<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PF Firewall: src/View/lib/stats.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PF Firewall<span id="projectnumber">&#160;7.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('lib_2stats_8php_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">stats.php</div></div>
</div><!--header-->
<div class="contents">
<a href="lib_2stats_8php.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span>&lt;?php</div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">/*</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> * Copyright (C) 2004-2023 Soner Tari</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> *</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> * This file is part of UTMFW.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> *</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> * UTMFW is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"> * it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"> * the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"> * (at your option) any later version.</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"> *</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"> * UTMFW is distributed in the hope that it will be useful,</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> * GNU General Public License for more details.</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"> *</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment"> * You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment"> * along with UTMFW.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment"> */</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno"><a class="line" href="lib_2stats_8php.html#a7d58cc793635ff6f9b214dd8cbb1d568">   24</a></span><span class="keyword">function</span> <a class="code hl_function" href="lib_2stats_8php.html#a7d58cc793635ff6f9b214dd8cbb1d568">PrintModalPieChart</a>()</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>{</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>    ?&gt;</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    &lt;!-- The Modal --&gt;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>    &lt;div <span class="keywordtype">id</span>=<span class="stringliteral">&quot;modalPieChart&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;modal&quot;</span>&gt;</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>        &lt;!-- The Close Button --&gt;</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>        &lt;span <span class="keyword">class</span>=<span class="stringliteral">&quot;close&quot;</span>&gt;&amp;times;&lt;/span&gt;</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>    &lt;/div&gt;</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    &lt;!-- The Pie Slice Tooltip --&gt;</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>    &lt;div <span class="keywordtype">id</span>=<span class="stringliteral">&quot;slicetip&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;hidden&quot;</span>&gt;</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>        &lt;p&gt;&lt;strong&gt;&lt;span <span class="keywordtype">id</span>=<span class="stringliteral">&quot;title&quot;</span>&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>        &lt;p&gt;&lt;span <span class="keywordtype">id</span>=<span class="stringliteral">&quot;key&quot;</span>&gt;&lt;/span&gt;&lt;/p&gt;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>        &lt;p&gt;&lt;span <span class="keywordtype">id</span>=<span class="stringliteral">&quot;value&quot;</span>&gt;&lt;/span&gt;&lt;/p&gt;</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>    &lt;/div&gt;</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>    &lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span> src=<span class="stringliteral">&quot;../lib/d3.min.js&quot;</span>&gt;&lt;/script&gt;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    &lt;script language=<span class="stringliteral">&quot;javascript&quot;</span> type=<span class="stringliteral">&quot;text/javascript&quot;</span>&gt;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>        <span class="comment">// Get the modal</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>        var modal = document.getElementById(<span class="stringliteral">&#39;modalPieChart&#39;</span>);</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span> </div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>        var slicetip = d3.select(<span class="stringliteral">&#39;#slicetip&#39;</span>);</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>        <span class="keyword">function</span> generateChart(dataset, title) {</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>            modal.style.display = <span class="stringliteral">&#39;block&#39;</span>;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span> </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>            var keys = Object.keys(dataset);</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>            var values = Object.values(dataset);</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>            var dataSum = d3.sum(values);</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span> </div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>            <span class="comment">// Use index to get key from dataset to display it on slicetip</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>            <span class="comment">// {key =&gt; {index =&gt; value}}</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>            var chartDataset = {};</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>            var curSum = 0;</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>            <span class="keywordflow">for</span> (var j = 0; j &lt; keys.length; ++j) {</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>                <span class="keywordflow">if</span> (j &gt; 10) {</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>                    chartDataset[<span class="stringliteral">&#39;others&#39;</span>] = {index: j, value: dataSum - curSum};</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>                }</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>                chartDataset[keys[j]] = {index: j, value: values[j]};</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>                curSum += values[j];</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>            }</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>            <span class="comment">// Use an accessor to get value as pie data</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>            var pie = d3.pie().value((d) =&gt; d.value);</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>            var w = 400;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>            var h = 400;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>            var outerRadius = w / 2;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>            var innerRadius = 0;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span> </div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>            var arc = d3.arc()</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>                .innerRadius(innerRadius)</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>                .outerRadius(outerRadius);</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>            <span class="comment">// Create SVG element</span></div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>            var svg = d3.select(<span class="stringliteral">&#39;#modalPieChart&#39;</span>)</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>                .append(<span class="stringliteral">&#39;svg&#39;</span>)</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>                .attr(<span class="stringliteral">&#39;id&#39;</span>, <span class="stringliteral">&#39;pieChart&#39;</span>)</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>                .attr(<span class="stringliteral">&#39;width&#39;</span>, w)</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>                .attr(<span class="stringliteral">&#39;height&#39;</span>, h)</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>                .attr(<span class="stringliteral">&#39;class&#39;</span>, <span class="stringliteral">&#39;modal-content&#39;</span>);</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>            <span class="comment">// Set up groups</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>            var arcs = svg.selectAll(<span class="stringliteral">&#39;g.arc&#39;</span>)</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>                .data(pie(Object.values(chartDataset)))</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>                .enter()</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>                .append(<span class="charliteral">&#39;g&#39;</span>)</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>                .attr(<span class="stringliteral">&#39;class&#39;</span>, <span class="stringliteral">&#39;arc&#39;</span>)</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>                .attr(<span class="stringliteral">&#39;transform&#39;</span>, <span class="stringliteral">&#39;translate(&#39;</span> + outerRadius + <span class="stringliteral">&#39;, &#39;</span> + outerRadius + <span class="charliteral">&#39;)&#39;</span>);</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span> </div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>            var color = d3.scaleOrdinal(d3.schemeCategory10);</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>            <span class="comment">// Draw arc paths</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>            arcs.append(<span class="stringliteral">&#39;path&#39;</span>)</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>                .attr(<span class="stringliteral">&#39;fill&#39;</span>, <span class="keyword">function</span> (d, i) {</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>                    <span class="keywordflow">return</span> color(i);</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>                })</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>                .attr(<span class="charliteral">&#39;d&#39;</span>, arc)</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>                .on(<span class="stringliteral">&#39;mouseover&#39;</span>, (event, d) =&gt; {</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>                    d3.select(event.currentTarget).style(<span class="stringliteral">&#39;opacity&#39;</span>, 0.7);</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span> </div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>                    <span class="comment">// Get the mouse pointer&#39;s x/y page coords for the tooltip</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>                    var x = <span class="keyword">event</span>.pageX + 25;</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                    var y = <span class="keyword">event</span>.pageY + 25;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>                    <span class="comment">// Update the tooltip position and contents</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>                    slicetip</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>                        .style(<span class="stringliteral">&#39;left&#39;</span>, x + <span class="stringliteral">&#39;px&#39;</span>)</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>                        .style(<span class="stringliteral">&#39;top&#39;</span>, y + <span class="stringliteral">&#39;px&#39;</span>)</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>                        .style(<span class="stringliteral">&#39;z-index&#39;</span>, 1);</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>                    slicetip</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>                        .select(<span class="stringliteral">&#39;#title&#39;</span>)</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>                        .text(title);</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>                    slicetip</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>                        .select(<span class="stringliteral">&#39;#key&#39;</span>)</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>                        .text(Object.keys(chartDataset)[d.data.index]);</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>                    slicetip</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>                        .select(<span class="stringliteral">&#39;#value&#39;</span>)</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>                        .text(Math.round(100 * d.value / dataSum) + <span class="stringliteral">&#39;%: &#39;</span> + d.value + <span class="charliteral">&#39;/&#39;</span> + dataSum);</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span> </div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>                    <span class="comment">// Show the tooltip</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>                    slicetip.classed(<span class="stringliteral">&#39;hidden&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>                })</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>                .on(<span class="stringliteral">&#39;mouseout&#39;</span>, (event) =&gt; {</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>                    d3.select(event.currentTarget)</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>                        .transition()</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>                        .duration(500)</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>                        .style(<span class="stringliteral">&#39;opacity&#39;</span>, 1);</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>                    <span class="comment">// Hide the tooltip</span></div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>                    slicetip.classed(<span class="stringliteral">&#39;hidden&#39;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                });</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span> </div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>            arcs.append(<span class="stringliteral">&#39;text&#39;</span>)</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>                .attr(<span class="stringliteral">&#39;transform&#39;</span>, <span class="keyword">function</span> (d) {</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>                    <span class="keywordflow">return</span> <span class="stringliteral">&#39;translate(&#39;</span> + arc.centroid(d) + <span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>                })</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>                .attr(<span class="stringliteral">&#39;text-anchor&#39;</span>, <span class="stringliteral">&#39;middle&#39;</span>)</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>                .attr(<span class="stringliteral">&#39;font-weight&#39;</span>, <span class="stringliteral">&#39;bold&#39;</span>)</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>                .text(<span class="keyword">function</span> (d, i) {</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>                    <span class="keywordflow">return</span> (d.value / dataSum &gt; .05) ? Object.keys(chartDataset)[i] : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>                });</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        };</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>        <span class="comment">// Get the &lt;span&gt; element that closes the modal</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>        var xbtn = document.getElementsByClassName(<span class="stringliteral">&#39;close&#39;</span>)[0];</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>        <span class="comment">// When the user clicks on the modal or &lt;span&gt; (x), close the modal</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>        <span class="keyword">function</span> close() {</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>            var chart = document.getElementById(<span class="stringliteral">&#39;pieChart&#39;</span>);</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>            <span class="comment">// This function is called twice, for both xbtn and modal</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>            <span class="keywordflow">if</span> (chart) {</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>                chart.parentNode.removeChild(chart);</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>                slicetip.classed(<span class="stringliteral">&#39;hidden&#39;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>                modal.style.display = <span class="stringliteral">&#39;none&#39;</span>;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>            }</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>        }</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>        xbtn.onclick = close;</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>        modal.onclick = close;</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>    &lt;/script&gt;</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    &lt;?php</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>}</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno"><a class="line" href="lib_2stats_8php.html#adc17fec78425e82407dcaa0f0d91694c">  177</a></span><span class="keyword">function</span> <a class="code hl_function" href="lib_2stats_8php.html#adc17fec78425e82407dcaa0f0d91694c">DisplayChartTriggers</a>()</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>{</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    ?&gt;</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>    &lt;script language=<span class="stringliteral">&quot;javascript&quot;</span> type=<span class="stringliteral">&quot;text/javascript&quot;</span>&gt;</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>        var trigs = document.getElementsByClassName(<span class="stringliteral">&#39;chart-trigger&#39;</span>);</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>        <span class="keywordflow">for</span> (var j = 0; j &lt; trigs.length; ++j) {</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>            trigs[j].style.display = <span class="stringliteral">&#39;inline&#39;</span>;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>        }</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    &lt;/script&gt;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    &lt;?php</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>}</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno"><a class="line" href="lib_2stats_8php.html#ab2bd89b86acfa12bc53a9bc0e40f20fa">  190</a></span><a class="code hl_variable" href="lib_2stats_8php.html#ab2bd89b86acfa12bc53a9bc0e40f20fa">$StatsWarningMsg</a>= <a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;Analysis of statistical data may take a long time to process. Please be patient. Also note that if you refresh this page frequently, CPU load may increase considerably.&#39;</span>);</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno"><a class="line" href="lib_2stats_8php.html#aa25c43be2349a68251baec561458f902">  193</a></span><a class="code hl_variable" href="lib_2stats_8php.html#aa25c43be2349a68251baec561458f902">$StatsHelpMsg</a>= <a class="code hl_function" href="view_8php.html#a249b79962f39cf1d037dfa8095060820">_HELPWINDOW</a>(<span class="stringliteral">&#39;This page displays statistical data collected over the log files of this module.</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span><span class="stringliteral">You can change the date of statistics using drop-down boxes. An empty value means match-all. For example, if you choose 3 for month and empty value for day fields, the charts and lists display statistics for all the days in March. Choosing empty value for month means empty value for day field as well.</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span><span class="stringliteral">For single dates, Horizontal chart direction is assumed. For date ranges, default graph style is Daily, and direction is Vertical. Graph style can be changed to Hourly for date ranges, where cumulative hourly statistics are shown. In Daily style, horizontal direction is not possible.&#39;</span>);</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span> </div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno"><a class="line" href="lib_2stats_8php.html#ad3721afc9816a0572176f35b69fd9a5b">  199</a></span><a class="code hl_variable" href="lib_2stats_8php.html#ad3721afc9816a0572176f35b69fd9a5b">$Submenu</a>= <a class="code hl_function" href="libauth_8php.html#aedf527ce631be6f841d63bc1b01a6c35">SetSubmenu</a>(<span class="stringliteral">&#39;general&#39;</span>);</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>require_once(<span class="stringliteral">&quot;../lib/stats.$Submenu.php&quot;</span>);</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>?&gt;</div>
<div class="ttc" id="alib_2stats_8php_html_a7d58cc793635ff6f9b214dd8cbb1d568"><div class="ttname"><a href="lib_2stats_8php.html#a7d58cc793635ff6f9b214dd8cbb1d568">PrintModalPieChart</a></div><div class="ttdeci">PrintModalPieChart()</div><div class="ttdoc">Prints pie chart on a modal.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2stats_8php_source.html#l00024">stats.php:24</a></div></div>
<div class="ttc" id="alib_2stats_8php_html_aa25c43be2349a68251baec561458f902"><div class="ttname"><a href="lib_2stats_8php.html#aa25c43be2349a68251baec561458f902">$StatsHelpMsg</a></div><div class="ttdeci">$StatsHelpMsg</div><div class="ttdoc">Main help box used on all statistics pages.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2stats_8php_source.html#l00193">stats.php:193</a></div></div>
<div class="ttc" id="alib_2stats_8php_html_ab2bd89b86acfa12bc53a9bc0e40f20fa"><div class="ttname"><a href="lib_2stats_8php.html#ab2bd89b86acfa12bc53a9bc0e40f20fa">$StatsWarningMsg</a></div><div class="ttdeci">$StatsWarningMsg</div><div class="ttdoc">Stats page warning message.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2stats_8php_source.html#l00190">stats.php:190</a></div></div>
<div class="ttc" id="alib_2stats_8php_html_ad3721afc9816a0572176f35b69fd9a5b"><div class="ttname"><a href="lib_2stats_8php.html#ad3721afc9816a0572176f35b69fd9a5b">$Submenu</a></div><div class="ttdeci">$Submenu</div><div class="ttdef"><b>Definition:</b> <a href="lib_2stats_8php_source.html#l00199">stats.php:199</a></div></div>
<div class="ttc" id="alib_2stats_8php_html_adc17fec78425e82407dcaa0f0d91694c"><div class="ttname"><a href="lib_2stats_8php.html#adc17fec78425e82407dcaa0f0d91694c">DisplayChartTriggers</a></div><div class="ttdeci">DisplayChartTriggers()</div><div class="ttdoc">Displays chart trigger images.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2stats_8php_source.html#l00177">stats.php:177</a></div></div>
<div class="ttc" id="alibauth_8php_html_aedf527ce631be6f841d63bc1b01a6c35"><div class="ttname"><a href="libauth_8php.html#aedf527ce631be6f841d63bc1b01a6c35">SetSubmenu</a></div><div class="ttdeci">SetSubmenu($default)</div><div class="ttdoc">Sets session submenu variable.</div><div class="ttdef"><b>Definition:</b> <a href="libauth_8php_source.html#l00227">libauth.php:227</a></div></div>
<div class="ttc" id="aview_8php_html_a249b79962f39cf1d037dfa8095060820"><div class="ttname"><a href="view_8php.html#a249b79962f39cf1d037dfa8095060820">_HELPWINDOW</a></div><div class="ttdeci">_HELPWINDOW($str)</div><div class="ttdoc">For classifying gettext strings into files.</div><div class="ttdef"><b>Definition:</b> <a href="view_8php_source.html#l00668">view.php:668</a></div></div>
<div class="ttc" id="aview_8php_html_a4aa5270b4a28926a0ea160561a3ba51f"><div class="ttname"><a href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a></div><div class="ttdeci">_NOTICE($str)</div><div class="ttdoc">For classifying gettext strings into files.</div><div class="ttdef"><b>Definition:</b> <a href="view_8php_source.html#l00656">view.php:656</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_7784d12364ef0ec21cd188ca9cb3a89c.html">View</a></li><li class="navelem"><a class="el" href="dir_3d8d19653935a420028f1a09cc863ca4.html">lib</a></li><li class="navelem"><a class="el" href="lib_2stats_8php.html">stats.php</a></li>
    <li class="footer">Generated on Sun Apr 30 2023 00:52:46 for PF Firewall by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
