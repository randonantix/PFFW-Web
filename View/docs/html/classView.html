<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PF Firewall: View Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PF Firewall<span id="projectnumber">&#160;7.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classView.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle"><div class="title">View Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for View:</div>
<div class="dyncontent">
<div class="center"><img src="classView__inherit__graph.png" border="0" usemap="#aView_inherit__map" alt="Inheritance graph"/></div>
<map name="aView_inherit__map" id="aView_inherit__map">
<area shape="rect" title=" " alt="" coords="364,5,419,31"/>
<area shape="rect" href="classCtlrlogs.html" title=" " alt="" coords="41,225,113,251"/>
<area shape="rect" href="classDhcpd.html" title=" " alt="" coords="31,79,94,104"/>
<area shape="rect" href="classDnsmasq.html" title=" " alt="" coords="118,79,201,104"/>
<area shape="rect" href="classDocs.html" title=" " alt="" coords="226,79,280,104"/>
<area shape="rect" href="classFtpproxy.html" title=" " alt="" coords="305,79,385,104"/>
<area shape="rect" href="classHttpd.html" title=" " alt="" coords="409,79,468,104"/>
<area shape="rect" href="classMonitoring.html" title=" " alt="" coords="492,79,584,104"/>
<area shape="rect" href="classOpenssh.html" title=" " alt="" coords="608,79,687,104"/>
<area shape="rect" href="classPf.html" title=" " alt="" coords="711,79,750,104"/>
<area shape="rect" href="classSystem.html" title=" " alt="" coords="774,79,844,104"/>
<area shape="rect" href="classFwlogs.html" title=" " alt="" coords="178,152,246,177"/>
<area shape="rect" href="classHttpdlogs.html" title=" " alt="" coords="344,152,429,177"/>
<area shape="rect" href="classWuilogs.html" title=" " alt="" coords="174,225,249,251"/>
<area shape="rect" href="classCollectd.html" title=" " alt="" coords="453,152,528,177"/>
<area shape="rect" href="classSymon.html" title=" " alt="" coords="552,152,618,177"/>
<area shape="rect" href="classSymux.html" title=" " alt="" coords="642,152,709,177"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a523ddd51e800ca8c2c56854c85cb312f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#a523ddd51e800ca8c2c56854c85cb312f">Controller</a> (&amp;$output)</td></tr>
<tr class="memdesc:a523ddd51e800ca8c2c56854c85cb312f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls the controller.  <br /></td></tr>
<tr class="separator:a523ddd51e800ca8c2c56854c85cb312f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea23a64569c8554130fb55b4c6781b33"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#aea23a64569c8554130fb55b4c6781b33">CheckAuthentication</a> ($user, $passwd)</td></tr>
<tr class="memdesc:aea23a64569c8554130fb55b4c6781b33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks the given user:password pair by testing login.  <br /></td></tr>
<tr class="separator:aea23a64569c8554130fb55b4c6781b33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07c2efd2b813bc974c545fcf33783926"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#a07c2efd2b813bc974c545fcf33783926">Restart</a> ()</td></tr>
<tr class="memdesc:a07c2efd2b813bc974c545fcf33783926"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops and restarts module process(es).  <br /></td></tr>
<tr class="separator:a07c2efd2b813bc974c545fcf33783926"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f17de803b9ad897ee1e879e90982bd2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#a0f17de803b9ad897ee1e879e90982bd2">Stop</a> ()</td></tr>
<tr class="memdesc:a0f17de803b9ad897ee1e879e90982bd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops module process(es).  <br /></td></tr>
<tr class="separator:a0f17de803b9ad897ee1e879e90982bd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58a42cd2dbcf0483f1da759a8d283d58"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#a58a42cd2dbcf0483f1da759a8d283d58">Start</a> ()</td></tr>
<tr class="memdesc:a58a42cd2dbcf0483f1da759a8d283d58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts module process(es).  <br /></td></tr>
<tr class="separator:a58a42cd2dbcf0483f1da759a8d283d58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e15d34b5378973d7c5f425eea21cbfe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#a0e15d34b5378973d7c5f425eea21cbfe">ProcessStartStopRequests</a> ()</td></tr>
<tr class="memdesc:a0e15d34b5378973d7c5f425eea21cbfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes user posts for process start and stop.  <br /></td></tr>
<tr class="separator:a0e15d34b5378973d7c5f425eea21cbfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac66492e0af705fe63013ec18a7a9fa15"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#ac66492e0af705fe63013ec18a7a9fa15">PrintStatusForm</a> ($generate_status=0, $printcount=FALSE, $showbuttons=TRUE, $printprocs=TRUE, $showrestartbutton=FALSE)</td></tr>
<tr class="memdesc:ac66492e0af705fe63013ec18a7a9fa15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Displays module status, software version, Restart/Stop buttons, and process table.  <br /></td></tr>
<tr class="separator:ac66492e0af705fe63013ec18a7a9fa15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab01dd9990a4e547d5519dd0d9174fdb7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#ab01dd9990a4e547d5519dd0d9174fdb7">PrintProcessTable</a> ($output, $printcount=FALSE)</td></tr>
<tr class="memdesc:ab01dd9990a4e547d5519dd0d9174fdb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets and lists processes for daemons/services.  <br /></td></tr>
<tr class="separator:ab01dd9990a4e547d5519dd0d9174fdb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb2db63abb2379f6fa3bfe17f4975d42"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#abb2db63abb2379f6fa3bfe17f4975d42">PrintProcessTableHeader</a> ()</td></tr>
<tr class="memdesc:abb2db63abb2379f6fa3bfe17f4975d42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints headers for processes table.  <br /></td></tr>
<tr class="separator:abb2db63abb2379f6fa3bfe17f4975d42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef4854da4a80f863418cbc2360cc33df"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#aef4854da4a80f863418cbc2360cc33df">UploadLogFile</a> ()</td></tr>
<tr class="memdesc:aef4854da4a80f863418cbc2360cc33df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uploads selected log file.  <br /></td></tr>
<tr class="separator:aef4854da4a80f863418cbc2360cc33df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b7b8e472e1742ee0be6390ae6c85670"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#a2b7b8e472e1742ee0be6390ae6c85670">PrintStats</a> ($file='')</td></tr>
<tr class="memdesc:a2b7b8e472e1742ee0be6390ae6c85670"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints general text statistics.  <br /></td></tr>
<tr class="separator:a2b7b8e472e1742ee0be6390ae6c85670"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6f7c1b683220834feaa1ae071e577d6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#aa6f7c1b683220834feaa1ae071e577d6">IsDateRange</a> ($date)</td></tr>
<tr class="memdesc:aa6f7c1b683220834feaa1ae071e577d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the date array contains a range, meaning an empty string.  <br /></td></tr>
<tr class="separator:aa6f7c1b683220834feaa1ae071e577d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1455cd0463f356f76d6fefc1be2d0f61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#a1455cd0463f356f76d6fefc1be2d0f61">FormatDate</a> ($date)</td></tr>
<tr class="memdesc:a1455cd0463f356f76d6fefc1be2d0f61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic date array to string formatter.  <br /></td></tr>
<tr class="separator:a1455cd0463f356f76d6fefc1be2d0f61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4eb4b078f693461c66cea00a2f3b0a7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#aa4eb4b078f693461c66cea00a2f3b0a7">FormatDateArray</a> ($datestr, &amp;$date)</td></tr>
<tr class="memdesc:aa4eb4b078f693461c66cea00a2f3b0a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Date string to array formatter.  <br /></td></tr>
<tr class="separator:aa4eb4b078f693461c66cea00a2f3b0a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a014cbcd14acae8d018129f8030d441d9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#a014cbcd14acae8d018129f8030d441d9">PrintLogLine</a> ($cols, $linenum, $lastlinenum)</td></tr>
<tr class="memdesc:a014cbcd14acae8d018129f8030d441d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic parser, highlighter, and printer for the log line.  <br /></td></tr>
<tr class="separator:a014cbcd14acae8d018129f8030d441d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7380caec2969c7c943efab862b724b76"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#a7380caec2969c7c943efab862b724b76">getLogLineClass</a> ($cols)</td></tr>
<tr class="memdesc:a7380caec2969c7c943efab862b724b76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines log line color class.  <br /></td></tr>
<tr class="separator:a7380caec2969c7c943efab862b724b76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9beeef4a0926b9f2ac3ba6354b8573b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#af9beeef4a0926b9f2ac3ba6354b8573b">FormatLogCols</a> (&amp;$cols)</td></tr>
<tr class="memdesc:af9beeef4a0926b9f2ac3ba6354b8573b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post-processes log columns for display.  <br /></td></tr>
<tr class="separator:af9beeef4a0926b9f2ac3ba6354b8573b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b7f83be321b3512acc2c1bd1a41b787"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#a0b7f83be321b3512acc2c1bd1a41b787">SetSessionConfOpt</a> ()</td></tr>
<tr class="separator:a0b7f83be321b3512acc2c1bd1a41b787"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a4d78d22732a2db7f27b3c39ab3a0f679"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#a4d78d22732a2db7f27b3c39ab3a0f679">$Model</a> = 'model'</td></tr>
<tr class="separator:a4d78d22732a2db7f27b3c39ab3a0f679"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a643d60fb839b5d58f0725a88d0ecd1a0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#a643d60fb839b5d58f0725a88d0ecd1a0">$Module</a> = 'model'</td></tr>
<tr class="separator:a643d60fb839b5d58f0725a88d0ecd1a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9e8ffc52c9a4f358fb574dae198f434"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#ab9e8ffc52c9a4f358fb574dae198f434">$Caption</a> = '<a class="el" href="classModel.html">Model</a>'</td></tr>
<tr class="separator:ab9e8ffc52c9a4f358fb574dae198f434"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6342c38a273ba23edb4a2c6ee907bf2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#ad6342c38a273ba23edb4a2c6ee907bf2">$LogsHelpMsg</a> = ''</td></tr>
<tr class="separator:ad6342c38a273ba23edb4a2c6ee907bf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a603376f45a6c28f439076e775ee851f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#a603376f45a6c28f439076e775ee851f0">$GraphHelpMsg</a> = ''</td></tr>
<tr class="separator:a603376f45a6c28f439076e775ee851f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0053f9703e84c2b7fd41ff4819305b6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#aa0053f9703e84c2b7fd41ff4819305b6">$ConfHelpMsg</a> = ''</td></tr>
<tr class="separator:aa0053f9703e84c2b7fd41ff4819305b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa82afad3a1e5359b526e325dfbb3c894"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#aa82afad3a1e5359b526e325dfbb3c894">$Layout</a> = ''</td></tr>
<tr class="separator:aa82afad3a1e5359b526e325dfbb3c894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6ed4f9ea7c0b69f41295c885adb4651"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#af6ed4f9ea7c0b69f41295c885adb4651">$LogsPage</a> = 'logs.php'</td></tr>
<tr class="separator:af6ed4f9ea7c0b69f41295c885adb4651"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83b7d71e43e3e32108a4b4834c24fbca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#a83b7d71e43e3e32108a4b4834c24fbca">$StatsPage</a> = 'stats.php'</td></tr>
<tr class="separator:a83b7d71e43e3e32108a4b4834c24fbca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2e162a2e94a6861acb555bb17919717"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView.html#ac2e162a2e94a6861acb555bb17919717">$Config</a> = array()</td></tr>
<tr class="memdesc:ac2e162a2e94a6861acb555bb17919717"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration.  <br /></td></tr>
<tr class="separator:ac2e162a2e94a6861acb555bb17919717"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00027">27</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="aea23a64569c8554130fb55b4c6781b33" name="aea23a64569c8554130fb55b4c6781b33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea23a64569c8554130fb55b4c6781b33">&#9670;&#160;</a></span>CheckAuthentication()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CheckAuthentication </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$passwd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks the given user:password pair by testing login. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$user</td><td>User name. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$passwd</td><td>SHA encrypted password. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE if passwd matches, FALSE otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00187">187</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  188</span>    {</div>
<div class="line"><span class="lineno">  189</span>        $ssh = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceNet__SSH2.html">Net_SSH2</a>(<span class="stringliteral">&#39;127.0.0.1&#39;</span>);</div>
<div class="line"><span class="lineno">  190</span>        <span class="keywordflow">if</span> ($ssh-&gt;login($user, $passwd)) {</div>
<div class="line"><span class="lineno">  191</span>            $hostname= gethostname();</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>            $encoded_args= json_encode(array(<a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;Locale&#39;</span>], $this-&gt;<a class="code hl_namespace" href="namespaceModel.html">Model</a>, <span class="stringliteral">&#39;GetMyName&#39;</span>), JSON_UNESCAPED_SLASHES);</div>
<div class="line"><span class="lineno">  194</span>            $output= $ssh-&gt;exec($encoded_args);</div>
<div class="line"><span class="lineno">  195</span>            $decoded= json_decode($output, TRUE);</div>
<div class="line"><span class="lineno">  196</span>            <span class="keywordflow">if</span> ($decoded !== NULL &amp;&amp; is_array($decoded)) {</div>
<div class="line"><span class="lineno">  197</span>                $output= explode(<span class="stringliteral">&quot;\n&quot;</span>, $decoded[0]);</div>
<div class="line"><span class="lineno">  198</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  199</span>                $msg= <span class="stringliteral">&#39;Failed decoding output: &#39;</span>.print_r($output, TRUE);</div>
<div class="line"><span class="lineno">  200</span>                <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;$msg, ($encoded_args)&quot;</span>);</div>
<div class="line"><span class="lineno">  201</span>                <a class="code hl_function" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a>($msg, <span class="stringliteral">&#39;auto&#39;</span>, <span class="stringliteral">&#39;ERROR&#39;</span>);</div>
<div class="line"><span class="lineno">  202</span>            }</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>            <span class="keywordflow">if</span> ($hostname == $output[0]) {</div>
<div class="line"><span class="lineno">  205</span>                <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  206</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  207</span>                <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;SSH test command failed: $hostname == $output[0]&quot;</span>);</div>
<div class="line"><span class="lineno">  208</span>            }</div>
<div class="line"><span class="lineno">  209</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  210</span>            <a class="code hl_function" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a>(<a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;FAILED&#39;</span>).<span class="stringliteral">&#39;: &#39;</span>.<a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;Authentication failed&#39;</span>), <span class="stringliteral">&#39;auto&#39;</span>, <span class="stringliteral">&#39;ERROR&#39;</span>);</div>
<div class="line"><span class="lineno">  211</span>            <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;Authentication failed&#39;</span>);</div>
<div class="line"><span class="lineno">  212</span>        }</div>
<div class="line"><span class="lineno">  213</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  214</span>    }</div>
<div class="ttc" id="aInstaller_2lib_8php_html_ac089920689dafbf6a510f3b87eb6a6d4"><div class="ttname"><a href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a></div><div class="ttdeci">PrintHelpWindow($msg, $width='auto', $type='INFO')</div><div class="ttdoc">Satisfies Controller.</div><div class="ttdef"><b>Definition:</b> <a href="Installer_2lib_8php_source.html#l00030">lib.php:30</a></div></div>
<div class="ttc" id="alibauth_8php_html_aafa5d84b0ff32cf3d31b8cdfd1c6d769"><div class="ttname"><a href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a></div><div class="ttdeci">wui_syslog($prio, $file, $func, $line, $msg)</div><div class="ttdoc">Wrapper for syslog().</div><div class="ttdef"><b>Definition:</b> <a href="libauth_8php_source.html#l00067">libauth.php:67</a></div></div>
<div class="ttc" id="alogs_8archives_8php_html_a7430243fef5a97ca3ca2324775d4dfec"><div class="ttname"><a href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a></div><div class="ttdeci">if(count($_POST)) else if(isset( $_SESSION[ $View-&gt;Model][ $Submenu][ 'Month'], $_SESSION[ $View-&gt;Model][ $Submenu][ 'Day'], $_SESSION[ $View-&gt;Model][ $Submenu][ 'Hour'], $_SESSION[ $View-&gt;Model][ $Submenu][ 'Minute'])) if($ApplyDefaults) $_SESSION[$View-&gt;Model][$Submenu]['Month']</div><div class="ttdef"><b>Definition:</b> <a href="logs_8archives_8php_source.html#l00081">logs.archives.php:81</a></div></div>
<div class="ttc" id="anamespaceModel_html"><div class="ttname"><a href="namespaceModel.html">Model</a></div><div class="ttdoc">Model of MVC: Generally, the Model is responsible for executing commands from the View.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2AfTo_8php_source.html#l00021">AfTo.php:21</a></div></div>
<div class="ttc" id="anamespaceNet__SSH2_html"><div class="ttname"><a href="namespaceNet__SSH2.html">Net_SSH2</a></div><div class="ttdoc">#-</div></div>
<div class="ttc" id="aview_8php_html_a4aa5270b4a28926a0ea160561a3ba51f"><div class="ttname"><a href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a></div><div class="ttdeci">_NOTICE($str)</div><div class="ttdoc">For classifying gettext strings into files.</div><div class="ttdef"><b>Definition:</b> <a href="view_8php_source.html#l00656">view.php:656</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="logs_8archives_8php_source.html#l00081">$_SESSION</a>, <a class="el" href="view_8php_source.html#l00656">_NOTICE()</a>, <a class="el" href="Installer_2lib_8php_source.html#l00030">PrintHelpWindow()</a>, and <a class="el" href="libauth_8php_source.html#l00067">wui_syslog()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_aea23a64569c8554130fb55b4c6781b33_cgraph.png" border="0" usemap="#aclassView_aea23a64569c8554130fb55b4c6781b33_cgraph" alt=""/></div>
<map name="aclassView_aea23a64569c8554130fb55b4c6781b33_cgraph" id="aclassView_aea23a64569c8554130fb55b4c6781b33_cgraph">
<area shape="rect" title="Checks the given user:password pair by testing login." alt="" coords="5,55,163,80"/>
<area shape="rect" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f" title="For classifying gettext strings into files." alt="" coords="239,5,317,31"/>
<area shape="rect" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4" title="Satisfies Controller." alt="" coords="211,55,345,80"/>
<area shape="rect" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769" title="Wrapper for syslog()." alt="" coords="231,104,325,129"/>
</map>
</div>

</div>
</div>
<a id="a523ddd51e800ca8c2c56854c85cb312f" name="a523ddd51e800ca8c2c56854c85cb312f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a523ddd51e800ca8c2c56854c85cb312f">&#9670;&#160;</a></span>Controller()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Controller </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$output</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls the controller. </p>
<p>Both command and arguments are passed as variable arguments.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$output</td><td>Output of the command. </td></tr>
    <tr><td class="paramtype"></td><td class="paramname">mixed</td><td>Variable_Args Elements of the command line in variable arguments. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool Return value of shell command (adjusted for PHP). </dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000005">Bug:</a></b></dt><dd><a href="http://bugs.php.net/bug.php?id=49847">http://bugs.php.net/bug.php?id=49847</a>, fixed/closed in SVN on 141009 </dd></dl>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00074">74</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   75</span>    {</div>
<div class="line"><span class="lineno">   76</span>        global <a class="code hl_variable" href="ctlr_8php.html#a40526f7adf1cd83e3b87bc51d2835cf9">$SRC_ROOT</a>, <a class="code hl_variable" href="install_8php.html#ae24ad5440f9dc504e9e3ef2ddfb65566">$UseSSH</a>;</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>        $return= FALSE;</div>
<div class="line"><span class="lineno">   79</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">   80</span>            $ctlr= <a class="code hl_variable" href="ctlr_8php.html#a40526f7adf1cd83e3b87bc51d2835cf9">$SRC_ROOT</a> . <span class="stringliteral">&#39;/Controller/ctlr.php&#39;</span>;</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>            $argv= func_get_args();</div>
<div class="line"><span class="lineno">   83</span>            <span class="comment">// Arg 0 is $output, skip it</span></div>
<div class="line"><span class="lineno">   84</span>            $argv= array_slice($argv, 1);</div>
<div class="line"><span class="lineno">   85</span>            <span class="comment">// Prepend locale and model</span></div>
<div class="line"><span class="lineno">   86</span>            $argv= array_merge(array(<a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;Locale&#39;</span>], $this-&gt;<a class="code hl_namespace" href="namespaceModel.html">Model</a>), $argv);</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>            $encoded_args= json_encode($argv, JSON_UNESCAPED_SLASHES);</div>
<div class="line"><span class="lineno">   89</span>            <span class="keywordflow">if</span> ($encoded_args !== NULL) {</div>
<div class="line"><span class="lineno">   90</span>                <span class="comment">// Init command output</span></div>
<div class="line"><span class="lineno">   91</span>                $outputArray= array();</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>                $executed= TRUE;</div>
<div class="line"><span class="lineno">   94</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="install_8php.html#ae24ad5440f9dc504e9e3ef2ddfb65566">$UseSSH</a>) {</div>
<div class="line"><span class="lineno">   95</span>                    <span class="comment">// Subsequent calls use the encrypted password in the cookie, so we should decrypt it first</span></div>
<div class="line"><span class="lineno">   96</span>                    $ciphertext_base64= $_COOKIE[<span class="stringliteral">&#39;passwd&#39;</span>];</div>
<div class="line"><span class="lineno">   97</span>                    $ciphertext= base64_decode($ciphertext_base64);</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>                    $iv_size= openssl_cipher_iv_length(<span class="stringliteral">&#39;AES-256-CBC&#39;</span>);</div>
<div class="line"><span class="lineno">  100</span>                    $iv= substr($ciphertext, 0, $iv_size);</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>                    $ciphertext= substr($ciphertext, $iv_size);</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>                    $passwd= openssl_decrypt($ciphertext, <span class="stringliteral">&#39;AES-256-CBC&#39;</span>, <a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;cryptKey&#39;</span>], OPENSSL_RAW_DATA, $iv);</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>                    $ssh= <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceNet__SSH2.html">Net_SSH2</a>(<span class="stringliteral">&#39;127.0.0.1&#39;</span>);</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>                    <span class="comment">// Give more time to all requests, the default timeout is 10 seconds</span></div>
<div class="line"><span class="lineno">  109</span>                    $ssh-&gt;setTimeout(30);</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>                    <span class="keywordflow">if</span> ($ssh-&gt;login(<a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;USER&#39;</span>], $passwd)) {</div>
<div class="line"><span class="lineno">  112</span>                        <span class="comment">// The login shells of admin and user users are set to sh.php, so we just pass down the args</span></div>
<div class="line"><span class="lineno">  113</span>                        $outputArray[0]= $ssh-&gt;exec($encoded_args);</div>
<div class="line"><span class="lineno">  114</span>                        <span class="keywordflow">if</span> ($ssh-&gt;isTimeout()) {</div>
<div class="line"><span class="lineno">  115</span>                            $msg= <span class="stringliteral">&#39;SSH exec timed out&#39;</span>;</div>
<div class="line"><span class="lineno">  116</span>                            <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;$msg, ($encoded_args)&quot;</span>);</div>
<div class="line"><span class="lineno">  117</span>                            <a class="code hl_function" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a>($msg, <span class="stringliteral">&#39;auto&#39;</span>, <span class="stringliteral">&#39;ERROR&#39;</span>);</div>
<div class="line"><span class="lineno">  118</span>                            $executed= FALSE;</div>
<div class="line"><span class="lineno">  119</span>                        }</div>
<div class="line"><span class="lineno">  120</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  121</span>                        $msg= <span class="stringliteral">&#39;SSH login failed&#39;</span>;</div>
<div class="line"><span class="lineno">  122</span>                        <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;$msg, ($encoded_args)&quot;</span>);</div>
<div class="line"><span class="lineno">  123</span>                        <a class="code hl_function" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a>($msg, <span class="stringliteral">&#39;auto&#39;</span>, <span class="stringliteral">&#39;ERROR&#39;</span>);</div>
<div class="line"><span class="lineno">  124</span>                        $executed= FALSE;</div>
<div class="line"><span class="lineno">  125</span>                    }</div>
<div class="line"><span class="lineno">  126</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  127</span>                    <span class="comment">// Runs the command as the www user</span></div>
<div class="line"><span class="lineno">  128</span>                    <span class="comment">// Escape args to avoid shell expansion</span></div>
<div class="line"><span class="lineno">  130</span><span class="comment"></span>                    exec(<span class="stringliteral">&quot;/usr/bin/doas $ctlr &quot;</span>.escapeshellarg($encoded_args), $outputArray);</div>
<div class="line"><span class="lineno">  131</span>                }</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>                <span class="keywordflow">if</span> ($executed) {</div>
<div class="line"><span class="lineno">  134</span>                    $output= array();</div>
<div class="line"><span class="lineno">  135</span>                    $errorStr= <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  136</span>                    <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= 1;</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>                    $decoded= json_decode($outputArray[0], TRUE);</div>
<div class="line"><span class="lineno">  139</span>                    <span class="keywordflow">if</span> ($decoded !== NULL &amp;&amp; is_array($decoded)) {</div>
<div class="line"><span class="lineno">  140</span>                        $output= explode(<span class="stringliteral">&quot;\n&quot;</span>, $decoded[0]);</div>
<div class="line"><span class="lineno">  141</span>                        $errorStr= $decoded[1];</div>
<div class="line"><span class="lineno">  142</span>                        <span class="comment">// FALSE returned by the Model function is json_encoded/decoded as string &#39;false&#39;</span></div>
<div class="line"><span class="lineno">  143</span>                        <span class="keywordflow">if</span> ($decoded[0] == <span class="stringliteral">&#39;false&#39;</span>) {</div>
<div class="line"><span class="lineno">  144</span>                            <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= 1;</div>
<div class="line"><span class="lineno">  145</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  146</span>                            <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= $decoded[2];</div>
<div class="line"><span class="lineno">  147</span>                        }</div>
<div class="line"><span class="lineno">  148</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  149</span>                        $msg= <span class="stringliteral">&#39;Failed decoding output: &#39;</span>.print_r($outputArray[0], TRUE);</div>
<div class="line"><span class="lineno">  150</span>                        <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;$msg, ($encoded_args)&quot;</span>);</div>
<div class="line"><span class="lineno">  151</span>                        <a class="code hl_function" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a>($msg, <span class="stringliteral">&#39;auto&#39;</span>, <span class="stringliteral">&#39;ERROR&#39;</span>);</div>
<div class="line"><span class="lineno">  152</span>                    }</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>                    <span class="comment">// Show errors, if any</span></div>
<div class="line"><span class="lineno">  155</span>                    <span class="keywordflow">if</span> ($errorStr !== <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno">  156</span>                        $error= explode(<span class="stringliteral">&quot;\n&quot;</span>, $errorStr);</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>                        <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Shell command exit status: $retval: (&quot;</span> . implode(<span class="stringliteral">&#39;, &#39;</span>, $error) . <span class="stringliteral">&quot;), ($encoded_args)&quot;</span>);</div>
<div class="line"><span class="lineno">  159</span>                        <a class="code hl_function" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a>(implode(<span class="stringliteral">&#39;&lt;br&gt;&#39;</span>, $error), <span class="stringliteral">&#39;auto&#39;</span>, <span class="stringliteral">&#39;ERROR&#39;</span>);</div>
<div class="line"><span class="lineno">  160</span>                    }</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>                    <span class="comment">// (exit status 0 in shell) == (TRUE in php)</span></div>
<div class="line"><span class="lineno">  163</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno">  164</span>                        $return= TRUE;</div>
<div class="line"><span class="lineno">  165</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  166</span>                        <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Shell command exit status: $retval: ($encoded_args)&quot;</span>);</div>
<div class="line"><span class="lineno">  167</span>                    }</div>
<div class="line"><span class="lineno">  168</span>                }</div>
<div class="line"><span class="lineno">  169</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  170</span>                <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;Failed encoding args: &#39;</span> . print_r($argv, TRUE));</div>
<div class="line"><span class="lineno">  171</span>            }</div>
<div class="line"><span class="lineno">  172</span>        }</div>
<div class="line"><span class="lineno">  173</span>        <span class="keywordflow">catch</span> (Exception $e) {</div>
<div class="line"><span class="lineno">  174</span>            echo <span class="stringliteral">&#39;Exception: &#39;</span>.__FILE__.<span class="charliteral">&#39; &#39;</span>.__FUNCTION__.<span class="stringliteral">&#39; (&#39;</span>.__LINE__.<span class="stringliteral">&#39;): &#39;</span>.$e-&gt;getMessage().<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  175</span>            <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;Exception: &#39;</span>.$e-&gt;getMessage());</div>
<div class="line"><span class="lineno">  176</span>        }</div>
<div class="line"><span class="lineno">  177</span>        <span class="keywordflow">return</span> $return;</div>
<div class="line"><span class="lineno">  178</span>    }</div>
<div class="ttc" id="actlr_8php_html_a40526f7adf1cd83e3b87bc51d2835cf9"><div class="ttname"><a href="ctlr_8php.html#a40526f7adf1cd83e3b87bc51d2835cf9">$SRC_ROOT</a></div><div class="ttdeci">$SRC_ROOT</div><div class="ttdef"><b>Definition:</b> <a href="ctlr_8php_source.html#l00032">ctlr.php:32</a></div></div>
<div class="ttc" id="actlr_8php_html_a80b96347dc2ad0d4e3748dc87db72731"><div class="ttname"><a href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a></div><div class="ttdeci">if( $ArgV[0]==='-n') if($ArgV[0]==='-t') $retval</div><div class="ttdef"><b>Definition:</b> <a href="ctlr_8php_source.html#l00072">ctlr.php:72</a></div></div>
<div class="ttc" id="ainstall_8php_html_ae24ad5440f9dc504e9e3ef2ddfb65566"><div class="ttname"><a href="install_8php.html#ae24ad5440f9dc504e9e3ef2ddfb65566">$UseSSH</a></div><div class="ttdeci">$UseSSH</div><div class="ttdef"><b>Definition:</b> <a href="install_8php_source.html#l00062">install.php:62</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="logs_8archives_8php_source.html#l00081">$_SESSION</a>, <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="ctlr_8php_source.html#l00032">$SRC_ROOT</a>, <a class="el" href="install_8php_source.html#l00062">$UseSSH</a>, <a class="el" href="Installer_2lib_8php_source.html#l00030">PrintHelpWindow()</a>, and <a class="el" href="libauth_8php_source.html#l00067">wui_syslog()</a>.</p>

<p class="reference">Referenced by <a class="el" href="View_2pf_2pf_8php_source.html#l00086">Pf\PrintStatesTable()</a>, <a class="el" href="view_8php_source.html#l00507">PrintStats()</a>, <a class="el" href="view_8php_source.html#l00290">PrintStatusForm()</a>, <a class="el" href="view_8php_source.html#l00260">ProcessStartStopRequests()</a>, <a class="el" href="view_8php_source.html#l00247">Start()</a>, <a class="el" href="view_8php_source.html#l00234">Stop()</a>, and <a class="el" href="view_8php_source.html#l00469">UploadLogFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_a523ddd51e800ca8c2c56854c85cb312f_cgraph.png" border="0" usemap="#aclassView_a523ddd51e800ca8c2c56854c85cb312f_cgraph" alt=""/></div>
<map name="aclassView_a523ddd51e800ca8c2c56854c85cb312f_cgraph" id="aclassView_a523ddd51e800ca8c2c56854c85cb312f_cgraph">
<area shape="rect" title="Calls the controller." alt="" coords="5,31,92,56"/>
<area shape="rect" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4" title="Satisfies Controller." alt="" coords="140,5,275,31"/>
<area shape="rect" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769" title="Wrapper for syslog()." alt="" coords="160,55,255,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_a523ddd51e800ca8c2c56854c85cb312f_icgraph.png" border="0" usemap="#aclassView_a523ddd51e800ca8c2c56854c85cb312f_icgraph" alt=""/></div>
<map name="aclassView_a523ddd51e800ca8c2c56854c85cb312f_icgraph" id="aclassView_a523ddd51e800ca8c2c56854c85cb312f_icgraph">
<area shape="rect" title="Calls the controller." alt="" coords="555,155,641,180"/>
<area shape="rect" href="classPf.html#a466fac5fced11e2731c73da0430d590b" title="Gets and lists pf states." alt="" coords="363,5,507,31"/>
<area shape="rect" href="classView.html#a2b7b8e472e1742ee0be6390ae6c85670" title="Prints general text statistics." alt="" coords="392,55,477,80"/>
<area shape="rect" href="classView.html#ac66492e0af705fe63013ec18a7a9fa15" title="Displays module status, software version, Restart/Stop buttons, and process table." alt="" coords="371,104,498,129"/>
<area shape="rect" href="classView.html#a0e15d34b5378973d7c5f425eea21cbfe" title="Processes user posts for process start and stop." alt="" coords="5,205,197,231"/>
<area shape="rect" href="classView.html#a58a42cd2dbcf0483f1da759a8d283d58" title="Starts module process(es)." alt="" coords="408,205,461,231"/>
<area shape="rect" href="classView.html#a0f17de803b9ad897ee1e879e90982bd2" title="Stops module process(es)." alt="" coords="409,255,460,280"/>
<area shape="rect" href="classView.html#aef4854da4a80f863418cbc2360cc33df" title="Uploads selected log file." alt="" coords="377,304,492,329"/>
<area shape="rect" href="classView.html#a07c2efd2b813bc974c545fcf33783926" title="Stops and restarts module process(es)." alt="" coords="245,205,315,231"/>
</map>
</div>

</div>
</div>
<a id="a1455cd0463f356f76d6fefc1be2d0f61" name="a1455cd0463f356f76d6fefc1be2d0f61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1455cd0463f356f76d6fefc1be2d0f61">&#9670;&#160;</a></span>FormatDate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FormatDate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$date</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generic date array to string formatter. </p>
<p>Assumes standard syslog date format for the output string. The datetimes in log lines may be different for each module. Does the opposite of FormatDateArray().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$date</td><td>Datetime struct. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string Date string. </dd></dl>

<p>Reimplemented in <a class="el" href="classPf.html#a1455cd0463f356f76d6fefc1be2d0f61">Pf</a>.</p>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00540">540</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  541</span>    {</div>
<div class="line"><span class="lineno">  542</span>        global <a class="code hl_variable" href="defs_8php.html#a4ce923af45f11d3c8c5488c75cdefbb5">$MonthNames</a>;</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="defs_8php.html#a4ce923af45f11d3c8c5488c75cdefbb5">$MonthNames</a>[$date[<span class="stringliteral">&#39;Month&#39;</span>]].<span class="charliteral">&#39; &#39;</span>.sprintf(<span class="stringliteral">&#39;% 2d&#39;</span>, $date[<span class="stringliteral">&#39;Day&#39;</span>]);</div>
<div class="line"><span class="lineno">  545</span>    }</div>
<div class="ttc" id="adefs_8php_html_a4ce923af45f11d3c8c5488c75cdefbb5"><div class="ttname"><a href="defs_8php.html#a4ce923af45f11d3c8c5488c75cdefbb5">$MonthNames</a></div><div class="ttdeci">$MonthNames</div><div class="ttdoc">Used in translating months from number to string.</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00075">defs.php:75</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="defs_8php_source.html#l00075">$MonthNames</a>.</p>

</div>
</div>
<a id="aa4eb4b078f693461c66cea00a2f3b0a7" name="aa4eb4b078f693461c66cea00a2f3b0a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4eb4b078f693461c66cea00a2f3b0a7">&#9670;&#160;</a></span>FormatDateArray()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FormatDateArray </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$datestr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$date</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Date string to array formatter. </p>
<p>Assumes standard syslog date format for the output string. Does the opposite of FormatDate().</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000052">Todo:</a></b></dt><dd>Check if empty Year is ok around new year's day</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$datestr</td><td>Date as string. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$date</td><td>Datetime output. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00559">559</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  560</span>    {</div>
<div class="line"><span class="lineno">  561</span>        global <a class="code hl_variable" href="defs_8php.html#a4281598b07b2ade20b01086ecbd3417e">$MonthNumbers</a>;</div>
<div class="line"><span class="lineno">  562</span>        </div>
<div class="line"><span class="lineno">  563</span>        <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/(\d+)\s+(\d+)/&#39;</span>, $datestr, $match)) {</div>
<div class="line"><span class="lineno">  564</span>            $date[<span class="stringliteral">&#39;Month&#39;</span>]= $match[1];</div>
<div class="line"><span class="lineno">  565</span>            $date[<span class="stringliteral">&#39;Day&#39;</span>]= sprintf(<span class="stringliteral">&#39;%02d&#39;</span>, $match[2]);</div>
<div class="line"><span class="lineno">  566</span>            <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  567</span>        }</div>
<div class="line"><span class="lineno">  568</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/(\w+)\s+(\d+)/&#39;</span>, $datestr, $match)) {</div>
<div class="line"><span class="lineno">  569</span>            <span class="keywordflow">if</span> (array_key_exists($match[1], <a class="code hl_variable" href="defs_8php.html#a4281598b07b2ade20b01086ecbd3417e">$MonthNumbers</a>)) {</div>
<div class="line"><span class="lineno">  570</span>                $date[<span class="stringliteral">&#39;Month&#39;</span>]= <a class="code hl_variable" href="defs_8php.html#a4281598b07b2ade20b01086ecbd3417e">$MonthNumbers</a>[$match[1]];</div>
<div class="line"><span class="lineno">  571</span>                $date[<span class="stringliteral">&#39;Day&#39;</span>]= sprintf(<span class="stringliteral">&#39;%02d&#39;</span>, $match[2]);</div>
<div class="line"><span class="lineno">  572</span>                <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  573</span>            }</div>
<div class="line"><span class="lineno">  574</span>        }</div>
<div class="line"><span class="lineno">  575</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  576</span>    }</div>
<div class="ttc" id="adefs_8php_html_a4281598b07b2ade20b01086ecbd3417e"><div class="ttname"><a href="defs_8php.html#a4281598b07b2ade20b01086ecbd3417e">$MonthNumbers</a></div><div class="ttdeci">$MonthNumbers</div><div class="ttdoc">Used in translating months from string to number.</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00091">defs.php:91</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="defs_8php_source.html#l00091">$MonthNumbers</a>.</p>

</div>
</div>
<a id="af9beeef4a0926b9f2ac3ba6354b8573b" name="af9beeef4a0926b9f2ac3ba6354b8573b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9beeef4a0926b9f2ac3ba6354b8573b">&#9670;&#160;</a></span>FormatLogCols()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FormatLogCols </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$cols</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Post-processes log columns for display. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$cols</td><td>Parsed log line in columns </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classCtlrlogs.html#af9beeef4a0926b9f2ac3ba6354b8573b">Ctlrlogs</a>, <a class="el" href="classHttpd.html#af9beeef4a0926b9f2ac3ba6354b8573b">Httpd</a>, <a class="el" href="classHttpdlogs.html#af9beeef4a0926b9f2ac3ba6354b8573b">Httpdlogs</a>, <a class="el" href="classWuilogs.html#af9beeef4a0926b9f2ac3ba6354b8573b">Wuilogs</a>, and <a class="el" href="classSystem.html#af9beeef4a0926b9f2ac3ba6354b8573b">System</a>.</p>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00634">634</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  635</span>    {</div>
<div class="line"><span class="lineno">  636</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7380caec2969c7c943efab862b724b76" name="a7380caec2969c7c943efab862b724b76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7380caec2969c7c943efab862b724b76">&#9670;&#160;</a></span>getLogLineClass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getLogLineClass </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$cols</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines log line color class. </p>
<p>Keywords are obtained from arrays in $LogConf.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$cols</td><td>Parsed log line </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string Log line color class. </dd></dl>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00601">601</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  602</span>    {</div>
<div class="line"><span class="lineno">  603</span>        global <a class="code hl_variable" href="View_2dhcpd_2include_8php.html#ac8ca37bad560f102f600d5623d11bbb3">$LogConf</a>;</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>        $class= <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  606</span>        <span class="keywordflow">if</span> (array_key_exists(<span class="stringliteral">&#39;Prio&#39;</span>, $cols) &amp;&amp; array_key_exists($cols[<span class="stringliteral">&#39;Prio&#39;</span>], $this-&gt;prioClasses)) {</div>
<div class="line"><span class="lineno">  607</span>            $class= $this-&gt;prioClasses[$cols[<span class="stringliteral">&#39;Prio&#39;</span>]];</div>
<div class="line"><span class="lineno">  608</span>        }</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>        <span class="keywordflow">if</span> (isset(<a class="code hl_variable" href="View_2dhcpd_2include_8php.html#ac8ca37bad560f102f600d5623d11bbb3">$LogConf</a>[$this-&gt;<a class="code hl_namespace" href="namespaceModel.html">Model</a>][<span class="stringliteral">&#39;HighlightLogs&#39;</span>][<span class="stringliteral">&#39;Col&#39;</span>]) &amp;&amp; isset(<a class="code hl_variable" href="View_2dhcpd_2include_8php.html#ac8ca37bad560f102f600d5623d11bbb3">$LogConf</a>[$this-&gt;Model][<span class="stringliteral">&#39;HighlightLogs&#39;</span>][<span class="stringliteral">&#39;REs&#39;</span>])) {</div>
<div class="line"><span class="lineno">  611</span>            <span class="comment">// Make sure the log column exists, log rotation lines do not have module specific columns</span></div>
<div class="line"><span class="lineno">  612</span>            <span class="keywordflow">if</span> (isset($cols[<a class="code hl_variable" href="View_2dhcpd_2include_8php.html#ac8ca37bad560f102f600d5623d11bbb3">$LogConf</a>[$this-&gt;Model][<span class="stringliteral">&#39;HighlightLogs&#39;</span>][<span class="stringliteral">&#39;Col&#39;</span>]])) {</div>
<div class="line"><span class="lineno">  613</span>                <span class="keywordflow">foreach</span> (<a class="code hl_variable" href="View_2dhcpd_2include_8php.html#ac8ca37bad560f102f600d5623d11bbb3">$LogConf</a>[$this-&gt;Model][<span class="stringliteral">&#39;HighlightLogs&#39;</span>][<span class="stringliteral">&#39;REs&#39;</span>] as $color =&gt; $res) {</div>
<div class="line"><span class="lineno">  614</span>                    <span class="keywordflow">foreach</span> ($res as $re) {</div>
<div class="line"><span class="lineno">  615</span>                        <a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>= <a class="code hl_function" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9">Escape</a>($re, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno">  616</span>                        <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&quot;/$r/&quot;</span>, $cols[<a class="code hl_variable" href="View_2dhcpd_2include_8php.html#ac8ca37bad560f102f600d5623d11bbb3">$LogConf</a>[$this-&gt;Model][<span class="stringliteral">&#39;HighlightLogs&#39;</span>][<span class="stringliteral">&#39;Col&#39;</span>]])) {</div>
<div class="line"><span class="lineno">  617</span>                            $class= $color;</div>
<div class="line"><span class="lineno">  618</span>                            <span class="comment">// Exit on first match, i.e. precedence: red, yellow, green</span></div>
<div class="line"><span class="lineno">  619</span>                            <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno">  620</span>                        }</div>
<div class="line"><span class="lineno">  621</span>                    }</div>
<div class="line"><span class="lineno">  622</span>                }</div>
<div class="line"><span class="lineno">  623</span>            }</div>
<div class="line"><span class="lineno">  624</span>        }</div>
<div class="line"><span class="lineno">  625</span>out:</div>
<div class="line"><span class="lineno">  626</span>        <span class="keywordflow">return</span> $class;</div>
<div class="line"><span class="lineno">  627</span>    }</div>
<div class="ttc" id="aView_2dhcpd_2include_8php_html_ac8ca37bad560f102f600d5623d11bbb3"><div class="ttname"><a href="View_2dhcpd_2include_8php.html#ac8ca37bad560f102f600d5623d11bbb3">$LogConf</a></div><div class="ttdeci">$LogConf</div><div class="ttdef"><b>Definition:</b> <a href="View_2dhcpd_2include_8php_source.html#l00050">include.php:50</a></div></div>
<div class="ttc" id="aconfigtest_8php_html_a8abe176bc41afd728f32ba8c506cbd98"><div class="ttname"><a href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a></div><div class="ttdeci">$r</div><div class="ttdef"><b>Definition:</b> <a href="configtest_8php_source.html#l00066">configtest.php:66</a></div></div>
<div class="ttc" id="alib_2lib_8php_html_a998c26d78939d233b87794689e841eb9"><div class="ttname"><a href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9">Escape</a></div><div class="ttdeci">Escape($str, $chars, $no_double_escapes=TRUE)</div><div class="ttdoc">Escapes chars.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2lib_8php_source.html#l00080">lib.php:80</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="View_2dhcpd_2include_8php_source.html#l00050">$LogConf</a>, <a class="el" href="configtest_8php_source.html#l00066">$r</a>, and <a class="el" href="lib_2lib_8php_source.html#l00080">Escape()</a>.</p>

<p class="reference">Referenced by <a class="el" href="view_8php_source.html#l00585">PrintLogLine()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_a7380caec2969c7c943efab862b724b76_cgraph.png" border="0" usemap="#aclassView_a7380caec2969c7c943efab862b724b76_cgraph" alt=""/></div>
<map name="aclassView_a7380caec2969c7c943efab862b724b76_cgraph" id="aclassView_a7380caec2969c7c943efab862b724b76_cgraph">
<area shape="rect" title="Determines log line color class." alt="" coords="5,5,133,31"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="181,5,249,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_a7380caec2969c7c943efab862b724b76_icgraph.png" border="0" usemap="#aclassView_a7380caec2969c7c943efab862b724b76_icgraph" alt=""/></div>
<map name="aclassView_a7380caec2969c7c943efab862b724b76_icgraph" id="aclassView_a7380caec2969c7c943efab862b724b76_icgraph">
<area shape="rect" title="Determines log line color class." alt="" coords="156,5,284,31"/>
<area shape="rect" href="classView.html#a014cbcd14acae8d018129f8030d441d9" title="Generic parser, highlighter, and printer for the log line." alt="" coords="5,5,108,31"/>
</map>
</div>

</div>
</div>
<a id="aa6f7c1b683220834feaa1ae071e577d6" name="aa6f7c1b683220834feaa1ae071e577d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6f7c1b683220834feaa1ae071e577d6">&#9670;&#160;</a></span>IsDateRange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IsDateRange </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$date</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the date array contains a range, meaning an empty string. </p>
<p>Assumes standard syslog date format for the output string.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$date</td><td>Datetime struct. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE if a range. </dd></dl>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00525">525</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  526</span>    {</div>
<div class="line"><span class="lineno">  527</span>        <span class="keywordflow">return</span> ($date[<span class="stringliteral">&#39;Month&#39;</span>] == <span class="stringliteral">&#39;&#39;</span>) || ($date[<span class="stringliteral">&#39;Day&#39;</span>] == <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><span class="lineno">  528</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a014cbcd14acae8d018129f8030d441d9" name="a014cbcd14acae8d018129f8030d441d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a014cbcd14acae8d018129f8030d441d9">&#9670;&#160;</a></span>PrintLogLine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PrintLogLine </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$cols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$linenum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$lastlinenum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generic parser, highlighter, and printer for the log line. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$cols</td><td>Parsed log line </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$linenum</td><td>Line number of the log line </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$lastlinenum</td><td>Last line number, used to detect the last line </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00585">585</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  586</span>    {</div>
<div class="line"><span class="lineno">  587</span>        global <a class="code hl_variable" href="View_2dhcpd_2include_8php.html#ac8ca37bad560f102f600d5623d11bbb3">$LogConf</a>;</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span>        $class= $this-&gt;getLogLineClass($cols);</div>
<div class="line"><span class="lineno">  590</span>        <a class="code hl_function" href="libwui_8php.html#aab3036c36bc1cf224c89a6a1fb775728">PrintLogCols</a>($linenum, $cols, $lastlinenum, $class);</div>
<div class="line"><span class="lineno">  591</span>    }</div>
<div class="ttc" id="alibwui_8php_html_aab3036c36bc1cf224c89a6a1fb775728"><div class="ttname"><a href="libwui_8php.html#aab3036c36bc1cf224c89a6a1fb775728">PrintLogCols</a></div><div class="ttdeci">PrintLogCols($linenum, $cols, $lastlinenum=-1, $class='', $module='')</div><div class="ttdoc">Displays log fields in columns.</div><div class="ttdef"><b>Definition:</b> <a href="libwui_8php_source.html#l01319">libwui.php:1319</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="View_2dhcpd_2include_8php_source.html#l00050">$LogConf</a>, <a class="el" href="view_8php_source.html#l00601">getLogLineClass()</a>, and <a class="el" href="libwui_8php_source.html#l01319">PrintLogCols()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_a014cbcd14acae8d018129f8030d441d9_cgraph.png" border="0" usemap="#aclassView_a014cbcd14acae8d018129f8030d441d9_cgraph" alt=""/></div>
<map name="aclassView_a014cbcd14acae8d018129f8030d441d9_cgraph" id="aclassView_a014cbcd14acae8d018129f8030d441d9_cgraph">
<area shape="rect" title="Generic parser, highlighter, and printer for the log line." alt="" coords="5,31,108,56"/>
<area shape="rect" href="classView.html#a7380caec2969c7c943efab862b724b76" title="Determines log line color class." alt="" coords="156,5,284,31"/>
<area shape="rect" href="libwui_8php.html#aab3036c36bc1cf224c89a6a1fb775728" title="Displays log fields in columns." alt="" coords="169,55,271,80"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="332,5,400,31"/>
</map>
</div>

</div>
</div>
<a id="ab01dd9990a4e547d5519dd0d9174fdb7" name="ab01dd9990a4e547d5519dd0d9174fdb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab01dd9990a4e547d5519dd0d9174fdb7">&#9670;&#160;</a></span>PrintProcessTable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PrintProcessTable </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$printcount</em> = <code>FALSE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets and lists processes for daemons/services. </p>
<p>Used on module status pages. Perl processes are hard to list. </p><dl class="section warning"><dt>Warning</dt><dd>Spaces in $output lines were replaced by |'s elsewhere.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$output</td><td>ps output, modified by SelectProcesses(). </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$printcount</td><td>Whether to print process count at top. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00388">388</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  389</span>    {</div>
<div class="line"><span class="lineno">  390</span>        $total= count($output);</div>
<div class="line"><span class="lineno">  391</span>        <span class="keywordflow">if</span> ($total &gt; 0) {</div>
<div class="line"><span class="lineno">  392</span>            <span class="keywordflow">if</span> ($printcount) {</div>
<div class="line"><span class="lineno">  393</span>                echo <a class="code hl_function" href="defs_8php.html#a76b8877d5a35c08959e2609908c669b6">_TITLE</a>(<span class="stringliteral">&#39;Number of processes&#39;</span>).<span class="stringliteral">&#39;: &#39;</span>.$total;</div>
<div class="line"><span class="lineno">  394</span>            }</div>
<div class="line"><span class="lineno">  395</span>            ?&gt;</div>
<div class="line"><span class="lineno">  396</span>            &lt;table <span class="keywordtype">id</span>=<span class="stringliteral">&quot;logline&quot;</span>&gt;</div>
<div class="line"><span class="lineno">  397</span>                &lt;?php</div>
<div class="line"><span class="lineno">  398</span>                $this-&gt;PrintProcessTableHeader();</div>
<div class="line"><span class="lineno">  399</span>                $linenum= 0;</div>
<div class="line"><span class="lineno">  400</span>                <span class="keywordflow">foreach</span> ($output as $cols) {</div>
<div class="line"><span class="lineno">  401</span>                    $rowClass= ($linenum++ % 2 == 0) ? <span class="stringliteral">&#39;evenline&#39;</span> : <span class="stringliteral">&#39;oddline&#39;</span>;</div>
<div class="line"><span class="lineno">  402</span>                    $lastLine= $linenum == $total;</div>
<div class="line"><span class="lineno">  403</span>                    ?&gt;</div>
<div class="line"><span class="lineno">  404</span>                    &lt;tr&gt;</div>
<div class="line"><span class="lineno">  405</span>                        &lt;?php</div>
<div class="line"><span class="lineno">  406</span>                        $totalCols= count($cols);</div>
<div class="line"><span class="lineno">  407</span>                        $count= 1;</div>
<div class="line"><span class="lineno">  408</span>                        <span class="keywordflow">foreach</span> ($cols as $c) {</div>
<div class="line"><span class="lineno">  409</span>                            $cellClass= $rowClass;</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>                            <span class="keywordflow">if</span> ($lastLine) {</div>
<div class="line"><span class="lineno">  412</span>                                <span class="keywordflow">if</span> ($count == 1) {</div>
<div class="line"><span class="lineno">  413</span>                                    $cellClass.= <span class="stringliteral">&#39; lastLineFirstCell&#39;</span>;</div>
<div class="line"><span class="lineno">  414</span>                                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($count == $totalCols) {</div>
<div class="line"><span class="lineno">  415</span>                                    $cellClass.= <span class="stringliteral">&#39; lastLineLastCell&#39;</span>;</div>
<div class="line"><span class="lineno">  416</span>                                }</div>
<div class="line"><span class="lineno">  417</span>                            }</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>                            <span class="keywordflow">if</span> (in_array($count, array(8, 11, 12, 13))) {</div>
<div class="line"><span class="lineno">  420</span>                                <span class="comment">// Left align stat, user, group, and command columns</span></div>
<div class="line"><span class="lineno">  421</span>                                $cellClass.= <span class="stringliteral">&#39; left&#39;</span>;</div>
<div class="line"><span class="lineno">  422</span>                            }</div>
<div class="line"><span class="lineno">  423</span>                            ?&gt;</div>
<div class="line"><span class="lineno">  424</span>                            &lt;td <span class="keyword">class</span>=<span class="stringliteral">&quot;&lt;?php echo $cellClass ?&gt;&quot;</span>&gt;</div>
<div class="line"><span class="lineno">  425</span>                                &lt;?php echo $c ?&gt;</div>
<div class="line"><span class="lineno">  426</span>                            &lt;/td&gt;</div>
<div class="line"><span class="lineno">  427</span>                            &lt;?php</div>
<div class="line"><span class="lineno">  428</span>                            $count++;</div>
<div class="line"><span class="lineno">  429</span>                        }</div>
<div class="line"><span class="lineno">  430</span>                        ?&gt;</div>
<div class="line"><span class="lineno">  431</span>                    &lt;/tr&gt;</div>
<div class="line"><span class="lineno">  432</span>                    &lt;?php</div>
<div class="line"><span class="lineno">  433</span>                }</div>
<div class="line"><span class="lineno">  434</span>                ?&gt;</div>
<div class="line"><span class="lineno">  435</span>            &lt;/table&gt;</div>
<div class="line"><span class="lineno">  436</span>            &lt;?php</div>
<div class="line"><span class="lineno">  437</span>        }</div>
<div class="line"><span class="lineno">  438</span>    }</div>
<div class="ttc" id="adefs_8php_html_a76b8877d5a35c08959e2609908c669b6"><div class="ttname"><a href="defs_8php.html#a76b8877d5a35c08959e2609908c669b6">_TITLE</a></div><div class="ttdeci">_TITLE($str)</div><div class="ttdoc">For classifying gettext strings into files.</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00402">defs.php:402</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="defs_8php_source.html#l00402">_TITLE()</a>, and <a class="el" href="view_8php_source.html#l00445">PrintProcessTableHeader()</a>.</p>

<p class="reference">Referenced by <a class="el" href="view_8php_source.html#l00290">PrintStatusForm()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_ab01dd9990a4e547d5519dd0d9174fdb7_cgraph.png" border="0" usemap="#aclassView_ab01dd9990a4e547d5519dd0d9174fdb7_cgraph" alt=""/></div>
<map name="aclassView_ab01dd9990a4e547d5519dd0d9174fdb7_cgraph" id="aclassView_ab01dd9990a4e547d5519dd0d9174fdb7_cgraph">
<area shape="rect" title="Gets and lists processes for daemons/services." alt="" coords="5,31,141,56"/>
<area shape="rect" href="defs_8php.html#a76b8877d5a35c08959e2609908c669b6" title="For classifying gettext strings into files." alt="" coords="249,5,313,31"/>
<area shape="rect" href="classView.html#abb2db63abb2379f6fa3bfe17f4975d42" title="Prints headers for processes table." alt="" coords="189,55,372,80"/>
<area shape="rect" href="view_8php.html#ab4da5c8117f5ef7afe6fdfeb41764bac" title="For classifying gettext strings into files." alt="" coords="420,55,492,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_ab01dd9990a4e547d5519dd0d9174fdb7_icgraph.png" border="0" usemap="#aclassView_ab01dd9990a4e547d5519dd0d9174fdb7_icgraph" alt=""/></div>
<map name="aclassView_ab01dd9990a4e547d5519dd0d9174fdb7_icgraph" id="aclassView_ab01dd9990a4e547d5519dd0d9174fdb7_icgraph">
<area shape="rect" title="Gets and lists processes for daemons/services." alt="" coords="180,5,316,31"/>
<area shape="rect" href="classView.html#ac66492e0af705fe63013ec18a7a9fa15" title="Displays module status, software version, Restart/Stop buttons, and process table." alt="" coords="5,5,132,31"/>
</map>
</div>

</div>
</div>
<a id="abb2db63abb2379f6fa3bfe17f4975d42" name="abb2db63abb2379f6fa3bfe17f4975d42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb2db63abb2379f6fa3bfe17f4975d42">&#9670;&#160;</a></span>PrintProcessTableHeader()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PrintProcessTableHeader </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints headers for processes table. </p>
<p>PID STAT CPU TIME MEM RSS VSZ STARTED PRI NI USER COMMAND </p>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00445">445</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  446</span>    {</div>
<div class="line"><span class="lineno">  447</span>        ?&gt;</div>
<div class="line"><span class="lineno">  448</span>        &lt;tr <span class="keywordtype">id</span>=<span class="stringliteral">&quot;logline&quot;</span>&gt;</div>
<div class="line"><span class="lineno">  449</span>            &lt;th&gt;&lt;?php echo _(<span class="stringliteral">&#39;PID&#39;</span>) ?&gt;&lt;/th&gt;</div>
<div class="line"><span class="lineno">  450</span>            &lt;th&gt;&lt;?php echo <a class="code hl_function" href="view_8php.html#ab4da5c8117f5ef7afe6fdfeb41764bac">_TITLE2</a>(<span class="stringliteral">&#39;STARTED&#39;</span>) ?&gt;&lt;/th&gt;</div>
<div class="line"><span class="lineno">  451</span>            &lt;th&gt;&lt;?php echo _(<span class="stringliteral">&#39;%CPU&#39;</span>) ?&gt;&lt;/th&gt;</div>
<div class="line"><span class="lineno">  452</span>            &lt;th&gt;&lt;?php echo <a class="code hl_function" href="view_8php.html#ab4da5c8117f5ef7afe6fdfeb41764bac">_TITLE2</a>(<span class="stringliteral">&#39;TIME&#39;</span>) ?&gt;&lt;/th&gt;</div>
<div class="line"><span class="lineno">  453</span>            &lt;th&gt;&lt;?php echo <a class="code hl_function" href="view_8php.html#ab4da5c8117f5ef7afe6fdfeb41764bac">_TITLE2</a>(<span class="stringliteral">&#39;%MEM&#39;</span>) ?&gt;&lt;/th&gt;</div>
<div class="line"><span class="lineno">  454</span>            &lt;th&gt;&lt;?php echo _(<span class="stringliteral">&#39;RSS&#39;</span>) ?&gt;&lt;/th&gt;</div>
<div class="line"><span class="lineno">  455</span>            &lt;th&gt;&lt;?php echo _(<span class="stringliteral">&#39;VSZ&#39;</span>) ?&gt;&lt;/th&gt;</div>
<div class="line"><span class="lineno">  456</span>            &lt;th&gt;&lt;?php echo _(<span class="stringliteral">&#39;STAT&#39;</span>) ?&gt;&lt;/th&gt;</div>
<div class="line"><span class="lineno">  457</span>            &lt;th&gt;&lt;?php echo <a class="code hl_function" href="view_8php.html#ab4da5c8117f5ef7afe6fdfeb41764bac">_TITLE2</a>(<span class="stringliteral">&#39;PRI&#39;</span>) ?&gt;&lt;/th&gt;</div>
<div class="line"><span class="lineno">  458</span>            &lt;th&gt;&lt;?php echo _(<span class="stringliteral">&#39;NI&#39;</span>) ?&gt;&lt;/th&gt;</div>
<div class="line"><span class="lineno">  459</span>            &lt;th&gt;&lt;?php echo <a class="code hl_function" href="view_8php.html#ab4da5c8117f5ef7afe6fdfeb41764bac">_TITLE2</a>(<span class="stringliteral">&#39;USER&#39;</span>) ?&gt;&lt;/th&gt;</div>
<div class="line"><span class="lineno">  460</span>            &lt;th&gt;&lt;?php echo <a class="code hl_function" href="view_8php.html#ab4da5c8117f5ef7afe6fdfeb41764bac">_TITLE2</a>(<span class="stringliteral">&#39;GROUP&#39;</span>) ?&gt;&lt;/th&gt;</div>
<div class="line"><span class="lineno">  461</span>            &lt;th&gt;&lt;?php echo <a class="code hl_function" href="view_8php.html#ab4da5c8117f5ef7afe6fdfeb41764bac">_TITLE2</a>(<span class="stringliteral">&#39;COMMAND&#39;</span>) ?&gt;&lt;/th&gt;</div>
<div class="line"><span class="lineno">  462</span>        &lt;/tr&gt;</div>
<div class="line"><span class="lineno">  463</span>        &lt;?php</div>
<div class="line"><span class="lineno">  464</span>    }</div>
<div class="ttc" id="aview_8php_html_ab4da5c8117f5ef7afe6fdfeb41764bac"><div class="ttname"><a href="view_8php.html#ab4da5c8117f5ef7afe6fdfeb41764bac">_TITLE2</a></div><div class="ttdeci">_TITLE2($str)</div><div class="ttdoc">For classifying gettext strings into files.</div><div class="ttdef"><b>Definition:</b> <a href="view_8php_source.html#l00674">view.php:674</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="view_8php_source.html#l00674">_TITLE2()</a>.</p>

<p class="reference">Referenced by <a class="el" href="view_8php_source.html#l00388">PrintProcessTable()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_abb2db63abb2379f6fa3bfe17f4975d42_cgraph.png" border="0" usemap="#aclassView_abb2db63abb2379f6fa3bfe17f4975d42_cgraph" alt=""/></div>
<map name="aclassView_abb2db63abb2379f6fa3bfe17f4975d42_cgraph" id="aclassView_abb2db63abb2379f6fa3bfe17f4975d42_cgraph">
<area shape="rect" title="Prints headers for processes table." alt="" coords="5,5,188,31"/>
<area shape="rect" href="view_8php.html#ab4da5c8117f5ef7afe6fdfeb41764bac" title="For classifying gettext strings into files." alt="" coords="236,5,308,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_abb2db63abb2379f6fa3bfe17f4975d42_icgraph.png" border="0" usemap="#aclassView_abb2db63abb2379f6fa3bfe17f4975d42_icgraph" alt=""/></div>
<map name="aclassView_abb2db63abb2379f6fa3bfe17f4975d42_icgraph" id="aclassView_abb2db63abb2379f6fa3bfe17f4975d42_icgraph">
<area shape="rect" title="Prints headers for processes table." alt="" coords="364,5,547,31"/>
<area shape="rect" href="classView.html#ab01dd9990a4e547d5519dd0d9174fdb7" title="Gets and lists processes for daemons/services." alt="" coords="180,5,316,31"/>
<area shape="rect" href="classView.html#ac66492e0af705fe63013ec18a7a9fa15" title="Displays module status, software version, Restart/Stop buttons, and process table." alt="" coords="5,5,132,31"/>
</map>
</div>

</div>
</div>
<a id="a2b7b8e472e1742ee0be6390ae6c85670" name="a2b7b8e472e1742ee0be6390ae6c85670"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b7b8e472e1742ee0be6390ae6c85670">&#9670;&#160;</a></span>PrintStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PrintStats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em> = <code>''</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints general text statistics. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Log file if different from the one in $LogConf </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00507">507</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  508</span>    {</div>
<div class="line"><span class="lineno">  509</span>        <span class="keywordflow">if</span> ($file !== FALSE &amp;&amp; $this-&gt;Controller($output, <span class="stringliteral">&#39;GetProcStatLines&#39;</span>, $file)) {</div>
<div class="line"><span class="lineno">  510</span>            $stats= json_decode($output[0], TRUE);</div>
<div class="line"><span class="lineno">  511</span>            <span class="keywordflow">if</span> ($stats !== NULL &amp;&amp; is_array($stats)) {</div>
<div class="line"><span class="lineno">  512</span>                <a class="code hl_function" href="libwui_8php.html#a6d4c1e9983abb0c2314dff0b6cca6b28">PrintNVPs</a>($stats, <a class="code hl_function" href="defs_8php.html#a868aa11bbb5e5604585592e1e1c21271">_STATS</a>(<span class="stringliteral">&#39;General Statistics&#39;</span>), 50, FALSE, FALSE);</div>
<div class="line"><span class="lineno">  513</span>            }</div>
<div class="line"><span class="lineno">  514</span>        }</div>
<div class="line"><span class="lineno">  515</span>    }</div>
<div class="ttc" id="adefs_8php_html_a868aa11bbb5e5604585592e1e1c21271"><div class="ttname"><a href="defs_8php.html#a868aa11bbb5e5604585592e1e1c21271">_STATS</a></div><div class="ttdeci">_STATS($str)</div><div class="ttdoc">For classifying gettext strings into files.</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00163">defs.php:163</a></div></div>
<div class="ttc" id="alibwui_8php_html_a6d4c1e9983abb0c2314dff0b6cca6b28"><div class="ttname"><a href="libwui_8php.html#a6d4c1e9983abb0c2314dff0b6cca6b28">PrintNVPs</a></div><div class="ttdeci">PrintNVPs($nvps, $title, $maxcount=100, $pie=TRUE, $needle='', $prefix='', $postfix='', $dateArray=array(), $logFile='')</div><div class="ttdoc">Prints NVP statistics.</div><div class="ttdef"><b>Definition:</b> <a href="libwui_8php_source.html#l00517">libwui.php:517</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="defs_8php_source.html#l00163">_STATS()</a>, <a class="el" href="view_8php_source.html#l00074">Controller()</a>, and <a class="el" href="libwui_8php_source.html#l00517">PrintNVPs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_a2b7b8e472e1742ee0be6390ae6c85670_cgraph.png" border="0" usemap="#aclassView_a2b7b8e472e1742ee0be6390ae6c85670_cgraph" alt=""/></div>
<map name="aclassView_a2b7b8e472e1742ee0be6390ae6c85670_cgraph" id="aclassView_a2b7b8e472e1742ee0be6390ae6c85670_cgraph">
<area shape="rect" title="Prints general text statistics." alt="" coords="5,55,91,80"/>
<area shape="rect" href="defs_8php.html#a868aa11bbb5e5604585592e1e1c21271" title="For classifying gettext strings into files." alt="" coords="148,5,216,31"/>
<area shape="rect" href="classView.html#a523ddd51e800ca8c2c56854c85cb312f" title="Calls the controller." alt="" coords="139,55,225,80"/>
<area shape="rect" href="libwui_8php.html#a6d4c1e9983abb0c2314dff0b6cca6b28" title="Prints NVP statistics." alt="" coords="139,104,225,129"/>
<area shape="rect" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4" title="Satisfies Controller." alt="" coords="273,31,408,56"/>
<area shape="rect" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769" title="Wrapper for syslog()." alt="" coords="293,80,388,105"/>
</map>
</div>

</div>
</div>
<a id="ac66492e0af705fe63013ec18a7a9fa15" name="ac66492e0af705fe63013ec18a7a9fa15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac66492e0af705fe63013ec18a7a9fa15">&#9670;&#160;</a></span>PrintStatusForm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PrintStatusForm </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$generate_status</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$printcount</em> = <code>FALSE</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$showbuttons</em> = <code>TRUE</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$printprocs</em> = <code>TRUE</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$showrestartbutton</em> = <code>FALSE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Displays module status, software version, Restart/Stop buttons, and process table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">boolean</td><td class="paramname">$generate_status</td><td>Force generate module status, do not use cached status, necessary after process start/stop </td></tr>
    <tr><td class="paramtype">boolean</td><td class="paramname">$printcount</td><td>Whether to print number of running processes too </td></tr>
    <tr><td class="paramtype">boolean</td><td class="paramname">$showbuttons</td><td>Show Start/Stop buttons </td></tr>
    <tr><td class="paramtype">boolean</td><td class="paramname">$printprocs</td><td>Whether to print the process table </td></tr>
    <tr><td class="paramtype">boolean</td><td class="paramname">$showrestartbutton</td><td>Show Restart button, for <a class="el" href="classSystem.html">System</a> Info page </td></tr>
  </table>
  </dd>
</dl>
<p>Only admin can start/stop the processes</p>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00290">290</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  291</span>    {</div>
<div class="line"><span class="lineno">  292</span>        global <a class="code hl_variable" href="vars_8php.html#a2a733b91f319f70f5374bda816975ab5">$IMG_PATH</a>, <a class="code hl_variable" href="defs_8php.html#a93ea0868f01185b3c7915c2aff955f17">$ADMIN</a>, <a class="code hl_variable" href="vars_8php.html#aaf14c49b6f5800a3c7a2b820404cf974">$Status2Images</a>, <a class="code hl_variable" href="vars_8php.html#a997e7be64a8e7eebb5381685d03e154f">$StatusTitles</a>;</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>        $this-&gt;Controller($output, <span class="stringliteral">&#39;GetModuleStatus&#39;</span>, <a class="code hl_variable" href="View_2dhcpd_2dhcpd_8php.html#a83b72400c2ac339d288cdb20cd46a341">$generate_status</a>);</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>        $status= json_decode($output[0], TRUE);</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>        $running= $status[<span class="stringliteral">&#39;Status&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>;</div>
<div class="line"><span class="lineno">  299</span>        $imgfile= <a class="code hl_variable" href="vars_8php.html#aaf14c49b6f5800a3c7a2b820404cf974">$Status2Images</a>[$status[<span class="stringliteral">&#39;Status&#39;</span>]];</div>
<div class="line"><span class="lineno">  300</span>        <span class="keywordflow">if</span> ($running) {</div>
<div class="line"><span class="lineno">  301</span>            $name= <span class="stringliteral">&#39;Running&#39;</span>;</div>
<div class="line"><span class="lineno">  302</span>            $info= <a class="code hl_function" href="defs_8php.html#a76b8877d5a35c08959e2609908c669b6">_TITLE</a>(<span class="stringliteral">&#39;is running&#39;</span>);</div>
<div class="line"><span class="lineno">  303</span>            $confirm= <a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;Are you sure you want to stop the &lt;NAME&gt;?&#39;</span>);</div>
<div class="line"><span class="lineno">  304</span>            <span class="keywordflow">if</span> ($showbuttons) {</div>
<div class="line"><span class="lineno">  305</span>                $button= <span class="stringliteral">&#39;Stop&#39;</span>;</div>
<div class="line"><span class="lineno">  306</span>            }</div>
<div class="line"><span class="lineno">  307</span>        }</div>
<div class="line"><span class="lineno">  308</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  309</span>            $name= <span class="stringliteral">&#39;Stopped&#39;</span>;</div>
<div class="line"><span class="lineno">  310</span>            $info= <a class="code hl_function" href="defs_8php.html#a76b8877d5a35c08959e2609908c669b6">_TITLE</a>(<span class="stringliteral">&#39;is not running&#39;</span>);</div>
<div class="line"><span class="lineno">  311</span>            $confirm= <a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;Are you sure you want to start the &lt;NAME&gt;?&#39;</span>);</div>
<div class="line"><span class="lineno">  312</span>            <span class="keywordflow">if</span> ($showbuttons) {</div>
<div class="line"><span class="lineno">  313</span>                $button= <span class="stringliteral">&#39;Start&#39;</span>;</div>
<div class="line"><span class="lineno">  314</span>            }</div>
<div class="line"><span class="lineno">  315</span>        }</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>        $errorStatus= $status[<span class="stringliteral">&#39;ErrorStatus&#39;</span>];</div>
<div class="line"><span class="lineno">  318</span>        $errorImgfile= <a class="code hl_variable" href="vars_8php.html#aaf14c49b6f5800a3c7a2b820404cf974">$Status2Images</a>[$errorStatus];</div>
<div class="line"><span class="lineno">  319</span>        $errorInfo= <a class="code hl_variable" href="vars_8php.html#a997e7be64a8e7eebb5381685d03e154f">$StatusTitles</a>[$errorStatus];</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>        $confirm= preg_replace(<span class="stringliteral">&#39;/&lt;NAME&gt;/&#39;</span>, $this-&gt;<a class="code hl_variable" href="monitoring_2info_8php.html#a2f596a20a29b568cb41da30759c97fbf">Caption</a>, $confirm);</div>
<div class="line"><span class="lineno">  322</span>        ?&gt;</div>
<div class="line"><span class="lineno">  323</span>        &lt;table <span class="keywordtype">id</span>=<span class="stringliteral">&quot;status&quot;</span>&gt;</div>
<div class="line"><span class="lineno">  324</span>            &lt;tr&gt;</div>
<div class="line"><span class="lineno">  325</span>                &lt;td <span class="keyword">class</span>=<span class="stringliteral">&quot;image&quot;</span>&gt;</div>
<div class="line"><span class="lineno">  326</span>                    &lt;img src=<span class="stringliteral">&quot;&lt;?php echo $IMG_PATH.$imgfile ?&gt;&quot;</span> name=<span class="stringliteral">&quot;&lt;?php echo $name ?&gt;&quot;</span> alt=<span class="stringliteral">&quot;&lt;?php echo $name ?&gt;&quot;</span> border=<span class="stringliteral">&quot;0&quot;</span> title=<span class="stringliteral">&quot;&lt;?php echo $name ?&gt;&quot;</span>&gt;</div>
<div class="line"><span class="lineno">  327</span>                &lt;/td&gt;</div>
<div class="line"><span class="lineno">  328</span>                &lt;td <span class="keyword">class</span>=<span class="stringliteral">&quot;image&quot;</span>&gt;</div>
<div class="line"><span class="lineno">  329</span>                    &lt;img src=<span class="stringliteral">&quot;&lt;?php echo $IMG_PATH.$errorImgfile ?&gt;&quot;</span> name=<span class="stringliteral">&quot;&lt;?php echo $errorInfo ?&gt;&quot;</span> alt=<span class="stringliteral">&quot;&lt;?php echo $errorInfo ?&gt;&quot;</span> border=<span class="stringliteral">&quot;0&quot;</span> title=<span class="stringliteral">&quot;&lt;?php echo $errorInfo ?&gt;&quot;</span>&gt;</div>
<div class="line"><span class="lineno">  330</span>                &lt;/td&gt;</div>
<div class="line"><span class="lineno">  331</span>                &lt;td&gt;</div>
<div class="line"><span class="lineno">  332</span>                    &lt;form action=<span class="stringliteral">&quot;&lt;?php echo $_SERVER[&#39;PHP_SELF&#39;] ?&gt;&quot;</span> method=<span class="stringliteral">&quot;post&quot;</span>&gt;</div>
<div class="line"><span class="lineno">  333</span>                        &lt;strong&gt;&lt;?php echo $this-&gt;<a class="code hl_variable" href="monitoring_2info_8php.html#a2f596a20a29b568cb41da30759c97fbf">Caption</a> . <span class="stringliteral">&quot; $info &quot;</span> ?&gt;&lt;/strong&gt;</div>
<div class="line"><span class="lineno">  334</span>                        &lt;?php</div>
<div class="line"><span class="lineno">  336</span>                        <span class="keywordflow">if</span> (in_array(<a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;USER&#39;</span>], <a class="code hl_variable" href="defs_8php.html#a93ea0868f01185b3c7915c2aff955f17">$ADMIN</a>)) {</div>
<div class="line"><span class="lineno">  337</span>                            <span class="keywordflow">if</span> (isset($button)) {</div>
<div class="line"><span class="lineno">  338</span>                                ?&gt;</div>
<div class="line"><span class="lineno">  339</span>                                &lt;input type=<span class="stringliteral">&quot;submit&quot;</span> name=<span class="stringliteral">&quot;&lt;?php echo $button ?&gt;&quot;</span> value=<span class="stringliteral">&quot;&lt;?php echo _($button) ?&gt;&quot;</span> onclick=<span class="stringliteral">&quot;return confirm(&#39;&lt;?php echo $confirm ?&gt;&#39;)&quot;</span>/&gt;</div>
<div class="line"><span class="lineno">  340</span>                                &lt;?php</div>
<div class="line"><span class="lineno">  341</span>                            }</div>
<div class="line"><span class="lineno">  342</span>                            <span class="keywordflow">if</span> ($showrestartbutton) {</div>
<div class="line"><span class="lineno">  343</span>                                $restartConfirm= <a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;Are you sure you want to restart the &lt;NAME&gt;?&#39;</span>);</div>
<div class="line"><span class="lineno">  344</span>                                $restartConfirm= preg_replace(<span class="stringliteral">&#39;/&lt;NAME&gt;/&#39;</span>, $this-&gt;<a class="code hl_variable" href="monitoring_2info_8php.html#a2f596a20a29b568cb41da30759c97fbf">Caption</a>, $restartConfirm);</div>
<div class="line"><span class="lineno">  345</span>                                ?&gt;</div>
<div class="line"><span class="lineno">  346</span>                                &lt;input type=<span class="stringliteral">&quot;submit&quot;</span> name=<span class="stringliteral">&quot;Restart&quot;</span> value=<span class="stringliteral">&quot;&lt;?php echo _CONTROL(&#39;Restart&#39;) ?&gt;&quot;</span> onclick=<span class="stringliteral">&quot;return confirm(&#39;&lt;?php echo $restartConfirm ?&gt;&#39;)&quot;</span>/&gt;</div>
<div class="line"><span class="lineno">  347</span>                                &lt;?php</div>
<div class="line"><span class="lineno">  348</span>                            }</div>
<div class="line"><span class="lineno">  349</span>                        }</div>
<div class="line"><span class="lineno">  350</span>                        ?&gt;</div>
<div class="line"><span class="lineno">  351</span>                        &lt;input type=<span class="stringliteral">&quot;hidden&quot;</span> name=<span class="stringliteral">&quot;Model&quot;</span> value=&lt;?php echo $this-&gt;<a class="code hl_namespace" href="namespaceModel.html">Model</a> ?&gt; /&gt;</div>
<div class="line"><span class="lineno">  352</span>                    &lt;/form&gt;</div>
<div class="line"><span class="lineno">  353</span>                &lt;/td&gt;</div>
<div class="line"><span class="lineno">  354</span>                &lt;?php</div>
<div class="line"><span class="lineno">  355</span>                <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classView.html#a523ddd51e800ca8c2c56854c85cb312f">Controller</a>($output, <span class="stringliteral">&#39;GetVersion&#39;</span>)) {</div>
<div class="line"><span class="lineno">  356</span>                    ?&gt;</div>
<div class="line"><span class="lineno">  357</span>                    &lt;td <span class="keyword">class</span>=<span class="stringliteral">&quot;version&quot;</span>&gt;</div>
<div class="line"><span class="lineno">  358</span>                        &lt;strong&gt;&lt;?php echo <a class="code hl_function" href="defs_8php.html#a76b8877d5a35c08959e2609908c669b6">_TITLE</a>(<span class="stringliteral">&#39;Software Version&#39;</span>) ?&gt;&lt;/strong&gt;</div>
<div class="line"><span class="lineno">  359</span>                        &lt;?php</div>
<div class="line"><span class="lineno">  360</span>                        <span class="keywordflow">foreach</span> ($output as $line) {</div>
<div class="line"><span class="lineno">  361</span>                            echo <span class="stringliteral">&#39;&lt;br /&gt;&#39;</span>.$line;</div>
<div class="line"><span class="lineno">  362</span>                        }</div>
<div class="line"><span class="lineno">  363</span>                        ?&gt;</div>
<div class="line"><span class="lineno">  364</span>                    &lt;/td&gt;</div>
<div class="line"><span class="lineno">  365</span>                    &lt;?php</div>
<div class="line"><span class="lineno">  366</span>                }</div>
<div class="line"><span class="lineno">  367</span>                ?&gt;</div>
<div class="line"><span class="lineno">  368</span>            &lt;/tr&gt;</div>
<div class="line"><span class="lineno">  369</span>        &lt;/table&gt;</div>
<div class="line"><span class="lineno">  370</span>        &lt;?php</div>
<div class="line"><span class="lineno">  371</span>        <span class="keywordflow">if</span> ($running &amp;&amp; $printprocs) {</div>
<div class="line"><span class="lineno">  372</span>            <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classView.html#a523ddd51e800ca8c2c56854c85cb312f">Controller</a>($output, <span class="stringliteral">&#39;GetProcList&#39;</span>)) {</div>
<div class="line"><span class="lineno">  373</span>                $this-&gt;<a class="code hl_function" href="classView.html#ab01dd9990a4e547d5519dd0d9174fdb7">PrintProcessTable</a>(json_decode($output[0], TRUE), $printcount);</div>
<div class="line"><span class="lineno">  374</span>            }</div>
<div class="line"><span class="lineno">  375</span>        }</div>
<div class="line"><span class="lineno">  376</span>    }</div>
<div class="ttc" id="aView_2dhcpd_2dhcpd_8php_html_a83b72400c2ac339d288cdb20cd46a341"><div class="ttname"><a href="View_2dhcpd_2dhcpd_8php.html#a83b72400c2ac339d288cdb20cd46a341">$generate_status</a></div><div class="ttdeci">$generate_status</div><div class="ttdef"><b>Definition:</b> <a href="View_2dhcpd_2dhcpd_8php_source.html#l00025">dhcpd.php:25</a></div></div>
<div class="ttc" id="aclassView_html_a523ddd51e800ca8c2c56854c85cb312f"><div class="ttname"><a href="classView.html#a523ddd51e800ca8c2c56854c85cb312f">View\Controller</a></div><div class="ttdeci">Controller(&amp;$output)</div><div class="ttdoc">Calls the controller.</div><div class="ttdef"><b>Definition:</b> <a href="view_8php_source.html#l00074">view.php:74</a></div></div>
<div class="ttc" id="aclassView_html_ab01dd9990a4e547d5519dd0d9174fdb7"><div class="ttname"><a href="classView.html#ab01dd9990a4e547d5519dd0d9174fdb7">View\PrintProcessTable</a></div><div class="ttdeci">PrintProcessTable($output, $printcount=FALSE)</div><div class="ttdoc">Gets and lists processes for daemons/services.</div><div class="ttdef"><b>Definition:</b> <a href="view_8php_source.html#l00388">view.php:388</a></div></div>
<div class="ttc" id="adefs_8php_html_a93ea0868f01185b3c7915c2aff955f17"><div class="ttname"><a href="defs_8php.html#a93ea0868f01185b3c7915c2aff955f17">$ADMIN</a></div><div class="ttdeci">$ADMIN</div><div class="ttdoc">Superuser.</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00049">defs.php:49</a></div></div>
<div class="ttc" id="amonitoring_2info_8php_html_a2f596a20a29b568cb41da30759c97fbf"><div class="ttname"><a href="monitoring_2info_8php.html#a2f596a20a29b568cb41da30759c97fbf">Caption</a></div><div class="ttdeci">$View Caption</div><div class="ttdef"><b>Definition:</b> <a href="monitoring_2info_8php_source.html#l00036">info.php:36</a></div></div>
<div class="ttc" id="avars_8php_html_a2a733b91f319f70f5374bda816975ab5"><div class="ttname"><a href="vars_8php.html#a2a733b91f319f70f5374bda816975ab5">$IMG_PATH</a></div><div class="ttdeci">if(isset($_SESSION['Timeout'])) elseif(isset( $_SESSION[ 'USER']) &amp;&amp;in_array( $_SESSION[ 'USER'], $ALL_USERS)) if(!isset($_SESSION['USER'])|| $_SESSION['USER']=='loggedout') $IMG_PATH</div><div class="ttdoc">Path to image files used in help boxes and links.</div><div class="ttdef"><b>Definition:</b> <a href="vars_8php_source.html#l00092">vars.php:92</a></div></div>
<div class="ttc" id="avars_8php_html_a997e7be64a8e7eebb5381685d03e154f"><div class="ttname"><a href="vars_8php.html#a997e7be64a8e7eebb5381685d03e154f">$StatusTitles</a></div><div class="ttdeci">$StatusTitles</div><div class="ttdef"><b>Definition:</b> <a href="vars_8php_source.html#l00105">vars.php:105</a></div></div>
<div class="ttc" id="avars_8php_html_aaf14c49b6f5800a3c7a2b820404cf974"><div class="ttname"><a href="vars_8php.html#aaf14c49b6f5800a3c7a2b820404cf974">$Status2Images</a></div><div class="ttdeci">$Status2Images</div><div class="ttdef"><b>Definition:</b> <a href="vars_8php_source.html#l00095">vars.php:95</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="logs_8archives_8php_source.html#l00081">$_SESSION</a>, <a class="el" href="defs_8php_source.html#l00049">$ADMIN</a>, <a class="el" href="View_2dhcpd_2dhcpd_8php_source.html#l00025">$generate_status</a>, <a class="el" href="vars_8php_source.html#l00092">$IMG_PATH</a>, <a class="el" href="vars_8php_source.html#l00095">$Status2Images</a>, <a class="el" href="vars_8php_source.html#l00105">$StatusTitles</a>, <a class="el" href="view_8php_source.html#l00656">_NOTICE()</a>, <a class="el" href="defs_8php_source.html#l00402">_TITLE()</a>, <a class="el" href="monitoring_2info_8php_source.html#l00036">Caption</a>, <a class="el" href="view_8php_source.html#l00074">Controller()</a>, and <a class="el" href="view_8php_source.html#l00388">PrintProcessTable()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_ac66492e0af705fe63013ec18a7a9fa15_cgraph.png" border="0" usemap="#aclassView_ac66492e0af705fe63013ec18a7a9fa15_cgraph" alt=""/></div>
<map name="aclassView_ac66492e0af705fe63013ec18a7a9fa15_cgraph" id="aclassView_ac66492e0af705fe63013ec18a7a9fa15_cgraph">
<area shape="rect" title="Displays module status, software version, Restart/Stop buttons, and process table." alt="" coords="5,80,132,105"/>
<area shape="rect" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f" title="For classifying gettext strings into files." alt="" coords="209,5,287,31"/>
<area shape="rect" href="defs_8php.html#a76b8877d5a35c08959e2609908c669b6" title="For classifying gettext strings into files." alt="" coords="423,107,487,132"/>
<area shape="rect" href="classView.html#a523ddd51e800ca8c2c56854c85cb312f" title="Calls the controller." alt="" coords="205,55,291,80"/>
<area shape="rect" href="classView.html#ab01dd9990a4e547d5519dd0d9174fdb7" title="Gets and lists processes for daemons/services." alt="" coords="180,156,316,181"/>
<area shape="rect" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4" title="Satisfies Controller." alt="" coords="388,56,523,81"/>
<area shape="rect" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769" title="Wrapper for syslog()." alt="" coords="408,7,503,32"/>
<area shape="rect" href="classView.html#abb2db63abb2379f6fa3bfe17f4975d42" title="Prints headers for processes table." alt="" coords="364,156,547,181"/>
<area shape="rect" href="view_8php.html#ab4da5c8117f5ef7afe6fdfeb41764bac" title="For classifying gettext strings into files." alt="" coords="595,156,667,181"/>
</map>
</div>

</div>
</div>
<a id="a0e15d34b5378973d7c5f425eea21cbfe" name="a0e15d34b5378973d7c5f425eea21cbfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e15d34b5378973d7c5f425eea21cbfe">&#9670;&#160;</a></span>ProcessStartStopRequests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ProcessStartStopRequests </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes user posts for process start and stop. </p>
<p>Used on info pages. </p>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00260">260</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  261</span>    {</div>
<div class="line"><span class="lineno">  262</span>        <a class="code hl_variable" href="View_2dhcpd_2dhcpd_8php.html#a83b72400c2ac339d288cdb20cd46a341">$generate_status</a>= 0;</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>        <span class="keywordflow">if</span> (filter_has_var(INPUT_POST, <span class="stringliteral">&#39;Model&#39;</span>)) {</div>
<div class="line"><span class="lineno">  265</span>            <span class="keywordflow">if</span> (filter_input(INPUT_POST, <span class="stringliteral">&#39;Model&#39;</span>) == $this-&gt;<a class="code hl_namespace" href="namespaceModel.html">Model</a>) {</div>
<div class="line"><span class="lineno">  266</span>                <span class="keywordflow">if</span> (filter_has_var(INPUT_POST, <span class="stringliteral">&#39;Start&#39;</span>)) {</div>
<div class="line"><span class="lineno">  267</span>                    $this-&gt;Restart();</div>
<div class="line"><span class="lineno">  268</span>                    <a class="code hl_variable" href="View_2dhcpd_2dhcpd_8php.html#a83b72400c2ac339d288cdb20cd46a341">$generate_status</a>= 1;</div>
<div class="line"><span class="lineno">  269</span>                }</div>
<div class="line"><span class="lineno">  270</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (filter_has_var(INPUT_POST, <span class="stringliteral">&#39;Stop&#39;</span>)) {</div>
<div class="line"><span class="lineno">  271</span>                    $this-&gt;Stop();</div>
<div class="line"><span class="lineno">  272</span>                    <a class="code hl_variable" href="View_2dhcpd_2dhcpd_8php.html#a83b72400c2ac339d288cdb20cd46a341">$generate_status</a>= 1;</div>
<div class="line"><span class="lineno">  273</span>                }</div>
<div class="line"><span class="lineno">  274</span>            }</div>
<div class="line"><span class="lineno">  275</span>        }</div>
<div class="line"><span class="lineno">  276</span>        $this-&gt;<a class="code hl_function" href="classView.html#a523ddd51e800ca8c2c56854c85cb312f">Controller</a>(<a class="code hl_variable" href="Model_2include_8php.html#a8a55ddd2b83051d9d86510dcd04f9f4c">$Output</a>, <span class="stringliteral">&#39;GetStatus&#39;</span>);</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="View_2dhcpd_2dhcpd_8php.html#a83b72400c2ac339d288cdb20cd46a341">$generate_status</a>;</div>
<div class="line"><span class="lineno">  279</span>    }</div>
<div class="ttc" id="aModel_2include_8php_html_a8a55ddd2b83051d9d86510dcd04f9f4c"><div class="ttname"><a href="Model_2include_8php.html#a8a55ddd2b83051d9d86510dcd04f9f4c">$Output</a></div><div class="ttdeci">$Output</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00092">include.php:92</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="View_2dhcpd_2dhcpd_8php_source.html#l00025">$generate_status</a>, <a class="el" href="Model_2include_8php_source.html#l00092">$Output</a>, <a class="el" href="view_8php_source.html#l00074">Controller()</a>, <a class="el" href="view_8php_source.html#l00221">Restart()</a>, and <a class="el" href="view_8php_source.html#l00234">Stop()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_a0e15d34b5378973d7c5f425eea21cbfe_cgraph.png" border="0" usemap="#aclassView_a0e15d34b5378973d7c5f425eea21cbfe_cgraph" alt=""/></div>
<map name="aclassView_a0e15d34b5378973d7c5f425eea21cbfe_cgraph" id="aclassView_a0e15d34b5378973d7c5f425eea21cbfe_cgraph">
<area shape="rect" title="Processes user posts for process start and stop." alt="" coords="5,31,197,56"/>
<area shape="rect" href="classView.html#a523ddd51e800ca8c2c56854c85cb312f" title="Calls the controller." alt="" coords="464,31,551,56"/>
<area shape="rect" href="classView.html#a07c2efd2b813bc974c545fcf33783926" title="Stops and restarts module process(es)." alt="" coords="245,31,315,56"/>
<area shape="rect" href="classView.html#a0f17de803b9ad897ee1e879e90982bd2" title="Stops module process(es)." alt="" coords="364,80,415,105"/>
<area shape="rect" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4" title="Satisfies Controller." alt="" coords="599,5,733,31"/>
<area shape="rect" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769" title="Wrapper for syslog()." alt="" coords="619,55,713,80"/>
<area shape="rect" href="classView.html#a58a42cd2dbcf0483f1da759a8d283d58" title="Starts module process(es)." alt="" coords="363,31,416,56"/>
</map>
</div>

</div>
</div>
<a id="a07c2efd2b813bc974c545fcf33783926" name="a07c2efd2b813bc974c545fcf33783926"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07c2efd2b813bc974c545fcf33783926">&#9670;&#160;</a></span>Restart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Restart </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stops and restarts module process(es). </p>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p>Reimplemented in <a class="el" href="classSystem.html#a07c2efd2b813bc974c545fcf33783926">System</a>.</p>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00221">221</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  222</span>    {</div>
<div class="line"><span class="lineno">  223</span>        <span class="keywordflow">if</span> ($this-&gt;Stop()) {</div>
<div class="line"><span class="lineno">  224</span>            <span class="keywordflow">return</span> $this-&gt;Start();</div>
<div class="line"><span class="lineno">  225</span>        }</div>
<div class="line"><span class="lineno">  226</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  227</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="view_8php_source.html#l00247">Start()</a>, and <a class="el" href="view_8php_source.html#l00234">Stop()</a>.</p>

<p class="reference">Referenced by <a class="el" href="view_8php_source.html#l00260">ProcessStartStopRequests()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_a07c2efd2b813bc974c545fcf33783926_cgraph.png" border="0" usemap="#aclassView_a07c2efd2b813bc974c545fcf33783926_cgraph" alt=""/></div>
<map name="aclassView_a07c2efd2b813bc974c545fcf33783926_cgraph" id="aclassView_a07c2efd2b813bc974c545fcf33783926_cgraph">
<area shape="rect" title="Stops and restarts module process(es)." alt="" coords="5,31,75,56"/>
<area shape="rect" href="classView.html#a58a42cd2dbcf0483f1da759a8d283d58" title="Starts module process(es)." alt="" coords="123,5,176,31"/>
<area shape="rect" href="classView.html#a0f17de803b9ad897ee1e879e90982bd2" title="Stops module process(es)." alt="" coords="124,55,175,80"/>
<area shape="rect" href="classView.html#a523ddd51e800ca8c2c56854c85cb312f" title="Calls the controller." alt="" coords="224,31,311,56"/>
<area shape="rect" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4" title="Satisfies Controller." alt="" coords="359,5,493,31"/>
<area shape="rect" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769" title="Wrapper for syslog()." alt="" coords="379,55,473,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_a07c2efd2b813bc974c545fcf33783926_icgraph.png" border="0" usemap="#aclassView_a07c2efd2b813bc974c545fcf33783926_icgraph" alt=""/></div>
<map name="aclassView_a07c2efd2b813bc974c545fcf33783926_icgraph" id="aclassView_a07c2efd2b813bc974c545fcf33783926_icgraph">
<area shape="rect" title="Stops and restarts module process(es)." alt="" coords="245,5,315,31"/>
<area shape="rect" href="classView.html#a0e15d34b5378973d7c5f425eea21cbfe" title="Processes user posts for process start and stop." alt="" coords="5,5,197,31"/>
</map>
</div>

</div>
</div>
<a id="a0b7f83be321b3512acc2c1bd1a41b787" name="a0b7f83be321b3512acc2c1bd1a41b787"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b7f83be321b3512acc2c1bd1a41b787">&#9670;&#160;</a></span>SetSessionConfOpt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetSessionConfOpt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00638">638</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  639</span>    {</div>
<div class="line"><span class="lineno">  640</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a58a42cd2dbcf0483f1da759a8d283d58" name="a58a42cd2dbcf0483f1da759a8d283d58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58a42cd2dbcf0483f1da759a8d283d58">&#9670;&#160;</a></span>Start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Starts module process(es). </p>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p>Reimplemented in <a class="el" href="classDhcpd.html#a58a42cd2dbcf0483f1da759a8d283d58">Dhcpd</a>, and <a class="el" href="classPf.html#a58a42cd2dbcf0483f1da759a8d283d58">Pf</a>.</p>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00247">247</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  248</span>    {</div>
<div class="line"><span class="lineno">  249</span>        <span class="keywordflow">if</span> ($this-&gt;Controller($output, <span class="stringliteral">&#39;Start&#39;</span>)) {</div>
<div class="line"><span class="lineno">  250</span>            <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  251</span>        }</div>
<div class="line"><span class="lineno">  252</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  253</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="view_8php_source.html#l00074">Controller()</a>.</p>

<p class="reference">Referenced by <a class="el" href="view_8php_source.html#l00221">Restart()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_a58a42cd2dbcf0483f1da759a8d283d58_cgraph.png" border="0" usemap="#aclassView_a58a42cd2dbcf0483f1da759a8d283d58_cgraph" alt=""/></div>
<map name="aclassView_a58a42cd2dbcf0483f1da759a8d283d58_cgraph" id="aclassView_a58a42cd2dbcf0483f1da759a8d283d58_cgraph">
<area shape="rect" title="Starts module process(es)." alt="" coords="5,31,59,56"/>
<area shape="rect" href="classView.html#a523ddd51e800ca8c2c56854c85cb312f" title="Calls the controller." alt="" coords="107,31,193,56"/>
<area shape="rect" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4" title="Satisfies Controller." alt="" coords="241,5,376,31"/>
<area shape="rect" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769" title="Wrapper for syslog()." alt="" coords="261,55,356,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_a58a42cd2dbcf0483f1da759a8d283d58_icgraph.png" border="0" usemap="#aclassView_a58a42cd2dbcf0483f1da759a8d283d58_icgraph" alt=""/></div>
<map name="aclassView_a58a42cd2dbcf0483f1da759a8d283d58_icgraph" id="aclassView_a58a42cd2dbcf0483f1da759a8d283d58_icgraph">
<area shape="rect" title="Starts module process(es)." alt="" coords="363,5,416,31"/>
<area shape="rect" href="classView.html#a07c2efd2b813bc974c545fcf33783926" title="Stops and restarts module process(es)." alt="" coords="245,5,315,31"/>
<area shape="rect" href="classView.html#a0e15d34b5378973d7c5f425eea21cbfe" title="Processes user posts for process start and stop." alt="" coords="5,5,197,31"/>
</map>
</div>

</div>
</div>
<a id="a0f17de803b9ad897ee1e879e90982bd2" name="a0f17de803b9ad897ee1e879e90982bd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f17de803b9ad897ee1e879e90982bd2">&#9670;&#160;</a></span>Stop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stops module process(es). </p>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p>Reimplemented in <a class="el" href="classCollectd.html#a0f17de803b9ad897ee1e879e90982bd2">Collectd</a>, and <a class="el" href="classPf.html#a0f17de803b9ad897ee1e879e90982bd2">Pf</a>.</p>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00234">234</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  235</span>    {</div>
<div class="line"><span class="lineno">  236</span>        <span class="keywordflow">if</span> ($this-&gt;Controller($output, <span class="stringliteral">&#39;Stop&#39;</span>)) {</div>
<div class="line"><span class="lineno">  237</span>            <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  238</span>        }</div>
<div class="line"><span class="lineno">  239</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  240</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="view_8php_source.html#l00074">Controller()</a>.</p>

<p class="reference">Referenced by <a class="el" href="view_8php_source.html#l00260">ProcessStartStopRequests()</a>, and <a class="el" href="view_8php_source.html#l00221">Restart()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_a0f17de803b9ad897ee1e879e90982bd2_cgraph.png" border="0" usemap="#aclassView_a0f17de803b9ad897ee1e879e90982bd2_cgraph" alt=""/></div>
<map name="aclassView_a0f17de803b9ad897ee1e879e90982bd2_cgraph" id="aclassView_a0f17de803b9ad897ee1e879e90982bd2_cgraph">
<area shape="rect" title="Stops module process(es)." alt="" coords="5,31,56,56"/>
<area shape="rect" href="classView.html#a523ddd51e800ca8c2c56854c85cb312f" title="Calls the controller." alt="" coords="104,31,191,56"/>
<area shape="rect" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4" title="Satisfies Controller." alt="" coords="239,5,373,31"/>
<area shape="rect" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769" title="Wrapper for syslog()." alt="" coords="259,55,353,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_a0f17de803b9ad897ee1e879e90982bd2_icgraph.png" border="0" usemap="#aclassView_a0f17de803b9ad897ee1e879e90982bd2_icgraph" alt=""/></div>
<map name="aclassView_a0f17de803b9ad897ee1e879e90982bd2_icgraph" id="aclassView_a0f17de803b9ad897ee1e879e90982bd2_icgraph">
<area shape="rect" title="Stops module process(es)." alt="" coords="363,5,413,31"/>
<area shape="rect" href="classView.html#a0e15d34b5378973d7c5f425eea21cbfe" title="Processes user posts for process start and stop." alt="" coords="5,5,197,31"/>
<area shape="rect" href="classView.html#a07c2efd2b813bc974c545fcf33783926" title="Stops and restarts module process(es)." alt="" coords="245,31,315,56"/>
</map>
</div>

</div>
</div>
<a id="aef4854da4a80f863418cbc2360cc33df" name="aef4854da4a80f863418cbc2360cc33df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef4854da4a80f863418cbc2360cc33df">&#9670;&#160;</a></span>UploadLogFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UploadLogFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Uploads selected log file. </p>
<p>Do not send anything yet if download requested (header is modified below).</p>
<dl class="section warning"><dt>Warning</dt><dd>Clear the output buffer first</dd>
<dd>
Do not send anything else, otherwise it is appended to the file</dd></dl>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00469">469</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  470</span>    {</div>
<div class="line"><span class="lineno">  472</span>        <span class="keywordflow">if</span> (filter_has_var(INPUT_POST, <span class="stringliteral">&#39;Download&#39;</span>) &amp;&amp; filter_has_var(INPUT_POST, <span class="stringliteral">&#39;LogFile&#39;</span>)) {</div>
<div class="line"><span class="lineno">  473</span>            <span class="keywordflow">if</span> ($this-&gt;Controller($output, <span class="stringliteral">&#39;PrepareFileForDownload&#39;</span>, filter_input(INPUT_POST, <span class="stringliteral">&#39;LogFile&#39;</span>))) {</div>
<div class="line"><span class="lineno">  474</span>                $tmpfile= $output[0];</div>
<div class="line"><span class="lineno">  476</span>                ob_clean();</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>                <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/MSIE/&#39;</span>, $_SERVER[<span class="stringliteral">&#39;HTTP_USER_AGENT&#39;</span>])) {</div>
<div class="line"><span class="lineno">  479</span>                    <span class="comment">// Without this header, IE cannot even download the file</span></div>
<div class="line"><span class="lineno">  480</span>                    header(<span class="stringliteral">&quot;Pragma: public&quot;</span>);</div>
<div class="line"><span class="lineno">  481</span>                }</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>                <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/.*\.gz$/&#39;</span>, $tmpfile)) {</div>
<div class="line"><span class="lineno">  484</span>                     header(<span class="stringliteral">&#39;Content-Type: application/x-gzip&#39;</span>);</div>
<div class="line"><span class="lineno">  485</span>                }</div>
<div class="line"><span class="lineno">  486</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/.*\.pdf$/&#39;</span>, $tmpfile)) {</div>
<div class="line"><span class="lineno">  487</span>                     header(<span class="stringliteral">&#39;Content-Type: application/pdf&#39;</span>);</div>
<div class="line"><span class="lineno">  488</span>                }</div>
<div class="line"><span class="lineno">  489</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  490</span>                     header(<span class="stringliteral">&#39;Content-Type: text/plain&#39;</span>);</div>
<div class="line"><span class="lineno">  491</span>                }</div>
<div class="line"><span class="lineno">  492</span>                header(<span class="stringliteral">&#39;Content-Disposition: attachment; filename=&quot;&#39;</span>.basename($tmpfile).<span class="charliteral">&#39;&quot;&#39;</span>);</div>
<div class="line"><span class="lineno">  493</span>                header(<span class="stringliteral">&#39;Content-Length: &#39;</span>.filesize($tmpfile));</div>
<div class="line"><span class="lineno">  494</span>                readfile($tmpfile);</div>
<div class="line"><span class="lineno">  495</span>                flush();</div>
<div class="line"><span class="lineno">  497</span>                <a class="code hl_variable" href="dhcpd_2index_8php.html#a6733eb5f605d09eaede9845835d71c4e">exit</a>;</div>
<div class="line"><span class="lineno">  498</span>            }</div>
<div class="line"><span class="lineno">  499</span>        }</div>
<div class="line"><span class="lineno">  500</span>    }</div>
<div class="ttc" id="adhcpd_2index_8php_html_a6733eb5f605d09eaede9845835d71c4e"><div class="ttname"><a href="dhcpd_2index_8php.html#a6733eb5f605d09eaede9845835d71c4e">exit</a></div><div class="ttdeci">exit</div><div class="ttdef"><b>Definition:</b> <a href="dhcpd_2index_8php_source.html#l00023">index.php:23</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="view_8php_source.html#l00074">Controller()</a>, and <a class="el" href="dhcpd_2index_8php_source.html#l00023">exit</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_aef4854da4a80f863418cbc2360cc33df_cgraph.png" border="0" usemap="#aclassView_aef4854da4a80f863418cbc2360cc33df_cgraph" alt=""/></div>
<map name="aclassView_aef4854da4a80f863418cbc2360cc33df_cgraph" id="aclassView_aef4854da4a80f863418cbc2360cc33df_cgraph">
<area shape="rect" title="Uploads selected log file." alt="" coords="5,31,120,56"/>
<area shape="rect" href="classView.html#a523ddd51e800ca8c2c56854c85cb312f" title="Calls the controller." alt="" coords="168,31,255,56"/>
<area shape="rect" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4" title="Satisfies Controller." alt="" coords="303,5,437,31"/>
<area shape="rect" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769" title="Wrapper for syslog()." alt="" coords="323,55,417,80"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a id="ab9e8ffc52c9a4f358fb574dae198f434" name="ab9e8ffc52c9a4f358fb574dae198f434"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9e8ffc52c9a4f358fb574dae198f434">&#9670;&#160;</a></span>$Caption</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$<a class="el" href="monitoring_2info_8php.html#a2f596a20a29b568cb41da30759c97fbf">Caption</a> = '<a class="el" href="classModel.html">Model</a>'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00031">31</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>

</div>
</div>
<a id="aa0053f9703e84c2b7fd41ff4819305b6" name="aa0053f9703e84c2b7fd41ff4819305b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0053f9703e84c2b7fd41ff4819305b6">&#9670;&#160;</a></span>$ConfHelpMsg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$ConfHelpMsg = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00035">35</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>

</div>
</div>
<a id="ac2e162a2e94a6861acb555bb17919717" name="ac2e162a2e94a6861acb555bb17919717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2e162a2e94a6861acb555bb17919717">&#9670;&#160;</a></span>$Config</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$Config = array()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configuration. </p>
<p>If title field is missing, index string is used as title.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">title</td><td>Configuration title displayed. </td></tr>
    <tr><td class="paramname">info</td><td>Info text displayed in help box on the right. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00049">49</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>

</div>
</div>
<a id="a603376f45a6c28f439076e775ee851f0" name="a603376f45a6c28f439076e775ee851f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a603376f45a6c28f439076e775ee851f0">&#9670;&#160;</a></span>$GraphHelpMsg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$GraphHelpMsg = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00034">34</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>

</div>
</div>
<a id="aa82afad3a1e5359b526e325dfbb3c894" name="aa82afad3a1e5359b526e325dfbb3c894"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa82afad3a1e5359b526e325dfbb3c894">&#9670;&#160;</a></span>$Layout</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$<a class="el" href="classLayout.html">Layout</a> = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00037">37</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>

</div>
</div>
<a id="ad6342c38a273ba23edb4a2c6ee907bf2" name="ad6342c38a273ba23edb4a2c6ee907bf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6342c38a273ba23edb4a2c6ee907bf2">&#9670;&#160;</a></span>$LogsHelpMsg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$LogsHelpMsg = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00033">33</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>

</div>
</div>
<a id="af6ed4f9ea7c0b69f41295c885adb4651" name="af6ed4f9ea7c0b69f41295c885adb4651"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6ed4f9ea7c0b69f41295c885adb4651">&#9670;&#160;</a></span>$LogsPage</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$LogsPage = 'logs.php'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00038">38</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>

</div>
</div>
<a id="a4d78d22732a2db7f27b3c39ab3a0f679" name="a4d78d22732a2db7f27b3c39ab3a0f679"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d78d22732a2db7f27b3c39ab3a0f679">&#9670;&#160;</a></span>$Model</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$<a class="el" href="classModel.html">Model</a> = 'model'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00029">29</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>

</div>
</div>
<a id="a643d60fb839b5d58f0725a88d0ecd1a0" name="a643d60fb839b5d58f0725a88d0ecd1a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a643d60fb839b5d58f0725a88d0ecd1a0">&#9670;&#160;</a></span>$Module</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$Module = 'model'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00030">30</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>

</div>
</div>
<a id="a83b7d71e43e3e32108a4b4834c24fbca" name="a83b7d71e43e3e32108a4b4834c24fbca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83b7d71e43e3e32108a4b4834c24fbca">&#9670;&#160;</a></span>$StatsPage</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$StatsPage = 'stats.php'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="view_8php_source.html#l00039">39</a> of file <a class="el" href="view_8php_source.html">view.php</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/View/lib/<a class="el" href="view_8php_source.html">view.php</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classView.html">View</a></li>
    <li class="footer">Generated on Sun Apr 30 2023 00:52:50 for PF Firewall by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
