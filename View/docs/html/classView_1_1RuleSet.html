<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PF Firewall: RuleSet Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PF Firewall<span id="projectnumber">&#160;7.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classView_1_1RuleSet.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle"><div class="title">RuleSet Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Loads and maintains rules.  
 <a href="classView_1_1RuleSet.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a78625abd499b4df0c09d9885c99f001b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a78625abd499b4df0c09d9885c99f001b">load</a> ($filename, $tmp=0, $force=0, $tmpFilename='')</td></tr>
<tr class="memdesc:a78625abd499b4df0c09d9885c99f001b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads the rules in a given file.  <br /></td></tr>
<tr class="separator:a78625abd499b4df0c09d9885c99f001b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43ff75d8518bbd9527992c20a869a4cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a43ff75d8518bbd9527992c20a869a4cc">loadArray</a> ($rulesArray)</td></tr>
<tr class="memdesc:a43ff75d8518bbd9527992c20a869a4cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads the rules from a given rules array.  <br /></td></tr>
<tr class="separator:a43ff75d8518bbd9527992c20a869a4cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b2ce2ed8ce3b208ef9aa0bd32a06746"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a7b2ce2ed8ce3b208ef9aa0bd32a06746">deleteRules</a> ()</td></tr>
<tr class="separator:a7b2ce2ed8ce3b208ef9aa0bd32a06746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53bccdcfa3b2b954917e854dca5b5b31"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a53bccdcfa3b2b954917e854dca5b5b31">up</a> ($ruleNumber)</td></tr>
<tr class="memdesc:a53bccdcfa3b2b954917e854dca5b5b31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Moves a rule up in the ruleset.  <br /></td></tr>
<tr class="separator:a53bccdcfa3b2b954917e854dca5b5b31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fe5b826a26b814dd811b0217c989bc0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a2fe5b826a26b814dd811b0217c989bc0">down</a> ($ruleNumber)</td></tr>
<tr class="memdesc:a2fe5b826a26b814dd811b0217c989bc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Moves a rule down in the ruleset.  <br /></td></tr>
<tr class="separator:a2fe5b826a26b814dd811b0217c989bc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94f644e621656cf736fe29b75d397881"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a94f644e621656cf736fe29b75d397881">del</a> ($ruleNumber)</td></tr>
<tr class="memdesc:a94f644e621656cf736fe29b75d397881"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes a rule from the ruleset.  <br /></td></tr>
<tr class="separator:a94f644e621656cf736fe29b75d397881"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13075c959cc9af9a256df1fbf3dee345"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a13075c959cc9af9a256df1fbf3dee345">move</a> ($ruleNumber, $moveTo)</td></tr>
<tr class="memdesc:a13075c959cc9af9a256df1fbf3dee345"><td class="mdescLeft">&#160;</td><td class="mdescRight">Moves a rule to another location in the ruleset.  <br /></td></tr>
<tr class="separator:a13075c959cc9af9a256df1fbf3dee345"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfe86d20259ba5cf6c22d032d177fab9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#abfe86d20259ba5cf6c22d032d177fab9">add</a> ($ruleNumber=0)</td></tr>
<tr class="memdesc:abfe86d20259ba5cf6c22d032d177fab9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds an empty rule location to the ruleset.  <br /></td></tr>
<tr class="separator:abfe86d20259ba5cf6c22d032d177fab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1be941dc5339fbc3495727e056b6deed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a1be941dc5339fbc3495727e056b6deed">comment</a> ($ruleNumber)</td></tr>
<tr class="separator:a1be941dc5339fbc3495727e056b6deed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32ea8f746244d21480f530220a0407f7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a32ea8f746244d21480f530220a0407f7">uncomment</a> ($ruleNumber)</td></tr>
<tr class="separator:a32ea8f746244d21480f530220a0407f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb352c46e469765da3b900f5513be404"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#afb352c46e469765da3b900f5513be404">separate</a> ($ruleNumber)</td></tr>
<tr class="separator:afb352c46e469765da3b900f5513be404"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38d99acc70a1d8fd8f94455743b2d237"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a38d99acc70a1d8fd8f94455743b2d237">parse</a> ()</td></tr>
<tr class="separator:a38d99acc70a1d8fd8f94455743b2d237"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a854c506e8544694597487ba5cacb92"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a5a854c506e8544694597487ba5cacb92">computeNewRuleNumber</a> ($ruleNumber=0)</td></tr>
<tr class="memdesc:a5a854c506e8544694597487ba5cacb92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the actual rule number which can be allocated.  <br /></td></tr>
<tr class="separator:a5a854c506e8544694597487ba5cacb92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f5a37e16926830b3f1a923d6abe97e2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a3f5a37e16926830b3f1a923d6abe97e2">nextRuleNumber</a> ()</td></tr>
<tr class="memdesc:a3f5a37e16926830b3f1a923d6abe97e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of a new rule to be appended to the end of the ruleset.  <br /></td></tr>
<tr class="separator:a3f5a37e16926830b3f1a923d6abe97e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1423547e962111b353b79c6633ce7cd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#ab1423547e962111b353b79c6633ce7cd">setupEditSession</a> ($cat, &amp;$action, &amp;$ruleNumber)</td></tr>
<tr class="memdesc:ab1423547e962111b353b79c6633ce7cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the current state of the edit page and sets up the session vars.  <br /></td></tr>
<tr class="separator:ab1423547e962111b353b79c6633ce7cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe4cba22504dd2b5bcf06f1e770c5339"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#afe4cba22504dd2b5bcf06f1e770c5339">test</a> ($ruleNumber, $ruleObj)</td></tr>
<tr class="memdesc:afe4cba22504dd2b5bcf06f1e770c5339"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests the given rule.  <br /></td></tr>
<tr class="separator:afe4cba22504dd2b5bcf06f1e770c5339"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a649b2b3005c687ae78c9d1d65e973493"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a649b2b3005c687ae78c9d1d65e973493">cancel</a> ()</td></tr>
<tr class="memdesc:a649b2b3005c687ae78c9d1d65e973493"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancels the edit session.  <br /></td></tr>
<tr class="separator:a649b2b3005c687ae78c9d1d65e973493"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0515cf408d0001db8d0d6aef4c1829d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a0515cf408d0001db8d0d6aef4c1829d1">save</a> ($action, $ruleNumber, $ruleObj, $testResult)</td></tr>
<tr class="memdesc:a0515cf408d0001db8d0d6aef4c1829d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves the modified rule.  <br /></td></tr>
<tr class="separator:a0515cf408d0001db8d0d6aef4c1829d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cf5b164d9d21f96029c7f2ebd6e8795"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a7cf5b164d9d21f96029c7f2ebd6e8795">isModified</a> ($ruleNumber, $ruleObj)</td></tr>
<tr class="memdesc:a7cf5b164d9d21f96029c7f2ebd6e8795"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the rule is modified.  <br /></td></tr>
<tr class="separator:a7cf5b164d9d21f96029c7f2ebd6e8795"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c1018246c7e59b98d3fe88ec427dbc5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a1c1018246c7e59b98d3fe88ec427dbc5">getQueueNames</a> ()</td></tr>
<tr class="memdesc:a1c1018246c7e59b98d3fe88ec427dbc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the list of queues defined in the current ruleset.  <br /></td></tr>
<tr class="separator:a1c1018246c7e59b98d3fe88ec427dbc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a0722441477f957078ee2437054556cbc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a0722441477f957078ee2437054556cbc">$filename</a> = ''</td></tr>
<tr class="memdesc:a0722441477f957078ee2437054556cbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">The name of the currently loaded file.  <br /></td></tr>
<tr class="separator:a0722441477f957078ee2437054556cbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e92bb37ab892f2f238ed28c5c2c40d2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a5e92bb37ab892f2f238ed28c5c2c40d2">$uploaded</a> = FALSE</td></tr>
<tr class="memdesc:a5e92bb37ab892f2f238ed28c5c2c40d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether the file is uploaded or not.  <br /></td></tr>
<tr class="separator:a5e92bb37ab892f2f238ed28c5c2c40d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a811d22ac55b4592f7f2a202529629419"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classView_1_1RuleSet.html#a811d22ac55b4592f7f2a202529629419">$rules</a> = array()</td></tr>
<tr class="memdesc:a811d22ac55b4592f7f2a202529629419"><td class="mdescLeft">&#160;</td><td class="mdescRight">The list holding the ruleset.  <br /></td></tr>
<tr class="separator:a811d22ac55b4592f7f2a202529629419"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Loads and maintains rules. </p>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00048">48</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="abfe86d20259ba5cf6c22d032d177fab9" name="abfe86d20259ba5cf6c22d032d177fab9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfe86d20259ba5cf6c22d032d177fab9">&#9670;&#160;</a></span>add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">add </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleNumber</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds an empty rule location to the ruleset. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$ruleNumber</td><td>The location of the new rule. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int The actual rule location allocated. </dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>We cannot simply insert an empty array(), array_merge() discards it</dd></dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00210">210</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  211</span>    {</div>
<div class="line"><span class="lineno">  212</span>        <span class="keywordflow">if</span> (count($this-&gt;rules) == 0 || ($ruleNumber &gt;= $this-&gt;<a class="code hl_function" href="classView_1_1RuleSet.html#a3f5a37e16926830b3f1a923d6abe97e2">nextRuleNumber</a>())) {</div>
<div class="line"><span class="lineno">  213</span>            <span class="comment">// Add the first rule or append a new one to the end</span></div>
<div class="line"><span class="lineno">  214</span>            array_push($this-&gt;rules, array());</div>
<div class="line"><span class="lineno">  215</span>            <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classView_1_1RuleSet.html#a3f5a37e16926830b3f1a923d6abe97e2">nextRuleNumber</a>();</div>
<div class="line"><span class="lineno">  216</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  217</span>            <span class="comment">// Insert a new rule in the middle</span></div>
<div class="line"><span class="lineno">  218</span>            $head= array_slice($this-&gt;rules, 0, $ruleNumber);</div>
<div class="line"><span class="lineno">  219</span>            $tail= array_slice($this-&gt;rules, $ruleNumber);</div>
<div class="line"><span class="lineno">  221</span>            <span class="comment">// hence insert an array with an empty string element, which will be overwritten by the caller</span></div>
<div class="line"><span class="lineno">  222</span>            <span class="comment">// or we could use array_push($head, array()) instead</span></div>
<div class="line"><span class="lineno">  223</span>            $this-&gt;rules= array_merge($head, array(<span class="stringliteral">&#39;&#39;</span>), $tail);</div>
<div class="line"><span class="lineno">  224</span>            <span class="keywordflow">return</span> $ruleNumber;</div>
<div class="line"><span class="lineno">  225</span>        }</div>
<div class="line"><span class="lineno">  226</span>    }</div>
<div class="ttc" id="aclassView_1_1RuleSet_html_a3f5a37e16926830b3f1a923d6abe97e2"><div class="ttname"><a href="classView_1_1RuleSet.html#a3f5a37e16926830b3f1a923d6abe97e2">View\RuleSet\nextRuleNumber</a></div><div class="ttdeci">nextRuleNumber()</div><div class="ttdoc">Returns the number of a new rule to be appended to the end of the ruleset.</div><div class="ttdef"><b>Definition:</b> <a href="View_2pf_2lib_2RuleSet_8php_source.html#l00369">RuleSet.php:369</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a649b2b3005c687ae78c9d1d65e973493" name="a649b2b3005c687ae78c9d1d65e973493"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a649b2b3005c687ae78c9d1d65e973493">&#9670;&#160;</a></span>cancel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cancel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancels the edit session. </p>
<p>First checks if the user has clicked the Cancel button. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000061">Todo:</a></b></dt><dd>Make conf.php a parameter </dd></dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00477">477</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  478</span>    {</div>
<div class="line"><span class="lineno">  479</span>        <span class="keywordflow">if</span> (filter_has_var(INPUT_POST, <span class="stringliteral">&#39;cancel&#39;</span>) &amp;&amp; (filter_input(INPUT_POST, <span class="stringliteral">&#39;cancel&#39;</span>) == <a class="code hl_function" href="view_8php.html#a365ac814f4e5c717bd9ce48ab65b97b5">_CONTROL</a>(<span class="stringliteral">&#39;Cancel&#39;</span>))) {</div>
<div class="line"><span class="lineno">  480</span>            unset(<a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;edit&#39;</span>]);</div>
<div class="line"><span class="lineno">  482</span>            header(<span class="stringliteral">&#39;Location: /pf/conf.php&#39;</span>);</div>
<div class="line"><span class="lineno">  483</span>            <a class="code hl_variable" href="dhcpd_2index_8php.html#a6733eb5f605d09eaede9845835d71c4e">exit</a>;</div>
<div class="line"><span class="lineno">  484</span>        }</div>
<div class="line"><span class="lineno">  485</span>    }</div>
<div class="ttc" id="adhcpd_2index_8php_html_a6733eb5f605d09eaede9845835d71c4e"><div class="ttname"><a href="dhcpd_2index_8php.html#a6733eb5f605d09eaede9845835d71c4e">exit</a></div><div class="ttdeci">exit</div><div class="ttdef"><b>Definition:</b> <a href="dhcpd_2index_8php_source.html#l00023">index.php:23</a></div></div>
<div class="ttc" id="alogs_8archives_8php_html_a7430243fef5a97ca3ca2324775d4dfec"><div class="ttname"><a href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a></div><div class="ttdeci">if(count($_POST)) else if(isset( $_SESSION[ $View-&gt;Model][ $Submenu][ 'Month'], $_SESSION[ $View-&gt;Model][ $Submenu][ 'Day'], $_SESSION[ $View-&gt;Model][ $Submenu][ 'Hour'], $_SESSION[ $View-&gt;Model][ $Submenu][ 'Minute'])) if($ApplyDefaults) $_SESSION[$View-&gt;Model][$Submenu]['Month']</div><div class="ttdef"><b>Definition:</b> <a href="logs_8archives_8php_source.html#l00081">logs.archives.php:81</a></div></div>
<div class="ttc" id="aview_8php_html_a365ac814f4e5c717bd9ce48ab65b97b5"><div class="ttname"><a href="view_8php.html#a365ac814f4e5c717bd9ce48ab65b97b5">_CONTROL</a></div><div class="ttdeci">_CONTROL($str)</div><div class="ttdoc">For classifying gettext strings into files.</div><div class="ttdef"><b>Definition:</b> <a href="view_8php_source.html#l00650">view.php:650</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="logs_8archives_8php_source.html#l00081">$_SESSION</a>, <a class="el" href="view_8php_source.html#l00650">_CONTROL()</a>, and <a class="el" href="dhcpd_2index_8php_source.html#l00023">exit</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_1_1RuleSet_a649b2b3005c687ae78c9d1d65e973493_cgraph.png" border="0" usemap="#aclassView_1_1RuleSet_a649b2b3005c687ae78c9d1d65e973493_cgraph" alt=""/></div>
<map name="aclassView_1_1RuleSet_a649b2b3005c687ae78c9d1d65e973493_cgraph" id="aclassView_1_1RuleSet_a649b2b3005c687ae78c9d1d65e973493_cgraph">
<area shape="rect" title="Cancels the edit session." alt="" coords="5,5,69,31"/>
<area shape="rect" href="view_8php.html#a365ac814f4e5c717bd9ce48ab65b97b5" title="For classifying gettext strings into files." alt="" coords="117,5,209,31"/>
</map>
</div>

</div>
</div>
<a id="a1be941dc5339fbc3495727e056b6deed" name="a1be941dc5339fbc3495727e056b6deed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1be941dc5339fbc3495727e056b6deed">&#9670;&#160;</a></span>comment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">comment </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleNumber</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section attention"><dt>Attention</dt><dd>Inline rules are multi-line, hence implode.</dd></dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00228">228</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  229</span>    {</div>
<div class="line"><span class="lineno">  230</span>        global <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>;</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>        <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>-&gt;Controller($output, <span class="stringliteral">&#39;GenerateRule&#39;</span>, json_encode($this-&gt;rules[$ruleNumber]), $ruleNumber, 1);</div>
<div class="line"><span class="lineno">  233</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>) {</div>
<div class="line"><span class="lineno">  234</span>            <a class="code hl_function" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a>(<a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;ERROR&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . <a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;Cannot generate rule&#39;</span>), <span class="stringliteral">&#39;auto&#39;</span>, <span class="stringliteral">&#39;ERROR&#39;</span>);</div>
<div class="line"><span class="lineno">  235</span>        }</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  238</span>        $output= explode(<span class="stringliteral">&quot;\n&quot;</span>, trim(implode(<span class="stringliteral">&quot;\n&quot;</span>, $output)));</div>
<div class="line"><span class="lineno">  239</span>        <span class="keywordflow">for</span> ($i= 0; $i &lt; count($output); $i++) {</div>
<div class="line"><span class="lineno">  240</span>            $output[$i]= <span class="stringliteral">&#39;# &#39;</span>.trim($output[$i]);</div>
<div class="line"><span class="lineno">  241</span>        }</div>
<div class="line"><span class="lineno">  242</span>        $ruleStr= implode(<span class="stringliteral">&quot;\n&quot;</span>, $output);</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>        unset($output);</div>
<div class="line"><span class="lineno">  245</span>        $rulesArray= array();</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>        <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>-&gt;Controller($output, <span class="stringliteral">&#39;ParseRules&#39;</span>, json_encode($ruleStr), 1);</div>
<div class="line"><span class="lineno">  248</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>) {</div>
<div class="line"><span class="lineno">  249</span>            <a class="code hl_function" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a>(<a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;ERROR&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . <a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;Cannot parse rules&#39;</span>), <span class="stringliteral">&#39;auto&#39;</span>, <span class="stringliteral">&#39;ERROR&#39;</span>);</div>
<div class="line"><span class="lineno">  250</span>        }</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>        $rulesArray= json_decode($output[0], TRUE)[<span class="stringliteral">&#39;rules&#39;</span>];</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>        $ruleSet= <span class="keyword">new</span> RuleSet();</div>
<div class="line"><span class="lineno">  255</span>        $ruleSet-&gt;loadArray($rulesArray);</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>        unset($this-&gt;rules[$ruleNumber]);</div>
<div class="line"><span class="lineno">  258</span>        <span class="comment">// array_slice() takes care of possible off-by-one error due to unset above</span></div>
<div class="line"><span class="lineno">  259</span>        $head= array_slice($this-&gt;rules, 0, $ruleNumber);</div>
<div class="line"><span class="lineno">  260</span>        $tail= array_slice($this-&gt;rules, $ruleNumber);</div>
<div class="line"><span class="lineno">  261</span>        $this-&gt;rules= array_merge($head, $ruleSet-&gt;rules, $tail);</div>
<div class="line"><span class="lineno">  262</span>    }</div>
<div class="ttc" id="aInstaller_2lib_8php_html_ac089920689dafbf6a510f3b87eb6a6d4"><div class="ttname"><a href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a></div><div class="ttdeci">PrintHelpWindow($msg, $width='auto', $type='INFO')</div><div class="ttdoc">Satisfies Controller.</div><div class="ttdef"><b>Definition:</b> <a href="Installer_2lib_8php_source.html#l00030">lib.php:30</a></div></div>
<div class="ttc" id="actlr_8php_html_a80b96347dc2ad0d4e3748dc87db72731"><div class="ttname"><a href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a></div><div class="ttdeci">if( $ArgV[0]==='-n') if($ArgV[0]==='-t') $retval</div><div class="ttdef"><b>Definition:</b> <a href="ctlr_8php_source.html#l00072">ctlr.php:72</a></div></div>
<div class="ttc" id="ainstall_8php_html_adfe49c647d27eb2b424c3ea73082382f"><div class="ttname"><a href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a></div><div class="ttdeci">$View</div><div class="ttdef"><b>Definition:</b> <a href="install_8php_source.html#l00057">install.php:57</a></div></div>
<div class="ttc" id="aview_8php_html_a4aa5270b4a28926a0ea160561a3ba51f"><div class="ttname"><a href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a></div><div class="ttdeci">_NOTICE($str)</div><div class="ttdoc">For classifying gettext strings into files.</div><div class="ttdef"><b>Definition:</b> <a href="view_8php_source.html#l00656">view.php:656</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="install_8php_source.html#l00057">$View</a>, <a class="el" href="view_8php_source.html#l00656">_NOTICE()</a>, and <a class="el" href="Installer_2lib_8php_source.html#l00030">PrintHelpWindow()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_1_1RuleSet_a1be941dc5339fbc3495727e056b6deed_cgraph.png" border="0" usemap="#aclassView_1_1RuleSet_a1be941dc5339fbc3495727e056b6deed_cgraph" alt=""/></div>
<map name="aclassView_1_1RuleSet_a1be941dc5339fbc3495727e056b6deed_cgraph" id="aclassView_1_1RuleSet_a1be941dc5339fbc3495727e056b6deed_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,89,56"/>
<area shape="rect" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f" title="For classifying gettext strings into files." alt="" coords="165,5,244,31"/>
<area shape="rect" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4" title="Satisfies Controller." alt="" coords="137,55,272,80"/>
</map>
</div>

</div>
</div>
<a id="a5a854c506e8544694597487ba5cacb92" name="a5a854c506e8544694597487ba5cacb92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a854c506e8544694597487ba5cacb92">&#9670;&#160;</a></span>computeNewRuleNumber()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">computeNewRuleNumber </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleNumber</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the actual rule number which can be allocated. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$ruleNumber</td><td>The rule number requested. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Actual rule number which can be allocated. </dd></dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00351">351</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  352</span>    {</div>
<div class="line"><span class="lineno">  353</span>        <span class="keywordflow">if</span> (count($this-&gt;rules) == 0 || ($ruleNumber &gt;= $this-&gt;<a class="code hl_function" href="classView_1_1RuleSet.html#a3f5a37e16926830b3f1a923d6abe97e2">nextRuleNumber</a>())) {</div>
<div class="line"><span class="lineno">  354</span>            <span class="comment">// Add the first rule or append a new one to the end</span></div>
<div class="line"><span class="lineno">  355</span>            <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classView_1_1RuleSet.html#a3f5a37e16926830b3f1a923d6abe97e2">nextRuleNumber</a>();</div>
<div class="line"><span class="lineno">  356</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  357</span>            <span class="comment">// Insert a new rule in the middle</span></div>
<div class="line"><span class="lineno">  358</span>            <span class="keywordflow">return</span> $ruleNumber;</div>
<div class="line"><span class="lineno">  359</span>        }</div>
<div class="line"><span class="lineno">  360</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a94f644e621656cf736fe29b75d397881" name="a94f644e621656cf736fe29b75d397881"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94f644e621656cf736fe29b75d397881">&#9670;&#160;</a></span>del()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">del </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleNumber</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deletes a rule from the ruleset. </p>
<dl class="section attention"><dt>Attention</dt><dd>We slice the array to update the keys, otherwise the unset() call leaves a hole in the ruleset indeces.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$ruleNumber</td><td>The number of the rule to delete. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00172">172</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  173</span>    {</div>
<div class="line"><span class="lineno">  174</span>        unset($this-&gt;rules[$ruleNumber]);</div>
<div class="line"><span class="lineno">  175</span>        <span class="comment">// Fake slice to update the keys</span></div>
<div class="line"><span class="lineno">  176</span>        $this-&gt;rules= array_slice($this-&gt;rules, 0);</div>
<div class="line"><span class="lineno">  177</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7b2ce2ed8ce3b208ef9aa0bd32a06746" name="a7b2ce2ed8ce3b208ef9aa0bd32a06746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b2ce2ed8ce3b208ef9aa0bd32a06746">&#9670;&#160;</a></span>deleteRules()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">deleteRules </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00128">128</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  129</span>    {</div>
<div class="line"><span class="lineno">  130</span>        $this-&gt;rules= array();</div>
<div class="line"><span class="lineno">  131</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2fe5b826a26b814dd811b0217c989bc0" name="a2fe5b826a26b814dd811b0217c989bc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fe5b826a26b814dd811b0217c989bc0">&#9670;&#160;</a></span>down()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">down </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleNumber</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Moves a rule down in the ruleset. </p>
<p>Simply switches the places of two rules.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$ruleNumber</td><td>The number of the rule to move down. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00156">156</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  157</span>    {</div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">if</span> (isset($this-&gt;rules[$ruleNumber + 1])) {</div>
<div class="line"><span class="lineno">  159</span>            $tmp= $this-&gt;rules[$ruleNumber + 1];</div>
<div class="line"><span class="lineno">  160</span>            $this-&gt;rules[$ruleNumber + 1]= $this-&gt;rules[$ruleNumber];</div>
<div class="line"><span class="lineno">  161</span>            $this-&gt;rules[$ruleNumber]= $tmp;</div>
<div class="line"><span class="lineno">  162</span>        }</div>
<div class="line"><span class="lineno">  163</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1c1018246c7e59b98d3fe88ec427dbc5" name="a1c1018246c7e59b98d3fe88ec427dbc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c1018246c7e59b98d3fe88ec427dbc5">&#9670;&#160;</a></span>getQueueNames()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getQueueNames </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the list of queues defined in the current ruleset. </p>
<dl class="section return"><dt>Returns</dt><dd>array List of queues. </dd></dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00559">559</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  560</span>    {</div>
<div class="line"><span class="lineno">  561</span>        <a class="code hl_variable" href="info_8queues_8php.html#ac61c83768b9e4bdaaa585ca89a93e349">$queues</a>= array();</div>
<div class="line"><span class="lineno">  562</span>        <span class="keywordflow">foreach</span> ($this-&gt;rules as $ruleObj) {</div>
<div class="line"><span class="lineno">  563</span>            <span class="keywordflow">if</span>  ($ruleObj-&gt;cat == <span class="stringliteral">&#39;Queue&#39;</span> &amp;&amp; isset($ruleObj-&gt;rule[<span class="stringliteral">&#39;name&#39;</span>])) {</div>
<div class="line"><span class="lineno">  564</span>                <a class="code hl_variable" href="info_8queues_8php.html#ac61c83768b9e4bdaaa585ca89a93e349">$queues</a>[]= $ruleObj-&gt;rule[<span class="stringliteral">&#39;name&#39;</span>];</div>
<div class="line"><span class="lineno">  565</span>            }</div>
<div class="line"><span class="lineno">  566</span>        }</div>
<div class="line"><span class="lineno">  567</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="info_8queues_8php.html#ac61c83768b9e4bdaaa585ca89a93e349">$queues</a>;</div>
<div class="line"><span class="lineno">  568</span>    }</div>
<div class="ttc" id="ainfo_8queues_8php_html_ac61c83768b9e4bdaaa585ca89a93e349"><div class="ttname"><a href="info_8queues_8php.html#ac61c83768b9e4bdaaa585ca89a93e349">$queues</a></div><div class="ttdeci">$queues</div><div class="ttdef"><b>Definition:</b> <a href="info_8queues_8php_source.html#l00023">info.queues.php:23</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="info_8queues_8php_source.html#l00023">$queues</a>.</p>

</div>
</div>
<a id="a7cf5b164d9d21f96029c7f2ebd6e8795" name="a7cf5b164d9d21f96029c7f2ebd6e8795"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cf5b164d9d21f96029c7f2ebd6e8795">&#9670;&#160;</a></span>isModified()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">isModified </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleObj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the rule is modified. </p>
<p>First checks if the rule already exists in the ruleset, i.e. the user is editing an existing rule. Otherwise, we always return TRUE for new rules.</p>
<p>We sort the keys because the modification of the rule on the edit page may result in different key orders.</p>
<p>Serialization allows for an easy comparison of the rules.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$ruleNumber</td><td>Rule number. </td></tr>
    <tr><td class="paramtype">object</td><td class="paramname">$ruleObj</td><td>Rule object to check. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE if the rule is modified, or FALSE otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00534">534</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  535</span>    {</div>
<div class="line"><span class="lineno">  536</span>        $modified= TRUE;</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>        <span class="keywordflow">if</span> (key_exists($ruleNumber, $this-&gt;rules)) {</div>
<div class="line"><span class="lineno">  539</span>            <span class="comment">// Make sure keys are sorted before comparison</span></div>
<div class="line"><span class="lineno">  540</span>            $newRule= $ruleObj-&gt;rule;</div>
<div class="line"><span class="lineno">  541</span>            ksort($newRule);</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>            $origRule= $this-&gt;rules[$ruleNumber]-&gt;rule;</div>
<div class="line"><span class="lineno">  544</span>            ksort($origRule);</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>            <span class="keywordflow">if</span> (serialize($newRule) === serialize($origRule)) {</div>
<div class="line"><span class="lineno">  547</span>                $modified= FALSE;</div>
<div class="line"><span class="lineno">  548</span>            }</div>
<div class="line"><span class="lineno">  549</span>        }</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>        <span class="keywordflow">return</span> $modified;</div>
<div class="line"><span class="lineno">  552</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a78625abd499b4df0c09d9885c99f001b" name="a78625abd499b4df0c09d9885c99f001b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78625abd499b4df0c09d9885c99f001b">&#9670;&#160;</a></span>load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">load </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$tmp</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$force</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$tmpFilename</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads the rules in a given file. </p>
<p>Refers to the <a class="el" href="classModel.html">Model</a> to parse and create the rules array, which the <a class="el" href="classModel.html">Model</a> returns as json encoded string.</p>
<p>$filename and $tmpFilename are displayed on rules and install pages.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$filename</td><td>File name in the filesystem. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$tmp</td><td>Whether the file is uploaded from a browser. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$force</td><td>Whether to force loading the file even with errors. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$tmpFilename</td><td>Name if the temporary file uploaded. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00079">79</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   80</span>    {</div>
<div class="line"><span class="lineno">   81</span>        global <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>;</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>        <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= TRUE;</div>
<div class="line"><span class="lineno">   84</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classView_1_1RuleSet.html#a0722441477f957078ee2437054556cbc">$filename</a> == <span class="stringliteral">&#39;/etc/pf.conf&#39;</span>) {</div>
<div class="line"><span class="lineno">   85</span>            <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>-&gt;Controller(<a class="code hl_variable" href="Model_2include_8php.html#a8a55ddd2b83051d9d86510dcd04f9f4c">$Output</a>, <span class="stringliteral">&#39;GetRules&#39;</span>, <a class="code hl_variable" href="classView_1_1RuleSet.html#a0722441477f957078ee2437054556cbc">$filename</a>, 0, <a class="code hl_variable" href="conf_8write_8php.html#ac60027de12260e75a070f5a7618fd632">$force</a>);</div>
<div class="line"><span class="lineno">   86</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   87</span>            <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>-&gt;Controller(<a class="code hl_variable" href="Model_2include_8php.html#a8a55ddd2b83051d9d86510dcd04f9f4c">$Output</a>, <span class="stringliteral">&#39;GetRules&#39;</span>, <a class="code hl_variable" href="classView_1_1RuleSet.html#a0722441477f957078ee2437054556cbc">$filename</a>, $tmp, <a class="code hl_variable" href="conf_8write_8php.html#ac60027de12260e75a070f5a7618fd632">$force</a>);</div>
<div class="line"><span class="lineno">   88</span>        }</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> !== FALSE || <a class="code hl_variable" href="conf_8write_8php.html#ac60027de12260e75a070f5a7618fd632">$force</a>) {</div>
<div class="line"><span class="lineno">   91</span>            <span class="keywordflow">if</span> ($tmp &amp;&amp; $tmpFilename !== <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno">   92</span>                $this-&gt;filename= $tmpFilename;</div>
<div class="line"><span class="lineno">   93</span>                <span class="comment">// Mark uploaded files as such</span></div>
<div class="line"><span class="lineno">   94</span>                $this-&gt;uploaded= TRUE;</div>
<div class="line"><span class="lineno">   95</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   96</span>                $this-&gt;filename= <a class="code hl_variable" href="classView_1_1RuleSet.html#a0722441477f957078ee2437054556cbc">$filename</a>;</div>
<div class="line"><span class="lineno">   97</span>                $this-&gt;uploaded= FALSE;</div>
<div class="line"><span class="lineno">   98</span>            }</div>
<div class="line"><span class="lineno">   99</span>            $rulesArray= json_decode(<a class="code hl_variable" href="Model_2include_8php.html#a8a55ddd2b83051d9d86510dcd04f9f4c">$Output</a>[0], TRUE)[<span class="stringliteral">&#39;rules&#39;</span>];</div>
<div class="line"><span class="lineno">  100</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  101</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  102</span>        }</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>        $this-&gt;<a class="code hl_function" href="classView_1_1RuleSet.html#a43ff75d8518bbd9527992c20a869a4cc">loadArray</a>($rulesArray);</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>        <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  107</span>    }</div>
<div class="ttc" id="aModel_2include_8php_html_a8a55ddd2b83051d9d86510dcd04f9f4c"><div class="ttname"><a href="Model_2include_8php.html#a8a55ddd2b83051d9d86510dcd04f9f4c">$Output</a></div><div class="ttdeci">$Output</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00092">include.php:92</a></div></div>
<div class="ttc" id="aclassView_1_1RuleSet_html_a0722441477f957078ee2437054556cbc"><div class="ttname"><a href="classView_1_1RuleSet.html#a0722441477f957078ee2437054556cbc">View\RuleSet\$filename</a></div><div class="ttdeci">$filename</div><div class="ttdoc">The name of the currently loaded file.</div><div class="ttdef"><b>Definition:</b> <a href="View_2pf_2lib_2RuleSet_8php_source.html#l00053">RuleSet.php:53</a></div></div>
<div class="ttc" id="aclassView_1_1RuleSet_html_a43ff75d8518bbd9527992c20a869a4cc"><div class="ttname"><a href="classView_1_1RuleSet.html#a43ff75d8518bbd9527992c20a869a4cc">View\RuleSet\loadArray</a></div><div class="ttdeci">loadArray($rulesArray)</div><div class="ttdoc">Loads the rules from a given rules array.</div><div class="ttdef"><b>Definition:</b> <a href="View_2pf_2lib_2RuleSet_8php_source.html#l00117">RuleSet.php:117</a></div></div>
<div class="ttc" id="aconf_8write_8php_html_ac60027de12260e75a070f5a7618fd632"><div class="ttname"><a href="conf_8write_8php.html#ac60027de12260e75a070f5a7618fd632">$force</a></div><div class="ttdeci">$force</div><div class="ttdef"><b>Definition:</b> <a href="conf_8write_8php_source.html#l00041">conf.write.php:41</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="conf_8write_8php_source.html#l00041">$force</a>, <a class="el" href="Model_2include_8php_source.html#l00092">$Output</a>, <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, and <a class="el" href="install_8php_source.html#l00057">$View</a>.</p>

</div>
</div>
<a id="a43ff75d8518bbd9527992c20a869a4cc" name="a43ff75d8518bbd9527992c20a869a4cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43ff75d8518bbd9527992c20a869a4cc">&#9670;&#160;</a></span>loadArray()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">loadArray </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$rulesArray</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads the rules from a given rules array. </p>
<p>First, we delete the rules list, then create the rule objects. A simple assignment of rule structure to the rules member var is sufficient.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$rulesArray</td><td>Rules in an array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00117">117</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  118</span>    {</div>
<div class="line"><span class="lineno">  119</span>        $this-&gt;<a class="code hl_function" href="classView_1_1RuleSet.html#a7b2ce2ed8ce3b208ef9aa0bd32a06746">deleteRules</a>();</div>
<div class="line"><span class="lineno">  120</span>        <span class="keywordflow">foreach</span> ($rulesArray as $ruleDef) {</div>
<div class="line"><span class="lineno">  121</span>            $cat= __NAMESPACE__ . <span class="charliteral">&#39;\\&#39;</span> . $ruleDef[<span class="stringliteral">&#39;cat&#39;</span>];</div>
<div class="line"><span class="lineno">  122</span>            $ruleObj= <span class="keyword">new</span> $cat();</div>
<div class="line"><span class="lineno">  123</span>            $ruleObj-&gt;rule= $ruleDef[<span class="stringliteral">&#39;rule&#39;</span>];</div>
<div class="line"><span class="lineno">  124</span>            $this-&gt;rules[]= $ruleObj;</div>
<div class="line"><span class="lineno">  125</span>        }</div>
<div class="line"><span class="lineno">  126</span>    }</div>
<div class="ttc" id="aclassView_1_1RuleSet_html_a7b2ce2ed8ce3b208ef9aa0bd32a06746"><div class="ttname"><a href="classView_1_1RuleSet.html#a7b2ce2ed8ce3b208ef9aa0bd32a06746">View\RuleSet\deleteRules</a></div><div class="ttdeci">deleteRules()</div><div class="ttdef"><b>Definition:</b> <a href="View_2pf_2lib_2RuleSet_8php_source.html#l00128">RuleSet.php:128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a13075c959cc9af9a256df1fbf3dee345" name="a13075c959cc9af9a256df1fbf3dee345"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13075c959cc9af9a256df1fbf3dee345">&#9670;&#160;</a></span>move()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">move </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$moveTo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Moves a rule to another location in the ruleset. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$ruleNumber</td><td>The number of the rule to move. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$moveTo</td><td>The location to move the rule to. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00185">185</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  186</span>    {</div>
<div class="line"><span class="lineno">  187</span>        <span class="keywordflow">if</span> ($ruleNumber &lt; 0 || $ruleNumber &gt;= count($this-&gt;rules)) {</div>
<div class="line"><span class="lineno">  188</span>            <a class="code hl_function" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a>(<a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;FAILED&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . <a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;Invalid rule number&#39;</span>) . <span class="stringliteral">&quot;: $ruleNumber&quot;</span>, <span class="stringliteral">&#39;auto&#39;</span>, <span class="stringliteral">&#39;ERROR&#39;</span>);</div>
<div class="line"><span class="lineno">  189</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  190</span>        }</div>
<div class="line"><span class="lineno">  191</span>        <span class="keywordflow">if</span> ($moveTo &lt; 0 || $moveTo &gt;= count($this-&gt;rules) || $ruleNumber == $moveTo) {</div>
<div class="line"><span class="lineno">  192</span>            <a class="code hl_function" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a>(<a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;FAILED&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . <a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;Invalid destination rule number&#39;</span>) . <span class="stringliteral">&quot;: $moveTo&quot;</span>, <span class="stringliteral">&#39;auto&#39;</span>, <span class="stringliteral">&#39;ERROR&#39;</span>);</div>
<div class="line"><span class="lineno">  193</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  194</span>        }</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>        $rule= $this-&gt;rules[$ruleNumber];</div>
<div class="line"><span class="lineno">  197</span>        unset($this-&gt;rules[$ruleNumber]);</div>
<div class="line"><span class="lineno">  198</span>        <span class="comment">// array_slice() takes care of possible off-by-one error due to unset above</span></div>
<div class="line"><span class="lineno">  199</span>        $head= array_slice($this-&gt;rules, 0, $moveTo);</div>
<div class="line"><span class="lineno">  200</span>        $tail= array_slice($this-&gt;rules, $moveTo);</div>
<div class="line"><span class="lineno">  201</span>        $this-&gt;rules= array_merge($head, array($rule), $tail);</div>
<div class="line"><span class="lineno">  202</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="view_8php_source.html#l00656">_NOTICE()</a>, and <a class="el" href="Installer_2lib_8php_source.html#l00030">PrintHelpWindow()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_1_1RuleSet_a13075c959cc9af9a256df1fbf3dee345_cgraph.png" border="0" usemap="#aclassView_1_1RuleSet_a13075c959cc9af9a256df1fbf3dee345_cgraph" alt=""/></div>
<map name="aclassView_1_1RuleSet_a13075c959cc9af9a256df1fbf3dee345_cgraph" id="aclassView_1_1RuleSet_a13075c959cc9af9a256df1fbf3dee345_cgraph">
<area shape="rect" title="Moves a rule to another location in the ruleset." alt="" coords="5,31,64,56"/>
<area shape="rect" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f" title="For classifying gettext strings into files." alt="" coords="140,5,219,31"/>
<area shape="rect" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4" title="Satisfies Controller." alt="" coords="112,55,247,80"/>
</map>
</div>

</div>
</div>
<a id="a3f5a37e16926830b3f1a923d6abe97e2" name="a3f5a37e16926830b3f1a923d6abe97e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f5a37e16926830b3f1a923d6abe97e2">&#9670;&#160;</a></span>nextRuleNumber()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">nextRuleNumber </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the number of a new rule to be appended to the end of the ruleset. </p>
<p>This is simply the count of the rules in the ruleset, because the list is zero-based.</p>
<dl class="section return"><dt>Returns</dt><dd>int New rule number. </dd></dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00369">369</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  370</span>    {</div>
<div class="line"><span class="lineno">  371</span>        <span class="keywordflow">return</span> count($this-&gt;rules);</div>
<div class="line"><span class="lineno">  372</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a38d99acc70a1d8fd8f94455743b2d237" name="a38d99acc70a1d8fd8f94455743b2d237"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38d99acc70a1d8fd8f94455743b2d237">&#9670;&#160;</a></span>parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00323">323</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  324</span>    {</div>
<div class="line"><span class="lineno">  325</span>        global <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>;</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>        <span class="comment">// Merge comments by reloading rules</span></div>
<div class="line"><span class="lineno">  328</span>        <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>-&gt;Controller($output, <span class="stringliteral">&#39;GenerateRules&#39;</span>, json_encode($this-&gt;rules), 0, 1);</div>
<div class="line"><span class="lineno">  329</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>) {</div>
<div class="line"><span class="lineno">  330</span>            <a class="code hl_function" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a>(<a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;ERROR&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . <a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;Cannot generate rules&#39;</span>), <span class="stringliteral">&#39;auto&#39;</span>, <span class="stringliteral">&#39;ERROR&#39;</span>);</div>
<div class="line"><span class="lineno">  331</span>        }</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>        $ruleStr= trim(implode(<span class="stringliteral">&quot;\n&quot;</span>, $output));</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>        unset($output);</div>
<div class="line"><span class="lineno">  336</span>        <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>-&gt;Controller($output, <span class="stringliteral">&#39;ParseRules&#39;</span>, json_encode($ruleStr), 1);</div>
<div class="line"><span class="lineno">  337</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>) {</div>
<div class="line"><span class="lineno">  338</span>            <a class="code hl_function" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a>(<a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;ERROR&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . <a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;Cannot parse rules&#39;</span>), <span class="stringliteral">&#39;auto&#39;</span>, <span class="stringliteral">&#39;ERROR&#39;</span>);</div>
<div class="line"><span class="lineno">  339</span>        }</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>        $rulesArray= json_decode($output[0], TRUE)[<span class="stringliteral">&#39;rules&#39;</span>];</div>
<div class="line"><span class="lineno">  342</span>        $this-&gt;<a class="code hl_function" href="classView_1_1RuleSet.html#a43ff75d8518bbd9527992c20a869a4cc">loadArray</a>($rulesArray);</div>
<div class="line"><span class="lineno">  343</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="install_8php_source.html#l00057">$View</a>, <a class="el" href="view_8php_source.html#l00656">_NOTICE()</a>, and <a class="el" href="Installer_2lib_8php_source.html#l00030">PrintHelpWindow()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_1_1RuleSet_a38d99acc70a1d8fd8f94455743b2d237_cgraph.png" border="0" usemap="#aclassView_1_1RuleSet_a38d99acc70a1d8fd8f94455743b2d237_cgraph" alt=""/></div>
<map name="aclassView_1_1RuleSet_a38d99acc70a1d8fd8f94455743b2d237_cgraph" id="aclassView_1_1RuleSet_a38d99acc70a1d8fd8f94455743b2d237_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,64,56"/>
<area shape="rect" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f" title="For classifying gettext strings into files." alt="" coords="140,5,219,31"/>
<area shape="rect" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4" title="Satisfies Controller." alt="" coords="112,55,247,80"/>
</map>
</div>

</div>
</div>
<a id="a0515cf408d0001db8d0d6aef4c1829d1" name="a0515cf408d0001db8d0d6aef4c1829d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0515cf408d0001db8d0d6aef4c1829d1">&#9670;&#160;</a></span>save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">save </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleObj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$testResult</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Saves the modified rule. </p>
<p>First checks if the user has clicked the Save button.</p>
<p>We don't save the rule if there are errors, unless the user forces saving.</p>
<p>We need the $action param to see if we are editing an existing rule or adding a new one. So if the user was editing a new rule, it does not exist in the ruleset yet. Because we do not modify the ruleset until the rule is saved.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$action</td><td>Current state of the edit page. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$ruleNumber</td><td>Rule number. </td></tr>
    <tr><td class="paramtype">object</td><td class="paramname">$ruleObj</td><td>Modified rule object to save. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$testResult</td><td>Test result of the rule. </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000062">Todo:</a></b></dt><dd>Make conf.php a parameter </dd></dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00503">503</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  504</span>    {</div>
<div class="line"><span class="lineno">  505</span>        <span class="keywordflow">if</span> (filter_has_var(INPUT_POST, <span class="stringliteral">&#39;save&#39;</span>) &amp;&amp; filter_input(INPUT_POST, <span class="stringliteral">&#39;save&#39;</span>) == <a class="code hl_function" href="view_8php.html#a365ac814f4e5c717bd9ce48ab65b97b5">_CONTROL</a>(<span class="stringliteral">&#39;Save&#39;</span>)) {</div>
<div class="line"><span class="lineno">  506</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="conf_8write_8php.html#a98e8b2e53fdffb694097f9507fee692e">$testResult</a> || filter_input(INPUT_POST, <span class="stringliteral">&#39;forcesave&#39;</span>)) {</div>
<div class="line"><span class="lineno">  507</span>                <span class="keywordflow">if</span> ($action == <span class="stringliteral">&#39;create&#39;</span>) {</div>
<div class="line"><span class="lineno">  508</span>                    $this-&gt;<a class="code hl_function" href="classView_1_1RuleSet.html#abfe86d20259ba5cf6c22d032d177fab9">add</a>($ruleNumber);</div>
<div class="line"><span class="lineno">  509</span>                }</div>
<div class="line"><span class="lineno">  510</span>                $this-&gt;rules[$ruleNumber]= $ruleObj;</div>
<div class="line"><span class="lineno">  511</span>                unset(<a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;edit&#39;</span>]);</div>
<div class="line"><span class="lineno">  513</span>                header(<span class="stringliteral">&#39;Location: /pf/conf.php&#39;</span>);</div>
<div class="line"><span class="lineno">  514</span>                <a class="code hl_variable" href="dhcpd_2index_8php.html#a6733eb5f605d09eaede9845835d71c4e">exit</a>;</div>
<div class="line"><span class="lineno">  515</span>            }</div>
<div class="line"><span class="lineno">  516</span>        }</div>
<div class="line"><span class="lineno">  517</span>    }</div>
<div class="ttc" id="aclassView_1_1RuleSet_html_abfe86d20259ba5cf6c22d032d177fab9"><div class="ttname"><a href="classView_1_1RuleSet.html#abfe86d20259ba5cf6c22d032d177fab9">View\RuleSet\add</a></div><div class="ttdeci">add($ruleNumber=0)</div><div class="ttdoc">Adds an empty rule location to the ruleset.</div><div class="ttdef"><b>Definition:</b> <a href="View_2pf_2lib_2RuleSet_8php_source.html#l00210">RuleSet.php:210</a></div></div>
<div class="ttc" id="aconf_8write_8php_html_a98e8b2e53fdffb694097f9507fee692e"><div class="ttname"><a href="conf_8write_8php.html#a98e8b2e53fdffb694097f9507fee692e">$testResult</a></div><div class="ttdeci">if(count($_POST) &amp;&amp;!filter_has_var(INPUT_POST, 'numbers')) $testResult</div><div class="ttdef"><b>Definition:</b> <a href="conf_8write_8php_source.html#l00028">conf.write.php:28</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="logs_8archives_8php_source.html#l00081">$_SESSION</a>, <a class="el" href="conf_8write_8php_source.html#l00028">$testResult</a>, <a class="el" href="view_8php_source.html#l00650">_CONTROL()</a>, and <a class="el" href="dhcpd_2index_8php_source.html#l00023">exit</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_1_1RuleSet_a0515cf408d0001db8d0d6aef4c1829d1_cgraph.png" border="0" usemap="#aclassView_1_1RuleSet_a0515cf408d0001db8d0d6aef4c1829d1_cgraph" alt=""/></div>
<map name="aclassView_1_1RuleSet_a0515cf408d0001db8d0d6aef4c1829d1_cgraph" id="aclassView_1_1RuleSet_a0515cf408d0001db8d0d6aef4c1829d1_cgraph">
<area shape="rect" title="Saves the modified rule." alt="" coords="5,5,59,31"/>
<area shape="rect" href="view_8php.html#a365ac814f4e5c717bd9ce48ab65b97b5" title="For classifying gettext strings into files." alt="" coords="107,5,199,31"/>
</map>
</div>

</div>
</div>
<a id="afb352c46e469765da3b900f5513be404" name="afb352c46e469765da3b900f5513be404"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb352c46e469765da3b900f5513be404">&#9670;&#160;</a></span>separate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">separate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleNumber</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00294">294</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  295</span>    {</div>
<div class="line"><span class="lineno">  296</span>        global <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>;</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>        $rulesArray= array();</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>        <span class="comment">// Can be used to merge separated comments by reloading rules</span></div>
<div class="line"><span class="lineno">  301</span>        $lines= explode(<span class="stringliteral">&quot;\n&quot;</span>, $this-&gt;rules[$ruleNumber]-&gt;rule[<span class="stringliteral">&#39;comment&#39;</span>]);</div>
<div class="line"><span class="lineno">  302</span>        <span class="keywordflow">for</span> ($i= 0; $i &lt; count($lines); $i++) {</div>
<div class="line"><span class="lineno">  303</span>            $ruleStr= <span class="stringliteral">&#39;# &#39;</span>.trim($lines[$i]);</div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span>            <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>-&gt;Controller($parseOut, <span class="stringliteral">&#39;ParseRules&#39;</span>, json_encode($ruleStr), 1);</div>
<div class="line"><span class="lineno">  306</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>) {</div>
<div class="line"><span class="lineno">  307</span>                <a class="code hl_function" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a>(<a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;ERROR&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . <a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;Cannot parse rules&#39;</span>), <span class="stringliteral">&#39;auto&#39;</span>, <span class="stringliteral">&#39;ERROR&#39;</span>);</div>
<div class="line"><span class="lineno">  308</span>            }</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>            $rulesArray[]= json_decode($parseOut[0], TRUE)[<span class="stringliteral">&#39;rules&#39;</span>][0];</div>
<div class="line"><span class="lineno">  311</span>        }</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>        $ruleSet= <span class="keyword">new</span> RuleSet();</div>
<div class="line"><span class="lineno">  314</span>        $ruleSet-&gt;loadArray($rulesArray);</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>        unset($this-&gt;rules[$ruleNumber]);</div>
<div class="line"><span class="lineno">  317</span>        <span class="comment">// array_slice() takes care of possible off-by-one error due to unset above</span></div>
<div class="line"><span class="lineno">  318</span>        $head= array_slice($this-&gt;rules, 0, $ruleNumber);</div>
<div class="line"><span class="lineno">  319</span>        $tail= array_slice($this-&gt;rules, $ruleNumber);</div>
<div class="line"><span class="lineno">  320</span>        $this-&gt;rules= array_merge($head, $ruleSet-&gt;rules, $tail);</div>
<div class="line"><span class="lineno">  321</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="install_8php_source.html#l00057">$View</a>, <a class="el" href="view_8php_source.html#l00656">_NOTICE()</a>, and <a class="el" href="Installer_2lib_8php_source.html#l00030">PrintHelpWindow()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_1_1RuleSet_afb352c46e469765da3b900f5513be404_cgraph.png" border="0" usemap="#aclassView_1_1RuleSet_afb352c46e469765da3b900f5513be404_cgraph" alt=""/></div>
<map name="aclassView_1_1RuleSet_afb352c46e469765da3b900f5513be404_cgraph" id="aclassView_1_1RuleSet_afb352c46e469765da3b900f5513be404_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,84,56"/>
<area shape="rect" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f" title="For classifying gettext strings into files." alt="" coords="160,5,239,31"/>
<area shape="rect" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4" title="Satisfies Controller." alt="" coords="132,55,267,80"/>
</map>
</div>

</div>
</div>
<a id="ab1423547e962111b353b79c6633ce7cd" name="ab1423547e962111b353b79c6633ce7cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1423547e962111b353b79c6633ce7cd">&#9670;&#160;</a></span>setupEditSession()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setupEditSession </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$cat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$ruleNumber</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the current state of the edit page and sets up the session vars. </p>
<p>If we change the rule number requested, perhaps because it is not a valid number in the ruleset, we change the current state to 'add'.</p>
<p>We change the state from 'create' to 'add' if the session properties do not match. Such a mismatch means that the user was editing a different rule previously.</p>
<p>If the state is 'edit' and the session variables are not set up yet, we clone the rule for editing. However, we also check if the user arrives the edit page by requesting on the address line, in which case we should make sure that the rule number exists and there was a previous edit session.</p>
<p>Note that the 'add' state means that we should reinitialize the session variables.</p>
<p>Note also that we always work on a clone of the rule, not the actual rule in the ruleset. Because we should not modify the rule until the user saves the changes s/he made.</p>
<p>One purpose of this state machine is that we should not reinitialize the session vars each time the user submits the edit page.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000060">Todo:</a></b></dt><dd>We need a state diagram for this FSM.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$cat</td><td>Type of the current rule to be edited. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$action</td><td>Current state of the edit page. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$ruleNumber</td><td>Rule number. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section attention"><dt>Attention</dt><dd>Add and del operations on multi-valued vars use GET method, so check if there is an active edit session.</dd></dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00401">401</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  402</span>    {</div>
<div class="line"><span class="lineno">  403</span>        global <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>;</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>        <span class="comment">// Make sure we deal only with rule numbers possible in the current ruleset</span></div>
<div class="line"><span class="lineno">  406</span>        <span class="keywordflow">if</span> (!array_key_exists($ruleNumber, <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>-&gt;RuleSet-&gt;rules)) {</div>
<div class="line"><span class="lineno">  407</span>            $ruleNumber= $this-&gt;<a class="code hl_function" href="classView_1_1RuleSet.html#a5a854c506e8544694597487ba5cacb92">computeNewRuleNumber</a>($ruleNumber);</div>
<div class="line"><span class="lineno">  408</span>            <span class="keywordflow">if</span> ($action == <span class="stringliteral">&#39;edit&#39;</span>) {</div>
<div class="line"><span class="lineno">  409</span>                $action= <span class="stringliteral">&#39;add&#39;</span>;</div>
<div class="line"><span class="lineno">  410</span>            }</div>
<div class="line"><span class="lineno">  411</span>        }</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>        <span class="keywordflow">if</span> ($action == <span class="stringliteral">&#39;create&#39;</span>) {</div>
<div class="line"><span class="lineno">  414</span>            <span class="keywordflow">if</span> (!isset(<a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;edit&#39;</span>][<span class="stringliteral">&#39;object&#39;</span>]) || <a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;edit&#39;</span>][<span class="stringliteral">&#39;object&#39;</span>]-&gt;cat!= $cat || <a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;edit&#39;</span>][<span class="stringliteral">&#39;ruleNumber&#39;</span>] != $ruleNumber) {</div>
<div class="line"><span class="lineno">  415</span>                $action= <span class="stringliteral">&#39;add&#39;</span>;</div>
<div class="line"><span class="lineno">  416</span>            }</div>
<div class="line"><span class="lineno">  417</span>        }</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>        <span class="keywordflow">if</span> ($action == <span class="stringliteral">&#39;edit&#39;</span>) {</div>
<div class="line"><span class="lineno">  420</span>            <span class="keywordflow">if</span> (!isset(<a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;edit&#39;</span>][<span class="stringliteral">&#39;object&#39;</span>]) || <a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;edit&#39;</span>][<span class="stringliteral">&#39;object&#39;</span>]-&gt;cat != $cat || <a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;edit&#39;</span>][<span class="stringliteral">&#39;ruleNumber&#39;</span>] != $ruleNumber ||</div>
<div class="line"><span class="lineno">  421</span>                <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>-&gt;RuleSet-&gt;rules[$ruleNumber]-&gt;cat != $cat) {</div>
<div class="line"><span class="lineno">  422</span>                <span class="comment">// The rule being edited has changed, setup a new edit session</span></div>
<div class="line"><span class="lineno">  423</span>                <span class="keywordflow">if</span> (array_key_exists($ruleNumber, <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>-&gt;RuleSet-&gt;rules)) {</div>
<div class="line"><span class="lineno">  424</span>                    <span class="comment">// Rule exists, so clone from the ruleset</span></div>
<div class="line"><span class="lineno">  425</span>                    unset(<a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;edit&#39;</span>]);</div>
<div class="line"><span class="lineno">  426</span>                    <a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;edit&#39;</span>][<span class="stringliteral">&#39;ruleNumber&#39;</span>]= $ruleNumber;</div>
<div class="line"><span class="lineno">  427</span>                    <a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;edit&#39;</span>][<span class="stringliteral">&#39;object&#39;</span>]= clone $this-&gt;rules[$ruleNumber];</div>
<div class="line"><span class="lineno">  428</span>                } elseif (!isset(<a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;edit&#39;</span>])) {</div>
<div class="line"><span class="lineno">  430</span>                    <span class="comment">// Rule does not exists, assume add if we are not already editing a new rule</span></div>
<div class="line"><span class="lineno">  431</span>                    <span class="comment">// Assume a new rule requested, if the page is submitted on the address line with a non-existing rule number</span></div>
<div class="line"><span class="lineno">  432</span>                    $action= <span class="stringliteral">&#39;add&#39;</span>;</div>
<div class="line"><span class="lineno">  433</span>                }</div>
<div class="line"><span class="lineno">  434</span>            }</div>
<div class="line"><span class="lineno">  435</span>        }</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>        <span class="keywordflow">if</span> ($action == <span class="stringliteral">&#39;add&#39;</span>) {</div>
<div class="line"><span class="lineno">  438</span>            <span class="comment">// Create a new rule and setup a new edit session</span></div>
<div class="line"><span class="lineno">  439</span>            <span class="comment">// Change action state to create, so we don&#39;t come back here to reinit session</span></div>
<div class="line"><span class="lineno">  440</span>            $action= <span class="stringliteral">&#39;create&#39;</span>;</div>
<div class="line"><span class="lineno">  441</span>            unset(<a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;edit&#39;</span>]);</div>
<div class="line"><span class="lineno">  442</span>            <a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;edit&#39;</span>][<span class="stringliteral">&#39;ruleNumber&#39;</span>]= $ruleNumber;</div>
<div class="line"><span class="lineno">  443</span>            $cat= __NAMESPACE__ . <span class="charliteral">&#39;\\&#39;</span> . $cat;</div>
<div class="line"><span class="lineno">  444</span>            <a class="code hl_variable" href="logs_8archives_8php.html#a7430243fef5a97ca3ca2324775d4dfec">$_SESSION</a>[<span class="stringliteral">&#39;edit&#39;</span>][<span class="stringliteral">&#39;object&#39;</span>]= <span class="keyword">new</span> $cat(<span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><span class="lineno">  445</span>        }</div>
<div class="line"><span class="lineno">  446</span>    }</div>
<div class="ttc" id="aclassView_1_1RuleSet_html_a5a854c506e8544694597487ba5cacb92"><div class="ttname"><a href="classView_1_1RuleSet.html#a5a854c506e8544694597487ba5cacb92">View\RuleSet\computeNewRuleNumber</a></div><div class="ttdeci">computeNewRuleNumber($ruleNumber=0)</div><div class="ttdoc">Computes the actual rule number which can be allocated.</div><div class="ttdef"><b>Definition:</b> <a href="View_2pf_2lib_2RuleSet_8php_source.html#l00351">RuleSet.php:351</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="logs_8archives_8php_source.html#l00081">$_SESSION</a>, and <a class="el" href="install_8php_source.html#l00057">$View</a>.</p>

</div>
</div>
<a id="afe4cba22504dd2b5bcf06f1e770c5339" name="afe4cba22504dd2b5bcf06f1e770c5339"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe4cba22504dd2b5bcf06f1e770c5339">&#9670;&#160;</a></span>test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleObj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests the given rule. </p>
<p>We create a rules array upto the rule number provided, and append the rule to be tested to the end. Note that the $ruleObj is the the clone rule modified on the edit page.</p>
<p>We simply use json encode and decode functions to create the rules array, because json encode function includes only the public member variables only. Note also that we pass TRUE for $assoc param, to convert objects to arrays.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$ruleNumber</td><td>The number of the rule to test. </td></tr>
    <tr><td class="paramtype">\View\Rule</td><td class="paramname">$ruleObj</td><td>The rule object to test. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool Test result returned from the <a class="el" href="classModel.html">Model</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00462">462</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  463</span>    {</div>
<div class="line"><span class="lineno">  464</span>        global <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>;</div>
<div class="line"><span class="lineno">  465</span>        </div>
<div class="line"><span class="lineno">  466</span>        $rulesArray= array_slice(json_decode(json_encode($this), TRUE)[<span class="stringliteral">&#39;rules&#39;</span>], 0, $ruleNumber);</div>
<div class="line"><span class="lineno">  467</span>        $rulesArray[]= json_decode(json_encode($ruleObj), TRUE);</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>-&gt;Controller(<a class="code hl_variable" href="Model_2include_8php.html#a8a55ddd2b83051d9d86510dcd04f9f4c">$Output</a>, <span class="stringliteral">&#39;TestRules&#39;</span>, json_encode($rulesArray));</div>
<div class="line"><span class="lineno">  470</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00092">$Output</a>, and <a class="el" href="install_8php_source.html#l00057">$View</a>.</p>

</div>
</div>
<a id="a32ea8f746244d21480f530220a0407f7" name="a32ea8f746244d21480f530220a0407f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32ea8f746244d21480f530220a0407f7">&#9670;&#160;</a></span>uncomment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uncomment </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleNumber</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00264">264</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  265</span>    {</div>
<div class="line"><span class="lineno">  266</span>        global <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>;</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>        $rulesArray= array();</div>
<div class="line"><span class="lineno">  269</span>        <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= <a class="code hl_variable" href="install_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>-&gt;Controller($output, <span class="stringliteral">&#39;ParseRules&#39;</span>, json_encode($this-&gt;rules[$ruleNumber]-&gt;rule[<span class="stringliteral">&#39;comment&#39;</span>]), 1);</div>
<div class="line"><span class="lineno">  270</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>) {</div>
<div class="line"><span class="lineno">  271</span>            <a class="code hl_function" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a>(<a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;ERROR&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . <a class="code hl_function" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f">_NOTICE</a>(<span class="stringliteral">&#39;Cannot parse rules&#39;</span>), <span class="stringliteral">&#39;auto&#39;</span>, <span class="stringliteral">&#39;ERROR&#39;</span>);</div>
<div class="line"><span class="lineno">  272</span>        }</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>        $rulesArray= json_decode($output[0], TRUE)[<span class="stringliteral">&#39;rules&#39;</span>];</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>        $ruleSet= <span class="keyword">new</span> RuleSet();</div>
<div class="line"><span class="lineno">  277</span>        $ruleSet-&gt;loadArray($rulesArray);</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>        unset($this-&gt;rules[$ruleNumber]);</div>
<div class="line"><span class="lineno">  280</span>        <span class="comment">// array_slice() takes care of possible off-by-one error due to unset above</span></div>
<div class="line"><span class="lineno">  281</span>        $head= array_slice($this-&gt;rules, 0, $ruleNumber);</div>
<div class="line"><span class="lineno">  282</span>        $tail= array_slice($this-&gt;rules, $ruleNumber);</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>        <span class="keywordflow">if</span> (count($ruleSet-&gt;rules)) {</div>
<div class="line"><span class="lineno">  285</span>            $this-&gt;rules= array_merge($head, $ruleSet-&gt;rules, $tail);</div>
<div class="line"><span class="lineno">  286</span>        }</div>
<div class="line"><span class="lineno">  287</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  288</span>            $blank= <span class="keyword">new</span> Blank();</div>
<div class="line"><span class="lineno">  289</span>            $blank-&gt;rule[<span class="stringliteral">&#39;blank&#39;</span>]= <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  290</span>            $this-&gt;rules= array_merge($head, array($blank), $tail);</div>
<div class="line"><span class="lineno">  291</span>        }</div>
<div class="line"><span class="lineno">  292</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="install_8php_source.html#l00057">$View</a>, <a class="el" href="view_8php_source.html#l00656">_NOTICE()</a>, and <a class="el" href="Installer_2lib_8php_source.html#l00030">PrintHelpWindow()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classView_1_1RuleSet_a32ea8f746244d21480f530220a0407f7_cgraph.png" border="0" usemap="#aclassView_1_1RuleSet_a32ea8f746244d21480f530220a0407f7_cgraph" alt=""/></div>
<map name="aclassView_1_1RuleSet_a32ea8f746244d21480f530220a0407f7_cgraph" id="aclassView_1_1RuleSet_a32ea8f746244d21480f530220a0407f7_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,105,56"/>
<area shape="rect" href="view_8php.html#a4aa5270b4a28926a0ea160561a3ba51f" title="For classifying gettext strings into files." alt="" coords="181,5,260,31"/>
<area shape="rect" href="Installer_2lib_8php.html#ac089920689dafbf6a510f3b87eb6a6d4" title="Satisfies Controller." alt="" coords="153,55,288,80"/>
</map>
</div>

</div>
</div>
<a id="a53bccdcfa3b2b954917e854dca5b5b31" name="a53bccdcfa3b2b954917e854dca5b5b31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53bccdcfa3b2b954917e854dca5b5b31">&#9670;&#160;</a></span>up()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">up </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleNumber</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Moves a rule up in the ruleset. </p>
<p>Simply switches the places of two rules.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$ruleNumber</td><td>The number of the rule to move up. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00140">140</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  141</span>    {</div>
<div class="line"><span class="lineno">  142</span>        <span class="keywordflow">if</span> (isset($this-&gt;rules[$ruleNumber - 1])) {</div>
<div class="line"><span class="lineno">  143</span>            $tmp= $this-&gt;rules[$ruleNumber - 1];</div>
<div class="line"><span class="lineno">  144</span>            $this-&gt;rules[$ruleNumber - 1]= $this-&gt;rules[$ruleNumber];</div>
<div class="line"><span class="lineno">  145</span>            $this-&gt;rules[$ruleNumber]= $tmp;</div>
<div class="line"><span class="lineno">  146</span>        }</div>
<div class="line"><span class="lineno">  147</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a id="a0722441477f957078ee2437054556cbc" name="a0722441477f957078ee2437054556cbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0722441477f957078ee2437054556cbc">&#9670;&#160;</a></span>$filename</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$filename = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The name of the currently loaded file. </p>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00053">53</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>

</div>
</div>
<a id="a811d22ac55b4592f7f2a202529629419" name="a811d22ac55b4592f7f2a202529629419"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a811d22ac55b4592f7f2a202529629419">&#9670;&#160;</a></span>$rules</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$rules = array()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The list holding the ruleset. </p>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00063">63</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>

</div>
</div>
<a id="a5e92bb37ab892f2f238ed28c5c2c40d2" name="a5e92bb37ab892f2f238ed28c5c2c40d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e92bb37ab892f2f238ed28c5c2c40d2">&#9670;&#160;</a></span>$uploaded</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$uploaded = FALSE</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Whether the file is uploaded or not. </p>

<p class="definition">Definition at line <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html#l00058">58</a> of file <a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/View/pf/lib/<a class="el" href="View_2pf_2lib_2RuleSet_8php_source.html">RuleSet.php</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceView.html">View</a></li><li class="navelem"><a class="el" href="classView_1_1RuleSet.html">RuleSet</a></li>
    <li class="footer">Generated on Sun Apr 30 2023 00:52:50 for PF Firewall by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
