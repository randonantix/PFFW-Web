<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PF Firewall: Rule Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PF Firewall<span id="projectnumber">&#160;7.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classModel_1_1Rule.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Data Fields</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle"><div class="title">Rule Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Base class for all model rule types.  
 <a href="classModel_1_1Rule.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for Rule:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_1_1Rule__inherit__graph.png" border="0" usemap="#aRule_inherit__map" alt="Inheritance graph"/></div>
<map name="aRule_inherit__map" id="aRule_inherit__map">
<area shape="rect" title="Base class for all model rule types." alt="" coords="517,5,567,31"/>
<area shape="rect" href="classModel_1_1Antispoof.html" title=" " alt="" coords="5,79,89,104"/>
<area shape="rect" href="classModel_1_1Blank.html" title=" " alt="" coords="114,79,173,104"/>
<area shape="rect" href="classModel_1_1Comment.html" title=" " alt="" coords="197,79,284,104"/>
<area shape="rect" href="classModel_1_1Limit.html" title=" " alt="" coords="308,79,363,104"/>
<area shape="rect" href="classModel_1_1LoadAnchor.html" title=" " alt="" coords="387,79,486,104"/>
<area shape="rect" href="classModel_1_1Macro.html" title=" " alt="" coords="511,79,573,104"/>
<area shape="rect" href="classModel_1_1Option.html" title=" " alt="" coords="597,79,663,104"/>
<area shape="rect" href="classModel_1_1Queue.html" title=" " alt="" coords="687,79,751,104"/>
<area shape="rect" href="classModel_1_1Table.html" title=" " alt="" coords="775,79,831,104"/>
<area shape="rect" href="classModel_1_1Timeout.html" title=" " alt="" coords="856,79,932,104"/>
<area shape="rect" href="classModel_1_1__Include.html" title=" " alt="" coords="956,79,1032,104"/>
<area shape="rect" href="classModel_1_1State.html" title=" " alt="" coords="866,152,922,177"/>
<area shape="rect" href="classModel_1_1FilterBase.html" title=" " alt="" coords="851,225,937,251"/>
<area shape="rect" href="classModel_1_1Anchor.html" title="Class for Anchor rules." alt="" coords="818,299,885,324"/>
<area shape="rect" href="classModel_1_1Filter.html" title=" " alt="" coords="909,299,964,324"/>
<area shape="rect" href="classModel_1_1AfTo.html" title="Class for AF Translation rules." alt="" coords="645,372,695,397"/>
<area shape="rect" href="classModel_1_1DivertPacket.html" title=" " alt="" coords="719,372,823,397"/>
<area shape="rect" href="classModel_1_1DivertTo.html" title=" " alt="" coords="848,372,924,397"/>
<area shape="rect" href="classModel_1_1NatBase.html" title=" " alt="" coords="949,372,1026,397"/>
<area shape="rect" href="classModel_1_1Route.html" title=" " alt="" coords="1051,372,1111,397"/>
<area shape="rect" href="classModel_1_1Scrub.html" title=" " alt="" coords="1135,372,1194,397"/>
<area shape="rect" href="classModel_1_1BinatTo.html" title=" " alt="" coords="863,445,933,471"/>
<area shape="rect" href="classModel_1_1NatTo.html" title=" " alt="" coords="958,445,1017,471"/>
<area shape="rect" href="classModel_1_1RdrTo.html" title=" " alt="" coords="1041,445,1099,471"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:adfbb717507cfdff51e565e468b5be13e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#adfbb717507cfdff51e565e468b5be13e">__construct</a> ($str)</td></tr>
<tr class="memdesc:adfbb717507cfdff51e565e468b5be13e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and initializes the rule object with the given rule string.  <br /></td></tr>
<tr class="separator:adfbb717507cfdff51e565e468b5be13e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4a887756fc1b11895f47dd07ab31f28"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#af4a887756fc1b11895f47dd07ab31f28">load</a> ($arr, $ruleNumber=0, $force=FALSE)</td></tr>
<tr class="memdesc:af4a887756fc1b11895f47dd07ab31f28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the rule object with the given data.  <br /></td></tr>
<tr class="separator:af4a887756fc1b11895f47dd07ab31f28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6945888a8bff78801ed111a0614e029a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a6945888a8bff78801ed111a0614e029a">validate</a> ($ruleArray, $force=FALSE)</td></tr>
<tr class="memdesc:a6945888a8bff78801ed111a0614e029a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validates rule array.  <br /></td></tr>
<tr class="separator:a6945888a8bff78801ed111a0614e029a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a510cd31ccdc9ebbb4ee79ac1b87e5967"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a510cd31ccdc9ebbb4ee79ac1b87e5967">validateKeyDef</a> (&amp;$arr, $key, $def, $parent, $force=FALSE)</td></tr>
<tr class="memdesc:a510cd31ccdc9ebbb4ee79ac1b87e5967"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the validation method to apply to rule value.  <br /></td></tr>
<tr class="separator:a510cd31ccdc9ebbb4ee79ac1b87e5967"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac346884d2c002f9049547879f9047dbb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#ac346884d2c002f9049547879f9047dbb">validateArrayValues</a> (&amp;$arr, $key, $def, $parent, $force=FALSE)</td></tr>
<tr class="memdesc:ac346884d2c002f9049547879f9047dbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies validation method to values in rule array.  <br /></td></tr>
<tr class="separator:ac346884d2c002f9049547879f9047dbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3fb11187e81b9bc9f010a8b18831824"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#af3fb11187e81b9bc9f010a8b18831824">validateValue</a> ($key, $value, $def, $parent, $force=FALSE)</td></tr>
<tr class="memdesc:af3fb11187e81b9bc9f010a8b18831824"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validates a value.  <br /></td></tr>
<tr class="separator:af3fb11187e81b9bc9f010a8b18831824"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d0e49aacf195439c437277b22a81062"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a4d0e49aacf195439c437277b22a81062">parse</a> ($str)</td></tr>
<tr class="memdesc:a4d0e49aacf195439c437277b22a81062"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses the given rule string.  <br /></td></tr>
<tr class="separator:a4d0e49aacf195439c437277b22a81062"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4be4055f3361d4800e16bc2e2e38cda6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a4be4055f3361d4800e16bc2e2e38cda6">init</a> ()</td></tr>
<tr class="separator:a4be4055f3361d4800e16bc2e2e38cda6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6011811d5724857e81bb02bc4e21de36"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a6011811d5724857e81bb02bc4e21de36">parseComment</a> ()</td></tr>
<tr class="memdesc:a6011811d5724857e81bb02bc4e21de36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses inline comments.  <br /></td></tr>
<tr class="separator:a6011811d5724857e81bb02bc4e21de36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c107fb139f601aed9aa988531ce9ae6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a1c107fb139f601aed9aa988531ce9ae6">sanitize</a> ()</td></tr>
<tr class="memdesc:a1c107fb139f601aed9aa988531ce9ae6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sanitizes rule string.  <br /></td></tr>
<tr class="separator:a1c107fb139f601aed9aa988531ce9ae6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c0c41e7a45a3c1899074b89c235114c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a6c0c41e7a45a3c1899074b89c235114c">split</a> ()</td></tr>
<tr class="memdesc:a6c0c41e7a45a3c1899074b89c235114c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Splits rule string into words.  <br /></td></tr>
<tr class="separator:a6c0c41e7a45a3c1899074b89c235114c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0de0a0ad5f249ef4d21d2257f685f046"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a0de0a0ad5f249ef4d21d2257f685f046">isEndOfWords</a> ()</td></tr>
<tr class="memdesc:a0de0a0ad5f249ef4d21d2257f685f046"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the index points at the last word in the list.  <br /></td></tr>
<tr class="separator:a0de0a0ad5f249ef4d21d2257f685f046"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbbf5d9bac06b78b5e012800e16629f2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#adbbf5d9bac06b78b5e012800e16629f2">parseNVP</a> ($key)</td></tr>
<tr class="memdesc:adbbf5d9bac06b78b5e012800e16629f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assigns the current word to the given key.  <br /></td></tr>
<tr class="separator:adbbf5d9bac06b78b5e012800e16629f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acca9e9e4b74ac3e5e43de8046f524a7d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#acca9e9e4b74ac3e5e43de8046f524a7d">parseNVPInc</a> ($key)</td></tr>
<tr class="memdesc:acca9e9e4b74ac3e5e43de8046f524a7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assigns the current word to the given key and increments the index.  <br /></td></tr>
<tr class="separator:acca9e9e4b74ac3e5e43de8046f524a7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c95d5920a522b69f73c9e831a7fca77"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a0c95d5920a522b69f73c9e831a7fca77">parseNextValue</a> ()</td></tr>
<tr class="memdesc:a0c95d5920a522b69f73c9e831a7fca77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assigns the next word to the current word as key and increments the index.  <br /></td></tr>
<tr class="separator:a0c95d5920a522b69f73c9e831a7fca77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae322db979a768e52584b58925d9fef41"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#ae322db979a768e52584b58925d9fef41">parseNextNVP</a> ($key)</td></tr>
<tr class="memdesc:ae322db979a768e52584b58925d9fef41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assigns the next word to the given key and increments the index.  <br /></td></tr>
<tr class="separator:ae322db979a768e52584b58925d9fef41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60008af4cf747b5858f80238a7a021c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a60008af4cf747b5858f80238a7a021c2">parseBool</a> ()</td></tr>
<tr class="memdesc:a60008af4cf747b5858f80238a7a021c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assigns TRUE to the current word as key.  <br /></td></tr>
<tr class="separator:a60008af4cf747b5858f80238a7a021c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14b410fb73379c15ac0b78f5eb34107e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a14b410fb73379c15ac0b78f5eb34107e">parseItems</a> ($key, $delimPre='{', $delimPost='}')</td></tr>
<tr class="memdesc:a14b410fb73379c15ac0b78f5eb34107e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assigns the items in delimiters to the given key.  <br /></td></tr>
<tr class="separator:a14b410fb73379c15ac0b78f5eb34107e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01df1ad0352a2d0c9c42b7e38ffc1a58"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a01df1ad0352a2d0c9c42b7e38ffc1a58">parseItem</a> ($delimPre='{', $delimPost='}')</td></tr>
<tr class="memdesc:a01df1ad0352a2d0c9c42b7e38ffc1a58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the items in delimiters and increments the index once for each word.  <br /></td></tr>
<tr class="separator:a01df1ad0352a2d0c9c42b7e38ffc1a58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f8f11122bd1c258b16838edceb8e1e6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a8f8f11122bd1c258b16838edceb8e1e6">parseParenthesized</a> ()</td></tr>
<tr class="memdesc:a8f8f11122bd1c258b16838edceb8e1e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the items in parentheses and increments the index once for each word.  <br /></td></tr>
<tr class="separator:a8f8f11122bd1c258b16838edceb8e1e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ea06e2649dc6ba385db5760c6af70f8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a6ea06e2649dc6ba385db5760c6af70f8">parsePortItem</a> ()</td></tr>
<tr class="memdesc:a6ea06e2649dc6ba385db5760c6af70f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets port item(s) and increments the index once for each word.  <br /></td></tr>
<tr class="separator:a6ea06e2649dc6ba385db5760c6af70f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abecfb2c99b09efd6623fcb698e7cc898"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#abecfb2c99b09efd6623fcb698e7cc898">parsePort</a> ()</td></tr>
<tr class="memdesc:abecfb2c99b09efd6623fcb698e7cc898"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a port item and increments the index once for each word.  <br /></td></tr>
<tr class="separator:abecfb2c99b09efd6623fcb698e7cc898"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ddc616519ddd2a1aca14ed5cc05328e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a9ddc616519ddd2a1aca14ed5cc05328e">parseDelimitedStr</a> ($key, $delimPre='&quot;', $delimPost= '&quot;')</td></tr>
<tr class="memdesc:a9ddc616519ddd2a1aca14ed5cc05328e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the string in delimiters and assign it to the given key.  <br /></td></tr>
<tr class="separator:a9ddc616519ddd2a1aca14ed5cc05328e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a992f76a0922b96572ab2f5e98d33d502"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a992f76a0922b96572ab2f5e98d33d502">parseString</a> ($delimPre='&quot;', $delimPost= '&quot;')</td></tr>
<tr class="memdesc:a992f76a0922b96572ab2f5e98d33d502"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the string in delimiters and increments the index once for each word.  <br /></td></tr>
<tr class="separator:a992f76a0922b96572ab2f5e98d33d502"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71f9ded8e965db5ffbf5abfe2df399f5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a71f9ded8e965db5ffbf5abfe2df399f5">parseAny</a> ()</td></tr>
<tr class="memdesc:a71f9ded8e965db5ffbf5abfe2df399f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assigns any to from or to keys.  <br /></td></tr>
<tr class="separator:a71f9ded8e965db5ffbf5abfe2df399f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade11e53c617595a99cfa62d9af9fa46a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#ade11e53c617595a99cfa62d9af9fa46a">parseSrcDest</a> ($portKey)</td></tr>
<tr class="memdesc:ade11e53c617595a99cfa62d9af9fa46a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets source or destination addresses and/or ports in the rule string.  <br /></td></tr>
<tr class="separator:ade11e53c617595a99cfa62d9af9fa46a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54a68405a3bd6bc1a1cfc2c4d4c1be7a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a54a68405a3bd6bc1a1cfc2c4d4c1be7a">parseOS</a> ()</td></tr>
<tr class="memdesc:a54a68405a3bd6bc1a1cfc2c4d4c1be7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets OS in host definition in the rule string.  <br /></td></tr>
<tr class="separator:a54a68405a3bd6bc1a1cfc2c4d4c1be7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67c9aa83f6831ac97f251aa7e844b147"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a67c9aa83f6831ac97f251aa7e844b147">parseLog</a> ()</td></tr>
<tr class="memdesc:a67c9aa83f6831ac97f251aa7e844b147"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets log specification in the rule string.  <br /></td></tr>
<tr class="separator:a67c9aa83f6831ac97f251aa7e844b147"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2990a052b6e735653adda2a1d19b4bd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#aa2990a052b6e735653adda2a1d19b4bd">genKey</a> ($key)</td></tr>
<tr class="memdesc:aa2990a052b6e735653adda2a1d19b4bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the given key.  <br /></td></tr>
<tr class="separator:aa2990a052b6e735653adda2a1d19b4bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac882848fb6fb22dc07512dd94fab8dda"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#ac882848fb6fb22dc07512dd94fab8dda">genValue</a> ($key, $head='', $tail='')</td></tr>
<tr class="memdesc:ac882848fb6fb22dc07512dd94fab8dda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the value of the given key.  <br /></td></tr>
<tr class="separator:ac882848fb6fb22dc07512dd94fab8dda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af54af6400a84c417ef91b561c476314e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#af54af6400a84c417ef91b561c476314e">genItems</a> ($key, $head='', $delimPre='{', $delimPost='}')</td></tr>
<tr class="memdesc:af54af6400a84c417ef91b561c476314e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the values of the given key.  <br /></td></tr>
<tr class="separator:af54af6400a84c417ef91b561c476314e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfe1395228186319db9c6619d606c304"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#adfe1395228186319db9c6619d606c304">generateItem</a> ($items, $head='', $delimPre='{', $delimPost='}')</td></tr>
<tr class="memdesc:adfe1395228186319db9c6619d606c304"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the given values in delimiters.  <br /></td></tr>
<tr class="separator:adfe1395228186319db9c6619d606c304"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4436066dc7a5f9e445faa2fccee13669"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a4436066dc7a5f9e445faa2fccee13669">genInterface</a> ()</td></tr>
<tr class="memdesc:a4436066dc7a5f9e445faa2fccee13669"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints interfaces with a leading 'on' keyword.  <br /></td></tr>
<tr class="separator:a4436066dc7a5f9e445faa2fccee13669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a087e88a2b0af88707fea99388aa30ca8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a087e88a2b0af88707fea99388aa30ca8">genComment</a> ()</td></tr>
<tr class="memdesc:a087e88a2b0af88707fea99388aa30ca8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints inline comment with a leading # char.  <br /></td></tr>
<tr class="separator:a087e88a2b0af88707fea99388aa30ca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af932173b7bc6a98121d898719e46c2f6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#af932173b7bc6a98121d898719e46c2f6">genLog</a> ()</td></tr>
<tr class="memdesc:af932173b7bc6a98121d898719e46c2f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints log definition of the rule.  <br /></td></tr>
<tr class="separator:af932173b7bc6a98121d898719e46c2f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a9e05c34c5aba2b3a1fcaadefe6f172eb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a9e05c34c5aba2b3a1fcaadefe6f172eb">$cat</a> = ''</td></tr>
<tr class="memdesc:a9e05c34c5aba2b3a1fcaadefe6f172eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rule category.  <br /></td></tr>
<tr class="separator:a9e05c34c5aba2b3a1fcaadefe6f172eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85b0fb17593555da65ddd33db4ad8444"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a85b0fb17593555da65ddd33db4ad8444">$rule</a> = array()</td></tr>
<tr class="memdesc:a85b0fb17593555da65ddd33db4ad8444"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal structure for rules.  <br /></td></tr>
<tr class="separator:a85b0fb17593555da65ddd33db4ad8444"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a7542d95618011800c61773127fa625cf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a7542d95618011800c61773127fa625cf">$str</a> = ''</td></tr>
<tr class="separator:a7542d95618011800c61773127fa625cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e53dfd2b001b81c9946fa05ec90e6f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$index</a> = 0</td></tr>
<tr class="separator:a23e53dfd2b001b81c9946fa05ec90e6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7018c653e9ec2b4c22b533145b4da2a6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a7018c653e9ec2b4c22b533145b4da2a6">$words</a> = array()</td></tr>
<tr class="memdesc:a7018c653e9ec2b4c22b533145b4da2a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">String to be parsed is split into words, this is the list holding those words.  <br /></td></tr>
<tr class="separator:a7018c653e9ec2b4c22b533145b4da2a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72c8c7754a73e2cd6b8a1537fafd46fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a72c8c7754a73e2cd6b8a1537fafd46fa">$ruleNumber</a> = 0</td></tr>
<tr class="separator:a72c8c7754a73e2cd6b8a1537fafd46fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fbd95bfcdf27d802a8c7938529a61ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a9fbd95bfcdf27d802a8c7938529a61ba">$keywords</a> = array()</td></tr>
<tr class="memdesc:a9fbd95bfcdf27d802a8c7938529a61ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">The keywords possible in this type of rule are accumulated in this array.  <br /></td></tr>
<tr class="separator:a9fbd95bfcdf27d802a8c7938529a61ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad30a971c97145df8297e4b4541b7127b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#ad30a971c97145df8297e4b4541b7127b">$keyInterface</a></td></tr>
<tr class="separator:ad30a971c97145df8297e4b4541b7127b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a041015ee18a86128af54756f493634a4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a041015ee18a86128af54756f493634a4">$keyAf</a></td></tr>
<tr class="separator:a041015ee18a86128af54756f493634a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad98a64fa8e9e88677a15587f62a45474"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#ad98a64fa8e9e88677a15587f62a45474">$keyLog</a></td></tr>
<tr class="separator:ad98a64fa8e9e88677a15587f62a45474"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7a08a65ba1786d5788767d5ec117c55"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#ac7a08a65ba1786d5788767d5ec117c55">$keyQuick</a></td></tr>
<tr class="separator:ac7a08a65ba1786d5788767d5ec117c55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8efd781e4f469d50e60f5c62ebc6dd5b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a8efd781e4f469d50e60f5c62ebc6dd5b">$typedef</a> = array()</td></tr>
<tr class="memdesc:a8efd781e4f469d50e60f5c62ebc6dd5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type definitions for the rule category are accumulated in this member var.  <br /></td></tr>
<tr class="separator:a8efd781e4f469d50e60f5c62ebc6dd5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c6205a05313bb99d22326effa594fda"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a5c6205a05313bb99d22326effa594fda">$typeInterface</a></td></tr>
<tr class="separator:a5c6205a05313bb99d22326effa594fda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16e6074571c059a912a50461f77c2d7d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a16e6074571c059a912a50461f77c2d7d">$typeAf</a></td></tr>
<tr class="separator:a16e6074571c059a912a50461f77c2d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23aa46f8a0a0b89e7817fc0d137dee32"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a23aa46f8a0a0b89e7817fc0d137dee32">$typeLog</a></td></tr>
<tr class="memdesc:a23aa46f8a0a0b89e7817fc0d137dee32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log can be of type either bool or array of values.  <br /></td></tr>
<tr class="separator:a23aa46f8a0a0b89e7817fc0d137dee32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e4a4ab312cf76f7cb8da432675403f1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a7e4a4ab312cf76f7cb8da432675403f1">$typeQuick</a></td></tr>
<tr class="separator:a7e4a4ab312cf76f7cb8da432675403f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb29924c3a2bc86eb23ee608c709c8bd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#aeb29924c3a2bc86eb23ee608c709c8bd">$typeComment</a></td></tr>
<tr class="separator:aeb29924c3a2bc86eb23ee608c709c8bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87953ecab962f6663d6d2e3dd06e5e23"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel_1_1Rule.html#a87953ecab962f6663d6d2e3dd06e5e23">$nestingStr</a></td></tr>
<tr class="memdesc:a87953ecab962f6663d6d2e3dd06e5e23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents nesting number while reporting errors in anchor inline rules.  <br /></td></tr>
<tr class="separator:a87953ecab962f6663d6d2e3dd06e5e23"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Base class for all model rule types. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00030">30</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="adfbb717507cfdff51e565e468b5be13e" name="adfbb717507cfdff51e565e468b5be13e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfbb717507cfdff51e565e468b5be13e">&#9670;&#160;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__construct </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and initializes the rule object with the given rule string. </p>
<p>We first set the nesting information, which is used in reporting errors occurred during parsing. Hence this string should be set before parsing the given string.</p>
<p>We also set the category or type of the rule.</p>
<p>Finally, we parse the given string, if not empty.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$str</td><td>String to parse. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classModel_1_1AfTo.html#adfbb717507cfdff51e565e468b5be13e">AfTo</a>, <a class="el" href="classModel_1_1Anchor.html#adfbb717507cfdff51e565e468b5be13e">Anchor</a>, <a class="el" href="classModel_1_1Antispoof.html#adfbb717507cfdff51e565e468b5be13e">Antispoof</a>, <a class="el" href="classModel_1_1BinatTo.html#adfbb717507cfdff51e565e468b5be13e">BinatTo</a>, <a class="el" href="classModel_1_1DivertPacket.html#adfbb717507cfdff51e565e468b5be13e">DivertPacket</a>, <a class="el" href="classModel_1_1DivertTo.html#adfbb717507cfdff51e565e468b5be13e">DivertTo</a>, <a class="el" href="classModel_1_1Filter.html#adfbb717507cfdff51e565e468b5be13e">Filter</a>, <a class="el" href="classModel_1_1FilterBase.html#adfbb717507cfdff51e565e468b5be13e">FilterBase</a>, <a class="el" href="classModel_1_1__Include.html#adfbb717507cfdff51e565e468b5be13e">_Include</a>, <a class="el" href="classModel_1_1Limit.html#adfbb717507cfdff51e565e468b5be13e">Limit</a>, <a class="el" href="classModel_1_1LoadAnchor.html#adfbb717507cfdff51e565e468b5be13e">LoadAnchor</a>, <a class="el" href="classModel_1_1Macro.html#adfbb717507cfdff51e565e468b5be13e">Macro</a>, <a class="el" href="classModel_1_1NatBase.html#adfbb717507cfdff51e565e468b5be13e">NatBase</a>, <a class="el" href="classModel_1_1NatTo.html#adfbb717507cfdff51e565e468b5be13e">NatTo</a>, <a class="el" href="classModel_1_1Option.html#adfbb717507cfdff51e565e468b5be13e">Option</a>, <a class="el" href="classModel_1_1Queue.html#adfbb717507cfdff51e565e468b5be13e">Queue</a>, <a class="el" href="classModel_1_1RdrTo.html#adfbb717507cfdff51e565e468b5be13e">RdrTo</a>, <a class="el" href="classModel_1_1Route.html#adfbb717507cfdff51e565e468b5be13e">Route</a>, <a class="el" href="classModel_1_1Scrub.html#adfbb717507cfdff51e565e468b5be13e">Scrub</a>, <a class="el" href="classModel_1_1State.html#adfbb717507cfdff51e565e468b5be13e">State</a>, <a class="el" href="classModel_1_1Table.html#adfbb717507cfdff51e565e468b5be13e">Table</a>, and <a class="el" href="classModel_1_1Timeout.html#adfbb717507cfdff51e565e468b5be13e">Timeout</a>.</p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00172">172</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  173</span>    {</div>
<div class="line"><span class="lineno">  174</span>        global $Nesting;</div>
<div class="line"><span class="lineno">  175</span>        $this-&gt;nestingStr= $Nesting &gt; 0 ? <span class="stringliteral">&quot;Nesting $Nesting, &quot;</span> : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>        $this-&gt;cat= str_replace(__NAMESPACE__ . <span class="charliteral">&#39;\\&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, get_called_class());</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>        $this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a4d0e49aacf195439c437277b22a81062">parse</a>(<a class="code hl_variable" href="classModel_1_1Rule.html#a7542d95618011800c61773127fa625cf">$str</a>);</div>
<div class="line"><span class="lineno">  180</span>    }</div>
<div class="ttc" id="aclassModel_1_1Rule_html_a4d0e49aacf195439c437277b22a81062"><div class="ttname"><a href="classModel_1_1Rule.html#a4d0e49aacf195439c437277b22a81062">Model\Rule\parse</a></div><div class="ttdeci">parse($str)</div><div class="ttdoc">Parses the given rule string.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00399">Rule.php:399</a></div></div>
<div class="ttc" id="aclassModel_1_1Rule_html_a7542d95618011800c61773127fa625cf"><div class="ttname"><a href="classModel_1_1Rule.html#a7542d95618011800c61773127fa625cf">Model\Rule\$str</a></div><div class="ttdeci">$str</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00042">Rule.php:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a087e88a2b0af88707fea99388aa30ca8" name="a087e88a2b0af88707fea99388aa30ca8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a087e88a2b0af88707fea99388aa30ca8">&#9670;&#160;</a></span>genComment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">genComment </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints inline comment with a leading # char. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00856">856</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  857</span>    {</div>
<div class="line"><span class="lineno">  858</span>        <span class="keywordflow">if</span> (isset($this-&gt;rule[<span class="stringliteral">&#39;comment&#39;</span>])) {</div>
<div class="line"><span class="lineno">  859</span>            $this-&gt;str.= <span class="stringliteral">&#39; # &#39;</span> . trim(stripslashes($this-&gt;rule[<span class="stringliteral">&#39;comment&#39;</span>]));</div>
<div class="line"><span class="lineno">  860</span>        }</div>
<div class="line"><span class="lineno">  861</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="adfe1395228186319db9c6619d606c304" name="adfe1395228186319db9c6619d606c304"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfe1395228186319db9c6619d606c304">&#9670;&#160;</a></span>generateItem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">generateItem </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$items</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$head</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$delimPre</em> = <code>'{'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$delimPost</em> = <code>'}'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints the given values in delimiters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">mixed</td><td class="paramname">$items</td><td>Values to print, array or string. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$head</td><td>Optional leading string. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$delimPre</td><td>Opening delimiter. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$delimPost</td><td>Closing delimiter. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00835">835</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  835</span>                                                         {<span class="stringliteral">&#39;, $delimPost= &#39;</span>}<span class="stringliteral">&#39;)</span></div>
<div class="line"><span class="lineno">  836</span><span class="stringliteral">    {</span></div>
<div class="line"><span class="lineno">  837</span><span class="stringliteral">        $head= $head == &#39;</span><span class="stringliteral">&#39; ? &#39;</span><span class="stringliteral">&#39; : &#39;</span> <span class="stringliteral">&#39; . trim($head);</span></div>
<div class="line"><span class="lineno">  838</span><span class="stringliteral">        if (is_array($items)) {</span></div>
<div class="line"><span class="lineno">  839</span><span class="stringliteral">            return $head . &quot; $delimPre &quot; . implode(&#39;</span>, <span class="stringliteral">&#39;, $items) . &quot; $delimPost&quot;;</span></div>
<div class="line"><span class="lineno">  840</span><span class="stringliteral">        } else {</span></div>
<div class="line"><span class="lineno">  841</span><span class="stringliteral">            return $head . &#39;</span> <span class="stringliteral">&#39; . $items;</span></div>
<div class="line"><span class="lineno">  842</span><span class="stringliteral">        }</span></div>
<div class="line"><span class="lineno">  843</span><span class="stringliteral">    }</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4436066dc7a5f9e445faa2fccee13669" name="a4436066dc7a5f9e445faa2fccee13669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4436066dc7a5f9e445faa2fccee13669">&#9670;&#160;</a></span>genInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">genInterface </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints interfaces with a leading 'on' keyword. </p>

<p>Reimplemented in <a class="el" href="classModel_1_1Filter.html#a4436066dc7a5f9e445faa2fccee13669">Filter</a>.</p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00848">848</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  849</span>    {</div>
<div class="line"><span class="lineno">  850</span>        $this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#af54af6400a84c417ef91b561c476314e">genItems</a>(<span class="stringliteral">&#39;interface&#39;</span>, <span class="stringliteral">&#39;on&#39;</span>);</div>
<div class="line"><span class="lineno">  851</span>    }</div>
<div class="ttc" id="aclassModel_1_1Rule_html_af54af6400a84c417ef91b561c476314e"><div class="ttname"><a href="classModel_1_1Rule.html#af54af6400a84c417ef91b561c476314e">Model\Rule\genItems</a></div><div class="ttdeci">genItems($key, $head='', $delimPre='{', $delimPost='}')</div><div class="ttdoc">Prints the values of the given key.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00820">Rule.php:820</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af54af6400a84c417ef91b561c476314e" name="af54af6400a84c417ef91b561c476314e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af54af6400a84c417ef91b561c476314e">&#9670;&#160;</a></span>genItems()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">genItems </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$head</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$delimPre</em> = <code>'{'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$delimPost</em> = <code>'}'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints the values of the given key. </p>
<p>Puts the values between opening and closing delimiters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td>Key to print the value of. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$head</td><td>Optional leading string. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$delimPre</td><td>Opening delimiter. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$delimPost</td><td>Closing delimiter. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00820">820</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  820</span>                                                   {<span class="stringliteral">&#39;, $delimPost= &#39;</span>}<span class="stringliteral">&#39;)</span></div>
<div class="line"><span class="lineno">  821</span><span class="stringliteral">    {</span></div>
<div class="line"><span class="lineno">  822</span><span class="stringliteral">        if (isset($this-&gt;rule[$key])) {</span></div>
<div class="line"><span class="lineno">  823</span><span class="stringliteral">            $this-&gt;str.= $this-&gt;generateItem($this-&gt;rule[$key], $head, $delimPre, $delimPost);</span></div>
<div class="line"><span class="lineno">  824</span><span class="stringliteral">        }</span></div>
<div class="line"><span class="lineno">  825</span><span class="stringliteral">    }</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2990a052b6e735653adda2a1d19b4bd" name="aa2990a052b6e735653adda2a1d19b4bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2990a052b6e735653adda2a1d19b4bd">&#9670;&#160;</a></span>genKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">genKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints the given key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td>Key to print. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00787">787</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  788</span>    {</div>
<div class="line"><span class="lineno">  789</span>        <span class="keywordflow">if</span> (isset($this-&gt;rule[$key])) {</div>
<div class="line"><span class="lineno">  790</span>            $this-&gt;str.= <span class="charliteral">&#39; &#39;</span> . $key;</div>
<div class="line"><span class="lineno">  791</span>        }</div>
<div class="line"><span class="lineno">  792</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af932173b7bc6a98121d898719e46c2f6" name="af932173b7bc6a98121d898719e46c2f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af932173b7bc6a98121d898719e46c2f6">&#9670;&#160;</a></span>genLog()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">genLog </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints log definition of the rule. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00866">866</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  867</span>    {</div>
<div class="line"><span class="lineno">  868</span>        <span class="keywordflow">if</span> (isset($this-&gt;rule[<span class="stringliteral">&#39;log&#39;</span>])) {</div>
<div class="line"><span class="lineno">  869</span>            <span class="keywordflow">if</span> (is_array($this-&gt;rule[<span class="stringliteral">&#39;log&#39;</span>])) {</div>
<div class="line"><span class="lineno">  870</span>                $s= <span class="stringliteral">&#39; log ( &#39;</span>;</div>
<div class="line"><span class="lineno">  871</span>                <span class="keywordflow">foreach</span> ($this-&gt;rule[<span class="stringliteral">&#39;log&#39;</span>] as $k =&gt; $v) {</div>
<div class="line"><span class="lineno">  872</span>                    $s.= (is_bool($v) ? <span class="stringliteral">&quot;$k&quot;</span> : <span class="stringliteral">&quot;$k $v&quot;</span>) . <span class="stringliteral">&#39;, &#39;</span>;</div>
<div class="line"><span class="lineno">  873</span>                }</div>
<div class="line"><span class="lineno">  874</span>                $this-&gt;str.= rtrim($s, <span class="stringliteral">&#39;, &#39;</span>) . <span class="stringliteral">&#39; )&#39;</span>;</div>
<div class="line"><span class="lineno">  875</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  876</span>                $this-&gt;str.= <span class="stringliteral">&#39; log&#39;</span>;</div>
<div class="line"><span class="lineno">  877</span>            }</div>
<div class="line"><span class="lineno">  878</span>        }</div>
<div class="line"><span class="lineno">  879</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac882848fb6fb22dc07512dd94fab8dda" name="ac882848fb6fb22dc07512dd94fab8dda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac882848fb6fb22dc07512dd94fab8dda">&#9670;&#160;</a></span>genValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">genValue </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$head</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$tail</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints the value of the given key. </p>
<p>Caller may supply a leading and/or a trailing string to print.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td>Key to print the value of. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$head</td><td>Optional leading string, may be NULL. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$tail</td><td>Optional trailing string. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00803">803</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  804</span>    {</div>
<div class="line"><span class="lineno">  805</span>        <span class="keywordflow">if</span> (isset($this-&gt;rule[$key])) {</div>
<div class="line"><span class="lineno">  806</span>            $this-&gt;str.= <span class="charliteral">&#39; &#39;</span> . $head . $this-&gt;rule[$key] . $tail;</div>
<div class="line"><span class="lineno">  807</span>        }</div>
<div class="line"><span class="lineno">  808</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4be4055f3361d4800e16bc2e2e38cda6" name="a4be4055f3361d4800e16bc2e2e38cda6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4be4055f3361d4800e16bc2e2e38cda6">&#9670;&#160;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00422">422</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  423</span>    {</div>
<div class="line"><span class="lineno">  424</span>        $this-&gt;rule= array();</div>
<div class="line"><span class="lineno">  425</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0de0a0ad5f249ef4d21d2257f685f046" name="a0de0a0ad5f249ef4d21d2257f685f046"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0de0a0ad5f249ef4d21d2257f685f046">&#9670;&#160;</a></span>isEndOfWords()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">isEndOfWords </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the index points at the last word in the list. </p>
<dl class="section attention"><dt>Attention</dt><dd>This is a very important check used in while loops advancing the index. If we do not check this, the while loop goes into an infinite loop: The index keeps advancing until the stack overflows and PHP simply gives notices for off-by-N errors. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00480">480</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  481</span>    {</div>
<div class="line"><span class="lineno">  482</span>        <span class="keywordflow">return</span> $this-&gt;index &gt;= count($this-&gt;words);</div>
<div class="line"><span class="lineno">  483</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af4a887756fc1b11895f47dd07ab31f28" name="af4a887756fc1b11895f47dd07ab31f28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4a887756fc1b11895f47dd07ab31f28">&#9670;&#160;</a></span>load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">load </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleNumber</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$force</em> = <code>FALSE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the rule object with the given data. </p>
<p>We first assign the given rule number to $ruleNumber. Rule objects cannot and should not have a fixed rule numbers actually. However, we do this only for the <a class="el" href="classModel.html">Model</a>, not the <a class="el" href="classView.html">View</a>. Otherwise, the <a class="el" href="classView.html">View</a> can change this rule number freely, such as when the user moves the rule up or down in the rules list. Having fixed rule numbers would make such operations difficult.</p>
<p>We then validate the given rule array. If there are no validation errors, we simply assign the given rule array to the rule member variable. Even if validation fails, we can force this assignment using the $force parameter.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$arr</td><td>Rule array. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$ruleNumber</td><td>Rule number. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$force</td><td>To force loading rules with validation errors. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE if validated, FALSE if not. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00199">199</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  200</span>    {</div>
<div class="line"><span class="lineno">  201</span>        $this-&gt;ruleNumber= <a class="code hl_variable" href="classModel_1_1Rule.html#a72c8c7754a73e2cd6b8a1537fafd46fa">$ruleNumber</a>;</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>        <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= $this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a6945888a8bff78801ed111a0614e029a">validate</a>($arr, <a class="code hl_variable" href="conf_8write_8php.html#ac60027de12260e75a070f5a7618fd632">$force</a>);</div>
<div class="line"><span class="lineno">  204</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> || <a class="code hl_variable" href="conf_8write_8php.html#ac60027de12260e75a070f5a7618fd632">$force</a>) {</div>
<div class="line"><span class="lineno">  205</span>            $this-&gt;rule= $arr;</div>
<div class="line"><span class="lineno">  206</span>        }</div>
<div class="line"><span class="lineno">  207</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>;</div>
<div class="line"><span class="lineno">  208</span>    }</div>
<div class="ttc" id="aclassModel_1_1Rule_html_a6945888a8bff78801ed111a0614e029a"><div class="ttname"><a href="classModel_1_1Rule.html#a6945888a8bff78801ed111a0614e029a">Model\Rule\validate</a></div><div class="ttdeci">validate($ruleArray, $force=FALSE)</div><div class="ttdoc">Validates rule array.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00223">Rule.php:223</a></div></div>
<div class="ttc" id="aclassModel_1_1Rule_html_a72c8c7754a73e2cd6b8a1537fafd46fa"><div class="ttname"><a href="classModel_1_1Rule.html#a72c8c7754a73e2cd6b8a1537fafd46fa">Model\Rule\$ruleNumber</a></div><div class="ttdeci">$ruleNumber</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00050">Rule.php:50</a></div></div>
<div class="ttc" id="aconf_8write_8php_html_ac60027de12260e75a070f5a7618fd632"><div class="ttname"><a href="conf_8write_8php.html#ac60027de12260e75a070f5a7618fd632">$force</a></div><div class="ttdeci">$force</div><div class="ttdef"><b>Definition:</b> <a href="conf_8write_8php_source.html#l00041">conf.write.php:41</a></div></div>
<div class="ttc" id="actlr_8php_html_a80b96347dc2ad0d4e3748dc87db72731"><div class="ttname"><a href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a></div><div class="ttdeci">if( $ArgV[0]==='-n') if($ArgV[0]==='-t') $retval</div><div class="ttdef"><b>Definition:</b> <a href="ctlr_8php_source.html#l00072">ctlr.php:72</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="conf_8write_8php_source.html#l00041">$force</a>, and <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>.</p>

</div>
</div>
<a id="a4d0e49aacf195439c437277b22a81062" name="a4d0e49aacf195439c437277b22a81062"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d0e49aacf195439c437277b22a81062">&#9670;&#160;</a></span>parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses the given rule string. </p>
<p>We first fetch any inline comments and sanitize the given string.</p>
<p>We then split the string into words. Each rule type defines the keywords they accept. So we iterate over these split words to match them with the keywords. When a match is found, the method defined for the keyword is executed. The method fills the internal rule structure by fetching words from the words list, not just the matching keyword, hence may advance the word index beyond the current word.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$str</td><td>String to parse. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classModel_1_1Blank.html#a4d0e49aacf195439c437277b22a81062">Blank</a>, <a class="el" href="classModel_1_1Comment.html#a4d0e49aacf195439c437277b22a81062">Comment</a>, <a class="el" href="classModel_1_1__Include.html#a4d0e49aacf195439c437277b22a81062">_Include</a>, <a class="el" href="classModel_1_1LoadAnchor.html#a4d0e49aacf195439c437277b22a81062">LoadAnchor</a>, and <a class="el" href="classModel_1_1Macro.html#a4d0e49aacf195439c437277b22a81062">Macro</a>.</p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00399">399</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  400</span>    {</div>
<div class="line"><span class="lineno">  401</span>        $this-&gt;str= <a class="code hl_variable" href="classModel_1_1Rule.html#a7542d95618011800c61773127fa625cf">$str</a>;</div>
<div class="line"><span class="lineno">  402</span>        $this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a4be4055f3361d4800e16bc2e2e38cda6">init</a>();</div>
<div class="line"><span class="lineno">  403</span>        $this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a6011811d5724857e81bb02bc4e21de36">parseComment</a>();</div>
<div class="line"><span class="lineno">  404</span>        $this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a1c107fb139f601aed9aa988531ce9ae6">sanitize</a>();</div>
<div class="line"><span class="lineno">  405</span>        $this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a6c0c41e7a45a3c1899074b89c235114c">split</a>();</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>        <span class="keywordflow">for</span> ($this-&gt;index= 0; $this-&gt;index &lt; count($this-&gt;words); $this-&gt;index++) {</div>
<div class="line"><span class="lineno">  408</span>            $key= $this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>];</div>
<div class="line"><span class="lineno">  409</span>            <span class="keywordflow">if</span> (array_key_exists($key, $this-&gt;keywords)) {</div>
<div class="line"><span class="lineno">  410</span>                $method= $this-&gt;keywords[$key][<span class="stringliteral">&#39;method&#39;</span>];               </div>
<div class="line"><span class="lineno">  411</span>                <span class="keywordflow">if</span> (is_callable($method, TRUE)) {</div>
<div class="line"><span class="lineno">  412</span>                    call_user_func_array(array($this, $method), $this-&gt;keywords[$key][<span class="stringliteral">&#39;params&#39;</span>]);</div>
<div class="line"><span class="lineno">  413</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  414</span>                    <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Parser method &#39;$method&#39; not callable&quot;</span>);</div>
<div class="line"><span class="lineno">  415</span>                }</div>
<div class="line"><span class="lineno">  416</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  417</span>                <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Word &#39;$key&#39; not in keywords&quot;</span>);</div>
<div class="line"><span class="lineno">  418</span>            }</div>
<div class="line"><span class="lineno">  419</span>        }</div>
<div class="line"><span class="lineno">  420</span>    }</div>
<div class="ttc" id="aModel_2include_8php_html_aacb56ea458e6602b98977b24fbbb4ebe"><div class="ttname"><a href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a></div><div class="ttdeci">ctlr_syslog($prio, $file, $func, $line, $msg)</div><div class="ttdoc">Wrapper for controller error logging via syslog.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00194">include.php:194</a></div></div>
<div class="ttc" id="aclassModel_1_1Rule_html_a1c107fb139f601aed9aa988531ce9ae6"><div class="ttname"><a href="classModel_1_1Rule.html#a1c107fb139f601aed9aa988531ce9ae6">Model\Rule\sanitize</a></div><div class="ttdeci">sanitize()</div><div class="ttdoc">Sanitizes rule string.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00449">Rule.php:449</a></div></div>
<div class="ttc" id="aclassModel_1_1Rule_html_a23e53dfd2b001b81c9946fa05ec90e6f"><div class="ttname"><a href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">Model\Rule\$index</a></div><div class="ttdeci">$index</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00043">Rule.php:43</a></div></div>
<div class="ttc" id="aclassModel_1_1Rule_html_a4be4055f3361d4800e16bc2e2e38cda6"><div class="ttname"><a href="classModel_1_1Rule.html#a4be4055f3361d4800e16bc2e2e38cda6">Model\Rule\init</a></div><div class="ttdeci">init()</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00422">Rule.php:422</a></div></div>
<div class="ttc" id="aclassModel_1_1Rule_html_a6011811d5724857e81bb02bc4e21de36"><div class="ttname"><a href="classModel_1_1Rule.html#a6011811d5724857e81bb02bc4e21de36">Model\Rule\parseComment</a></div><div class="ttdeci">parseComment()</div><div class="ttdoc">Parses inline comments.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00433">Rule.php:433</a></div></div>
<div class="ttc" id="aclassModel_1_1Rule_html_a6c0c41e7a45a3c1899074b89c235114c"><div class="ttname"><a href="classModel_1_1Rule.html#a6c0c41e7a45a3c1899074b89c235114c">Model\Rule\split</a></div><div class="ttdeci">split()</div><div class="ttdoc">Splits rule string into words.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00468">Rule.php:468</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_1_1Rule_a4d0e49aacf195439c437277b22a81062_cgraph.png" border="0" usemap="#aclassModel_1_1Rule_a4d0e49aacf195439c437277b22a81062_cgraph" alt=""/></div>
<map name="aclassModel_1_1Rule_a4d0e49aacf195439c437277b22a81062_cgraph" id="aclassModel_1_1Rule_a4d0e49aacf195439c437277b22a81062_cgraph">
<area shape="rect" title="Parses the given rule string." alt="" coords="5,5,64,31"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="112,5,204,31"/>
</map>
</div>

</div>
</div>
<a id="a71f9ded8e965db5ffbf5abfe2df399f5" name="a71f9ded8e965db5ffbf5abfe2df399f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71f9ded8e965db5ffbf5abfe2df399f5">&#9670;&#160;</a></span>parseAny()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parseAny </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assigns any to from or to keys. </p>
<p>This is the method called when an 'any' key is found in the words list.</p>
<p>Any may be used for either source or destination. Source has precedence. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00692">692</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  693</span>    {</div>
<div class="line"><span class="lineno">  694</span>        <span class="keywordflow">if</span> (!isset($this-&gt;rule[<span class="stringliteral">&#39;from&#39;</span>])) {</div>
<div class="line"><span class="lineno">  695</span>            $this-&gt;rule[<span class="stringliteral">&#39;from&#39;</span>]= <span class="stringliteral">&#39;any&#39;</span>;</div>
<div class="line"><span class="lineno">  696</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  697</span>            $this-&gt;rule[<span class="stringliteral">&#39;to&#39;</span>]= <span class="stringliteral">&#39;any&#39;</span>;</div>
<div class="line"><span class="lineno">  698</span>        }</div>
<div class="line"><span class="lineno">  699</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a60008af4cf747b5858f80238a7a021c2" name="a60008af4cf747b5858f80238a7a021c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60008af4cf747b5858f80238a7a021c2">&#9670;&#160;</a></span>parseBool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parseBool </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assigns TRUE to the current word as key. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00528">528</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  529</span>    {</div>
<div class="line"><span class="lineno">  530</span>        $this-&gt;rule[$this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>]]= TRUE;</div>
<div class="line"><span class="lineno">  531</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6011811d5724857e81bb02bc4e21de36" name="a6011811d5724857e81bb02bc4e21de36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6011811d5724857e81bb02bc4e21de36">&#9670;&#160;</a></span>parseComment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parseComment </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses inline comments. </p>
<p>We get any inline comments and update the string by removing the comment. Such comments do not need further parsing or processing. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00433">433</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  434</span>    {</div>
<div class="line"><span class="lineno">  435</span>        $pos= strpos($this-&gt;str, <span class="charliteral">&#39;#&#39;</span>);</div>
<div class="line"><span class="lineno">  436</span>        <span class="keywordflow">if</span> ($pos) {</div>
<div class="line"><span class="lineno">  437</span>            $this-&gt;rule[<span class="stringliteral">&#39;comment&#39;</span>]= trim(substr($this-&gt;str, $pos + 1));</div>
<div class="line"><span class="lineno">  438</span>            $this-&gt;str= substr($this-&gt;str, 0, $pos);</div>
<div class="line"><span class="lineno">  439</span>        }</div>
<div class="line"><span class="lineno">  440</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ddc616519ddd2a1aca14ed5cc05328e" name="a9ddc616519ddd2a1aca14ed5cc05328e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ddc616519ddd2a1aca14ed5cc05328e">&#9670;&#160;</a></span>parseDelimitedStr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parseDelimitedStr </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$delimPre</em> = <code>'&quot;'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$delimPost</em> = <code>'&quot;'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the string in delimiters and assign it to the given key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td>Key in the rule array to assign value to. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$delimPre</td><td>Opening delimiter. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$delimPost</td><td>Closing delimiter. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00656">656</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  657</span>    {</div>
<div class="line"><span class="lineno">  658</span>        $this-&gt;index++;</div>
<div class="line"><span class="lineno">  659</span>        $this-&gt;rule[$key]= $this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a992f76a0922b96572ab2f5e98d33d502">parseString</a>($delimPre, $delimPost);       </div>
<div class="line"><span class="lineno">  660</span>    }</div>
<div class="ttc" id="aclassModel_1_1Rule_html_a992f76a0922b96572ab2f5e98d33d502"><div class="ttname"><a href="classModel_1_1Rule.html#a992f76a0922b96572ab2f5e98d33d502">Model\Rule\parseString</a></div><div class="ttdeci">parseString($delimPre='&quot;', $delimPost= '&quot;')</div><div class="ttdoc">Gets the string in delimiters and increments the index once for each word.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00672">Rule.php:672</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a01df1ad0352a2d0c9c42b7e38ffc1a58" name="a01df1ad0352a2d0c9c42b7e38ffc1a58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01df1ad0352a2d0c9c42b7e38ffc1a58">&#9670;&#160;</a></span>parseItem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parseItem </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$delimPre</em> = <code>'{'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$delimPost</em> = <code>'}'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the items in delimiters and increments the index once for each word. </p>
<p>There may be only one item between delimiters. In this case, we may need to convert the array into a simple value by calling <a class="el" href="lib_2lib_8php.html#a5de4c118627ef9fcaa8eeed364b7616f" title="Converts an array to a simple value.">FlattenArray()</a>.</p>
<p>Note that the index points to the closing delimiter while exiting.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$delimPre</td><td>Opening delimiter. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$delimPost</td><td>Closing delimiter. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00558">558</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  558</span>                                   {<span class="stringliteral">&#39;, $delimPost= &#39;</span>}<span class="stringliteral">&#39;)</span></div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral">    {</span></div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral">        $this-&gt;index++;</span></div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">        if (($this-&gt;words[$this-&gt;index] == $delimPre)) {</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral">            while (preg_replace(&#39;</span>/[\s,]+/<span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, $this-&gt;words[++$this-&gt;index]) != $delimPost &amp;&amp; !$this-&gt;isEndOfWords()) {</span></div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">                $value[]= $this-&gt;parseParenthesized();</span></div>
<div class="line"><span class="lineno">  564</span><span class="stringliteral">            }</span></div>
<div class="line"><span class="lineno">  565</span><span class="stringliteral">        } else {</span></div>
<div class="line"><span class="lineno">  566</span><span class="stringliteral">            // ($ext_if)</span></div>
<div class="line"><span class="lineno">  567</span><span class="stringliteral">            $value[]= $this-&gt;parseParenthesized();</span></div>
<div class="line"><span class="lineno">  568</span><span class="stringliteral">            FlattenArray($value);</span></div>
<div class="line"><span class="lineno">  569</span><span class="stringliteral">        }</span></div>
<div class="line"><span class="lineno">  570</span><span class="stringliteral">        return $value;</span></div>
<div class="line"><span class="lineno">  571</span><span class="stringliteral">    }</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="lib_2lib_8php_source.html#l00057">FlattenArray()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_1_1Rule_a01df1ad0352a2d0c9c42b7e38ffc1a58_cgraph.png" border="0" usemap="#aclassModel_1_1Rule_a01df1ad0352a2d0c9c42b7e38ffc1a58_cgraph" alt=""/></div>
<map name="aclassModel_1_1Rule_a01df1ad0352a2d0c9c42b7e38ffc1a58_cgraph" id="aclassModel_1_1Rule_a01df1ad0352a2d0c9c42b7e38ffc1a58_cgraph">
<area shape="rect" title="Gets the items in delimiters and increments the index once for each word." alt="" coords="5,5,93,31"/>
<area shape="rect" href="lib_2lib_8php.html#a5de4c118627ef9fcaa8eeed364b7616f" title="Converts an array to a simple value." alt="" coords="141,5,244,31"/>
</map>
</div>

</div>
</div>
<a id="a14b410fb73379c15ac0b78f5eb34107e" name="a14b410fb73379c15ac0b78f5eb34107e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14b410fb73379c15ac0b78f5eb34107e">&#9670;&#160;</a></span>parseItems()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parseItems </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$delimPre</em> = <code>'{'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$delimPost</em> = <code>'}'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assigns the items in delimiters to the given key. </p>
<p>Note that each item may span multiple words: parseParenthesized().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td>Key in the rule array to assign value to. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$delimPre</td><td>Opening delimiter. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$delimPost</td><td>Closing delimiter. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00542">542</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  542</span>                                          {<span class="stringliteral">&#39;, $delimPost= &#39;</span>}<span class="stringliteral">&#39;)</span></div>
<div class="line"><span class="lineno">  543</span><span class="stringliteral">    {</span></div>
<div class="line"><span class="lineno">  544</span><span class="stringliteral">        $this-&gt;rule[$key]= $this-&gt;parseItem($delimPre, $delimPost);     </span></div>
<div class="line"><span class="lineno">  545</span><span class="stringliteral">    }</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a67c9aa83f6831ac97f251aa7e844b147" name="a67c9aa83f6831ac97f251aa7e844b147"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67c9aa83f6831ac97f251aa7e844b147">&#9670;&#160;</a></span>parseLog()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parseLog </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets log specification in the rule string. </p>
<p>This method is called if the parser finds a 'log' keyword in the rule string.</p>
<p>If there is no further logging details, we simply set logging to TRUE. Otherwise, any such specification must be in parentheses. In this case, we use an array which holds the values of the log key.</p>
<p>Therefore, checking if logging is enabled for a rule reduces to checking if the log key exists, not if it is set to TRUE or contains an array. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00765">765</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  766</span>    {</div>
<div class="line"><span class="lineno">  767</span>        <span class="keywordflow">if</span> ($this-&gt;words[$this-&gt;index + 1] == <span class="charliteral">&#39;(&#39;</span>) {</div>
<div class="line"><span class="lineno">  768</span>            $opts= $this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a01df1ad0352a2d0c9c42b7e38ffc1a58">parseItem</a>(<span class="charliteral">&#39;(&#39;</span>, <span class="charliteral">&#39;)&#39;</span>);</div>
<div class="line"><span class="lineno">  769</span>            $this-&gt;rule[<span class="stringliteral">&#39;log&#39;</span>]= array();</div>
<div class="line"><span class="lineno">  770</span>            <span class="keywordflow">for</span> ($i= 0; $i &lt; count($opts); $i++) {</div>
<div class="line"><span class="lineno">  771</span>                <span class="keywordflow">if</span> ($opts[$i] == <span class="stringliteral">&#39;to&#39;</span>) {</div>
<div class="line"><span class="lineno">  772</span>                    $this-&gt;rule[<span class="stringliteral">&#39;log&#39;</span>][<span class="stringliteral">&#39;to&#39;</span>]= $opts[++$i];</div>
<div class="line"><span class="lineno">  773</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  774</span>                    $this-&gt;rule[<span class="stringliteral">&#39;log&#39;</span>][$opts[$i]]= TRUE;</div>
<div class="line"><span class="lineno">  775</span>                }</div>
<div class="line"><span class="lineno">  776</span>            }</div>
<div class="line"><span class="lineno">  777</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  778</span>            $this-&gt;rule[<span class="stringliteral">&#39;log&#39;</span>]= TRUE;</div>
<div class="line"><span class="lineno">  779</span>        }</div>
<div class="line"><span class="lineno">  780</span>    }</div>
<div class="ttc" id="aclassModel_1_1Rule_html_a01df1ad0352a2d0c9c42b7e38ffc1a58"><div class="ttname"><a href="classModel_1_1Rule.html#a01df1ad0352a2d0c9c42b7e38ffc1a58">Model\Rule\parseItem</a></div><div class="ttdeci">parseItem($delimPre='{', $delimPost='}')</div><div class="ttdoc">Gets the items in delimiters and increments the index once for each word.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00558">Rule.php:558</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae322db979a768e52584b58925d9fef41" name="ae322db979a768e52584b58925d9fef41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae322db979a768e52584b58925d9fef41">&#9670;&#160;</a></span>parseNextNVP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parseNextNVP </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assigns the next word to the given key and increments the index. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td>Key in the rule array to assign value to. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00520">520</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  521</span>    {</div>
<div class="line"><span class="lineno">  522</span>        $this-&gt;rule[$key]= $this-&gt;words[++<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>];</div>
<div class="line"><span class="lineno">  523</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c95d5920a522b69f73c9e831a7fca77" name="a0c95d5920a522b69f73c9e831a7fca77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c95d5920a522b69f73c9e831a7fca77">&#9670;&#160;</a></span>parseNextValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parseNextValue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assigns the next word to the current word as key and increments the index. </p>
<p>Removes any quotes. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00510">510</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  511</span>    {</div>
<div class="line"><span class="lineno">  512</span>        $this-&gt;rule[$this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>]]= preg_replace(<span class="stringliteral">&#39;/&quot;/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $this-&gt;words[++$this-&gt;index]);</div>
<div class="line"><span class="lineno">  513</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="adbbf5d9bac06b78b5e012800e16629f2" name="adbbf5d9bac06b78b5e012800e16629f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbbf5d9bac06b78b5e012800e16629f2">&#9670;&#160;</a></span>parseNVP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parseNVP </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assigns the current word to the given key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td>Key in the rule array to assign value to. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00490">490</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  491</span>    {</div>
<div class="line"><span class="lineno">  492</span>        $this-&gt;rule[$key]= $this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>];</div>
<div class="line"><span class="lineno">  493</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="acca9e9e4b74ac3e5e43de8046f524a7d" name="acca9e9e4b74ac3e5e43de8046f524a7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acca9e9e4b74ac3e5e43de8046f524a7d">&#9670;&#160;</a></span>parseNVPInc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parseNVPInc </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assigns the current word to the given key and increments the index. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td>Key in the rule array to assign value to. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00500">500</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  501</span>    {</div>
<div class="line"><span class="lineno">  502</span>        $this-&gt;rule[$key]= $this-&gt;words[$this-&gt;index++];</div>
<div class="line"><span class="lineno">  503</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a54a68405a3bd6bc1a1cfc2c4d4c1be7a" name="a54a68405a3bd6bc1a1cfc2c4d4c1be7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54a68405a3bd6bc1a1cfc2c4d4c1be7a">&#9670;&#160;</a></span>parseOS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parseOS </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets OS in host definition in the rule string. </p>
<p>This method is called if the parser finds an 'os' keyword in the rule string.</p>
<p>There may be multiple OSs listed. Note that OS keywords may be in quotes. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00741">741</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  742</span>    {</div>
<div class="line"><span class="lineno">  743</span>        $this-&gt;index++;</div>
<div class="line"><span class="lineno">  744</span>        <span class="keywordflow">if</span> ($this-&gt;words[$this-&gt;index] == <span class="charliteral">&#39;{&#39;</span>) {</div>
<div class="line"><span class="lineno">  745</span>            <span class="keywordflow">while</span> (preg_replace(<span class="stringliteral">&#39;/[\s,]+/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $this-&gt;words[++$this-&gt;index]) != <span class="charliteral">&#39;}&#39;</span> &amp;&amp; !$this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a0de0a0ad5f249ef4d21d2257f685f046">isEndOfWords</a>()) {</div>
<div class="line"><span class="lineno">  746</span>                $this-&gt;rule[<span class="stringliteral">&#39;os&#39;</span>][]= $this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a992f76a0922b96572ab2f5e98d33d502">parseString</a>();      </div>
<div class="line"><span class="lineno">  747</span>            }</div>
<div class="line"><span class="lineno">  748</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  749</span>            $this-&gt;rule[<span class="stringliteral">&#39;os&#39;</span>]= $this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a992f76a0922b96572ab2f5e98d33d502">parseString</a>();        </div>
<div class="line"><span class="lineno">  750</span>        }</div>
<div class="line"><span class="lineno">  751</span>    }</div>
<div class="ttc" id="aclassModel_1_1Rule_html_a0de0a0ad5f249ef4d21d2257f685f046"><div class="ttname"><a href="classModel_1_1Rule.html#a0de0a0ad5f249ef4d21d2257f685f046">Model\Rule\isEndOfWords</a></div><div class="ttdeci">isEndOfWords()</div><div class="ttdoc">Checks if the index points at the last word in the list.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00480">Rule.php:480</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8f8f11122bd1c258b16838edceb8e1e6" name="a8f8f11122bd1c258b16838edceb8e1e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f8f11122bd1c258b16838edceb8e1e6">&#9670;&#160;</a></span>parseParenthesized()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parseParenthesized </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the items in parentheses and increments the index once for each word. </p>
<p>Items may have more complex structures than simple words.</p>
<p>We also get any trailing definitions for weight and net mask. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00580">580</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  581</span>    {</div>
<div class="line"><span class="lineno">  582</span>        <span class="keywordflow">if</span> ($this-&gt;words[$this-&gt;index] == <span class="charliteral">&#39;(&#39;</span>) {</div>
<div class="line"><span class="lineno">  583</span>            <span class="keywordflow">while</span> ($this-&gt;words[++$this-&gt;index] != <span class="charliteral">&#39;)&#39;</span> &amp;&amp; !$this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a0de0a0ad5f249ef4d21d2257f685f046">isEndOfWords</a>()) {</div>
<div class="line"><span class="lineno">  584</span>                $items[]= $this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>];</div>
<div class="line"><span class="lineno">  585</span>            }</div>
<div class="line"><span class="lineno">  586</span>            <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= <span class="charliteral">&#39;(&#39;</span> . implode(<span class="charliteral">&#39; &#39;</span>, $items) . <span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><span class="lineno">  587</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  588</span>            <span class="comment">// IP range, routehost = host &quot;@&quot; interface-name, IP net</span></div>
<div class="line"><span class="lineno">  589</span>            <span class="keywordflow">if</span> (isset($this-&gt;words[$this-&gt;index + 1]) &amp;&amp; ($this-&gt;words[$this-&gt;index + 1] == <span class="charliteral">&#39;-&#39;</span> || $this-&gt;words[$this-&gt;index + 1] == <span class="charliteral">&#39;@&#39;</span> || $this-&gt;words[$this-&gt;index + 1] == <span class="charliteral">&#39;/&#39;</span>)) {</div>
<div class="line"><span class="lineno">  590</span>                <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= $this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>] . <span class="charliteral">&#39; &#39;</span> . $this-&gt;words[$this-&gt;index + 1] . <span class="charliteral">&#39; &#39;</span> . $this-&gt;words[$this-&gt;index + 2];</div>
<div class="line"><span class="lineno">  591</span>                $this-&gt;index+= 2;</div>
<div class="line"><span class="lineno">  592</span>            <span class="comment">// icmp-type 1 code 2</span></div>
<div class="line"><span class="lineno">  593</span>            } elseif (isset($this-&gt;words[$this-&gt;index + 1]) &amp;&amp; ($this-&gt;words[$this-&gt;index + 1] == <span class="stringliteral">&#39;code&#39;</span>)) {</div>
<div class="line"><span class="lineno">  594</span>                <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= $this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>] . <span class="charliteral">&#39; &#39;</span> . $this-&gt;words[$this-&gt;index + 1] . <span class="charliteral">&#39; &#39;</span> . $this-&gt;words[$this-&gt;index + 2];</div>
<div class="line"><span class="lineno">  595</span>                $this-&gt;index+= 2;</div>
<div class="line"><span class="lineno">  596</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  597</span>                <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= $this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>];</div>
<div class="line"><span class="lineno">  598</span>            }</div>
<div class="line"><span class="lineno">  599</span>        }</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>        <span class="comment">// address [ &quot;weight&quot; number ] | address [ &quot;/&quot; mask-bits ] [ &quot;weight&quot; number ]</span></div>
<div class="line"><span class="lineno">  602</span>        <span class="keywordflow">if</span> (isset($this-&gt;words[$this-&gt;index + 1]) &amp;&amp; ($this-&gt;words[$this-&gt;index + 1] == <span class="stringliteral">&#39;weight&#39;</span>)) {</div>
<div class="line"><span class="lineno">  603</span>            <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= $this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>] . <span class="charliteral">&#39; &#39;</span> . $this-&gt;words[$this-&gt;index + 1] . <span class="charliteral">&#39; &#39;</span> . $this-&gt;words[$this-&gt;index + 2];</div>
<div class="line"><span class="lineno">  604</span>            $this-&gt;index+= 2;</div>
<div class="line"><span class="lineno">  605</span>        }</div>
<div class="line"><span class="lineno">  606</span> </div>
<div class="line"><span class="lineno">  607</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>;</div>
<div class="line"><span class="lineno">  608</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>.</p>

</div>
</div>
<a id="abecfb2c99b09efd6623fcb698e7cc898" name="abecfb2c99b09efd6623fcb698e7cc898"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abecfb2c99b09efd6623fcb698e7cc898">&#9670;&#160;</a></span>parsePort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parsePort </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets a port item and increments the index once for each word. </p>
<p>This methods gets only one item, which may have a more complex structure than a simple word. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00634">634</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  635</span>    {</div>
<div class="line"><span class="lineno">  636</span>        <span class="keywordflow">if</span> (in_array($this-&gt;words[$this-&gt;index], array(<span class="charliteral">&#39;=&#39;</span>, <span class="stringliteral">&#39;!=&#39;</span>, <span class="charliteral">&#39;&lt;&#39;</span>, <span class="stringliteral">&#39;&lt;=&#39;</span>, <span class="charliteral">&#39;&gt;&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>))) {</div>
<div class="line"><span class="lineno">  637</span>            <span class="comment">// unary-op = [ &quot;=&quot; | &quot;!=&quot; | &quot;&lt;&quot; | &quot;&lt;=&quot; | &quot;&gt;&quot; | &quot;&gt;=&quot; ] ( name | number )</span></div>
<div class="line"><span class="lineno">  638</span>            <span class="keywordflow">return</span> $this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>] . <span class="charliteral">&#39; &#39;</span> . $this-&gt;words[++<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>];</div>
<div class="line"><span class="lineno">  639</span>        } elseif (isset($this-&gt;words[$this-&gt;index + 1]) &amp;&amp; (in_array($this-&gt;words[$this-&gt;index + 1], array(<span class="stringliteral">&#39;&lt;&gt;&#39;</span>, <span class="stringliteral">&#39;&gt;&lt;&#39;</span>, <span class="charliteral">&#39;:&#39;</span>)))) {</div>
<div class="line"><span class="lineno">  640</span>            <span class="comment">// binary-op = number ( &quot;&lt;&gt;&quot; | &quot;&gt;&lt;&quot; | &quot;:&quot; ) number</span></div>
<div class="line"><span class="lineno">  641</span>            <span class="comment">// portspec = &quot;port&quot; ( number | name ) [ &quot;:&quot; ( &quot;*&quot; | number | name ) ]</span></div>
<div class="line"><span class="lineno">  642</span>            <span class="keywordflow">return</span> $this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>] . <span class="charliteral">&#39; &#39;</span> . $this-&gt;words[++<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>] . <span class="charliteral">&#39; &#39;</span> . $this-&gt;words[++<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>];</div>
<div class="line"><span class="lineno">  643</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  644</span>            <span class="comment">// ( name | number )</span></div>
<div class="line"><span class="lineno">  645</span>            <span class="keywordflow">return</span> $this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>];</div>
<div class="line"><span class="lineno">  646</span>        }</div>
<div class="line"><span class="lineno">  647</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ea06e2649dc6ba385db5760c6af70f8" name="a6ea06e2649dc6ba385db5760c6af70f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ea06e2649dc6ba385db5760c6af70f8">&#9670;&#160;</a></span>parsePortItem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parsePortItem </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets port item(s) and increments the index once for each word. </p>
<p>Items may have more complex structures than simple words. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00615">615</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  616</span>    {</div>
<div class="line"><span class="lineno">  617</span>        $this-&gt;index++;</div>
<div class="line"><span class="lineno">  618</span>        <span class="keywordflow">if</span> ($this-&gt;words[$this-&gt;index] == <span class="charliteral">&#39;{&#39;</span>) {</div>
<div class="line"><span class="lineno">  619</span>            <span class="keywordflow">while</span> (preg_replace(<span class="stringliteral">&#39;/[\s,]+/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $this-&gt;words[++$this-&gt;index]) != <span class="charliteral">&#39;}&#39;</span> &amp;&amp; !$this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a0de0a0ad5f249ef4d21d2257f685f046">isEndOfWords</a>()) {</div>
<div class="line"><span class="lineno">  620</span>                $this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>]= preg_replace(<span class="stringliteral">&#39;/[\s,]+/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $this-&gt;words[$this-&gt;index]);</div>
<div class="line"><span class="lineno">  621</span>                $value[]= $this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#abecfb2c99b09efd6623fcb698e7cc898">parsePort</a>();</div>
<div class="line"><span class="lineno">  622</span>            }</div>
<div class="line"><span class="lineno">  623</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  624</span>            $value= $this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#abecfb2c99b09efd6623fcb698e7cc898">parsePort</a>();</div>
<div class="line"><span class="lineno">  625</span>        }</div>
<div class="line"><span class="lineno">  626</span>        <span class="keywordflow">return</span> $value;</div>
<div class="line"><span class="lineno">  627</span>    }</div>
<div class="ttc" id="aclassModel_1_1Rule_html_abecfb2c99b09efd6623fcb698e7cc898"><div class="ttname"><a href="classModel_1_1Rule.html#abecfb2c99b09efd6623fcb698e7cc898">Model\Rule\parsePort</a></div><div class="ttdeci">parsePort()</div><div class="ttdoc">Gets a port item and increments the index once for each word.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00634">Rule.php:634</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ade11e53c617595a99cfa62d9af9fa46a" name="ade11e53c617595a99cfa62d9af9fa46a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade11e53c617595a99cfa62d9af9fa46a">&#9670;&#160;</a></span>parseSrcDest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parseSrcDest </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$portKey</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets source or destination addresses and/or ports in the rule string. </p>
<p>This method is called if the parser finds a 'from' or 'to' keyword in the rule string. Initially, the word index points to that keyword.</p>
<p>We first determine if we are going to parse an address or a port portion of a host definition. Note that host definition may contain port only, without any host address.</p>
<p>As seen in pfctl BNF syntax definition, the address portion may be a route. If that's the case, we first set the key to 'fromroute' or 'toroute'. Otherwise, what follows may be a list of addresses.</p>
<p>If there is a port definition, we assign it to the port key given.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$portKey</td><td>Src or dest port in the rule array to assign port to. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00717">717</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  718</span>    {</div>
<div class="line"><span class="lineno">  719</span>        <span class="keywordflow">if</span> ($this-&gt;words[$this-&gt;index + 1] != <span class="stringliteral">&#39;port&#39;</span>) {</div>
<div class="line"><span class="lineno">  720</span>            <span class="keywordflow">if</span> ($this-&gt;words[$this-&gt;index + 1] == <span class="stringliteral">&#39;route&#39;</span>) {</div>
<div class="line"><span class="lineno">  721</span>                $hostKey= $this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>];</div>
<div class="line"><span class="lineno">  722</span>                $this-&gt;index+= 2;</div>
<div class="line"><span class="lineno">  723</span>                $this-&gt;rule[$hostKey . <span class="stringliteral">&#39;route&#39;</span>]= $this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>];</div>
<div class="line"><span class="lineno">  724</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  725</span>                $this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a14b410fb73379c15ac0b78f5eb34107e">parseItems</a>($this-&gt;words[$this-&gt;index]);</div>
<div class="line"><span class="lineno">  726</span>            }</div>
<div class="line"><span class="lineno">  727</span>        }</div>
<div class="line"><span class="lineno">  728</span>        <span class="keywordflow">if</span> (isset($this-&gt;words[$this-&gt;index + 1]) &amp;&amp; ($this-&gt;words[$this-&gt;index + 1] == <span class="stringliteral">&#39;port&#39;</span>)) {</div>
<div class="line"><span class="lineno">  729</span>            $this-&gt;index++;</div>
<div class="line"><span class="lineno">  730</span>            $this-&gt;rule[$portKey]= $this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a6ea06e2649dc6ba385db5760c6af70f8">parsePortItem</a>();</div>
<div class="line"><span class="lineno">  731</span>        }</div>
<div class="line"><span class="lineno">  732</span>    }</div>
<div class="ttc" id="aclassModel_1_1Rule_html_a14b410fb73379c15ac0b78f5eb34107e"><div class="ttname"><a href="classModel_1_1Rule.html#a14b410fb73379c15ac0b78f5eb34107e">Model\Rule\parseItems</a></div><div class="ttdeci">parseItems($key, $delimPre='{', $delimPost='}')</div><div class="ttdoc">Assigns the items in delimiters to the given key.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00542">Rule.php:542</a></div></div>
<div class="ttc" id="aclassModel_1_1Rule_html_a6ea06e2649dc6ba385db5760c6af70f8"><div class="ttname"><a href="classModel_1_1Rule.html#a6ea06e2649dc6ba385db5760c6af70f8">Model\Rule\parsePortItem</a></div><div class="ttdeci">parsePortItem()</div><div class="ttdoc">Gets port item(s) and increments the index once for each word.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00615">Rule.php:615</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a992f76a0922b96572ab2f5e98d33d502" name="a992f76a0922b96572ab2f5e98d33d502"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a992f76a0922b96572ab2f5e98d33d502">&#9670;&#160;</a></span>parseString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parseString </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$delimPre</em> = <code>'&quot;'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$delimPost</em> = <code>'&quot;'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the string in delimiters and increments the index once for each word. </p>
<p>The string may contain single or multiple words.</p>
<p>We trim the string before returning.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$delimPre</td><td>Opening delimiter. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$delimPost</td><td>Closing delimiter. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00672">672</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  673</span>    {</div>
<div class="line"><span class="lineno">  674</span>        $value= <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  675</span>        <span class="keywordflow">if</span> ($this-&gt;words[$this-&gt;index] == $delimPre) {</div>
<div class="line"><span class="lineno">  676</span>            <span class="keywordflow">while</span> ($this-&gt;words[++$this-&gt;index] != $delimPost &amp;&amp; !$this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a0de0a0ad5f249ef4d21d2257f685f046">isEndOfWords</a>()) {</div>
<div class="line"><span class="lineno">  677</span>                $value.= <span class="charliteral">&#39; &#39;</span> . $this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>];</div>
<div class="line"><span class="lineno">  678</span>            }</div>
<div class="line"><span class="lineno">  679</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  680</span>            $value= $this-&gt;words[<a class="code hl_variable" href="classModel_1_1Rule.html#a23e53dfd2b001b81c9946fa05ec90e6f">$this-&gt;index</a>];</div>
<div class="line"><span class="lineno">  681</span>        }</div>
<div class="line"><span class="lineno">  682</span>        <span class="keywordflow">return</span> trim($value);</div>
<div class="line"><span class="lineno">  683</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1c107fb139f601aed9aa988531ce9ae6" name="a1c107fb139f601aed9aa988531ce9ae6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c107fb139f601aed9aa988531ce9ae6">&#9670;&#160;</a></span>sanitize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sanitize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sanitizes rule string. </p>
<p>Sanitization step prepares the given strings by making them obey certain standards, so that we only deal with the same format. However, note that sanitization may differ in different rule types, hence this method may be overridden in child classes. </p>

<p>Reimplemented in <a class="el" href="classModel_1_1Anchor.html#a1c107fb139f601aed9aa988531ce9ae6">Anchor</a>, <a class="el" href="classModel_1_1Limit.html#a1c107fb139f601aed9aa988531ce9ae6">Limit</a>, <a class="el" href="classModel_1_1Macro.html#a1c107fb139f601aed9aa988531ce9ae6">Macro</a>, <a class="el" href="classModel_1_1Queue.html#a1c107fb139f601aed9aa988531ce9ae6">Queue</a>, and <a class="el" href="classModel_1_1Table.html#a1c107fb139f601aed9aa988531ce9ae6">Table</a>.</p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00449">449</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  450</span>    {</div>
<div class="line"><span class="lineno">  451</span>        $this-&gt;str= preg_replace(<span class="stringliteral">&#39;/! +/&#39;</span>, <span class="charliteral">&#39;!&#39;</span>, $this-&gt;str);</div>
<div class="line"><span class="lineno">  452</span>        $this-&gt;str= preg_replace(<span class="stringliteral">&#39;/{/&#39;</span>, <span class="stringliteral">&#39; { &#39;</span>, $this-&gt;str);</div>
<div class="line"><span class="lineno">  453</span>        $this-&gt;str= preg_replace(<span class="stringliteral">&#39;/}/&#39;</span>, <span class="stringliteral">&#39; } &#39;</span>, $this-&gt;str);</div>
<div class="line"><span class="lineno">  454</span>        $this-&gt;str= preg_replace(<span class="stringliteral">&#39;/\&zwj;(/&#39;</span>, <span class="stringliteral">&#39; ( &#39;</span>, $this-&gt;str);</div>
<div class="line"><span class="lineno">  455</span>        $this-&gt;str= preg_replace(<span class="stringliteral">&#39;/\&zwj;)/&#39;</span>, <span class="stringliteral">&#39; ) &#39;</span>, $this-&gt;str);</div>
<div class="line"><span class="lineno">  456</span>        $this-&gt;str= preg_replace(<span class="stringliteral">&#39;/,/&#39;</span>, <span class="stringliteral">&#39; , &#39;</span>, $this-&gt;str);</div>
<div class="line"><span class="lineno">  457</span>        $this-&gt;str= preg_replace(<span class="stringliteral">&#39;/&quot;/&#39;</span>, <span class="stringliteral">&#39; &quot; &#39;</span>, $this-&gt;str);</div>
<div class="line"><span class="lineno">  458</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c0c41e7a45a3c1899074b89c235114c" name="a6c0c41e7a45a3c1899074b89c235114c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c0c41e7a45a3c1899074b89c235114c">&#9670;&#160;</a></span>split()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">split </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Splits rule string into words. </p>
<p>The string is split into words at certain types of chars, such as spaces, commas, and tabs. However, this method is overridden for special processing in Anchor and Timeout classes.</p>
<p>We don't set any limit on the number of words, but ask for non-empty results only. </p>

<p>Reimplemented in <a class="el" href="classModel_1_1Anchor.html#a6c0c41e7a45a3c1899074b89c235114c">Anchor</a>, and <a class="el" href="classModel_1_1Timeout.html#a6c0c41e7a45a3c1899074b89c235114c">Timeout</a>.</p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00468">468</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  469</span>    {</div>
<div class="line"><span class="lineno">  470</span>        $this-&gt;words= preg_split(<span class="stringliteral">&#39;/[\s,\t]+/&#39;</span>, $this-&gt;str, -1, PREG_SPLIT_NO_EMPTY);</div>
<div class="line"><span class="lineno">  471</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6945888a8bff78801ed111a0614e029a" name="a6945888a8bff78801ed111a0614e029a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6945888a8bff78801ed111a0614e029a">&#9670;&#160;</a></span>validate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">validate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ruleArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$force</em> = <code>FALSE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validates rule array. </p>
<p>The rule array is the internal representation of pf rules. Types of the elements in different rule categories are defined in typedefs.</p>
<p>We try to match the keys in $ruleArray with the ones in $typedef. If the keys match, we apply the validation method defined in the typedef struct to the value of the key in the rule array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$ruleArray</td><td>Rule array. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$force</td><td>Parameter to pass to validation function, currently just IsInlineAnchor(). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE if validated, FALSE if not. </dd></dl>
<p>Clone the rule array, because we delete array elements after validation.</p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00223">223</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  224</span>    {</div>
<div class="line"><span class="lineno">  226</span>        $arr= $ruleArray;</div>
<div class="line"><span class="lineno">  227</span>        <span class="keywordflow">foreach</span> ($this-&gt;<span class="keyword">typedef</span> as $key =&gt; $def) {</div>
<div class="line"><span class="lineno">  228</span>            <span class="keywordflow">if</span> (!$this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a510cd31ccdc9ebbb4ee79ac1b87e5967">validateKeyDef</a>($arr, $key, $def, <span class="stringliteral">&#39;&#39;</span>, <a class="code hl_variable" href="conf_8write_8php.html#ac60027de12260e75a070f5a7618fd632">$force</a>)) {</div>
<div class="line"><span class="lineno">  229</span>                <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  230</span>            }</div>
<div class="line"><span class="lineno">  231</span>        }</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>        <span class="keywordflow">if</span> (count($arr) &gt; 0) {</div>
<div class="line"><span class="lineno">  234</span>            <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>($this-&gt;nestingStr . _(<span class="stringliteral">&#39;Rule&#39;</span>) . <span class="stringliteral">&quot; $this-&gt;ruleNumber: &quot;</span> . _(<span class="stringliteral">&#39;Validation Error&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . _(<span class="stringliteral">&#39;Unexpected elements&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . implode(<span class="stringliteral">&#39;, &#39;</span>, array_keys($arr)));</div>
<div class="line"><span class="lineno">  235</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_NOTICE, __FILE__, __FUNCTION__, __LINE__, $this-&gt;nestingStr . <span class="stringliteral">&quot;Rule $this-&gt;ruleNumber: Validation Error: Unexpected elements: &quot;</span> . implode(<span class="stringliteral">&#39;, &#39;</span>, array_keys($arr)));</div>
<div class="line"><span class="lineno">  236</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  237</span>        }</div>
<div class="line"><span class="lineno">  238</span>        <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  239</span>    }</div>
<div class="ttc" id="aModel_2include_8php_html_a5afab85a7aaf19395f9a0e86cae76928"><div class="ttname"><a href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a></div><div class="ttdeci">Error($msg)</div><div class="ttdoc">Sets or updates $Error with the given message.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00131">include.php:131</a></div></div>
<div class="ttc" id="aclassModel_1_1Rule_html_a510cd31ccdc9ebbb4ee79ac1b87e5967"><div class="ttname"><a href="classModel_1_1Rule.html#a510cd31ccdc9ebbb4ee79ac1b87e5967">Model\Rule\validateKeyDef</a></div><div class="ttdeci">validateKeyDef(&amp;$arr, $key, $def, $parent, $force=FALSE)</div><div class="ttdoc">Finds the validation method to apply to rule value.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00264">Rule.php:264</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="conf_8write_8php_source.html#l00041">$force</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, and <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_1_1Rule_a6945888a8bff78801ed111a0614e029a_cgraph.png" border="0" usemap="#aclassModel_1_1Rule_a6945888a8bff78801ed111a0614e029a_cgraph" alt=""/></div>
<map name="aclassModel_1_1Rule_a6945888a8bff78801ed111a0614e029a_cgraph" id="aclassModel_1_1Rule_a6945888a8bff78801ed111a0614e029a_cgraph">
<area shape="rect" title="Validates rule array." alt="" coords="5,31,80,56"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="128,5,220,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="147,55,201,80"/>
</map>
</div>

</div>
</div>
<a id="ac346884d2c002f9049547879f9047dbb" name="ac346884d2c002f9049547879f9047dbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac346884d2c002f9049547879f9047dbb">&#9670;&#160;</a></span>validateArrayValues()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">validateArrayValues </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$def</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$force</em> = <code>FALSE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies validation method to values in rule array. </p>
<p>Certain rule elements can have multiple values, such as source and destination addresses. These are marked as 'multi' in typedef. So we apply the same validation method to each value in the rule element.</p>
<p>Some rule elements can have multiple elements, such as limit definitions. These are marked as 'values' in typedef. This basically means that the rule element contains another rule array in it. So we call validateKeyDef() method to validate such embedded arrays recursively. This is the start of recursion.</p>
<p>Since we delete the array elements after applying the validation method, the number of elements in the array should be 0 while exiting. Otherwise is a violation.</p>
<p>Since this method is called for rule elements of array type only, it is a validation error if the definition for the rule element does not have 'multi' or 'values'.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$arr</td><td>Rule array. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td>Key to search in both rule array and typedef. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$def</td><td>Validation definition. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$parent</td><td>If the value is an array within another array, this param represents the key of the parent array. Used in error reporting. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$force</td><td>Parameter to pass to validation function. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE if validated, FALSE if not. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00307">307</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  308</span>    {</div>
<div class="line"><span class="lineno">  309</span>        <span class="keywordflow">if</span> (isset($def[<span class="stringliteral">&#39;multi&#39;</span>]) &amp;&amp; $def[<span class="stringliteral">&#39;multi&#39;</span>]) {</div>
<div class="line"><span class="lineno">  310</span>            <span class="keywordflow">foreach</span> ($arr as $v) {</div>
<div class="line"><span class="lineno">  311</span>                <span class="keywordflow">if</span> (!$this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#af3fb11187e81b9bc9f010a8b18831824">validateValue</a>($key, $v, $def, $parent, <a class="code hl_variable" href="conf_8write_8php.html#ac60027de12260e75a070f5a7618fd632">$force</a>)) {</div>
<div class="line"><span class="lineno">  312</span>                    <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  313</span>                }</div>
<div class="line"><span class="lineno">  314</span>            }</div>
<div class="line"><span class="lineno">  315</span>        } elseif (isset($def[<span class="stringliteral">&#39;values&#39;</span>]) &amp;&amp; is_array($def[<span class="stringliteral">&#39;values&#39;</span>])) {</div>
<div class="line"><span class="lineno">  316</span>            <span class="keywordflow">foreach</span> ($def[<span class="stringliteral">&#39;values&#39;</span>] as $k =&gt; $d) {</div>
<div class="line"><span class="lineno">  317</span>                <span class="comment">// Recursion</span></div>
<div class="line"><span class="lineno">  318</span>                <span class="keywordflow">if</span> (!$this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#a510cd31ccdc9ebbb4ee79ac1b87e5967">validateKeyDef</a>($arr, $k, $d, $key, <a class="code hl_variable" href="conf_8write_8php.html#ac60027de12260e75a070f5a7618fd632">$force</a>)) {</div>
<div class="line"><span class="lineno">  319</span>                    <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  320</span>                }</div>
<div class="line"><span class="lineno">  321</span>            }</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>            <span class="keywordflow">if</span> (count($arr) &gt; 0) {</div>
<div class="line"><span class="lineno">  324</span>                <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>($this-&gt;nestingStr . _(<span class="stringliteral">&#39;Rule&#39;</span>) . <span class="stringliteral">&quot; $this-&gt;ruleNumber: &quot;</span> . _(<span class="stringliteral">&#39;Validation Error&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . _(<span class="stringliteral">&#39;Unexpected elements&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . ltrim(<span class="stringliteral">&quot;$parent.$key&quot;</span>, <span class="charliteral">&#39;.&#39;</span>) . <span class="charliteral">&#39; &#39;</span> . implode(<span class="stringliteral">&#39;, &#39;</span>, array_keys($arr)));</div>
<div class="line"><span class="lineno">  325</span>                <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_NOTICE, __FILE__, __FUNCTION__, __LINE__, $this-&gt;nestingStr . <span class="stringliteral">&quot;Rule $this-&gt;ruleNumber: Validation Error: Unexpected elements: &quot;</span> . ltrim(<span class="stringliteral">&quot;$parent.$key&quot;</span>, <span class="charliteral">&#39;.&#39;</span>) . <span class="charliteral">&#39; &#39;</span> . implode(<span class="stringliteral">&#39;, &#39;</span>, array_keys($arr)));</div>
<div class="line"><span class="lineno">  326</span>                <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  327</span>            }</div>
<div class="line"><span class="lineno">  328</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  329</span>            <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>($this-&gt;nestingStr . _(<span class="stringliteral">&#39;Rule&#39;</span>) . <span class="stringliteral">&quot; $this-&gt;ruleNumber: &quot;</span> . _(<span class="stringliteral">&#39;Validation Error&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . _(<span class="stringliteral">&#39;Multiple values not allowed for&#39;</span>) . <span class="charliteral">&#39; &#39;</span> . ltrim(<span class="stringliteral">&quot;$parent.$key&quot;</span>, <span class="charliteral">&#39;.&#39;</span>));</div>
<div class="line"><span class="lineno">  330</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_NOTICE, __FILE__, __FUNCTION__, __LINE__, $this-&gt;nestingStr . <span class="stringliteral">&quot;Rule $this-&gt;ruleNumber: Validation Error: Multiple values not allowed for &quot;</span> . ltrim(<span class="stringliteral">&quot;$parent.$key&quot;</span>, <span class="charliteral">&#39;.&#39;</span>));</div>
<div class="line"><span class="lineno">  331</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  332</span>        }</div>
<div class="line"><span class="lineno">  333</span>        <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  334</span>    }</div>
<div class="ttc" id="aclassModel_1_1Rule_html_af3fb11187e81b9bc9f010a8b18831824"><div class="ttname"><a href="classModel_1_1Rule.html#af3fb11187e81b9bc9f010a8b18831824">Model\Rule\validateValue</a></div><div class="ttdeci">validateValue($key, $value, $def, $parent, $force=FALSE)</div><div class="ttdoc">Validates a value.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00358">Rule.php:358</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="conf_8write_8php_source.html#l00041">$force</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, and <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_1_1Rule_ac346884d2c002f9049547879f9047dbb_cgraph.png" border="0" usemap="#aclassModel_1_1Rule_ac346884d2c002f9049547879f9047dbb_cgraph" alt=""/></div>
<map name="aclassModel_1_1Rule_ac346884d2c002f9049547879f9047dbb_cgraph" id="aclassModel_1_1Rule_ac346884d2c002f9049547879f9047dbb_cgraph">
<area shape="rect" title="Applies validation method to values in rule array." alt="" coords="5,31,159,56"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="207,5,299,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="226,55,279,80"/>
</map>
</div>

</div>
</div>
<a id="a510cd31ccdc9ebbb4ee79ac1b87e5967" name="a510cd31ccdc9ebbb4ee79ac1b87e5967"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a510cd31ccdc9ebbb4ee79ac1b87e5967">&#9670;&#160;</a></span>validateKeyDef()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">validateKeyDef </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$def</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$force</em> = <code>FALSE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the validation method to apply to rule value. </p>
<p>If the value is an array, we call a recursive method. This is so, because array elements may have other arrays in them too.</p>
<p>If the value is not an array, we directly apply the validation method. This ends the recursion, if any.</p>
<p>The rule array should have only the elements defined in typedef struct, and those elements only. Extra elements are considered invalid. We delete the key in the rule after applying the validation method, because after applying all defined validation methods, we'd like to see if there are any extra elements left which are not defined in typedef. This method is easier than diffing the rule array against the typedef. Note that the rule array we operate on is the clone of the actual rule array, hence we can freely delete elements.</p>
<p>If a key in typedef is marked as 'require', it should exist in the rule array, otherwise is an error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$arr</td><td>Rule array. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td>Key to search in both rule array and typedef. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$def</td><td>Validation definition. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$parent</td><td>If the value is an array within another array, this param represents the key of the parent array. Used in error reporting. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$force</td><td>Parameter to pass to validation function. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE if validated, FALSE if not. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00264">264</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  265</span>    {</div>
<div class="line"><span class="lineno">  266</span>        <span class="keywordflow">if</span> (array_key_exists($key, $arr)) {</div>
<div class="line"><span class="lineno">  267</span>            <span class="keywordflow">if</span> (is_array($arr[$key])) {</div>
<div class="line"><span class="lineno">  268</span>                <span class="comment">// Recursion</span></div>
<div class="line"><span class="lineno">  269</span>                <span class="keywordflow">if</span> (!$this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#ac346884d2c002f9049547879f9047dbb">validateArrayValues</a>($arr[$key], $key, $def, $parent, <a class="code hl_variable" href="conf_8write_8php.html#ac60027de12260e75a070f5a7618fd632">$force</a>)) {</div>
<div class="line"><span class="lineno">  270</span>                    <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  271</span>                }</div>
<div class="line"><span class="lineno">  272</span>            } elseif (!$this-&gt;<a class="code hl_function" href="classModel_1_1Rule.html#af3fb11187e81b9bc9f010a8b18831824">validateValue</a>($key, $arr[$key], $def, $parent, <a class="code hl_variable" href="conf_8write_8php.html#ac60027de12260e75a070f5a7618fd632">$force</a>)) {</div>
<div class="line"><span class="lineno">  273</span>                <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  274</span>            }</div>
<div class="line"><span class="lineno">  275</span>            unset($arr[$key]);</div>
<div class="line"><span class="lineno">  276</span>        } elseif (isset($def[<span class="stringliteral">&#39;require&#39;</span>]) &amp;&amp; $def[<span class="stringliteral">&#39;require&#39;</span>]) {</div>
<div class="line"><span class="lineno">  277</span>            <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>($this-&gt;nestingStr . _(<span class="stringliteral">&#39;Rule&#39;</span>) . <span class="stringliteral">&quot; $this-&gt;ruleNumber: &quot;</span> . _(<span class="stringliteral">&#39;Validation Error&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . _(<span class="stringliteral">&#39;Required element missing&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . ltrim(<span class="stringliteral">&quot;$parent.$key&quot;</span>, <span class="charliteral">&#39;.&#39;</span>));</div>
<div class="line"><span class="lineno">  278</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_NOTICE, __FILE__, __FUNCTION__, __LINE__, $this-&gt;nestingStr . <span class="stringliteral">&quot;Rule $this-&gt;ruleNumber: Validation Error: Required element missing: &quot;</span> . ltrim(<span class="stringliteral">&quot;$parent.$key&quot;</span>, <span class="charliteral">&#39;.&#39;</span>));</div>
<div class="line"><span class="lineno">  279</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  280</span>        }</div>
<div class="line"><span class="lineno">  281</span>        <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  282</span>    }</div>
<div class="ttc" id="aclassModel_1_1Rule_html_ac346884d2c002f9049547879f9047dbb"><div class="ttname"><a href="classModel_1_1Rule.html#ac346884d2c002f9049547879f9047dbb">Model\Rule\validateArrayValues</a></div><div class="ttdeci">validateArrayValues(&amp;$arr, $key, $def, $parent, $force=FALSE)</div><div class="ttdoc">Applies validation method to values in rule array.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2Rule_8php_source.html#l00307">Rule.php:307</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="conf_8write_8php_source.html#l00041">$force</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, and <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_1_1Rule_a510cd31ccdc9ebbb4ee79ac1b87e5967_cgraph.png" border="0" usemap="#aclassModel_1_1Rule_a510cd31ccdc9ebbb4ee79ac1b87e5967_cgraph" alt=""/></div>
<map name="aclassModel_1_1Rule_a510cd31ccdc9ebbb4ee79ac1b87e5967_cgraph" id="aclassModel_1_1Rule_a510cd31ccdc9ebbb4ee79ac1b87e5967_cgraph">
<area shape="rect" title="Finds the validation method to apply to rule value." alt="" coords="5,31,128,56"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="176,5,268,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="195,55,249,80"/>
</map>
</div>

</div>
</div>
<a id="af3fb11187e81b9bc9f010a8b18831824" name="af3fb11187e81b9bc9f010a8b18831824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3fb11187e81b9bc9f010a8b18831824">&#9670;&#160;</a></span>validateValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">validateValue </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$def</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$force</em> = <code>FALSE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validates a value. </p>
<p>This is where we apply validation methods to values.</p>
<p>Typedef may be a regular expression defined in 'regex' value. We apply this regex to the value using preg_match().</p>
<p>Typedef may instruct us to apply a validation function to the value. The name of the function is defined in 'func' value. Since we call this function directly, it should be a regular function defined in global namespace, not a class member.</p>
<p>If the validation function can be forced, it is marked using 'force'. In this case, we pass the $force param to the validation function.</p>
<p>Validation method should be defined as a regex or a function. Otherwise is an error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td>Key to search in both rule array and typedef. </td></tr>
    <tr><td class="paramtype">mixed</td><td class="paramname">$value</td><td>Value to validate, array or string. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$def</td><td>Validation definition. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$parent</td><td>If the value is an array within another array, this param represents the key of the parent array. Used in error reporting. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$force</td><td>Parameter to pass to validation function. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE if validated, FALSE if not. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000015">Todo:</a></b></dt><dd>Should we use call_user_func_array() and pass params in an array? </dd></dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00358">358</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  359</span>    {</div>
<div class="line"><span class="lineno">  360</span>        <span class="keywordflow">if</span> (isset($def[<span class="stringliteral">&#39;regex&#39;</span>])) {</div>
<div class="line"><span class="lineno">  361</span>            $rxfn= $def[<span class="stringliteral">&#39;regex&#39;</span>];</div>
<div class="line"><span class="lineno">  362</span>            $result= preg_match(<span class="stringliteral">&quot;/$rxfn/&quot;</span>, $value);</div>
<div class="line"><span class="lineno">  363</span>        } elseif (isset($def[<span class="stringliteral">&#39;func&#39;</span>])) {</div>
<div class="line"><span class="lineno">  364</span>            $rxfn= $def[<span class="stringliteral">&#39;func&#39;</span>];</div>
<div class="line"><span class="lineno">  366</span>            <span class="keywordflow">if</span> (isset($def[<span class="stringliteral">&#39;force&#39;</span>]) &amp;&amp; $def[<span class="stringliteral">&#39;force&#39;</span>]) {</div>
<div class="line"><span class="lineno">  367</span>                $result= $rxfn($value, <a class="code hl_variable" href="conf_8write_8php.html#ac60027de12260e75a070f5a7618fd632">$force</a>);</div>
<div class="line"><span class="lineno">  368</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  369</span>                $result= $rxfn($value);</div>
<div class="line"><span class="lineno">  370</span>            }</div>
<div class="line"><span class="lineno">  371</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  372</span>            <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>($this-&gt;nestingStr . _(<span class="stringliteral">&#39;Rule&#39;</span>) . <span class="stringliteral">&quot; $this-&gt;ruleNumber: &quot;</span> . _(<span class="stringliteral">&#39;Validation Error&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . _(<span class="stringliteral">&#39;No regex or func def for&#39;</span>) . <span class="charliteral">&#39; &#39;</span> . ltrim(<span class="stringliteral">&quot;$parent.$key&quot;</span>, <span class="charliteral">&#39;.&#39;</span>));</div>
<div class="line"><span class="lineno">  373</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, $this-&gt;nestingStr . <span class="stringliteral">&quot;Rule $this-&gt;ruleNumber: Validation Error: No regex or func def for &quot;</span> . ltrim(<span class="stringliteral">&quot;$parent.$key&quot;</span>, <span class="charliteral">&#39;.&#39;</span>));</div>
<div class="line"><span class="lineno">  374</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  375</span>        }</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>        <span class="keywordflow">if</span> (!$result) {</div>
<div class="line"><span class="lineno">  378</span>            <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>($this-&gt;nestingStr . _(<span class="stringliteral">&#39;Rule&#39;</span>) . <span class="stringliteral">&quot; $this-&gt;ruleNumber: &quot;</span> . _(<span class="stringliteral">&#39;Validation Error&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . _(<span class="stringliteral">&#39;Invalid value for&#39;</span>) . <span class="stringliteral">&quot; &#39;&quot;</span> . ltrim(<span class="stringliteral">&quot;$parent.$key&quot;</span>, <span class="charliteral">&#39;.&#39;</span>) . <span class="stringliteral">&quot;&#39;: &lt;pre&gt;&quot;</span> . htmlentities(print_r($value, TRUE)) . <span class="stringliteral">&#39;&lt;/pre&gt;&#39;</span>);</div>
<div class="line"><span class="lineno">  379</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, $this-&gt;nestingStr . <span class="stringliteral">&quot;Rule $this-&gt;ruleNumber: Validation Error: Invalid value for &#39;&quot;</span> . ltrim(<span class="stringliteral">&quot;$parent.$key&quot;</span>, <span class="charliteral">&#39;.&#39;</span>) . <span class="stringliteral">&quot;&#39;: &quot;</span> . print_r($value, TRUE));</div>
<div class="line"><span class="lineno">  380</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  381</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  382</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, $this-&gt;nestingStr . <span class="stringliteral">&quot;Rule $this-&gt;ruleNumber: Valid value for &#39;&quot;</span> . ltrim(<span class="stringliteral">&quot;$parent.$key&quot;</span>, <span class="charliteral">&#39;.&#39;</span>) . <span class="stringliteral">&quot;&#39;: &quot;</span> . print_r($value, TRUE) . <span class="stringliteral">&quot;, $rxfn&quot;</span>);</div>
<div class="line"><span class="lineno">  383</span>        }</div>
<div class="line"><span class="lineno">  384</span>        <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  385</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="conf_8write_8php_source.html#l00041">$force</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, and <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_1_1Rule_af3fb11187e81b9bc9f010a8b18831824_cgraph.png" border="0" usemap="#aclassModel_1_1Rule_af3fb11187e81b9bc9f010a8b18831824_cgraph" alt=""/></div>
<map name="aclassModel_1_1Rule_af3fb11187e81b9bc9f010a8b18831824_cgraph" id="aclassModel_1_1Rule_af3fb11187e81b9bc9f010a8b18831824_cgraph">
<area shape="rect" title="Validates a value." alt="" coords="5,31,116,56"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="164,5,256,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="183,55,237,80"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a id="a9e05c34c5aba2b3a1fcaadefe6f172eb" name="a9e05c34c5aba2b3a1fcaadefe6f172eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e05c34c5aba2b3a1fcaadefe6f172eb">&#9670;&#160;</a></span>$cat</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$cat = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rule category. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00035">35</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="a23e53dfd2b001b81c9946fa05ec90e6f" name="a23e53dfd2b001b81c9946fa05ec90e6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23e53dfd2b001b81c9946fa05ec90e6f">&#9670;&#160;</a></span>$index</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$index = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00043">43</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="a041015ee18a86128af54756f493634a4" name="a041015ee18a86128af54756f493634a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a041015ee18a86128af54756f493634a4">&#9670;&#160;</a></span>$keyAf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$keyAf</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= array(</div>
<div class="line">        <span class="stringliteral">&#39;inet&#39;</span> =&gt; array(</div>
<div class="line">            <span class="stringliteral">&#39;method&#39;</span> =&gt; <span class="stringliteral">&#39;parseNVP&#39;</span>,</div>
<div class="line">            <span class="stringliteral">&#39;params&#39;</span> =&gt; array(<span class="stringliteral">&#39;af&#39;</span>),</div>
<div class="line">            ),</div>
<div class="line">        <span class="stringliteral">&#39;inet6&#39;</span> =&gt; array(</div>
<div class="line">            <span class="stringliteral">&#39;method&#39;</span> =&gt; <span class="stringliteral">&#39;parseNVP&#39;</span>,</div>
<div class="line">            <span class="stringliteral">&#39;params&#39;</span> =&gt; array(<span class="stringliteral">&#39;af&#39;</span>),</div>
<div class="line">            ),</div>
<div class="line">        )</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00068">68</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="ad30a971c97145df8297e4b4541b7127b" name="ad30a971c97145df8297e4b4541b7127b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad30a971c97145df8297e4b4541b7127b">&#9670;&#160;</a></span>$keyInterface</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$keyInterface</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= array(</div>
<div class="line">        <span class="stringliteral">&#39;on&#39;</span> =&gt; array(</div>
<div class="line">            <span class="stringliteral">&#39;method&#39;</span> =&gt; <span class="stringliteral">&#39;parseItems&#39;</span>,</div>
<div class="line">            <span class="stringliteral">&#39;params&#39;</span> =&gt; array(<span class="stringliteral">&#39;interface&#39;</span>),</div>
<div class="line">            ),</div>
<div class="line">        )</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00061">61</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="ad98a64fa8e9e88677a15587f62a45474" name="ad98a64fa8e9e88677a15587f62a45474"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad98a64fa8e9e88677a15587f62a45474">&#9670;&#160;</a></span>$keyLog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$keyLog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= array(</div>
<div class="line">        <span class="stringliteral">&#39;log&#39;</span> =&gt; array(</div>
<div class="line">            <span class="stringliteral">&#39;method&#39;</span> =&gt; <span class="stringliteral">&#39;parseLog&#39;</span>,</div>
<div class="line">            <span class="stringliteral">&#39;params&#39;</span> =&gt; array(),</div>
<div class="line">            ),</div>
<div class="line">        )</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00079">79</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="ac7a08a65ba1786d5788767d5ec117c55" name="ac7a08a65ba1786d5788767d5ec117c55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7a08a65ba1786d5788767d5ec117c55">&#9670;&#160;</a></span>$keyQuick</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$keyQuick</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= array(</div>
<div class="line">        <span class="stringliteral">&#39;quick&#39;</span> =&gt; array(</div>
<div class="line">            <span class="stringliteral">&#39;method&#39;</span> =&gt; <span class="stringliteral">&#39;parseBool&#39;</span>,</div>
<div class="line">            <span class="stringliteral">&#39;params&#39;</span> =&gt; array(),</div>
<div class="line">            ),</div>
<div class="line">        )</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00086">86</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="a9fbd95bfcdf27d802a8c7938529a61ba" name="a9fbd95bfcdf27d802a8c7938529a61ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fbd95bfcdf27d802a8c7938529a61ba">&#9670;&#160;</a></span>$keywords</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$keywords = array()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The keywords possible in this type of rule are accumulated in this array. </p>
<p>We search for such keywords while parsing the given strings. The parser functions are defined in 'method', and the parameters of this function are listed in an array in 'params'. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00059">59</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="a87953ecab962f6663d6d2e3dd06e5e23" name="a87953ecab962f6663d6d2e3dd06e5e23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87953ecab962f6663d6d2e3dd06e5e23">&#9670;&#160;</a></span>$nestingStr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$nestingStr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Represents nesting number while reporting errors in anchor inline rules. </p>
<p>We allow for nested anchors in inline rules. If there are errors in such nested anchor rules, we report the nesting number of the anchor along with the line number. Otherwise, the line numbers reported in the errors are restarted from 0. This is because we create a new RuleSet object for each inline ruleset.</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000002">Bug:</a></b></dt><dd>Doxygen removes all documentation for a member var if var tag is used here. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00158">158</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="a85b0fb17593555da65ddd33db4ad8444" name="a85b0fb17593555da65ddd33db4ad8444"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85b0fb17593555da65ddd33db4ad8444">&#9670;&#160;</a></span>$rule</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$rule = array()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Internal structure for rules. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00040">40</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="a72c8c7754a73e2cd6b8a1537fafd46fa" name="a72c8c7754a73e2cd6b8a1537fafd46fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72c8c7754a73e2cd6b8a1537fafd46fa">&#9670;&#160;</a></span>$ruleNumber</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$ruleNumber = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00050">50</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="a7542d95618011800c61773127fa625cf" name="a7542d95618011800c61773127fa625cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7542d95618011800c61773127fa625cf">&#9670;&#160;</a></span>$str</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$str = ''</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00042">42</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="a16e6074571c059a912a50461f77c2d7d" name="a16e6074571c059a912a50461f77c2d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16e6074571c059a912a50461f77c2d7d">&#9670;&#160;</a></span>$typeAf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$typeAf</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= array(</div>
<div class="line">        <span class="stringliteral">&#39;af&#39;</span> =&gt; array(</div>
<div class="line">            <span class="stringliteral">&#39;regex&#39;</span> =&gt; <a class="code hl_variable" href="validate_8php.html#a0eac3493000696a4e8aa4dae2d87a1c5">RE_AF</a>,</div>
<div class="line">            ),</div>
<div class="line">        )</div>
<div class="ttc" id="avalidate_8php_html_a0eac3493000696a4e8aa4dae2d87a1c5"><div class="ttname"><a href="validate_8php.html#a0eac3493000696a4e8aa4dae2d87a1c5">RE_AF</a></div><div class="ttdeci">const RE_AF</div><div class="ttdef"><b>Definition:</b> <a href="validate_8php_source.html#l00051">validate.php:51</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00105">105</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="aeb29924c3a2bc86eb23ee608c709c8bd" name="aeb29924c3a2bc86eb23ee608c709c8bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb29924c3a2bc86eb23ee608c709c8bd">&#9670;&#160;</a></span>$typeComment</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$typeComment</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= array(</div>
<div class="line">        <span class="stringliteral">&#39;comment&#39;</span> =&gt; array(</div>
<div class="line">            <span class="stringliteral">&#39;regex&#39;</span> =&gt; <a class="code hl_variable" href="validate_8php.html#ac7407548c6da71b28629795852d65dc4">RE_COMMENT_INLINE</a>,</div>
<div class="line">            ),</div>
<div class="line">        )</div>
<div class="ttc" id="avalidate_8php_html_ac7407548c6da71b28629795852d65dc4"><div class="ttname"><a href="validate_8php.html#ac7407548c6da71b28629795852d65dc4">RE_COMMENT_INLINE</a></div><div class="ttdeci">const RE_COMMENT_INLINE</div><div class="ttdef"><b>Definition:</b> <a href="validate_8php_source.html#l00110">validate.php:110</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00142">142</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="a8efd781e4f469d50e60f5c62ebc6dd5b" name="a8efd781e4f469d50e60f5c62ebc6dd5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8efd781e4f469d50e60f5c62ebc6dd5b">&#9670;&#160;</a></span>$typedef</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$typedef = array()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Type definitions for the rule category are accumulated in this member var. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00096">96</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="a5c6205a05313bb99d22326effa594fda" name="a5c6205a05313bb99d22326effa594fda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c6205a05313bb99d22326effa594fda">&#9670;&#160;</a></span>$typeInterface</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$typeInterface</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= array(</div>
<div class="line">        <span class="stringliteral">&#39;interface&#39;</span> =&gt; array(</div>
<div class="line">            <span class="stringliteral">&#39;multi&#39;</span> =&gt; TRUE,</div>
<div class="line">            <span class="stringliteral">&#39;regex&#39;</span> =&gt; <a class="code hl_variable" href="validate_8php.html#ad99dde02d2a8263468f29a9d813a43a8">RE_IFSPEC</a>,</div>
<div class="line">            ),</div>
<div class="line">        )</div>
<div class="ttc" id="avalidate_8php_html_ad99dde02d2a8263468f29a9d813a43a8"><div class="ttname"><a href="validate_8php.html#ad99dde02d2a8263468f29a9d813a43a8">RE_IFSPEC</a></div><div class="ttdeci">const RE_IFSPEC</div><div class="ttdef"><b>Definition:</b> <a href="validate_8php_source.html#l00046">validate.php:46</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00098">98</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="a23aa46f8a0a0b89e7817fc0d137dee32" name="a23aa46f8a0a0b89e7817fc0d137dee32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23aa46f8a0a0b89e7817fc0d137dee32">&#9670;&#160;</a></span>$typeLog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$typeLog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= array(</div>
<div class="line">        <span class="stringliteral">&#39;log&#39;</span> =&gt; array(</div>
<div class="line">            <span class="stringliteral">&#39;regex&#39;</span> =&gt; <a class="code hl_variable" href="validate_8php.html#af39772f0c2b17ba7898676bbb5a34351">RE_BOOL</a>,</div>
<div class="line">            <span class="stringliteral">&#39;values&#39;</span> =&gt; array(</div>
<div class="line">                <span class="stringliteral">&#39;all&#39;</span> =&gt; array(</div>
<div class="line">                    <span class="stringliteral">&#39;regex&#39;</span> =&gt; <a class="code hl_variable" href="validate_8php.html#af39772f0c2b17ba7898676bbb5a34351">RE_BOOL</a>,</div>
<div class="line">                    ),</div>
<div class="line">                <span class="stringliteral">&#39;matches&#39;</span> =&gt; array(</div>
<div class="line">                    <span class="stringliteral">&#39;regex&#39;</span> =&gt; <a class="code hl_variable" href="validate_8php.html#af39772f0c2b17ba7898676bbb5a34351">RE_BOOL</a>,</div>
<div class="line">                    ),</div>
<div class="line">                <span class="stringliteral">&#39;user&#39;</span> =&gt; array(</div>
<div class="line">                    <span class="stringliteral">&#39;regex&#39;</span> =&gt; <a class="code hl_variable" href="validate_8php.html#af39772f0c2b17ba7898676bbb5a34351">RE_BOOL</a>,</div>
<div class="line">                    ),</div>
<div class="line">                <span class="stringliteral">&#39;to&#39;</span> =&gt; array(</div>
<div class="line">                    <span class="stringliteral">&#39;regex&#39;</span> =&gt; <a class="code hl_variable" href="validate_8php.html#a51a3628f453b04098dc6b454d206b440">RE_IF</a>,</div>
<div class="line">                    ),</div>
<div class="line">                ),</div>
<div class="line">            ),</div>
<div class="line">        )</div>
<div class="ttc" id="avalidate_8php_html_a51a3628f453b04098dc6b454d206b440"><div class="ttname"><a href="validate_8php.html#a51a3628f453b04098dc6b454d206b440">RE_IF</a></div><div class="ttdeci">const RE_IF</div><div class="ttdef"><b>Definition:</b> <a href="validate_8php_source.html#l00043">validate.php:43</a></div></div>
<div class="ttc" id="avalidate_8php_html_af39772f0c2b17ba7898676bbb5a34351"><div class="ttname"><a href="validate_8php.html#af39772f0c2b17ba7898676bbb5a34351">RE_BOOL</a></div><div class="ttdeci">const RE_BOOL</div><div class="ttdef"><b>Definition:</b> <a href="validate_8php_source.html#l00025">validate.php:25</a></div></div>
</div><!-- fragment -->
<p>Log can be of type either bool or array of values. </p>
<dl class="section attention"><dt>Attention</dt><dd>Validate functions can handle multi-type values like this. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00116">116</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="a7e4a4ab312cf76f7cb8da432675403f1" name="a7e4a4ab312cf76f7cb8da432675403f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e4a4ab312cf76f7cb8da432675403f1">&#9670;&#160;</a></span>$typeQuick</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$typeQuick</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= array(</div>
<div class="line">        <span class="stringliteral">&#39;quick&#39;</span> =&gt; array(</div>
<div class="line">            <span class="stringliteral">&#39;regex&#39;</span> =&gt; <a class="code hl_variable" href="validate_8php.html#af39772f0c2b17ba7898676bbb5a34351">RE_BOOL</a>,</div>
<div class="line">            ),</div>
<div class="line">        )</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00136">136</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<a id="a7018c653e9ec2b4c22b533145b4da2a6" name="a7018c653e9ec2b4c22b533145b4da2a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7018c653e9ec2b4c22b533145b4da2a6">&#9670;&#160;</a></span>$words</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$words = array()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>String to be parsed is split into words, this is the list holding those words. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Rule_8php_source.html#l00048">48</a> of file <a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/Model/lib/<a class="el" href="Model_2lib_2Rule_8php_source.html">Rule.php</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceModel.html">Model</a></li><li class="navelem"><a class="el" href="classModel_1_1Rule.html">Rule</a></li>
    <li class="footer">Generated on Sun Apr 30 2023 00:52:50 for PF Firewall by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
