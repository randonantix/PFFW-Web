<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PF Firewall: Model Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PF Firewall<span id="projectnumber">&#160;7.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classModel.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Data Fields</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle"><div class="title">Model Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for Model:</div>
<div class="dyncontent">
<div class="center"><img src="classModel__inherit__graph.png" border="0" usemap="#aModel_inherit__map" alt="Inheritance graph"/></div>
<map name="aModel_inherit__map" id="aModel_inherit__map">
<area shape="rect" title=" " alt="" coords="381,5,444,31"/>
<area shape="rect" href="classDhcpd.html" title=" " alt="" coords="5,79,68,104"/>
<area shape="rect" href="classDnsmasq.html" title=" " alt="" coords="93,79,175,104"/>
<area shape="rect" href="classDocs.html" title=" " alt="" coords="200,79,255,104"/>
<area shape="rect" href="classFtpproxy.html" title=" " alt="" coords="279,79,359,104"/>
<area shape="rect" href="classHttpd.html" title=" " alt="" coords="383,79,442,104"/>
<area shape="rect" href="classMonitoring.html" title=" " alt="" coords="467,79,559,104"/>
<area shape="rect" href="classOpenssh.html" title=" " alt="" coords="583,79,661,104"/>
<area shape="rect" href="classPf.html" title=" " alt="" coords="685,79,724,104"/>
<area shape="rect" href="classSystem.html" title=" " alt="" coords="748,79,819,104"/>
<area shape="rect" href="classFwlogs.html" title=" " alt="" coords="273,152,341,177"/>
<area shape="rect" href="classHttpdlogs.html" title=" " alt="" coords="366,152,451,177"/>
<area shape="rect" href="classCtlrlogs.html" title=" " alt="" coords="223,225,295,251"/>
<area shape="rect" href="classWuilogs.html" title=" " alt="" coords="319,225,394,251"/>
<area shape="rect" href="classCollectd.html" title=" " alt="" coords="475,152,550,177"/>
<area shape="rect" href="classSymon.html" title=" " alt="" coords="574,152,641,177"/>
<area shape="rect" href="classSymux.html" title=" " alt="" coords="665,152,731,177"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for Model:</div>
<div class="dyncontent">
<div class="center"><img src="classModel__coll__graph.png" border="0" usemap="#aModel_coll__map" alt="Collaboration graph"/></div>
<map name="aModel_coll__map" id="aModel_coll__map">
<area shape="rect" title=" " alt="" coords="5,108,68,133"/>
<area shape="rect" title=" " alt="" coords="8,5,65,31"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a095c5d389db211932136b53f25f39685"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a095c5d389db211932136b53f25f39685">__construct</a> ()</td></tr>
<tr class="separator:a095c5d389db211932136b53f25f39685"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73fbf3721e73a688382663bf84e1e428"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a73fbf3721e73a688382663bf84e1e428">IsRunning</a> ($proc='')</td></tr>
<tr class="memdesc:a73fbf3721e73a688382663bf84e1e428"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the given process(es) is running.  <br /></td></tr>
<tr class="separator:a73fbf3721e73a688382663bf84e1e428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac63c8a259bd05dfef1e6979a2c1f76d0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ac63c8a259bd05dfef1e6979a2c1f76d0">GetProcList</a> ()</td></tr>
<tr class="memdesc:ac63c8a259bd05dfef1e6979a2c1f76d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the list of processes running.  <br /></td></tr>
<tr class="separator:ac63c8a259bd05dfef1e6979a2c1f76d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aead9ffea53f83ba54a7bc722dbc81841"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aead9ffea53f83ba54a7bc722dbc81841">SelectProcesses</a> ($psout)</td></tr>
<tr class="memdesc:aead9ffea53f83ba54a7bc722dbc81841"><td class="mdescLeft">&#160;</td><td class="mdescRight">Selects user processes from ps output.  <br /></td></tr>
<tr class="separator:aead9ffea53f83ba54a7bc722dbc81841"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58a42cd2dbcf0483f1da759a8d283d58"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a58a42cd2dbcf0483f1da759a8d283d58">Start</a> ()</td></tr>
<tr class="memdesc:a58a42cd2dbcf0483f1da759a8d283d58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start module process(es).  <br /></td></tr>
<tr class="separator:a58a42cd2dbcf0483f1da759a8d283d58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f17de803b9ad897ee1e879e90982bd2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a0f17de803b9ad897ee1e879e90982bd2">Stop</a> ()</td></tr>
<tr class="memdesc:a0f17de803b9ad897ee1e879e90982bd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops module process(es)  <br /></td></tr>
<tr class="separator:a0f17de803b9ad897ee1e879e90982bd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a41a34d3378ee890958973fce464aa8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a4a41a34d3378ee890958973fce464aa8">Pkill</a> ($proc, $args='')</td></tr>
<tr class="memdesc:a4a41a34d3378ee890958973fce464aa8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kills the given process(es).  <br /></td></tr>
<tr class="separator:a4a41a34d3378ee890958973fce464aa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14573cc2fd34870091dfe7e8aa1ab171"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a14573cc2fd34870091dfe7e8aa1ab171">GetIntIf</a> ()</td></tr>
<tr class="memdesc:a14573cc2fd34870091dfe7e8aa1ab171"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get int_if.  <br /></td></tr>
<tr class="separator:a14573cc2fd34870091dfe7e8aa1ab171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7abfd365d79fd5b34b3aab5d4ff0c770"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a7abfd365d79fd5b34b3aab5d4ff0c770">_getIntIf</a> ()</td></tr>
<tr class="separator:a7abfd365d79fd5b34b3aab5d4ff0c770"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a190806315bf8a8147417f3735ba66bc5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a190806315bf8a8147417f3735ba66bc5">GetExtIf</a> ()</td></tr>
<tr class="memdesc:a190806315bf8a8147417f3735ba66bc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get ext_if.  <br /></td></tr>
<tr class="separator:a190806315bf8a8147417f3735ba66bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa572c51a6d4aa52ec3029518451a05fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aa572c51a6d4aa52ec3029518451a05fe">_getExtIf</a> ()</td></tr>
<tr class="separator:aa572c51a6d4aa52ec3029518451a05fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae36dbd983c2ff1ec0460a158ab8c41f1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ae36dbd983c2ff1ec0460a158ab8c41f1">isWifiIf</a> ($<a class="el" href="ctlr_8php.html#abc2baa6b327386720a46de43cf272921">if</a>)</td></tr>
<tr class="separator:ae36dbd983c2ff1ec0460a158ab8c41f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d296f9267d193d0b2295d611dcbea6c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a2d296f9267d193d0b2295d611dcbea6c">CreateUser</a> ($user, $passwd, $uid)</td></tr>
<tr class="memdesc:a2d296f9267d193d0b2295d611dcbea6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a system user.  <br /></td></tr>
<tr class="separator:a2d296f9267d193d0b2295d611dcbea6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a356c4619bee6a35594a2ee7ecb7f9d2d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a356c4619bee6a35594a2ee7ecb7f9d2d">SetPassword</a> ($user, $passwd)</td></tr>
<tr class="memdesc:a356c4619bee6a35594a2ee7ecb7f9d2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets user's password in the system password file.  <br /></td></tr>
<tr class="separator:a356c4619bee6a35594a2ee7ecb7f9d2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace6809a36e1a52e1dde4c9d6d662ca4c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ace6809a36e1a52e1dde4c9d6d662ca4c">SetLogLevel</a> ($level)</td></tr>
<tr class="memdesc:ace6809a36e1a52e1dde4c9d6d662ca4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets global log level.  <br /></td></tr>
<tr class="separator:ace6809a36e1a52e1dde4c9d6d662ca4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbf4c282267beb7f8667d0882d82b983"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#abbf4c282267beb7f8667d0882d82b983">SetHelpBox</a> ($bool)</td></tr>
<tr class="memdesc:abbf4c282267beb7f8667d0882d82b983"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables or disables help boxes.  <br /></td></tr>
<tr class="separator:abbf4c282267beb7f8667d0882d82b983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3070438f6bedf2aeeeb313d7c32e5e1e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a3070438f6bedf2aeeeb313d7c32e5e1e">SetSessionTimeout</a> ($timeout)</td></tr>
<tr class="memdesc:a3070438f6bedf2aeeeb313d7c32e5e1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets session timeout.  <br /></td></tr>
<tr class="separator:a3070438f6bedf2aeeeb313d7c32e5e1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a859ad1e51288c4d72ed9eda0f6f5e43e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a859ad1e51288c4d72ed9eda0f6f5e43e">SetDefaultLocale</a> ($locale)</td></tr>
<tr class="memdesc:a859ad1e51288c4d72ed9eda0f6f5e43e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets default locale.  <br /></td></tr>
<tr class="separator:a859ad1e51288c4d72ed9eda0f6f5e43e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a396fea6ec5c2ad29ebee26ea36723133"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a396fea6ec5c2ad29ebee26ea36723133">SetForceHTTPs</a> ($bool)</td></tr>
<tr class="memdesc:a396fea6ec5c2ad29ebee26ea36723133"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables or disables HTTPs.  <br /></td></tr>
<tr class="separator:a396fea6ec5c2ad29ebee26ea36723133"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a760367a76e1eae0a8e8e7bc6c9e0579e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a760367a76e1eae0a8e8e7bc6c9e0579e">SetUseSSH</a> ($bool)</td></tr>
<tr class="memdesc:a760367a76e1eae0a8e8e7bc6c9e0579e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables or disables SSH.  <br /></td></tr>
<tr class="separator:a760367a76e1eae0a8e8e7bc6c9e0579e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3d333424199ea8d1475ffb779b5407c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ad3d333424199ea8d1475ffb779b5407c">SetMaxAnchorNesting</a> ($max)</td></tr>
<tr class="memdesc:ad3d333424199ea8d1475ffb779b5407c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the max number of nested anchors allowed.  <br /></td></tr>
<tr class="separator:ad3d333424199ea8d1475ffb779b5407c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b4ff4a876f224dcd90e3d5cb3e288a4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a2b4ff4a876f224dcd90e3d5cb3e288a4">SetPfctlTimeout</a> ($timeout)</td></tr>
<tr class="memdesc:a2b4ff4a876f224dcd90e3d5cb3e288a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets pfctl timeout.  <br /></td></tr>
<tr class="separator:a2b4ff4a876f224dcd90e3d5cb3e288a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31cfb3981a2789a48b91e3b2ea325681"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a31cfb3981a2789a48b91e3b2ea325681">SetStatusCheckInterval</a> ($interval)</td></tr>
<tr class="memdesc:a31cfb3981a2789a48b91e3b2ea325681"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets status check interval.  <br /></td></tr>
<tr class="separator:a31cfb3981a2789a48b91e3b2ea325681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a396a20de76a1a352c40b3eb64d21bce9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a396a20de76a1a352c40b3eb64d21bce9">SetMaxFileSizeToProcess</a> ($size)</td></tr>
<tr class="memdesc:a396a20de76a1a352c40b3eb64d21bce9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets max file size to process.  <br /></td></tr>
<tr class="separator:a396a20de76a1a352c40b3eb64d21bce9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0601a366475cb83c65f99ad10e663de0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a0601a366475cb83c65f99ad10e663de0">GetReloadRate</a> ()</td></tr>
<tr class="memdesc:a0601a366475cb83c65f99ad10e663de0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets default reload rate.  <br /></td></tr>
<tr class="separator:a0601a366475cb83c65f99ad10e663de0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1151960aeff2e631b01f989afe5b2f7e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a1151960aeff2e631b01f989afe5b2f7e">_getReloadRate</a> ()</td></tr>
<tr class="separator:a1151960aeff2e631b01f989afe5b2f7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add75f616f424040c62005634d34c20b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#add75f616f424040c62005634d34c20b0">SetReloadRate</a> ($rate)</td></tr>
<tr class="memdesc:add75f616f424040c62005634d34c20b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets default reload rate.  <br /></td></tr>
<tr class="separator:add75f616f424040c62005634d34c20b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b098af2c181aba08669ccbc185af5d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8">RunShellCommand</a> ($cmd)</td></tr>
<tr class="memdesc:a9b098af2c181aba08669ccbc185af5d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the given shell command and returns its output as string.  <br /></td></tr>
<tr class="separator:a9b098af2c181aba08669ccbc185af5d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4ee9332ba73886bc02ffb1903a050ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aa4ee9332ba73886bc02ffb1903a050ba">GetFiles</a> ($filepath)</td></tr>
<tr class="memdesc:aa4ee9332ba73886bc02ffb1903a050ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns files with the given filepath pattern.  <br /></td></tr>
<tr class="separator:aa4ee9332ba73886bc02ffb1903a050ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91890c866a00b75b002e6b1016e6b43c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a91890c866a00b75b002e6b1016e6b43c">GetFile</a> ($file)</td></tr>
<tr class="memdesc:a91890c866a00b75b002e6b1016e6b43c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads file contents.  <br /></td></tr>
<tr class="separator:a91890c866a00b75b002e6b1016e6b43c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a620707dcc4093d4ca002e3dfdfa68af1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a620707dcc4093d4ca002e3dfdfa68af1">DeleteFile</a> ($path)</td></tr>
<tr class="memdesc:a620707dcc4093d4ca002e3dfdfa68af1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes the given file or directory.  <br /></td></tr>
<tr class="separator:a620707dcc4093d4ca002e3dfdfa68af1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24813c8e79a850571607408548a88528"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a24813c8e79a850571607408548a88528">PutFile</a> ($file, $contents)</td></tr>
<tr class="memdesc:a24813c8e79a850571607408548a88528"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes contents to file.  <br /></td></tr>
<tr class="separator:a24813c8e79a850571607408548a88528"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcd01c30cbd8fa9ac1c84340e5ed33de"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de">SetNVP</a> ($file, $name, $newvalue)</td></tr>
<tr class="memdesc:abcd01c30cbd8fa9ac1c84340e5ed33de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Changes value of NVP.  <br /></td></tr>
<tr class="separator:abcd01c30cbd8fa9ac1c84340e5ed33de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f197a5f9e014dc06404352d2f4b7e20"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20">GetNVP</a> ($file, $name, $set=0, $trimchars='')</td></tr>
<tr class="memdesc:a8f197a5f9e014dc06404352d2f4b7e20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads value of NVP.  <br /></td></tr>
<tr class="separator:a8f197a5f9e014dc06404352d2f4b7e20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a151a013af243c2c1255caf53dffadc9b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a151a013af243c2c1255caf53dffadc9b">SearchFile</a> ($file, $re, $set=0, $trimchars='')</td></tr>
<tr class="memdesc:a151a013af243c2c1255caf53dffadc9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Searches the given file with the given regex.  <br /></td></tr>
<tr class="separator:a151a013af243c2c1255caf53dffadc9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42dee43d638f627934bd6bca7b8f1397"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a42dee43d638f627934bd6bca7b8f1397">SearchFileAll</a> ($file, $re, $set=1)</td></tr>
<tr class="memdesc:a42dee43d638f627934bd6bca7b8f1397"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multi-searches a given file with a given regexp.  <br /></td></tr>
<tr class="separator:a42dee43d638f627934bd6bca7b8f1397"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa97184370ce56f1abd12ae18ddbf2c40"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aa97184370ce56f1abd12ae18ddbf2c40">ReplaceRegexp</a> ($file, $matchre, $replacere)</td></tr>
<tr class="memdesc:aa97184370ce56f1abd12ae18ddbf2c40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Searches a needle and replaces with a value in the given file.  <br /></td></tr>
<tr class="separator:aa97184370ce56f1abd12ae18ddbf2c40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2af57dba14ec82874dc3302908f36e5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aa2af57dba14ec82874dc3302908f36e5">AppendToFile</a> ($file, $line)</td></tr>
<tr class="memdesc:aa2af57dba14ec82874dc3302908f36e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Appends a string to a file.  <br /></td></tr>
<tr class="separator:aa2af57dba14ec82874dc3302908f36e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f2769948b2be5ec1c6afd2bd4f70637"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a9f2769948b2be5ec1c6afd2bd4f70637">GetDateTime</a> ()</td></tr>
<tr class="memdesc:a9f2769948b2be5ec1c6afd2bd4f70637"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets system datetime.  <br /></td></tr>
<tr class="separator:a9f2769948b2be5ec1c6afd2bd4f70637"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7dc2e292df1ab234a44e9e2a5b170b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aa7dc2e292df1ab234a44e9e2a5b170b0">GetPhyIfs</a> ()</td></tr>
<tr class="memdesc:aa7dc2e292df1ab234a44e9e2a5b170b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts physical interface names from ifconfig output.  <br /></td></tr>
<tr class="separator:aa7dc2e292df1ab234a44e9e2a5b170b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a917be6afd7db6dec41becb528b1690d5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a917be6afd7db6dec41becb528b1690d5">_getPhyIfs</a> ()</td></tr>
<tr class="separator:a917be6afd7db6dec41becb528b1690d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e59d0bd0ce3f0afb4a82ef8c7345c6b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a8e59d0bd0ce3f0afb4a82ef8c7345c6b">GetDefaultLogFile</a> ()</td></tr>
<tr class="memdesc:a8e59d0bd0ce3f0afb4a82ef8c7345c6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the log file of the module.  <br /></td></tr>
<tr class="separator:a8e59d0bd0ce3f0afb4a82ef8c7345c6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf995c8c1f12fe1a00b653fd790c3ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef">SelectLogFile</a> ($file)</td></tr>
<tr class="memdesc:aacf995c8c1f12fe1a00b653fd790c3ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the log file under the tmp folder.  <br /></td></tr>
<tr class="separator:aacf995c8c1f12fe1a00b653fd790c3ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adef576154f41b9e06cbf28bb1a4f74b8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#adef576154f41b9e06cbf28bb1a4f74b8">IsLogFileModified</a> ($logfile)</td></tr>
<tr class="memdesc:adef576154f41b9e06cbf28bb1a4f74b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the given log file has been updated.  <br /></td></tr>
<tr class="separator:adef576154f41b9e06cbf28bb1a4f74b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ece271b0ef8636736f58b3b75268931"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a7ece271b0ef8636736f58b3b75268931">GetTmpLogFileName</a> ($file)</td></tr>
<tr class="memdesc:a7ece271b0ef8636736f58b3b75268931"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the name of the file in the tmp folder.  <br /></td></tr>
<tr class="separator:a7ece271b0ef8636736f58b3b75268931"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4d7aefbd214d3da3f1965e6ddddb998"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ad4d7aefbd214d3da3f1965e6ddddb998">UpdateTmpLogFile</a> ($file)</td></tr>
<tr class="memdesc:ad4d7aefbd214d3da3f1965e6ddddb998"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies the original log file to tmp folder.  <br /></td></tr>
<tr class="separator:ad4d7aefbd214d3da3f1965e6ddddb998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3827d539c75623fd5345ab590caaa2cb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a3827d539c75623fd5345ab590caaa2cb">formatDateHourRegexp</a> ($month, $day, $hour, $minute)</td></tr>
<tr class="memdesc:a3827d539c75623fd5345ab590caaa2cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates the module specific datetime regexp for filtering logs.  <br /></td></tr>
<tr class="separator:a3827d539c75623fd5345ab590caaa2cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e0bb0c7dbe09da8be1338e15c21068a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a9e0bb0c7dbe09da8be1338e15c21068a">formatDateHourRegexpDayLeadingZero</a> ($month, $day, $hour, $minute)</td></tr>
<tr class="separator:a9e0bb0c7dbe09da8be1338e15c21068a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3077006595dffaebf9edc227f4a49a97"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a3077006595dffaebf9edc227f4a49a97">formatDateHourRegexpWeekDays</a> ($month, $day, $hour, $minute)</td></tr>
<tr class="separator:a3077006595dffaebf9edc227f4a49a97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeea778b449fceb9e5e77cc98440ac4bd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aeea778b449fceb9e5e77cc98440ac4bd">GetFileLineCount</a> ($file, $re='', $needle='', $month='', $day='', $hour='', $minute='')</td></tr>
<tr class="memdesc:aeea778b449fceb9e5e77cc98440ac4bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets line count of the given log file.  <br /></td></tr>
<tr class="separator:aeea778b449fceb9e5e77cc98440ac4bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec3d644e69b54bae382fe3aa894c0879"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aec3d644e69b54bae382fe3aa894c0879">_getFileLineCount</a> ($file, $re='', $needle='', $month='', $day='', $hour='', $minute='')</td></tr>
<tr class="separator:aec3d644e69b54bae382fe3aa894c0879"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cd1d5510b23ec577d9d124f9e05a449"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a3cd1d5510b23ec577d9d124f9e05a449">GetLogs</a> ($file, $end, $count, $re='', $needle='', $month='', $day='', $hour='', $minute='')</td></tr>
<tr class="memdesc:a3cd1d5510b23ec577d9d124f9e05a449"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets lines in log file.  <br /></td></tr>
<tr class="separator:a3cd1d5510b23ec577d9d124f9e05a449"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd1e082730aeee7890560b4ca2ee0a62"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#abd1e082730aeee7890560b4ca2ee0a62">GetLiveLogs</a> ($file, $count, $re='')</td></tr>
<tr class="memdesc:abd1e082730aeee7890560b4ca2ee0a62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets logs for live logs pages.  <br /></td></tr>
<tr class="separator:abd1e082730aeee7890560b4ca2ee0a62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80a9c7ffc5b622913366185669db13f8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a80a9c7ffc5b622913366185669db13f8">_getLiveLogs</a> ($file, $count, $re='', $needle='', $reportFileExistResult=TRUE)</td></tr>
<tr class="memdesc:a80a9c7ffc5b622913366185669db13f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets logs for live logs pages, the actual method.  <br /></td></tr>
<tr class="separator:a80a9c7ffc5b622913366185669db13f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf87c48d0be7e3e4563be72e08f120b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aaf87c48d0be7e3e4563be72e08f120b0">GetLastLogs</a> ($file, $count)</td></tr>
<tr class="separator:aaf87c48d0be7e3e4563be72e08f120b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed5ee3c735f862c4d99761b379f31729"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aed5ee3c735f862c4d99761b379f31729">GetLogFilesList</a> ()</td></tr>
<tr class="memdesc:aed5ee3c735f862c4d99761b379f31729"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets log files list with start dates.  <br /></td></tr>
<tr class="separator:aed5ee3c735f862c4d99761b379f31729"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40159dcd03e82eade9e96fd6b8080e89"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a40159dcd03e82eade9e96fd6b8080e89">GetLogStartDate</a> ($file)</td></tr>
<tr class="memdesc:a40159dcd03e82eade9e96fd6b8080e89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts the datetime of the first line in the log file.  <br /></td></tr>
<tr class="separator:a40159dcd03e82eade9e96fd6b8080e89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab423e07962bdc1319b01c6d7c679f0f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aab423e07962bdc1319b01c6d7c679f0f">_getLogStartDate</a> ($file)</td></tr>
<tr class="separator:aab423e07962bdc1319b01c6d7c679f0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8f9b01c41c50fcef015cc5444236024"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ad8f9b01c41c50fcef015cc5444236024">GetFileFirstLine</a> ($file)</td></tr>
<tr class="memdesc:ad8f9b01c41c50fcef015cc5444236024"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets first line of file.  <br /></td></tr>
<tr class="separator:ad8f9b01c41c50fcef015cc5444236024"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8dbb64d308bdf8cbe3dfee2c84fb9bb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb">ParseLogLine</a> ($logline, &amp;$cols)</td></tr>
<tr class="memdesc:ad8dbb64d308bdf8cbe3dfee2c84fb9bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses the given log line.  <br /></td></tr>
<tr class="separator:ad8dbb64d308bdf8cbe3dfee2c84fb9bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6201c722387cb7120a3447378f73271"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ae6201c722387cb7120a3447378f73271">PostProcessCols</a> (&amp;$cols)</td></tr>
<tr class="memdesc:ae6201c722387cb7120a3447378f73271"><td class="mdescLeft">&#160;</td><td class="mdescRight">Further processes parser output fields.  <br /></td></tr>
<tr class="separator:ae6201c722387cb7120a3447378f73271"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb9609a07caf72ce5cc529f4dcca949f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#afb9609a07caf72ce5cc529f4dcca949f">PrepareFileForDownload</a> ($file)</td></tr>
<tr class="memdesc:afb9609a07caf72ce5cc529f4dcca949f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares file for download over WUI.  <br /></td></tr>
<tr class="separator:afb9609a07caf72ce5cc529f4dcca949f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf44e19a68f4a6be9289e2e39a5698f7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7">GetOrigFileName</a> ($logfile)</td></tr>
<tr class="memdesc:adf44e19a68f4a6be9289e2e39a5698f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the original file name for the given log file.  <br /></td></tr>
<tr class="separator:adf44e19a68f4a6be9289e2e39a5698f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a392e2975b79f55e83ed15c7c6ed8725c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a392e2975b79f55e83ed15c7c6ed8725c">GetProcStatLines</a> ($logfile)</td></tr>
<tr class="memdesc:a392e2975b79f55e83ed15c7c6ed8725c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collects text statistics for the proc stats general page.  <br /></td></tr>
<tr class="separator:a392e2975b79f55e83ed15c7c6ed8725c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cdc13ae8497b92e1c6cbf8b85c6d43c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a5cdc13ae8497b92e1c6cbf8b85c6d43c">CopyLogFileToTmp</a> ($file, $tmpdir)</td></tr>
<tr class="memdesc:a5cdc13ae8497b92e1c6cbf8b85c6d43c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uncompresses gzipped log file to tmp dir.  <br /></td></tr>
<tr class="separator:a5cdc13ae8497b92e1c6cbf8b85c6d43c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad26e67d9a70c2182a67b939ae61b6d01"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ad26e67d9a70c2182a67b939ae61b6d01">GetStatsLogLines</a> ($logfile, $tail=-1)</td></tr>
<tr class="memdesc:ad26e67d9a70c2182a67b939ae61b6d01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds generic grep command and extracts log lines.  <br /></td></tr>
<tr class="separator:ad26e67d9a70c2182a67b939ae61b6d01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f595c1fea08e09a47f744ff8fec6815"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815">GetAllStats</a> ($logfile, $collecthours='')</td></tr>
<tr class="memdesc:a2f595c1fea08e09a47f744ff8fec6815"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets both brief and full statistics.  <br /></td></tr>
<tr class="separator:a2f595c1fea08e09a47f744ff8fec6815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac746ea8beac01d38d9d0289c6c08fe4a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a">GetStats</a> ($logfile, $date, $collecthours='')</td></tr>
<tr class="memdesc:ac746ea8beac01d38d9d0289c6c08fe4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main statistics collector, as module data set.  <br /></td></tr>
<tr class="separator:ac746ea8beac01d38d9d0289c6c08fe4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a879807a0b92e50464699e78d3c216483"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a879807a0b92e50464699e78d3c216483">_getStats</a> ($logfile, $date, $collecthours='')</td></tr>
<tr class="separator:a879807a0b92e50464699e78d3c216483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb379dac54166aba28a4e7e22d0fa772"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772">ValidateFile</a> ($file, $reportFileExistResult=TRUE)</td></tr>
<tr class="memdesc:afb379dac54166aba28a4e7e22d0fa772"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs.  <br /></td></tr>
<tr class="separator:afb379dac54166aba28a4e7e22d0fa772"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab81972f4cb26c1d07ac429589bb4d62d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d">ValidateFileExists</a> ($file, $reportFileExistResult=TRUE)</td></tr>
<tr class="separator:ab81972f4cb26c1d07ac429589bb4d62d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1e8cbbabce3210438cebad028f153d7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ab1e8cbbabce3210438cebad028f153d7">CountDiffLogLines</a> ($logfile, &amp;$count)</td></tr>
<tr class="memdesc:ab1e8cbbabce3210438cebad028f153d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the number of lines added to log files since last tmp file update.  <br /></td></tr>
<tr class="separator:ab1e8cbbabce3210438cebad028f153d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b2587fd477dfc21d60f1185c624521c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c">UpdateStats</a> ($logfile, &amp;$stats, &amp;$briefstats)</td></tr>
<tr class="memdesc:a4b2587fd477dfc21d60f1185c624521c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates statistics incrementally, both brief and full.  <br /></td></tr>
<tr class="separator:a4b2587fd477dfc21d60f1185c624521c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acae82824087b62c41fe805eba381e84c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#acae82824087b62c41fe805eba381e84c">GetDateRegexp</a> ($date)</td></tr>
<tr class="memdesc:acae82824087b62c41fe805eba381e84c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates date regexp to be used by statistics functions.  <br /></td></tr>
<tr class="separator:acae82824087b62c41fe805eba381e84c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1a4adadbacc084431d026315be20390"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ae1a4adadbacc084431d026315be20390">GetHourRegexp</a> ($date)</td></tr>
<tr class="memdesc:ae1a4adadbacc084431d026315be20390"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates hour regexp to be used by statistics functions.  <br /></td></tr>
<tr class="separator:ae1a4adadbacc084431d026315be20390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1149c6f5338677a1a74e8a4964826e80"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a1149c6f5338677a1a74e8a4964826e80">GetSavedStats</a> ($logfile, &amp;$stats, &amp;$briefstats)</td></tr>
<tr class="memdesc:a1149c6f5338677a1a74e8a4964826e80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets saved statistics for the given log file.  <br /></td></tr>
<tr class="separator:a1149c6f5338677a1a74e8a4964826e80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ef1e4c1d1fadd3c6696a101cd2aa7e5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a2ef1e4c1d1fadd3c6696a101cd2aa7e5">GetStatsFileInfo</a> ($logfile, &amp;$linecount, &amp;$filestat)</td></tr>
<tr class="memdesc:a2ef1e4c1d1fadd3c6696a101cd2aa7e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets previous line count and stat() from statistics file.  <br /></td></tr>
<tr class="separator:a2ef1e4c1d1fadd3c6696a101cd2aa7e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae24c34977ae6864272b678fe40fdb09a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ae24c34977ae6864272b678fe40fdb09a">GetStatsFileName</a> ($logfile)</td></tr>
<tr class="memdesc:ae24c34977ae6864272b678fe40fdb09a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets name of the tmp statistics file for the given log file.  <br /></td></tr>
<tr class="separator:ae24c34977ae6864272b678fe40fdb09a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5448888d58c0402bcc575e3a5cd9e9e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ab5448888d58c0402bcc575e3a5cd9e9e">SaveStats</a> ($logfile, $stats, $briefstats, $linecount)</td></tr>
<tr class="memdesc:ab5448888d58c0402bcc575e3a5cd9e9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves collected statistics with the current line count and stat() output.  <br /></td></tr>
<tr class="separator:ab5448888d58c0402bcc575e3a5cd9e9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac23e08bf49a305b2d76f11cecc62ba4c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ac23e08bf49a305b2d76f11cecc62ba4c">CollectDayStats</a> ($statsdefs, $values, $line, &amp;$stats)</td></tr>
<tr class="memdesc:ac23e08bf49a305b2d76f11cecc62ba4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Day statistics collector.  <br /></td></tr>
<tr class="separator:ac23e08bf49a305b2d76f11cecc62ba4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe3e76f34ef7907cc5fcc6d2840bf081"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#abe3e76f34ef7907cc5fcc6d2840bf081">CollectHourStats</a> ($statsdefs, $hour, $min, $values, $line, &amp;$daystats)</td></tr>
<tr class="memdesc:abe3e76f34ef7907cc5fcc6d2840bf081"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hour statistics collector.  <br /></td></tr>
<tr class="separator:abe3e76f34ef7907cc5fcc6d2840bf081"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ffb35c34bab2bd539a5a945a489625"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a10ffb35c34bab2bd539a5a945a489625">IncStats</a> ($line, $values, $statsdefs, &amp;$stats)</td></tr>
<tr class="memdesc:a10ffb35c34bab2bd539a5a945a489625"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increments stats for the given values.  <br /></td></tr>
<tr class="separator:a10ffb35c34bab2bd539a5a945a489625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b4ab5022e1e5883d5292c024eaaf8c1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a3b4ab5022e1e5883d5292c024eaaf8c1">CollectMinuteStats</a> ($statsdefs, $min, $values, $line, &amp;$hourstats)</td></tr>
<tr class="memdesc:a3b4ab5022e1e5883d5292c024eaaf8c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minute statistics collector.  <br /></td></tr>
<tr class="separator:a3b4ab5022e1e5883d5292c024eaaf8c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b5bd25430f02d1925323e19f2861a9e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a7b5bd25430f02d1925323e19f2861a9e">GetConfigValues</a> ($conf, $group)</td></tr>
<tr class="memdesc:a7b5bd25430f02d1925323e19f2861a9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets all configuration for a given configuration type.  <br /></td></tr>
<tr class="separator:a7b5bd25430f02d1925323e19f2861a9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae81727132988d14931750ce5e1c88bd7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ae81727132988d14931750ce5e1c88bd7">GetValue</a> ($name, $conf, $group)</td></tr>
<tr class="memdesc:ae81727132988d14931750ce5e1c88bd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns all enabled configuration for a given configuration type.  <br /></td></tr>
<tr class="separator:ae81727132988d14931750ce5e1c88bd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9aefd70a0fc1481512f149df7a0376aa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a9aefd70a0fc1481512f149df7a0376aa">GetDisabledValue</a> ($name, $conf, $group)</td></tr>
<tr class="memdesc:a9aefd70a0fc1481512f149df7a0376aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns all disabled configuration for a given configuration type.  <br /></td></tr>
<tr class="separator:a9aefd70a0fc1481512f149df7a0376aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25397fad2fa355ebc979d4672a4b2c7e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a25397fad2fa355ebc979d4672a4b2c7e">getValidValues</a> ($name)</td></tr>
<tr class="separator:a25397fad2fa355ebc979d4672a4b2c7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aebe30cc76f4942c0333005444fb00f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a1aebe30cc76f4942c0333005444fb00f">GetDisabledNVP</a> ($file, $name, $set=0, $trimchars='')</td></tr>
<tr class="memdesc:a1aebe30cc76f4942c0333005444fb00f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads value of commented-out NVP.  <br /></td></tr>
<tr class="separator:a1aebe30cc76f4942c0333005444fb00f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6cc2dcb5a8fe07db88766823322be7e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ae6cc2dcb5a8fe07db88766823322be7e">GetName</a> ($file, $name)</td></tr>
<tr class="memdesc:ae6cc2dcb5a8fe07db88766823322be7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if Name exists.  <br /></td></tr>
<tr class="separator:ae6cc2dcb5a8fe07db88766823322be7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a716268fcbfd5197d5055df81c2dbc5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a6a716268fcbfd5197d5055df81c2dbc5">GetDisabledName</a> ($file, $name)</td></tr>
<tr class="memdesc:a6a716268fcbfd5197d5055df81c2dbc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if commented-out Name exists.  <br /></td></tr>
<tr class="separator:a6a716268fcbfd5197d5055df81c2dbc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c5f8b05e5cbfffe696da52ce05f066a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a4c5f8b05e5cbfffe696da52ce05f066a">SetConfValue</a> ($name, $newvalue, $conf, $group)</td></tr>
<tr class="memdesc:a4c5f8b05e5cbfffe696da52ce05f066a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the value of NVP configuration.  <br /></td></tr>
<tr class="separator:a4c5f8b05e5cbfffe696da52ce05f066a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d6c4b92ec14b5133d20ce287ef720ca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a3d6c4b92ec14b5133d20ce287ef720ca">GetConfValueType</a> ($name)</td></tr>
<tr class="separator:a3d6c4b92ec14b5133d20ce287ef720ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6abe8763d4525946e15e0d9784d500b8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a6abe8763d4525946e15e0d9784d500b8">EnableConf</a> ($name, $conf, $group)</td></tr>
<tr class="memdesc:a6abe8763d4525946e15e0d9784d500b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables a configuration item in conf file.  <br /></td></tr>
<tr class="separator:a6abe8763d4525946e15e0d9784d500b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45811aad99c24bbd1afd2c51d6aaac37"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a45811aad99c24bbd1afd2c51d6aaac37">DisableConf</a> ($name, $conf, $group)</td></tr>
<tr class="memdesc:a45811aad99c24bbd1afd2c51d6aaac37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disables a configuration item in conf file.  <br /></td></tr>
<tr class="separator:a45811aad99c24bbd1afd2c51d6aaac37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8a29b93534e66eb054051710d774895"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#af8a29b93534e66eb054051710d774895">EnableNVP</a> ($file, $name, $type)</td></tr>
<tr class="memdesc:af8a29b93534e66eb054051710d774895"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables an NVP configuration item with value.  <br /></td></tr>
<tr class="separator:af8a29b93534e66eb054051710d774895"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65410624e4cac2f3429147c621873382"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a65410624e4cac2f3429147c621873382">EnableName</a> ($file, $name)</td></tr>
<tr class="memdesc:a65410624e4cac2f3429147c621873382"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables a Name: configuration item without value.  <br /></td></tr>
<tr class="separator:a65410624e4cac2f3429147c621873382"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05257350a817e0a8da3dfaa868c623b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a05257350a817e0a8da3dfaa868c623b1">DisableNVP</a> ($file, $name, $type)</td></tr>
<tr class="memdesc:a05257350a817e0a8da3dfaa868c623b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disables an NVP.  <br /></td></tr>
<tr class="separator:a05257350a817e0a8da3dfaa868c623b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a997af94797f7368e6f273a6f9f63d8a8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a997af94797f7368e6f273a6f9f63d8a8">DisableName</a> ($file, $name)</td></tr>
<tr class="memdesc:a997af94797f7368e6f273a6f9f63d8a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disables a Name.  <br /></td></tr>
<tr class="separator:a997af94797f7368e6f273a6f9f63d8a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae08f1955abf4f7b5ca00ec1fec76041f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ae08f1955abf4f7b5ca00ec1fec76041f">GetConfFile</a> ($conf, $group)</td></tr>
<tr class="memdesc:ae08f1955abf4f7b5ca00ec1fec76041f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns configuration file of the module.  <br /></td></tr>
<tr class="separator:ae08f1955abf4f7b5ca00ec1fec76041f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63e6c944f6d63934ee3f05c24bc3e122"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a63e6c944f6d63934ee3f05c24bc3e122">SetConfig</a> ($confname)</td></tr>
<tr class="memdesc:a63e6c944f6d63934ee3f05c24bc3e122"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets configuration file based on config type provided.  <br /></td></tr>
<tr class="separator:a63e6c944f6d63934ee3f05c24bc3e122"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb3147c61c1c08d30c6b360ba839b213"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aeb3147c61c1c08d30c6b360ba839b213">Kill</a> ()</td></tr>
<tr class="memdesc:aeb3147c61c1c08d30c6b360ba839b213"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops module's parent process with its pid.  <br /></td></tr>
<tr class="separator:aeb3147c61c1c08d30c6b360ba839b213"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68390acfc08f9138f4ec2fcc1e18ef7e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a68390acfc08f9138f4ec2fcc1e18ef7e">KillPid</a> ($pid)</td></tr>
<tr class="memdesc:a68390acfc08f9138f4ec2fcc1e18ef7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kills process with the given pid.  <br /></td></tr>
<tr class="separator:a68390acfc08f9138f4ec2fcc1e18ef7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93da2b4fba63c0813e0210b9d61b5ede"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a93da2b4fba63c0813e0210b9d61b5ede">IsModulePidRunning</a> ($pid)</td></tr>
<tr class="memdesc:a93da2b4fba63c0813e0210b9d61b5ede"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the pid is running.  <br /></td></tr>
<tr class="separator:a93da2b4fba63c0813e0210b9d61b5ede"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a300b28f440e32170130534117802e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ac9a300b28f440e32170130534117802e">GetVersion</a> ()</td></tr>
<tr class="memdesc:ac9a300b28f440e32170130534117802e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets software version string.  <br /></td></tr>
<tr class="separator:ac9a300b28f440e32170130534117802e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cf12375d05dca29b3c81333ff1882a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a5cf12375d05dca29b3c81333ff1882a2">GetServiceStatus</a> ($get_info=0, $start='10min', $interval_changed=0)</td></tr>
<tr class="memdesc:a5cf12375d05dca29b3c81333ff1882a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets service statuses.  <br /></td></tr>
<tr class="separator:a5cf12375d05dca29b3c81333ff1882a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3216e14ab593ec9dcc7df09c995d8b1b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a3216e14ab593ec9dcc7df09c995d8b1b">getCachedContents</a> ($filename, &amp;$contents)</td></tr>
<tr class="separator:a3216e14ab593ec9dcc7df09c995d8b1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac74f9ae5abb475786f8f9278af56e953"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ac74f9ae5abb475786f8f9278af56e953">GetModuleStatus</a> ($generate_status)</td></tr>
<tr class="separator:ac74f9ae5abb475786f8f9278af56e953"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b9d9c5affe24f91a3151fa107ee80e4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a5b9d9c5affe24f91a3151fa107ee80e4">_getModuleStatus</a> ($start, $generate_status, $do_cache=1)</td></tr>
<tr class="separator:a5b9d9c5affe24f91a3151fa107ee80e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65ffe7950ba3a608bd8839a16ab88fe5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a65ffe7950ba3a608bd8839a16ab88fe5">_getModuleInfo</a> ($start)</td></tr>
<tr class="separator:a65ffe7950ba3a608bd8839a16ab88fe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75a2cec868b2b3cf1d0f2ae81a799298"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a75a2cec868b2b3cf1d0f2ae81a799298">getFifoLogs</a> ($interval=60)</td></tr>
<tr class="separator:a75a2cec868b2b3cf1d0f2ae81a799298"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fb8ac5678a9e42f00fb66780296bca9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a7fb8ac5678a9e42f00fb66780296bca9">getRrdValue</a> ($rrd, $start=60, &amp;$result, $type='derive')</td></tr>
<tr class="separator:a7fb8ac5678a9e42f00fb66780296bca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a106f3eba1442c7e4cf721764772bc724"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a106f3eba1442c7e4cf721764772bc724">getRrdfetchResolution</a> ($output)</td></tr>
<tr class="separator:a106f3eba1442c7e4cf721764772bc724"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab735f5a4ded9f9c9a5b04f182205fd7d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ab735f5a4ded9f9c9a5b04f182205fd7d">GetStatus</a> ()</td></tr>
<tr class="separator:ab735f5a4ded9f9c9a5b04f182205fd7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b114b525be039c9d40aced2dba528f6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a6b114b525be039c9d40aced2dba528f6">isPrio</a> ($log, $prio)</td></tr>
<tr class="separator:a6b114b525be039c9d40aced2dba528f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afea284b751e524dc9f750e8523be5c95"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#afea284b751e524dc9f750e8523be5c95">GetSysCtl</a> ($option)</td></tr>
<tr class="memdesc:afea284b751e524dc9f750e8523be5c95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets sysctl output for the given arg.  <br /></td></tr>
<tr class="separator:afea284b751e524dc9f750e8523be5c95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e24130261dd255285454c45adc570eb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a5e24130261dd255285454c45adc570eb">_getSysCtl</a> ($option)</td></tr>
<tr class="separator:a5e24130261dd255285454c45adc570eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4eb638f282def52a768efc7dbcbc698"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#af4eb638f282def52a768efc7dbcbc698">ParseSyslogLine</a> ($logline, &amp;$cols)</td></tr>
<tr class="memdesc:af4eb638f282def52a768efc7dbcbc698"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses standard syslog line.  <br /></td></tr>
<tr class="separator:af4eb638f282def52a768efc7dbcbc698"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6ce9b164f907bfe360c2f5dee6d1ab1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ac6ce9b164f907bfe360c2f5dee6d1ab1">GetNewsyslogConfig</a> ($model)</td></tr>
<tr class="memdesc:ac6ce9b164f907bfe360c2f5dee6d1ab1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets newsyslog configuration for log file.  <br /></td></tr>
<tr class="separator:ac6ce9b164f907bfe360c2f5dee6d1ab1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bd903872ce2d86a25252a84248f2e3f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a6bd903872ce2d86a25252a84248f2e3f">SetNewsyslogConfig</a> ($file, $count, $size, $when)</td></tr>
<tr class="memdesc:a6bd903872ce2d86a25252a84248f2e3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets newsyslog configuration for log file.  <br /></td></tr>
<tr class="separator:a6bd903872ce2d86a25252a84248f2e3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a941c3c7c9570b1a241f58024b3cc7963"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a941c3c7c9570b1a241f58024b3cc7963">_getPartitions</a> ()</td></tr>
<tr class="memdesc:a941c3c7c9570b1a241f58024b3cc7963"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns all partitions mounted.  <br /></td></tr>
<tr class="separator:a941c3c7c9570b1a241f58024b3cc7963"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad150b90d723746fef93c906fb8548a9e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ad150b90d723746fef93c906fb8548a9e">GetSensors</a> ()</td></tr>
<tr class="memdesc:ad150b90d723746fef93c906fb8548a9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds sysctl temp and fan sensors.  <br /></td></tr>
<tr class="separator:ad150b90d723746fef93c906fb8548a9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a7fc5c8cb4f856fd6066c4b4f12254321"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a7fc5c8cb4f856fd6066c4b4f12254321">$Nesting</a> = 0</td></tr>
<tr class="memdesc:a7fc5c8cb4f856fd6066c4b4f12254321"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keeps the count of nested anchors in inline rules.  <br /></td></tr>
<tr class="separator:a7fc5c8cb4f856fd6066c4b4f12254321"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90efb261c13e9a3e16ed2b0563dec08d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a90efb261c13e9a3e16ed2b0563dec08d">$Name</a> = ''</td></tr>
<tr class="separator:a90efb261c13e9a3e16ed2b0563dec08d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42126d9267d0d3d37d824eefc58baa42"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a42126d9267d0d3d37d824eefc58baa42">$Proc</a> = ''</td></tr>
<tr class="separator:a42126d9267d0d3d37d824eefc58baa42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77cc6ebf3902e67557ab5de9317a11c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a77cc6ebf3902e67557ab5de9317a11c2">$User</a> = ''</td></tr>
<tr class="separator:a77cc6ebf3902e67557ab5de9317a11c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdf16e6be60850ef6ade179a6018caab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#afdf16e6be60850ef6ade179a6018caab">$StartCmd</a> = ''</td></tr>
<tr class="separator:afdf16e6be60850ef6ade179a6018caab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fadf0af39f87db5dbae30e1e2a80341"><td class="memItemLeft" align="right" valign="top">const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a8fadf0af39f87db5dbae30e1e2a80341">PROC_STAT_TIMEOUT</a> = 30</td></tr>
<tr class="memdesc:a8fadf0af39f87db5dbae30e1e2a80341"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max number of iterations to try while starting or stopping processes.  <br /></td></tr>
<tr class="separator:a8fadf0af39f87db5dbae30e1e2a80341"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13912bdecf95fd51b565bc7100f9e2f6"><td class="memItemLeft" align="right" valign="top">const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a13912bdecf95fd51b565bc7100f9e2f6">PROC_STAT_SLEEP_TIME</a> = 1</td></tr>
<tr class="separator:a13912bdecf95fd51b565bc7100f9e2f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c7b0180201dacbbea3b4959bc257b9c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a9c7b0180201dacbbea3b4959bc257b9c">$Commands</a> = array()</td></tr>
<tr class="memdesc:a9c7b0180201dacbbea3b4959bc257b9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Argument lists and descriptions of commands.  <br /></td></tr>
<tr class="separator:a9c7b0180201dacbbea3b4959bc257b9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a241473971eee4015ff567b0a2ddd69a0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a241473971eee4015ff567b0a2ddd69a0">$NVPS</a> = '='</td></tr>
<tr class="separator:a241473971eee4015ff567b0a2ddd69a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0400b8e33b224a6c59480c6f32e4b261"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a0400b8e33b224a6c59480c6f32e4b261">$COMC</a> = '#'</td></tr>
<tr class="separator:a0400b8e33b224a6c59480c6f32e4b261"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09ce856a444e6c8704d1c5cc9f63e347"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a09ce856a444e6c8704d1c5cc9f63e347">$LogFile</a> = ''</td></tr>
<tr class="separator:a09ce856a444e6c8704d1c5cc9f63e347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8f3243fedb9ea1936571728529a3832"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ac8f3243fedb9ea1936571728529a3832">$TmpLogsDir</a> = ''</td></tr>
<tr class="separator:ac8f3243fedb9ea1936571728529a3832"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a572fc2c1faaac0479dcda390666042"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a8a572fc2c1faaac0479dcda390666042">$PfRulesFile</a> = '/etc/pf.conf'</td></tr>
<tr class="separator:a8a572fc2c1faaac0479dcda390666042"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa03d84f7a8bbfcb5f3ca9cc4e6c91a8c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aa03d84f7a8bbfcb5f3ca9cc4e6c91a8c">$ConfFile</a> = ''</td></tr>
<tr class="separator:aa03d84f7a8bbfcb5f3ca9cc4e6c91a8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2e162a2e94a6861acb555bb17919717"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ac2e162a2e94a6861acb555bb17919717">$Config</a> = ''</td></tr>
<tr class="separator:ac2e162a2e94a6861acb555bb17919717"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69b3b446371042a6cc08124b54c8be8d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a69b3b446371042a6cc08124b54c8be8d">$ReloadCmd</a> = ''</td></tr>
<tr class="separator:a69b3b446371042a6cc08124b54c8be8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecc7046be658ffe343bc3a80a05989d6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aecc7046be658ffe343bc3a80a05989d6">$CmdLogStart</a> = '/usr/bin/head -1 &lt;LF&gt;'</td></tr>
<tr class="separator:aecc7046be658ffe343bc3a80a05989d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3676f8d6824dd8545ac5262a7d839161"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a3676f8d6824dd8545ac5262a7d839161">$VersionCmd</a> = ''</td></tr>
<tr class="separator:a3676f8d6824dd8545ac5262a7d839161"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21d9c74bb030acf2c58fc04a3e2421cb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a21d9c74bb030acf2c58fc04a3e2421cb">$PidFile</a> = ''</td></tr>
<tr class="separator:a21d9c74bb030acf2c58fc04a3e2421cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a6ed5c1b8c0dee6594cb0afd49f0b9750"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a6ed5c1b8c0dee6594cb0afd49f0b9750">$psCmd</a> = '/bin/ps arwwx -o pid,start,%cpu,time,%mem,rss,vsz,stat,pri,nice,tty,user,group,command | /usr/bin/grep -v -e grep | /usr/bin/grep -E &lt;PROC&gt;'</td></tr>
<tr class="separator:a6ed5c1b8c0dee6594cb0afd49f0b9750"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39672e159647946bae12cec464b15b73"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a39672e159647946bae12cec464b15b73">$rcConfLocal</a> = '/etc/rc.conf.local'</td></tr>
<tr class="separator:a39672e159647946bae12cec464b15b73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a386f9a88efbebc72ab5669b927503235"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a386f9a88efbebc72ab5669b927503235">$PFFWDIR</a> = <a class="el" href="defs_8php.html#aa8d15384fc15e1dedc917fe43ebf78e2">PFFWDIR</a></td></tr>
<tr class="memdesc:a386f9a88efbebc72ab5669b927503235"><td class="mdescLeft">&#160;</td><td class="mdescRight">Makes the PFFWDIR define easier to use in functions, without adding a global var.  <br /></td></tr>
<tr class="separator:a386f9a88efbebc72ab5669b927503235"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a506cdea0e774d00e4a4f0fd3006ccde6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a506cdea0e774d00e4a4f0fd3006ccde6">$CollectdName</a> = ''</td></tr>
<tr class="memdesc:a506cdea0e774d00e4a4f0fd3006ccde6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used in collectd rrd and fifo file names.  <br /></td></tr>
<tr class="separator:a506cdea0e774d00e4a4f0fd3006ccde6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a43e9fdce01db0b8d3e2b34b980c241"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a6a43e9fdce01db0b8d3e2b34b980c241">$CollectdRrdFolder</a> = PFFWDIR.'/collectd/rrd/localhost'</td></tr>
<tr class="separator:a6a43e9fdce01db0b8d3e2b34b980c241"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7944f085df794e2c339d32c263672463"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a7944f085df794e2c339d32c263672463">$CollectdFifoFolder</a> = PFFWDIR.'/collectd/fifo'</td></tr>
<tr class="separator:a7944f085df794e2c339d32c263672463"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabdfb1b0a42cc5cc9dee4bab322e4bdc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#aabdfb1b0a42cc5cc9dee4bab322e4bdc">$newSyslogConf</a> = '/etc/newsyslog.conf'</td></tr>
<tr class="separator:aabdfb1b0a42cc5cc9dee4bab322e4bdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16d4a0f2690f73b941741636d93ff962"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a16d4a0f2690f73b941741636d93ff962">$dateTimeFormat</a> = 'M j H:i:s'</td></tr>
<tr class="memdesc:a16d4a0f2690f73b941741636d93ff962"><td class="mdescLeft">&#160;</td><td class="mdescRight">This datetime format is for error logs, not access logs.  <br /></td></tr>
<tr class="separator:a16d4a0f2690f73b941741636d93ff962"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00027">27</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a095c5d389db211932136b53f25f39685" name="a095c5d389db211932136b53f25f39685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a095c5d389db211932136b53f25f39685">&#9670;&#160;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__construct </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000019">Todo:</a></b></dt><dd>Is there any pattern or size for new value, 2nd param? </dd></dl>

<p>Reimplemented in <a class="el" href="classCollectd.html#a095c5d389db211932136b53f25f39685">Collectd</a>, <a class="el" href="classDhcpd.html#a095c5d389db211932136b53f25f39685">Dhcpd</a>, <a class="el" href="classDnsmasq.html#a095c5d389db211932136b53f25f39685">Dnsmasq</a>, <a class="el" href="classDocs.html#a095c5d389db211932136b53f25f39685">Docs</a>, <a class="el" href="classFtpproxy.html#a095c5d389db211932136b53f25f39685">Ftpproxy</a>, <a class="el" href="classHttpd.html#a095c5d389db211932136b53f25f39685">Httpd</a>, <a class="el" href="classOpenssh.html#a095c5d389db211932136b53f25f39685">Openssh</a>, <a class="el" href="classPf.html#a095c5d389db211932136b53f25f39685">Pf</a>, <a class="el" href="classSymon.html#a095c5d389db211932136b53f25f39685">Symon</a>, <a class="el" href="classSymux.html#a095c5d389db211932136b53f25f39685">Symux</a>, <a class="el" href="classSystem.html#a095c5d389db211932136b53f25f39685">System</a>, <a class="el" href="classDhcpd.html#a095c5d389db211932136b53f25f39685">Dhcpd</a>, <a class="el" href="classDnsmasq.html#a095c5d389db211932136b53f25f39685">Dnsmasq</a>, <a class="el" href="classFtpproxy.html#a095c5d389db211932136b53f25f39685">Ftpproxy</a>, <a class="el" href="classCtlrlogs.html#a095c5d389db211932136b53f25f39685">Ctlrlogs</a>, <a class="el" href="classHttpd.html#a095c5d389db211932136b53f25f39685">Httpd</a>, <a class="el" href="classHttpdlogs.html#a095c5d389db211932136b53f25f39685">Httpdlogs</a>, <a class="el" href="classWuilogs.html#a095c5d389db211932136b53f25f39685">Wuilogs</a>, <a class="el" href="classDocs.html#a095c5d389db211932136b53f25f39685">Docs</a>, <a class="el" href="classMonitoring.html#a095c5d389db211932136b53f25f39685">Monitoring</a>, <a class="el" href="classOpenssh.html#a095c5d389db211932136b53f25f39685">Openssh</a>, <a class="el" href="classPf.html#a095c5d389db211932136b53f25f39685">Pf</a>, and <a class="el" href="classSystem.html#a095c5d389db211932136b53f25f39685">System</a>.</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00090">90</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   91</span>    {</div>
<div class="line"><span class="lineno">   92</span>        global <a class="code hl_variable" href="dnsmasq_8php.html#a7791894e7e1929c1d4d6df1961938101">$ModelConfig</a>;</div>
<div class="line"><span class="lineno">   93</span>        </div>
<div class="line"><span class="lineno">   94</span>        $this-&gt;Proc= $this-&gt;Name;</div>
<div class="line"><span class="lineno">   95</span>        $this-&gt;CollectdName= $this-&gt;Name;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>        $this-&gt;TmpLogsDir= <a class="code hl_variable" href="defs_8php.html#aa8d15384fc15e1dedc917fe43ebf78e2">PFFWDIR</a>.<span class="stringliteral">&#39;/logs/&#39;</span>.get_class($this).<span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>        $this-&gt;Config= <a class="code hl_variable" href="dnsmasq_8php.html#a7791894e7e1929c1d4d6df1961938101">$ModelConfig</a>;</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>        $this-&gt;Commands= array_merge(</div>
<div class="line"><span class="lineno">  102</span>            $this-&gt;Commands,</div>
<div class="line"><span class="lineno">  103</span>            array(</div>
<div class="line"><span class="lineno">  104</span>                <span class="stringliteral">&#39;IsRunning&#39;</span> =&gt;  array(</div>
<div class="line"><span class="lineno">  105</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(),</div>
<div class="line"><span class="lineno">  106</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Check if process running&#39;</span>),</div>
<div class="line"><span class="lineno">  107</span>                    ),</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>                <span class="stringliteral">&#39;Start&#39;</span> =&gt;  array(</div>
<div class="line"><span class="lineno">  110</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(),</div>
<div class="line"><span class="lineno">  111</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Start &#39;</span>.get_class($this)),</div>
<div class="line"><span class="lineno">  112</span>                    ),</div>
<div class="line"><span class="lineno">  113</span>                </div>
<div class="line"><span class="lineno">  114</span>                <span class="stringliteral">&#39;Stop&#39;</span>  =&gt;  array(</div>
<div class="line"><span class="lineno">  115</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(),</div>
<div class="line"><span class="lineno">  116</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt; _(<span class="stringliteral">&#39;Stop &#39;</span>.get_class($this)),</div>
<div class="line"><span class="lineno">  117</span>                    ),</div>
<div class="line"><span class="lineno">  118</span>                </div>
<div class="line"><span class="lineno">  119</span>                <span class="stringliteral">&#39;GetProcList&#39;</span>   =&gt;  array(</div>
<div class="line"><span class="lineno">  120</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(),</div>
<div class="line"><span class="lineno">  121</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get process list&#39;</span>),</div>
<div class="line"><span class="lineno">  122</span>                    ),</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>                <span class="stringliteral">&#39;GetIntIf&#39;</span>=&gt;    array(</div>
<div class="line"><span class="lineno">  125</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(),</div>
<div class="line"><span class="lineno">  126</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get int_if&#39;</span>),</div>
<div class="line"><span class="lineno">  127</span>                    ),</div>
<div class="line"><span class="lineno">  128</span>                </div>
<div class="line"><span class="lineno">  129</span>                <span class="stringliteral">&#39;GetExtIf&#39;</span>=&gt;    array(</div>
<div class="line"><span class="lineno">  130</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(),</div>
<div class="line"><span class="lineno">  131</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get ext_if&#39;</span>),</div>
<div class="line"><span class="lineno">  132</span>                    ),</div>
<div class="line"><span class="lineno">  133</span>                </div>
<div class="line"><span class="lineno">  134</span>                <span class="stringliteral">&#39;CreateUser&#39;</span>    =&gt;  array(</div>
<div class="line"><span class="lineno">  135</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a244352f035b82b20b0efa506167fd862">NAME</a>, <a class="code hl_variable" href="Model_2include_8php.html#afaaf058c3f7b1aa11d546a22fa4e06d1">SHA1STR</a>, <a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>),</div>
<div class="line"><span class="lineno">  136</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Create user&#39;</span>),</div>
<div class="line"><span class="lineno">  137</span>                    ),</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>                <span class="stringliteral">&#39;SetPassword&#39;</span>   =&gt;  array(</div>
<div class="line"><span class="lineno">  140</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a244352f035b82b20b0efa506167fd862">NAME</a>, <a class="code hl_variable" href="Model_2include_8php.html#afaaf058c3f7b1aa11d546a22fa4e06d1">SHA1STR</a>),</div>
<div class="line"><span class="lineno">  141</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Set user password&#39;</span>),</div>
<div class="line"><span class="lineno">  142</span>                    ),</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>                <span class="stringliteral">&#39;SetLogLevel&#39;</span>=&gt; array(</div>
<div class="line"><span class="lineno">  145</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a244352f035b82b20b0efa506167fd862">NAME</a>),</div>
<div class="line"><span class="lineno">  146</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Set log level&#39;</span>),</div>
<div class="line"><span class="lineno">  147</span>                    ),</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>                <span class="stringliteral">&#39;SetHelpBox&#39;</span>=&gt;  array(</div>
<div class="line"><span class="lineno">  150</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a244352f035b82b20b0efa506167fd862">NAME</a>),</div>
<div class="line"><span class="lineno">  151</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Set help boxes&#39;</span>),</div>
<div class="line"><span class="lineno">  152</span>                    ),</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>                <span class="stringliteral">&#39;SetSessionTimeout&#39;</span>=&gt;   array(</div>
<div class="line"><span class="lineno">  155</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>),</div>
<div class="line"><span class="lineno">  156</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Set session timeout&#39;</span>),</div>
<div class="line"><span class="lineno">  157</span>                    ),</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>                <span class="stringliteral">&#39;SetDefaultLocale&#39;</span>=&gt;    array(</div>
<div class="line"><span class="lineno">  160</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a244352f035b82b20b0efa506167fd862">NAME</a>),</div>
<div class="line"><span class="lineno">  161</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Set default locale&#39;</span>),</div>
<div class="line"><span class="lineno">  162</span>                    ),</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>                <span class="stringliteral">&#39;SetForceHTTPs&#39;</span>=&gt;   array(</div>
<div class="line"><span class="lineno">  165</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a244352f035b82b20b0efa506167fd862">NAME</a>),</div>
<div class="line"><span class="lineno">  166</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Set force HTTPs&#39;</span>),</div>
<div class="line"><span class="lineno">  167</span>                    ),</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>                <span class="stringliteral">&#39;SetUseSSH&#39;</span>=&gt;   array(</div>
<div class="line"><span class="lineno">  170</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a244352f035b82b20b0efa506167fd862">NAME</a>),</div>
<div class="line"><span class="lineno">  171</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Set use SSH&#39;</span>),</div>
<div class="line"><span class="lineno">  172</span>                    ),</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>                <span class="stringliteral">&#39;SetMaxAnchorNesting&#39;</span>=&gt; array(</div>
<div class="line"><span class="lineno">  175</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>),</div>
<div class="line"><span class="lineno">  176</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Set max anchor nesting&#39;</span>),</div>
<div class="line"><span class="lineno">  177</span>                    ),</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>                <span class="stringliteral">&#39;SetPfctlTimeout&#39;</span>=&gt; array(</div>
<div class="line"><span class="lineno">  180</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>),</div>
<div class="line"><span class="lineno">  181</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Set pfctl timeout&#39;</span>),</div>
<div class="line"><span class="lineno">  182</span>                    ),</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>                <span class="stringliteral">&#39;SetStatusCheckInterval&#39;</span>=&gt;  array(</div>
<div class="line"><span class="lineno">  185</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>),</div>
<div class="line"><span class="lineno">  186</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Set status check interval&#39;</span>),</div>
<div class="line"><span class="lineno">  187</span>                    ),</div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>                <span class="stringliteral">&#39;SetMaxFileSizeToProcess&#39;</span>=&gt; array(</div>
<div class="line"><span class="lineno">  190</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>),</div>
<div class="line"><span class="lineno">  191</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Set max file size to process&#39;</span>),</div>
<div class="line"><span class="lineno">  192</span>                    ),</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>                <span class="stringliteral">&#39;GetReloadRate&#39;</span>=&gt;   array(</div>
<div class="line"><span class="lineno">  195</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(),</div>
<div class="line"><span class="lineno">  196</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get reload rate&#39;</span>),</div>
<div class="line"><span class="lineno">  197</span>                    ),</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>                <span class="stringliteral">&#39;SetReloadRate&#39;</span>=&gt;   array(</div>
<div class="line"><span class="lineno">  200</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>),</div>
<div class="line"><span class="lineno">  201</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Set reload rate&#39;</span>),</div>
<div class="line"><span class="lineno">  202</span>                    ),</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>                <span class="stringliteral">&#39;GetDateTime&#39;</span>   =&gt;  array(</div>
<div class="line"><span class="lineno">  205</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(),</div>
<div class="line"><span class="lineno">  206</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get datetime&#39;</span>),</div>
<div class="line"><span class="lineno">  207</span>                    ),</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>                <span class="stringliteral">&#39;GetPhyIfs&#39;</span>     =&gt;  array(</div>
<div class="line"><span class="lineno">  210</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(),</div>
<div class="line"><span class="lineno">  211</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;List physical interfaces&#39;</span>),</div>
<div class="line"><span class="lineno">  212</span>                    ),</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>                <span class="stringliteral">&#39;GetDefaultLogFile&#39;</span> =&gt;  array(</div>
<div class="line"><span class="lineno">  215</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(),</div>
<div class="line"><span class="lineno">  216</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get log file&#39;</span>),</div>
<div class="line"><span class="lineno">  217</span>                    ),</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>                <span class="stringliteral">&#39;SelectLogFile&#39;</span> =&gt;  array(</div>
<div class="line"><span class="lineno">  220</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a471bd5fa39fc99207c458ec196d5652f">FILEPATH</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>),</div>
<div class="line"><span class="lineno">  221</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Select log file&#39;</span>),</div>
<div class="line"><span class="lineno">  222</span>                    ),</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>                <span class="stringliteral">&#39;GetLogFilesList&#39;</span>   =&gt;  array(</div>
<div class="line"><span class="lineno">  225</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(),</div>
<div class="line"><span class="lineno">  226</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get log files list&#39;</span>),</div>
<div class="line"><span class="lineno">  227</span>                    ),</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>                <span class="stringliteral">&#39;GetLogStartDate&#39;</span>   =&gt;  array(</div>
<div class="line"><span class="lineno">  230</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a471bd5fa39fc99207c458ec196d5652f">FILEPATH</a>),</div>
<div class="line"><span class="lineno">  231</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get log start date&#39;</span>),</div>
<div class="line"><span class="lineno">  232</span>                    ),</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>                <span class="stringliteral">&#39;GetFileLineCount&#39;</span>  =&gt;  array(</div>
<div class="line"><span class="lineno">  235</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a471bd5fa39fc99207c458ec196d5652f">FILEPATH</a>, <a class="code hl_variable" href="Model_2include_8php.html#af0db0413348d2bf97376cfcda96c900a">REGEXP</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>, <a class="code hl_variable" href="Model_2include_8php.html#af0db0413348d2bf97376cfcda96c900a">REGEXP</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>, <a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>, <a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>, <a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>, <a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>),</div>
<div class="line"><span class="lineno">  236</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get line count&#39;</span>),</div>
<div class="line"><span class="lineno">  237</span>                    ),</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>                <span class="stringliteral">&#39;GetLogs&#39;</span>   =&gt;  array(</div>
<div class="line"><span class="lineno">  240</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a471bd5fa39fc99207c458ec196d5652f">FILEPATH</a>, <a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>, <a class="code hl_variable" href="Model_2include_8php.html#a817b3018df80ccaa9d4e8094a0b50498">TAIL</a>, <a class="code hl_variable" href="Model_2include_8php.html#af0db0413348d2bf97376cfcda96c900a">REGEXP</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>, <a class="code hl_variable" href="Model_2include_8php.html#af0db0413348d2bf97376cfcda96c900a">REGEXP</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>, <a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>, <a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>, <a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>, <a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>),</div>
<div class="line"><span class="lineno">  241</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get lines&#39;</span>),</div>
<div class="line"><span class="lineno">  242</span>                    ),</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>                <span class="stringliteral">&#39;GetLiveLogs&#39;</span>   =&gt;  array(</div>
<div class="line"><span class="lineno">  245</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a471bd5fa39fc99207c458ec196d5652f">FILEPATH</a>, <a class="code hl_variable" href="Model_2include_8php.html#a817b3018df80ccaa9d4e8094a0b50498">TAIL</a>, <a class="code hl_variable" href="Model_2include_8php.html#af0db0413348d2bf97376cfcda96c900a">REGEXP</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>),</div>
<div class="line"><span class="lineno">  246</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get tail&#39;</span>),</div>
<div class="line"><span class="lineno">  247</span>                    ),</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>                <span class="stringliteral">&#39;GetLastLogs&#39;</span>   =&gt;  array(</div>
<div class="line"><span class="lineno">  250</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a471bd5fa39fc99207c458ec196d5652f">FILEPATH</a>, <a class="code hl_variable" href="Model_2include_8php.html#a817b3018df80ccaa9d4e8094a0b50498">TAIL</a>),</div>
<div class="line"><span class="lineno">  251</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get last logs&#39;</span>),</div>
<div class="line"><span class="lineno">  252</span>                    ),</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>                <span class="stringliteral">&#39;GetAllStats&#39;</span>=&gt; array(</div>
<div class="line"><span class="lineno">  255</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a471bd5fa39fc99207c458ec196d5652f">FILEPATH</a>, <a class="code hl_variable" href="Model_2include_8php.html#a244352f035b82b20b0efa506167fd862">NAME</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>),</div>
<div class="line"><span class="lineno">  256</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get all stats&#39;</span>),</div>
<div class="line"><span class="lineno">  257</span>                    ),</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>                <span class="stringliteral">&#39;GetStats&#39;</span>=&gt;    array(</div>
<div class="line"><span class="lineno">  260</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a471bd5fa39fc99207c458ec196d5652f">FILEPATH</a>, <a class="code hl_variable" href="Model_2include_8php.html#a594b291ab7d855c5e91f47718577399a">SERIALARRAY</a>, <a class="code hl_variable" href="Model_2include_8php.html#a244352f035b82b20b0efa506167fd862">NAME</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>),</div>
<div class="line"><span class="lineno">  261</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get stats&#39;</span>),</div>
<div class="line"><span class="lineno">  262</span>                    ),</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>                <span class="stringliteral">&#39;GetProcStatLines&#39;</span>  =&gt;  array(</div>
<div class="line"><span class="lineno">  265</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a471bd5fa39fc99207c458ec196d5652f">FILEPATH</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>),</div>
<div class="line"><span class="lineno">  266</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get stat lines&#39;</span>),</div>
<div class="line"><span class="lineno">  267</span>                    ),</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>                <span class="stringliteral">&#39;PrepareFileForDownload&#39;</span>    =&gt;  array(</div>
<div class="line"><span class="lineno">  270</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a471bd5fa39fc99207c458ec196d5652f">FILEPATH</a>),</div>
<div class="line"><span class="lineno">  271</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Prepare file for download&#39;</span>),</div>
<div class="line"><span class="lineno">  272</span>                    ),</div>
<div class="line"><span class="lineno">  273</span>                </div>
<div class="line"><span class="lineno">  274</span>                <span class="stringliteral">&#39;GetVersion&#39;</span>    =&gt;  array(</div>
<div class="line"><span class="lineno">  275</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(),</div>
<div class="line"><span class="lineno">  276</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get software version&#39;</span>),</div>
<div class="line"><span class="lineno">  277</span>                    ),</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>                <span class="stringliteral">&#39;GetServiceStatus&#39;</span>  =&gt;  array(</div>
<div class="line"><span class="lineno">  280</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a24a65e5ca0a321531cace9880fd48187">BOOL</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>, <a class="code hl_variable" href="Model_2include_8php.html#a15dbbd62538f544f880c9db8eb37503b">STR</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>, <a class="code hl_variable" href="Model_2include_8php.html#a24a65e5ca0a321531cace9880fd48187">BOOL</a>|<a class="code hl_variable" href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a>),</div>
<div class="line"><span class="lineno">  281</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get service status&#39;</span>),</div>
<div class="line"><span class="lineno">  282</span>                    ),</div>
<div class="line"><span class="lineno">  283</span>                </div>
<div class="line"><span class="lineno">  284</span>                <span class="stringliteral">&#39;GetModuleStatus&#39;</span>   =&gt;  array(</div>
<div class="line"><span class="lineno">  285</span>                    <span class="comment">// Trailing comma to avoid syntax error</span></div>
<div class="line"><span class="lineno">  286</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a24a65e5ca0a321531cace9880fd48187">BOOL</a>,),</div>
<div class="line"><span class="lineno">  287</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get module status&#39;</span>),</div>
<div class="line"><span class="lineno">  288</span>                    ),</div>
<div class="line"><span class="lineno">  289</span>                </div>
<div class="line"><span class="lineno">  290</span>                <span class="stringliteral">&#39;GetSysCtl&#39;</span> =&gt;  array(</div>
<div class="line"><span class="lineno">  291</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a244352f035b82b20b0efa506167fd862">NAME</a>),</div>
<div class="line"><span class="lineno">  292</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get sysctl values&#39;</span>),</div>
<div class="line"><span class="lineno">  293</span>                    ),</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>                <span class="stringliteral">&#39;GetConfigValues&#39;</span>   =&gt;  array(</div>
<div class="line"><span class="lineno">  296</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a244352f035b82b20b0efa506167fd862">NAME</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>, <a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>),</div>
<div class="line"><span class="lineno">  297</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get config values&#39;</span>),</div>
<div class="line"><span class="lineno">  298</span>                    ),</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>                <span class="stringliteral">&#39;SetConfValue&#39;</span>  =&gt;  array(</div>
<div class="line"><span class="lineno">  302</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a69a76b3c3133c65b74aa23fca3ed4c14">CONFNAME</a>, <a class="code hl_variable" href="Model_2include_8php.html#a15dbbd62538f544f880c9db8eb37503b">STR</a>, <a class="code hl_variable" href="Model_2include_8php.html#a244352f035b82b20b0efa506167fd862">NAME</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>, <a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>),</div>
<div class="line"><span class="lineno">  303</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Set name value pair&#39;</span>),</div>
<div class="line"><span class="lineno">  304</span>                    ),</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>                <span class="stringliteral">&#39;EnableConf&#39;</span>    =&gt;  array(</div>
<div class="line"><span class="lineno">  307</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a69a76b3c3133c65b74aa23fca3ed4c14">CONFNAME</a>, <a class="code hl_variable" href="Model_2include_8php.html#a244352f035b82b20b0efa506167fd862">NAME</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>, <a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>),</div>
<div class="line"><span class="lineno">  308</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Enable config&#39;</span>),</div>
<div class="line"><span class="lineno">  309</span>                    ),</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>                <span class="stringliteral">&#39;DisableConf&#39;</span>   =&gt;  array(</div>
<div class="line"><span class="lineno">  312</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(<a class="code hl_variable" href="Model_2include_8php.html#a69a76b3c3133c65b74aa23fca3ed4c14">CONFNAME</a>, <a class="code hl_variable" href="Model_2include_8php.html#a244352f035b82b20b0efa506167fd862">NAME</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>, <a class="code hl_variable" href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a>|<a class="code hl_variable" href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a>),</div>
<div class="line"><span class="lineno">  313</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Disable config&#39;</span>),</div>
<div class="line"><span class="lineno">  314</span>                    ),</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>                <span class="stringliteral">&#39;GetStatus&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  317</span>                    <span class="stringliteral">&#39;argv&#39;</span>  =&gt;  array(),</div>
<div class="line"><span class="lineno">  318</span>                    <span class="stringliteral">&#39;desc&#39;</span>  =&gt;  _(<span class="stringliteral">&#39;Get critical errors&#39;</span>),</div>
<div class="line"><span class="lineno">  319</span>                    ),</div>
<div class="line"><span class="lineno">  320</span>                )</div>
<div class="line"><span class="lineno">  321</span>            );</div>
<div class="line"><span class="lineno">  322</span>    }</div>
<div class="ttc" id="aModel_2include_8php_html_a15dbbd62538f544f880c9db8eb37503b"><div class="ttname"><a href="Model_2include_8php.html#a15dbbd62538f544f880c9db8eb37503b">STR</a></div><div class="ttdeci">const STR</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00080">include.php:80</a></div></div>
<div class="ttc" id="aModel_2include_8php_html_a244352f035b82b20b0efa506167fd862"><div class="ttname"><a href="Model_2include_8php.html#a244352f035b82b20b0efa506167fd862">NAME</a></div><div class="ttdeci">const NAME</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00070">include.php:70</a></div></div>
<div class="ttc" id="aModel_2include_8php_html_a24a65e5ca0a321531cace9880fd48187"><div class="ttname"><a href="Model_2include_8php.html#a24a65e5ca0a321531cace9880fd48187">BOOL</a></div><div class="ttdeci">const BOOL</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00073">include.php:73</a></div></div>
<div class="ttc" id="aModel_2include_8php_html_a4370fe0320239a94428e9ee2edb9b5a4"><div class="ttname"><a href="Model_2include_8php.html#a4370fe0320239a94428e9ee2edb9b5a4">EMPTYSTR</a></div><div class="ttdeci">const EMPTYSTR</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00076">include.php:76</a></div></div>
<div class="ttc" id="aModel_2include_8php_html_a471bd5fa39fc99207c458ec196d5652f"><div class="ttname"><a href="Model_2include_8php.html#a471bd5fa39fc99207c458ec196d5652f">FILEPATH</a></div><div class="ttdeci">const FILEPATH</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00069">include.php:69</a></div></div>
<div class="ttc" id="aModel_2include_8php_html_a594b291ab7d855c5e91f47718577399a"><div class="ttname"><a href="Model_2include_8php.html#a594b291ab7d855c5e91f47718577399a">SERIALARRAY</a></div><div class="ttdeci">const SERIALARRAY</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00078">include.php:78</a></div></div>
<div class="ttc" id="aModel_2include_8php_html_a69a76b3c3133c65b74aa23fca3ed4c14"><div class="ttname"><a href="Model_2include_8php.html#a69a76b3c3133c65b74aa23fca3ed4c14">CONFNAME</a></div><div class="ttdeci">const CONFNAME</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00089">include.php:89</a></div></div>
<div class="ttc" id="aModel_2include_8php_html_a817b3018df80ccaa9d4e8094a0b50498"><div class="ttname"><a href="Model_2include_8php.html#a817b3018df80ccaa9d4e8094a0b50498">TAIL</a></div><div class="ttdeci">const TAIL</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00087">include.php:87</a></div></div>
<div class="ttc" id="aModel_2include_8php_html_ac62f1cfad2f7d0988d46057bf55d1e80"><div class="ttname"><a href="Model_2include_8php.html#ac62f1cfad2f7d0988d46057bf55d1e80">NONE</a></div><div class="ttdeci">const NONE</div><div class="ttdoc">Shell command argument types.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00068">include.php:68</a></div></div>
<div class="ttc" id="aModel_2include_8php_html_ae7841227444af4fba3ee5824df8a2387"><div class="ttname"><a href="Model_2include_8php.html#ae7841227444af4fba3ee5824df8a2387">NUM</a></div><div class="ttdeci">const NUM</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00071">include.php:71</a></div></div>
<div class="ttc" id="aModel_2include_8php_html_af0db0413348d2bf97376cfcda96c900a"><div class="ttname"><a href="Model_2include_8php.html#af0db0413348d2bf97376cfcda96c900a">REGEXP</a></div><div class="ttdeci">const REGEXP</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00077">include.php:77</a></div></div>
<div class="ttc" id="aModel_2include_8php_html_afaaf058c3f7b1aa11d546a22fa4e06d1"><div class="ttname"><a href="Model_2include_8php.html#afaaf058c3f7b1aa11d546a22fa4e06d1">SHA1STR</a></div><div class="ttdeci">const SHA1STR</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00072">include.php:72</a></div></div>
<div class="ttc" id="adefs_8php_html_aa8d15384fc15e1dedc917fe43ebf78e2"><div class="ttname"><a href="defs_8php.html#aa8d15384fc15e1dedc917fe43ebf78e2">PFFWDIR</a></div><div class="ttdeci">const PFFWDIR</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00034">defs.php:34</a></div></div>
<div class="ttc" id="adnsmasq_8php_html_a7791894e7e1929c1d4d6df1961938101"><div class="ttname"><a href="dnsmasq_8php.html#a7791894e7e1929c1d4d6df1961938101">$ModelConfig</a></div><div class="ttdeci">$ModelConfig</div><div class="ttdef"><b>Definition:</b> <a href="dnsmasq_8php_source.html#l00123">dnsmasq.php:123</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="dnsmasq_8php_source.html#l00123">$ModelConfig</a>, <a class="el" href="Model_2include_8php_source.html#l00073">BOOL</a>, <a class="el" href="Model_2include_8php_source.html#l00089">CONFNAME</a>, <a class="el" href="Model_2include_8php_source.html#l00076">EMPTYSTR</a>, <a class="el" href="Model_2include_8php_source.html#l00069">FILEPATH</a>, <a class="el" href="Model_2include_8php_source.html#l00070">NAME</a>, <a class="el" href="Model_2include_8php_source.html#l00068">NONE</a>, <a class="el" href="Model_2include_8php_source.html#l00071">NUM</a>, <a class="el" href="defs_8php_source.html#l00034">PFFWDIR</a>, <a class="el" href="Model_2include_8php_source.html#l00077">REGEXP</a>, <a class="el" href="Model_2include_8php_source.html#l00078">SERIALARRAY</a>, <a class="el" href="Model_2include_8php_source.html#l00072">SHA1STR</a>, <a class="el" href="Model_2include_8php_source.html#l00080">STR</a>, and <a class="el" href="Model_2include_8php_source.html#l00087">TAIL</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aa572c51a6d4aa52ec3029518451a05fe" name="aa572c51a6d4aa52ec3029518451a05fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa572c51a6d4aa52ec3029518451a05fe">&#9670;&#160;</a></span>_getExtIf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getExtIf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00515">515</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  516</span>    {</div>
<div class="line"><span class="lineno">  517</span>        <span class="keywordflow">return</span> $this-&gt;GetNVP($this-&gt;PfRulesFile, <span class="stringliteral">&#39;ext_if&#39;</span>);</div>
<div class="line"><span class="lineno">  518</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00915">GetNVP()</a>.</p>

<p class="reference">Referenced by <a class="el" href="Model_2system_8php_source.html#l00621">System\GetConfig()</a>, <a class="el" href="model_8php_source.html#l00510">GetExtIf()</a>, <a class="el" href="model_8php_source.html#l02683">GetServiceStatus()</a>, and <a class="el" href="Model_2system_8php_source.html#l01051">System\NetStart()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aa572c51a6d4aa52ec3029518451a05fe_cgraph.png" border="0" usemap="#aclassModel_aa572c51a6d4aa52ec3029518451a05fe_cgraph" alt=""/></div>
<map name="aclassModel_aa572c51a6d4aa52ec3029518451a05fe_cgraph" id="aclassModel_aa572c51a6d4aa52ec3029518451a05fe_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,85,31"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="133,5,205,31"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="253,5,343,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aa572c51a6d4aa52ec3029518451a05fe_icgraph.png" border="0" usemap="#aclassModel_aa572c51a6d4aa52ec3029518451a05fe_icgraph" alt=""/></div>
<map name="aclassModel_aa572c51a6d4aa52ec3029518451a05fe_icgraph" id="aclassModel_aa572c51a6d4aa52ec3029518451a05fe_icgraph">
<area shape="rect" title=" " alt="" coords="192,80,272,105"/>
<area shape="rect" href="classSystem.html#a6baa62a81a32e122dde71ac97c46fe9a" title="Reads hostname, gateway, and interface configuration." alt="" coords="5,5,144,31"/>
<area shape="rect" href="classModel.html#a190806315bf8a8147417f3735ba66bc5" title="Get ext_if." alt="" coords="37,55,112,80"/>
<area shape="rect" href="classModel.html#a5cf12375d05dca29b3c81333ff1882a2" title="Gets service statuses." alt="" coords="7,104,142,129"/>
<area shape="rect" href="classSystem.html#a6c0c91116842cbcd97f4311fea0acc8c" title="Restarts the network." alt="" coords="10,153,139,179"/>
</map>
</div>

</div>
</div>
<a id="aec3d644e69b54bae382fe3aa894c0879" name="aec3d644e69b54bae382fe3aa894c0879"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec3d644e69b54bae382fe3aa894c0879">&#9670;&#160;</a></span>_getFileLineCount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getFileLineCount </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$re</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$needle</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$month</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$day</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$hour</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$minute</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section warning"><dt>Warning</dt><dd>Input redirection is necessary, otherwise wc adds file name to its output too</dd></dl>

<p>Reimplemented in <a class="el" href="classOpenssh.html#aec3d644e69b54bae382fe3aa894c0879">Openssh</a>, and <a class="el" href="classPf.html#aec3d644e69b54bae382fe3aa894c0879">Pf</a>.</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01279">1279</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1280</span>    {</div>
<div class="line"><span class="lineno"> 1281</span>        <span class="keywordflow">if</span> (!$this-&gt;ValidateFile($file)) {</div>
<div class="line"><span class="lineno"> 1282</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1283</span>        }</div>
<div class="line"><span class="lineno"> 1284</span> </div>
<div class="line"><span class="lineno"> 1285</span>        <span class="keywordflow">if</span> ($re == <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $needle == <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $month == <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $day == <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $hour == <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $minute == <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1287</span>            $cmd= <span class="stringliteral">&quot;/usr/bin/wc -l &lt; $file&quot;</span>;</div>
<div class="line"><span class="lineno"> 1288</span>        }</div>
<div class="line"><span class="lineno"> 1289</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1290</span>            <span class="comment">// Skip for speed, otherwise we could use datetime regexp for empty strings too</span></div>
<div class="line"><span class="lineno"> 1291</span>            <span class="keywordflow">if</span> ($month == <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $day == <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $hour == <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $minute == <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1292</span>                $re= escapeshellarg($re);</div>
<div class="line"><span class="lineno"> 1293</span>                <span class="keywordflow">if</span> ($needle == <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1294</span>                    $cmd= <span class="stringliteral">&quot;/usr/bin/grep -a -E $re $file&quot;</span>;</div>
<div class="line"><span class="lineno"> 1295</span>                }</div>
<div class="line"><span class="lineno"> 1296</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1297</span>                    $needle= escapeshellarg($needle);</div>
<div class="line"><span class="lineno"> 1298</span>                    $cmd= <span class="stringliteral">&quot;/usr/bin/grep -a -E $needle $file | /usr/bin/grep -a -E $re&quot;</span>;</div>
<div class="line"><span class="lineno"> 1299</span>                }</div>
<div class="line"><span class="lineno"> 1300</span>            }</div>
<div class="line"><span class="lineno"> 1301</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1302</span>                $cmd= <span class="stringliteral">&#39;/usr/bin/grep -a -E &quot;&#39;</span> . $this-&gt;<a class="code hl_function" href="classModel.html#a3827d539c75623fd5345ab590caaa2cb">formatDateHourRegexp</a>($month, $day, $hour, $minute) . <span class="stringliteral">&#39;&quot; &#39;</span> . $file;</div>
<div class="line"><span class="lineno"> 1303</span> </div>
<div class="line"><span class="lineno"> 1304</span>                $re= escapeshellarg($re);</div>
<div class="line"><span class="lineno"> 1305</span>                <span class="keywordflow">if</span> ($needle == <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1306</span>                    $cmd.= <span class="stringliteral">&quot; | /usr/bin/grep -a -E $re&quot;</span>;</div>
<div class="line"><span class="lineno"> 1307</span>                }</div>
<div class="line"><span class="lineno"> 1308</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1309</span>                    $needle= escapeshellarg($needle);</div>
<div class="line"><span class="lineno"> 1310</span>                    $cmd.= <span class="stringliteral">&quot; | /usr/bin/grep -a -E $needle | /usr/bin/grep -a -E $re&quot;</span>;</div>
<div class="line"><span class="lineno"> 1311</span>                }</div>
<div class="line"><span class="lineno"> 1312</span>            }</div>
<div class="line"><span class="lineno"> 1313</span> </div>
<div class="line"><span class="lineno"> 1314</span>            $cmd.= <span class="stringliteral">&#39; | /usr/bin/wc -l&#39;</span>;</div>
<div class="line"><span class="lineno"> 1315</span>        }</div>
<div class="line"><span class="lineno"> 1316</span> </div>
<div class="line"><span class="lineno"> 1317</span>        <span class="comment">// OpenBSD wc returns with leading blanks</span></div>
<div class="line"><span class="lineno"> 1318</span>        <span class="keywordflow">return</span> trim($this-&gt;<a class="code hl_function" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8">RunShellCommand</a>($cmd));</div>
<div class="line"><span class="lineno"> 1319</span>    }</div>
<div class="ttc" id="aclassModel_html_a3827d539c75623fd5345ab590caaa2cb"><div class="ttname"><a href="classModel.html#a3827d539c75623fd5345ab590caaa2cb">Model\formatDateHourRegexp</a></div><div class="ttdeci">formatDateHourRegexp($month, $day, $hour, $minute)</div><div class="ttdoc">Generates the module specific datetime regexp for filtering logs.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l01164">model.php:1164</a></div></div>
<div class="ttc" id="aclassModel_html_a9b098af2c181aba08669ccbc185af5d8"><div class="ttname"><a href="classModel.html#a9b098af2c181aba08669ccbc185af5d8">Model\RunShellCommand</a></div><div class="ttdeci">RunShellCommand($cmd)</div><div class="ttdoc">Runs the given shell command and returns its output as string.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l00791">model.php:791</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l01164">formatDateHourRegexp()</a>, <a class="el" href="model_8php_source.html#l00791">RunShellCommand()</a>, and <a class="el" href="model_8php_source.html#l01838">ValidateFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01873">CountDiffLogLines()</a>, <a class="el" href="model_8php_source.html#l01274">GetFileLineCount()</a>, and <a class="el" href="model_8php_source.html#l01919">UpdateStats()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aec3d644e69b54bae382fe3aa894c0879_cgraph.png" border="0" usemap="#aclassModel_aec3d644e69b54bae382fe3aa894c0879_cgraph" alt=""/></div>
<map name="aclassModel_aec3d644e69b54bae382fe3aa894c0879_cgraph" id="aclassModel_aec3d644e69b54bae382fe3aa894c0879_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,144,80"/>
<area shape="rect" href="classModel.html#a3827d539c75623fd5345ab590caaa2cb" title="Generates the module specific datetime regexp for filtering logs." alt="" coords="192,5,369,31"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="207,55,354,80"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="231,104,330,129"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="603,104,656,129"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="417,129,555,155"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aec3d644e69b54bae382fe3aa894c0879_icgraph.png" border="0" usemap="#aclassModel_aec3d644e69b54bae382fe3aa894c0879_icgraph" alt=""/></div>
<map name="aclassModel_aec3d644e69b54bae382fe3aa894c0879_icgraph" id="aclassModel_aec3d644e69b54bae382fe3aa894c0879_icgraph">
<area shape="rect" title=" " alt="" coords="643,80,781,105"/>
<area shape="rect" href="classModel.html#ab1e8cbbabce3210438cebad028f153d7" title="Gets the number of lines added to log files since last tmp file update." alt="" coords="455,29,595,55"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="304,55,407,80"/>
<area shape="rect" href="classModel.html#aeea778b449fceb9e5e77cc98440ac4bd" title="Gets line count of the given log file." alt="" coords="458,131,591,156"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,29,243,55"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,79,256,104"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="a7abfd365d79fd5b34b3aab5d4ff0c770" name="a7abfd365d79fd5b34b3aab5d4ff0c770"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7abfd365d79fd5b34b3aab5d4ff0c770">&#9670;&#160;</a></span>_getIntIf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getIntIf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00500">500</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  501</span>    {</div>
<div class="line"><span class="lineno">  502</span>        <span class="keywordflow">return</span> $this-&gt;GetNVP($this-&gt;PfRulesFile, <span class="stringliteral">&#39;int_if&#39;</span>);</div>
<div class="line"><span class="lineno">  503</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00915">GetNVP()</a>.</p>

<p class="reference">Referenced by <a class="el" href="Model_2system_8php_source.html#l00621">System\GetConfig()</a>, <a class="el" href="model_8php_source.html#l00495">GetIntIf()</a>, <a class="el" href="model_8php_source.html#l02683">GetServiceStatus()</a>, and <a class="el" href="Model_2system_8php_source.html#l01051">System\NetStart()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a7abfd365d79fd5b34b3aab5d4ff0c770_cgraph.png" border="0" usemap="#aclassModel_a7abfd365d79fd5b34b3aab5d4ff0c770_cgraph" alt=""/></div>
<map name="aclassModel_a7abfd365d79fd5b34b3aab5d4ff0c770_cgraph" id="aclassModel_a7abfd365d79fd5b34b3aab5d4ff0c770_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,81,31"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="129,5,201,31"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="249,5,339,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a7abfd365d79fd5b34b3aab5d4ff0c770_icgraph.png" border="0" usemap="#aclassModel_a7abfd365d79fd5b34b3aab5d4ff0c770_icgraph" alt=""/></div>
<map name="aclassModel_a7abfd365d79fd5b34b3aab5d4ff0c770_icgraph" id="aclassModel_a7abfd365d79fd5b34b3aab5d4ff0c770_icgraph">
<area shape="rect" title=" " alt="" coords="192,80,268,105"/>
<area shape="rect" href="classSystem.html#a6baa62a81a32e122dde71ac97c46fe9a" title="Reads hostname, gateway, and interface configuration." alt="" coords="5,5,144,31"/>
<area shape="rect" href="classModel.html#a14573cc2fd34870091dfe7e8aa1ab171" title="Get int_if." alt="" coords="39,55,110,80"/>
<area shape="rect" href="classModel.html#a5cf12375d05dca29b3c81333ff1882a2" title="Gets service statuses." alt="" coords="7,104,142,129"/>
<area shape="rect" href="classSystem.html#a6c0c91116842cbcd97f4311fea0acc8c" title="Restarts the network." alt="" coords="10,153,139,179"/>
</map>
</div>

</div>
</div>
<a id="a80a9c7ffc5b622913366185669db13f8" name="a80a9c7ffc5b622913366185669db13f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80a9c7ffc5b622913366185669db13f8">&#9670;&#160;</a></span>_getLiveLogs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getLiveLogs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$re</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$needle</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$reportFileExistResult</em> = <code>TRUE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets logs for live logs pages, the actual method. </p>
<p>A few modules share their log files with other processes. So the $needle param is used to filter module log lines.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$needle</td><td>Second regexp to further restrict the result set. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classMonitoring.html#a80a9c7ffc5b622913366185669db13f8">Monitoring</a>, <a class="el" href="classOpenssh.html#a80a9c7ffc5b622913366185669db13f8">Openssh</a>, and <a class="el" href="classPf.html#a80a9c7ffc5b622913366185669db13f8">Pf</a>.</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01407">1407</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1408</span>    {</div>
<div class="line"><span class="lineno"> 1409</span>        <span class="keywordflow">if</span> (!$this-&gt;ValidateFile($file, $reportFileExistResult)) {</div>
<div class="line"><span class="lineno"> 1410</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1411</span>        }</div>
<div class="line"><span class="lineno"> 1412</span> </div>
<div class="line"><span class="lineno"> 1413</span>        <span class="comment">// Empty $re is not an issue for grep, greps all</span></div>
<div class="line"><span class="lineno"> 1414</span>        $re= escapeshellarg($re);</div>
<div class="line"><span class="lineno"> 1415</span>        <span class="keywordflow">if</span> ($needle == <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1416</span>            $cmd= <span class="stringliteral">&quot;/usr/bin/grep -a -E $re $file&quot;</span>;</div>
<div class="line"><span class="lineno"> 1417</span>        }</div>
<div class="line"><span class="lineno"> 1418</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1419</span>            $needle= escapeshellarg($needle);</div>
<div class="line"><span class="lineno"> 1420</span>            $cmd= <span class="stringliteral">&quot;/usr/bin/grep -a -E $needle $file | /usr/bin/grep -a -E $re&quot;</span>;</div>
<div class="line"><span class="lineno"> 1421</span>        }</div>
<div class="line"><span class="lineno"> 1422</span> </div>
<div class="line"><span class="lineno"> 1423</span>        $cmd.= <span class="stringliteral">&quot; | /usr/bin/tail -$count&quot;</span>;</div>
<div class="line"><span class="lineno"> 1424</span> </div>
<div class="line"><span class="lineno"> 1425</span>        exec($cmd, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno"> 1426</span> </div>
<div class="line"><span class="lineno"> 1427</span>        $logs= array();</div>
<div class="line"><span class="lineno"> 1428</span>        <span class="keywordflow">foreach</span> ($output as $line) {</div>
<div class="line"><span class="lineno"> 1429</span>            unset($cols);</div>
<div class="line"><span class="lineno"> 1430</span>            <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb">ParseLogLine</a>($line, $cols)) {</div>
<div class="line"><span class="lineno"> 1431</span>                $logs[]= $cols;</div>
<div class="line"><span class="lineno"> 1432</span>            }</div>
<div class="line"><span class="lineno"> 1433</span>        }</div>
<div class="line"><span class="lineno"> 1434</span>        <span class="keywordflow">return</span> $logs;</div>
<div class="line"><span class="lineno"> 1435</span>    }</div>
<div class="ttc" id="aclassModel_html_ad8dbb64d308bdf8cbe3dfee2c84fb9bb"><div class="ttname"><a href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb">Model\ParseLogLine</a></div><div class="ttdeci">ParseLogLine($logline, &amp;$cols)</div><div class="ttdoc">Parses the given log line.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l01533">model.php:1533</a></div></div>
<div class="ttc" id="actlr_8php_html_a80b96347dc2ad0d4e3748dc87db72731"><div class="ttname"><a href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a></div><div class="ttdeci">if( $ArgV[0]==='-n') if($ArgV[0]==='-t') $retval</div><div class="ttdef"><b>Definition:</b> <a href="ctlr_8php_source.html#l00072">ctlr.php:72</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="model_8php_source.html#l01533">ParseLogLine()</a>, and <a class="el" href="model_8php_source.html#l01838">ValidateFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02862">getFifoLogs()</a>, and <a class="el" href="model_8php_source.html#l01394">GetLiveLogs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a80a9c7ffc5b622913366185669db13f8_cgraph.png" border="0" usemap="#aclassModel_a80a9c7ffc5b622913366185669db13f8_cgraph" alt=""/></div>
<map name="aclassModel_a80a9c7ffc5b622913366185669db13f8_cgraph" id="aclassModel_a80a9c7ffc5b622913366185669db13f8_cgraph">
<area shape="rect" title="Gets logs for live logs pages, the actual method." alt="" coords="5,32,112,57"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="160,7,267,32"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="164,56,263,81"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="320,5,447,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="500,81,553,107"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="315,107,452,132"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a80a9c7ffc5b622913366185669db13f8_icgraph.png" border="0" usemap="#aclassModel_a80a9c7ffc5b622913366185669db13f8_icgraph" alt=""/></div>
<map name="aclassModel_a80a9c7ffc5b622913366185669db13f8_icgraph" id="aclassModel_a80a9c7ffc5b622913366185669db13f8_icgraph">
<area shape="rect" title="Gets logs for live logs pages, the actual method." alt="" coords="525,55,632,80"/>
<area shape="rect" href="classModel.html#a75a2cec868b2b3cf1d0f2ae81a799298" title=" " alt="" coords="377,29,475,55"/>
<area shape="rect" href="classModel.html#abd1e082730aeee7890560b4ca2ee0a62" title="Gets logs for live logs pages." alt="" coords="375,79,477,104"/>
<area shape="rect" href="classModel.html#a5b9d9c5affe24f91a3151fa107ee80e4" title=" " alt="" coords="188,5,327,31"/>
<area shape="rect" href="classModel.html#ab735f5a4ded9f9c9a5b04f182205fd7d" title=" " alt="" coords="214,55,301,80"/>
<area shape="rect" href="classModel.html#ac74f9ae5abb475786f8f9278af56e953" title=" " alt="" coords="5,5,140,31"/>
</map>
</div>

</div>
</div>
<a id="aab423e07962bdc1319b01c6d7c679f0f" name="aab423e07962bdc1319b01c6d7c679f0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab423e07962bdc1319b01c6d7c679f0f">&#9670;&#160;</a></span>_getLogStartDate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getLogStartDate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01489">1489</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1490</span>    {</div>
<div class="line"><span class="lineno"> 1491</span>        <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/.*\.gz$/&#39;</span>, $file)) {</div>
<div class="line"><span class="lineno"> 1492</span>            $tmpfile= $this-&gt;GetTmpLogFileName($file);</div>
<div class="line"><span class="lineno"> 1493</span>            <span class="comment">// Log file may have been rotated, shifting compressed archive file numbers,</span></div>
<div class="line"><span class="lineno"> 1494</span>            <span class="comment">// hence modification check</span></div>
<div class="line"><span class="lineno"> 1495</span>            <span class="keywordflow">if</span> (file_exists($tmpfile) &amp;&amp; !$this-&gt;IsLogFileModified($tmpfile)) {</div>
<div class="line"><span class="lineno"> 1496</span>                $file= $tmpfile;</div>
<div class="line"><span class="lineno"> 1497</span>            }</div>
<div class="line"><span class="lineno"> 1498</span>        }</div>
<div class="line"><span class="lineno"> 1499</span>        </div>
<div class="line"><span class="lineno"> 1500</span>        <span class="keywordflow">if</span> (!preg_match(<span class="stringliteral">&#39;/.*\.gz$/&#39;</span>, $file)) {</div>
<div class="line"><span class="lineno"> 1501</span>            $logline= $this-&gt;<a class="code hl_function" href="classModel.html#ad8f9b01c41c50fcef015cc5444236024">GetFileFirstLine</a>($file);</div>
<div class="line"><span class="lineno"> 1502</span>            </div>
<div class="line"><span class="lineno"> 1503</span>            <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb">ParseLogLine</a>($logline, $cols)) {</div>
<div class="line"><span class="lineno"> 1504</span>                <span class="keywordflow">return</span> $cols[<span class="stringliteral">&#39;Date&#39;</span>].<span class="charliteral">&#39; &#39;</span>.$cols[<span class="stringliteral">&#39;Time&#39;</span>];</div>
<div class="line"><span class="lineno"> 1505</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1506</span>                <span class="keywordflow">return</span> _(<span class="stringliteral">&#39;Unknown&#39;</span>);</div>
<div class="line"><span class="lineno"> 1507</span>            }</div>
<div class="line"><span class="lineno"> 1508</span>        }</div>
<div class="line"><span class="lineno"> 1509</span>        <span class="keywordflow">return</span> _(<span class="stringliteral">&#39;Compressed&#39;</span>);</div>
<div class="line"><span class="lineno"> 1510</span>    }</div>
<div class="ttc" id="aclassModel_html_ad8f9b01c41c50fcef015cc5444236024"><div class="ttname"><a href="classModel.html#ad8f9b01c41c50fcef015cc5444236024">Model\GetFileFirstLine</a></div><div class="ttdeci">GetFileFirstLine($file)</div><div class="ttdoc">Gets first line of file.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l01520">model.php:1520</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l01520">GetFileFirstLine()</a>, <a class="el" href="model_8php_source.html#l01127">GetTmpLogFileName()</a>, <a class="el" href="model_8php_source.html#l01094">IsLogFileModified()</a>, and <a class="el" href="model_8php_source.html#l01533">ParseLogLine()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01463">GetLogFilesList()</a>, and <a class="el" href="model_8php_source.html#l01484">GetLogStartDate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aab423e07962bdc1319b01c6d7c679f0f_cgraph.png" border="0" usemap="#aclassModel_aab423e07962bdc1319b01c6d7c679f0f_cgraph" alt=""/></div>
<map name="aclassModel_aab423e07962bdc1319b01c6d7c679f0f_cgraph" id="aclassModel_aab423e07962bdc1319b01c6d7c679f0f_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,140,183"/>
<area shape="rect" href="classModel.html#ad8f9b01c41c50fcef015cc5444236024" title="Gets first line of file." alt="" coords="397,5,519,31"/>
<area shape="rect" href="classModel.html#a7ece271b0ef8636736f58b3b75268931" title="Gets the name of the file in the tmp folder." alt="" coords="188,181,347,207"/>
<area shape="rect" href="classModel.html#adef576154f41b9e06cbf28bb1a4f74b8" title="Checks if the given log file has been updated." alt="" coords="200,132,335,157"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="214,232,321,257"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="569,32,716,57"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="597,156,689,181"/>
<area shape="rect" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7" title="Gets the original file name for the given log file." alt="" coords="764,157,899,183"/>
<area shape="rect" href="classModel.html#a2ef1e4c1d1fadd3c6696a101cd2aa7e5" title="Gets previous line count and stat() from statistics file." alt="" coords="395,107,521,132"/>
<area shape="rect" href="classModel.html#ae24c34977ae6864272b678fe40fdb09a" title="Gets name of the tmp statistics file for the given log file." alt="" coords="573,107,713,132"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="395,259,521,284"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aab423e07962bdc1319b01c6d7c679f0f_icgraph.png" border="0" usemap="#aclassModel_aab423e07962bdc1319b01c6d7c679f0f_icgraph" alt=""/></div>
<map name="aclassModel_aab423e07962bdc1319b01c6d7c679f0f_icgraph" id="aclassModel_aab423e07962bdc1319b01c6d7c679f0f_icgraph">
<area shape="rect" title=" " alt="" coords="184,31,319,56"/>
<area shape="rect" href="classModel.html#aed5ee3c735f862c4d99761b379f31729" title="Gets log files list with start dates." alt="" coords="10,5,131,31"/>
<area shape="rect" href="classModel.html#a40159dcd03e82eade9e96fd6b8080e89" title="Extracts the datetime of the first line in the log file." alt="" coords="5,55,136,80"/>
</map>
</div>

</div>
</div>
<a id="a65ffe7950ba3a608bd8839a16ab88fe5" name="a65ffe7950ba3a608bd8839a16ab88fe5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65ffe7950ba3a608bd8839a16ab88fe5">&#9670;&#160;</a></span>_getModuleInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getModuleInfo </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$start</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reimplemented in <a class="el" href="classDhcpd.html#a65ffe7950ba3a608bd8839a16ab88fe5">Dhcpd</a>, <a class="el" href="classOpenssh.html#a65ffe7950ba3a608bd8839a16ab88fe5">Openssh</a>, <a class="el" href="classPf.html#a65ffe7950ba3a608bd8839a16ab88fe5">Pf</a>, and <a class="el" href="classSystem.html#a65ffe7950ba3a608bd8839a16ab88fe5">System</a>.</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02857">2857</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2858</span>    {</div>
<div class="line"><span class="lineno"> 2859</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2860</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b9d9c5affe24f91a3151fa107ee80e4" name="a5b9d9c5affe24f91a3151fa107ee80e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b9d9c5affe24f91a3151fa107ee80e4">&#9670;&#160;</a></span>_getModuleStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getModuleStatus </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$generate_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$do_cache</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02804">2804</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2805</span>    {</div>
<div class="line"><span class="lineno"> 2806</span>        $status= array();</div>
<div class="line"><span class="lineno"> 2807</span>        $cache= <span class="stringliteral">&quot;{$this-&gt;PFFWDIR}/cache/{$this-&gt;Name}_status.json&quot;</span>;</div>
<div class="line"><span class="lineno"> 2808</span> </div>
<div class="line"><span class="lineno"> 2809</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="View_2dhcpd_2dhcpd_8php.html#a83b72400c2ac339d288cdb20cd46a341">$generate_status</a> || !$this-&gt;getCachedContents($cache, $status)) {</div>
<div class="line"><span class="lineno"> 2810</span>            $runStatus= $this-&gt;IsRunning() ? <span class="charliteral">&#39;R&#39;</span> : <span class="charliteral">&#39;S&#39;</span>;</div>
<div class="line"><span class="lineno"> 2811</span> </div>
<div class="line"><span class="lineno"> 2812</span>            $status= array(</div>
<div class="line"><span class="lineno"> 2813</span>                <span class="stringliteral">&#39;Status&#39;</span> =&gt; $runStatus,</div>
<div class="line"><span class="lineno"> 2814</span>                <span class="stringliteral">&#39;ErrorStatus&#39;</span> =&gt; <span class="charliteral">&#39;U&#39;</span>,</div>
<div class="line"><span class="lineno"> 2815</span>                <span class="stringliteral">&#39;Critical&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno"> 2816</span>                <span class="stringliteral">&#39;Error&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno"> 2817</span>                <span class="stringliteral">&#39;Warning&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno"> 2818</span>                <span class="stringliteral">&#39;Logs&#39;</span> =&gt; array(),</div>
<div class="line"><span class="lineno"> 2819</span>                );</div>
<div class="line"><span class="lineno"> 2820</span> </div>
<div class="line"><span class="lineno"> 2821</span>            $logs= $this-&gt;getFifoLogs($start);</div>
<div class="line"><span class="lineno"> 2822</span>            <span class="keywordflow">if</span> ($logs !== FALSE) {</div>
<div class="line"><span class="lineno"> 2823</span>                $status[<span class="stringliteral">&#39;Logs&#39;</span>]= $logs;</div>
<div class="line"><span class="lineno"> 2824</span>            }</div>
<div class="line"><span class="lineno"> 2825</span> </div>
<div class="line"><span class="lineno"> 2826</span>            $result= array(</div>
<div class="line"><span class="lineno"> 2827</span>                <span class="stringliteral">&#39;critical&#39;</span> =&gt; TRUE,</div>
<div class="line"><span class="lineno"> 2828</span>                <span class="stringliteral">&#39;error&#39;</span> =&gt; TRUE,</div>
<div class="line"><span class="lineno"> 2829</span>                <span class="stringliteral">&#39;warning&#39;</span> =&gt; TRUE,</div>
<div class="line"><span class="lineno"> 2830</span>                );</div>
<div class="line"><span class="lineno"> 2831</span> </div>
<div class="line"><span class="lineno"> 2832</span>            <span class="keywordflow">foreach</span> (array(<span class="stringliteral">&#39;warning&#39;</span>, <span class="stringliteral">&#39;error&#39;</span>, <span class="stringliteral">&#39;critical&#39;</span>) as $prio) {</div>
<div class="line"><span class="lineno"> 2833</span>                $status[ucfirst($prio)]= $this-&gt;getRrdValue(<span class="stringliteral">&quot;derive-$prio.rrd&quot;</span>, $start, $result[$prio]);</div>
<div class="line"><span class="lineno"> 2834</span>            }</div>
<div class="line"><span class="lineno"> 2835</span> </div>
<div class="line"><span class="lineno"> 2836</span>            <span class="keywordflow">if</span> ($status[<span class="stringliteral">&#39;Critical&#39;</span>]) {</div>
<div class="line"><span class="lineno"> 2837</span>                $status[<span class="stringliteral">&#39;ErrorStatus&#39;</span>]= <span class="charliteral">&#39;C&#39;</span>;</div>
<div class="line"><span class="lineno"> 2838</span>            }</div>
<div class="line"><span class="lineno"> 2839</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($status[<span class="stringliteral">&#39;Error&#39;</span>]) {</div>
<div class="line"><span class="lineno"> 2840</span>                $status[<span class="stringliteral">&#39;ErrorStatus&#39;</span>]= <span class="charliteral">&#39;E&#39;</span>;</div>
<div class="line"><span class="lineno"> 2841</span>            }</div>
<div class="line"><span class="lineno"> 2842</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($status[<span class="stringliteral">&#39;Warning&#39;</span>]) {</div>
<div class="line"><span class="lineno"> 2843</span>                $status[<span class="stringliteral">&#39;ErrorStatus&#39;</span>]= <span class="charliteral">&#39;W&#39;</span>;</div>
<div class="line"><span class="lineno"> 2844</span>            }</div>
<div class="line"><span class="lineno"> 2845</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($result[<span class="stringliteral">&#39;critical&#39;</span>] &amp;&amp; $result[<span class="stringliteral">&#39;error&#39;</span>] &amp;&amp; $result[<span class="stringliteral">&#39;warning&#39;</span>]) {</div>
<div class="line"><span class="lineno"> 2846</span>                $status[<span class="stringliteral">&#39;ErrorStatus&#39;</span>]= <span class="charliteral">&#39;N&#39;</span>;</div>
<div class="line"><span class="lineno"> 2847</span>            }</div>
<div class="line"><span class="lineno"> 2848</span> </div>
<div class="line"><span class="lineno"> 2849</span>            <span class="keywordflow">if</span> ($do_cache) {</div>
<div class="line"><span class="lineno"> 2850</span>                file_put_contents($cache, json_encode($status), LOCK_EX);</div>
<div class="line"><span class="lineno"> 2851</span>            }</div>
<div class="line"><span class="lineno"> 2852</span>        }</div>
<div class="line"><span class="lineno"> 2853</span> </div>
<div class="line"><span class="lineno"> 2854</span>        <span class="keywordflow">return</span> $status;</div>
<div class="line"><span class="lineno"> 2855</span>    }</div>
<div class="ttc" id="aView_2dhcpd_2dhcpd_8php_html_a83b72400c2ac339d288cdb20cd46a341"><div class="ttname"><a href="View_2dhcpd_2dhcpd_8php.html#a83b72400c2ac339d288cdb20cd46a341">$generate_status</a></div><div class="ttdeci">$generate_status</div><div class="ttdef"><b>Definition:</b> <a href="View_2dhcpd_2dhcpd_8php_source.html#l00025">dhcpd.php:25</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="View_2dhcpd_2dhcpd_8php_source.html#l00025">$generate_status</a>, <a class="el" href="model_8php_source.html#l02775">getCachedContents()</a>, <a class="el" href="model_8php_source.html#l02862">getFifoLogs()</a>, <a class="el" href="model_8php_source.html#l02906">getRrdValue()</a>, and <a class="el" href="model_8php_source.html#l00332">IsRunning()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02797">GetModuleStatus()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a5b9d9c5affe24f91a3151fa107ee80e4_cgraph.png" border="0" usemap="#aclassModel_a5b9d9c5affe24f91a3151fa107ee80e4_cgraph" alt=""/></div>
<map name="aclassModel_a5b9d9c5affe24f91a3151fa107ee80e4_cgraph" id="aclassModel_a5b9d9c5affe24f91a3151fa107ee80e4_cgraph">
<area shape="rect" title=" " alt="" coords="5,181,144,207"/>
<area shape="rect" href="classModel.html#a3216e14ab593ec9dcc7df09c995d8b1b" title=" " alt="" coords="192,55,341,80"/>
<area shape="rect" href="classModel.html#a75a2cec868b2b3cf1d0f2ae81a799298" title=" " alt="" coords="218,280,315,305"/>
<area shape="rect" href="classModel.html#a7fb8ac5678a9e42f00fb66780296bca9" title=" " alt="" coords="216,131,317,156"/>
<area shape="rect" href="classModel.html#a73fbf3721e73a688382663bf84e1e428" title="Checks if the given process(es) is running." alt="" coords="223,205,310,231"/>
<area shape="rect" href="classModel.html#a1151960aeff2e631b01f989afe5b2f7e" title=" " alt="" coords="410,5,535,31"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="427,55,519,80"/>
<area shape="rect" href="classModel.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="419,307,526,332"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="604,307,711,332"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="608,357,707,383"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="764,307,891,332"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="944,307,997,332"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="759,408,896,433"/>
<area shape="rect" href="classModel.html#a106f3eba1442c7e4cf721764772bc724" title=" " alt="" coords="389,156,556,181"/>
<area shape="rect" href="classModel.html#aead9ffea53f83ba54a7bc722dbc81841" title="Selects user processes from ps output." alt="" coords="409,205,536,231"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a5b9d9c5affe24f91a3151fa107ee80e4_icgraph.png" border="0" usemap="#aclassModel_a5b9d9c5affe24f91a3151fa107ee80e4_icgraph" alt=""/></div>
<map name="aclassModel_a5b9d9c5affe24f91a3151fa107ee80e4_icgraph" id="aclassModel_a5b9d9c5affe24f91a3151fa107ee80e4_icgraph">
<area shape="rect" title=" " alt="" coords="188,5,327,31"/>
<area shape="rect" href="classModel.html#ac74f9ae5abb475786f8f9278af56e953" title=" " alt="" coords="5,5,140,31"/>
</map>
</div>

</div>
</div>
<a id="a941c3c7c9570b1a241f58024b3cc7963" name="a941c3c7c9570b1a241f58024b3cc7963"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a941c3c7c9570b1a241f58024b3cc7963">&#9670;&#160;</a></span>_getPartitions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getPartitions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns all partitions mounted. </p>

<p>Reimplemented in <a class="el" href="classSystem.html#a941c3c7c9570b1a241f58024b3cc7963">System</a>.</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l03154">3154</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3155</span>    {</div>
<div class="line"><span class="lineno"> 3156</span>        <span class="keywordflow">if</span> (($contents= $this-&gt;RunShellCommand(<span class="stringliteral">&quot;/sbin/mount&quot;</span>)) !== <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 3157</span>            $contents= explode(<span class="stringliteral">&quot;\n&quot;</span>, $contents);</div>
<div class="line"><span class="lineno"> 3158</span>            </div>
<div class="line"><span class="lineno"> 3159</span>            $partitions= array();</div>
<div class="line"><span class="lineno"> 3160</span>            <span class="keywordflow">foreach</span> ($contents as $line) {</div>
<div class="line"><span class="lineno"> 3161</span>                <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/^(\S+)\s+on\s+(\S+)/&#39;</span>, $line, $match)) {</div>
<div class="line"><span class="lineno"> 3162</span>                    $partitions[$match[1]]= $match[2];</div>
<div class="line"><span class="lineno"> 3163</span>                }</div>
<div class="line"><span class="lineno"> 3164</span>            }</div>
<div class="line"><span class="lineno"> 3165</span>            <span class="keywordflow">return</span> $partitions;</div>
<div class="line"><span class="lineno"> 3166</span>        }</div>
<div class="line"><span class="lineno"> 3167</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 3168</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00791">RunShellCommand()</a>.</p>

<p class="reference">Referenced by <a class="el" href="symon_8php_source.html#l00117">Symon\SetConf()</a>, and <a class="el" href="symon_8php_source.html#l00301">Symon\SetPartitions()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a941c3c7c9570b1a241f58024b3cc7963_cgraph.png" border="0" usemap="#aclassModel_a941c3c7c9570b1a241f58024b3cc7963_cgraph" alt=""/></div>
<map name="aclassModel_a941c3c7c9570b1a241f58024b3cc7963_cgraph" id="aclassModel_a941c3c7c9570b1a241f58024b3cc7963_cgraph">
<area shape="rect" title="Returns all partitions mounted." alt="" coords="5,5,116,31"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="164,5,311,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a941c3c7c9570b1a241f58024b3cc7963_icgraph.png" border="0" usemap="#aclassModel_a941c3c7c9570b1a241f58024b3cc7963_icgraph" alt=""/></div>
<map name="aclassModel_a941c3c7c9570b1a241f58024b3cc7963_icgraph" id="aclassModel_a941c3c7c9570b1a241f58024b3cc7963_icgraph">
<area shape="rect" title="Returns all partitions mounted." alt="" coords="207,31,317,56"/>
<area shape="rect" href="classSymon.html#a7cfa59b60de90b66fac33786564689da" title="Sets interface names in the symon and symux config files." alt="" coords="21,5,143,31"/>
<area shape="rect" href="classSymon.html#a0e98d8a401fc7d293c027316be99f6b8" title=" " alt="" coords="5,55,159,80"/>
</map>
</div>

</div>
</div>
<a id="a917be6afd7db6dec41becb528b1690d5" name="a917be6afd7db6dec41becb528b1690d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a917be6afd7db6dec41becb528b1690d5">&#9670;&#160;</a></span>_getPhyIfs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getPhyIfs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01036">1036</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1037</span>    {</div>
<div class="line"><span class="lineno"> 1038</span>        <span class="keywordflow">return</span> $this-&gt;RunShellCommand(<span class="stringliteral">&quot;/sbin/ifconfig -a | /usr/bin/grep &#39;: flags=&#39; | /usr/bin/sed &#39;s/: flags=.*//g&#39; | /usr/bin/grep -v -e lo -e pflog -e pfsync -e enc -e tun&quot;</span>);</div>
<div class="line"><span class="lineno"> 1039</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00791">RunShellCommand()</a>.</p>

<p class="reference">Referenced by <a class="el" href="Model_2system_8php_source.html#l00621">System\GetConfig()</a>, and <a class="el" href="model_8php_source.html#l01031">GetPhyIfs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a917be6afd7db6dec41becb528b1690d5_cgraph.png" border="0" usemap="#aclassModel_a917be6afd7db6dec41becb528b1690d5_cgraph" alt=""/></div>
<map name="aclassModel_a917be6afd7db6dec41becb528b1690d5_cgraph" id="aclassModel_a917be6afd7db6dec41becb528b1690d5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,96,31"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="144,5,291,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a917be6afd7db6dec41becb528b1690d5_icgraph.png" border="0" usemap="#aclassModel_a917be6afd7db6dec41becb528b1690d5_icgraph" alt=""/></div>
<map name="aclassModel_a917be6afd7db6dec41becb528b1690d5_icgraph" id="aclassModel_a917be6afd7db6dec41becb528b1690d5_icgraph">
<area shape="rect" title=" " alt="" coords="192,31,283,56"/>
<area shape="rect" href="classSystem.html#a6baa62a81a32e122dde71ac97c46fe9a" title="Reads hostname, gateway, and interface configuration." alt="" coords="5,5,144,31"/>
<area shape="rect" href="classModel.html#aa7dc2e292df1ab234a44e9e2a5b170b0" title="Extracts physical interface names from ifconfig output." alt="" coords="32,55,117,80"/>
</map>
</div>

</div>
</div>
<a id="a1151960aeff2e631b01f989afe5b2f7e" name="a1151960aeff2e631b01f989afe5b2f7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1151960aeff2e631b01f989afe5b2f7e">&#9670;&#160;</a></span>_getReloadRate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getReloadRate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00760">760</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  761</span>    {</div>
<div class="line"><span class="lineno">  762</span>        global <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>;</div>
<div class="line"><span class="lineno">  763</span> </div>
<div class="line"><span class="lineno">  764</span>        require(<a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/setup.php&#39;</span>);</div>
<div class="line"><span class="lineno">  765</span>        </div>
<div class="line"><span class="lineno">  766</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="View_2lib_2setup_8php.html#a634db6fb1abed6ef889755dc7b24091b">$DefaultReloadRate</a>;</div>
<div class="line"><span class="lineno">  767</span>    }</div>
<div class="ttc" id="aView_2lib_2setup_8php_html_a634db6fb1abed6ef889755dc7b24091b"><div class="ttname"><a href="View_2lib_2setup_8php.html#a634db6fb1abed6ef889755dc7b24091b">$DefaultReloadRate</a></div><div class="ttdeci">$DefaultReloadRate</div><div class="ttdoc">Default reload rate in seconds for dynamic pages, e.g. live pages.</div><div class="ttdef"><b>Definition:</b> <a href="View_2lib_2setup_8php_source.html#l00035">setup.php:35</a></div></div>
<div class="ttc" id="ainstall_8php_html_a1cf4c1ce4d54df11a660775bb7c5bbd8"><div class="ttname"><a href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a></div><div class="ttdeci">$VIEW_PATH</div><div class="ttdef"><b>Definition:</b> <a href="install_8php_source.html#l00039">install.php:39</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="View_2lib_2setup_8php_source.html#l00035">$DefaultReloadRate</a>, and <a class="el" href="install_8php_source.html#l00039">$VIEW_PATH</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02775">getCachedContents()</a>, and <a class="el" href="model_8php_source.html#l00755">GetReloadRate()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a1151960aeff2e631b01f989afe5b2f7e_icgraph.png" border="0" usemap="#aclassModel_a1151960aeff2e631b01f989afe5b2f7e_icgraph" alt=""/></div>
<map name="aclassModel_a1151960aeff2e631b01f989afe5b2f7e_icgraph" id="aclassModel_a1151960aeff2e631b01f989afe5b2f7e_icgraph">
<area shape="rect" title=" " alt="" coords="572,55,697,80"/>
<area shape="rect" href="classModel.html#a3216e14ab593ec9dcc7df09c995d8b1b" title=" " alt="" coords="375,29,524,55"/>
<area shape="rect" href="classModel.html#a0601a366475cb83c65f99ad10e663de0" title="Gets default reload rate." alt="" coords="389,79,509,104"/>
<area shape="rect" href="classModel.html#a5b9d9c5affe24f91a3151fa107ee80e4" title=" " alt="" coords="188,5,327,31"/>
<area shape="rect" href="classModel.html#a5cf12375d05dca29b3c81333ff1882a2" title="Gets service statuses." alt="" coords="190,55,325,80"/>
<area shape="rect" href="classModel.html#ac74f9ae5abb475786f8f9278af56e953" title=" " alt="" coords="5,5,140,31"/>
</map>
</div>

</div>
</div>
<a id="a879807a0b92e50464699e78d3c216483" name="a879807a0b92e50464699e78d3c216483"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a879807a0b92e50464699e78d3c216483">&#9670;&#160;</a></span>_getStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getStats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$date</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$collecthours</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01780">1780</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1781</span>    {</div>
<div class="line"><span class="lineno"> 1782</span>        <span class="keywordflow">if</span> (!$this-&gt;ValidateFile($logfile)) {</div>
<div class="line"><span class="lineno"> 1783</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1784</span>        }</div>
<div class="line"><span class="lineno"> 1785</span> </div>
<div class="line"><span class="lineno"> 1786</span>        $date= json_decode($date, TRUE);</div>
<div class="line"><span class="lineno"> 1787</span> </div>
<div class="line"><span class="lineno"> 1788</span>        $stats= array();</div>
<div class="line"><span class="lineno"> 1789</span>        $briefstats= array();</div>
<div class="line"><span class="lineno"> 1790</span>        $uptodate= FALSE;</div>
<div class="line"><span class="lineno"> 1791</span> </div>
<div class="line"><span class="lineno"> 1792</span>        <span class="keywordflow">if</span> ($this-&gt;IsLogFileModified($logfile)) {</div>
<div class="line"><span class="lineno"> 1793</span>            $this-&gt;UpdateTmpLogFile($logfile);</div>
<div class="line"><span class="lineno"> 1794</span>        }</div>
<div class="line"><span class="lineno"> 1795</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1796</span>            $uptodate= $this-&gt;<a class="code hl_function" href="classModel.html#a1149c6f5338677a1a74e8a4964826e80">GetSavedStats</a>($logfile, $stats, $briefstats);</div>
<div class="line"><span class="lineno"> 1797</span>        }</div>
<div class="line"><span class="lineno"> 1798</span> </div>
<div class="line"><span class="lineno"> 1799</span>        <span class="keywordflow">if</span> (!$uptodate) {</div>
<div class="line"><span class="lineno"> 1800</span>            $this-&gt;<a class="code hl_function" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c">UpdateStats</a>($logfile, $stats, $briefstats);</div>
<div class="line"><span class="lineno"> 1801</span>        }</div>
<div class="line"><span class="lineno"> 1802</span> </div>
<div class="line"><span class="lineno"> 1803</span>        <span class="keywordflow">if</span> (isset($stats[<span class="stringliteral">&#39;Date&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1804</span>            <span class="keywordflow">if</span> ($collecthours === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1805</span>                <span class="keywordflow">foreach</span> ($stats[<span class="stringliteral">&#39;Date&#39;</span>] as $day =&gt; $daystats) {</div>
<div class="line"><span class="lineno"> 1806</span>                    unset($stats[<span class="stringliteral">&#39;Date&#39;</span>][$day][<span class="stringliteral">&#39;Hours&#39;</span>]);</div>
<div class="line"><span class="lineno"> 1807</span>                }</div>
<div class="line"><span class="lineno"> 1808</span>            }</div>
<div class="line"><span class="lineno"> 1809</span> </div>
<div class="line"><span class="lineno"> 1810</span>            $re= $this-&gt;<a class="code hl_function" href="classModel.html#acae82824087b62c41fe805eba381e84c">GetDateRegexp</a>($date);</div>
<div class="line"><span class="lineno"> 1811</span>            <span class="keywordflow">foreach</span> ($stats[<span class="stringliteral">&#39;Date&#39;</span>] as $day =&gt; $daystats) {</div>
<div class="line"><span class="lineno"> 1812</span>                <span class="keywordflow">if</span> (!preg_match(<span class="stringliteral">&quot;/$re/&quot;</span>, $day)) {</div>
<div class="line"><span class="lineno"> 1813</span>                    unset($stats[<span class="stringliteral">&#39;Date&#39;</span>][$day]);</div>
<div class="line"><span class="lineno"> 1814</span>                }</div>
<div class="line"><span class="lineno"> 1815</span>            }</div>
<div class="line"><span class="lineno"> 1816</span> </div>
<div class="line"><span class="lineno"> 1817</span>            $re= $this-&gt;<a class="code hl_function" href="classModel.html#ae1a4adadbacc084431d026315be20390">GetHourRegexp</a>($date);</div>
<div class="line"><span class="lineno"> 1818</span>            <span class="keywordflow">foreach</span> ($stats[<span class="stringliteral">&#39;Date&#39;</span>] as $day =&gt; $daystats) {</div>
<div class="line"><span class="lineno"> 1819</span>                <span class="keywordflow">if</span> (isset($daystats[<span class="stringliteral">&#39;Hours&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1820</span>                    <span class="keywordflow">foreach</span> ($daystats[<span class="stringliteral">&#39;Hours&#39;</span>] as $hour =&gt; $hourstats) {</div>
<div class="line"><span class="lineno"> 1821</span>                        <span class="keywordflow">if</span> (!preg_match(<span class="stringliteral">&quot;/$re/&quot;</span>, $hour)) {</div>
<div class="line"><span class="lineno"> 1822</span>                            unset($stats[<span class="stringliteral">&#39;Date&#39;</span>][$day][<span class="stringliteral">&#39;Hours&#39;</span>][$hour]);</div>
<div class="line"><span class="lineno"> 1823</span>                        }</div>
<div class="line"><span class="lineno"> 1824</span>                    }</div>
<div class="line"><span class="lineno"> 1825</span>                }</div>
<div class="line"><span class="lineno"> 1826</span>            }</div>
<div class="line"><span class="lineno"> 1827</span>        }</div>
<div class="line"><span class="lineno"> 1828</span>        <span class="keywordflow">return</span> json_encode($stats);</div>
<div class="line"><span class="lineno"> 1829</span>    }</div>
<div class="ttc" id="aclassModel_html_a1149c6f5338677a1a74e8a4964826e80"><div class="ttname"><a href="classModel.html#a1149c6f5338677a1a74e8a4964826e80">Model\GetSavedStats</a></div><div class="ttdeci">GetSavedStats($logfile, &amp;$stats, &amp;$briefstats)</div><div class="ttdoc">Gets saved statistics for the given log file.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l02033">model.php:2033</a></div></div>
<div class="ttc" id="aclassModel_html_a4b2587fd477dfc21d60f1185c624521c"><div class="ttname"><a href="classModel.html#a4b2587fd477dfc21d60f1185c624521c">Model\UpdateStats</a></div><div class="ttdeci">UpdateStats($logfile, &amp;$stats, &amp;$briefstats)</div><div class="ttdoc">Updates statistics incrementally, both brief and full.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l01919">model.php:1919</a></div></div>
<div class="ttc" id="aclassModel_html_acae82824087b62c41fe805eba381e84c"><div class="ttname"><a href="classModel.html#acae82824087b62c41fe805eba381e84c">Model\GetDateRegexp</a></div><div class="ttdeci">GetDateRegexp($date)</div><div class="ttdoc">Generates date regexp to be used by statistics functions.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l01989">model.php:1989</a></div></div>
<div class="ttc" id="aclassModel_html_ae1a4adadbacc084431d026315be20390"><div class="ttname"><a href="classModel.html#ae1a4adadbacc084431d026315be20390">Model\GetHourRegexp</a></div><div class="ttdeci">GetHourRegexp($date)</div><div class="ttdoc">Generates hour regexp to be used by statistics functions.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l02014">model.php:2014</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l01989">GetDateRegexp()</a>, <a class="el" href="model_8php_source.html#l02014">GetHourRegexp()</a>, <a class="el" href="model_8php_source.html#l02033">GetSavedStats()</a>, <a class="el" href="model_8php_source.html#l01094">IsLogFileModified()</a>, <a class="el" href="model_8php_source.html#l01919">UpdateStats()</a>, <a class="el" href="model_8php_source.html#l01144">UpdateTmpLogFile()</a>, and <a class="el" href="model_8php_source.html#l01838">ValidateFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01742">GetAllStats()</a>, and <a class="el" href="model_8php_source.html#l01775">GetStats()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a879807a0b92e50464699e78d3c216483_cgraph.png" border="0" usemap="#aclassModel_a879807a0b92e50464699e78d3c216483_cgraph" alt=""/></div>
<map name="aclassModel_a879807a0b92e50464699e78d3c216483_cgraph" id="aclassModel_a879807a0b92e50464699e78d3c216483_cgraph">
<area shape="rect" title=" " alt="" coords="5,375,88,400"/>
<area shape="rect" href="classModel.html#acae82824087b62c41fe805eba381e84c" title="Generates date regexp to be used by statistics functions." alt="" coords="145,224,271,250"/>
<area shape="rect" href="classModel.html#ae1a4adadbacc084431d026315be20390" title="Generates hour regexp to be used by statistics functions." alt="" coords="145,274,271,299"/>
<area shape="rect" href="classModel.html#a1149c6f5338677a1a74e8a4964826e80" title="Gets saved statistics for the given log file." alt="" coords="341,375,459,400"/>
<area shape="rect" href="classModel.html#adef576154f41b9e06cbf28bb1a4f74b8" title="Checks if the given log file has been updated." alt="" coords="333,124,467,150"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="157,754,259,779"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="746,855,845,880"/>
<area shape="rect" href="classModel.html#ad4d7aefbd214d3da3f1965e6ddddb998" title="Copies the original log file to tmp folder." alt="" coords="136,426,280,451"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="749,426,841,451"/>
<area shape="rect" href="classModel.html#a91890c866a00b75b002e6b1016e6b43c" title="Reads file contents." alt="" coords="555,226,623,251"/>
<area shape="rect" href="classModel.html#ae24c34977ae6864272b678fe40fdb09a" title="Gets name of the tmp statistics file for the given log file." alt="" coords="725,175,865,200"/>
<area shape="rect" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7" title="Gets the original file name for the given log file." alt="" coords="940,175,1075,200"/>
<area shape="rect" href="classModel.html#a2ef1e4c1d1fadd3c6696a101cd2aa7e5" title="Gets previous line count and stat() from statistics file." alt="" coords="526,324,653,350"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="722,728,869,754"/>
<area shape="rect" href="classModel.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="520,728,659,754"/>
<area shape="rect" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09" title=" " alt="" coords="932,1058,1083,1083"/>
<area shape="rect" href="classModel.html#ac23e08bf49a305b2d76f11cecc62ba4c" title="Day statistics collector." alt="" coords="337,982,463,1007"/>
<area shape="rect" href="classModel.html#ab1e8cbbabce3210438cebad028f153d7" title="Gets the number of lines added to log files since last tmp file update." alt="" coords="330,578,470,603"/>
<area shape="rect" href="classModel.html#ad26e67d9a70c2182a67b939ae61b6d01" title="Builds generic grep command and extracts log lines." alt="" coords="522,880,657,906"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="347,1056,453,1082"/>
<area shape="rect" href="classModel.html#ae6201c722387cb7120a3447378f73271" title="Further processes parser output fields." alt="" coords="336,830,464,855"/>
<area shape="rect" href="classModel.html#ab5448888d58c0402bcc575e3a5cd9e9e" title="Saves collected statistics with the current line count and stat() output." alt="" coords="546,275,633,300"/>
<area shape="rect" href="classModel.html#a3827d539c75623fd5345ab590caaa2cb" title="Generates the module specific datetime regexp for filtering logs." alt="" coords="707,679,884,704"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="1131,804,1184,830"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="939,830,1076,855"/>
<area shape="rect" href="classModel.html#abe3e76f34ef7907cc5fcc6d2840bf081" title="Hour statistics collector." alt="" coords="524,1032,655,1058"/>
<area shape="rect" href="classModel.html#a10ffb35c34bab2bd539a5a945a489625" title="Increments stats for the given values." alt="" coords="758,1008,833,1034"/>
<area shape="rect" href="classModel.html#a3b4ab5022e1e5883d5292c024eaaf8c1" title="Minute statistics collector." alt="" coords="723,1058,868,1083"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="526,1082,653,1107"/>
<area shape="rect" href="classModel.html#a24813c8e79a850571607408548a88528" title="Writes contents to file." alt="" coords="762,276,829,302"/>
<area shape="rect" href="classModel.html#a5cdc13ae8497b92e1c6cbf8b85c6d43c" title="Uncompresses gzipped log file to tmp dir." alt="" coords="328,678,472,703"/>
<area shape="rect" href="classModel.html#a620707dcc4093d4ca002e3dfdfa68af1" title="Deletes the given file or directory." alt="" coords="545,679,633,704"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a879807a0b92e50464699e78d3c216483_icgraph.png" border="0" usemap="#aclassModel_a879807a0b92e50464699e78d3c216483_icgraph" alt=""/></div>
<map name="aclassModel_a879807a0b92e50464699e78d3c216483_icgraph" id="aclassModel_a879807a0b92e50464699e78d3c216483_icgraph">
<area shape="rect" title=" " alt="" coords="148,31,231,56"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="a5e24130261dd255285454c45adc570eb" name="a5e24130261dd255285454c45adc570eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e24130261dd255285454c45adc570eb">&#9670;&#160;</a></span>_getSysCtl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getSysCtl </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$option</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l03050">3050</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3051</span>    {</div>
<div class="line"><span class="lineno"> 3052</span>        <span class="keywordflow">return</span> $this-&gt;RunShellCommand(<span class="stringliteral">&quot;/sbin/sysctl $option 2&gt;&amp;1&quot;</span>);</div>
<div class="line"><span class="lineno"> 3053</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00791">RunShellCommand()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l03177">GetSensors()</a>, <a class="el" href="model_8php_source.html#l03045">GetSysCtl()</a>, <a class="el" href="symon_8php_source.html#l00117">Symon\SetConf()</a>, and <a class="el" href="symon_8php_source.html#l00260">Symon\SetCpus()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a5e24130261dd255285454c45adc570eb_cgraph.png" border="0" usemap="#aclassModel_a5e24130261dd255285454c45adc570eb_cgraph" alt=""/></div>
<map name="aclassModel_a5e24130261dd255285454c45adc570eb_cgraph" id="aclassModel_a5e24130261dd255285454c45adc570eb_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,96,31"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="144,5,291,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a5e24130261dd255285454c45adc570eb_icgraph.png" border="0" usemap="#aclassModel_a5e24130261dd255285454c45adc570eb_icgraph" alt=""/></div>
<map name="aclassModel_a5e24130261dd255285454c45adc570eb_icgraph" id="aclassModel_a5e24130261dd255285454c45adc570eb_icgraph">
<area shape="rect" title=" " alt="" coords="368,80,459,105"/>
<area shape="rect" href="classModel.html#ad150b90d723746fef93c906fb8548a9e" title="Finds sysctl temp and fan sensors." alt="" coords="210,55,306,80"/>
<area shape="rect" href="classSymon.html#a7cfa59b60de90b66fac33786564689da" title="Sets interface names in the symon and symux config files." alt="" coords="15,5,138,31"/>
<area shape="rect" href="classModel.html#afea284b751e524dc9f750e8523be5c95" title="Gets sysctl output for the given arg." alt="" coords="215,104,301,129"/>
<area shape="rect" href="classSymon.html#a8c586413d2b45bcb21c3ef170e641e69" title=" " alt="" coords="196,153,320,179"/>
<area shape="rect" href="classSymon.html#a50f7fad3eb7f171ae72bcafa7c8a2275" title=" " alt="" coords="5,55,148,80"/>
</map>
</div>

</div>
</div>
<a id="aa2af57dba14ec82874dc3302908f36e5" name="aa2af57dba14ec82874dc3302908f36e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2af57dba14ec82874dc3302908f36e5">&#9670;&#160;</a></span>AppendToFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AppendToFile </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Appends a string to a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Config file pathname. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$line</td><td>Line to add. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000028">Todo:</a></b></dt><dd>Return the return value of file_put_contents()? Check and test all usages of AppendToFile() first. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00994">994</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  995</span>    {</div>
<div class="line"><span class="lineno">  996</span>        <span class="keywordflow">if</span> (copy($file, $file.<span class="stringliteral">&#39;.bak&#39;</span>)) {</div>
<div class="line"><span class="lineno">  997</span>            $contents= file_get_contents($file).$line.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  999</span>            file_put_contents($file, $contents);</div>
<div class="line"><span class="lineno"> 1000</span>            <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 1001</span>        }</div>
<div class="line"><span class="lineno"> 1002</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1003</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Cannot copy file: $file&quot;</span>);</div>
<div class="line"><span class="lineno"> 1004</span>        }</div>
<div class="line"><span class="lineno"> 1005</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1006</span>    }</div>
<div class="ttc" id="aModel_2include_8php_html_aacb56ea458e6602b98977b24fbbb4ebe"><div class="ttname"><a href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a></div><div class="ttdeci">ctlr_syslog($prio, $file, $func, $line, $msg)</div><div class="ttdoc">Wrapper for controller error logging via syslog.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00194">include.php:194</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>.</p>

<p class="reference">Referenced by <a class="el" href="Model_2system_8php_source.html#l00393">System\AddHost()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aa2af57dba14ec82874dc3302908f36e5_cgraph.png" border="0" usemap="#aclassModel_aa2af57dba14ec82874dc3302908f36e5_cgraph" alt=""/></div>
<map name="aclassModel_aa2af57dba14ec82874dc3302908f36e5_cgraph" id="aclassModel_aa2af57dba14ec82874dc3302908f36e5_cgraph">
<area shape="rect" title="Appends a string to a file." alt="" coords="5,5,113,31"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="161,5,253,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aa2af57dba14ec82874dc3302908f36e5_icgraph.png" border="0" usemap="#aclassModel_aa2af57dba14ec82874dc3302908f36e5_icgraph" alt=""/></div>
<map name="aclassModel_aa2af57dba14ec82874dc3302908f36e5_icgraph" id="aclassModel_aa2af57dba14ec82874dc3302908f36e5_icgraph">
<area shape="rect" title="Appends a string to a file." alt="" coords="184,5,292,31"/>
<area shape="rect" href="classSystem.html#ae71ff078bde201e683fe532347febfd7" title="Adds host line to hosts file." alt="" coords="5,5,136,31"/>
</map>
</div>

</div>
</div>
<a id="ac23e08bf49a305b2d76f11cecc62ba4c" name="ac23e08bf49a305b2d76f11cecc62ba4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac23e08bf49a305b2d76f11cecc62ba4c">&#9670;&#160;</a></span>CollectDayStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CollectDayStats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$statsdefs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$stats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Day statistics collector. </p>
<p>$statsdefs has all the information to collect what data.</p>
<p>If parsed log time does not have an appropriate hour/min, then 12:00 is assumed.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000030">Todo:</a></b></dt><dd>How is it possible that Time does not have hour/min? Should have a module Time field processor as well?</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$statsdefs</td><td>Module stats section of $StatsConf. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$values</td><td>Log fields parsed by caller function. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$line</td><td>Current log line needed to search for keywords. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$stats</td><td>Statistics data set collected. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02164">2164</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2165</span>    {</div>
<div class="line"><span class="lineno"> 2166</span>        $re= <span class="stringliteral">&#39;/^(\d+):(\d+):(\d+)$/&#39;</span>;</div>
<div class="line"><span class="lineno"> 2167</span>        <span class="keywordflow">if</span> (preg_match($re, $values[<span class="stringliteral">&#39;Time&#39;</span>], $match)) {</div>
<div class="line"><span class="lineno"> 2168</span>            $hour= $match[1];</div>
<div class="line"><span class="lineno"> 2169</span>            $min= $match[2];</div>
<div class="line"><span class="lineno"> 2170</span>        }</div>
<div class="line"><span class="lineno"> 2171</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2172</span>            <span class="comment">// Should be unreachable</span></div>
<div class="line"><span class="lineno"> 2173</span>            $hour= <span class="stringliteral">&#39;12&#39;</span>;</div>
<div class="line"><span class="lineno"> 2174</span>            $min= <span class="stringliteral">&#39;00&#39;</span>;</div>
<div class="line"><span class="lineno"> 2175</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;There was no Time in log values, defaulting to 12:00&#39;</span>);</div>
<div class="line"><span class="lineno"> 2176</span>        }</div>
<div class="line"><span class="lineno"> 2177</span> </div>
<div class="line"><span class="lineno"> 2178</span>        $daystats= &amp;$stats[<span class="stringliteral">&#39;Date&#39;</span>][$values[<span class="stringliteral">&#39;Date&#39;</span>]];</div>
<div class="line"><span class="lineno"> 2179</span>        $this-&gt;<a class="code hl_function" href="classModel.html#a10ffb35c34bab2bd539a5a945a489625">IncStats</a>($line, $values, $statsdefs, $daystats);</div>
<div class="line"><span class="lineno"> 2180</span> </div>
<div class="line"><span class="lineno"> 2181</span>        $this-&gt;<a class="code hl_function" href="classModel.html#abe3e76f34ef7907cc5fcc6d2840bf081">CollectHourStats</a>($statsdefs, $hour, $min, $values, $line, $daystats);</div>
<div class="line"><span class="lineno"> 2182</span>    }</div>
<div class="ttc" id="aclassModel_html_a10ffb35c34bab2bd539a5a945a489625"><div class="ttname"><a href="classModel.html#a10ffb35c34bab2bd539a5a945a489625">Model\IncStats</a></div><div class="ttdeci">IncStats($line, $values, $statsdefs, &amp;$stats)</div><div class="ttdoc">Increments stats for the given values.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l02214">model.php:2214</a></div></div>
<div class="ttc" id="aclassModel_html_abe3e76f34ef7907cc5fcc6d2840bf081"><div class="ttname"><a href="classModel.html#abe3e76f34ef7907cc5fcc6d2840bf081">Model\CollectHourStats</a></div><div class="ttdeci">CollectHourStats($statsdefs, $hour, $min, $values, $line, &amp;$daystats)</div><div class="ttdoc">Hour statistics collector.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l02198">model.php:2198</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l02198">CollectHourStats()</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, and <a class="el" href="model_8php_source.html#l02214">IncStats()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01919">UpdateStats()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ac23e08bf49a305b2d76f11cecc62ba4c_cgraph.png" border="0" usemap="#aclassModel_ac23e08bf49a305b2d76f11cecc62ba4c_cgraph" alt=""/></div>
<map name="aclassModel_ac23e08bf49a305b2d76f11cecc62ba4c_cgraph" id="aclassModel_ac23e08bf49a305b2d76f11cecc62ba4c_cgraph">
<area shape="rect" title="Day statistics collector." alt="" coords="5,56,132,81"/>
<area shape="rect" href="classModel.html#abe3e76f34ef7907cc5fcc6d2840bf081" title="Hour statistics collector." alt="" coords="180,5,311,31"/>
<area shape="rect" href="classModel.html#a10ffb35c34bab2bd539a5a945a489625" title="Increments stats for the given values." alt="" coords="394,55,469,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="199,107,291,132"/>
<area shape="rect" href="classModel.html#a3b4ab5022e1e5883d5292c024eaaf8c1" title="Minute statistics collector." alt="" coords="359,5,504,31"/>
<area shape="rect" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09" title=" " alt="" coords="552,31,703,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ac23e08bf49a305b2d76f11cecc62ba4c_icgraph.png" border="0" usemap="#aclassModel_ac23e08bf49a305b2d76f11cecc62ba4c_icgraph" alt=""/></div>
<map name="aclassModel_ac23e08bf49a305b2d76f11cecc62ba4c_icgraph" id="aclassModel_ac23e08bf49a305b2d76f11cecc62ba4c_icgraph">
<area shape="rect" title="Day statistics collector." alt="" coords="455,55,581,80"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="304,55,407,80"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,29,243,55"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,79,256,104"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="abe3e76f34ef7907cc5fcc6d2840bf081" name="abe3e76f34ef7907cc5fcc6d2840bf081"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe3e76f34ef7907cc5fcc6d2840bf081">&#9670;&#160;</a></span>CollectHourStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CollectHourStats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$statsdefs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$hour</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$daystats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hour statistics collector. </p>
<p>$statsdefs has all the information to collect what data.</p>
<p>$daystats is the subsection of the main $stats array for the current date.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$statsdefs</td><td>Module stats section of $StatsConf. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$hour</td><td>Hour to collect stats for. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$min</td><td>Min to collect stats for, passed to CollectMinuteStats(). </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$values</td><td>Log fields parsed by caller function. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$line</td><td>Current log line needed to search for keywords. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$daystats</td><td>Statistics data set collected. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02198">2198</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2199</span>    {</div>
<div class="line"><span class="lineno"> 2200</span>        $hourstats= &amp;$daystats[<span class="stringliteral">&#39;Hours&#39;</span>][$hour];</div>
<div class="line"><span class="lineno"> 2201</span>        $this-&gt;IncStats($line, $values, $statsdefs, $hourstats);</div>
<div class="line"><span class="lineno"> 2202</span> </div>
<div class="line"><span class="lineno"> 2203</span>        $this-&gt;CollectMinuteStats($statsdefs, $min, $values, $line, $hourstats);</div>
<div class="line"><span class="lineno"> 2204</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l02274">CollectMinuteStats()</a>, and <a class="el" href="model_8php_source.html#l02214">IncStats()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02164">CollectDayStats()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_abe3e76f34ef7907cc5fcc6d2840bf081_cgraph.png" border="0" usemap="#aclassModel_abe3e76f34ef7907cc5fcc6d2840bf081_cgraph" alt=""/></div>
<map name="aclassModel_abe3e76f34ef7907cc5fcc6d2840bf081_cgraph" id="aclassModel_abe3e76f34ef7907cc5fcc6d2840bf081_cgraph">
<area shape="rect" title="Hour statistics collector." alt="" coords="5,31,136,56"/>
<area shape="rect" href="classModel.html#a3b4ab5022e1e5883d5292c024eaaf8c1" title="Minute statistics collector." alt="" coords="184,5,329,31"/>
<area shape="rect" href="classModel.html#a10ffb35c34bab2bd539a5a945a489625" title="Increments stats for the given values." alt="" coords="219,55,294,80"/>
<area shape="rect" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09" title=" " alt="" coords="377,31,528,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_abe3e76f34ef7907cc5fcc6d2840bf081_icgraph.png" border="0" usemap="#aclassModel_abe3e76f34ef7907cc5fcc6d2840bf081_icgraph" alt=""/></div>
<map name="aclassModel_abe3e76f34ef7907cc5fcc6d2840bf081_icgraph" id="aclassModel_abe3e76f34ef7907cc5fcc6d2840bf081_icgraph">
<area shape="rect" title="Hour statistics collector." alt="" coords="629,55,760,80"/>
<area shape="rect" href="classModel.html#ac23e08bf49a305b2d76f11cecc62ba4c" title="Day statistics collector." alt="" coords="455,55,581,80"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="304,55,407,80"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,29,243,55"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,79,256,104"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="a3b4ab5022e1e5883d5292c024eaaf8c1" name="a3b4ab5022e1e5883d5292c024eaaf8c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b4ab5022e1e5883d5292c024eaaf8c1">&#9670;&#160;</a></span>CollectMinuteStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CollectMinuteStats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$statsdefs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$hourstats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Minute statistics collector. </p>
<p>$statsdefs has all the information to collect what data.</p>
<p>$hourstats is the subsection of the $stats array for the current hour.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$statsdefs</td><td>Module stats section of $StatsConf. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$min</td><td>Min to collect stats for, passed to CollectMinuteStats(). </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$values</td><td>Log fields parsed by caller function. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$line</td><td>Current log line needed to search for keywords. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$hourstats</td><td>Statistics data set collected. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02274">2274</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2275</span>    {</div>
<div class="line"><span class="lineno"> 2276</span>        $minstats= &amp;$hourstats[<span class="stringliteral">&#39;Mins&#39;</span>][$min];</div>
<div class="line"><span class="lineno"> 2277</span>        <a class="code hl_function" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09">AddValueCreateKey</a>($minstats, <span class="stringliteral">&#39;Sum&#39;</span>, 1);</div>
<div class="line"><span class="lineno"> 2278</span> </div>
<div class="line"><span class="lineno"> 2279</span>        <span class="keywordflow">foreach</span> ($statsdefs as $stat =&gt; $statconf) {</div>
<div class="line"><span class="lineno"> 2280</span>            <span class="keywordflow">if</span> (isset($statconf[<span class="stringliteral">&#39;Counters&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2281</span>                <span class="keywordflow">foreach</span> ($statconf[<span class="stringliteral">&#39;Counters&#39;</span>] as $counter =&gt; $conf) {</div>
<div class="line"><span class="lineno"> 2282</span>                    <span class="keywordflow">if</span> (isset($values[$conf[<span class="stringliteral">&#39;Field&#39;</span>]])) {</div>
<div class="line"><span class="lineno"> 2283</span>                        <a class="code hl_function" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09">AddValueCreateKey</a>($minstats, $counter, $values[$conf[<span class="stringliteral">&#39;Field&#39;</span>]]);</div>
<div class="line"><span class="lineno"> 2284</span>                    }</div>
<div class="line"><span class="lineno"> 2285</span>                }</div>
<div class="line"><span class="lineno"> 2286</span>            }</div>
<div class="line"><span class="lineno"> 2287</span>        }</div>
<div class="line"><span class="lineno"> 2288</span> </div>
<div class="line"><span class="lineno"> 2289</span>        <span class="keywordflow">foreach</span> ($statsdefs as $stat =&gt; $conf) {</div>
<div class="line"><span class="lineno"> 2290</span>            <span class="keywordflow">if</span> (isset($conf[<span class="stringliteral">&#39;Needle&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2291</span>                <span class="keywordflow">if</span> (preg_match(<span class="charliteral">&#39;/&#39;</span>.$conf[<span class="stringliteral">&#39;Needle&#39;</span>].<span class="charliteral">&#39;/&#39;</span>, $line)) {</div>
<div class="line"><span class="lineno"> 2292</span>                    <a class="code hl_function" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09">AddValueCreateKey</a>($minstats, $stat, 1);</div>
<div class="line"><span class="lineno"> 2293</span>                }</div>
<div class="line"><span class="lineno"> 2294</span>            }</div>
<div class="line"><span class="lineno"> 2295</span>        }</div>
<div class="line"><span class="lineno"> 2296</span>    }</div>
<div class="ttc" id="alib_2lib_8php_html_ad33cadb8e288ea78e94fd94045f91e09"><div class="ttname"><a href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09">AddValueCreateKey</a></div><div class="ttdeci">AddValueCreateKey(&amp;$data, $name, $value)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2lib_8php_source.html#l00096">lib.php:96</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="lib_2lib_8php_source.html#l00096">AddValueCreateKey()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02198">CollectHourStats()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a3b4ab5022e1e5883d5292c024eaaf8c1_cgraph.png" border="0" usemap="#aclassModel_a3b4ab5022e1e5883d5292c024eaaf8c1_cgraph" alt=""/></div>
<map name="aclassModel_a3b4ab5022e1e5883d5292c024eaaf8c1_cgraph" id="aclassModel_a3b4ab5022e1e5883d5292c024eaaf8c1_cgraph">
<area shape="rect" title="Minute statistics collector." alt="" coords="5,5,151,31"/>
<area shape="rect" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09" title=" " alt="" coords="199,5,349,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a3b4ab5022e1e5883d5292c024eaaf8c1_icgraph.png" border="0" usemap="#aclassModel_a3b4ab5022e1e5883d5292c024eaaf8c1_icgraph" alt=""/></div>
<map name="aclassModel_a3b4ab5022e1e5883d5292c024eaaf8c1_icgraph" id="aclassModel_a3b4ab5022e1e5883d5292c024eaaf8c1_icgraph">
<area shape="rect" title="Minute statistics collector." alt="" coords="808,55,953,80"/>
<area shape="rect" href="classModel.html#abe3e76f34ef7907cc5fcc6d2840bf081" title="Hour statistics collector." alt="" coords="629,55,760,80"/>
<area shape="rect" href="classModel.html#ac23e08bf49a305b2d76f11cecc62ba4c" title="Day statistics collector." alt="" coords="455,55,581,80"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="304,55,407,80"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,29,243,55"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,79,256,104"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="a5cdc13ae8497b92e1c6cbf8b85c6d43c" name="a5cdc13ae8497b92e1c6cbf8b85c6d43c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cdc13ae8497b92e1c6cbf8b85c6d43c">&#9670;&#160;</a></span>CopyLogFileToTmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CopyLogFileToTmp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$tmpdir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Uncompresses gzipped log file to tmp dir. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Log file. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$tmpdir</td><td>Tmp folder to copy to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01654">1654</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1655</span>    {</div>
<div class="line"><span class="lineno"> 1656</span>        <span class="keywordflow">if</span> (!$this-&gt;ValidateFile($file)) {</div>
<div class="line"><span class="lineno"> 1657</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1658</span>        }</div>
<div class="line"><span class="lineno"> 1659</span> </div>
<div class="line"><span class="lineno"> 1660</span>        <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= 0;</div>
<div class="line"><span class="lineno"> 1661</span>        <span class="keywordflow">if</span> (!file_exists($tmpdir)) {</div>
<div class="line"><span class="lineno"> 1662</span>            exec(<span class="stringliteral">&quot;/bin/mkdir -p $tmpdir 2&gt;&amp;1&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno"> 1663</span>        }</div>
<div class="line"><span class="lineno"> 1664</span> </div>
<div class="line"><span class="lineno"> 1665</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno"> 1666</span>            exec(<span class="stringliteral">&quot;/bin/cp $file $tmpdir 2&gt;&amp;1&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno"> 1667</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno"> 1668</span>                $tmpfile= $tmpdir.basename($file);</div>
<div class="line"><span class="lineno"> 1669</span>                <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/(.*)\.gz$/&#39;</span>, $tmpfile, $match)) {</div>
<div class="line"><span class="lineno"> 1670</span>                    <span class="comment">// Delete the old uncompressed file, otherwise gunzip fails</span></div>
<div class="line"><span class="lineno"> 1671</span>                    $this-&gt;<a class="code hl_function" href="classModel.html#a620707dcc4093d4ca002e3dfdfa68af1">DeleteFile</a>($match[1]);</div>
<div class="line"><span class="lineno"> 1672</span>                    </div>
<div class="line"><span class="lineno"> 1673</span>                    exec(<span class="stringliteral">&quot;/usr/bin/gunzip $tmpfile 2&gt;&amp;1&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno"> 1674</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno"> 1675</span>                        <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 1676</span>                    }</div>
<div class="line"><span class="lineno"> 1677</span>                    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1678</span>                        <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;gunzip failed: &#39;</span>.$tmpdir.basename($file));</div>
<div class="line"><span class="lineno"> 1679</span>                    }</div>
<div class="line"><span class="lineno"> 1680</span>                }</div>
<div class="line"><span class="lineno"> 1681</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1682</span>                    <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 1683</span>                }</div>
<div class="line"><span class="lineno"> 1684</span>            }</div>
<div class="line"><span class="lineno"> 1685</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1686</span>                <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;cp failed: &#39;</span>.$file);</div>
<div class="line"><span class="lineno"> 1687</span>            }</div>
<div class="line"><span class="lineno"> 1688</span>        }</div>
<div class="line"><span class="lineno"> 1689</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1690</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;mkdir failed: &#39;</span>.$tmpdir);</div>
<div class="line"><span class="lineno"> 1691</span>        }</div>
<div class="line"><span class="lineno"> 1692</span> </div>
<div class="line"><span class="lineno"> 1693</span>        <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>(implode(<span class="stringliteral">&quot;\n&quot;</span>, $output));</div>
<div class="line"><span class="lineno"> 1694</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1695</span>    }</div>
<div class="ttc" id="aModel_2include_8php_html_a5afab85a7aaf19395f9a0e86cae76928"><div class="ttname"><a href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a></div><div class="ttdeci">Error($msg)</div><div class="ttdoc">Sets or updates $Error with the given message.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00131">include.php:131</a></div></div>
<div class="ttc" id="aclassModel_html_a620707dcc4093d4ca002e3dfdfa68af1"><div class="ttname"><a href="classModel.html#a620707dcc4093d4ca002e3dfdfa68af1">Model\DeleteFile</a></div><div class="ttdeci">DeleteFile($path)</div><div class="ttdoc">Deletes the given file or directory.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l00836">model.php:836</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="model_8php_source.html#l00836">DeleteFile()</a>, <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>, and <a class="el" href="model_8php_source.html#l01838">ValidateFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01144">UpdateTmpLogFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a5cdc13ae8497b92e1c6cbf8b85c6d43c_cgraph.png" border="0" usemap="#aclassModel_a5cdc13ae8497b92e1c6cbf8b85c6d43c_cgraph" alt=""/></div>
<map name="aclassModel_a5cdc13ae8497b92e1c6cbf8b85c6d43c_cgraph" id="aclassModel_a5cdc13ae8497b92e1c6cbf8b85c6d43c_cgraph">
<area shape="rect" title="Uncompresses gzipped log file to tmp dir." alt="" coords="5,81,149,107"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="367,5,459,31"/>
<area shape="rect" href="classModel.html#a620707dcc4093d4ca002e3dfdfa68af1" title="Deletes the given file or directory." alt="" coords="203,56,291,81"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="529,132,583,157"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="197,157,296,183"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="344,208,481,233"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a5cdc13ae8497b92e1c6cbf8b85c6d43c_icgraph.png" border="0" usemap="#aclassModel_a5cdc13ae8497b92e1c6cbf8b85c6d43c_icgraph" alt=""/></div>
<map name="aclassModel_a5cdc13ae8497b92e1c6cbf8b85c6d43c_icgraph" id="aclassModel_a5cdc13ae8497b92e1c6cbf8b85c6d43c_icgraph">
<area shape="rect" title="Uncompresses gzipped log file to tmp dir." alt="" coords="496,55,640,80"/>
<area shape="rect" href="classModel.html#ad4d7aefbd214d3da3f1965e6ddddb998" title="Copies the original log file to tmp folder." alt="" coords="304,55,448,80"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,29,243,55"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,79,256,104"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="ab1e8cbbabce3210438cebad028f153d7" name="ab1e8cbbabce3210438cebad028f153d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1e8cbbabce3210438cebad028f153d7">&#9670;&#160;</a></span>CountDiffLogLines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CountDiffLogLines </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the number of lines added to log files since last tmp file update. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$logfile</td><td>Log file pathname. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$count</td><td>Number of new log lines. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01873">1873</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1874</span>    {</div>
<div class="line"><span class="lineno"> 1875</span>        global <a class="code hl_variable" href="defs_8php.html#acaae7b246b0fd77ae6400fa4868a593b">$StatsConf</a>;</div>
<div class="line"><span class="lineno"> 1876</span> </div>
<div class="line"><span class="lineno"> 1877</span>        $count= -1;</div>
<div class="line"><span class="lineno"> 1878</span> </div>
<div class="line"><span class="lineno"> 1879</span>        <span class="keywordflow">if</span> ($this-&gt;GetStatsFileInfo($logfile, $oldlinecount, $oldfilestat)) {</div>
<div class="line"><span class="lineno"> 1880</span>            $needle= <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1881</span>            $statsdefs= <a class="code hl_variable" href="defs_8php.html#acaae7b246b0fd77ae6400fa4868a593b">$StatsConf</a>[$this-&gt;Name];</div>
<div class="line"><span class="lineno"> 1882</span>            <span class="keywordflow">if</span> (isset($statsdefs) &amp;&amp; isset($statsdefs[<span class="stringliteral">&#39;Total&#39;</span>][<span class="stringliteral">&#39;Needle&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1883</span>                $needle= $statsdefs[<span class="stringliteral">&#39;Total&#39;</span>][<span class="stringliteral">&#39;Needle&#39;</span>];</div>
<div class="line"><span class="lineno"> 1884</span>            }</div>
<div class="line"><span class="lineno"> 1885</span> </div>
<div class="line"><span class="lineno"> 1886</span>            $newlinecount= $this-&gt;_getFileLineCount($logfile, $needle);</div>
<div class="line"><span class="lineno"> 1887</span>            <span class="keywordflow">if</span> ($newlinecount === FALSE) {</div>
<div class="line"><span class="lineno"> 1888</span>                <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1889</span>            }</div>
<div class="line"><span class="lineno"> 1890</span> </div>
<div class="line"><span class="lineno"> 1891</span>            $origfile= $this-&gt;<a class="code hl_function" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7">GetOrigFileName</a>($logfile);</div>
<div class="line"><span class="lineno"> 1892</span> </div>
<div class="line"><span class="lineno"> 1893</span>            <span class="keywordflow">if</span> (($newlinecount &gt;= $oldlinecount) &amp;&amp; !preg_match(<span class="stringliteral">&#39;/\.gz$/&#39;</span>, $origfile)) {</div>
<div class="line"><span class="lineno"> 1894</span>                <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Logfile modified: $logfile, linecount $oldlinecount-&gt;$newlinecount&quot;</span>);</div>
<div class="line"><span class="lineno"> 1895</span> </div>
<div class="line"><span class="lineno"> 1896</span>                $count= $newlinecount - $oldlinecount;</div>
<div class="line"><span class="lineno"> 1897</span>                <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Logfile has grown by $count lines: $logfile&quot;</span>);</div>
<div class="line"><span class="lineno"> 1898</span>                <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 1899</span>            }</div>
<div class="line"><span class="lineno"> 1900</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1901</span>                <span class="comment">// Logs probably rotated, recollect the stats</span></div>
<div class="line"><span class="lineno"> 1902</span>                <span class="comment">// Also stats for compressed files are always recollected on rotation, otherwise stats would be merged with the old stats</span></div>
<div class="line"><span class="lineno"> 1903</span>                <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Assuming log file rotation: $logfile&quot;</span>);</div>
<div class="line"><span class="lineno"> 1904</span>            }</div>
<div class="line"><span class="lineno"> 1905</span>        }</div>
<div class="line"><span class="lineno"> 1906</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1907</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Cannot get file info: $logfile&quot;</span>);</div>
<div class="line"><span class="lineno"> 1908</span>        }</div>
<div class="line"><span class="lineno"> 1909</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1910</span>    }</div>
<div class="ttc" id="aclassModel_html_adf44e19a68f4a6be9289e2e39a5698f7"><div class="ttname"><a href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7">Model\GetOrigFileName</a></div><div class="ttdeci">GetOrigFileName($logfile)</div><div class="ttdoc">Gets the original file name for the given log file.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l01594">model.php:1594</a></div></div>
<div class="ttc" id="adefs_8php_html_acaae7b246b0fd77ae6400fa4868a593b"><div class="ttname"><a href="defs_8php.html#acaae7b246b0fd77ae6400fa4868a593b">$StatsConf</a></div><div class="ttdeci">$StatsConf</div><div class="ttdoc">Master statistics configuration.</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00202">defs.php:202</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="defs_8php_source.html#l00202">$StatsConf</a>, <a class="el" href="model_8php_source.html#l01279">_getFileLineCount()</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="model_8php_source.html#l01594">GetOrigFileName()</a>, and <a class="el" href="model_8php_source.html#l02063">GetStatsFileInfo()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01919">UpdateStats()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ab1e8cbbabce3210438cebad028f153d7_cgraph.png" border="0" usemap="#aclassModel_ab1e8cbbabce3210438cebad028f153d7_cgraph" alt=""/></div>
<map name="aclassModel_ab1e8cbbabce3210438cebad028f153d7_cgraph" id="aclassModel_ab1e8cbbabce3210438cebad028f153d7_cgraph">
<area shape="rect" title="Gets the number of lines added to log files since last tmp file update." alt="" coords="5,177,145,203"/>
<area shape="rect" href="classModel.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="193,79,332,104"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="423,203,515,228"/>
<area shape="rect" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7" title="Gets the original file name for the given log file." alt="" coords="607,179,741,204"/>
<area shape="rect" href="classModel.html#a2ef1e4c1d1fadd3c6696a101cd2aa7e5" title="Gets previous line count and stat() from statistics file." alt="" coords="199,152,326,177"/>
<area shape="rect" href="classModel.html#a3827d539c75623fd5345ab590caaa2cb" title="Generates the module specific datetime regexp for filtering logs." alt="" coords="380,5,557,31"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="395,104,542,129"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="419,55,518,80"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="791,55,844,80"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="605,80,743,105"/>
<area shape="rect" href="classModel.html#ae24c34977ae6864272b678fe40fdb09a" title="Gets name of the tmp statistics file for the given log file." alt="" coords="399,153,539,179"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ab1e8cbbabce3210438cebad028f153d7_icgraph.png" border="0" usemap="#aclassModel_ab1e8cbbabce3210438cebad028f153d7_icgraph" alt=""/></div>
<map name="aclassModel_ab1e8cbbabce3210438cebad028f153d7_icgraph" id="aclassModel_ab1e8cbbabce3210438cebad028f153d7_icgraph">
<area shape="rect" title="Gets the number of lines added to log files since last tmp file update." alt="" coords="455,55,595,80"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="304,55,407,80"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,29,243,55"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,79,256,104"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="a2d296f9267d193d0b2295d611dcbea6c" name="a2d296f9267d193d0b2295d611dcbea6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d296f9267d193d0b2295d611dcbea6c">&#9670;&#160;</a></span>CreateUser()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CreateUser </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$passwd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$uid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a system user. </p>
<p>Note that passwords are double encrypted.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$user</td><td>User name. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$passwd</td><td>SHA encrypted password. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$uid</td><td>User id. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00536">536</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  537</span>    {</div>
<div class="line"><span class="lineno">  538</span>        exec(<span class="stringliteral">&quot;/bin/cat /etc/master.passwd | /usr/bin/grep -E &#39;^$user:&#39; 2&gt;&amp;1&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>        <span class="comment">// If the user does not exist</span></div>
<div class="line"><span class="lineno">  541</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> !== 0 &amp;&amp; count($output) == 0) {</div>
<div class="line"><span class="lineno">  542</span>            $uline= <span class="stringliteral">&quot;$user:$(/usr/bin/encrypt $passwd):$uid:$uid::0:0:PFFW $user:/var/empty:/var/www/htdocs/pffw/Controller/sh.php&quot;</span>;</div>
<div class="line"><span class="lineno">  543</span>            exec(<span class="stringliteral">&quot;/bin/echo $uline &gt;&gt;/etc/master.passwd 2&gt;&amp;1&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno">  546</span>                $gline= <span class="stringliteral">&quot;$user:*:$uid:&quot;</span>;</div>
<div class="line"><span class="lineno">  547</span>                exec(<span class="stringliteral">&quot;/bin/echo $gline &gt;&gt;/etc/group 2&gt;&amp;1&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno">  550</span>                    exec(<span class="stringliteral">&quot;/usr/sbin/pwd_mkdb -p /etc/master.passwd 2&gt;&amp;1&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno">  551</span>                    <span class="keywordflow">return</span> <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0;</div>
<div class="line"><span class="lineno">  552</span>                }</div>
<div class="line"><span class="lineno">  553</span>            }</div>
<div class="line"><span class="lineno">  554</span>        }</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>        $errout= implode(<span class="stringliteral">&quot;\n&quot;</span>, $output);</div>
<div class="line"><span class="lineno">  557</span>        <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>($errout);</div>
<div class="line"><span class="lineno">  558</span>        <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Create user failed: $errout&quot;</span>);</div>
<div class="line"><span class="lineno">  559</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  560</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, and <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a2d296f9267d193d0b2295d611dcbea6c_cgraph.png" border="0" usemap="#aclassModel_a2d296f9267d193d0b2295d611dcbea6c_cgraph" alt=""/></div>
<map name="aclassModel_a2d296f9267d193d0b2295d611dcbea6c_cgraph" id="aclassModel_a2d296f9267d193d0b2295d611dcbea6c_cgraph">
<area shape="rect" title="Creates a system user." alt="" coords="5,31,100,56"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="148,5,240,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="167,55,221,80"/>
</map>
</div>

</div>
</div>
<a id="a620707dcc4093d4ca002e3dfdfa68af1" name="a620707dcc4093d4ca002e3dfdfa68af1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a620707dcc4093d4ca002e3dfdfa68af1">&#9670;&#160;</a></span>DeleteFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DeleteFile </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deletes the given file or directory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td>File or dir to delete. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00836">836</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  837</span>    {</div>
<div class="line"><span class="lineno">  838</span>        <span class="keywordflow">if</span> (file_exists($path)) {</div>
<div class="line"><span class="lineno">  839</span>            exec(<span class="stringliteral">&quot;/bin/rm -rf $path 2&gt;&amp;1&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno">  840</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno">  841</span>                <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  842</span>            }</div>
<div class="line"><span class="lineno">  843</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  844</span>                $errout= implode(<span class="stringliteral">&quot;\n&quot;</span>, $output);</div>
<div class="line"><span class="lineno">  845</span>                <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>($errout);</div>
<div class="line"><span class="lineno">  846</span>                <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Failed deleting: $path, $errout&quot;</span>);</div>
<div class="line"><span class="lineno">  847</span>            }</div>
<div class="line"><span class="lineno">  848</span>        }</div>
<div class="line"><span class="lineno">  849</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  850</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;File path does not exist: $path&quot;</span>);</div>
<div class="line"><span class="lineno">  851</span>        }</div>
<div class="line"><span class="lineno">  852</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  853</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, and <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01654">CopyLogFileToTmp()</a>, <a class="el" href="Model_2system_8php_source.html#l00801">System\DeleteIf()</a>, and <a class="el" href="Model_2system_8php_source.html#l00706">System\SystemMakeDynamicGateway()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a620707dcc4093d4ca002e3dfdfa68af1_cgraph.png" border="0" usemap="#aclassModel_a620707dcc4093d4ca002e3dfdfa68af1_cgraph" alt=""/></div>
<map name="aclassModel_a620707dcc4093d4ca002e3dfdfa68af1_cgraph" id="aclassModel_a620707dcc4093d4ca002e3dfdfa68af1_cgraph">
<area shape="rect" title="Deletes the given file or directory." alt="" coords="5,31,93,56"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="141,5,233,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="161,55,214,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a620707dcc4093d4ca002e3dfdfa68af1_icgraph.png" border="0" usemap="#aclassModel_a620707dcc4093d4ca002e3dfdfa68af1_icgraph" alt=""/></div>
<map name="aclassModel_a620707dcc4093d4ca002e3dfdfa68af1_icgraph" id="aclassModel_a620707dcc4093d4ca002e3dfdfa68af1_icgraph">
<area shape="rect" title="Deletes the given file or directory." alt="" coords="761,105,849,131"/>
<area shape="rect" href="classModel.html#a5cdc13ae8497b92e1c6cbf8b85c6d43c" title="Uncompresses gzipped log file to tmp dir." alt="" coords="533,56,677,81"/>
<area shape="rect" href="classSystem.html#abb4eb7780d65c831b01cd1eab2d118ab" title="Deconfigures an interface by deleting its hostname file." alt="" coords="541,105,668,131"/>
<area shape="rect" href="classSystem.html#a6f642ec1c473f0c2e671baaa1a53e279" title="Converts static gateway address to dynamic address." alt="" coords="496,155,713,195"/>
<area shape="rect" href="classModel.html#ad4d7aefbd214d3da3f1965e6ddddb998" title="Copies the original log file to tmp folder." alt="" coords="304,56,448,81"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,31,243,56"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,80,256,105"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="a45811aad99c24bbd1afd2c51d6aaac37" name="a45811aad99c24bbd1afd2c51d6aaac37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45811aad99c24bbd1afd2c51d6aaac37">&#9670;&#160;</a></span>DisableConf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DisableConf </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disables a configuration item in conf file. </p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02508">2508</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2509</span>    {</div>
<div class="line"><span class="lineno"> 2510</span>        $file= $this-&gt;GetConfFile($conf, $group);</div>
<div class="line"><span class="lineno"> 2511</span> </div>
<div class="line"><span class="lineno"> 2512</span>        $this-&gt;SetConfig($conf);</div>
<div class="line"><span class="lineno"> 2513</span>        <span class="keywordflow">if</span> ((isset($this-&gt;Config[$name][<span class="stringliteral">&#39;type&#39;</span>])) &amp;&amp; ($this-&gt;Config[$name][<span class="stringliteral">&#39;type&#39;</span>] === FALSE)) {</div>
<div class="line"><span class="lineno"> 2514</span>            <span class="keywordflow">return</span> $this-&gt;DisableName($file, $name);</div>
<div class="line"><span class="lineno"> 2515</span>        }</div>
<div class="line"><span class="lineno"> 2516</span>        <span class="keywordflow">return</span> $this-&gt;DisableNVP($file, $name, $this-&gt;GetConfValueType($name));</div>
<div class="line"><span class="lineno"> 2517</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l02553">DisableName()</a>, <a class="el" href="model_8php_source.html#l02544">DisableNVP()</a>, <a class="el" href="model_8php_source.html#l02568">GetConfFile()</a>, <a class="el" href="model_8php_source.html#l02474">GetConfValueType()</a>, and <a class="el" href="model_8php_source.html#l02581">SetConfig()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a45811aad99c24bbd1afd2c51d6aaac37_cgraph.png" border="0" usemap="#aclassModel_a45811aad99c24bbd1afd2c51d6aaac37_cgraph" alt=""/></div>
<map name="aclassModel_a45811aad99c24bbd1afd2c51d6aaac37_cgraph" id="aclassModel_a45811aad99c24bbd1afd2c51d6aaac37_cgraph">
<area shape="rect" title="Disables a configuration item in conf file." alt="" coords="5,104,107,129"/>
<area shape="rect" href="classModel.html#a997af94797f7368e6f273a6f9f63d8a8" title="Disables a Name." alt="" coords="170,5,281,31"/>
<area shape="rect" href="classModel.html#a05257350a817e0a8da3dfaa868c623b1" title="Disables an NVP." alt="" coords="176,55,275,80"/>
<area shape="rect" href="classModel.html#ae08f1955abf4f7b5ca00ec1fec76041f" title="Returns configuration file of the module." alt="" coords="176,104,275,129"/>
<area shape="rect" href="classModel.html#a3d6c4b92ec14b5133d20ce287ef720ca" title=" " alt="" coords="155,153,296,179"/>
<area shape="rect" href="classModel.html#a63e6c944f6d63934ee3f05c24bc3e122" title="Sets configuration file based on config type provided." alt="" coords="183,203,267,228"/>
<area shape="rect" href="classModel.html#aa97184370ce56f1abd12ae18ddbf2c40" title="Searches a needle and replaces with a value in the given file." alt="" coords="344,31,467,56"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="515,31,607,56"/>
</map>
</div>

</div>
</div>
<a id="a997af94797f7368e6f273a6f9f63d8a8" name="a997af94797f7368e6f273a6f9f63d8a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a997af94797f7368e6f273a6f9f63d8a8">&#9670;&#160;</a></span>DisableName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DisableName </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disables a Name. </p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02553">2553</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2554</span>    {</div>
<div class="line"><span class="lineno"> 2555</span>        <span class="keywordflow">return</span> $this-&gt;ReplaceRegexp($file, <span class="stringliteral">&quot;/^(\h*$name(\h*$this-&gt;COMC.*|\h*))$/m&quot;</span>, $this-&gt;COMC.<span class="stringliteral">&#39;${1}&#39;</span>);</div>
<div class="line"><span class="lineno"> 2556</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00968">ReplaceRegexp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02508">DisableConf()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a997af94797f7368e6f273a6f9f63d8a8_cgraph.png" border="0" usemap="#aclassModel_a997af94797f7368e6f273a6f9f63d8a8_cgraph" alt=""/></div>
<map name="aclassModel_a997af94797f7368e6f273a6f9f63d8a8_cgraph" id="aclassModel_a997af94797f7368e6f273a6f9f63d8a8_cgraph">
<area shape="rect" title="Disables a Name." alt="" coords="5,5,116,31"/>
<area shape="rect" href="classModel.html#aa97184370ce56f1abd12ae18ddbf2c40" title="Searches a needle and replaces with a value in the given file." alt="" coords="164,5,287,31"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="335,5,427,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a997af94797f7368e6f273a6f9f63d8a8_icgraph.png" border="0" usemap="#aclassModel_a997af94797f7368e6f273a6f9f63d8a8_icgraph" alt=""/></div>
<map name="aclassModel_a997af94797f7368e6f273a6f9f63d8a8_icgraph" id="aclassModel_a997af94797f7368e6f273a6f9f63d8a8_icgraph">
<area shape="rect" title="Disables a Name." alt="" coords="155,5,265,31"/>
<area shape="rect" href="classModel.html#a45811aad99c24bbd1afd2c51d6aaac37" title="Disables a configuration item in conf file." alt="" coords="5,5,107,31"/>
</map>
</div>

</div>
</div>
<a id="a05257350a817e0a8da3dfaa868c623b1" name="a05257350a817e0a8da3dfaa868c623b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05257350a817e0a8da3dfaa868c623b1">&#9670;&#160;</a></span>DisableNVP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DisableNVP </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disables an NVP. </p>
<dl class="section attention"><dt>Attention</dt><dd>Value may be empty, so we allow for empty values with the re ($type|), while disabling</dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02544">2544</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2545</span>    {</div>
<div class="line"><span class="lineno"> 2547</span>        <span class="keywordflow">return</span> $this-&gt;ReplaceRegexp($file, <span class="stringliteral">&quot;/^(\h*$name\b\s*$this-&gt;NVPS\s*($type|))$/m&quot;</span>, $this-&gt;COMC.<span class="stringliteral">&#39;${1}&#39;</span>);</div>
<div class="line"><span class="lineno"> 2548</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00968">ReplaceRegexp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02508">DisableConf()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a05257350a817e0a8da3dfaa868c623b1_cgraph.png" border="0" usemap="#aclassModel_a05257350a817e0a8da3dfaa868c623b1_cgraph" alt=""/></div>
<map name="aclassModel_a05257350a817e0a8da3dfaa868c623b1_cgraph" id="aclassModel_a05257350a817e0a8da3dfaa868c623b1_cgraph">
<area shape="rect" title="Disables an NVP." alt="" coords="5,5,104,31"/>
<area shape="rect" href="classModel.html#aa97184370ce56f1abd12ae18ddbf2c40" title="Searches a needle and replaces with a value in the given file." alt="" coords="152,5,275,31"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="323,5,415,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a05257350a817e0a8da3dfaa868c623b1_icgraph.png" border="0" usemap="#aclassModel_a05257350a817e0a8da3dfaa868c623b1_icgraph" alt=""/></div>
<map name="aclassModel_a05257350a817e0a8da3dfaa868c623b1_icgraph" id="aclassModel_a05257350a817e0a8da3dfaa868c623b1_icgraph">
<area shape="rect" title="Disables an NVP." alt="" coords="155,5,253,31"/>
<area shape="rect" href="classModel.html#a45811aad99c24bbd1afd2c51d6aaac37" title="Disables a configuration item in conf file." alt="" coords="5,5,107,31"/>
</map>
</div>

</div>
</div>
<a id="a6abe8763d4525946e15e0d9784d500b8" name="a6abe8763d4525946e15e0d9784d500b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6abe8763d4525946e15e0d9784d500b8">&#9670;&#160;</a></span>EnableConf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EnableConf </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables a configuration item in conf file. </p>
<p>Certain modules have multiple configuration files, hence they override this method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$name</td><td>Config name </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$conf</td><td>Config type </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$group</td><td>E2guardian group </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02494">2494</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2495</span>    {</div>
<div class="line"><span class="lineno"> 2496</span>        $file= $this-&gt;GetConfFile($conf, $group);</div>
<div class="line"><span class="lineno"> 2497</span> </div>
<div class="line"><span class="lineno"> 2498</span>        $this-&gt;SetConfig($conf);</div>
<div class="line"><span class="lineno"> 2499</span>        <span class="keywordflow">if</span> ((isset($this-&gt;Config[$name][<span class="stringliteral">&#39;type&#39;</span>])) &amp;&amp; ($this-&gt;Config[$name][<span class="stringliteral">&#39;type&#39;</span>] === FALSE)) {</div>
<div class="line"><span class="lineno"> 2500</span>            <span class="keywordflow">return</span> $this-&gt;EnableName($file, $name);</div>
<div class="line"><span class="lineno"> 2501</span>        }</div>
<div class="line"><span class="lineno"> 2502</span>        <span class="keywordflow">return</span> $this-&gt;EnableNVP($file, $name, $this-&gt;GetConfValueType($name));</div>
<div class="line"><span class="lineno"> 2503</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l02536">EnableName()</a>, <a class="el" href="model_8php_source.html#l02527">EnableNVP()</a>, <a class="el" href="model_8php_source.html#l02568">GetConfFile()</a>, <a class="el" href="model_8php_source.html#l02474">GetConfValueType()</a>, and <a class="el" href="model_8php_source.html#l02581">SetConfig()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a6abe8763d4525946e15e0d9784d500b8_cgraph.png" border="0" usemap="#aclassModel_a6abe8763d4525946e15e0d9784d500b8_cgraph" alt=""/></div>
<map name="aclassModel_a6abe8763d4525946e15e0d9784d500b8_cgraph" id="aclassModel_a6abe8763d4525946e15e0d9784d500b8_cgraph">
<area shape="rect" title="Enables a configuration item in conf file." alt="" coords="5,104,101,129"/>
<area shape="rect" href="classModel.html#a65410624e4cac2f3429147c621873382" title="Enables a Name: configuration item without value." alt="" coords="167,5,273,31"/>
<area shape="rect" href="classModel.html#af8a29b93534e66eb054051710d774895" title="Enables an NVP configuration item with value." alt="" coords="173,55,267,80"/>
<area shape="rect" href="classModel.html#ae08f1955abf4f7b5ca00ec1fec76041f" title="Returns configuration file of the module." alt="" coords="171,104,269,129"/>
<area shape="rect" href="classModel.html#a3d6c4b92ec14b5133d20ce287ef720ca" title=" " alt="" coords="149,153,291,179"/>
<area shape="rect" href="classModel.html#a63e6c944f6d63934ee3f05c24bc3e122" title="Sets configuration file based on config type provided." alt="" coords="178,203,262,228"/>
<area shape="rect" href="classModel.html#aa97184370ce56f1abd12ae18ddbf2c40" title="Searches a needle and replaces with a value in the given file." alt="" coords="339,31,461,56"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="509,31,601,56"/>
</map>
</div>

</div>
</div>
<a id="a65410624e4cac2f3429147c621873382" name="a65410624e4cac2f3429147c621873382"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65410624e4cac2f3429147c621873382">&#9670;&#160;</a></span>EnableName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EnableName </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables a Name: configuration item without value. </p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02536">2536</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2537</span>    {</div>
<div class="line"><span class="lineno"> 2538</span>        <span class="keywordflow">return</span> $this-&gt;ReplaceRegexp($file, <span class="stringliteral">&quot;/^\h*$this-&gt;COMC(\h*$name(\h*$this-&gt;COMC.*|\h*))$/m&quot;</span>, <span class="stringliteral">&#39;${1}&#39;</span>);</div>
<div class="line"><span class="lineno"> 2539</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00968">ReplaceRegexp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02494">EnableConf()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a65410624e4cac2f3429147c621873382_cgraph.png" border="0" usemap="#aclassModel_a65410624e4cac2f3429147c621873382_cgraph" alt=""/></div>
<map name="aclassModel_a65410624e4cac2f3429147c621873382_cgraph" id="aclassModel_a65410624e4cac2f3429147c621873382_cgraph">
<area shape="rect" title="Enables a Name: configuration item without value." alt="" coords="5,5,111,31"/>
<area shape="rect" href="classModel.html#aa97184370ce56f1abd12ae18ddbf2c40" title="Searches a needle and replaces with a value in the given file." alt="" coords="159,5,281,31"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="329,5,421,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a65410624e4cac2f3429147c621873382_icgraph.png" border="0" usemap="#aclassModel_a65410624e4cac2f3429147c621873382_icgraph" alt=""/></div>
<map name="aclassModel_a65410624e4cac2f3429147c621873382_icgraph" id="aclassModel_a65410624e4cac2f3429147c621873382_icgraph">
<area shape="rect" title="Enables a Name: configuration item without value." alt="" coords="149,5,255,31"/>
<area shape="rect" href="classModel.html#a6abe8763d4525946e15e0d9784d500b8" title="Enables a configuration item in conf file." alt="" coords="5,5,101,31"/>
</map>
</div>

</div>
</div>
<a id="af8a29b93534e66eb054051710d774895" name="af8a29b93534e66eb054051710d774895"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8a29b93534e66eb054051710d774895">&#9670;&#160;</a></span>EnableNVP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EnableNVP </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables an NVP configuration item with value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Config file </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$name</td><td>Config name </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$type</td><td>Type regexp of value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>Value may be empty, so we allow for empty values with the re ($type|), while enabling</dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02527">2527</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2528</span>    {</div>
<div class="line"><span class="lineno"> 2530</span>        <span class="keywordflow">return</span> $this-&gt;ReplaceRegexp($file, <span class="stringliteral">&quot;/^\h*$this-&gt;COMC(\s*$name\b\s*$this-&gt;NVPS\s*($type|))$/m&quot;</span>, <span class="stringliteral">&#39;${1}&#39;</span>);</div>
<div class="line"><span class="lineno"> 2531</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00968">ReplaceRegexp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02494">EnableConf()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_af8a29b93534e66eb054051710d774895_cgraph.png" border="0" usemap="#aclassModel_af8a29b93534e66eb054051710d774895_cgraph" alt=""/></div>
<map name="aclassModel_af8a29b93534e66eb054051710d774895_cgraph" id="aclassModel_af8a29b93534e66eb054051710d774895_cgraph">
<area shape="rect" title="Enables an NVP configuration item with value." alt="" coords="5,5,99,31"/>
<area shape="rect" href="classModel.html#aa97184370ce56f1abd12ae18ddbf2c40" title="Searches a needle and replaces with a value in the given file." alt="" coords="147,5,269,31"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="317,5,409,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_af8a29b93534e66eb054051710d774895_icgraph.png" border="0" usemap="#aclassModel_af8a29b93534e66eb054051710d774895_icgraph" alt=""/></div>
<map name="aclassModel_af8a29b93534e66eb054051710d774895_icgraph" id="aclassModel_af8a29b93534e66eb054051710d774895_icgraph">
<area shape="rect" title="Enables an NVP configuration item with value." alt="" coords="149,5,243,31"/>
<area shape="rect" href="classModel.html#a6abe8763d4525946e15e0d9784d500b8" title="Enables a configuration item in conf file." alt="" coords="5,5,101,31"/>
</map>
</div>

</div>
</div>
<a id="a3827d539c75623fd5345ab590caaa2cb" name="a3827d539c75623fd5345ab590caaa2cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3827d539c75623fd5345ab590caaa2cb">&#9670;&#160;</a></span>formatDateHourRegexp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">formatDateHourRegexp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$month</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$hour</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$minute</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates the module specific datetime regexp for filtering logs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$month</td><td>Two-digit month, or empty string for match all. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$day</td><td>Two-digit day, or empty string for match all. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$hour</td><td>Two-digit hour, or empty string for match all. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$minute</td><td>Two-digit minute, or empty string for match all. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string Regexp to use as datetime filter. </dd></dl>

<p>Reimplemented in <a class="el" href="classPf.html#a3827d539c75623fd5345ab590caaa2cb">Pf</a>.</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01164">1164</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1165</span>    {</div>
<div class="line"><span class="lineno"> 1166</span>        global <a class="code hl_variable" href="defs_8php.html#a4ce923af45f11d3c8c5488c75cdefbb5">$MonthNames</a>, <a class="code hl_variable" href="defs_8php.html#a4bfd1f62a770e381e991cf87ee7a51ce">$Re_MonthNames</a>;</div>
<div class="line"><span class="lineno"> 1167</span> </div>
<div class="line"><span class="lineno"> 1168</span>        <span class="comment">// Sep  7 13:49:06</span></div>
<div class="line"><span class="lineno"> 1169</span>        <span class="keywordflow">if</span> ($month != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1170</span>            $reMonth= <a class="code hl_variable" href="defs_8php.html#a4ce923af45f11d3c8c5488c75cdefbb5">$MonthNames</a>[$month];</div>
<div class="line"><span class="lineno"> 1171</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1172</span>            $reMonth= <span class="charliteral">&#39;(&#39;</span>.$Re_MonthNames.<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><span class="lineno"> 1173</span>        }</div>
<div class="line"><span class="lineno"> 1174</span> </div>
<div class="line"><span class="lineno"> 1175</span>        <span class="keywordflow">if</span> ($day != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1176</span>            $reDay= sprintf(<span class="stringliteral">&#39;% 2d&#39;</span>, $day);</div>
<div class="line"><span class="lineno"> 1177</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1178</span>            $reDay= <span class="stringliteral">&#39;([[:digit:][:blank:]][[:digit:]])&#39;</span>;</div>
<div class="line"><span class="lineno"> 1179</span>        }</div>
<div class="line"><span class="lineno"> 1180</span> </div>
<div class="line"><span class="lineno"> 1181</span>        <span class="keywordflow">if</span> ($hour != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1182</span>            $reHour= $hour;</div>
<div class="line"><span class="lineno"> 1183</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1184</span>            $reHour= <span class="stringliteral">&#39;([[:digit:]][[:digit:]])&#39;</span>;</div>
<div class="line"><span class="lineno"> 1185</span>        }</div>
<div class="line"><span class="lineno"> 1186</span> </div>
<div class="line"><span class="lineno"> 1187</span>        <span class="keywordflow">if</span> ($minute != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1188</span>            $reMinute= $minute;</div>
<div class="line"><span class="lineno"> 1189</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1190</span>            $reMinute= <span class="stringliteral">&#39;([[:digit:]][[:digit:]])&#39;</span>;</div>
<div class="line"><span class="lineno"> 1191</span>        }</div>
<div class="line"><span class="lineno"> 1192</span> </div>
<div class="line"><span class="lineno"> 1193</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;^$reMonth $reDay $reHour:$reMinute:&quot;</span>;</div>
<div class="line"><span class="lineno"> 1194</span>    }</div>
<div class="ttc" id="adefs_8php_html_a4bfd1f62a770e381e991cf87ee7a51ce"><div class="ttname"><a href="defs_8php.html#a4bfd1f62a770e381e991cf87ee7a51ce">$Re_MonthNames</a></div><div class="ttdeci">$Re_MonthNames</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00106">defs.php:106</a></div></div>
<div class="ttc" id="adefs_8php_html_a4ce923af45f11d3c8c5488c75cdefbb5"><div class="ttname"><a href="defs_8php.html#a4ce923af45f11d3c8c5488c75cdefbb5">$MonthNames</a></div><div class="ttdeci">$MonthNames</div><div class="ttdoc">Used in translating months from number to string.</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00075">defs.php:75</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="defs_8php_source.html#l00075">$MonthNames</a>, and <a class="el" href="defs_8php_source.html#l00106">$Re_MonthNames</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01279">_getFileLineCount()</a>, <a class="el" href="openssh_8php_source.html#l00090">Openssh\_getFileLineCount()</a>, <a class="el" href="model_8php_source.html#l01335">GetLogs()</a>, and <a class="el" href="openssh_8php_source.html#l00118">Openssh\GetLogs()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a3827d539c75623fd5345ab590caaa2cb_icgraph.png" border="0" usemap="#aclassModel_a3827d539c75623fd5345ab590caaa2cb_icgraph" alt=""/></div>
<map name="aclassModel_a3827d539c75623fd5345ab590caaa2cb_icgraph" id="aclassModel_a3827d539c75623fd5345ab590caaa2cb_icgraph">
<area shape="rect" title="Generates the module specific datetime regexp for filtering logs." alt="" coords="889,156,1067,181"/>
<area shape="rect" href="classModel.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="673,81,811,107"/>
<area shape="rect" href="classOpenssh.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="643,131,841,156"/>
<area shape="rect" href="classModel.html#a3cd1d5510b23ec577d9d124f9e05a449" title="Gets lines in log file." alt="" coords="705,180,779,205"/>
<area shape="rect" href="classOpenssh.html#a3cd1d5510b23ec577d9d124f9e05a449" title="Gets lines in log file." alt="" coords="675,229,809,255"/>
<area shape="rect" href="classModel.html#ab1e8cbbabce3210438cebad028f153d7" title="Gets the number of lines added to log files since last tmp file update." alt="" coords="455,31,595,56"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="304,56,407,81"/>
<area shape="rect" href="classModel.html#aeea778b449fceb9e5e77cc98440ac4bd" title="Gets line count of the given log file." alt="" coords="458,132,591,157"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,31,243,56"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,80,256,105"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="a9e0bb0c7dbe09da8be1338e15c21068a" name="a9e0bb0c7dbe09da8be1338e15c21068a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e0bb0c7dbe09da8be1338e15c21068a">&#9670;&#160;</a></span>formatDateHourRegexpDayLeadingZero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">formatDateHourRegexpDayLeadingZero </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$month</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$hour</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$minute</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01196">1196</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1197</span>    {</div>
<div class="line"><span class="lineno"> 1198</span>        global <a class="code hl_variable" href="defs_8php.html#a4ce923af45f11d3c8c5488c75cdefbb5">$MonthNames</a>, <a class="code hl_variable" href="defs_8php.html#a4bfd1f62a770e381e991cf87ee7a51ce">$Re_MonthNames</a>;</div>
<div class="line"><span class="lineno"> 1199</span> </div>
<div class="line"><span class="lineno"> 1200</span>        <span class="comment">// Sep 07 13:49:06</span></div>
<div class="line"><span class="lineno"> 1201</span>        <span class="keywordflow">if</span> ($month != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1202</span>            $reMonth= <a class="code hl_variable" href="defs_8php.html#a4ce923af45f11d3c8c5488c75cdefbb5">$MonthNames</a>[$month];</div>
<div class="line"><span class="lineno"> 1203</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1204</span>            $reMonth= <span class="charliteral">&#39;(&#39;</span>.$Re_MonthNames.<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><span class="lineno"> 1205</span>        }</div>
<div class="line"><span class="lineno"> 1206</span> </div>
<div class="line"><span class="lineno"> 1207</span>        <span class="keywordflow">if</span> ($day != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1208</span>            $reDay= $day;</div>
<div class="line"><span class="lineno"> 1209</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1210</span>            $reDay= <span class="stringliteral">&#39;([[:digit:]][[:digit:]])&#39;</span>;</div>
<div class="line"><span class="lineno"> 1211</span>        }</div>
<div class="line"><span class="lineno"> 1212</span> </div>
<div class="line"><span class="lineno"> 1213</span>        <span class="keywordflow">if</span> ($hour != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1214</span>            $reHour= $hour;</div>
<div class="line"><span class="lineno"> 1215</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1216</span>            $reHour= <span class="stringliteral">&#39;([[:digit:]][[:digit:]])&#39;</span>;</div>
<div class="line"><span class="lineno"> 1217</span>        }</div>
<div class="line"><span class="lineno"> 1218</span> </div>
<div class="line"><span class="lineno"> 1219</span>        <span class="keywordflow">if</span> ($minute != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1220</span>            $reMinute= $minute;</div>
<div class="line"><span class="lineno"> 1221</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1222</span>            $reMinute= <span class="stringliteral">&#39;([[:digit:]][[:digit:]])&#39;</span>;</div>
<div class="line"><span class="lineno"> 1223</span>        }</div>
<div class="line"><span class="lineno"> 1224</span>        </div>
<div class="line"><span class="lineno"> 1225</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;^$reMonth $reDay $reHour:$reMinute:&quot;</span>;</div>
<div class="line"><span class="lineno"> 1226</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="defs_8php_source.html#l00075">$MonthNames</a>, and <a class="el" href="defs_8php_source.html#l00106">$Re_MonthNames</a>.</p>

<p class="reference">Referenced by <a class="el" href="Model_2pf_8php_source.html#l00612">Pf\formatDateHourRegexp()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a9e0bb0c7dbe09da8be1338e15c21068a_icgraph.png" border="0" usemap="#aclassModel_a9e0bb0c7dbe09da8be1338e15c21068a_icgraph" alt=""/></div>
<map name="aclassModel_a9e0bb0c7dbe09da8be1338e15c21068a_icgraph" id="aclassModel_a9e0bb0c7dbe09da8be1338e15c21068a_icgraph">
<area shape="rect" title=" " alt="" coords="451,31,735,56"/>
<area shape="rect" href="classPf.html#a3827d539c75623fd5345ab590caaa2cb" title="Generates the module specific datetime regexp for filtering logs." alt="" coords="208,31,403,56"/>
<area shape="rect" href="classPf.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="5,5,160,31"/>
<area shape="rect" href="classPf.html#a3cd1d5510b23ec577d9d124f9e05a449" title="Gets lines in log file." alt="" coords="37,55,129,80"/>
</map>
</div>

</div>
</div>
<a id="a3077006595dffaebf9edc227f4a49a97" name="a3077006595dffaebf9edc227f4a49a97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3077006595dffaebf9edc227f4a49a97">&#9670;&#160;</a></span>formatDateHourRegexpWeekDays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">formatDateHourRegexpWeekDays </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$month</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$hour</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$minute</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01228">1228</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1229</span>    {</div>
<div class="line"><span class="lineno"> 1230</span>        global <a class="code hl_variable" href="defs_8php.html#a4ce923af45f11d3c8c5488c75cdefbb5">$MonthNames</a>, <a class="code hl_variable" href="defs_8php.html#a4bfd1f62a770e381e991cf87ee7a51ce">$Re_MonthNames</a>, <a class="code hl_variable" href="defs_8php.html#a7c06ec4b9cdfbee7cdad62be64179251">$Re_WeekDays</a>;</div>
<div class="line"><span class="lineno"> 1231</span> </div>
<div class="line"><span class="lineno"> 1232</span>        <span class="comment">// Mon Sep  4 23:51:31</span></div>
<div class="line"><span class="lineno"> 1233</span>        <span class="keywordflow">if</span> ($month != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1234</span>            $reMonth= <a class="code hl_variable" href="defs_8php.html#a4ce923af45f11d3c8c5488c75cdefbb5">$MonthNames</a>[$month];</div>
<div class="line"><span class="lineno"> 1235</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1236</span>            $reMonth= <span class="charliteral">&#39;(&#39;</span>.$Re_MonthNames.<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><span class="lineno"> 1237</span>        }</div>
<div class="line"><span class="lineno"> 1238</span> </div>
<div class="line"><span class="lineno"> 1239</span>        <span class="keywordflow">if</span> ($day != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1240</span>            $reDay= sprintf(<span class="stringliteral">&#39;% 2d&#39;</span>, $day);</div>
<div class="line"><span class="lineno"> 1241</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1242</span>            $reDay= <span class="stringliteral">&#39;([[:digit:][:blank:]][[:digit:]])&#39;</span>;</div>
<div class="line"><span class="lineno"> 1243</span>        }</div>
<div class="line"><span class="lineno"> 1244</span> </div>
<div class="line"><span class="lineno"> 1245</span>        <span class="keywordflow">if</span> ($hour != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1246</span>            $reHour= $hour;</div>
<div class="line"><span class="lineno"> 1247</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1248</span>            $reHour= <span class="stringliteral">&#39;([[:digit:]][[:digit:]])&#39;</span>;</div>
<div class="line"><span class="lineno"> 1249</span>        }</div>
<div class="line"><span class="lineno"> 1250</span> </div>
<div class="line"><span class="lineno"> 1251</span>        <span class="keywordflow">if</span> ($minute != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1252</span>            $reMinute= $minute;</div>
<div class="line"><span class="lineno"> 1253</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1254</span>            $reMinute= <span class="stringliteral">&#39;([[:digit:]][[:digit:]])&#39;</span>;</div>
<div class="line"><span class="lineno"> 1255</span>        }</div>
<div class="line"><span class="lineno"> 1256</span> </div>
<div class="line"><span class="lineno"> 1257</span>        $reWeekDays= <span class="charliteral">&#39;(&#39;</span>.$Re_WeekDays.<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><span class="lineno"> 1258</span> </div>
<div class="line"><span class="lineno"> 1259</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;^$reWeekDays $reMonth $reDay $reHour:$reMinute:&quot;</span>;</div>
<div class="line"><span class="lineno"> 1260</span>    }</div>
<div class="ttc" id="adefs_8php_html_a7c06ec4b9cdfbee7cdad62be64179251"><div class="ttname"><a href="defs_8php.html#a7c06ec4b9cdfbee7cdad62be64179251">$Re_WeekDays</a></div><div class="ttdeci">$Re_WeekDays</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00119">defs.php:119</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="defs_8php_source.html#l00075">$MonthNames</a>, <a class="el" href="defs_8php_source.html#l00106">$Re_MonthNames</a>, and <a class="el" href="defs_8php_source.html#l00119">$Re_WeekDays</a>.</p>

</div>
</div>
<a id="a2f595c1fea08e09a47f744ff8fec6815" name="a2f595c1fea08e09a47f744ff8fec6815"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f595c1fea08e09a47f744ff8fec6815">&#9670;&#160;</a></span>GetAllStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetAllStats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$collecthours</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets both brief and full statistics. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$logfile</td><td>Log file pathname. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$collecthours</td><td>Flag to get hour statistics also. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array Statistics in serialized arrays. </dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>We need $stats return value of GetStats() because of $collecthours constraint</dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01742">1742</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1743</span>    {</div>
<div class="line"><span class="lineno"> 1744</span>        $date= json_encode(array(<span class="stringliteral">&#39;Month&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;Day&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>));</div>
<div class="line"><span class="lineno"> 1746</span>        $stats= $this-&gt;_getStats($logfile, $date, $collecthours);</div>
<div class="line"><span class="lineno"> 1747</span>        <span class="keywordflow">if</span> ($stats === FALSE) {</div>
<div class="line"><span class="lineno"> 1748</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1749</span>        }</div>
<div class="line"><span class="lineno"> 1750</span> </div>
<div class="line"><span class="lineno"> 1751</span>        <span class="comment">// Do not get $stats here, just $briefstats</span></div>
<div class="line"><span class="lineno"> 1752</span>        $this-&gt;GetSavedStats($logfile, $dummy, $briefstats);</div>
<div class="line"><span class="lineno"> 1753</span>        $briefstats= json_encode($briefstats);</div>
<div class="line"><span class="lineno"> 1754</span> </div>
<div class="line"><span class="lineno"> 1755</span>        <span class="comment">// Use serialized stats as array elements to prevent otherwise extra json_decode() for $stats,</span></div>
<div class="line"><span class="lineno"> 1756</span>        <span class="comment">// which is already serialized by GetStat() above.</span></div>
<div class="line"><span class="lineno"> 1757</span>        <span class="comment">// They are ordinary strings now, this json_encode() should be quite fast</span></div>
<div class="line"><span class="lineno"> 1758</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>(json_encode(</div>
<div class="line"><span class="lineno"> 1759</span>                array(</div>
<div class="line"><span class="lineno"> 1760</span>                    <span class="stringliteral">&#39;stats&#39;</span>     =&gt; $stats,</div>
<div class="line"><span class="lineno"> 1761</span>                    <span class="stringliteral">&#39;briefstats&#39;</span>=&gt; $briefstats,</div>
<div class="line"><span class="lineno"> 1762</span>                    )</div>
<div class="line"><span class="lineno"> 1763</span>                )</div>
<div class="line"><span class="lineno"> 1764</span>            );</div>
<div class="line"><span class="lineno"> 1765</span>    }</div>
<div class="ttc" id="aModel_2include_8php_html_af6395f757480163a2a2645bbb2cdb8cd"><div class="ttname"><a href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a></div><div class="ttdeci">Output($msg)</div><div class="ttdoc">Sets or updates $Output with the given message.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00108">include.php:108</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l01780">_getStats()</a>, <a class="el" href="model_8php_source.html#l02033">GetSavedStats()</a>, and <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a2f595c1fea08e09a47f744ff8fec6815_cgraph.png" border="0" usemap="#aclassModel_a2f595c1fea08e09a47f744ff8fec6815_cgraph" alt=""/></div>
<map name="aclassModel_a2f595c1fea08e09a47f744ff8fec6815_cgraph" id="aclassModel_a2f595c1fea08e09a47f744ff8fec6815_cgraph">
<area shape="rect" title="Gets both brief and full statistics." alt="" coords="5,499,100,524"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="148,423,231,448"/>
<area shape="rect" href="classModel.html#a1149c6f5338677a1a74e8a4964826e80" title="Gets saved statistics for the given log file." alt="" coords="483,448,602,474"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="156,550,223,575"/>
<area shape="rect" href="classModel.html#acae82824087b62c41fe805eba381e84c" title="Generates date regexp to be used by statistics functions." alt="" coords="288,348,413,374"/>
<area shape="rect" href="classModel.html#ae1a4adadbacc084431d026315be20390" title="Generates hour regexp to be used by statistics functions." alt="" coords="288,398,413,423"/>
<area shape="rect" href="classModel.html#adef576154f41b9e06cbf28bb1a4f74b8" title="Checks if the given log file has been updated." alt="" coords="475,298,610,323"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="299,751,402,776"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="889,803,987,828"/>
<area shape="rect" href="classModel.html#ad4d7aefbd214d3da3f1965e6ddddb998" title="Copies the original log file to tmp folder." alt="" coords="279,144,423,170"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="892,296,984,322"/>
<area shape="rect" href="classModel.html#a91890c866a00b75b002e6b1016e6b43c" title="Reads file contents." alt="" coords="698,398,766,423"/>
<area shape="rect" href="classModel.html#ae24c34977ae6864272b678fe40fdb09a" title="Gets name of the tmp statistics file for the given log file." alt="" coords="868,474,1008,499"/>
<area shape="rect" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7" title="Gets the original file name for the given log file." alt="" coords="1083,474,1217,499"/>
<area shape="rect" href="classModel.html#a2ef1e4c1d1fadd3c6696a101cd2aa7e5" title="Gets previous line count and stat() from statistics file." alt="" coords="669,550,795,575"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="865,754,1011,779"/>
<area shape="rect" href="classModel.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="663,852,801,878"/>
<area shape="rect" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09" title=" " alt="" coords="1075,979,1225,1004"/>
<area shape="rect" href="classModel.html#ac23e08bf49a305b2d76f11cecc62ba4c" title="Day statistics collector." alt="" coords="479,928,606,954"/>
<area shape="rect" href="classModel.html#ab1e8cbbabce3210438cebad028f153d7" title="Gets the number of lines added to log files since last tmp file update." alt="" coords="473,624,613,650"/>
<area shape="rect" href="classModel.html#ad26e67d9a70c2182a67b939ae61b6d01" title="Builds generic grep command and extracts log lines." alt="" coords="665,803,799,828"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="489,978,596,1003"/>
<area shape="rect" href="classModel.html#ae6201c722387cb7120a3447378f73271" title="Further processes parser output fields." alt="" coords="479,776,607,802"/>
<area shape="rect" href="classModel.html#ab5448888d58c0402bcc575e3a5cd9e9e" title="Saves collected statistics with the current line count and stat() output." alt="" coords="689,651,775,676"/>
<area shape="rect" href="classModel.html#a3827d539c75623fd5345ab590caaa2cb" title="Generates the module specific datetime regexp for filtering logs." alt="" coords="849,852,1027,878"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="1273,340,1327,366"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="1081,764,1219,790"/>
<area shape="rect" href="classModel.html#abe3e76f34ef7907cc5fcc6d2840bf081" title="Hour statistics collector." alt="" coords="667,1004,797,1030"/>
<area shape="rect" href="classModel.html#a10ffb35c34bab2bd539a5a945a489625" title="Increments stats for the given values." alt="" coords="901,1028,975,1054"/>
<area shape="rect" href="classModel.html#a3b4ab5022e1e5883d5292c024eaaf8c1" title="Minute statistics collector." alt="" coords="865,979,1011,1004"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="669,1106,795,1131"/>
<area shape="rect" href="classModel.html#a24813c8e79a850571607408548a88528" title="Writes contents to file." alt="" coords="905,651,971,676"/>
<area shape="rect" href="classModel.html#a5cdc13ae8497b92e1c6cbf8b85c6d43c" title="Uncompresses gzipped log file to tmp dir." alt="" coords="471,94,615,119"/>
<area shape="rect" href="classModel.html#a620707dcc4093d4ca002e3dfdfa68af1" title="Deletes the given file or directory." alt="" coords="688,43,776,68"/>
</map>
</div>

</div>
</div>
<a id="a3216e14ab593ec9dcc7df09c995d8b1b" name="a3216e14ab593ec9dcc7df09c995d8b1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3216e14ab593ec9dcc7df09c995d8b1b">&#9670;&#160;</a></span>getCachedContents()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getCachedContents </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$contents</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02775">2775</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2776</span>    {</div>
<div class="line"><span class="lineno"> 2777</span>        <span class="keywordflow">if</span> (file_exists($filename)) {</div>
<div class="line"><span class="lineno"> 2778</span>            $now= intval(exec(<span class="stringliteral">&#39;date &quot;+%s&quot;&#39;</span>));</div>
<div class="line"><span class="lineno"> 2779</span>            $ctime= intval(stat($filename)[<span class="stringliteral">&#39;ctime&#39;</span>]);</div>
<div class="line"><span class="lineno"> 2780</span>            $diff= $now - $ctime;</div>
<div class="line"><span class="lineno"> 2781</span> </div>
<div class="line"><span class="lineno"> 2782</span>            $reload_rate= $this-&gt;_getReloadRate();</div>
<div class="line"><span class="lineno"> 2783</span> </div>
<div class="line"><span class="lineno"> 2784</span>            <span class="keywordflow">if</span> ($diff &lt; $reload_rate) {</div>
<div class="line"><span class="lineno"> 2785</span>                <span class="keywordflow">if</span> ($cachedContents= json_decode(file_get_contents($filename), TRUE)) {</div>
<div class="line"><span class="lineno"> 2786</span>                    <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Using cached contents from $filename, refresh interval &lt; default reload rate: $diff &lt; $reload_rate seconds&quot;</span>);</div>
<div class="line"><span class="lineno"> 2787</span>                    $contents= $cachedContents;</div>
<div class="line"><span class="lineno"> 2788</span>                    <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 2789</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2790</span>                    <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Cannot json_decode cached contents from $filename&quot;</span>);</div>
<div class="line"><span class="lineno"> 2791</span>                }</div>
<div class="line"><span class="lineno"> 2792</span>            }</div>
<div class="line"><span class="lineno"> 2793</span>        }</div>
<div class="line"><span class="lineno"> 2794</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2795</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00760">_getReloadRate()</a>, and <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02804">_getModuleStatus()</a>, and <a class="el" href="model_8php_source.html#l02683">GetServiceStatus()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a3216e14ab593ec9dcc7df09c995d8b1b_cgraph.png" border="0" usemap="#aclassModel_a3216e14ab593ec9dcc7df09c995d8b1b_cgraph" alt=""/></div>
<map name="aclassModel_a3216e14ab593ec9dcc7df09c995d8b1b_cgraph" id="aclassModel_a3216e14ab593ec9dcc7df09c995d8b1b_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,155,56"/>
<area shape="rect" href="classModel.html#a1151960aeff2e631b01f989afe5b2f7e" title=" " alt="" coords="203,5,328,31"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="219,55,311,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a3216e14ab593ec9dcc7df09c995d8b1b_icgraph.png" border="0" usemap="#aclassModel_a3216e14ab593ec9dcc7df09c995d8b1b_icgraph" alt=""/></div>
<map name="aclassModel_a3216e14ab593ec9dcc7df09c995d8b1b_icgraph" id="aclassModel_a3216e14ab593ec9dcc7df09c995d8b1b_icgraph">
<area shape="rect" title=" " alt="" coords="375,31,524,56"/>
<area shape="rect" href="classModel.html#a5b9d9c5affe24f91a3151fa107ee80e4" title=" " alt="" coords="188,5,327,31"/>
<area shape="rect" href="classModel.html#a5cf12375d05dca29b3c81333ff1882a2" title="Gets service statuses." alt="" coords="190,55,325,80"/>
<area shape="rect" href="classModel.html#ac74f9ae5abb475786f8f9278af56e953" title=" " alt="" coords="5,5,140,31"/>
</map>
</div>

</div>
</div>
<a id="ae08f1955abf4f7b5ca00ec1fec76041f" name="ae08f1955abf4f7b5ca00ec1fec76041f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae08f1955abf4f7b5ca00ec1fec76041f">&#9670;&#160;</a></span>GetConfFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetConfFile </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns configuration file of the module. </p>
<p>Certain modules have configuration divided into multiple pages/files, hence they override this method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$conf</td><td>Config type </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$group</td><td>E2guardian group </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string Config file pathname </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02568">2568</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2569</span>    {</div>
<div class="line"><span class="lineno"> 2570</span>        <span class="keywordflow">return</span> $this-&gt;ConfFile;</div>
<div class="line"><span class="lineno"> 2571</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02508">DisableConf()</a>, <a class="el" href="model_8php_source.html#l02494">EnableConf()</a>, <a class="el" href="model_8php_source.html#l02366">GetDisabledValue()</a>, <a class="el" href="model_8php_source.html#l02337">GetValue()</a>, and <a class="el" href="model_8php_source.html#l02455">SetConfValue()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ae08f1955abf4f7b5ca00ec1fec76041f_icgraph.png" border="0" usemap="#aclassModel_ae08f1955abf4f7b5ca00ec1fec76041f_icgraph" alt=""/></div>
<map name="aclassModel_ae08f1955abf4f7b5ca00ec1fec76041f_icgraph" id="aclassModel_ae08f1955abf4f7b5ca00ec1fec76041f_icgraph">
<area shape="rect" title="Returns configuration file of the module." alt="" coords="369,104,468,129"/>
<area shape="rect" href="classModel.html#a45811aad99c24bbd1afd2c51d6aaac37" title="Disables a configuration item in conf file." alt="" coords="201,5,303,31"/>
<area shape="rect" href="classModel.html#a6abe8763d4525946e15e0d9784d500b8" title="Enables a configuration item in conf file." alt="" coords="204,55,300,80"/>
<area shape="rect" href="classModel.html#a9aefd70a0fc1481512f149df7a0376aa" title="Returns all disabled configuration for a given configuration type." alt="" coords="183,104,321,129"/>
<area shape="rect" href="classModel.html#ae81727132988d14931750ce5e1c88bd7" title="Returns all enabled configuration for a given configuration type." alt="" coords="211,153,293,179"/>
<area shape="rect" href="classModel.html#a4c5f8b05e5cbfffe696da52ce05f066a" title="Sets the value of NVP configuration." alt="" coords="197,203,307,228"/>
<area shape="rect" href="classModel.html#a7b5bd25430f02d1925323e19f2861a9e" title="Gets all configuration for a given configuration type." alt="" coords="5,129,135,155"/>
</map>
</div>

</div>
</div>
<a id="a7b5bd25430f02d1925323e19f2861a9e" name="a7b5bd25430f02d1925323e19f2861a9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b5bd25430f02d1925323e19f2861a9e">&#9670;&#160;</a></span>GetConfigValues()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetConfigValues </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets all configuration for a given configuration type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$conf</td><td>Config type </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$group</td><td>E2guardian group </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array Array of config items </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02305">2305</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2306</span>    {</div>
<div class="line"><span class="lineno"> 2307</span>        $this-&gt;SetConfig($conf);</div>
<div class="line"><span class="lineno"> 2308</span> </div>
<div class="line"><span class="lineno"> 2309</span>        $values= array();</div>
<div class="line"><span class="lineno"> 2310</span>        <span class="keywordflow">foreach</span> ($this-&gt;Config as $name =&gt; $config) {</div>
<div class="line"><span class="lineno"> 2311</span>            <span class="keywordflow">if</span> (($output= $this-&gt;GetValue($name, $conf, $group)) !== FALSE) {</div>
<div class="line"><span class="lineno"> 2312</span>                $values[$name]= array(</div>
<div class="line"><span class="lineno"> 2313</span>                    <span class="stringliteral">&#39;Value&#39;</span> =&gt; $output,</div>
<div class="line"><span class="lineno"> 2314</span>                    <span class="stringliteral">&#39;Type&#39;</span> =&gt; $this-&gt;GetConfValueType($name),</div>
<div class="line"><span class="lineno"> 2315</span>                    <span class="stringliteral">&#39;Enabled&#39;</span> =&gt; TRUE,</div>
<div class="line"><span class="lineno"> 2316</span>                    );</div>
<div class="line"><span class="lineno"> 2317</span>            }</div>
<div class="line"><span class="lineno"> 2318</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (($output= $this-&gt;GetDisabledValue($name, $conf, $group)) !== FALSE) {</div>
<div class="line"><span class="lineno"> 2319</span>                $values[$name]= array(</div>
<div class="line"><span class="lineno"> 2320</span>                    <span class="stringliteral">&#39;Value&#39;</span> =&gt; $output,</div>
<div class="line"><span class="lineno"> 2321</span>                    <span class="stringliteral">&#39;Type&#39;</span> =&gt; $this-&gt;GetConfValueType($name),</div>
<div class="line"><span class="lineno"> 2322</span>                    <span class="stringliteral">&#39;Enabled&#39;</span> =&gt; FALSE,</div>
<div class="line"><span class="lineno"> 2323</span>                    );</div>
<div class="line"><span class="lineno"> 2324</span>            }</div>
<div class="line"><span class="lineno"> 2325</span>        }</div>
<div class="line"><span class="lineno"> 2326</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>(json_encode($values));</div>
<div class="line"><span class="lineno"> 2327</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l02474">GetConfValueType()</a>, <a class="el" href="model_8php_source.html#l02366">GetDisabledValue()</a>, <a class="el" href="model_8php_source.html#l02337">GetValue()</a>, <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>, and <a class="el" href="model_8php_source.html#l02581">SetConfig()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a7b5bd25430f02d1925323e19f2861a9e_cgraph.png" border="0" usemap="#aclassModel_a7b5bd25430f02d1925323e19f2861a9e_cgraph" alt=""/></div>
<map name="aclassModel_a7b5bd25430f02d1925323e19f2861a9e_cgraph" id="aclassModel_a7b5bd25430f02d1925323e19f2861a9e_cgraph">
<area shape="rect" title="Gets all configuration for a given configuration type." alt="" coords="5,179,135,204"/>
<area shape="rect" href="classModel.html#a3d6c4b92ec14b5133d20ce287ef720ca" title=" " alt="" coords="183,80,324,105"/>
<area shape="rect" href="classModel.html#a9aefd70a0fc1481512f149df7a0376aa" title="Returns all disabled configuration for a given configuration type." alt="" coords="184,179,323,204"/>
<area shape="rect" href="classModel.html#ae81727132988d14931750ce5e1c88bd7" title="Returns all enabled configuration for a given configuration type." alt="" coords="213,129,294,155"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="220,228,287,253"/>
<area shape="rect" href="classModel.html#a63e6c944f6d63934ee3f05c24bc3e122" title="Sets configuration file based on config type provided." alt="" coords="211,277,295,303"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="397,104,489,129"/>
<area shape="rect" href="classModel.html#ae08f1955abf4f7b5ca00ec1fec76041f" title="Returns configuration file of the module." alt="" coords="393,153,492,179"/>
<area shape="rect" href="classModel.html#a6a716268fcbfd5197d5055df81c2dbc5" title="Checks if commented&#45;out Name exists." alt="" coords="372,301,513,327"/>
<area shape="rect" href="classModel.html#a1aebe30cc76f4942c0333005444fb00f" title="Reads value of commented&#45;out NVP." alt="" coords="378,252,507,277"/>
<area shape="rect" href="classModel.html#a25397fad2fa355ebc979d4672a4b2c7e" title=" " alt="" coords="383,203,502,228"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="561,153,651,179"/>
<area shape="rect" href="classModel.html#ae6cc2dcb5a8fe07db88766823322be7e" title="Checks if Name exists." alt="" coords="401,5,485,31"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="407,55,479,80"/>
</map>
</div>

</div>
</div>
<a id="a3d6c4b92ec14b5133d20ce287ef720ca" name="a3d6c4b92ec14b5133d20ce287ef720ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d6c4b92ec14b5133d20ce287ef720ca">&#9670;&#160;</a></span>GetConfValueType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetConfValueType </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02474">2474</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2475</span>    {</div>
<div class="line"><span class="lineno"> 2476</span>        <span class="keywordflow">if</span> (isset($this-&gt;Config[$name][<span class="stringliteral">&#39;type&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2477</span>            <span class="keywordflow">return</span> $this-&gt;Config[$name][<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><span class="lineno"> 2478</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2479</span>            <span class="keywordflow">return</span> <span class="stringliteral">&#39;.*&#39;</span>;</div>
<div class="line"><span class="lineno"> 2480</span>        }</div>
<div class="line"><span class="lineno"> 2481</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02508">DisableConf()</a>, <a class="el" href="model_8php_source.html#l02494">EnableConf()</a>, and <a class="el" href="model_8php_source.html#l02305">GetConfigValues()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a3d6c4b92ec14b5133d20ce287ef720ca_icgraph.png" border="0" usemap="#aclassModel_a3d6c4b92ec14b5133d20ce287ef720ca_icgraph" alt=""/></div>
<map name="aclassModel_a3d6c4b92ec14b5133d20ce287ef720ca_icgraph" id="aclassModel_a3d6c4b92ec14b5133d20ce287ef720ca_icgraph">
<area shape="rect" title=" " alt="" coords="183,55,324,80"/>
<area shape="rect" href="classModel.html#a45811aad99c24bbd1afd2c51d6aaac37" title="Disables a configuration item in conf file." alt="" coords="19,5,121,31"/>
<area shape="rect" href="classModel.html#a6abe8763d4525946e15e0d9784d500b8" title="Enables a configuration item in conf file." alt="" coords="22,55,118,80"/>
<area shape="rect" href="classModel.html#a7b5bd25430f02d1925323e19f2861a9e" title="Gets all configuration for a given configuration type." alt="" coords="5,104,135,129"/>
</map>
</div>

</div>
</div>
<a id="acae82824087b62c41fe805eba381e84c" name="acae82824087b62c41fe805eba381e84c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acae82824087b62c41fe805eba381e84c">&#9670;&#160;</a></span>GetDateRegexp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetDateRegexp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$date</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates date regexp to be used by statistics functions. </p>
<p>Used to match date indeces of stats array to get stats for date ranges.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$date</td><td>Date struct. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string Regexp. </dd></dl>

<p>Reimplemented in <a class="el" href="classPf.html#acae82824087b62c41fe805eba381e84c">Pf</a>.</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01989">1989</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1990</span>    {</div>
<div class="line"><span class="lineno"> 1991</span>        global <a class="code hl_variable" href="defs_8php.html#a4ce923af45f11d3c8c5488c75cdefbb5">$MonthNames</a>;</div>
<div class="line"><span class="lineno"> 1992</span> </div>
<div class="line"><span class="lineno"> 1993</span>        <span class="keywordflow">if</span> ($date[<span class="stringliteral">&#39;Month&#39;</span>] == <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1994</span>            $re= <span class="stringliteral">&#39;.*&#39;</span>;</div>
<div class="line"><span class="lineno"> 1995</span>        }</div>
<div class="line"><span class="lineno"> 1996</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1997</span>            $re= <a class="code hl_variable" href="defs_8php.html#a4ce923af45f11d3c8c5488c75cdefbb5">$MonthNames</a>[$date[<span class="stringliteral">&#39;Month&#39;</span>]].<span class="stringliteral">&#39;\s+&#39;</span>;</div>
<div class="line"><span class="lineno"> 1998</span>            <span class="keywordflow">if</span> ($date[<span class="stringliteral">&#39;Day&#39;</span>] == <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1999</span>                $re.= <span class="stringliteral">&#39;.*&#39;</span>;</div>
<div class="line"><span class="lineno"> 2000</span>            }</div>
<div class="line"><span class="lineno"> 2001</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2002</span>                $re.= sprintf(<span class="stringliteral">&#39;% 2d&#39;</span>, $date[<span class="stringliteral">&#39;Day&#39;</span>]);</div>
<div class="line"><span class="lineno"> 2003</span>            }</div>
<div class="line"><span class="lineno"> 2004</span>        }</div>
<div class="line"><span class="lineno"> 2005</span>        <span class="keywordflow">return</span> $re;</div>
<div class="line"><span class="lineno"> 2006</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="defs_8php_source.html#l00075">$MonthNames</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01780">_getStats()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_acae82824087b62c41fe805eba381e84c_icgraph.png" border="0" usemap="#aclassModel_acae82824087b62c41fe805eba381e84c_icgraph" alt=""/></div>
<map name="aclassModel_acae82824087b62c41fe805eba381e84c_icgraph" id="aclassModel_acae82824087b62c41fe805eba381e84c_icgraph">
<area shape="rect" title="Generates date regexp to be used by statistics functions." alt="" coords="279,31,404,56"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="148,31,231,56"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="a9f2769948b2be5ec1c6afd2bd4f70637" name="a9f2769948b2be5ec1c6afd2bd4f70637"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f2769948b2be5ec1c6afd2bd4f70637">&#9670;&#160;</a></span>GetDateTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetDateTime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets system datetime. </p>
<dl class="section return"><dt>Returns</dt><dd>array Datetime. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01013">1013</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1014</span>    {</div>
<div class="line"><span class="lineno"> 1015</span>        $dateArray= array();</div>
<div class="line"><span class="lineno"> 1016</span>        $dateArray[<span class="stringliteral">&#39;Month&#39;</span>]= exec(<span class="stringliteral">&#39;/bin/date +%m&#39;</span>);</div>
<div class="line"><span class="lineno"> 1017</span>        $dateArray[<span class="stringliteral">&#39;Day&#39;</span>]= exec(<span class="stringliteral">&#39;/bin/date +%d&#39;</span>);</div>
<div class="line"><span class="lineno"> 1018</span>        $dateArray[<span class="stringliteral">&#39;Hour&#39;</span>]= exec(<span class="stringliteral">&#39;/bin/date +%H&#39;</span>);</div>
<div class="line"><span class="lineno"> 1019</span>        $dateArray[<span class="stringliteral">&#39;Minute&#39;</span>]= exec(<span class="stringliteral">&#39;/bin/date +%M&#39;</span>);</div>
<div class="line"><span class="lineno"> 1020</span> </div>
<div class="line"><span class="lineno"> 1021</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>(json_encode($dateArray));</div>
<div class="line"><span class="lineno"> 1022</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a9f2769948b2be5ec1c6afd2bd4f70637_cgraph.png" border="0" usemap="#aclassModel_a9f2769948b2be5ec1c6afd2bd4f70637_cgraph" alt=""/></div>
<map name="aclassModel_a9f2769948b2be5ec1c6afd2bd4f70637_cgraph" id="aclassModel_a9f2769948b2be5ec1c6afd2bd4f70637_cgraph">
<area shape="rect" title="Gets system datetime." alt="" coords="5,5,115,31"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="163,5,229,31"/>
</map>
</div>

</div>
</div>
<a id="a8e59d0bd0ce3f0afb4a82ef8c7345c6b" name="a8e59d0bd0ce3f0afb4a82ef8c7345c6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e59d0bd0ce3f0afb4a82ef8c7345c6b">&#9670;&#160;</a></span>GetDefaultLogFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetDefaultLogFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the log file of the module. </p>
<dl class="section return"><dt>Returns</dt><dd>string Name of log file. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01046">1046</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1047</span>    {</div>
<div class="line"><span class="lineno"> 1048</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>($this-&gt;LogFile);</div>
<div class="line"><span class="lineno"> 1049</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a8e59d0bd0ce3f0afb4a82ef8c7345c6b_cgraph.png" border="0" usemap="#aclassModel_a8e59d0bd0ce3f0afb4a82ef8c7345c6b_cgraph" alt=""/></div>
<map name="aclassModel_a8e59d0bd0ce3f0afb4a82ef8c7345c6b_cgraph" id="aclassModel_a8e59d0bd0ce3f0afb4a82ef8c7345c6b_cgraph">
<area shape="rect" title="Gets the log file of the module." alt="" coords="5,5,144,31"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="192,5,259,31"/>
</map>
</div>

</div>
</div>
<a id="a6a716268fcbfd5197d5055df81c2dbc5" name="a6a716268fcbfd5197d5055df81c2dbc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a716268fcbfd5197d5055df81c2dbc5">&#9670;&#160;</a></span>GetDisabledName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetDisabledName </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if commented-out Name exists. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Config file </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$name</td><td>Name of NVP </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed Commented Name or FALSE on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02441">2441</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2442</span>    {</div>
<div class="line"><span class="lineno"> 2443</span>        <span class="keywordflow">return</span> $this-&gt;SearchFile($file, <span class="stringliteral">&quot;/^\h*$this-&gt;COMC\h*($name)(\h*$this-&gt;COMC.*|\h*)$/m&quot;</span>);</div>
<div class="line"><span class="lineno"> 2444</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00929">SearchFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02366">GetDisabledValue()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a6a716268fcbfd5197d5055df81c2dbc5_cgraph.png" border="0" usemap="#aclassModel_a6a716268fcbfd5197d5055df81c2dbc5_cgraph" alt=""/></div>
<map name="aclassModel_a6a716268fcbfd5197d5055df81c2dbc5_cgraph" id="aclassModel_a6a716268fcbfd5197d5055df81c2dbc5_cgraph">
<area shape="rect" title="Checks if commented&#45;out Name exists." alt="" coords="5,5,147,31"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="195,5,284,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a6a716268fcbfd5197d5055df81c2dbc5_icgraph.png" border="0" usemap="#aclassModel_a6a716268fcbfd5197d5055df81c2dbc5_icgraph" alt=""/></div>
<map name="aclassModel_a6a716268fcbfd5197d5055df81c2dbc5_icgraph" id="aclassModel_a6a716268fcbfd5197d5055df81c2dbc5_icgraph">
<area shape="rect" title="Checks if commented&#45;out Name exists." alt="" coords="369,5,511,31"/>
<area shape="rect" href="classModel.html#a9aefd70a0fc1481512f149df7a0376aa" title="Returns all disabled configuration for a given configuration type." alt="" coords="183,5,321,31"/>
<area shape="rect" href="classModel.html#a7b5bd25430f02d1925323e19f2861a9e" title="Gets all configuration for a given configuration type." alt="" coords="5,5,135,31"/>
</map>
</div>

</div>
</div>
<a id="a1aebe30cc76f4942c0333005444fb00f" name="a1aebe30cc76f4942c0333005444fb00f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aebe30cc76f4942c0333005444fb00f">&#9670;&#160;</a></span>GetDisabledNVP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetDisabledNVP </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$set</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$trimchars</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads value of commented-out NVP. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Config file </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$name</td><td>Name of NVP </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$set</td><td>There may be multiple parentheses in $re, which one to return </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$trimchars</td><td>If given, these chars are trimmed on the left or right. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string Value of commented NVP or NULL on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02417">2417</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2418</span>    {</div>
<div class="line"><span class="lineno"> 2419</span>        <span class="keywordflow">return</span> $this-&gt;SearchFile($file, <span class="stringliteral">&quot;/^\h*$this-&gt;COMC\h*$name\b\h*$this-&gt;NVPS\h*([^$this-&gt;COMC&#39;\&quot;\n]*|&#39;[^&#39;\n]*&#39;|\&quot;[^\&quot;\n]*\&quot;|[^$this-&gt;COMC\n]*)(\h*|\h*$this-&gt;COMC.*)$/m&quot;</span>, $set, $trimchars);</div>
<div class="line"><span class="lineno"> 2420</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00929">SearchFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02366">GetDisabledValue()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a1aebe30cc76f4942c0333005444fb00f_cgraph.png" border="0" usemap="#aclassModel_a1aebe30cc76f4942c0333005444fb00f_cgraph" alt=""/></div>
<map name="aclassModel_a1aebe30cc76f4942c0333005444fb00f_cgraph" id="aclassModel_a1aebe30cc76f4942c0333005444fb00f_cgraph">
<area shape="rect" title="Reads value of commented&#45;out NVP." alt="" coords="5,5,135,31"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="183,5,272,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a1aebe30cc76f4942c0333005444fb00f_icgraph.png" border="0" usemap="#aclassModel_a1aebe30cc76f4942c0333005444fb00f_icgraph" alt=""/></div>
<map name="aclassModel_a1aebe30cc76f4942c0333005444fb00f_icgraph" id="aclassModel_a1aebe30cc76f4942c0333005444fb00f_icgraph">
<area shape="rect" title="Reads value of commented&#45;out NVP." alt="" coords="369,5,499,31"/>
<area shape="rect" href="classModel.html#a9aefd70a0fc1481512f149df7a0376aa" title="Returns all disabled configuration for a given configuration type." alt="" coords="183,5,321,31"/>
<area shape="rect" href="classModel.html#a7b5bd25430f02d1925323e19f2861a9e" title="Gets all configuration for a given configuration type." alt="" coords="5,5,135,31"/>
</map>
</div>

</div>
</div>
<a id="a9aefd70a0fc1481512f149df7a0376aa" name="a9aefd70a0fc1481512f149df7a0376aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9aefd70a0fc1481512f149df7a0376aa">&#9670;&#160;</a></span>GetDisabledValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetDisabledValue </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns all disabled configuration for a given configuration type. </p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02366">2366</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2367</span>    {</div>
<div class="line"><span class="lineno"> 2368</span>        $file= $this-&gt;GetConfFile($conf, $group);</div>
<div class="line"><span class="lineno"> 2369</span>        </div>
<div class="line"><span class="lineno"> 2370</span>        <span class="keywordflow">if</span> ((isset($this-&gt;Config[$name][<span class="stringliteral">&#39;type&#39;</span>])) &amp;&amp; ($this-&gt;Config[$name][<span class="stringliteral">&#39;type&#39;</span>] === FALSE)) {</div>
<div class="line"><span class="lineno"> 2371</span>            <span class="keywordflow">return</span> $this-&gt;GetDisabledName($file, $name);</div>
<div class="line"><span class="lineno"> 2372</span>        }</div>
<div class="line"><span class="lineno"> 2373</span> </div>
<div class="line"><span class="lineno"> 2374</span>        $validValues= $this-&gt;getValidValues($name);</div>
<div class="line"><span class="lineno"> 2375</span>        $value= FALSE;</div>
<div class="line"><span class="lineno"> 2376</span>        $set= 0;</div>
<div class="line"><span class="lineno"> 2377</span>        <span class="comment">// Try max 5 possible values</span></div>
<div class="line"><span class="lineno"> 2378</span>        <span class="keywordflow">while</span> ($set &lt; 5) {</div>
<div class="line"><span class="lineno"> 2379</span>            $value= $this-&gt;GetDisabledNVP($file, $name, $set);</div>
<div class="line"><span class="lineno"> 2380</span>            <span class="keywordflow">if</span> ($value === FALSE) {</div>
<div class="line"><span class="lineno"> 2381</span>                <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2382</span>            }</div>
<div class="line"><span class="lineno"> 2383</span>            <span class="keywordflow">if</span> (!count($validValues) || in_array($value, $validValues)) {</div>
<div class="line"><span class="lineno"> 2384</span>                <span class="keywordflow">return</span> <span class="stringliteral">&quot;$name=$value&quot;</span>;</div>
<div class="line"><span class="lineno"> 2385</span>            }</div>
<div class="line"><span class="lineno"> 2386</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_NOTICE, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Failed validating value: $name: $value&quot;</span>);</div>
<div class="line"><span class="lineno"> 2387</span>            $set++;</div>
<div class="line"><span class="lineno"> 2388</span>        }</div>
<div class="line"><span class="lineno"> 2389</span>        <span class="keywordflow">return</span> $value;</div>
<div class="line"><span class="lineno"> 2390</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="model_8php_source.html#l02568">GetConfFile()</a>, <a class="el" href="model_8php_source.html#l02441">GetDisabledName()</a>, <a class="el" href="model_8php_source.html#l02417">GetDisabledNVP()</a>, and <a class="el" href="model_8php_source.html#l02392">getValidValues()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02305">GetConfigValues()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a9aefd70a0fc1481512f149df7a0376aa_cgraph.png" border="0" usemap="#aclassModel_a9aefd70a0fc1481512f149df7a0376aa_cgraph" alt=""/></div>
<map name="aclassModel_a9aefd70a0fc1481512f149df7a0376aa_cgraph" id="aclassModel_a9aefd70a0fc1481512f149df7a0376aa_cgraph">
<area shape="rect" title="Returns all disabled configuration for a given configuration type." alt="" coords="5,104,144,129"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="217,5,309,31"/>
<area shape="rect" href="classModel.html#ae08f1955abf4f7b5ca00ec1fec76041f" title="Returns configuration file of the module." alt="" coords="213,55,312,80"/>
<area shape="rect" href="classModel.html#a6a716268fcbfd5197d5055df81c2dbc5" title="Checks if commented&#45;out Name exists." alt="" coords="192,104,333,129"/>
<area shape="rect" href="classModel.html#a1aebe30cc76f4942c0333005444fb00f" title="Reads value of commented&#45;out NVP." alt="" coords="198,153,327,179"/>
<area shape="rect" href="classModel.html#a25397fad2fa355ebc979d4672a4b2c7e" title=" " alt="" coords="203,203,322,228"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="381,129,471,155"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a9aefd70a0fc1481512f149df7a0376aa_icgraph.png" border="0" usemap="#aclassModel_a9aefd70a0fc1481512f149df7a0376aa_icgraph" alt=""/></div>
<map name="aclassModel_a9aefd70a0fc1481512f149df7a0376aa_icgraph" id="aclassModel_a9aefd70a0fc1481512f149df7a0376aa_icgraph">
<area shape="rect" title="Returns all disabled configuration for a given configuration type." alt="" coords="183,5,321,31"/>
<area shape="rect" href="classModel.html#a7b5bd25430f02d1925323e19f2861a9e" title="Gets all configuration for a given configuration type." alt="" coords="5,5,135,31"/>
</map>
</div>

</div>
</div>
<a id="a190806315bf8a8147417f3735ba66bc5" name="a190806315bf8a8147417f3735ba66bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a190806315bf8a8147417f3735ba66bc5">&#9670;&#160;</a></span>GetExtIf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetExtIf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get ext_if. </p>
<dl class="section return"><dt>Returns</dt><dd>string External interface name. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00510">510</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  511</span>    {</div>
<div class="line"><span class="lineno">  512</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>($this-&gt;_getExtIf());</div>
<div class="line"><span class="lineno">  513</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00515">_getExtIf()</a>, and <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a190806315bf8a8147417f3735ba66bc5_cgraph.png" border="0" usemap="#aclassModel_a190806315bf8a8147417f3735ba66bc5_cgraph" alt=""/></div>
<map name="aclassModel_a190806315bf8a8147417f3735ba66bc5_cgraph" id="aclassModel_a190806315bf8a8147417f3735ba66bc5_cgraph">
<area shape="rect" title="Get ext_if." alt="" coords="5,31,80,56"/>
<area shape="rect" href="classModel.html#aa572c51a6d4aa52ec3029518451a05fe" title=" " alt="" coords="128,5,208,31"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="135,55,201,80"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="256,5,328,31"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="376,5,465,31"/>
</map>
</div>

</div>
</div>
<a id="a75a2cec868b2b3cf1d0f2ae81a799298" name="a75a2cec868b2b3cf1d0f2ae81a799298"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75a2cec868b2b3cf1d0f2ae81a799298">&#9670;&#160;</a></span>getFifoLogs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getFifoLogs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$interval</em> = <code>60</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section attention"><dt>Attention</dt><dd>Don't call date_create('now') to get current time, it uses UTC in php.ini, but the timezone in the logs may be different</dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02862">2862</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2863</span>    {</div>
<div class="line"><span class="lineno"> 2864</span>        $lastLogs= array();</div>
<div class="line"><span class="lineno"> 2865</span>        $rv= FALSE;</div>
<div class="line"><span class="lineno"> 2866</span> </div>
<div class="line"><span class="lineno"> 2867</span>        <span class="keywordflow">foreach</span> (array(<span class="stringliteral">&#39;warning&#39;</span>, <span class="stringliteral">&#39;error&#39;</span>, <span class="stringliteral">&#39;critical&#39;</span>) as $prio) {</div>
<div class="line"><span class="lineno"> 2868</span>            <span class="comment">// We could get Capacity from collectd.conf, but each fifo may have its own Capacity definition</span></div>
<div class="line"><span class="lineno"> 2869</span>            <span class="comment">// So we use 100</span></div>
<div class="line"><span class="lineno"> 2870</span>            $logs= $this-&gt;_getLiveLogs(<span class="stringliteral">&quot;{$this-&gt;CollectdFifoFolder}/{$this-&gt;CollectdName}_$prio.fifo&quot;</span>, 100, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, FALSE);</div>
<div class="line"><span class="lineno"> 2871</span>            <span class="keywordflow">if</span> ($logs === FALSE) {</div>
<div class="line"><span class="lineno"> 2872</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2873</span>            }</div>
<div class="line"><span class="lineno"> 2874</span> </div>
<div class="line"><span class="lineno"> 2875</span>            $rv= TRUE;</div>
<div class="line"><span class="lineno"> 2876</span> </div>
<div class="line"><span class="lineno"> 2877</span>            $count= count($logs);</div>
<div class="line"><span class="lineno"> 2878</span>            <span class="keywordflow">if</span> ($count &gt; 0) {</div>
<div class="line"><span class="lineno"> 2880</span>                <span class="comment">// Create datetime from /bin/date output to match the timezone in the logs</span></div>
<div class="line"><span class="lineno"> 2881</span>                $dt= DateTime::createFromFormat($this-&gt;dateTimeFormat, exec(<span class="stringliteral">&#39;/bin/date &quot;+%b %e %H:%M:%S&quot;&#39;</span>));</div>
<div class="line"><span class="lineno"> 2882</span>                <span class="keywordflow">if</span> ($dt) {</div>
<div class="line"><span class="lineno"> 2883</span>                    $lastTs= $dt-&gt;getTimestamp();</div>
<div class="line"><span class="lineno"> 2884</span> </div>
<div class="line"><span class="lineno"> 2885</span>                    <span class="comment">// Loop in reverse order to break out asap</span></div>
<div class="line"><span class="lineno"> 2886</span>                    <span class="keywordflow">while</span> (--$count &gt;= 0) {</div>
<div class="line"><span class="lineno"> 2887</span>                        $l= $logs[$count];</div>
<div class="line"><span class="lineno"> 2888</span> </div>
<div class="line"><span class="lineno"> 2889</span>                        <span class="comment">// @attention Always check the retval of createFromFormat(), it may fail due to format mismatch, e.g. log rotation lines</span></div>
<div class="line"><span class="lineno"> 2890</span>                        $dt= DateTime::createFromFormat($this-&gt;dateTimeFormat, $l[<span class="stringliteral">&#39;Date&#39;</span>].<span class="charliteral">&#39; &#39;</span>.$l[<span class="stringliteral">&#39;Time&#39;</span>]);</div>
<div class="line"><span class="lineno"> 2891</span>                        <span class="keywordflow">if</span> ($dt) {</div>
<div class="line"><span class="lineno"> 2892</span>                            $ts= $dt-&gt;getTimestamp();</div>
<div class="line"><span class="lineno"> 2893</span>                            <span class="keywordflow">if</span> ($lastTs - $ts &lt;= $interval) {</div>
<div class="line"><span class="lineno"> 2894</span>                                $lastLogs[]= $l;</div>
<div class="line"><span class="lineno"> 2895</span>                            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2896</span>                                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2897</span>                            }</div>
<div class="line"><span class="lineno"> 2898</span>                        }</div>
<div class="line"><span class="lineno"> 2899</span>                    }</div>
<div class="line"><span class="lineno"> 2900</span>                }</div>
<div class="line"><span class="lineno"> 2901</span>            }</div>
<div class="line"><span class="lineno"> 2902</span>        }</div>
<div class="line"><span class="lineno"> 2903</span>        <span class="keywordflow">return</span> $rv ? $lastLogs : FALSE;</div>
<div class="line"><span class="lineno"> 2904</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l01407">_getLiveLogs()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02804">_getModuleStatus()</a>, and <a class="el" href="model_8php_source.html#l02979">GetStatus()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a75a2cec868b2b3cf1d0f2ae81a799298_cgraph.png" border="0" usemap="#aclassModel_a75a2cec868b2b3cf1d0f2ae81a799298_cgraph" alt=""/></div>
<map name="aclassModel_a75a2cec868b2b3cf1d0f2ae81a799298_cgraph" id="aclassModel_a75a2cec868b2b3cf1d0f2ae81a799298_cgraph">
<area shape="rect" title=" " alt="" coords="5,32,103,57"/>
<area shape="rect" href="classModel.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="151,32,257,57"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="305,7,412,32"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="309,56,408,81"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="465,5,592,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="645,81,699,107"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="460,107,597,132"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a75a2cec868b2b3cf1d0f2ae81a799298_icgraph.png" border="0" usemap="#aclassModel_a75a2cec868b2b3cf1d0f2ae81a799298_icgraph" alt=""/></div>
<map name="aclassModel_a75a2cec868b2b3cf1d0f2ae81a799298_icgraph" id="aclassModel_a75a2cec868b2b3cf1d0f2ae81a799298_icgraph">
<area shape="rect" title=" " alt="" coords="375,31,472,56"/>
<area shape="rect" href="classModel.html#a5b9d9c5affe24f91a3151fa107ee80e4" title=" " alt="" coords="188,5,327,31"/>
<area shape="rect" href="classModel.html#ab735f5a4ded9f9c9a5b04f182205fd7d" title=" " alt="" coords="214,55,301,80"/>
<area shape="rect" href="classModel.html#ac74f9ae5abb475786f8f9278af56e953" title=" " alt="" coords="5,5,140,31"/>
</map>
</div>

</div>
</div>
<a id="a91890c866a00b75b002e6b1016e6b43c" name="a91890c866a00b75b002e6b1016e6b43c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91890c866a00b75b002e6b1016e6b43c">&#9670;&#160;</a></span>GetFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetFile </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads file contents. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Config file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed File contents in a string or FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00822">822</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  823</span>    {</div>
<div class="line"><span class="lineno">  824</span>        <span class="keywordflow">if</span> (file_exists($file)) {</div>
<div class="line"><span class="lineno">  825</span>            <span class="keywordflow">return</span> file_get_contents($file);</div>
<div class="line"><span class="lineno">  826</span>        }</div>
<div class="line"><span class="lineno">  827</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  828</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Model_2system_8php_source.html#l00468">System\_getIfConfig()</a>, <a class="el" href="Model_2dhcpd_8php_source.html#l00363">Dhcpd\_getLeases()</a>, <a class="el" href="Model_2system_8php_source.html#l00432">System\_getMyName()</a>, <a class="el" href="Model_2system_8php_source.html#l00588">System\_getStaticGateway()</a>, <a class="el" href="Model_2system_8php_source.html#l01465">System\DaemonizedRotateLogFile()</a>, <a class="el" href="Model_2system_8php_source.html#l01776">System\EnableHostap()</a>, <a class="el" href="Model_2system_8php_source.html#l01788">System\GetMFSConfig()</a>, <a class="el" href="model_8php_source.html#l03088">GetNewsyslogConfig()</a>, <a class="el" href="Model_2system_8php_source.html#l01014">System\GetRemoteTime()</a>, <a class="el" href="Model_2system_8php_source.html#l01603">System\getRootCronTab()</a>, <a class="el" href="model_8php_source.html#l02033">GetSavedStats()</a>, <a class="el" href="model_8php_source.html#l02588">Kill()</a>, and <a class="el" href="model_8php_source.html#l03123">SetNewsyslogConfig()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a91890c866a00b75b002e6b1016e6b43c_icgraph.png" border="0" usemap="#aclassModel_a91890c866a00b75b002e6b1016e6b43c_icgraph" alt=""/></div>
<map name="aclassModel_a91890c866a00b75b002e6b1016e6b43c_icgraph" id="aclassModel_a91890c866a00b75b002e6b1016e6b43c_icgraph">
<area shape="rect" title="Reads file contents." alt="" coords="944,351,1012,376"/>
<area shape="rect" href="classSystem.html#a8f266bbe68428102e21654d0ce0ad832" title=" " alt="" coords="696,104,849,129"/>
<area shape="rect" href="classDhcpd.html#a41befaaa7e57ab544a686a23333a2086" title=" " alt="" coords="703,203,843,228"/>
<area shape="rect" href="classSystem.html#af5082be9929e989404336047e2ff8942" title=" " alt="" coords="691,55,854,80"/>
<area shape="rect" href="classSystem.html#a7114619c558a6753b86838fde9ae99e5" title=" " alt="" coords="673,153,872,179"/>
<area shape="rect" href="classSystem.html#a8f54af1e94c8b939b1ebb436baacd58f" title="Rotate log file via newsyslog." alt="" coords="649,252,896,277"/>
<area shape="rect" href="classSystem.html#abd6fc6d3a058b392238ae053baad44ca" title="Enables hostap on the given interface." alt="" coords="690,301,855,327"/>
<area shape="rect" href="classSystem.html#a620f42e40ed47964e1e4fc96a759b38f" title=" " alt="" coords="689,351,856,376"/>
<area shape="rect" href="classModel.html#ac6ce9b164f907bfe360c2f5dee6d1ab1" title="Gets newsyslog configuration for log file." alt="" coords="694,400,851,425"/>
<area shape="rect" href="classSystem.html#a9d579394f9aad623cebfb05d17af0774" title="Reads datetime temporary output file." alt="" coords="681,449,864,475"/>
<area shape="rect" href="classSystem.html#a42acd46e4e13a7ca4ce63619a861885e" title=" " alt="" coords="683,499,862,524"/>
<area shape="rect" href="classModel.html#a1149c6f5338677a1a74e8a4964826e80" title="Gets saved statistics for the given log file." alt="" coords="713,548,832,573"/>
<area shape="rect" href="classModel.html#aeb3147c61c1c08d30c6b360ba839b213" title="Stops module&#39;s parent process with its pid." alt="" coords="751,597,794,623"/>
<area shape="rect" href="classModel.html#a6bd903872ce2d86a25252a84248f2e3f" title="Sets newsyslog configuration for log file." alt="" coords="695,647,850,672"/>
<area shape="rect" href="classSystem.html#a6baa62a81a32e122dde71ac97c46fe9a" title="Reads hostname, gateway, and interface configuration." alt="" coords="429,55,568,80"/>
<area shape="rect" href="classSystem.html#a3303bbb179d383a51f6981bcf65372a8" title="Reads interface configuration." alt="" coords="425,104,573,129"/>
<area shape="rect" href="classDhcpd.html#adef32c4a0164bed3caf5f2efa262b818" title=" " alt="" coords="396,252,601,277"/>
<area shape="rect" href="classDhcpd.html#a6ef19a5a822ec5a4c5b7b33476aadcd3" title="Gets dhcpd leases." alt="" coords="431,301,566,327"/>
<area shape="rect" href="classDhcpd.html#a65ffe7950ba3a608bd8839a16ab88fe5" title=" " alt="" coords="164,252,332,277"/>
<area shape="rect" href="classDhcpd.html#a99c7d07369de88b18f42e1b15595c5a0" title=" " alt="" coords="148,301,348,327"/>
<area shape="rect" href="classSystem.html#a625fd6e0c7a30ae05df2e9dd75d1e455" title="Reads hostname." alt="" coords="420,5,577,31"/>
<area shape="rect" href="classSystem.html#a4f4e4e9f2af4ade1afb253c004db47db" title="Reads static gateway address from mygate file." alt="" coords="402,153,595,179"/>
<area shape="rect" href="classSystem.html#ab11c15607f702856d377b575f60d875a" title="Gets system gateway, static or dynamic." alt="" coords="397,203,600,228"/>
<area shape="rect" href="classSystem.html#a6c0c91116842cbcd97f4311fea0acc8c" title="Restarts the network." alt="" coords="183,203,313,228"/>
<area shape="rect" href="classSystem.html#a9ab68d76ae284801fab86bc79307f163" title=" " alt="" coords="413,448,585,473"/>
<area shape="rect" href="classSystem.html#a35859a78a5736fe2821b4531775d4443" title=" " alt="" coords="415,497,582,523"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="207,599,289,624"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,549,100,575"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="447,649,550,675"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,599,92,624"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="194,649,302,675"/>
</map>
</div>

</div>
</div>
<a id="ad8f9b01c41c50fcef015cc5444236024" name="ad8f9b01c41c50fcef015cc5444236024"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8f9b01c41c50fcef015cc5444236024">&#9670;&#160;</a></span>GetFileFirstLine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetFileFirstLine </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets first line of file. </p>
<p>Used to get the start date of log files.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Log file pathname. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string First line in file. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01520">1520</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1521</span>    {</div>
<div class="line"><span class="lineno"> 1522</span>        $cmd= preg_replace(<span class="stringliteral">&#39;/&lt;LF&gt;/&#39;</span>, $file, $this-&gt;CmdLogStart);</div>
<div class="line"><span class="lineno"> 1523</span>        <span class="keywordflow">return</span> $this-&gt;RunShellCommand($cmd);</div>
<div class="line"><span class="lineno"> 1524</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00791">RunShellCommand()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01489">_getLogStartDate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ad8f9b01c41c50fcef015cc5444236024_cgraph.png" border="0" usemap="#aclassModel_ad8f9b01c41c50fcef015cc5444236024_cgraph" alt=""/></div>
<map name="aclassModel_ad8f9b01c41c50fcef015cc5444236024_cgraph" id="aclassModel_ad8f9b01c41c50fcef015cc5444236024_cgraph">
<area shape="rect" title="Gets first line of file." alt="" coords="5,5,128,31"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="176,5,323,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ad8f9b01c41c50fcef015cc5444236024_icgraph.png" border="0" usemap="#aclassModel_ad8f9b01c41c50fcef015cc5444236024_icgraph" alt=""/></div>
<map name="aclassModel_ad8f9b01c41c50fcef015cc5444236024_icgraph" id="aclassModel_ad8f9b01c41c50fcef015cc5444236024_icgraph">
<area shape="rect" title="Gets first line of file." alt="" coords="367,31,489,56"/>
<area shape="rect" href="classModel.html#aab423e07962bdc1319b01c6d7c679f0f" title=" " alt="" coords="184,31,319,56"/>
<area shape="rect" href="classModel.html#aed5ee3c735f862c4d99761b379f31729" title="Gets log files list with start dates." alt="" coords="10,5,131,31"/>
<area shape="rect" href="classModel.html#a40159dcd03e82eade9e96fd6b8080e89" title="Extracts the datetime of the first line in the log file." alt="" coords="5,55,136,80"/>
</map>
</div>

</div>
</div>
<a id="aeea778b449fceb9e5e77cc98440ac4bd" name="aeea778b449fceb9e5e77cc98440ac4bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeea778b449fceb9e5e77cc98440ac4bd">&#9670;&#160;</a></span>GetFileLineCount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetFileLineCount </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$re</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$needle</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$month</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$day</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$hour</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$minute</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets line count of the given log file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Log file pathname. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$re</td><td>Regexp to get count of a restricted result set. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$needle</td><td>Optional regexp to use with a second grep over logs, used by Stats pages. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$month</td><td>Two-digit month, or empty string for match all. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$day</td><td>Two-digit day, or empty string for match all. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$hour</td><td>Two-digit hour, or empty string for match all. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$minute</td><td>Two-digit minute, or empty string for match all. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Line count. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01274">1274</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1275</span>    {</div>
<div class="line"><span class="lineno"> 1276</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>($this-&gt;_getFileLineCount($file, $re, $needle, $month, $day, $hour, $minute));</div>
<div class="line"><span class="lineno"> 1277</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l01279">_getFileLineCount()</a>, and <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aeea778b449fceb9e5e77cc98440ac4bd_cgraph.png" border="0" usemap="#aclassModel_aeea778b449fceb9e5e77cc98440ac4bd_cgraph" alt=""/></div>
<map name="aclassModel_aeea778b449fceb9e5e77cc98440ac4bd_cgraph" id="aclassModel_aeea778b449fceb9e5e77cc98440ac4bd_cgraph">
<area shape="rect" title="Gets line count of the given log file." alt="" coords="5,80,139,105"/>
<area shape="rect" href="classModel.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="187,55,325,80"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="223,104,289,129"/>
<area shape="rect" href="classModel.html#a3827d539c75623fd5345ab590caaa2cb" title="Generates the module specific datetime regexp for filtering logs." alt="" coords="373,5,551,31"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="389,55,535,80"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="413,104,511,129"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="784,104,837,129"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="599,129,736,155"/>
</map>
</div>

</div>
</div>
<a id="aa4ee9332ba73886bc02ffb1903a050ba" name="aa4ee9332ba73886bc02ffb1903a050ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4ee9332ba73886bc02ffb1903a050ba">&#9670;&#160;</a></span>GetFiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetFiles </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$filepath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns files with the given filepath pattern. </p>
<p>$filepath does not have to be just directory path, and may contain wildcards.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$filepath</td><td>File pattern to match. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string List of file names, without path. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00811">811</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  812</span>    {</div>
<div class="line"><span class="lineno">  813</span>        <span class="keywordflow">return</span> $this-&gt;RunShellCommand(<span class="stringliteral">&quot;ls -1 $filepath&quot;</span>);</div>
<div class="line"><span class="lineno">  814</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00791">RunShellCommand()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01463">GetLogFilesList()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aa4ee9332ba73886bc02ffb1903a050ba_cgraph.png" border="0" usemap="#aclassModel_aa4ee9332ba73886bc02ffb1903a050ba_cgraph" alt=""/></div>
<map name="aclassModel_aa4ee9332ba73886bc02ffb1903a050ba_cgraph" id="aclassModel_aa4ee9332ba73886bc02ffb1903a050ba_cgraph">
<area shape="rect" title="Returns files with the given filepath pattern." alt="" coords="5,5,80,31"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="128,5,275,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aa4ee9332ba73886bc02ffb1903a050ba_icgraph.png" border="0" usemap="#aclassModel_aa4ee9332ba73886bc02ffb1903a050ba_icgraph" alt=""/></div>
<map name="aclassModel_aa4ee9332ba73886bc02ffb1903a050ba_icgraph" id="aclassModel_aa4ee9332ba73886bc02ffb1903a050ba_icgraph">
<area shape="rect" title="Returns files with the given filepath pattern." alt="" coords="175,5,249,31"/>
<area shape="rect" href="classModel.html#aed5ee3c735f862c4d99761b379f31729" title="Gets log files list with start dates." alt="" coords="5,5,127,31"/>
</map>
</div>

</div>
</div>
<a id="ae1a4adadbacc084431d026315be20390" name="ae1a4adadbacc084431d026315be20390"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1a4adadbacc084431d026315be20390">&#9670;&#160;</a></span>GetHourRegexp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetHourRegexp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$date</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates hour regexp to be used by statistics functions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$date</td><td>Date struct. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string Regexp. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02014">2014</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2015</span>    {</div>
<div class="line"><span class="lineno"> 2016</span>        <span class="keywordflow">if</span> (!isset($date[<span class="stringliteral">&#39;Hour&#39;</span>]) || $date[<span class="stringliteral">&#39;Hour&#39;</span>] == <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 2017</span>            $re= <span class="stringliteral">&#39;.*&#39;</span>;</div>
<div class="line"><span class="lineno"> 2018</span>        }</div>
<div class="line"><span class="lineno"> 2019</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2020</span>            $re= $date[<span class="stringliteral">&#39;Hour&#39;</span>];</div>
<div class="line"><span class="lineno"> 2021</span>        }</div>
<div class="line"><span class="lineno"> 2022</span>        <span class="keywordflow">return</span> $re;</div>
<div class="line"><span class="lineno"> 2023</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01780">_getStats()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ae1a4adadbacc084431d026315be20390_icgraph.png" border="0" usemap="#aclassModel_ae1a4adadbacc084431d026315be20390_icgraph" alt=""/></div>
<map name="aclassModel_ae1a4adadbacc084431d026315be20390_icgraph" id="aclassModel_ae1a4adadbacc084431d026315be20390_icgraph">
<area shape="rect" title="Generates hour regexp to be used by statistics functions." alt="" coords="279,31,404,56"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="148,31,231,56"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="a14573cc2fd34870091dfe7e8aa1ab171" name="a14573cc2fd34870091dfe7e8aa1ab171"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14573cc2fd34870091dfe7e8aa1ab171">&#9670;&#160;</a></span>GetIntIf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetIntIf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get int_if. </p>
<dl class="section return"><dt>Returns</dt><dd>string Internal interface name. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00495">495</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  496</span>    {</div>
<div class="line"><span class="lineno">  497</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>($this-&gt;_getIntIf());</div>
<div class="line"><span class="lineno">  498</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00500">_getIntIf()</a>, and <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a14573cc2fd34870091dfe7e8aa1ab171_cgraph.png" border="0" usemap="#aclassModel_a14573cc2fd34870091dfe7e8aa1ab171_cgraph" alt=""/></div>
<map name="aclassModel_a14573cc2fd34870091dfe7e8aa1ab171_cgraph" id="aclassModel_a14573cc2fd34870091dfe7e8aa1ab171_cgraph">
<area shape="rect" title="Get int_if." alt="" coords="5,31,76,56"/>
<area shape="rect" href="classModel.html#a7abfd365d79fd5b34b3aab5d4ff0c770" title=" " alt="" coords="124,5,200,31"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="129,55,195,80"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="248,5,320,31"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="368,5,457,31"/>
</map>
</div>

</div>
</div>
<a id="aaf87c48d0be7e3e4563be72e08f120b0" name="aaf87c48d0be7e3e4563be72e08f120b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf87c48d0be7e3e4563be72e08f120b0">&#9670;&#160;</a></span>GetLastLogs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetLastLogs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01437">1437</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1438</span>    {</div>
<div class="line"><span class="lineno"> 1439</span>        exec(<span class="stringliteral">&quot;/usr/bin/tail -$count $file&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno"> 1440</span> </div>
<div class="line"><span class="lineno"> 1441</span>        <span class="keywordflow">if</span> (!$this-&gt;ValidateFileExists($file, TRUE)) {</div>
<div class="line"><span class="lineno"> 1442</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1443</span>        }</div>
<div class="line"><span class="lineno"> 1444</span> </div>
<div class="line"><span class="lineno"> 1445</span>        $logs= array();</div>
<div class="line"><span class="lineno"> 1446</span>        <span class="keywordflow">foreach</span> ($output as $line) {</div>
<div class="line"><span class="lineno"> 1447</span>            unset($cols);</div>
<div class="line"><span class="lineno"> 1448</span>            <span class="keywordflow">if</span> ($this-&gt;ParseLogLine($line, $cols)) {</div>
<div class="line"><span class="lineno"> 1449</span>                $logs[]= $cols;</div>
<div class="line"><span class="lineno"> 1450</span>            }</div>
<div class="line"><span class="lineno"> 1451</span>        }</div>
<div class="line"><span class="lineno"> 1452</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>(json_encode($logs));</div>
<div class="line"><span class="lineno"> 1453</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>, <a class="el" href="model_8php_source.html#l01533">ParseLogLine()</a>, and <a class="el" href="model_8php_source.html#l01855">ValidateFileExists()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aaf87c48d0be7e3e4563be72e08f120b0_cgraph.png" border="0" usemap="#aclassModel_aaf87c48d0be7e3e4563be72e08f120b0_cgraph" alt=""/></div>
<map name="aclassModel_aaf87c48d0be7e3e4563be72e08f120b0_cgraph" id="aclassModel_aaf87c48d0be7e3e4563be72e08f120b0_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,108,80"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="191,5,258,31"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="171,55,278,80"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="156,104,293,129"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="341,55,468,80"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="378,104,431,129"/>
</map>
</div>

</div>
</div>
<a id="abd1e082730aeee7890560b4ca2ee0a62" name="abd1e082730aeee7890560b4ca2ee0a62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd1e082730aeee7890560b4ca2ee0a62">&#9670;&#160;</a></span>GetLiveLogs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetLiveLogs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$re</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets logs for live logs pages. </p>
<p>Used to extract lines in last section of the log file or of the lines grep'd.</p>
<p>Difference from the archives method is that this one always gets the tail of the log or grep'd lines.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Log file. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$count</td><td>Tail length, page line count. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$re</td><td>Regexp to restrict the result set. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array Log lines. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01394">1394</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1395</span>    {</div>
<div class="line"><span class="lineno"> 1396</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>(json_encode($this-&gt;_getLiveLogs($file, $count, $re)));</div>
<div class="line"><span class="lineno"> 1397</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l01407">_getLiveLogs()</a>, and <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_abd1e082730aeee7890560b4ca2ee0a62_cgraph.png" border="0" usemap="#aclassModel_abd1e082730aeee7890560b4ca2ee0a62_cgraph" alt=""/></div>
<map name="aclassModel_abd1e082730aeee7890560b4ca2ee0a62_cgraph" id="aclassModel_abd1e082730aeee7890560b4ca2ee0a62_cgraph">
<area shape="rect" title="Gets logs for live logs pages." alt="" coords="5,56,108,81"/>
<area shape="rect" href="classModel.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="156,31,263,56"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="176,80,243,105"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="311,7,417,32"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="315,56,413,81"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="471,5,597,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="651,81,704,107"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="465,107,603,132"/>
</map>
</div>

</div>
</div>
<a id="aed5ee3c735f862c4d99761b379f31729" name="aed5ee3c735f862c4d99761b379f31729"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed5ee3c735f862c4d99761b379f31729">&#9670;&#160;</a></span>GetLogFilesList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetLogFilesList </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets log files list with start dates. </p>
<p>Searches the logs directory for all possible archives according to the default file name.</p>
<dl class="section return"><dt>Returns</dt><dd>array File names with start dates. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01463">1463</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1464</span>    {</div>
<div class="line"><span class="lineno"> 1465</span>        $file= <a class="code hl_variable" href="logs_8archives_8php.html#a09ce856a444e6c8704d1c5cc9f63e347">$this-&gt;LogFile</a>;</div>
<div class="line"><span class="lineno"> 1466</span>        $filelist= explode(<span class="stringliteral">&quot;\n&quot;</span>, $this-&gt;GetFiles(<span class="stringliteral">&quot;$file*&quot;</span>));</div>
<div class="line"><span class="lineno"> 1467</span>        asort($filelist);</div>
<div class="line"><span class="lineno"> 1468</span> </div>
<div class="line"><span class="lineno"> 1469</span>        $result= array();</div>
<div class="line"><span class="lineno"> 1470</span>        <span class="keywordflow">foreach</span> ($filelist as $filepath) {</div>
<div class="line"><span class="lineno"> 1471</span>            $result[$filepath]= $this-&gt;_getLogStartDate($filepath);</div>
<div class="line"><span class="lineno"> 1472</span>        }</div>
<div class="line"><span class="lineno"> 1473</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>(json_encode($result));</div>
<div class="line"><span class="lineno"> 1474</span>    }</div>
<div class="ttc" id="alogs_8archives_8php_html_a09ce856a444e6c8704d1c5cc9f63e347"><div class="ttname"><a href="logs_8archives_8php.html#a09ce856a444e6c8704d1c5cc9f63e347">$LogFile</a></div><div class="ttdeci">$LogFile</div><div class="ttdef"><b>Definition:</b> <a href="logs_8archives_8php_source.html#l00044">logs.archives.php:44</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="logs_8archives_8php_source.html#l00044">$LogFile</a>, <a class="el" href="model_8php_source.html#l01489">_getLogStartDate()</a>, <a class="el" href="model_8php_source.html#l00811">GetFiles()</a>, and <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aed5ee3c735f862c4d99761b379f31729_cgraph.png" border="0" usemap="#aclassModel_aed5ee3c735f862c4d99761b379f31729_cgraph" alt=""/></div>
<map name="aclassModel_aed5ee3c735f862c4d99761b379f31729_cgraph" id="aclassModel_aed5ee3c735f862c4d99761b379f31729_cgraph">
<area shape="rect" title="Gets log files list with start dates." alt="" coords="5,107,127,132"/>
<area shape="rect" href="classModel.html#aab423e07962bdc1319b01c6d7c679f0f" title=" " alt="" coords="175,107,309,132"/>
<area shape="rect" href="classModel.html#aa4ee9332ba73886bc02ffb1903a050ba" title="Returns files with the given filepath pattern." alt="" coords="590,5,665,31"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="209,156,275,181"/>
<area shape="rect" href="classModel.html#ad8f9b01c41c50fcef015cc5444236024" title="Gets first line of file." alt="" coords="566,105,689,131"/>
<area shape="rect" href="classModel.html#a7ece271b0ef8636736f58b3b75268931" title="Gets the name of the file in the tmp folder." alt="" coords="357,157,516,183"/>
<area shape="rect" href="classModel.html#adef576154f41b9e06cbf28bb1a4f74b8" title="Checks if the given log file has been updated." alt="" coords="369,207,504,232"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="383,56,490,81"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="739,105,885,131"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="766,180,858,205"/>
<area shape="rect" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7" title="Gets the original file name for the given log file." alt="" coords="933,281,1068,307"/>
<area shape="rect" href="classModel.html#a2ef1e4c1d1fadd3c6696a101cd2aa7e5" title="Gets previous line count and stat() from statistics file." alt="" coords="564,155,691,180"/>
<area shape="rect" href="classModel.html#ae24c34977ae6864272b678fe40fdb09a" title="Gets name of the tmp statistics file for the given log file." alt="" coords="742,256,882,281"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="564,56,691,81"/>
</map>
</div>

</div>
</div>
<a id="a3cd1d5510b23ec577d9d124f9e05a449" name="a3cd1d5510b23ec577d9d124f9e05a449"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cd1d5510b23ec577d9d124f9e05a449">&#9670;&#160;</a></span>GetLogs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetLogs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$re</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$needle</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$month</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$day</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$hour</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$minute</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets lines in log file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Log file pathname. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$end</td><td>Head option, start line. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$count</td><td>Tail option, page line count. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$re</td><td>Regexp to restrict the result set. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$needle</td><td>Optional regexp to use with a second grep over logs, used by Stats pages. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$month</td><td>Two-digit month, or empty string for match all. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$day</td><td>Two-digit day, or empty string for match all. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$hour</td><td>Two-digit hour, or empty string for match all. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$minute</td><td>Two-digit minute, or empty string for match all. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array Log lines. </dd></dl>

<p>Reimplemented in <a class="el" href="classOpenssh.html#a3cd1d5510b23ec577d9d124f9e05a449">Openssh</a>, and <a class="el" href="classPf.html#a3cd1d5510b23ec577d9d124f9e05a449">Pf</a>.</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01335">1335</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1336</span>    {</div>
<div class="line"><span class="lineno"> 1337</span>        <span class="keywordflow">if</span> (!$this-&gt;ValidateFile($file)) {</div>
<div class="line"><span class="lineno"> 1338</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1339</span>        }</div>
<div class="line"><span class="lineno"> 1340</span> </div>
<div class="line"><span class="lineno"> 1341</span>        <span class="comment">// Empty $re is not an issue for grep, greps all</span></div>
<div class="line"><span class="lineno"> 1342</span>        <span class="comment">// Skip for speed, otherwise we could use datetime regexp for empty strings too</span></div>
<div class="line"><span class="lineno"> 1343</span>        <span class="keywordflow">if</span> ($month == <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $day == <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $hour == <span class="stringliteral">&#39;&#39;</span> &amp;&amp; $minute == <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1344</span>            $re= escapeshellarg($re);</div>
<div class="line"><span class="lineno"> 1345</span>            <span class="keywordflow">if</span> ($needle == <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1346</span>                $cmd= <span class="stringliteral">&quot;/usr/bin/grep -a -E $re $file&quot;</span>;</div>
<div class="line"><span class="lineno"> 1347</span>            }</div>
<div class="line"><span class="lineno"> 1348</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1349</span>                $needle= escapeshellarg($needle);</div>
<div class="line"><span class="lineno"> 1350</span>                $cmd= <span class="stringliteral">&quot;/usr/bin/grep -a -E $needle $file | /usr/bin/grep -a -E $re&quot;</span>;</div>
<div class="line"><span class="lineno"> 1351</span>            }</div>
<div class="line"><span class="lineno"> 1352</span>        }</div>
<div class="line"><span class="lineno"> 1353</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1354</span>            $cmd= <span class="stringliteral">&#39;/usr/bin/grep -a -E &quot;&#39;</span> . $this-&gt;<a class="code hl_function" href="classModel.html#a3827d539c75623fd5345ab590caaa2cb">formatDateHourRegexp</a>($month, $day, $hour, $minute) . <span class="stringliteral">&#39;&quot; &#39;</span> . $file;</div>
<div class="line"><span class="lineno"> 1355</span> </div>
<div class="line"><span class="lineno"> 1356</span>            $re= escapeshellarg($re);</div>
<div class="line"><span class="lineno"> 1357</span>            <span class="keywordflow">if</span> ($needle == <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1358</span>                $cmd.= <span class="stringliteral">&quot; | /usr/bin/grep -a -E $re&quot;</span>;</div>
<div class="line"><span class="lineno"> 1359</span>            }</div>
<div class="line"><span class="lineno"> 1360</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1361</span>                $needle= escapeshellarg($needle);</div>
<div class="line"><span class="lineno"> 1362</span>                $cmd.= <span class="stringliteral">&quot; | /usr/bin/grep -a -E $needle | /usr/bin/grep -a -E $re&quot;</span>;</div>
<div class="line"><span class="lineno"> 1363</span>            }</div>
<div class="line"><span class="lineno"> 1364</span>        }</div>
<div class="line"><span class="lineno"> 1365</span> </div>
<div class="line"><span class="lineno"> 1366</span>        $cmd.= <span class="stringliteral">&quot; | /usr/bin/head -$end | /usr/bin/tail -$count&quot;</span>;</div>
<div class="line"><span class="lineno"> 1367</span> </div>
<div class="line"><span class="lineno"> 1368</span>        exec($cmd, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno"> 1369</span>        </div>
<div class="line"><span class="lineno"> 1370</span>        $logs= array();</div>
<div class="line"><span class="lineno"> 1371</span>        <span class="keywordflow">foreach</span> ($output as $line) {</div>
<div class="line"><span class="lineno"> 1372</span>            unset($cols);</div>
<div class="line"><span class="lineno"> 1373</span>            <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb">ParseLogLine</a>($line, $cols)) {</div>
<div class="line"><span class="lineno"> 1374</span>                $logs[]= $cols;</div>
<div class="line"><span class="lineno"> 1375</span>            }</div>
<div class="line"><span class="lineno"> 1376</span>        }</div>
<div class="line"><span class="lineno"> 1377</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>(json_encode($logs));</div>
<div class="line"><span class="lineno"> 1378</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="model_8php_source.html#l01164">formatDateHourRegexp()</a>, <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>, <a class="el" href="model_8php_source.html#l01533">ParseLogLine()</a>, and <a class="el" href="model_8php_source.html#l01838">ValidateFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a3cd1d5510b23ec577d9d124f9e05a449_cgraph.png" border="0" usemap="#aclassModel_a3cd1d5510b23ec577d9d124f9e05a449_cgraph" alt=""/></div>
<map name="aclassModel_a3cd1d5510b23ec577d9d124f9e05a449_cgraph" id="aclassModel_a3cd1d5510b23ec577d9d124f9e05a449_cgraph">
<area shape="rect" title="Gets lines in log file." alt="" coords="5,80,80,105"/>
<area shape="rect" href="classModel.html#a3827d539c75623fd5345ab590caaa2cb" title="Generates the module specific datetime regexp for filtering logs." alt="" coords="128,5,305,31"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="183,55,250,80"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="163,104,270,129"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="167,153,266,179"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="359,103,485,128"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="539,179,592,204"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="353,204,491,229"/>
</map>
</div>

</div>
</div>
<a id="a40159dcd03e82eade9e96fd6b8080e89" name="a40159dcd03e82eade9e96fd6b8080e89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40159dcd03e82eade9e96fd6b8080e89">&#9670;&#160;</a></span>GetLogStartDate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetLogStartDate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extracts the datetime of the first line in the log file. </p>
<p>Works only on uncompressed log files.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Log file pathname. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string DateTime or a message if the archive is compressed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01484">1484</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1485</span>    {</div>
<div class="line"><span class="lineno"> 1486</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>($this-&gt;_getLogStartDate($file));</div>
<div class="line"><span class="lineno"> 1487</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l01489">_getLogStartDate()</a>, and <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a40159dcd03e82eade9e96fd6b8080e89_cgraph.png" border="0" usemap="#aclassModel_a40159dcd03e82eade9e96fd6b8080e89_cgraph" alt=""/></div>
<map name="aclassModel_a40159dcd03e82eade9e96fd6b8080e89_cgraph" id="aclassModel_a40159dcd03e82eade9e96fd6b8080e89_cgraph">
<area shape="rect" title="Extracts the datetime of the first line in the log file." alt="" coords="5,183,136,208"/>
<area shape="rect" href="classModel.html#aab423e07962bdc1319b01c6d7c679f0f" title=" " alt="" coords="184,157,319,183"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="218,207,285,232"/>
<area shape="rect" href="classModel.html#ad8f9b01c41c50fcef015cc5444236024" title="Gets first line of file." alt="" coords="575,5,698,31"/>
<area shape="rect" href="classModel.html#a7ece271b0ef8636736f58b3b75268931" title="Gets the name of the file in the tmp folder." alt="" coords="367,181,525,207"/>
<area shape="rect" href="classModel.html#adef576154f41b9e06cbf28bb1a4f74b8" title="Checks if the given log file has been updated." alt="" coords="379,132,513,157"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="393,232,499,257"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="748,32,895,57"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="775,156,867,181"/>
<area shape="rect" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7" title="Gets the original file name for the given log file." alt="" coords="943,157,1077,183"/>
<area shape="rect" href="classModel.html#a2ef1e4c1d1fadd3c6696a101cd2aa7e5" title="Gets previous line count and stat() from statistics file." alt="" coords="573,107,700,132"/>
<area shape="rect" href="classModel.html#ae24c34977ae6864272b678fe40fdb09a" title="Gets name of the tmp statistics file for the given log file." alt="" coords="751,107,891,132"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="573,259,700,284"/>
</map>
</div>

</div>
</div>
<a id="ac74f9ae5abb475786f8f9278af56e953" name="ac74f9ae5abb475786f8f9278af56e953"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac74f9ae5abb475786f8f9278af56e953">&#9670;&#160;</a></span>GetModuleStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetModuleStatus </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$generate_status</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02797">2797</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2798</span>    {</div>
<div class="line"><span class="lineno"> 2799</span>        global <a class="code hl_variable" href="lib_2setup_8php.html#a757cdec67d8424a7b058bfaeebaae8c9">$StatusCheckInterval</a>;</div>
<div class="line"><span class="lineno"> 2800</span> </div>
<div class="line"><span class="lineno"> 2801</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>(json_encode($this-&gt;_getModuleStatus(<a class="code hl_variable" href="lib_2setup_8php.html#a757cdec67d8424a7b058bfaeebaae8c9">$StatusCheckInterval</a>, <a class="code hl_variable" href="View_2dhcpd_2dhcpd_8php.html#a83b72400c2ac339d288cdb20cd46a341">$generate_status</a>)));</div>
<div class="line"><span class="lineno"> 2802</span>    }</div>
<div class="ttc" id="alib_2setup_8php_html_a757cdec67d8424a7b058bfaeebaae8c9"><div class="ttname"><a href="lib_2setup_8php.html#a757cdec67d8424a7b058bfaeebaae8c9">$StatusCheckInterval</a></div><div class="ttdeci">$StatusCheckInterval</div><div class="ttdoc">Interval to check module status for displaying.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2setup_8php_source.html#l00038">setup.php:38</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="View_2dhcpd_2dhcpd_8php_source.html#l00025">$generate_status</a>, <a class="el" href="lib_2setup_8php_source.html#l00038">$StatusCheckInterval</a>, <a class="el" href="model_8php_source.html#l02804">_getModuleStatus()</a>, and <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ac74f9ae5abb475786f8f9278af56e953_cgraph.png" border="0" usemap="#aclassModel_ac74f9ae5abb475786f8f9278af56e953_cgraph" alt=""/></div>
<map name="aclassModel_ac74f9ae5abb475786f8f9278af56e953_cgraph" id="aclassModel_ac74f9ae5abb475786f8f9278af56e953_cgraph">
<area shape="rect" title=" " alt="" coords="5,207,140,232"/>
<area shape="rect" href="classModel.html#a5b9d9c5affe24f91a3151fa107ee80e4" title=" " alt="" coords="188,181,327,207"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="224,231,291,256"/>
<area shape="rect" href="classModel.html#a3216e14ab593ec9dcc7df09c995d8b1b" title=" " alt="" coords="375,55,524,80"/>
<area shape="rect" href="classModel.html#a75a2cec868b2b3cf1d0f2ae81a799298" title=" " alt="" coords="401,280,498,305"/>
<area shape="rect" href="classModel.html#a7fb8ac5678a9e42f00fb66780296bca9" title=" " alt="" coords="399,131,500,156"/>
<area shape="rect" href="classModel.html#a73fbf3721e73a688382663bf84e1e428" title="Checks if the given process(es) is running." alt="" coords="406,205,493,231"/>
<area shape="rect" href="classModel.html#a1151960aeff2e631b01f989afe5b2f7e" title=" " alt="" coords="593,5,718,31"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="609,55,701,80"/>
<area shape="rect" href="classModel.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="602,307,709,332"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="787,307,893,332"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="791,357,889,383"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="947,307,1073,332"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="1127,307,1180,332"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="941,408,1079,433"/>
<area shape="rect" href="classModel.html#a106f3eba1442c7e4cf721764772bc724" title=" " alt="" coords="572,156,739,181"/>
<area shape="rect" href="classModel.html#aead9ffea53f83ba54a7bc722dbc81841" title="Selects user processes from ps output." alt="" coords="592,205,719,231"/>
</map>
</div>

</div>
</div>
<a id="ae6cc2dcb5a8fe07db88766823322be7e" name="ae6cc2dcb5a8fe07db88766823322be7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6cc2dcb5a8fe07db88766823322be7e">&#9670;&#160;</a></span>GetName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetName </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if Name exists. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Config file </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$name</td><td>Name of NVP </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed Name or FALSE on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02429">2429</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2430</span>    {</div>
<div class="line"><span class="lineno"> 2431</span>        <span class="keywordflow">return</span> $this-&gt;SearchFile($file, <span class="stringliteral">&quot;/^\h*($name)(\h*$this-&gt;COMC.*|\h*)$/m&quot;</span>);</div>
<div class="line"><span class="lineno"> 2432</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00929">SearchFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02337">GetValue()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ae6cc2dcb5a8fe07db88766823322be7e_cgraph.png" border="0" usemap="#aclassModel_ae6cc2dcb5a8fe07db88766823322be7e_cgraph" alt=""/></div>
<map name="aclassModel_ae6cc2dcb5a8fe07db88766823322be7e_cgraph" id="aclassModel_ae6cc2dcb5a8fe07db88766823322be7e_cgraph">
<area shape="rect" title="Checks if Name exists." alt="" coords="5,5,89,31"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="137,5,227,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ae6cc2dcb5a8fe07db88766823322be7e_icgraph.png" border="0" usemap="#aclassModel_ae6cc2dcb5a8fe07db88766823322be7e_icgraph" alt=""/></div>
<map name="aclassModel_ae6cc2dcb5a8fe07db88766823322be7e_icgraph" id="aclassModel_ae6cc2dcb5a8fe07db88766823322be7e_icgraph">
<area shape="rect" title="Checks if Name exists." alt="" coords="312,5,396,31"/>
<area shape="rect" href="classModel.html#ae81727132988d14931750ce5e1c88bd7" title="Returns all enabled configuration for a given configuration type." alt="" coords="183,5,264,31"/>
<area shape="rect" href="classModel.html#a7b5bd25430f02d1925323e19f2861a9e" title="Gets all configuration for a given configuration type." alt="" coords="5,5,135,31"/>
</map>
</div>

</div>
</div>
<a id="ac6ce9b164f907bfe360c2f5dee6d1ab1" name="ac6ce9b164f907bfe360c2f5dee6d1ab1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6ce9b164f907bfe360c2f5dee6d1ab1">&#9670;&#160;</a></span>GetNewsyslogConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetNewsyslogConfig </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$model</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets newsyslog configuration for log file. </p>
<p>Certain log files do not have model classes, hence the $model param.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$model</td><td>Index to $ModelsToLogConfig </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed Configuration array or FALSE on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l03088">3088</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3089</span>    {</div>
<div class="line"><span class="lineno"> 3090</span>        $output= FALSE;</div>
<div class="line"><span class="lineno"> 3091</span>        <span class="keywordflow">if</span> (($contents= $this-&gt;GetFile($this-&gt;newSyslogConf)) !== FALSE) {</div>
<div class="line"><span class="lineno"> 3092</span>            $re_filepath= <a class="code hl_function" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9">Escape</a>($this-&gt;LogFile, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno"> 3093</span>            $re_owner= <span class="stringliteral">&#39;([\w:]+|)&#39;</span>;</div>
<div class="line"><span class="lineno"> 3094</span>            $re_mode= <span class="stringliteral">&#39;(\d+)&#39;</span>;</div>
<div class="line"><span class="lineno"> 3095</span>            $re_count= <span class="stringliteral">&#39;(\d+)&#39;</span>;</div>
<div class="line"><span class="lineno"> 3096</span>            $re_size= <span class="stringliteral">&#39;(\d+|\*)&#39;</span>;</div>
<div class="line"><span class="lineno"> 3097</span>            $re_when= <span class="stringliteral">&#39;(\d+|\*)&#39;</span>;</div>
<div class="line"><span class="lineno"> 3098</span> </div>
<div class="line"><span class="lineno"> 3099</span>            $re= <span class="stringliteral">&quot;/^\s*$re_filepath\s+$re_owner\s*$re_mode\s+$re_count\s+$re_size\s+$re_when\s+.*$/m&quot;</span>;</div>
<div class="line"><span class="lineno"> 3100</span>            <span class="keywordflow">if</span> (preg_match($re, $contents, $match)) {</div>
<div class="line"><span class="lineno"> 3101</span>                $output= array(</div>
<div class="line"><span class="lineno"> 3102</span>                    $this-&gt;LogFile =&gt; array(</div>
<div class="line"><span class="lineno"> 3103</span>                        <span class="stringliteral">&#39;Model&#39;</span> =&gt; $model,</div>
<div class="line"><span class="lineno"> 3104</span>                        <span class="stringliteral">&#39;Count&#39;</span> =&gt; $match[3],</div>
<div class="line"><span class="lineno"> 3105</span>                        <span class="stringliteral">&#39;Size&#39;</span> =&gt; $match[4],</div>
<div class="line"><span class="lineno"> 3106</span>                        <span class="stringliteral">&#39;When&#39;</span> =&gt; $match[5],</div>
<div class="line"><span class="lineno"> 3107</span>                        ),</div>
<div class="line"><span class="lineno"> 3108</span>                    );</div>
<div class="line"><span class="lineno"> 3109</span>            }</div>
<div class="line"><span class="lineno"> 3110</span>        }</div>
<div class="line"><span class="lineno"> 3111</span>        <span class="keywordflow">return</span> $output;</div>
<div class="line"><span class="lineno"> 3112</span>    }</div>
<div class="ttc" id="alib_2lib_8php_html_a998c26d78939d233b87794689e841eb9"><div class="ttname"><a href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9">Escape</a></div><div class="ttdeci">Escape($str, $chars, $no_double_escapes=TRUE)</div><div class="ttdoc">Escapes chars.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2lib_8php_source.html#l00080">lib.php:80</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="lib_2lib_8php_source.html#l00080">Escape()</a>, and <a class="el" href="model_8php_source.html#l00822">GetFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ac6ce9b164f907bfe360c2f5dee6d1ab1_cgraph.png" border="0" usemap="#aclassModel_ac6ce9b164f907bfe360c2f5dee6d1ab1_cgraph" alt=""/></div>
<map name="aclassModel_ac6ce9b164f907bfe360c2f5dee6d1ab1_cgraph" id="aclassModel_ac6ce9b164f907bfe360c2f5dee6d1ab1_cgraph">
<area shape="rect" title="Gets newsyslog configuration for log file." alt="" coords="5,31,163,56"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="211,5,279,31"/>
<area shape="rect" href="classModel.html#a91890c866a00b75b002e6b1016e6b43c" title="Reads file contents." alt="" coords="211,55,279,80"/>
</map>
</div>

</div>
</div>
<a id="a8f197a5f9e014dc06404352d2f4b7e20" name="a8f197a5f9e014dc06404352d2f4b7e20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f197a5f9e014dc06404352d2f4b7e20">&#9670;&#160;</a></span>GetNVP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetNVP </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$set</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$trimchars</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads value of NVP. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Config file. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$name</td><td>Name of NVP. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$set</td><td>There may be multiple parentheses in $re, which one to return. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$trimchars</td><td>Chars to trim in the results. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed Value of NVP or FALSE on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00915">915</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  916</span>    {</div>
<div class="line"><span class="lineno">  917</span>        <span class="keywordflow">return</span> $this-&gt;SearchFile($file, <span class="stringliteral">&quot;/^\h*$name\b\h*$this-&gt;NVPS\h*([^$this-&gt;COMC&#39;\&quot;\n]*|&#39;[^&#39;\n]*&#39;|\&quot;[^\&quot;\n]*\&quot;|[^$this-&gt;COMC\n]*)(\h*|\h*$this-&gt;COMC.*)$/m&quot;</span>, $set, $trimchars);</div>
<div class="line"><span class="lineno">  918</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00929">SearchFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l00515">_getExtIf()</a>, <a class="el" href="model_8php_source.html#l00500">_getIntIf()</a>, <a class="el" href="dnsmasq_8php_source.html#l00071">Dnsmasq\GetListenOn()</a>, <a class="el" href="model_8php_source.html#l02337">GetValue()</a>, and <a class="el" href="model_8php_source.html#l00878">SetNVP()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a8f197a5f9e014dc06404352d2f4b7e20_cgraph.png" border="0" usemap="#aclassModel_a8f197a5f9e014dc06404352d2f4b7e20_cgraph" alt=""/></div>
<map name="aclassModel_a8f197a5f9e014dc06404352d2f4b7e20_cgraph" id="aclassModel_a8f197a5f9e014dc06404352d2f4b7e20_cgraph">
<area shape="rect" title="Reads value of NVP." alt="" coords="5,5,77,31"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="125,5,215,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a8f197a5f9e014dc06404352d2f4b7e20_icgraph.png" border="0" usemap="#aclassModel_a8f197a5f9e014dc06404352d2f4b7e20_icgraph" alt=""/></div>
<map name="aclassModel_a8f197a5f9e014dc06404352d2f4b7e20_icgraph" id="aclassModel_a8f197a5f9e014dc06404352d2f4b7e20_icgraph">
<area shape="rect" title="Reads value of NVP." alt="" coords="711,948,783,973"/>
<area shape="rect" href="classModel.html#aa572c51a6d4aa52ec3029518451a05fe" title=" " alt="" coords="539,207,619,232"/>
<area shape="rect" href="classModel.html#a7abfd365d79fd5b34b3aab5d4ff0c770" title=" " alt="" coords="541,107,617,132"/>
<area shape="rect" href="classDnsmasq.html#a6ce8641410dc2a28206b2e8f6c9db6ff" title="Gets the interface that the DNS forwarder binds to listen for requests." alt="" coords="496,997,663,1023"/>
<area shape="rect" href="classModel.html#ae81727132988d14931750ce5e1c88bd7" title="Returns all enabled configuration for a given configuration type." alt="" coords="539,1367,620,1392"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="544,948,615,973"/>
<area shape="rect" href="classSystem.html#a6baa62a81a32e122dde71ac97c46fe9a" title="Reads hostname, gateway, and interface configuration." alt="" coords="249,156,387,181"/>
<area shape="rect" href="classModel.html#a190806315bf8a8147417f3735ba66bc5" title="Get ext_if." alt="" coords="281,257,355,283"/>
<area shape="rect" href="classModel.html#a5cf12375d05dca29b3c81333ff1882a2" title="Gets service statuses." alt="" coords="5,207,140,232"/>
<area shape="rect" href="classSystem.html#a6c0c91116842cbcd97f4311fea0acc8c" title="Restarts the network." alt="" coords="253,107,383,132"/>
<area shape="rect" href="classModel.html#a14573cc2fd34870091dfe7e8aa1ab171" title="Get int_if." alt="" coords="283,5,353,31"/>
<area shape="rect" href="classModel.html#a7b5bd25430f02d1925323e19f2861a9e" title="Gets all configuration for a given configuration type." alt="" coords="253,1688,383,1713"/>
<area shape="rect" href="classSystem.html#a7c21107fcd868c9590f376c07f02afaf" title=" " alt="" coords="251,1392,385,1417"/>
<area shape="rect" href="classSystem.html#a91b60c705c31df895a96ff1480ce85db" title=" " alt="" coords="229,1441,407,1467"/>
<area shape="rect" href="classSystem.html#a6f28b1520f68197fc3089c87d3ee5a86" title=" " alt="" coords="253,1491,383,1516"/>
<area shape="rect" href="classSystem.html#a77b569ce1603eae5f71e4f90e9e5c3a0" title=" " alt="" coords="231,1540,405,1565"/>
<area shape="rect" href="classSystem.html#a84af1d367e28f412bc9a7e07464defc6" title=" " alt="" coords="188,1589,448,1615"/>
<area shape="rect" href="classSystem.html#a896e4c34afa76bb1359be66b348597f6" title=" " alt="" coords="191,1639,445,1664"/>
<area shape="rect" href="classModel.html#a4c5f8b05e5cbfffe696da52ce05f066a" title="Sets the value of NVP configuration." alt="" coords="263,356,373,381"/>
<area shape="rect" href="classModel.html#a859ad1e51288c4d72ed9eda0f6f5e43e" title="Sets default locale." alt="" coords="251,405,385,431"/>
<area shape="rect" href="classModel.html#a396fea6ec5c2ad29ebee26ea36723133" title="Enables or disables HTTPs." alt="" coords="259,455,377,480"/>
<area shape="rect" href="classModel.html#abbf4c282267beb7f8667d0882d82b983" title="Enables or disables help boxes." alt="" coords="269,504,367,529"/>
<area shape="rect" href="classPf.html#a8a838a5a93147d20d19f2f4c44a16b23" title="Sets interface names in pf.conf." alt="" coords="280,553,356,579"/>
<area shape="rect" href="classPf.html#ae936293c9b2b0d90849d2c17acc1e6e8" title="Sets int_net." alt="" coords="269,603,367,628"/>
<area shape="rect" href="classDnsmasq.html#aafd6db1bc365b4992ffdc2894821194f" title="Sets the interface that the DNS forwarder binds to listen for requests." alt="" coords="235,652,401,677"/>
<area shape="rect" href="classModel.html#ace6809a36e1a52e1dde4c9d6d662ca4c" title="Sets global log level." alt="" coords="267,701,369,727"/>
<area shape="rect" href="classModel.html#ad3d333424199ea8d1475ffb779b5407c" title="Sets the max number of nested anchors allowed." alt="" coords="235,751,401,776"/>
<area shape="rect" href="classModel.html#a396a20de76a1a352c40b3eb64d21bce9" title="Sets max file size to process." alt="" coords="225,800,411,825"/>
<area shape="rect" href="classSystem.html#a59df788be29e03ef99af4f3a16fdb1a0" title=" " alt="" coords="257,849,379,875"/>
<area shape="rect" href="classSystem.html#af6fa08d72148c73798549ca54163b619" title=" " alt="" coords="243,899,393,924"/>
<area shape="rect" href="classSystem.html#ae08f689f2d21a3414d7f1f667a0d5350" title=" " alt="" coords="223,948,413,973"/>
<area shape="rect" href="classSystem.html#ac188e028fb53e14e566562ae2e805f09" title=" " alt="" coords="231,997,405,1023"/>
<area shape="rect" href="classSystem.html#a43705d78ea353c6e76f34342df25ea58" title=" " alt="" coords="219,1047,417,1072"/>
<area shape="rect" href="classSystem.html#a3ad0b53500536d14f25a7d95f819a977" title=" " alt="" coords="233,1096,403,1121"/>
<area shape="rect" href="classModel.html#a2b4ff4a876f224dcd90e3d5cb3e288a4" title="Sets pfctl timeout." alt="" coords="255,1145,381,1171"/>
<area shape="rect" href="classModel.html#add75f616f424040c62005634d34c20b0" title="Sets default reload rate." alt="" coords="259,1195,377,1220"/>
<area shape="rect" href="classModel.html#a3070438f6bedf2aeeeb313d7c32e5e1e" title="Sets session timeout." alt="" coords="245,1244,391,1269"/>
<area shape="rect" href="classModel.html#a31cfb3981a2789a48b91e3b2ea325681" title="Sets status check interval." alt="" coords="231,307,405,332"/>
<area shape="rect" href="classSystem.html#ad6ebf17ff7b76e126f2c94d29bde51d4" title=" " alt="" coords="241,1293,395,1319"/>
<area shape="rect" href="classModel.html#a760367a76e1eae0a8e8e7bc6c9e0579e" title="Enables or disables SSH." alt="" coords="271,1343,365,1368"/>
</map>
</div>

</div>
</div>
<a id="adf44e19a68f4a6be9289e2e39a5698f7" name="adf44e19a68f4a6be9289e2e39a5698f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf44e19a68f4a6be9289e2e39a5698f7">&#9670;&#160;</a></span>GetOrigFileName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetOrigFileName </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logfile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the original file name for the given log file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$logfile</td><td>Log file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string Log file name. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01594">1594</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1595</span>    {</div>
<div class="line"><span class="lineno"> 1596</span>        $origfilename= basename($logfile);</div>
<div class="line"><span class="lineno"> 1597</span>        <span class="comment">// Do not append an extra .gz to compressed files</span></div>
<div class="line"><span class="lineno"> 1598</span>        <span class="keywordflow">if</span> ((basename($this-&gt;LogFile) !== $origfilename) &amp;&amp; !preg_match(<span class="stringliteral">&#39;/\.gz$/&#39;</span>, $origfilename)) {</div>
<div class="line"><span class="lineno"> 1599</span>            $origfilename.= <span class="stringliteral">&#39;.gz&#39;</span>;</div>
<div class="line"><span class="lineno"> 1600</span>        }</div>
<div class="line"><span class="lineno"> 1601</span>        <span class="keywordflow">return</span> dirname($this-&gt;LogFile).<span class="charliteral">&#39;/&#39;</span>.$origfilename;</div>
<div class="line"><span class="lineno"> 1602</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01873">CountDiffLogLines()</a>, <a class="el" href="model_8php_source.html#l02096">GetStatsFileName()</a>, <a class="el" href="model_8php_source.html#l01094">IsLogFileModified()</a>, <a class="el" href="model_8php_source.html#l02117">SaveStats()</a>, and <a class="el" href="model_8php_source.html#l01144">UpdateTmpLogFile()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_adf44e19a68f4a6be9289e2e39a5698f7_icgraph.png" border="0" usemap="#aclassModel_adf44e19a68f4a6be9289e2e39a5698f7_icgraph" alt=""/></div>
<map name="aclassModel_adf44e19a68f4a6be9289e2e39a5698f7_icgraph" id="aclassModel_adf44e19a68f4a6be9289e2e39a5698f7_icgraph">
<area shape="rect" title="Gets the original file name for the given log file." alt="" coords="1069,180,1204,205"/>
<area shape="rect" href="classModel.html#ab1e8cbbabce3210438cebad028f153d7" title="Gets the number of lines added to log files since last tmp file update." alt="" coords="519,231,659,256"/>
<area shape="rect" href="classModel.html#ae24c34977ae6864272b678fe40fdb09a" title="Gets name of the tmp statistics file for the given log file." alt="" coords="881,180,1021,205"/>
<area shape="rect" href="classModel.html#adef576154f41b9e06cbf28bb1a4f74b8" title="Checks if the given log file has been updated." alt="" coords="521,129,656,155"/>
<area shape="rect" href="classModel.html#ab5448888d58c0402bcc575e3a5cd9e9e" title="Saves collected statistics with the current line count and stat() output." alt="" coords="727,281,813,307"/>
<area shape="rect" href="classModel.html#ad4d7aefbd214d3da3f1965e6ddddb998" title="Copies the original log file to tmp folder." alt="" coords="327,79,471,104"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="347,231,450,256"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="172,231,255,256"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="159,129,267,155"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,305,100,331"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,231,92,256"/>
<area shape="rect" href="classModel.html#a1149c6f5338677a1a74e8a4964826e80" title="Gets saved statistics for the given log file." alt="" coords="529,332,648,357"/>
<area shape="rect" href="classModel.html#a2ef1e4c1d1fadd3c6696a101cd2aa7e5" title="Gets previous line count and stat() from statistics file." alt="" coords="707,180,833,205"/>
<area shape="rect" href="classModel.html#aab423e07962bdc1319b01c6d7c679f0f" title=" " alt="" coords="331,29,466,55"/>
<area shape="rect" href="classModel.html#aed5ee3c735f862c4d99761b379f31729" title="Gets log files list with start dates." alt="" coords="153,55,274,80"/>
<area shape="rect" href="classModel.html#a40159dcd03e82eade9e96fd6b8080e89" title="Extracts the datetime of the first line in the log file." alt="" coords="148,5,279,31"/>
</map>
</div>

</div>
</div>
<a id="aa7dc2e292df1ab234a44e9e2a5b170b0" name="aa7dc2e292df1ab234a44e9e2a5b170b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7dc2e292df1ab234a44e9e2a5b170b0">&#9670;&#160;</a></span>GetPhyIfs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetPhyIfs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extracts physical interface names from ifconfig output. </p>
<p>Removes non-physical interfaces from the output.</p>
<dl class="section return"><dt>Returns</dt><dd>string Names of physical interfaces. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01031">1031</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1032</span>    {</div>
<div class="line"><span class="lineno"> 1033</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>($this-&gt;_getPhyIfs());</div>
<div class="line"><span class="lineno"> 1034</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l01036">_getPhyIfs()</a>, and <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aa7dc2e292df1ab234a44e9e2a5b170b0_cgraph.png" border="0" usemap="#aclassModel_aa7dc2e292df1ab234a44e9e2a5b170b0_cgraph" alt=""/></div>
<map name="aclassModel_aa7dc2e292df1ab234a44e9e2a5b170b0_cgraph" id="aclassModel_aa7dc2e292df1ab234a44e9e2a5b170b0_cgraph">
<area shape="rect" title="Extracts physical interface names from ifconfig output." alt="" coords="5,31,91,56"/>
<area shape="rect" href="classModel.html#a917be6afd7db6dec41becb528b1690d5" title=" " alt="" coords="139,5,229,31"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="151,55,217,80"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="277,5,424,31"/>
</map>
</div>

</div>
</div>
<a id="ac63c8a259bd05dfef1e6979a2c1f76d0" name="ac63c8a259bd05dfef1e6979a2c1f76d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac63c8a259bd05dfef1e6979a2c1f76d0">&#9670;&#160;</a></span>GetProcList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetProcList </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the list of processes running. </p>
<dl class="section return"><dt>Returns</dt><dd>mixed List of processes on success, FALSE on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00354">354</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  355</span>    {</div>
<div class="line"><span class="lineno">  356</span>        $cmd= preg_replace(<span class="stringliteral">&#39;/&lt;PROC&gt;/&#39;</span>, escapeshellarg($this-&gt;Proc), $this-&gt;psCmd);</div>
<div class="line"><span class="lineno">  357</span>        exec($cmd, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno">  358</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno">  359</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>(json_encode($this-&gt;SelectProcesses($output)));</div>
<div class="line"><span class="lineno">  360</span>        }</div>
<div class="line"><span class="lineno">  361</span>        <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>(implode(<span class="stringliteral">&quot;\n&quot;</span>, $output));</div>
<div class="line"><span class="lineno">  362</span>        <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Process list failed for $this-&gt;Proc&quot;</span>);</div>
<div class="line"><span class="lineno">  363</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  364</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>, <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>, and <a class="el" href="model_8php_source.html#l00372">SelectProcesses()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ac63c8a259bd05dfef1e6979a2c1f76d0_cgraph.png" border="0" usemap="#aclassModel_ac63c8a259bd05dfef1e6979a2c1f76d0_cgraph" alt=""/></div>
<map name="aclassModel_ac63c8a259bd05dfef1e6979a2c1f76d0_cgraph" id="aclassModel_ac63c8a259bd05dfef1e6979a2c1f76d0_cgraph">
<area shape="rect" title="Gets the list of processes running." alt="" coords="5,80,101,105"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="167,5,259,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="186,55,239,80"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="179,104,246,129"/>
<area shape="rect" href="classModel.html#aead9ffea53f83ba54a7bc722dbc81841" title="Selects user processes from ps output." alt="" coords="149,153,276,179"/>
</map>
</div>

</div>
</div>
<a id="a392e2975b79f55e83ed15c7c6ed8725c" name="a392e2975b79f55e83ed15c7c6ed8725c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a392e2975b79f55e83ed15c7c6ed8725c">&#9670;&#160;</a></span>GetProcStatLines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetProcStatLines </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logfile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Collects text statistics for the proc stats general page. </p>
<p>Builds the shell command to count with grep first. Counts the number of lines in the grep output.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$logfile</td><td>Log file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array Statistics. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01613">1613</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1614</span>    {</div>
<div class="line"><span class="lineno"> 1615</span>        global <a class="code hl_variable" href="defs_8php.html#acaae7b246b0fd77ae6400fa4868a593b">$StatsConf</a>;</div>
<div class="line"><span class="lineno"> 1616</span> </div>
<div class="line"><span class="lineno"> 1617</span>        <span class="keywordflow">if</span> (!$this-&gt;ValidateFile($logfile)) {</div>
<div class="line"><span class="lineno"> 1618</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1619</span>        }</div>
<div class="line"><span class="lineno"> 1620</span> </div>
<div class="line"><span class="lineno"> 1621</span>        $stats= array();</div>
<div class="line"><span class="lineno"> 1622</span>        <span class="keywordflow">foreach</span> (<a class="code hl_variable" href="defs_8php.html#acaae7b246b0fd77ae6400fa4868a593b">$StatsConf</a>[$this-&gt;Name] as $stat =&gt; $conf) {</div>
<div class="line"><span class="lineno"> 1623</span>            <span class="keywordflow">if</span> (isset($conf[<span class="stringliteral">&#39;Title&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1624</span>                <span class="keywordflow">if</span> (isset($conf[<span class="stringliteral">&#39;Cmd&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1625</span>                    $cmd= $conf[<span class="stringliteral">&#39;Cmd&#39;</span>];</div>
<div class="line"><span class="lineno"> 1626</span>                    <span class="keywordflow">if</span> (isset($conf[<span class="stringliteral">&#39;Needle&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1627</span>                        $cmd.= <span class="stringliteral">&#39; | /usr/bin/grep -a -E &lt;NDL&gt;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1628</span>                        $cmd= preg_replace(<span class="stringliteral">&#39;/&lt;NDL&gt;/&#39;</span>, escapeshellarg($conf[<span class="stringliteral">&#39;Needle&#39;</span>]), $cmd);</div>
<div class="line"><span class="lineno"> 1629</span>                    }</div>
<div class="line"><span class="lineno"> 1630</span>                    $cmd.= <span class="stringliteral">&#39; | /usr/bin/wc -l&#39;</span>;</div>
<div class="line"><span class="lineno"> 1631</span>                }</div>
<div class="line"><span class="lineno"> 1632</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isset($conf[<span class="stringliteral">&#39;Needle&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1633</span>                    $cmd= <span class="stringliteral">&#39;/usr/bin/grep -a -E &lt;NDL&gt; &lt;LF&gt; | /usr/bin/wc -l&#39;</span>;</div>
<div class="line"><span class="lineno"> 1634</span>                    $cmd= preg_replace(<span class="stringliteral">&#39;/&lt;NDL&gt;/&#39;</span>, escapeshellarg($conf[<span class="stringliteral">&#39;Needle&#39;</span>]), $cmd);</div>
<div class="line"><span class="lineno"> 1635</span>                }</div>
<div class="line"><span class="lineno"> 1636</span>                <span class="keywordflow">if</span> ($logfile == <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1637</span>                    $logfile= <a class="code hl_variable" href="logs_8archives_8php.html#a09ce856a444e6c8704d1c5cc9f63e347">$this-&gt;LogFile</a>;</div>
<div class="line"><span class="lineno"> 1638</span>                }</div>
<div class="line"><span class="lineno"> 1639</span>                $cmd= preg_replace(<span class="stringliteral">&#39;/&lt;LF&gt;/&#39;</span>, $logfile, $cmd);</div>
<div class="line"><span class="lineno"> 1640</span> </div>
<div class="line"><span class="lineno"> 1641</span>                $stats[$conf[<span class="stringliteral">&#39;Title&#39;</span>]]= trim($this-&gt;<a class="code hl_function" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8">RunShellCommand</a>($cmd));</div>
<div class="line"><span class="lineno"> 1642</span>            }</div>
<div class="line"><span class="lineno"> 1643</span>        }</div>
<div class="line"><span class="lineno"> 1644</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>(json_encode($stats));</div>
<div class="line"><span class="lineno"> 1645</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="logs_8archives_8php_source.html#l00044">$LogFile</a>, <a class="el" href="defs_8php_source.html#l00202">$StatsConf</a>, <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>, <a class="el" href="model_8php_source.html#l00791">RunShellCommand()</a>, and <a class="el" href="model_8php_source.html#l01838">ValidateFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a392e2975b79f55e83ed15c7c6ed8725c_cgraph.png" border="0" usemap="#aclassModel_a392e2975b79f55e83ed15c7c6ed8725c_cgraph" alt=""/></div>
<map name="aclassModel_a392e2975b79f55e83ed15c7c6ed8725c_cgraph" id="aclassModel_a392e2975b79f55e83ed15c7c6ed8725c_cgraph">
<area shape="rect" title="Collects text statistics for the proc stats general page." alt="" coords="5,55,139,80"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="227,5,293,31"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="187,55,333,80"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="211,104,309,129"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="567,104,620,129"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="381,129,519,155"/>
</map>
</div>

</div>
</div>
<a id="a0601a366475cb83c65f99ad10e663de0" name="a0601a366475cb83c65f99ad10e663de0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0601a366475cb83c65f99ad10e663de0">&#9670;&#160;</a></span>GetReloadRate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetReloadRate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets default reload rate. </p>
<dl class="section return"><dt>Returns</dt><dd>string Reload rate in seconds. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00755">755</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  756</span>    {</div>
<div class="line"><span class="lineno">  757</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>($this-&gt;_getReloadRate());</div>
<div class="line"><span class="lineno">  758</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00760">_getReloadRate()</a>, and <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a0601a366475cb83c65f99ad10e663de0_cgraph.png" border="0" usemap="#aclassModel_a0601a366475cb83c65f99ad10e663de0_cgraph" alt=""/></div>
<map name="aclassModel_a0601a366475cb83c65f99ad10e663de0_cgraph" id="aclassModel_a0601a366475cb83c65f99ad10e663de0_cgraph">
<area shape="rect" title="Gets default reload rate." alt="" coords="5,31,125,56"/>
<area shape="rect" href="classModel.html#a1151960aeff2e631b01f989afe5b2f7e" title=" " alt="" coords="173,5,299,31"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="203,55,269,80"/>
</map>
</div>

</div>
</div>
<a id="a106f3eba1442c7e4cf721764772bc724" name="a106f3eba1442c7e4cf721764772bc724"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a106f3eba1442c7e4cf721764772bc724">&#9670;&#160;</a></span>getRrdfetchResolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getRrdfetchResolution </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$output</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02960">2960</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2961</span>    {</div>
<div class="line"><span class="lineno"> 2962</span>        $resolution= 0;</div>
<div class="line"><span class="lineno"> 2963</span>        $startTime= 0;</div>
<div class="line"><span class="lineno"> 2964</span>        <span class="keywordflow">foreach</span> ($output as $o) {</div>
<div class="line"><span class="lineno"> 2965</span>            <span class="comment">// 1626645180: 0.0000000000e+00</span></div>
<div class="line"><span class="lineno"> 2966</span>            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/^(\d+):\s+\S+$/&#39;</span>, $o, $match)) {</div>
<div class="line"><span class="lineno"> 2967</span>                <span class="keywordflow">if</span> (!$startTime) {</div>
<div class="line"><span class="lineno"> 2968</span>                    $startTime= intval($match[1]);</div>
<div class="line"><span class="lineno"> 2969</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2970</span>                    <span class="comment">// endTime - startTime</span></div>
<div class="line"><span class="lineno"> 2971</span>                    $resolution= intval($match[1]) - $startTime;</div>
<div class="line"><span class="lineno"> 2972</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2973</span>                }</div>
<div class="line"><span class="lineno"> 2974</span>            }</div>
<div class="line"><span class="lineno"> 2975</span>        }</div>
<div class="line"><span class="lineno"> 2976</span>        <span class="keywordflow">return</span> $resolution;</div>
<div class="line"><span class="lineno"> 2977</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02906">getRrdValue()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a106f3eba1442c7e4cf721764772bc724_icgraph.png" border="0" usemap="#aclassModel_a106f3eba1442c7e4cf721764772bc724_icgraph" alt=""/></div>
<map name="aclassModel_a106f3eba1442c7e4cf721764772bc724_icgraph" id="aclassModel_a106f3eba1442c7e4cf721764772bc724_icgraph">
<area shape="rect" title=" " alt="" coords="568,55,735,80"/>
<area shape="rect" href="classModel.html#a7fb8ac5678a9e42f00fb66780296bca9" title=" " alt="" coords="419,55,520,80"/>
<area shape="rect" href="classOpenssh.html#a65ffe7950ba3a608bd8839a16ab88fe5" title=" " alt="" coords="188,5,371,31"/>
<area shape="rect" href="classModel.html#a5b9d9c5affe24f91a3151fa107ee80e4" title=" " alt="" coords="210,55,349,80"/>
<area shape="rect" href="classModel.html#ab735f5a4ded9f9c9a5b04f182205fd7d" title=" " alt="" coords="236,104,323,129"/>
<area shape="rect" href="classModel.html#ac74f9ae5abb475786f8f9278af56e953" title=" " alt="" coords="5,55,140,80"/>
</map>
</div>

</div>
</div>
<a id="a7fb8ac5678a9e42f00fb66780296bca9" name="a7fb8ac5678a9e42f00fb66780296bca9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fb8ac5678a9e42f00fb66780296bca9">&#9670;&#160;</a></span>getRrdValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getRrdValue </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$rrd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$start</em> = <code>60</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$type</em> = <code>'derive'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section attention"><dt>Attention</dt><dd>We cannot use the Interval in collectd.conf</dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02906">2906</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2907</span>    {</div>
<div class="line"><span class="lineno"> 2908</span>        $result= FALSE;</div>
<div class="line"><span class="lineno"> 2909</span> </div>
<div class="line"><span class="lineno"> 2910</span>        $rrd= <span class="stringliteral">&quot;{$this-&gt;CollectdRrdFolder}/tail-{$this-&gt;CollectdName}/$rrd&quot;</span>;</div>
<div class="line"><span class="lineno"> 2911</span> </div>
<div class="line"><span class="lineno"> 2912</span>        <span class="keywordflow">if</span> (!file_exists($rrd)) {</div>
<div class="line"><span class="lineno"> 2913</span>            <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>(_(<span class="stringliteral">&#39;RRD file does not exist&#39;</span>).<span class="stringliteral">&#39;: &#39;</span>.$rrd);</div>
<div class="line"><span class="lineno"> 2914</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_INFO, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;RRD file does not exist: $rrd&quot;</span>);</div>
<div class="line"><span class="lineno"> 2915</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2916</span>        }</div>
<div class="line"><span class="lineno"> 2917</span> </div>
<div class="line"><span class="lineno"> 2918</span>        $value= 0;</div>
<div class="line"><span class="lineno"> 2919</span> </div>
<div class="line"><span class="lineno"> 2920</span>        <span class="comment">// Ask rrdtool to use the highest resolution possible: 10 seconds</span></div>
<div class="line"><span class="lineno"> 2921</span>        <span class="comment">// Passing -r $start can produce shorter output, but it is not reliable, seems too lossy</span></div>
<div class="line"><span class="lineno"> 2922</span>        $cmd= <span class="stringliteral">&quot;/usr/local/bin/rrdtool fetch $rrd AVERAGE -s -$start -r 10&quot;</span>;</div>
<div class="line"><span class="lineno"> 2923</span> </div>
<div class="line"><span class="lineno"> 2924</span>        exec($cmd, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno"> 2925</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno"> 2926</span>            <span class="keywordflow">if</span> ($type == <span class="stringliteral">&#39;derive&#39;</span>) {</div>
<div class="line"><span class="lineno"> 2928</span>                <span class="comment">// rrdfetch chooses its own resolution close to what we asked for</span></div>
<div class="line"><span class="lineno"> 2929</span>                <span class="comment">// so we have to compute it ourselves in the output</span></div>
<div class="line"><span class="lineno"> 2930</span>                $resolution= $this-&gt;getRrdfetchResolution($output);</div>
<div class="line"><span class="lineno"> 2931</span>                <span class="keywordflow">if</span> (!$resolution) {</div>
<div class="line"><span class="lineno"> 2932</span>                    <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>(_(<span class="stringliteral">&#39;Cannot determine the resolution in rrdfetch output&#39;</span>).<span class="stringliteral">&quot;: $cmd&quot;</span>);</div>
<div class="line"><span class="lineno"> 2933</span>                    <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Cannot determine the resolution in rrdfetch output: $cmd&quot;</span>);</div>
<div class="line"><span class="lineno"> 2934</span>                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2935</span>                }</div>
<div class="line"><span class="lineno"> 2936</span>            }</div>
<div class="line"><span class="lineno"> 2937</span> </div>
<div class="line"><span class="lineno"> 2938</span>            <span class="keywordflow">foreach</span> ($output as $o) {</div>
<div class="line"><span class="lineno"> 2939</span>                <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/^\d+:\s+(\S+)$/&#39;</span>, $o, $match)) {</div>
<div class="line"><span class="lineno"> 2940</span>                    <span class="keywordflow">if</span> ($match[1] != <span class="stringliteral">&#39;nan&#39;</span>) {</div>
<div class="line"><span class="lineno"> 2941</span>                        $v= floatval($match[1]);</div>
<div class="line"><span class="lineno"> 2942</span>                        <span class="keywordflow">if</span> ($type == <span class="stringliteral">&#39;gauge&#39;</span>) {</div>
<div class="line"><span class="lineno"> 2943</span>                            $value= max($value, $v);</div>
<div class="line"><span class="lineno"> 2944</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2945</span>                            $value+= $v * $resolution;</div>
<div class="line"><span class="lineno"> 2946</span>                        }</div>
<div class="line"><span class="lineno"> 2947</span>                    }</div>
<div class="line"><span class="lineno"> 2948</span>                }</div>
<div class="line"><span class="lineno"> 2949</span>            }</div>
<div class="line"><span class="lineno"> 2950</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2951</span>            <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>(_(<span class="stringliteral">&#39;Failed executing rrdfetch&#39;</span>).<span class="stringliteral">&quot;: $cmd&quot;</span>);</div>
<div class="line"><span class="lineno"> 2952</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Failed executing rrdfetch: $cmd&quot;</span>);</div>
<div class="line"><span class="lineno"> 2953</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2954</span>        }</div>
<div class="line"><span class="lineno"> 2955</span> </div>
<div class="line"><span class="lineno"> 2956</span>        $result= TRUE;</div>
<div class="line"><span class="lineno"> 2957</span>        <span class="keywordflow">return</span> round($value);</div>
<div class="line"><span class="lineno"> 2958</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>, and <a class="el" href="model_8php_source.html#l02960">getRrdfetchResolution()</a>.</p>

<p class="reference">Referenced by <a class="el" href="openssh_8php_source.html#l00082">Openssh\_getModuleInfo()</a>, <a class="el" href="model_8php_source.html#l02804">_getModuleStatus()</a>, and <a class="el" href="model_8php_source.html#l02979">GetStatus()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a7fb8ac5678a9e42f00fb66780296bca9_cgraph.png" border="0" usemap="#aclassModel_a7fb8ac5678a9e42f00fb66780296bca9_cgraph" alt=""/></div>
<map name="aclassModel_a7fb8ac5678a9e42f00fb66780296bca9_cgraph" id="aclassModel_a7fb8ac5678a9e42f00fb66780296bca9_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,107,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="192,5,284,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="211,55,265,80"/>
<area shape="rect" href="classModel.html#a106f3eba1442c7e4cf721764772bc724" title=" " alt="" coords="155,104,321,129"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a7fb8ac5678a9e42f00fb66780296bca9_icgraph.png" border="0" usemap="#aclassModel_a7fb8ac5678a9e42f00fb66780296bca9_icgraph" alt=""/></div>
<map name="aclassModel_a7fb8ac5678a9e42f00fb66780296bca9_icgraph" id="aclassModel_a7fb8ac5678a9e42f00fb66780296bca9_icgraph">
<area shape="rect" title=" " alt="" coords="419,55,520,80"/>
<area shape="rect" href="classOpenssh.html#a65ffe7950ba3a608bd8839a16ab88fe5" title=" " alt="" coords="188,5,371,31"/>
<area shape="rect" href="classModel.html#a5b9d9c5affe24f91a3151fa107ee80e4" title=" " alt="" coords="210,55,349,80"/>
<area shape="rect" href="classModel.html#ab735f5a4ded9f9c9a5b04f182205fd7d" title=" " alt="" coords="236,104,323,129"/>
<area shape="rect" href="classModel.html#ac74f9ae5abb475786f8f9278af56e953" title=" " alt="" coords="5,55,140,80"/>
</map>
</div>

</div>
</div>
<a id="a1149c6f5338677a1a74e8a4964826e80" name="a1149c6f5338677a1a74e8a4964826e80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1149c6f5338677a1a74e8a4964826e80">&#9670;&#160;</a></span>GetSavedStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetSavedStats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$briefstats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets saved statistics for the given log file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$logfile</td><td>Log file. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$stats</td><td>Statistics. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$briefstats</td><td>Brief statistics. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02033">2033</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2034</span>    {</div>
<div class="line"><span class="lineno"> 2035</span>        $statsfile= $this-&gt;GetStatsFileName($logfile);</div>
<div class="line"><span class="lineno"> 2036</span>        <span class="keywordflow">if</span> (($filecontents= $this-&gt;GetFile($statsfile)) !== FALSE) {</div>
<div class="line"><span class="lineno"> 2037</span>            <span class="keywordflow">if</span> ($serialized_stats= preg_replace(<span class="stringliteral">&quot;|^(&lt;filestat&gt;.*&lt;/filestat&gt;\s)|m&quot;</span>, <span class="stringliteral">&#39;&#39;</span>, $filecontents)) {</div>
<div class="line"><span class="lineno"> 2038</span>                $allstats= json_decode($serialized_stats, TRUE);</div>
<div class="line"><span class="lineno"> 2039</span>                <span class="keywordflow">if</span> (isset($allstats[<span class="stringliteral">&#39;stats&#39;</span>]) &amp;&amp; isset($allstats[<span class="stringliteral">&#39;briefstats&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2040</span>                    $stats= $allstats[<span class="stringliteral">&#39;stats&#39;</span>];</div>
<div class="line"><span class="lineno"> 2041</span>                    $briefstats= $allstats[<span class="stringliteral">&#39;briefstats&#39;</span>];</div>
<div class="line"><span class="lineno"> 2042</span>                    <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 2043</span>                }</div>
<div class="line"><span class="lineno"> 2044</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2045</span>                    <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Missing stats in file: $statsfile&quot;</span>);</div>
<div class="line"><span class="lineno"> 2046</span>                }</div>
<div class="line"><span class="lineno"> 2047</span>            }</div>
<div class="line"><span class="lineno"> 2048</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2049</span>                <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;filestat removal failed in file: $statsfile&quot;</span>);</div>
<div class="line"><span class="lineno"> 2050</span>            }</div>
<div class="line"><span class="lineno"> 2051</span>        }</div>
<div class="line"><span class="lineno"> 2052</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2053</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="model_8php_source.html#l00822">GetFile()</a>, and <a class="el" href="model_8php_source.html#l02096">GetStatsFileName()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01780">_getStats()</a>, <a class="el" href="model_8php_source.html#l01742">GetAllStats()</a>, and <a class="el" href="model_8php_source.html#l01919">UpdateStats()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a1149c6f5338677a1a74e8a4964826e80_cgraph.png" border="0" usemap="#aclassModel_a1149c6f5338677a1a74e8a4964826e80_cgraph" alt=""/></div>
<map name="aclassModel_a1149c6f5338677a1a74e8a4964826e80_cgraph" id="aclassModel_a1149c6f5338677a1a74e8a4964826e80_cgraph">
<area shape="rect" title="Gets saved statistics for the given log file." alt="" coords="5,55,124,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="196,5,288,31"/>
<area shape="rect" href="classModel.html#a91890c866a00b75b002e6b1016e6b43c" title="Reads file contents." alt="" coords="208,55,276,80"/>
<area shape="rect" href="classModel.html#ae24c34977ae6864272b678fe40fdb09a" title="Gets name of the tmp statistics file for the given log file." alt="" coords="172,104,312,129"/>
<area shape="rect" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7" title="Gets the original file name for the given log file." alt="" coords="360,104,495,129"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a1149c6f5338677a1a74e8a4964826e80_icgraph.png" border="0" usemap="#aclassModel_a1149c6f5338677a1a74e8a4964826e80_icgraph" alt=""/></div>
<map name="aclassModel_a1149c6f5338677a1a74e8a4964826e80_icgraph" id="aclassModel_a1149c6f5338677a1a74e8a4964826e80_icgraph">
<area shape="rect" title="Gets saved statistics for the given log file." alt="" coords="455,55,573,80"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,55,243,80"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="304,105,407,131"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,105,256,131"/>
</map>
</div>

</div>
</div>
<a id="ad150b90d723746fef93c906fb8548a9e" name="ad150b90d723746fef93c906fb8548a9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad150b90d723746fef93c906fb8548a9e">&#9670;&#160;</a></span>GetSensors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetSensors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds sysctl temp and fan sensors. </p>
<p>There may be multiple sensors. And we don't know which is CPU sensor.</p>
<dl class="section return"><dt>Returns</dt><dd>array Sensors extracted from sysctl output, FALSE if error or no sensors. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l03177">3177</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3178</span>    {</div>
<div class="line"><span class="lineno"> 3179</span>        <span class="keywordflow">if</span> (($hwsensors= $this-&gt;_getSysCtl(<span class="stringliteral">&#39;hw.sensors&#39;</span>)) !== FALSE) {</div>
<div class="line"><span class="lineno"> 3180</span>            $hwsensors= explode(<span class="stringliteral">&quot;\n&quot;</span>, $hwsensors);</div>
<div class="line"><span class="lineno"> 3181</span> </div>
<div class="line"><span class="lineno"> 3182</span>            <span class="keywordflow">if</span> (count($hwsensors) &gt; 0) {</div>
<div class="line"><span class="lineno"> 3183</span>                $tempsensors= array();</div>
<div class="line"><span class="lineno"> 3184</span>                $fansensors= array();</div>
<div class="line"><span class="lineno"> 3185</span>                <span class="keywordflow">foreach</span> ($hwsensors as $sensor) {</div>
<div class="line"><span class="lineno"> 3186</span>                    <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&quot;/^hw\.sensors\.(\w+\d+\.temp\d+)/&quot;</span>, $sensor, $match)) {</div>
<div class="line"><span class="lineno"> 3187</span>                        <span class="keywordflow">if</span> (!in_array($match[1], $tempsensors)) {</div>
<div class="line"><span class="lineno"> 3188</span>                            $tempsensors[]= $match[1];</div>
<div class="line"><span class="lineno"> 3189</span>                        }</div>
<div class="line"><span class="lineno"> 3190</span>                    }</div>
<div class="line"><span class="lineno"> 3191</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&quot;/^hw\.sensors\.(\w+\d+\.fan\d+)/&quot;</span>, $sensor, $match)) {</div>
<div class="line"><span class="lineno"> 3192</span>                        <span class="keywordflow">if</span> (!in_array($match[1], $fansensors)) {</div>
<div class="line"><span class="lineno"> 3193</span>                            $fansensors[]= $match[1];</div>
<div class="line"><span class="lineno"> 3194</span>                        }</div>
<div class="line"><span class="lineno"> 3195</span>                    }</div>
<div class="line"><span class="lineno"> 3196</span>                }</div>
<div class="line"><span class="lineno"> 3197</span>                </div>
<div class="line"><span class="lineno"> 3198</span>                <span class="keywordflow">return</span> array(</div>
<div class="line"><span class="lineno"> 3199</span>                    <span class="stringliteral">&#39;temp&#39;</span>  =&gt; $tempsensors,</div>
<div class="line"><span class="lineno"> 3200</span>                    <span class="stringliteral">&#39;fan&#39;</span>   =&gt; $fansensors,</div>
<div class="line"><span class="lineno"> 3201</span>                    );</div>
<div class="line"><span class="lineno"> 3202</span>            }</div>
<div class="line"><span class="lineno"> 3203</span>        }</div>
<div class="line"><span class="lineno"> 3204</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 3205</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l03050">_getSysCtl()</a>.</p>

<p class="reference">Referenced by <a class="el" href="symon_8php_source.html#l00117">Symon\SetConf()</a>, and <a class="el" href="symon_8php_source.html#l00278">Symon\SetSensors()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ad150b90d723746fef93c906fb8548a9e_cgraph.png" border="0" usemap="#aclassModel_ad150b90d723746fef93c906fb8548a9e_cgraph" alt=""/></div>
<map name="aclassModel_ad150b90d723746fef93c906fb8548a9e_cgraph" id="aclassModel_ad150b90d723746fef93c906fb8548a9e_cgraph">
<area shape="rect" title="Finds sysctl temp and fan sensors." alt="" coords="5,5,101,31"/>
<area shape="rect" href="classModel.html#a5e24130261dd255285454c45adc570eb" title=" " alt="" coords="149,5,240,31"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="288,5,435,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ad150b90d723746fef93c906fb8548a9e_icgraph.png" border="0" usemap="#aclassModel_ad150b90d723746fef93c906fb8548a9e_icgraph" alt=""/></div>
<map name="aclassModel_ad150b90d723746fef93c906fb8548a9e_icgraph" id="aclassModel_ad150b90d723746fef93c906fb8548a9e_icgraph">
<area shape="rect" title="Finds sysctl temp and fan sensors." alt="" coords="196,31,292,56"/>
<area shape="rect" href="classSymon.html#a7cfa59b60de90b66fac33786564689da" title="Sets interface names in the symon and symux config files." alt="" coords="15,5,138,31"/>
<area shape="rect" href="classSymon.html#a50f7fad3eb7f171ae72bcafa7c8a2275" title=" " alt="" coords="5,55,148,80"/>
</map>
</div>

</div>
</div>
<a id="a5cf12375d05dca29b3c81333ff1882a2" name="a5cf12375d05dca29b3c81333ff1882a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cf12375d05dca29b3c81333ff1882a2">&#9670;&#160;</a></span>GetServiceStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetServiceStatus </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$get_info</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$start</em> = <code>'10min'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$interval_changed</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets service statuses. </p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02683">2683</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2684</span>    {</div>
<div class="line"><span class="lineno"> 2685</span>        global <a class="code hl_variable" href="defs_8php.html#a05492353e037e388cf7282041359336c">$MODEL_PATH</a>, <a class="code hl_variable" href="Controller_2lib_8php.html#aa3999bc30aa5307623a99e2f4aec8d01">$ModelFiles</a>, <a class="code hl_variable" href="Controller_2lib_8php.html#acabe457fb176ac2d698dabd5703a1c5b">$Models</a>, <a class="code hl_variable" href="defs_8php.html#a0083e4f029931a1eca1a72f558d0457f">$ModelsToStat</a>, <a class="code hl_variable" href="defs_8php.html#adf0d224b08caed0281790f5861eee95b">$DashboardIntervals2Seconds</a>;</div>
<div class="line"><span class="lineno"> 2686</span> </div>
<div class="line"><span class="lineno"> 2687</span>        <span class="keywordflow">if</span> ($interval_changed) {</div>
<div class="line"><span class="lineno"> 2688</span>            $this-&gt;SetStatusCheckInterval(<a class="code hl_variable" href="defs_8php.html#adf0d224b08caed0281790f5861eee95b">$DashboardIntervals2Seconds</a>[$start]);</div>
<div class="line"><span class="lineno"> 2689</span>        }</div>
<div class="line"><span class="lineno"> 2690</span> </div>
<div class="line"><span class="lineno"> 2691</span>        $info= array();</div>
<div class="line"><span class="lineno"> 2692</span>        $cacheInfo= <a class="code hl_variable" href="defs_8php.html#aa8d15384fc15e1dedc917fe43ebf78e2">PFFWDIR</a>.<span class="stringliteral">&#39;/cache/info.json&#39;</span>;</div>
<div class="line"><span class="lineno"> 2693</span> </div>
<div class="line"><span class="lineno"> 2694</span>        <span class="keywordflow">if</span> ($get_info &amp;&amp; ($interval_changed || !$this-&gt;getCachedContents($cacheInfo, $info))) {</div>
<div class="line"><span class="lineno"> 2695</span>            <span class="keywordflow">if</span> (($intif= $this-&gt;_getIntIf()) !== FALSE) {</div>
<div class="line"><span class="lineno"> 2696</span>                $intif= trim($intif, <span class="charliteral">&#39;&quot;&#39;</span>);</div>
<div class="line"><span class="lineno"> 2697</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2698</span>                $intif= <span class="stringliteral">&#39;lan0&#39;</span>;</div>
<div class="line"><span class="lineno"> 2699</span>                <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;Cannot get internal interface name&#39;</span>);</div>
<div class="line"><span class="lineno"> 2700</span>            }</div>
<div class="line"><span class="lineno"> 2701</span> </div>
<div class="line"><span class="lineno"> 2702</span>            <span class="keywordflow">if</span> (($extif= $this-&gt;<a class="code hl_function" href="classModel.html#aa572c51a6d4aa52ec3029518451a05fe">_getExtIf</a>()) !== FALSE) {</div>
<div class="line"><span class="lineno"> 2703</span>                $extif= trim($extif, <span class="charliteral">&#39;&quot;&#39;</span>);</div>
<div class="line"><span class="lineno"> 2704</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2705</span>                $extif= <span class="stringliteral">&#39;wan0&#39;</span>;</div>
<div class="line"><span class="lineno"> 2706</span>                <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;Cannot get external interface name&#39;</span>);</div>
<div class="line"><span class="lineno"> 2707</span>            }</div>
<div class="line"><span class="lineno"> 2708</span> </div>
<div class="line"><span class="lineno"> 2709</span>            <span class="comment">// @attention Use $model, not $this here, otherwise $this is an instance of System class, which has its own _getPartitions() method</span></div>
<div class="line"><span class="lineno"> 2710</span>            <span class="comment">// Model has the _getPartitions() method we want</span></div>
<div class="line"><span class="lineno"> 2711</span>            $model= <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceModel.html">Model</a>();</div>
<div class="line"><span class="lineno"> 2712</span>            $partitions= $model-&gt;_getPartitions();</div>
<div class="line"><span class="lineno"> 2713</span> </div>
<div class="line"><span class="lineno"> 2714</span>            $disks= array();</div>
<div class="line"><span class="lineno"> 2715</span>            <span class="keywordflow">foreach</span> ($partitions as $part =&gt; $mdir) {</div>
<div class="line"><span class="lineno"> 2716</span>                <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;|/dev/((\w+\d+)[a-z]+)|&#39;</span>, $part, $match)) {</div>
<div class="line"><span class="lineno"> 2717</span>                    <span class="keywordflow">if</span> (!in_array($match[2], $disks)) {</div>
<div class="line"><span class="lineno"> 2718</span>                        $disks[]= $match[2];</div>
<div class="line"><span class="lineno"> 2719</span>                    }</div>
<div class="line"><span class="lineno"> 2720</span>                }</div>
<div class="line"><span class="lineno"> 2721</span>            }</div>
<div class="line"><span class="lineno"> 2722</span> </div>
<div class="line"><span class="lineno"> 2723</span>            $disk= <span class="stringliteral">&#39;wd0&#39;</span>;</div>
<div class="line"><span class="lineno"> 2724</span>            <span class="keywordflow">if</span> (count($disks) &gt; 0) {</div>
<div class="line"><span class="lineno"> 2725</span>                $disk= $disks[0];</div>
<div class="line"><span class="lineno"> 2726</span>            }</div>
<div class="line"><span class="lineno"> 2727</span> </div>
<div class="line"><span class="lineno"> 2728</span>            exec(<span class="stringliteral">&quot;doas sh $MODEL_PATH/rrdgraph.sh -$start $intif $extif $disk $interval_changed&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno"> 2729</span>            <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>(implode(<span class="stringliteral">&quot;\n&quot;</span>, $output));</div>
<div class="line"><span class="lineno"> 2730</span> </div>
<div class="line"><span class="lineno"> 2731</span>            <span class="keywordflow">foreach</span> (<a class="code hl_variable" href="defs_8php.html#a0083e4f029931a1eca1a72f558d0457f">$ModelsToStat</a> as $name =&gt; $caption) {</div>
<div class="line"><span class="lineno"> 2732</span>                require_once(<a class="code hl_variable" href="defs_8php.html#a05492353e037e388cf7282041359336c">$MODEL_PATH</a>.<span class="charliteral">&#39;/&#39;</span>.<a class="code hl_variable" href="Controller_2lib_8php.html#aa3999bc30aa5307623a99e2f4aec8d01">$ModelFiles</a>[$name]);</div>
<div class="line"><span class="lineno"> 2733</span>                $model= <span class="keyword">new</span> <a class="code hl_variable" href="Controller_2lib_8php.html#acabe457fb176ac2d698dabd5703a1c5b">$Models</a>[$name]();</div>
<div class="line"><span class="lineno"> 2734</span> </div>
<div class="line"><span class="lineno"> 2735</span>                $module_info= $model-&gt;_getModuleInfo(<a class="code hl_variable" href="defs_8php.html#adf0d224b08caed0281790f5861eee95b">$DashboardIntervals2Seconds</a>[$start]);</div>
<div class="line"><span class="lineno"> 2736</span>                <span class="keywordflow">if</span> ($module_info !== FALSE) {</div>
<div class="line"><span class="lineno"> 2737</span>                    $info[$name]= $module_info;</div>
<div class="line"><span class="lineno"> 2738</span>                }</div>
<div class="line"><span class="lineno"> 2739</span>            }</div>
<div class="line"><span class="lineno"> 2740</span> </div>
<div class="line"><span class="lineno"> 2741</span>            file_put_contents($cacheInfo, json_encode($info), LOCK_EX);</div>
<div class="line"><span class="lineno"> 2742</span>        }</div>
<div class="line"><span class="lineno"> 2743</span> </div>
<div class="line"><span class="lineno"> 2744</span>        $status= array();</div>
<div class="line"><span class="lineno"> 2745</span>        $cacheStatus= <a class="code hl_variable" href="defs_8php.html#aa8d15384fc15e1dedc917fe43ebf78e2">PFFWDIR</a>.<span class="stringliteral">&#39;/cache/status.json&#39;</span>;</div>
<div class="line"><span class="lineno"> 2746</span> </div>
<div class="line"><span class="lineno"> 2747</span>        <span class="keywordflow">if</span> ($interval_changed || !$this-&gt;<a class="code hl_function" href="classModel.html#a3216e14ab593ec9dcc7df09c995d8b1b">getCachedContents</a>($cacheStatus, $status)) {</div>
<div class="line"><span class="lineno"> 2748</span>            <span class="keywordflow">foreach</span> (<a class="code hl_variable" href="defs_8php.html#a0083e4f029931a1eca1a72f558d0457f">$ModelsToStat</a> as $name =&gt; $caption) {</div>
<div class="line"><span class="lineno"> 2749</span>                require_once(<a class="code hl_variable" href="defs_8php.html#a05492353e037e388cf7282041359336c">$MODEL_PATH</a>.<span class="charliteral">&#39;/&#39;</span>.<a class="code hl_variable" href="Controller_2lib_8php.html#aa3999bc30aa5307623a99e2f4aec8d01">$ModelFiles</a>[$name]);</div>
<div class="line"><span class="lineno"> 2750</span>                $model= <span class="keyword">new</span> <a class="code hl_variable" href="Controller_2lib_8php.html#acabe457fb176ac2d698dabd5703a1c5b">$Models</a>[$name]();</div>
<div class="line"><span class="lineno"> 2751</span> </div>
<div class="line"><span class="lineno"> 2752</span>                <span class="comment">// Do not cache module status individually here, we accumulate and cache them all in status.json below</span></div>
<div class="line"><span class="lineno"> 2753</span>                $module_status= $model-&gt;_getModuleStatus(<a class="code hl_variable" href="defs_8php.html#adf0d224b08caed0281790f5861eee95b">$DashboardIntervals2Seconds</a>[$start], 1, 0);</div>
<div class="line"><span class="lineno"> 2754</span>                <span class="keywordflow">if</span> ($module_status !== FALSE) {</div>
<div class="line"><span class="lineno"> 2755</span>                    $status[$name]= $module_status;</div>
<div class="line"><span class="lineno"> 2756</span>                }</div>
<div class="line"><span class="lineno"> 2757</span>            }</div>
<div class="line"><span class="lineno"> 2758</span> </div>
<div class="line"><span class="lineno"> 2759</span>            file_put_contents($cacheStatus, json_encode($status), LOCK_EX);</div>
<div class="line"><span class="lineno"> 2760</span>        }</div>
<div class="line"><span class="lineno"> 2761</span> </div>
<div class="line"><span class="lineno"> 2762</span>        $output= array();</div>
<div class="line"><span class="lineno"> 2763</span>        $output[<span class="stringliteral">&#39;status&#39;</span>]= $status;</div>
<div class="line"><span class="lineno"> 2764</span>        <span class="keywordflow">if</span> ($get_info) {</div>
<div class="line"><span class="lineno"> 2765</span>            $output[<span class="stringliteral">&#39;info&#39;</span>]= $info;</div>
<div class="line"><span class="lineno"> 2766</span>        }</div>
<div class="line"><span class="lineno"> 2767</span> </div>
<div class="line"><span class="lineno"> 2768</span>        <span class="keywordflow">if</span> (file_exists(<a class="code hl_variable" href="defs_8php.html#aa8d15384fc15e1dedc917fe43ebf78e2">PFFWDIR</a>.<span class="stringliteral">&#39;/.starting&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 2769</span>            <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>(_(<span class="stringliteral">&#39;System is starting up...&#39;</span>));</div>
<div class="line"><span class="lineno"> 2770</span>        }</div>
<div class="line"><span class="lineno"> 2771</span> </div>
<div class="line"><span class="lineno"> 2772</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>(json_encode($output));</div>
<div class="line"><span class="lineno"> 2773</span>    }</div>
<div class="ttc" id="aController_2lib_8php_html_aa3999bc30aa5307623a99e2f4aec8d01"><div class="ttname"><a href="Controller_2lib_8php.html#aa3999bc30aa5307623a99e2f4aec8d01">$ModelFiles</a></div><div class="ttdeci">$ModelFiles</div><div class="ttdoc">Matches model names to files. View provides the name only.</div><div class="ttdef"><b>Definition:</b> <a href="Controller_2lib_8php_source.html#l00032">lib.php:32</a></div></div>
<div class="ttc" id="aController_2lib_8php_html_acabe457fb176ac2d698dabd5703a1c5b"><div class="ttname"><a href="Controller_2lib_8php.html#acabe457fb176ac2d698dabd5703a1c5b">$Models</a></div><div class="ttdeci">$Models</div><div class="ttdoc">Matches model names to Classes. Used to create the object.</div><div class="ttdef"><b>Definition:</b> <a href="Controller_2lib_8php_source.html#l00051">lib.php:51</a></div></div>
<div class="ttc" id="aclassModel_html_a3216e14ab593ec9dcc7df09c995d8b1b"><div class="ttname"><a href="classModel.html#a3216e14ab593ec9dcc7df09c995d8b1b">Model\getCachedContents</a></div><div class="ttdeci">getCachedContents($filename, &amp;$contents)</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l02775">model.php:2775</a></div></div>
<div class="ttc" id="aclassModel_html_aa572c51a6d4aa52ec3029518451a05fe"><div class="ttname"><a href="classModel.html#aa572c51a6d4aa52ec3029518451a05fe">Model\_getExtIf</a></div><div class="ttdeci">_getExtIf()</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l00515">model.php:515</a></div></div>
<div class="ttc" id="adefs_8php_html_a0083e4f029931a1eca1a72f558d0457f"><div class="ttname"><a href="defs_8php.html#a0083e4f029931a1eca1a72f558d0457f">$ModelsToStat</a></div><div class="ttdeci">$ModelsToStat</div><div class="ttdoc">Models to get statuses.</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00409">defs.php:409</a></div></div>
<div class="ttc" id="adefs_8php_html_a05492353e037e388cf7282041359336c"><div class="ttname"><a href="defs_8php.html#a05492353e037e388cf7282041359336c">$MODEL_PATH</a></div><div class="ttdeci">$MODEL_PATH</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00032">defs.php:32</a></div></div>
<div class="ttc" id="adefs_8php_html_adf0d224b08caed0281790f5861eee95b"><div class="ttname"><a href="defs_8php.html#adf0d224b08caed0281790f5861eee95b">$DashboardIntervals2Seconds</a></div><div class="ttdeci">$DashboardIntervals2Seconds</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00422">defs.php:422</a></div></div>
<div class="ttc" id="anamespaceModel_html"><div class="ttname"><a href="namespaceModel.html">Model</a></div><div class="ttdoc">Model of MVC: Generally, the Model is responsible for executing commands from the View.</div><div class="ttdef"><b>Definition:</b> <a href="Model_2lib_2AfTo_8php_source.html#l00021">AfTo.php:21</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="defs_8php_source.html#l00422">$DashboardIntervals2Seconds</a>, <a class="el" href="defs_8php_source.html#l00032">$MODEL_PATH</a>, <a class="el" href="Controller_2lib_8php_source.html#l00032">$ModelFiles</a>, <a class="el" href="Controller_2lib_8php_source.html#l00051">$Models</a>, <a class="el" href="defs_8php_source.html#l00409">$ModelsToStat</a>, <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="model_8php_source.html#l00515">_getExtIf()</a>, <a class="el" href="model_8php_source.html#l00500">_getIntIf()</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>, <a class="el" href="model_8php_source.html#l02775">getCachedContents()</a>, <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>, <a class="el" href="defs_8php_source.html#l00034">PFFWDIR</a>, and <a class="el" href="model_8php_source.html#l00718">SetStatusCheckInterval()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a5cf12375d05dca29b3c81333ff1882a2_cgraph.png" border="0" usemap="#aclassModel_a5cf12375d05dca29b3c81333ff1882a2_cgraph" alt=""/></div>
<map name="aclassModel_a5cf12375d05dca29b3c81333ff1882a2_cgraph" id="aclassModel_a5cf12375d05dca29b3c81333ff1882a2_cgraph">
<area shape="rect" title="Gets service statuses." alt="" coords="5,156,140,181"/>
<area shape="rect" href="classModel.html#aa572c51a6d4aa52ec3029518451a05fe" title=" " alt="" coords="433,5,513,31"/>
<area shape="rect" href="classModel.html#a7abfd365d79fd5b34b3aab5d4ff0c770" title=" " alt="" coords="435,55,511,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="584,156,676,181"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="249,256,302,281"/>
<area shape="rect" href="classModel.html#a3216e14ab593ec9dcc7df09c995d8b1b" title=" " alt="" coords="201,207,350,232"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="242,305,309,331"/>
<area shape="rect" href="classModel.html#a31cfb3981a2789a48b91e3b2ea325681" title="Sets status check interval." alt="" coords="188,105,363,131"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="594,55,666,80"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="724,55,813,80"/>
<area shape="rect" href="classModel.html#a1151960aeff2e631b01f989afe5b2f7e" title=" " alt="" coords="411,257,536,283"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="438,105,509,131"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="596,105,664,131"/>
</map>
</div>

</div>
</div>
<a id="ac746ea8beac01d38d9d0289c6c08fe4a" name="ac746ea8beac01d38d9d0289c6c08fe4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac746ea8beac01d38d9d0289c6c08fe4a">&#9670;&#160;</a></span>GetStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetStats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$date</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$collecthours</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main statistics collector, as module data set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$logfile</td><td>Log file pathname. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$date</td><td>Datetime struct. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$collecthours</td><td>Flag to collect hour statistics also. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array Statistics data set collected. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01775">1775</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1776</span>    {</div>
<div class="line"><span class="lineno"> 1777</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>($this-&gt;_getStats($logfile, $date, $collecthours));</div>
<div class="line"><span class="lineno"> 1778</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l01780">_getStats()</a>, and <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ac746ea8beac01d38d9d0289c6c08fe4a_cgraph.png" border="0" usemap="#aclassModel_ac746ea8beac01d38d9d0289c6c08fe4a_cgraph" alt=""/></div>
<map name="aclassModel_ac746ea8beac01d38d9d0289c6c08fe4a_cgraph" id="aclassModel_ac746ea8beac01d38d9d0289c6c08fe4a_cgraph">
<area shape="rect" title="Main statistics collector, as module data set." alt="" coords="5,400,84,426"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="132,375,215,400"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="140,424,207,450"/>
<area shape="rect" href="classModel.html#acae82824087b62c41fe805eba381e84c" title="Generates date regexp to be used by statistics functions." alt="" coords="272,224,397,250"/>
<area shape="rect" href="classModel.html#ae1a4adadbacc084431d026315be20390" title="Generates hour regexp to be used by statistics functions." alt="" coords="272,274,397,299"/>
<area shape="rect" href="classModel.html#a1149c6f5338677a1a74e8a4964826e80" title="Gets saved statistics for the given log file." alt="" coords="467,375,586,400"/>
<area shape="rect" href="classModel.html#adef576154f41b9e06cbf28bb1a4f74b8" title="Checks if the given log file has been updated." alt="" coords="459,124,594,150"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="283,754,386,779"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="873,855,971,880"/>
<area shape="rect" href="classModel.html#ad4d7aefbd214d3da3f1965e6ddddb998" title="Copies the original log file to tmp folder." alt="" coords="263,426,407,451"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="876,426,968,451"/>
<area shape="rect" href="classModel.html#a91890c866a00b75b002e6b1016e6b43c" title="Reads file contents." alt="" coords="682,226,750,251"/>
<area shape="rect" href="classModel.html#ae24c34977ae6864272b678fe40fdb09a" title="Gets name of the tmp statistics file for the given log file." alt="" coords="852,175,992,200"/>
<area shape="rect" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7" title="Gets the original file name for the given log file." alt="" coords="1067,175,1201,200"/>
<area shape="rect" href="classModel.html#a2ef1e4c1d1fadd3c6696a101cd2aa7e5" title="Gets previous line count and stat() from statistics file." alt="" coords="653,324,779,350"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="849,728,995,754"/>
<area shape="rect" href="classModel.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="647,728,785,754"/>
<area shape="rect" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09" title=" " alt="" coords="1059,1058,1209,1083"/>
<area shape="rect" href="classModel.html#ac23e08bf49a305b2d76f11cecc62ba4c" title="Day statistics collector." alt="" coords="463,982,590,1007"/>
<area shape="rect" href="classModel.html#ab1e8cbbabce3210438cebad028f153d7" title="Gets the number of lines added to log files since last tmp file update." alt="" coords="457,578,597,603"/>
<area shape="rect" href="classModel.html#ad26e67d9a70c2182a67b939ae61b6d01" title="Builds generic grep command and extracts log lines." alt="" coords="649,880,783,906"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="473,1056,580,1082"/>
<area shape="rect" href="classModel.html#ae6201c722387cb7120a3447378f73271" title="Further processes parser output fields." alt="" coords="463,830,591,855"/>
<area shape="rect" href="classModel.html#ab5448888d58c0402bcc575e3a5cd9e9e" title="Saves collected statistics with the current line count and stat() output." alt="" coords="673,275,759,300"/>
<area shape="rect" href="classModel.html#a3827d539c75623fd5345ab590caaa2cb" title="Generates the module specific datetime regexp for filtering logs." alt="" coords="833,679,1011,704"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="1257,804,1311,830"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="1065,830,1203,855"/>
<area shape="rect" href="classModel.html#abe3e76f34ef7907cc5fcc6d2840bf081" title="Hour statistics collector." alt="" coords="651,1032,781,1058"/>
<area shape="rect" href="classModel.html#a10ffb35c34bab2bd539a5a945a489625" title="Increments stats for the given values." alt="" coords="885,1008,959,1034"/>
<area shape="rect" href="classModel.html#a3b4ab5022e1e5883d5292c024eaaf8c1" title="Minute statistics collector." alt="" coords="849,1058,995,1083"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="653,1082,779,1107"/>
<area shape="rect" href="classModel.html#a24813c8e79a850571607408548a88528" title="Writes contents to file." alt="" coords="889,276,955,302"/>
<area shape="rect" href="classModel.html#a5cdc13ae8497b92e1c6cbf8b85c6d43c" title="Uncompresses gzipped log file to tmp dir." alt="" coords="455,678,599,703"/>
<area shape="rect" href="classModel.html#a620707dcc4093d4ca002e3dfdfa68af1" title="Deletes the given file or directory." alt="" coords="672,679,760,704"/>
</map>
</div>

</div>
</div>
<a id="a2ef1e4c1d1fadd3c6696a101cd2aa7e5" name="a2ef1e4c1d1fadd3c6696a101cd2aa7e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ef1e4c1d1fadd3c6696a101cd2aa7e5">&#9670;&#160;</a></span>GetStatsFileInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetStatsFileInfo </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$linecount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$filestat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets previous line count and stat() from statistics file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$logfile</td><td>Log file. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$linecount</td><td>Previous line count. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$filestat</td><td>Previous stat() output. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000029">Todo:</a></b></dt><dd>Should check file format too, and delete the stats file if corrupted </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02063">2063</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2064</span>    {</div>
<div class="line"><span class="lineno"> 2066</span> </div>
<div class="line"><span class="lineno"> 2067</span>        $linecount= 0;</div>
<div class="line"><span class="lineno"> 2068</span>        $filestat= array();</div>
<div class="line"><span class="lineno"> 2069</span> </div>
<div class="line"><span class="lineno"> 2070</span>        $statsfile= $this-&gt;GetStatsFileName($logfile);</div>
<div class="line"><span class="lineno"> 2071</span>        <span class="keywordflow">if</span> (file_exists($statsfile)) {</div>
<div class="line"><span class="lineno"> 2072</span>            $filestatline= $this-&gt;RunShellCommand(<span class="stringliteral">&quot;/usr/bin/head -1 $statsfile&quot;</span>);</div>
<div class="line"><span class="lineno"> 2073</span>            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;|^&lt;filestat&gt;(.*)&lt;/filestat&gt;$|&#39;</span>, $filestatline, $match)) {</div>
<div class="line"><span class="lineno"> 2074</span>                $fileinfo= json_decode($match[1], TRUE);</div>
<div class="line"><span class="lineno"> 2075</span> </div>
<div class="line"><span class="lineno"> 2076</span>                $linecount= $fileinfo[<span class="stringliteral">&#39;linecount&#39;</span>];</div>
<div class="line"><span class="lineno"> 2077</span>                $filestat= $fileinfo[<span class="stringliteral">&#39;stat&#39;</span>];</div>
<div class="line"><span class="lineno"> 2078</span>                <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 2079</span>            }</div>
<div class="line"><span class="lineno"> 2080</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2081</span>                <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;filestat missing in: $statsfile&quot;</span>);</div>
<div class="line"><span class="lineno"> 2082</span>            }</div>
<div class="line"><span class="lineno"> 2083</span>        }</div>
<div class="line"><span class="lineno"> 2084</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2085</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;No such file: $statsfile&quot;</span>);</div>
<div class="line"><span class="lineno"> 2086</span>        }</div>
<div class="line"><span class="lineno"> 2087</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2088</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="model_8php_source.html#l02096">GetStatsFileName()</a>, and <a class="el" href="model_8php_source.html#l00791">RunShellCommand()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01873">CountDiffLogLines()</a>, and <a class="el" href="model_8php_source.html#l01094">IsLogFileModified()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a2ef1e4c1d1fadd3c6696a101cd2aa7e5_cgraph.png" border="0" usemap="#aclassModel_a2ef1e4c1d1fadd3c6696a101cd2aa7e5_cgraph" alt=""/></div>
<map name="aclassModel_a2ef1e4c1d1fadd3c6696a101cd2aa7e5_cgraph" id="aclassModel_a2ef1e4c1d1fadd3c6696a101cd2aa7e5_cgraph">
<area shape="rect" title="Gets previous line count and stat() from statistics file." alt="" coords="5,55,132,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="207,5,299,31"/>
<area shape="rect" href="classModel.html#ae24c34977ae6864272b678fe40fdb09a" title="Gets name of the tmp statistics file for the given log file." alt="" coords="183,55,323,80"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="180,104,327,129"/>
<area shape="rect" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7" title="Gets the original file name for the given log file." alt="" coords="375,55,509,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a2ef1e4c1d1fadd3c6696a101cd2aa7e5_icgraph.png" border="0" usemap="#aclassModel_a2ef1e4c1d1fadd3c6696a101cd2aa7e5_icgraph" alt=""/></div>
<map name="aclassModel_a2ef1e4c1d1fadd3c6696a101cd2aa7e5_icgraph" id="aclassModel_a2ef1e4c1d1fadd3c6696a101cd2aa7e5_icgraph">
<area shape="rect" title="Gets previous line count and stat() from statistics file." alt="" coords="737,31,864,56"/>
<area shape="rect" href="classModel.html#ab1e8cbbabce3210438cebad028f153d7" title="Gets the number of lines added to log files since last tmp file update." alt="" coords="549,5,689,31"/>
<area shape="rect" href="classModel.html#adef576154f41b9e06cbf28bb1a4f74b8" title="Checks if the given log file has been updated." alt="" coords="367,56,501,81"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="383,7,485,32"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="210,56,293,81"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="197,7,305,32"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="23,7,118,32"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="31,56,110,81"/>
<area shape="rect" href="classModel.html#aab423e07962bdc1319b01c6d7c679f0f" title=" " alt="" coords="184,105,319,131"/>
<area shape="rect" href="classModel.html#aed5ee3c735f862c4d99761b379f31729" title="Gets log files list with start dates." alt="" coords="10,105,131,131"/>
<area shape="rect" href="classModel.html#a40159dcd03e82eade9e96fd6b8080e89" title="Extracts the datetime of the first line in the log file." alt="" coords="5,155,136,180"/>
</map>
</div>

</div>
</div>
<a id="ae24c34977ae6864272b678fe40fdb09a" name="ae24c34977ae6864272b678fe40fdb09a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae24c34977ae6864272b678fe40fdb09a">&#9670;&#160;</a></span>GetStatsFileName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetStatsFileName </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logfile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets name of the tmp statistics file for the given log file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$logfile</td><td>Log file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string Statistics file name. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02096">2096</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2097</span>    {</div>
<div class="line"><span class="lineno"> 2098</span>        $origfilename= basename($this-&gt;GetOrigFileName($logfile));</div>
<div class="line"><span class="lineno"> 2099</span> </div>
<div class="line"><span class="lineno"> 2100</span>        $statsdir= <a class="code hl_variable" href="defs_8php.html#aa8d15384fc15e1dedc917fe43ebf78e2">PFFWDIR</a>.<span class="stringliteral">&#39;/stats/&#39;</span>.get_class($this);</div>
<div class="line"><span class="lineno"> 2101</span>        $statsfile= <span class="stringliteral">&quot;$statsdir/$origfilename&quot;</span>;</div>
<div class="line"><span class="lineno"> 2102</span> </div>
<div class="line"><span class="lineno"> 2103</span>        <span class="keywordflow">return</span> $statsfile;</div>
<div class="line"><span class="lineno"> 2104</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l01594">GetOrigFileName()</a>, and <a class="el" href="defs_8php_source.html#l00034">PFFWDIR</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02033">GetSavedStats()</a>, <a class="el" href="model_8php_source.html#l02063">GetStatsFileInfo()</a>, <a class="el" href="model_8php_source.html#l01094">IsLogFileModified()</a>, and <a class="el" href="model_8php_source.html#l02117">SaveStats()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ae24c34977ae6864272b678fe40fdb09a_cgraph.png" border="0" usemap="#aclassModel_ae24c34977ae6864272b678fe40fdb09a_cgraph" alt=""/></div>
<map name="aclassModel_ae24c34977ae6864272b678fe40fdb09a_cgraph" id="aclassModel_ae24c34977ae6864272b678fe40fdb09a_cgraph">
<area shape="rect" title="Gets name of the tmp statistics file for the given log file." alt="" coords="5,5,145,31"/>
<area shape="rect" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7" title="Gets the original file name for the given log file." alt="" coords="193,5,328,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ae24c34977ae6864272b678fe40fdb09a_icgraph.png" border="0" usemap="#aclassModel_ae24c34977ae6864272b678fe40fdb09a_icgraph" alt=""/></div>
<map name="aclassModel_ae24c34977ae6864272b678fe40fdb09a_icgraph" id="aclassModel_ae24c34977ae6864272b678fe40fdb09a_icgraph">
<area shape="rect" title="Gets name of the tmp statistics file for the given log file." alt="" coords="872,119,1012,144"/>
<area shape="rect" href="classModel.html#a1149c6f5338677a1a74e8a4964826e80" title="Gets saved statistics for the given log file." alt="" coords="520,43,639,68"/>
<area shape="rect" href="classModel.html#a2ef1e4c1d1fadd3c6696a101cd2aa7e5" title="Gets previous line count and stat() from statistics file." alt="" coords="697,143,824,168"/>
<area shape="rect" href="classModel.html#adef576154f41b9e06cbf28bb1a4f74b8" title="Checks if the given log file has been updated." alt="" coords="512,193,647,219"/>
<area shape="rect" href="classModel.html#ab5448888d58c0402bcc575e3a5cd9e9e" title="Saves collected statistics with the current line count and stat() output." alt="" coords="717,93,804,119"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="172,80,255,105"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="343,93,445,119"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,80,92,105"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="159,143,267,168"/>
<area shape="rect" href="classModel.html#ab1e8cbbabce3210438cebad028f153d7" title="Gets the number of lines added to log files since last tmp file update." alt="" coords="509,144,649,169"/>
<area shape="rect" href="classModel.html#aab423e07962bdc1319b01c6d7c679f0f" title=" " alt="" coords="327,245,461,271"/>
<area shape="rect" href="classModel.html#aed5ee3c735f862c4d99761b379f31729" title="Gets log files list with start dates." alt="" coords="153,269,274,295"/>
<area shape="rect" href="classModel.html#a40159dcd03e82eade9e96fd6b8080e89" title="Extracts the datetime of the first line in the log file." alt="" coords="148,220,279,245"/>
</map>
</div>

</div>
</div>
<a id="ad26e67d9a70c2182a67b939ae61b6d01" name="ad26e67d9a70c2182a67b939ae61b6d01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad26e67d9a70c2182a67b939ae61b6d01">&#9670;&#160;</a></span>GetStatsLogLines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetStatsLogLines </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$tail</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Builds generic grep command and extracts log lines. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$logfile</td><td>Log file pathname. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$tail</td><td>Tail len to get the new log lines to update the stats with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string Log lines. </dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>Normally would never allow large $tail numbers here, but this $tail is computed in the code.</dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01704">1704</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1705</span>    {</div>
<div class="line"><span class="lineno"> 1706</span>        global <a class="code hl_variable" href="defs_8php.html#acaae7b246b0fd77ae6400fa4868a593b">$StatsConf</a>;</div>
<div class="line"><span class="lineno"> 1707</span> </div>
<div class="line"><span class="lineno"> 1708</span>        <span class="keywordflow">if</span> (!$this-&gt;ValidateFile($logfile)) {</div>
<div class="line"><span class="lineno"> 1709</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1710</span>        }</div>
<div class="line"><span class="lineno"> 1711</span> </div>
<div class="line"><span class="lineno"> 1712</span>        $statsdefs= <a class="code hl_variable" href="defs_8php.html#acaae7b246b0fd77ae6400fa4868a593b">$StatsConf</a>[$this-&gt;Name];</div>
<div class="line"><span class="lineno"> 1713</span> </div>
<div class="line"><span class="lineno"> 1714</span>        $needle= <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1715</span>        <span class="keywordflow">if</span> (isset($statsdefs[<span class="stringliteral">&#39;Total&#39;</span>][<span class="stringliteral">&#39;Needle&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1716</span>            $needle= $statsdefs[<span class="stringliteral">&#39;Total&#39;</span>][<span class="stringliteral">&#39;Needle&#39;</span>];</div>
<div class="line"><span class="lineno"> 1717</span>        }</div>
<div class="line"><span class="lineno"> 1718</span>        </div>
<div class="line"><span class="lineno"> 1719</span>        $cmd= $statsdefs[<span class="stringliteral">&#39;Total&#39;</span>][<span class="stringliteral">&#39;Cmd&#39;</span>];</div>
<div class="line"><span class="lineno"> 1720</span>        <span class="keywordflow">if</span> ($needle != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1721</span>            $needle= escapeshellarg($needle);</div>
<div class="line"><span class="lineno"> 1722</span>            $cmd.= <span class="stringliteral">&quot; | /usr/bin/grep -a -E $needle&quot;</span>;</div>
<div class="line"><span class="lineno"> 1723</span>        }</div>
<div class="line"><span class="lineno"> 1724</span> </div>
<div class="line"><span class="lineno"> 1725</span>        <span class="keywordflow">if</span> ($tail &gt; -1) {</div>
<div class="line"><span class="lineno"> 1727</span>            $cmd.= <span class="stringliteral">&quot; | /usr/bin/tail -$tail&quot;</span>;</div>
<div class="line"><span class="lineno"> 1728</span>        }</div>
<div class="line"><span class="lineno"> 1729</span> </div>
<div class="line"><span class="lineno"> 1730</span>        $cmd= preg_replace(<span class="stringliteral">&#39;/&lt;LF&gt;/&#39;</span>, $logfile, $cmd);</div>
<div class="line"><span class="lineno"> 1731</span> </div>
<div class="line"><span class="lineno"> 1732</span>        <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8">RunShellCommand</a>($cmd);</div>
<div class="line"><span class="lineno"> 1733</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="defs_8php_source.html#l00202">$StatsConf</a>, <a class="el" href="model_8php_source.html#l00791">RunShellCommand()</a>, and <a class="el" href="model_8php_source.html#l01838">ValidateFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01919">UpdateStats()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ad26e67d9a70c2182a67b939ae61b6d01_cgraph.png" border="0" usemap="#aclassModel_ad26e67d9a70c2182a67b939ae61b6d01_cgraph" alt=""/></div>
<map name="aclassModel_ad26e67d9a70c2182a67b939ae61b6d01_cgraph" id="aclassModel_ad26e67d9a70c2182a67b939ae61b6d01_cgraph">
<area shape="rect" title="Builds generic grep command and extracts log lines." alt="" coords="5,31,140,56"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="188,5,335,31"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="212,55,311,80"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="568,55,621,80"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="383,80,520,105"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ad26e67d9a70c2182a67b939ae61b6d01_icgraph.png" border="0" usemap="#aclassModel_ad26e67d9a70c2182a67b939ae61b6d01_icgraph" alt=""/></div>
<map name="aclassModel_ad26e67d9a70c2182a67b939ae61b6d01_icgraph" id="aclassModel_ad26e67d9a70c2182a67b939ae61b6d01_icgraph">
<area shape="rect" title="Builds generic grep command and extracts log lines." alt="" coords="455,55,589,80"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="304,55,407,80"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,29,243,55"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,79,256,104"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="ab735f5a4ded9f9c9a5b04f182205fd7d" name="ab735f5a4ded9f9c9a5b04f182205fd7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab735f5a4ded9f9c9a5b04f182205fd7d">&#9670;&#160;</a></span>GetStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetStatus </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02979">2979</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2980</span>    {</div>
<div class="line"><span class="lineno"> 2981</span>        global <a class="code hl_variable" href="defs_8php.html#a0083e4f029931a1eca1a72f558d0457f">$ModelsToStat</a>, <a class="code hl_variable" href="lib_2setup_8php.html#a757cdec67d8424a7b058bfaeebaae8c9">$StatusCheckInterval</a>;</div>
<div class="line"><span class="lineno"> 2982</span> </div>
<div class="line"><span class="lineno"> 2983</span>        $logs= $this-&gt;getFifoLogs(<a class="code hl_variable" href="lib_2setup_8php.html#a757cdec67d8424a7b058bfaeebaae8c9">$StatusCheckInterval</a>);</div>
<div class="line"><span class="lineno"> 2984</span>        <span class="keywordflow">if</span> ($logs === FALSE) {</div>
<div class="line"><span class="lineno"> 2985</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2986</span>        }</div>
<div class="line"><span class="lineno"> 2987</span> </div>
<div class="line"><span class="lineno"> 2988</span>        <span class="keywordflow">if</span> (count($logs)) {</div>
<div class="line"><span class="lineno"> 2989</span>            $prios= array(</div>
<div class="line"><span class="lineno"> 2990</span>                <span class="stringliteral">&#39;critical&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 2991</span>                    <span class="stringliteral">&#39;key&#39;</span> =&gt; <span class="stringliteral">&#39;CRITICAL|ALERT|EMERGENCY&#39;</span>,</div>
<div class="line"><span class="lineno"> 2992</span>                    <span class="stringliteral">&#39;msg&#39;</span> =&gt; <a class="code hl_function" href="defs_8php.html#a76b8877d5a35c08959e2609908c669b6">_TITLE</a>(<span class="stringliteral">&#39;&lt;MODEL&gt; has CRITICAL errors&#39;</span>),</div>
<div class="line"><span class="lineno"> 2993</span>                    ),</div>
<div class="line"><span class="lineno"> 2994</span>                <span class="stringliteral">&#39;error&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 2995</span>                    <span class="stringliteral">&#39;key&#39;</span> =&gt; <span class="stringliteral">&#39;ERROR&#39;</span>,</div>
<div class="line"><span class="lineno"> 2996</span>                    <span class="stringliteral">&#39;msg&#39;</span> =&gt; <a class="code hl_function" href="defs_8php.html#a76b8877d5a35c08959e2609908c669b6">_TITLE</a>(<span class="stringliteral">&#39;&lt;MODEL&gt; has ERRORs&#39;</span>),</div>
<div class="line"><span class="lineno"> 2997</span>                    ),</div>
<div class="line"><span class="lineno"> 2998</span>                <span class="stringliteral">&#39;warning&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 2999</span>                    <span class="stringliteral">&#39;key&#39;</span> =&gt; <span class="stringliteral">&#39;WARNING&#39;</span>,</div>
<div class="line"><span class="lineno"> 3000</span>                    <span class="stringliteral">&#39;msg&#39;</span> =&gt; <a class="code hl_function" href="defs_8php.html#a76b8877d5a35c08959e2609908c669b6">_TITLE</a>(<span class="stringliteral">&#39;&lt;MODEL&gt; has WARNINGs&#39;</span>),</div>
<div class="line"><span class="lineno"> 3001</span>                    ),</div>
<div class="line"><span class="lineno"> 3002</span>                );</div>
<div class="line"><span class="lineno"> 3003</span> </div>
<div class="line"><span class="lineno"> 3004</span>            <span class="keywordflow">foreach</span> ($prios as $prio =&gt; $p) {</div>
<div class="line"><span class="lineno"> 3005</span>                $keys= explode(<span class="charliteral">&#39;|&#39;</span>, $p[<span class="stringliteral">&#39;key&#39;</span>]);</div>
<div class="line"><span class="lineno"> 3006</span> </div>
<div class="line"><span class="lineno"> 3007</span>                $errorStr= <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 3008</span>                $shown= 0;</div>
<div class="line"><span class="lineno"> 3009</span>                <span class="keywordflow">foreach</span> ($logs as $l) {</div>
<div class="line"><span class="lineno"> 3010</span>                    <span class="keywordflow">foreach</span> ($keys as $k) {</div>
<div class="line"><span class="lineno"> 3011</span>                        <span class="keywordflow">if</span> ($this-&gt;isPrio($l, $k)) {</div>
<div class="line"><span class="lineno"> 3012</span>                            <span class="keywordflow">if</span> ($shown &lt; 5) {</div>
<div class="line"><span class="lineno"> 3013</span>                                $errorStr.= <span class="stringliteral">&quot;\n&quot;</span> . $l[<span class="stringliteral">&#39;Log&#39;</span>];</div>
<div class="line"><span class="lineno"> 3014</span>                                $shown++;</div>
<div class="line"><span class="lineno"> 3015</span>                            }</div>
<div class="line"><span class="lineno"> 3016</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3017</span>                        }</div>
<div class="line"><span class="lineno"> 3018</span>                    }</div>
<div class="line"><span class="lineno"> 3019</span>                }</div>
<div class="line"><span class="lineno"> 3020</span> </div>
<div class="line"><span class="lineno"> 3021</span>                <span class="keywordflow">if</span> ($shown) {</div>
<div class="line"><span class="lineno"> 3022</span>                    $total= $this-&gt;<a class="code hl_function" href="classModel.html#a7fb8ac5678a9e42f00fb66780296bca9">getRrdValue</a>(<span class="stringliteral">&quot;derive-$prio.rrd&quot;</span>, <a class="code hl_variable" href="lib_2setup_8php.html#a757cdec67d8424a7b058bfaeebaae8c9">$StatusCheckInterval</a>, $result);</div>
<div class="line"><span class="lineno"> 3023</span>                    <span class="keywordflow">if</span> ($total &gt; $shown) {</div>
<div class="line"><span class="lineno"> 3024</span>                        $errorStr.= <span class="stringliteral">&quot;\n&quot;</span> . str_replace(<span class="stringliteral">&#39;&lt;COUNT&gt;&#39;</span>, $total - $shown, <a class="code hl_function" href="defs_8php.html#a76b8877d5a35c08959e2609908c669b6">_TITLE</a>(<span class="stringliteral">&#39;And &lt;COUNT&gt; others not shown.&#39;</span>));</div>
<div class="line"><span class="lineno"> 3025</span>                    }</div>
<div class="line"><span class="lineno"> 3026</span>                    <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>(str_replace(<span class="stringliteral">&#39;&lt;MODEL&gt;&#39;</span>, _(<a class="code hl_variable" href="defs_8php.html#a0083e4f029931a1eca1a72f558d0457f">$ModelsToStat</a>[$this-&gt;Name]), _($p[<span class="stringliteral">&#39;msg&#39;</span>])) . <span class="charliteral">&#39;:&#39;</span> . $errorStr);</div>
<div class="line"><span class="lineno"> 3027</span>                }</div>
<div class="line"><span class="lineno"> 3028</span>            }</div>
<div class="line"><span class="lineno"> 3029</span>            <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>(str_replace(<span class="stringliteral">&#39;&lt;INTERVAL&gt;&#39;</span>, <a class="code hl_variable" href="lib_2setup_8php.html#a757cdec67d8424a7b058bfaeebaae8c9">$StatusCheckInterval</a>, <a class="code hl_function" href="defs_8php.html#a76b8877d5a35c08959e2609908c669b6">_TITLE</a>(<span class="stringliteral">&#39;In the last &lt;INTERVAL&gt; seconds.&#39;</span>)) );</div>
<div class="line"><span class="lineno"> 3030</span>        }</div>
<div class="line"><span class="lineno"> 3031</span>        <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 3032</span>    }</div>
<div class="ttc" id="aclassModel_html_a7fb8ac5678a9e42f00fb66780296bca9"><div class="ttname"><a href="classModel.html#a7fb8ac5678a9e42f00fb66780296bca9">Model\getRrdValue</a></div><div class="ttdeci">getRrdValue($rrd, $start=60, &amp;$result, $type='derive')</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l02906">model.php:2906</a></div></div>
<div class="ttc" id="adefs_8php_html_a76b8877d5a35c08959e2609908c669b6"><div class="ttname"><a href="defs_8php.html#a76b8877d5a35c08959e2609908c669b6">_TITLE</a></div><div class="ttdeci">_TITLE($str)</div><div class="ttdoc">For classifying gettext strings into files.</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00402">defs.php:402</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="defs_8php_source.html#l00409">$ModelsToStat</a>, <a class="el" href="lib_2setup_8php_source.html#l00038">$StatusCheckInterval</a>, <a class="el" href="defs_8php_source.html#l00402">_TITLE()</a>, <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>, <a class="el" href="model_8php_source.html#l02862">getFifoLogs()</a>, <a class="el" href="model_8php_source.html#l02906">getRrdValue()</a>, and <a class="el" href="model_8php_source.html#l03034">isPrio()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ab735f5a4ded9f9c9a5b04f182205fd7d_cgraph.png" border="0" usemap="#aclassModel_ab735f5a4ded9f9c9a5b04f182205fd7d_cgraph" alt=""/></div>
<map name="aclassModel_ab735f5a4ded9f9c9a5b04f182205fd7d_cgraph" id="aclassModel_ab735f5a4ded9f9c9a5b04f182205fd7d_cgraph">
<area shape="rect" title=" " alt="" coords="5,133,92,159"/>
<area shape="rect" href="defs_8php.html#a76b8877d5a35c08959e2609908c669b6" title="For classifying gettext strings into files." alt="" coords="159,5,223,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="844,183,897,208"/>
<area shape="rect" href="classModel.html#a75a2cec868b2b3cf1d0f2ae81a799298" title=" " alt="" coords="142,133,239,159"/>
<area shape="rect" href="classModel.html#a7fb8ac5678a9e42f00fb66780296bca9" title=" " alt="" coords="140,259,241,284"/>
<area shape="rect" href="classModel.html#a6b114b525be039c9d40aced2dba528f6" title=" " alt="" coords="161,308,220,333"/>
<area shape="rect" href="classModel.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="319,133,426,159"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="504,108,611,133"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="508,157,607,183"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="664,107,791,132"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="659,208,796,233"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="327,309,419,335"/>
<area shape="rect" href="classModel.html#a106f3eba1442c7e4cf721764772bc724" title=" " alt="" coords="289,359,456,384"/>
</map>
</div>

</div>
</div>
<a id="afea284b751e524dc9f750e8523be5c95" name="afea284b751e524dc9f750e8523be5c95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afea284b751e524dc9f750e8523be5c95">&#9670;&#160;</a></span>GetSysCtl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetSysCtl </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$option</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets sysctl output for the given arg. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$option</td><td>sysctl arg, such as hw.sensors. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string sysctl output lines. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l03045">3045</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3046</span>    {</div>
<div class="line"><span class="lineno"> 3047</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>($this-&gt;_getSysCtl($option));</div>
<div class="line"><span class="lineno"> 3048</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l03050">_getSysCtl()</a>, and <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_afea284b751e524dc9f750e8523be5c95_cgraph.png" border="0" usemap="#aclassModel_afea284b751e524dc9f750e8523be5c95_cgraph" alt=""/></div>
<map name="aclassModel_afea284b751e524dc9f750e8523be5c95_cgraph" id="aclassModel_afea284b751e524dc9f750e8523be5c95_cgraph">
<area shape="rect" title="Gets sysctl output for the given arg." alt="" coords="5,31,92,56"/>
<area shape="rect" href="classModel.html#a5e24130261dd255285454c45adc570eb" title=" " alt="" coords="140,5,231,31"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="152,55,219,80"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="279,5,425,31"/>
</map>
</div>

</div>
</div>
<a id="a7ece271b0ef8636736f58b3b75268931" name="a7ece271b0ef8636736f58b3b75268931"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ece271b0ef8636736f58b3b75268931">&#9670;&#160;</a></span>GetTmpLogFileName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetTmpLogFileName </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the name of the file in the tmp folder. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>File pathname. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string Pathname of the tmp file. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01127">1127</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1128</span>    {</div>
<div class="line"><span class="lineno"> 1129</span>        <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/(.*)\.gz$/&#39;</span>, $file, $match)) {</div>
<div class="line"><span class="lineno"> 1130</span>            $file= $this-&gt;TmpLogsDir.basename($match[1]);</div>
<div class="line"><span class="lineno"> 1131</span>        }</div>
<div class="line"><span class="lineno"> 1132</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1133</span>            $file= $this-&gt;TmpLogsDir.basename($file);</div>
<div class="line"><span class="lineno"> 1134</span>        }</div>
<div class="line"><span class="lineno"> 1135</span>        <span class="keywordflow">return</span> $file;</div>
<div class="line"><span class="lineno"> 1136</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01489">_getLogStartDate()</a>, and <a class="el" href="model_8php_source.html#l01060">SelectLogFile()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a7ece271b0ef8636736f58b3b75268931_icgraph.png" border="0" usemap="#aclassModel_a7ece271b0ef8636736f58b3b75268931_icgraph" alt=""/></div>
<map name="aclassModel_a7ece271b0ef8636736f58b3b75268931_icgraph" id="aclassModel_a7ece271b0ef8636736f58b3b75268931_icgraph">
<area shape="rect" title="Gets the name of the file in the tmp folder." alt="" coords="367,55,525,80"/>
<area shape="rect" href="classModel.html#aab423e07962bdc1319b01c6d7c679f0f" title=" " alt="" coords="184,29,319,55"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="197,79,305,104"/>
<area shape="rect" href="classModel.html#aed5ee3c735f862c4d99761b379f31729" title="Gets log files list with start dates." alt="" coords="10,5,131,31"/>
<area shape="rect" href="classModel.html#a40159dcd03e82eade9e96fd6b8080e89" title="Extracts the datetime of the first line in the log file." alt="" coords="5,55,136,80"/>
</map>
</div>

</div>
</div>
<a id="a25397fad2fa355ebc979d4672a4b2c7e" name="a25397fad2fa355ebc979d4672a4b2c7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25397fad2fa355ebc979d4672a4b2c7e">&#9670;&#160;</a></span>getValidValues()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getValidValues </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02392">2392</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2393</span>    {</div>
<div class="line"><span class="lineno"> 2394</span>        $validValues= array();</div>
<div class="line"><span class="lineno"> 2395</span>        <span class="keywordflow">if</span> (isset($this-&gt;Config[$name][<span class="stringliteral">&#39;type&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2396</span>            $type= $this-&gt;Config[$name][<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><span class="lineno"> 2397</span>            <span class="keywordflow">if</span> ($type == <a class="code hl_variable" href="defs_8php.html#aab8182fd89e46c735247eb039aa6bdfc">STR_on_off</a>) {</div>
<div class="line"><span class="lineno"> 2398</span>                $validValues= array(<span class="stringliteral">&#39;on&#39;</span>, <span class="stringliteral">&#39;off&#39;</span>);</div>
<div class="line"><span class="lineno"> 2399</span>            } elseif ($type == <a class="code hl_variable" href="defs_8php.html#a2307404447f3de81f7356b7bc39ad38c">STR_On_Off</a>) {</div>
<div class="line"><span class="lineno"> 2400</span>                $validValues= array(<span class="stringliteral">&#39;On&#39;</span>, <span class="stringliteral">&#39;Off&#39;</span>);</div>
<div class="line"><span class="lineno"> 2401</span>            } elseif ($type == <a class="code hl_variable" href="defs_8php.html#a29602e1b92e5668050ad9d28cfbd067d">STR_yes_no</a>) {</div>
<div class="line"><span class="lineno"> 2402</span>                $validValues= array(<span class="stringliteral">&#39;yes&#39;</span>, <span class="stringliteral">&#39;no&#39;</span>);</div>
<div class="line"><span class="lineno"> 2403</span>            }</div>
<div class="line"><span class="lineno"> 2404</span>        }</div>
<div class="line"><span class="lineno"> 2405</span>        <span class="keywordflow">return</span> $validValues;</div>
<div class="line"><span class="lineno"> 2406</span>    }</div>
<div class="ttc" id="adefs_8php_html_a2307404447f3de81f7356b7bc39ad38c"><div class="ttname"><a href="defs_8php.html#a2307404447f3de81f7356b7bc39ad38c">STR_On_Off</a></div><div class="ttdeci">const STR_On_Off</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00131">defs.php:131</a></div></div>
<div class="ttc" id="adefs_8php_html_a29602e1b92e5668050ad9d28cfbd067d"><div class="ttname"><a href="defs_8php.html#a29602e1b92e5668050ad9d28cfbd067d">STR_yes_no</a></div><div class="ttdeci">const STR_yes_no</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00133">defs.php:133</a></div></div>
<div class="ttc" id="adefs_8php_html_aab8182fd89e46c735247eb039aa6bdfc"><div class="ttname"><a href="defs_8php.html#aab8182fd89e46c735247eb039aa6bdfc">STR_on_off</a></div><div class="ttdeci">const STR_on_off</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00130">defs.php:130</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="defs_8php_source.html#l00130">STR_on_off</a>, <a class="el" href="defs_8php_source.html#l00131">STR_On_Off</a>, and <a class="el" href="defs_8php_source.html#l00133">STR_yes_no</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02366">GetDisabledValue()</a>, and <a class="el" href="model_8php_source.html#l02337">GetValue()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a25397fad2fa355ebc979d4672a4b2c7e_icgraph.png" border="0" usemap="#aclassModel_a25397fad2fa355ebc979d4672a4b2c7e_icgraph" alt=""/></div>
<map name="aclassModel_a25397fad2fa355ebc979d4672a4b2c7e_icgraph" id="aclassModel_a25397fad2fa355ebc979d4672a4b2c7e_icgraph">
<area shape="rect" title=" " alt="" coords="369,31,488,56"/>
<area shape="rect" href="classModel.html#a9aefd70a0fc1481512f149df7a0376aa" title="Returns all disabled configuration for a given configuration type." alt="" coords="183,5,321,31"/>
<area shape="rect" href="classModel.html#ae81727132988d14931750ce5e1c88bd7" title="Returns all enabled configuration for a given configuration type." alt="" coords="211,55,293,80"/>
<area shape="rect" href="classModel.html#a7b5bd25430f02d1925323e19f2861a9e" title="Gets all configuration for a given configuration type." alt="" coords="5,31,135,56"/>
</map>
</div>

</div>
</div>
<a id="ae81727132988d14931750ce5e1c88bd7" name="ae81727132988d14931750ce5e1c88bd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae81727132988d14931750ce5e1c88bd7">&#9670;&#160;</a></span>GetValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetValue </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns all enabled configuration for a given configuration type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$name</td><td>Config name </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$conf</td><td>Config type </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$group</td><td>E2guardian group </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array Array of config items </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02337">2337</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2338</span>    {</div>
<div class="line"><span class="lineno"> 2339</span>        $file= $this-&gt;GetConfFile($conf, $group);</div>
<div class="line"><span class="lineno"> 2340</span>        </div>
<div class="line"><span class="lineno"> 2341</span>        <span class="keywordflow">if</span> ((isset($this-&gt;Config[$name][<span class="stringliteral">&#39;type&#39;</span>])) &amp;&amp; ($this-&gt;Config[$name][<span class="stringliteral">&#39;type&#39;</span>] === FALSE)) {</div>
<div class="line"><span class="lineno"> 2342</span>            <span class="keywordflow">return</span> $this-&gt;GetName($file, $name);</div>
<div class="line"><span class="lineno"> 2343</span>        }</div>
<div class="line"><span class="lineno"> 2344</span> </div>
<div class="line"><span class="lineno"> 2345</span>        $validValues= $this-&gt;getValidValues($name);</div>
<div class="line"><span class="lineno"> 2346</span>        $value= FALSE;</div>
<div class="line"><span class="lineno"> 2347</span>        $set= 0;</div>
<div class="line"><span class="lineno"> 2348</span>        <span class="comment">// Try max 5 possible values</span></div>
<div class="line"><span class="lineno"> 2349</span>        <span class="keywordflow">while</span> ($set &lt; 5) {</div>
<div class="line"><span class="lineno"> 2350</span>            $value= $this-&gt;GetNVP($file, $name, $set);</div>
<div class="line"><span class="lineno"> 2351</span>            <span class="keywordflow">if</span> ($value === FALSE) {</div>
<div class="line"><span class="lineno"> 2352</span>                <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2353</span>            }</div>
<div class="line"><span class="lineno"> 2354</span>            <span class="keywordflow">if</span> (!count($validValues) || in_array($value, $validValues)) {</div>
<div class="line"><span class="lineno"> 2355</span>                <span class="keywordflow">return</span> <span class="stringliteral">&quot;$name=$value&quot;</span>;</div>
<div class="line"><span class="lineno"> 2356</span>            }</div>
<div class="line"><span class="lineno"> 2357</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_NOTICE, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Failed validating value: $name: $value&quot;</span>);</div>
<div class="line"><span class="lineno"> 2358</span>            $set++;</div>
<div class="line"><span class="lineno"> 2359</span>        }</div>
<div class="line"><span class="lineno"> 2360</span>        <span class="keywordflow">return</span> $value;</div>
<div class="line"><span class="lineno"> 2361</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="model_8php_source.html#l02568">GetConfFile()</a>, <a class="el" href="model_8php_source.html#l02429">GetName()</a>, <a class="el" href="model_8php_source.html#l00915">GetNVP()</a>, and <a class="el" href="model_8php_source.html#l02392">getValidValues()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02305">GetConfigValues()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ae81727132988d14931750ce5e1c88bd7_cgraph.png" border="0" usemap="#aclassModel_ae81727132988d14931750ce5e1c88bd7_cgraph" alt=""/></div>
<map name="aclassModel_ae81727132988d14931750ce5e1c88bd7_cgraph" id="aclassModel_ae81727132988d14931750ce5e1c88bd7_cgraph">
<area shape="rect" title="Returns all enabled configuration for a given configuration type." alt="" coords="5,104,87,129"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="148,5,240,31"/>
<area shape="rect" href="classModel.html#ae08f1955abf4f7b5ca00ec1fec76041f" title="Returns configuration file of the module." alt="" coords="145,55,243,80"/>
<area shape="rect" href="classModel.html#ae6cc2dcb5a8fe07db88766823322be7e" title="Checks if Name exists." alt="" coords="152,104,236,129"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="158,153,230,179"/>
<area shape="rect" href="classModel.html#a25397fad2fa355ebc979d4672a4b2c7e" title=" " alt="" coords="135,203,253,228"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="301,129,391,155"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ae81727132988d14931750ce5e1c88bd7_icgraph.png" border="0" usemap="#aclassModel_ae81727132988d14931750ce5e1c88bd7_icgraph" alt=""/></div>
<map name="aclassModel_ae81727132988d14931750ce5e1c88bd7_icgraph" id="aclassModel_ae81727132988d14931750ce5e1c88bd7_icgraph">
<area shape="rect" title="Returns all enabled configuration for a given configuration type." alt="" coords="183,5,264,31"/>
<area shape="rect" href="classModel.html#a7b5bd25430f02d1925323e19f2861a9e" title="Gets all configuration for a given configuration type." alt="" coords="5,5,135,31"/>
</map>
</div>

</div>
</div>
<a id="ac9a300b28f440e32170130534117802e" name="ac9a300b28f440e32170130534117802e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a300b28f440e32170130534117802e">&#9670;&#160;</a></span>GetVersion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GetVersion </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets software version string. </p>

<p>Reimplemented in <a class="el" href="classCollectd.html#ac9a300b28f440e32170130534117802e">Collectd</a>, <a class="el" href="classDnsmasq.html#ac9a300b28f440e32170130534117802e">Dnsmasq</a>, and <a class="el" href="classHttpd.html#ac9a300b28f440e32170130534117802e">Httpd</a>.</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02672">2672</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2673</span>    {</div>
<div class="line"><span class="lineno"> 2674</span>        <span class="keywordflow">if</span> ($this-&gt;VersionCmd !== <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 2675</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>($this-&gt;RunShellCommand($this-&gt;VersionCmd.<span class="stringliteral">&#39; | /usr/bin/head -1&#39;</span>));</div>
<div class="line"><span class="lineno"> 2676</span>        }</div>
<div class="line"><span class="lineno"> 2677</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2678</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>, and <a class="el" href="model_8php_source.html#l00791">RunShellCommand()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ac9a300b28f440e32170130534117802e_cgraph.png" border="0" usemap="#aclassModel_ac9a300b28f440e32170130534117802e_cgraph" alt=""/></div>
<map name="aclassModel_ac9a300b28f440e32170130534117802e_cgraph" id="aclassModel_ac9a300b28f440e32170130534117802e_cgraph">
<area shape="rect" title="Gets software version string." alt="" coords="5,31,99,56"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="187,5,253,31"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="147,55,293,80"/>
</map>
</div>

</div>
</div>
<a id="a10ffb35c34bab2bd539a5a945a489625" name="a10ffb35c34bab2bd539a5a945a489625"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10ffb35c34bab2bd539a5a945a489625">&#9670;&#160;</a></span>IncStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IncStats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$statsdefs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$stats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Increments stats for the given values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$line</td><td>Current log line needed to search for keywords. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$values</td><td>Log fields parsed by caller function. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$statsdefs</td><td>Module stats section of $StatsConf. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$stats</td><td>Statistics data set collected. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02214">2214</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2215</span>    {</div>
<div class="line"><span class="lineno"> 2216</span>        <a class="code hl_function" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09">AddValueCreateKey</a>($stats, <span class="stringliteral">&#39;Sum&#39;</span>, 1);</div>
<div class="line"><span class="lineno"> 2217</span> </div>
<div class="line"><span class="lineno"> 2218</span>        <span class="keywordflow">foreach</span> ($statsdefs as $stat =&gt; $statconf) {</div>
<div class="line"><span class="lineno"> 2219</span>            <span class="keywordflow">if</span> (isset($statconf[<span class="stringliteral">&#39;Counters&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2220</span>                <span class="keywordflow">foreach</span> ($statconf[<span class="stringliteral">&#39;Counters&#39;</span>] as $counter =&gt; $conf) {</div>
<div class="line"><span class="lineno"> 2221</span>                    <span class="keywordflow">if</span> (isset($values[$conf[<span class="stringliteral">&#39;Field&#39;</span>]])) {</div>
<div class="line"><span class="lineno"> 2222</span>                        $value= $values[$conf[<span class="stringliteral">&#39;Field&#39;</span>]];</div>
<div class="line"><span class="lineno"> 2223</span> </div>
<div class="line"><span class="lineno"> 2224</span>                        <span class="keywordflow">if</span> (!isset($stats[$counter])) {</div>
<div class="line"><span class="lineno"> 2225</span>                            $stats[$counter]= array();</div>
<div class="line"><span class="lineno"> 2226</span>                        }</div>
<div class="line"><span class="lineno"> 2227</span>                        <a class="code hl_function" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09">AddValueCreateKey</a>($stats[$counter], <span class="stringliteral">&#39;Sum&#39;</span>, $value);</div>
<div class="line"><span class="lineno"> 2228</span> </div>
<div class="line"><span class="lineno"> 2229</span>                        <span class="keywordflow">if</span> (isset($conf[<span class="stringliteral">&#39;NVPs&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2230</span>                            <span class="keywordflow">foreach</span> ($conf[<span class="stringliteral">&#39;NVPs&#39;</span>] as $name =&gt; $title) {</div>
<div class="line"><span class="lineno"> 2231</span>                                <span class="keywordflow">if</span> (isset($values[$name])) {</div>
<div class="line"><span class="lineno"> 2232</span>                                    <a class="code hl_function" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09">AddValueCreateKey</a>($stats[$counter][$name], $values[$name], $value);</div>
<div class="line"><span class="lineno"> 2233</span>                                }</div>
<div class="line"><span class="lineno"> 2234</span>                            }</div>
<div class="line"><span class="lineno"> 2235</span>                        }</div>
<div class="line"><span class="lineno"> 2236</span>                    }</div>
<div class="line"><span class="lineno"> 2237</span>                }</div>
<div class="line"><span class="lineno"> 2238</span>            }</div>
<div class="line"><span class="lineno"> 2239</span>        }</div>
<div class="line"><span class="lineno"> 2240</span> </div>
<div class="line"><span class="lineno"> 2241</span>        <span class="keywordflow">foreach</span> ($statsdefs as $stat =&gt; $conf) {</div>
<div class="line"><span class="lineno"> 2242</span>            <span class="keywordflow">if</span> (isset($conf[<span class="stringliteral">&#39;Needle&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2243</span>                <span class="keywordflow">if</span> (preg_match(<span class="charliteral">&#39;/&#39;</span>.$conf[<span class="stringliteral">&#39;Needle&#39;</span>].<span class="charliteral">&#39;/&#39;</span>, $line)) {</div>
<div class="line"><span class="lineno"> 2244</span>                    <span class="keywordflow">if</span> (!isset($stats[$stat])) {</div>
<div class="line"><span class="lineno"> 2245</span>                        $stats[$stat]= array();</div>
<div class="line"><span class="lineno"> 2246</span>                    }</div>
<div class="line"><span class="lineno"> 2247</span>                    <a class="code hl_function" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09">AddValueCreateKey</a>($stats[$stat], <span class="stringliteral">&#39;Sum&#39;</span>, 1);</div>
<div class="line"><span class="lineno"> 2248</span> </div>
<div class="line"><span class="lineno"> 2249</span>                    <span class="keywordflow">if</span> (isset($conf[<span class="stringliteral">&#39;NVPs&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2250</span>                        <span class="keywordflow">foreach</span> ($conf[<span class="stringliteral">&#39;NVPs&#39;</span>] as $name =&gt; $title) {</div>
<div class="line"><span class="lineno"> 2251</span>                            <span class="keywordflow">if</span> (isset($values[$name])) {</div>
<div class="line"><span class="lineno"> 2252</span>                                <a class="code hl_function" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09">AddValueCreateKey</a>($stats[$stat][$name], $values[$name], 1);</div>
<div class="line"><span class="lineno"> 2253</span>                            }</div>
<div class="line"><span class="lineno"> 2254</span>                        }</div>
<div class="line"><span class="lineno"> 2255</span>                    }</div>
<div class="line"><span class="lineno"> 2256</span>                }</div>
<div class="line"><span class="lineno"> 2257</span>            }</div>
<div class="line"><span class="lineno"> 2258</span>        }</div>
<div class="line"><span class="lineno"> 2259</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="lib_2lib_8php_source.html#l00096">AddValueCreateKey()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02164">CollectDayStats()</a>, and <a class="el" href="model_8php_source.html#l02198">CollectHourStats()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a10ffb35c34bab2bd539a5a945a489625_cgraph.png" border="0" usemap="#aclassModel_a10ffb35c34bab2bd539a5a945a489625_cgraph" alt=""/></div>
<map name="aclassModel_a10ffb35c34bab2bd539a5a945a489625_cgraph" id="aclassModel_a10ffb35c34bab2bd539a5a945a489625_cgraph">
<area shape="rect" title="Increments stats for the given values." alt="" coords="5,5,80,31"/>
<area shape="rect" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09" title=" " alt="" coords="128,5,279,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a10ffb35c34bab2bd539a5a945a489625_icgraph.png" border="0" usemap="#aclassModel_a10ffb35c34bab2bd539a5a945a489625_icgraph" alt=""/></div>
<map name="aclassModel_a10ffb35c34bab2bd539a5a945a489625_icgraph" id="aclassModel_a10ffb35c34bab2bd539a5a945a489625_icgraph">
<area shape="rect" title="Increments stats for the given values." alt="" coords="808,55,883,80"/>
<area shape="rect" href="classModel.html#ac23e08bf49a305b2d76f11cecc62ba4c" title="Day statistics collector." alt="" coords="455,55,581,80"/>
<area shape="rect" href="classModel.html#abe3e76f34ef7907cc5fcc6d2840bf081" title="Hour statistics collector." alt="" coords="629,80,760,105"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="304,55,407,80"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,29,243,55"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,79,256,104"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="adef576154f41b9e06cbf28bb1a4f74b8" name="adef576154f41b9e06cbf28bb1a4f74b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adef576154f41b9e06cbf28bb1a4f74b8">&#9670;&#160;</a></span>IsLogFileModified()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IsLogFileModified </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logfile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the given log file has been updated. </p>
<p>Compares the full stat info of the orig and tmp files. We unset the last access time before the diff, because it is updated by the stat() call itself too.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$logfile</td><td>Log file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE if modified, FALSE otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01094">1094</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1095</span>    {</div>
<div class="line"><span class="lineno"> 1096</span>        $origfile= $this-&gt;GetOrigFileName($logfile);</div>
<div class="line"><span class="lineno"> 1097</span>        </div>
<div class="line"><span class="lineno"> 1098</span>        <span class="keywordflow">if</span> ($this-&gt;GetStatsFileInfo($logfile, $linecount, $filestat)) {</div>
<div class="line"><span class="lineno"> 1099</span>            <span class="keywordflow">if</span> (file_exists($origfile)) {</div>
<div class="line"><span class="lineno"> 1100</span>                $newfilestat= stat($origfile);</div>
<div class="line"><span class="lineno"> 1101</span> </div>
<div class="line"><span class="lineno"> 1102</span>                $diff= array_diff($newfilestat, $filestat);</div>
<div class="line"><span class="lineno"> 1103</span>                unset($diff[<span class="charliteral">&#39;8&#39;</span>]);</div>
<div class="line"><span class="lineno"> 1104</span>                unset($diff[<span class="stringliteral">&#39;atime&#39;</span>]);</div>
<div class="line"><span class="lineno"> 1105</span>                <span class="keywordflow">if</span> (count($diff) === 0) {</div>
<div class="line"><span class="lineno"> 1106</span>                    <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Logfile not modified: $logfile, linecount $linecount&quot;</span>);</div>
<div class="line"><span class="lineno"> 1107</span>                    <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1108</span>                }</div>
<div class="line"><span class="lineno"> 1109</span>                </div>
<div class="line"><span class="lineno"> 1110</span>                <span class="comment">// Reset the accumulated stats if the log file turned over</span></div>
<div class="line"><span class="lineno"> 1111</span>                <span class="keywordflow">if</span> ($newfilestat[<span class="stringliteral">&#39;ino&#39;</span>] != $filestat[<span class="stringliteral">&#39;ino&#39;</span>]) {</div>
<div class="line"><span class="lineno"> 1112</span>                    $statsfile= $this-&gt;GetStatsFileName($logfile);</div>
<div class="line"><span class="lineno"> 1113</span>                    exec(<span class="stringliteral">&quot;/bin/rm -f $statsfile 2&gt;&amp;1&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno"> 1114</span>                    <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_INFO, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Logfile turned over: $logfile, deleted stats file: $statsfile&quot;</span>);</div>
<div class="line"><span class="lineno"> 1115</span>                }</div>
<div class="line"><span class="lineno"> 1116</span>            }</div>
<div class="line"><span class="lineno"> 1117</span>        }</div>
<div class="line"><span class="lineno"> 1118</span>        <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 1119</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="model_8php_source.html#l01594">GetOrigFileName()</a>, <a class="el" href="model_8php_source.html#l02063">GetStatsFileInfo()</a>, and <a class="el" href="model_8php_source.html#l02096">GetStatsFileName()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01489">_getLogStartDate()</a>, <a class="el" href="model_8php_source.html#l01780">_getStats()</a>, and <a class="el" href="model_8php_source.html#l01060">SelectLogFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_adef576154f41b9e06cbf28bb1a4f74b8_cgraph.png" border="0" usemap="#aclassModel_adef576154f41b9e06cbf28bb1a4f74b8_cgraph" alt=""/></div>
<map name="aclassModel_adef576154f41b9e06cbf28bb1a4f74b8_cgraph" id="aclassModel_adef576154f41b9e06cbf28bb1a4f74b8_cgraph">
<area shape="rect" title="Checks if the given log file has been updated." alt="" coords="5,52,140,78"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="390,27,482,52"/>
<area shape="rect" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7" title="Gets the original file name for the given log file." alt="" coords="557,52,692,78"/>
<area shape="rect" href="classModel.html#a2ef1e4c1d1fadd3c6696a101cd2aa7e5" title="Gets previous line count and stat() from statistics file." alt="" coords="188,78,315,103"/>
<area shape="rect" href="classModel.html#ae24c34977ae6864272b678fe40fdb09a" title="Gets name of the tmp statistics file for the given log file." alt="" coords="366,127,506,152"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="363,78,509,103"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_adef576154f41b9e06cbf28bb1a4f74b8_icgraph.png" border="0" usemap="#aclassModel_adef576154f41b9e06cbf28bb1a4f74b8_icgraph" alt=""/></div>
<map name="aclassModel_adef576154f41b9e06cbf28bb1a4f74b8_icgraph" id="aclassModel_adef576154f41b9e06cbf28bb1a4f74b8_icgraph">
<area shape="rect" title="Checks if the given log file has been updated." alt="" coords="367,104,501,129"/>
<area shape="rect" href="classModel.html#aab423e07962bdc1319b01c6d7c679f0f" title=" " alt="" coords="184,55,319,80"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="210,104,293,129"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="197,153,305,179"/>
<area shape="rect" href="classModel.html#aed5ee3c735f862c4d99761b379f31729" title="Gets log files list with start dates." alt="" coords="10,5,131,31"/>
<area shape="rect" href="classModel.html#a40159dcd03e82eade9e96fd6b8080e89" title="Extracts the datetime of the first line in the log file." alt="" coords="5,55,136,80"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="23,104,118,129"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="31,153,110,179"/>
</map>
</div>

</div>
</div>
<a id="a93da2b4fba63c0813e0210b9d61b5ede" name="a93da2b4fba63c0813e0210b9d61b5ede"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93da2b4fba63c0813e0210b9d61b5ede">&#9670;&#160;</a></span>IsModulePidRunning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IsModulePidRunning </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$pid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the pid is running. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$pid</td><td>Pid </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02660">2660</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2661</span>    {</div>
<div class="line"><span class="lineno"> 2662</span>        $pidcmd= <span class="stringliteral">&quot;/bin/ps -o pid -p $pid | /usr/bin/grep &#39;$pid&#39;&quot;</span>;</div>
<div class="line"><span class="lineno"> 2663</span> </div>
<div class="line"><span class="lineno"> 2664</span>        $output= $this-&gt;RunShellCommand($pidcmd);</div>
<div class="line"><span class="lineno"> 2665</span> </div>
<div class="line"><span class="lineno"> 2666</span>        <span class="keywordflow">return</span> ($output !== <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><span class="lineno"> 2667</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00791">RunShellCommand()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02629">KillPid()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a93da2b4fba63c0813e0210b9d61b5ede_cgraph.png" border="0" usemap="#aclassModel_a93da2b4fba63c0813e0210b9d61b5ede_cgraph" alt=""/></div>
<map name="aclassModel_a93da2b4fba63c0813e0210b9d61b5ede_cgraph" id="aclassModel_a93da2b4fba63c0813e0210b9d61b5ede_cgraph">
<area shape="rect" title="Checks if the pid is running." alt="" coords="5,5,160,31"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="208,5,355,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a93da2b4fba63c0813e0210b9d61b5ede_icgraph.png" border="0" usemap="#aclassModel_a93da2b4fba63c0813e0210b9d61b5ede_icgraph" alt=""/></div>
<map name="aclassModel_a93da2b4fba63c0813e0210b9d61b5ede_icgraph" id="aclassModel_a93da2b4fba63c0813e0210b9d61b5ede_icgraph">
<area shape="rect" title="Checks if the pid is running." alt="" coords="116,5,271,31"/>
<area shape="rect" href="classModel.html#a68390acfc08f9138f4ec2fcc1e18ef7e" title="Kills process with the given pid." alt="" coords="5,5,68,31"/>
</map>
</div>

</div>
</div>
<a id="a6b114b525be039c9d40aced2dba528f6" name="a6b114b525be039c9d40aced2dba528f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b114b525be039c9d40aced2dba528f6">&#9670;&#160;</a></span>isPrio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">isPrio </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$prio</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l03034">3034</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3035</span>    {</div>
<div class="line"><span class="lineno"> 3036</span>        <span class="keywordflow">return</span> array_key_exists(<span class="stringliteral">&#39;Prio&#39;</span>, $log) &amp;&amp; strtoupper($log[<span class="stringliteral">&#39;Prio&#39;</span>]) == $prio;</div>
<div class="line"><span class="lineno"> 3037</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02979">GetStatus()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a6b114b525be039c9d40aced2dba528f6_icgraph.png" border="0" usemap="#aclassModel_a6b114b525be039c9d40aced2dba528f6_icgraph" alt=""/></div>
<map name="aclassModel_a6b114b525be039c9d40aced2dba528f6_icgraph" id="aclassModel_a6b114b525be039c9d40aced2dba528f6_icgraph">
<area shape="rect" title=" " alt="" coords="140,5,199,31"/>
<area shape="rect" href="classModel.html#ab735f5a4ded9f9c9a5b04f182205fd7d" title=" " alt="" coords="5,5,92,31"/>
</map>
</div>

</div>
</div>
<a id="a73fbf3721e73a688382663bf84e1e428" name="a73fbf3721e73a688382663bf84e1e428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73fbf3721e73a688382663bf84e1e428">&#9670;&#160;</a></span>IsRunning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IsRunning </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$proc</em> = <code>''</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the given process(es) is running. </p>
<p>Uses ps with grep.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$proc</td><td>Module process name. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE if there is any process running, FALSE otherwise. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000020">Todo:</a></b></dt><dd>Should use pid files instead of ps, if possible at all </dd></dl>

<p>Reimplemented in <a class="el" href="classPf.html#a73fbf3721e73a688382663bf84e1e428">Pf</a>.</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00332">332</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  333</span>    {</div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordflow">if</span> ($proc == <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno">  335</span>            $proc= $this-&gt;Proc;</div>
<div class="line"><span class="lineno">  336</span>        }</div>
<div class="line"><span class="lineno">  337</span>    </div>
<div class="line"><span class="lineno">  339</span>        $cmd= preg_replace(<span class="stringliteral">&#39;/&lt;PROC&gt;/&#39;</span>, escapeshellarg($proc), $this-&gt;psCmd);</div>
<div class="line"><span class="lineno">  340</span>        exec($cmd, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno">  341</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno">  342</span>            <span class="keywordflow">return</span> count($this-&gt;SelectProcesses($output)) &gt; 0;</div>
<div class="line"><span class="lineno">  343</span>        }</div>
<div class="line"><span class="lineno">  344</span>        <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>(implode(<span class="stringliteral">&quot;\n&quot;</span>, $output));</div>
<div class="line"><span class="lineno">  345</span>        <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;No such process: $proc&quot;</span>);</div>
<div class="line"><span class="lineno">  346</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  347</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>, and <a class="el" href="model_8php_source.html#l00372">SelectProcesses()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02804">_getModuleStatus()</a>, <a class="el" href="Model_2system_8php_source.html#l01014">System\GetRemoteTime()</a>, <a class="el" href="model_8php_source.html#l02588">Kill()</a>, <a class="el" href="model_8php_source.html#l00462">Pkill()</a>, and <a class="el" href="model_8php_source.html#l00415">Start()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a73fbf3721e73a688382663bf84e1e428_cgraph.png" border="0" usemap="#aclassModel_a73fbf3721e73a688382663bf84e1e428_cgraph" alt=""/></div>
<map name="aclassModel_a73fbf3721e73a688382663bf84e1e428_cgraph" id="aclassModel_a73fbf3721e73a688382663bf84e1e428_cgraph">
<area shape="rect" title="Checks if the given process(es) is running." alt="" coords="5,55,92,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="157,5,249,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="177,55,230,80"/>
<area shape="rect" href="classModel.html#aead9ffea53f83ba54a7bc722dbc81841" title="Selects user processes from ps output." alt="" coords="140,104,267,129"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a73fbf3721e73a688382663bf84e1e428_icgraph.png" border="0" usemap="#aclassModel_a73fbf3721e73a688382663bf84e1e428_icgraph" alt=""/></div>
<map name="aclassModel_a73fbf3721e73a688382663bf84e1e428_icgraph" id="aclassModel_a73fbf3721e73a688382663bf84e1e428_icgraph">
<area shape="rect" title="Checks if the given process(es) is running." alt="" coords="492,104,579,129"/>
<area shape="rect" href="classModel.html#a5b9d9c5affe24f91a3151fa107ee80e4" title=" " alt="" coords="283,5,422,31"/>
<area shape="rect" href="classSystem.html#a9d579394f9aad623cebfb05d17af0774" title="Reads datetime temporary output file." alt="" coords="261,55,444,80"/>
<area shape="rect" href="classModel.html#aeb3147c61c1c08d30c6b360ba839b213" title="Stops module&#39;s parent process with its pid." alt="" coords="331,104,374,129"/>
<area shape="rect" href="classModel.html#a4a41a34d3378ee890958973fce464aa8" title="Kills the given process(es)." alt="" coords="327,153,378,179"/>
<area shape="rect" href="classModel.html#a58a42cd2dbcf0483f1da759a8d283d58" title="Start module process(es)." alt="" coords="326,203,379,228"/>
<area shape="rect" href="classModel.html#ac74f9ae5abb475786f8f9278af56e953" title=" " alt="" coords="42,5,177,31"/>
<area shape="rect" href="classSystem.html#a1ffd9dc72330e3a8049e5565d8861ea5" title="Displays datetime from the given time server." alt="" coords="5,79,213,104"/>
<area shape="rect" href="classSystem.html#a7d00602ba2d2adb8db74ff7712fc1bd4" title="Sets datetime from the given time server." alt="" coords="19,128,199,153"/>
<area shape="rect" href="classCollectd.html#a0f17de803b9ad897ee1e879e90982bd2" title="Kills collectd with the KILL signal, if the parent Stop() call fails." alt="" coords="55,177,163,203"/>
<area shape="rect" href="classModel.html#a0f17de803b9ad897ee1e879e90982bd2" title="Stops module process(es)" alt="" coords="84,227,135,252"/>
</map>
</div>

</div>
</div>
<a id="ae36dbd983c2ff1ec0460a158ab8c41f1" name="ae36dbd983c2ff1ec0460a158ab8c41f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae36dbd983c2ff1ec0460a158ab8c41f1">&#9670;&#160;</a></span>isWifiIf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">isWifiIf </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$if</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00520">520</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  521</span>    {</div>
<div class="line"><span class="lineno">  522</span>        exec(<span class="stringliteral">&quot;ifconfig $if 2&gt;/dev/null | grep -q \&quot;^[[:space:]]*ieee80211:\&quot;&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno">  523</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0;</div>
<div class="line"><span class="lineno">  524</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>.</p>

<p class="reference">Referenced by <a class="el" href="Model_2system_8php_source.html#l00468">System\_getIfConfig()</a>, and <a class="el" href="Model_2system_8php_source.html#l01051">System\NetStart()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ae36dbd983c2ff1ec0460a158ab8c41f1_icgraph.png" border="0" usemap="#aclassModel_ae36dbd983c2ff1ec0460a158ab8c41f1_icgraph" alt=""/></div>
<map name="aclassModel_ae36dbd983c2ff1ec0460a158ab8c41f1_icgraph" id="aclassModel_ae36dbd983c2ff1ec0460a158ab8c41f1_icgraph">
<area shape="rect" title=" " alt="" coords="403,55,469,80"/>
<area shape="rect" href="classSystem.html#a8f266bbe68428102e21654d0ce0ad832" title=" " alt="" coords="201,29,355,55"/>
<area shape="rect" href="classSystem.html#a6c0c91116842cbcd97f4311fea0acc8c" title="Restarts the network." alt="" coords="213,79,343,104"/>
<area shape="rect" href="classSystem.html#a6baa62a81a32e122dde71ac97c46fe9a" title="Reads hostname, gateway, and interface configuration." alt="" coords="10,5,149,31"/>
<area shape="rect" href="classSystem.html#a3303bbb179d383a51f6981bcf65372a8" title="Reads interface configuration." alt="" coords="5,55,153,80"/>
</map>
</div>

</div>
</div>
<a id="aeb3147c61c1c08d30c6b360ba839b213" name="aeb3147c61c1c08d30c6b360ba839b213"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb3147c61c1c08d30c6b360ba839b213">&#9670;&#160;</a></span>Kill()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Kill </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stops module's parent process with its pid. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000031">Todo:</a></b></dt><dd>Check $TmpFile for error messages, if so break out instead </dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>Missing pid file means success, proc is not running anyway</dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02588">2588</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2589</span>    {</div>
<div class="line"><span class="lineno"> 2590</span>        global <a class="code hl_variable" href="Controller_2lib_8php.html#a934f13a80ef6f9bc5b5f861e6746792c">$TmpFile</a>;</div>
<div class="line"><span class="lineno"> 2591</span>        </div>
<div class="line"><span class="lineno"> 2592</span>        <span class="keywordflow">if</span> (($pid= $this-&gt;GetFile($this-&gt;PidFile)) !== FALSE) {</div>
<div class="line"><span class="lineno"> 2593</span>            $cmd= <span class="stringliteral">&quot;/bin/kill $pid&quot;</span>;</div>
<div class="line"><span class="lineno"> 2594</span> </div>
<div class="line"><span class="lineno"> 2595</span>            $count= 0;</div>
<div class="line"><span class="lineno"> 2596</span>            <span class="keywordflow">while</span> ($count++ &lt; self::PROC_STAT_TIMEOUT) {</div>
<div class="line"><span class="lineno"> 2597</span>                <span class="keywordflow">if</span> (!$this-&gt;IsRunning()) {</div>
<div class="line"><span class="lineno"> 2598</span>                    <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 2599</span>                }</div>
<div class="line"><span class="lineno"> 2600</span>                $this-&gt;RunShellCommand(<span class="stringliteral">&quot;$cmd &gt; $TmpFile 2&gt;&amp;1&quot;</span>);</div>
<div class="line"><span class="lineno"> 2602</span>                exec(<span class="stringliteral">&#39;/bin/sleep &#39;</span> . self::PROC_STAT_SLEEP_TIME);</div>
<div class="line"><span class="lineno"> 2603</span>            }</div>
<div class="line"><span class="lineno"> 2604</span> </div>
<div class="line"><span class="lineno"> 2605</span>            <span class="comment">// Check one last time due to the last sleep in the loop</span></div>
<div class="line"><span class="lineno"> 2606</span>            <span class="keywordflow">if</span> (!$this-&gt;<a class="code hl_function" href="classModel.html#a73fbf3721e73a688382663bf84e1e428">IsRunning</a>()) {</div>
<div class="line"><span class="lineno"> 2607</span>                <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 2608</span>            }</div>
<div class="line"><span class="lineno"> 2609</span> </div>
<div class="line"><span class="lineno"> 2610</span>            <span class="comment">// Kill command is redirected to tmp file</span></div>
<div class="line"><span class="lineno"> 2611</span>            $output= file_get_contents(<a class="code hl_variable" href="Controller_2lib_8php.html#a934f13a80ef6f9bc5b5f861e6746792c">$TmpFile</a>);</div>
<div class="line"><span class="lineno"> 2612</span>            <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>($output);</div>
<div class="line"><span class="lineno"> 2613</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Kill failed with: $output&quot;</span>);</div>
<div class="line"><span class="lineno"> 2614</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2615</span>        }</div>
<div class="line"><span class="lineno"> 2617</span>        <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 2618</span>    }</div>
<div class="ttc" id="aController_2lib_8php_html_a934f13a80ef6f9bc5b5f861e6746792c"><div class="ttname"><a href="Controller_2lib_8php.html#a934f13a80ef6f9bc5b5f861e6746792c">$TmpFile</a></div><div class="ttdeci">$TmpFile</div><div class="ttdoc">Output and error redirect file.</div><div class="ttdef"><b>Definition:</b> <a href="Controller_2lib_8php_source.html#l00026">lib.php:26</a></div></div>
<div class="ttc" id="aclassModel_html_a73fbf3721e73a688382663bf84e1e428"><div class="ttname"><a href="classModel.html#a73fbf3721e73a688382663bf84e1e428">Model\IsRunning</a></div><div class="ttdeci">IsRunning($proc='')</div><div class="ttdoc">Checks if the given process(es) is running.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l00332">model.php:332</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Controller_2lib_8php_source.html#l00026">$TmpFile</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>, <a class="el" href="model_8php_source.html#l00822">GetFile()</a>, <a class="el" href="model_8php_source.html#l00332">IsRunning()</a>, and <a class="el" href="model_8php_source.html#l00791">RunShellCommand()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aeb3147c61c1c08d30c6b360ba839b213_cgraph.png" border="0" usemap="#aclassModel_aeb3147c61c1c08d30c6b360ba839b213_cgraph" alt=""/></div>
<map name="aclassModel_aeb3147c61c1c08d30c6b360ba839b213_cgraph" id="aclassModel_aeb3147c61c1c08d30c6b360ba839b213_cgraph">
<area shape="rect" title="Stops module&#39;s parent process with its pid." alt="" coords="5,104,48,129"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="308,5,400,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="327,129,381,155"/>
<area shape="rect" href="classModel.html#a91890c866a00b75b002e6b1016e6b43c" title="Reads file contents." alt="" coords="135,104,203,129"/>
<area shape="rect" href="classModel.html#a73fbf3721e73a688382663bf84e1e428" title="Checks if the given process(es) is running." alt="" coords="126,55,213,80"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="96,205,243,231"/>
<area shape="rect" href="classModel.html#aead9ffea53f83ba54a7bc722dbc81841" title="Selects user processes from ps output." alt="" coords="291,55,417,80"/>
</map>
</div>

</div>
</div>
<a id="a68390acfc08f9138f4ec2fcc1e18ef7e" name="a68390acfc08f9138f4ec2fcc1e18ef7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68390acfc08f9138f4ec2fcc1e18ef7e">&#9670;&#160;</a></span>KillPid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">KillPid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$pid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Kills process with the given pid. </p>
<p>Tries PROC_STAT_TIMEOUT times. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000032">Todo:</a></b></dt><dd>Actually should stop retrying on some error conditions?</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$pid</td><td>Pid </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000033">Todo:</a></b></dt><dd>Check $TmpFile for error messages, if so break out instead </dd></dl>
<p>Kill command is redirected to tmp file</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02629">2629</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2630</span>    {</div>
<div class="line"><span class="lineno"> 2631</span>        global <a class="code hl_variable" href="Controller_2lib_8php.html#a934f13a80ef6f9bc5b5f861e6746792c">$TmpFile</a>;</div>
<div class="line"><span class="lineno"> 2632</span> </div>
<div class="line"><span class="lineno"> 2633</span>        $cmd= <span class="stringliteral">&#39;/bin/kill &#39;</span>.$pid;</div>
<div class="line"><span class="lineno"> 2634</span> </div>
<div class="line"><span class="lineno"> 2635</span>        $count= 0;</div>
<div class="line"><span class="lineno"> 2636</span>        <span class="keywordflow">while</span> ($count++ &lt; self::PROC_STAT_TIMEOUT) {</div>
<div class="line"><span class="lineno"> 2637</span>            <span class="keywordflow">if</span> (!$this-&gt;IsModulePidRunning($pid)) {</div>
<div class="line"><span class="lineno"> 2638</span>                <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 2639</span>            }</div>
<div class="line"><span class="lineno"> 2640</span>            $this-&gt;RunShellCommand(<span class="stringliteral">&quot;$cmd &gt; $TmpFile 2&gt;&amp;1&quot;</span>);</div>
<div class="line"><span class="lineno"> 2642</span>            exec(<span class="stringliteral">&#39;/bin/sleep &#39;</span> . self::PROC_STAT_SLEEP_TIME);</div>
<div class="line"><span class="lineno"> 2643</span>        }</div>
<div class="line"><span class="lineno"> 2644</span> </div>
<div class="line"><span class="lineno"> 2646</span>        $output= file_get_contents(<a class="code hl_variable" href="Controller_2lib_8php.html#a934f13a80ef6f9bc5b5f861e6746792c">$TmpFile</a>);</div>
<div class="line"><span class="lineno"> 2647</span>        <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>($output);</div>
<div class="line"><span class="lineno"> 2648</span>        <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Kill failed with: $output&quot;</span>);</div>
<div class="line"><span class="lineno"> 2649</span> </div>
<div class="line"><span class="lineno"> 2650</span>        <span class="comment">// Check one last time due to the last sleep in the loop</span></div>
<div class="line"><span class="lineno"> 2651</span>        <span class="keywordflow">return</span> !$this-&gt;<a class="code hl_function" href="classModel.html#a93da2b4fba63c0813e0210b9d61b5ede">IsModulePidRunning</a>($pid);</div>
<div class="line"><span class="lineno"> 2652</span>    }</div>
<div class="ttc" id="aclassModel_html_a93da2b4fba63c0813e0210b9d61b5ede"><div class="ttname"><a href="classModel.html#a93da2b4fba63c0813e0210b9d61b5ede">Model\IsModulePidRunning</a></div><div class="ttdeci">IsModulePidRunning($pid)</div><div class="ttdoc">Checks if the pid is running.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l02660">model.php:2660</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Controller_2lib_8php_source.html#l00026">$TmpFile</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>, <a class="el" href="model_8php_source.html#l02660">IsModulePidRunning()</a>, and <a class="el" href="model_8php_source.html#l00791">RunShellCommand()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a68390acfc08f9138f4ec2fcc1e18ef7e_cgraph.png" border="0" usemap="#aclassModel_a68390acfc08f9138f4ec2fcc1e18ef7e_cgraph" alt=""/></div>
<map name="aclassModel_a68390acfc08f9138f4ec2fcc1e18ef7e_cgraph" id="aclassModel_a68390acfc08f9138f4ec2fcc1e18ef7e_cgraph">
<area shape="rect" title="Kills process with the given pid." alt="" coords="5,80,68,105"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="147,5,239,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="167,55,220,80"/>
<area shape="rect" href="classModel.html#a93da2b4fba63c0813e0210b9d61b5ede" title="Checks if the pid is running." alt="" coords="116,104,271,129"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="319,129,465,155"/>
</map>
</div>

</div>
</div>
<a id="ad8dbb64d308bdf8cbe3dfee2c84fb9bb" name="ad8dbb64d308bdf8cbe3dfee2c84fb9bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8dbb64d308bdf8cbe3dfee2c84fb9bb">&#9670;&#160;</a></span>ParseLogLine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ParseLogLine </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$cols</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses the given log line. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$logline</td><td>Log line. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$cols</td><td>Parsed fields. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p>Reimplemented in <a class="el" href="classDnsmasq.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb">Dnsmasq</a>, <a class="el" href="classFtpproxy.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb">Ftpproxy</a>, <a class="el" href="classFwlogs.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb">Fwlogs</a>, <a class="el" href="classHttpd.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb">Httpd</a>, <a class="el" href="classHttpdlogs.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb">Httpdlogs</a>, <a class="el" href="classOpenssh.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb">Openssh</a>, and <a class="el" href="classPf.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb">Pf</a>.</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01533">1533</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1534</span>    {</div>
<div class="line"><span class="lineno"> 1535</span>        <span class="keywordflow">return</span> $this-&gt;ParseSyslogLine($logline, $cols);</div>
<div class="line"><span class="lineno"> 1536</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l03062">ParseSyslogLine()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01407">_getLiveLogs()</a>, <a class="el" href="model_8php_source.html#l01489">_getLogStartDate()</a>, <a class="el" href="model_8php_source.html#l01437">GetLastLogs()</a>, <a class="el" href="model_8php_source.html#l01335">GetLogs()</a>, and <a class="el" href="model_8php_source.html#l01919">UpdateStats()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ad8dbb64d308bdf8cbe3dfee2c84fb9bb_cgraph.png" border="0" usemap="#aclassModel_ad8dbb64d308bdf8cbe3dfee2c84fb9bb_cgraph" alt=""/></div>
<map name="aclassModel_ad8dbb64d308bdf8cbe3dfee2c84fb9bb_cgraph" id="aclassModel_ad8dbb64d308bdf8cbe3dfee2c84fb9bb_cgraph">
<area shape="rect" title="Parses the given log line." alt="" coords="5,5,112,31"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="160,5,287,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ad8dbb64d308bdf8cbe3dfee2c84fb9bb_icgraph.png" border="0" usemap="#aclassModel_ad8dbb64d308bdf8cbe3dfee2c84fb9bb_icgraph" alt=""/></div>
<map name="aclassModel_ad8dbb64d308bdf8cbe3dfee2c84fb9bb_icgraph" id="aclassModel_ad8dbb64d308bdf8cbe3dfee2c84fb9bb_icgraph">
<area shape="rect" title="Parses the given log line." alt="" coords="736,177,843,203"/>
<area shape="rect" href="classModel.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="567,79,674,104"/>
<area shape="rect" href="classModel.html#aab423e07962bdc1319b01c6d7c679f0f" title=" " alt="" coords="553,128,688,153"/>
<area shape="rect" href="classModel.html#aaf87c48d0be7e3e4563be72e08f120b0" title=" " alt="" coords="569,177,672,203"/>
<area shape="rect" href="classModel.html#a3cd1d5510b23ec577d9d124f9e05a449" title="Gets lines in log file." alt="" coords="583,227,658,252"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="569,276,672,301"/>
<area shape="rect" href="classModel.html#a75a2cec868b2b3cf1d0f2ae81a799298" title=" " alt="" coords="391,29,489,55"/>
<area shape="rect" href="classModel.html#abd1e082730aeee7890560b4ca2ee0a62" title="Gets logs for live logs pages." alt="" coords="389,79,491,104"/>
<area shape="rect" href="classModel.html#a5b9d9c5affe24f91a3151fa107ee80e4" title=" " alt="" coords="188,5,327,31"/>
<area shape="rect" href="classModel.html#ab735f5a4ded9f9c9a5b04f182205fd7d" title=" " alt="" coords="214,55,301,80"/>
<area shape="rect" href="classModel.html#ac74f9ae5abb475786f8f9278af56e953" title=" " alt="" coords="5,5,140,31"/>
<area shape="rect" href="classModel.html#aed5ee3c735f862c4d99761b379f31729" title="Gets log files list with start dates." alt="" coords="379,128,501,153"/>
<area shape="rect" href="classModel.html#a40159dcd03e82eade9e96fd6b8080e89" title="Extracts the datetime of the first line in the log file." alt="" coords="375,177,505,203"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="399,251,481,276"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="386,300,494,325"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="210,225,305,251"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="218,275,297,300"/>
</map>
</div>

</div>
</div>
<a id="af4eb638f282def52a768efc7dbcbc698" name="af4eb638f282def52a768efc7dbcbc698"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4eb638f282def52a768efc7dbcbc698">&#9670;&#160;</a></span>ParseSyslogLine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ParseSyslogLine </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$cols</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses standard syslog line. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$logline</td><td>Log line </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$cols</td><td>Parsed fields </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l03062">3062</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3063</span>    {</div>
<div class="line"><span class="lineno"> 3064</span>        $re_datetime= <span class="stringliteral">&#39;(\w+\s+\d+)\s+(\d+:\d+:\d+)&#39;</span>;</div>
<div class="line"><span class="lineno"> 3065</span>        $re_proc= <span class="stringliteral">&#39;((\S+(\[\d+\]|)):|)&#39;</span>;</div>
<div class="line"><span class="lineno"> 3066</span>        $re_prio= <span class="stringliteral">&#39;((EMERGENCY|ALERT|CRITICAL|ERROR|WARNING|NOTICE|INFO|DEBUG|emergency|alert|critical|error|warning|notice|info|debug):|)&#39;</span>;</div>
<div class="line"><span class="lineno"> 3067</span>        </div>
<div class="line"><span class="lineno"> 3068</span>        $re= <span class="stringliteral">&quot;/^$re_datetime\s+(\S+|)\s+$re_proc\s*$re_prio\s*(.*|)$/&quot;</span>;</div>
<div class="line"><span class="lineno"> 3069</span>        <span class="keywordflow">if</span> (preg_match($re, $logline, $match)) {</div>
<div class="line"><span class="lineno"> 3070</span>            $cols[<span class="stringliteral">&#39;Date&#39;</span>]= $match[1];</div>
<div class="line"><span class="lineno"> 3071</span>            $cols[<span class="stringliteral">&#39;Time&#39;</span>]= $match[2];</div>
<div class="line"><span class="lineno"> 3072</span>            $cols[<span class="stringliteral">&#39;Process&#39;</span>]= $match[5];</div>
<div class="line"><span class="lineno"> 3073</span>            $cols[<span class="stringliteral">&#39;Prio&#39;</span>]= $match[8];</div>
<div class="line"><span class="lineno"> 3074</span>            $cols[<span class="stringliteral">&#39;Log&#39;</span>]= $match[9];</div>
<div class="line"><span class="lineno"> 3075</span>            <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 3076</span>        }</div>
<div class="line"><span class="lineno"> 3077</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 3078</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="dnsmasq_8php_source.html#l00087">Dnsmasq\ParseLogLine()</a>, <a class="el" href="ftp-proxy_8php_source.html#l00037">Ftpproxy\ParseLogLine()</a>, <a class="el" href="fwlogs_8php_source.html#l00029">Fwlogs\ParseLogLine()</a>, <a class="el" href="Model_2httpd_8php_source.html#l00046">Httpd\ParseLogLine()</a>, <a class="el" href="httpdlogs_8php_source.html#l00033">Httpdlogs\ParseLogLine()</a>, <a class="el" href="model_8php_source.html#l01533">ParseLogLine()</a>, and <a class="el" href="openssh_8php_source.html#l00044">Openssh\ParseLogLine()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_af4eb638f282def52a768efc7dbcbc698_icgraph.png" border="0" usemap="#aclassModel_af4eb638f282def52a768efc7dbcbc698_icgraph" alt=""/></div>
<map name="aclassModel_af4eb638f282def52a768efc7dbcbc698_icgraph" id="aclassModel_af4eb638f282def52a768efc7dbcbc698_icgraph">
<area shape="rect" title="Parses standard syslog line." alt="" coords="991,153,1117,179"/>
<area shape="rect" href="classDnsmasq.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="769,5,941,31"/>
<area shape="rect" href="classFtpproxy.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="771,55,940,80"/>
<area shape="rect" href="classFwlogs.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="777,104,934,129"/>
<area shape="rect" href="classHttpd.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="782,153,929,179"/>
<area shape="rect" href="classHttpdlogs.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="768,203,943,228"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="802,252,909,277"/>
<area shape="rect" href="classOpenssh.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="772,375,939,400"/>
<area shape="rect" href="classModel.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="583,128,690,153"/>
<area shape="rect" href="classModel.html#aab423e07962bdc1319b01c6d7c679f0f" title=" " alt="" coords="569,177,704,203"/>
<area shape="rect" href="classModel.html#aaf87c48d0be7e3e4563be72e08f120b0" title=" " alt="" coords="585,227,688,252"/>
<area shape="rect" href="classModel.html#a3cd1d5510b23ec577d9d124f9e05a449" title="Gets lines in log file." alt="" coords="599,276,674,301"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="585,325,688,351"/>
<area shape="rect" href="classModel.html#a75a2cec868b2b3cf1d0f2ae81a799298" title=" " alt="" coords="391,79,489,104"/>
<area shape="rect" href="classModel.html#abd1e082730aeee7890560b4ca2ee0a62" title="Gets logs for live logs pages." alt="" coords="389,128,491,153"/>
<area shape="rect" href="classModel.html#a5b9d9c5affe24f91a3151fa107ee80e4" title=" " alt="" coords="188,55,327,80"/>
<area shape="rect" href="classModel.html#ab735f5a4ded9f9c9a5b04f182205fd7d" title=" " alt="" coords="214,104,301,129"/>
<area shape="rect" href="classModel.html#ac74f9ae5abb475786f8f9278af56e953" title=" " alt="" coords="5,55,140,80"/>
<area shape="rect" href="classModel.html#aed5ee3c735f862c4d99761b379f31729" title="Gets log files list with start dates." alt="" coords="379,177,501,203"/>
<area shape="rect" href="classModel.html#a40159dcd03e82eade9e96fd6b8080e89" title="Extracts the datetime of the first line in the log file." alt="" coords="375,227,505,252"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="399,300,481,325"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="386,349,494,375"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="210,275,305,300"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="218,324,297,349"/>
<area shape="rect" href="classOpenssh.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="553,375,720,400"/>
<area shape="rect" href="classOpenssh.html#a3cd1d5510b23ec577d9d124f9e05a449" title="Gets lines in log file." alt="" coords="569,424,704,449"/>
</map>
</div>

</div>
</div>
<a id="a4a41a34d3378ee890958973fce464aa8" name="a4a41a34d3378ee890958973fce464aa8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a41a34d3378ee890958973fce464aa8">&#9670;&#160;</a></span>Pkill()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Pkill </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$proc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$args</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Kills the given process(es). </p>
<p>Used to kill processes without a model definition, hence the $proc param. Tries PROC_STAT_TIMEOUT times.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000023">Todo:</a></b></dt><dd>Actually should stop retrying on error?</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$proc</td><td>Process name </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$args</td><td>Args to pass to pkill, e.g. signal name or number </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000024">Todo:</a></b></dt><dd>Check $TmpFile for error messages, if so break out instead </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00462">462</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  463</span>    {</div>
<div class="line"><span class="lineno">  464</span>        global <a class="code hl_variable" href="Controller_2lib_8php.html#a934f13a80ef6f9bc5b5f861e6746792c">$TmpFile</a>;</div>
<div class="line"><span class="lineno">  465</span>        </div>
<div class="line"><span class="lineno">  466</span>        $cmd= <span class="stringliteral">&quot;/usr/bin/pkill $args -x $proc&quot;</span>;</div>
<div class="line"><span class="lineno">  467</span>        </div>
<div class="line"><span class="lineno">  468</span>        $count= 0;</div>
<div class="line"><span class="lineno">  469</span>        <span class="keywordflow">while</span> ($count++ &lt; self::PROC_STAT_TIMEOUT) {</div>
<div class="line"><span class="lineno">  470</span>            <span class="keywordflow">if</span> (!$this-&gt;IsRunning($proc)) {</div>
<div class="line"><span class="lineno">  471</span>                <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  472</span>            }</div>
<div class="line"><span class="lineno">  473</span>            $this-&gt;RunShellCommand(<span class="stringliteral">&quot;$cmd &gt; $TmpFile 2&gt;&amp;1&quot;</span>);</div>
<div class="line"><span class="lineno">  475</span>            exec(<span class="stringliteral">&#39;/bin/sleep &#39;</span> . self::PROC_STAT_SLEEP_TIME);</div>
<div class="line"><span class="lineno">  476</span>        }</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>        <span class="comment">// Check one last time due to the last sleep in the loop</span></div>
<div class="line"><span class="lineno">  479</span>        <span class="keywordflow">if</span> (!$this-&gt;<a class="code hl_function" href="classModel.html#a73fbf3721e73a688382663bf84e1e428">IsRunning</a>($proc)) {</div>
<div class="line"><span class="lineno">  480</span>            <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  481</span>        }</div>
<div class="line"><span class="lineno">  482</span>        </div>
<div class="line"><span class="lineno">  483</span>        <span class="comment">// Pkill command is redirected to the tmp file</span></div>
<div class="line"><span class="lineno">  484</span>        $output= file_get_contents(<a class="code hl_variable" href="Controller_2lib_8php.html#a934f13a80ef6f9bc5b5f861e6746792c">$TmpFile</a>);</div>
<div class="line"><span class="lineno">  485</span>        <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>($output);</div>
<div class="line"><span class="lineno">  486</span>        <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Pkill failed for $proc with: $output&quot;</span>);</div>
<div class="line"><span class="lineno">  487</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  488</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Controller_2lib_8php_source.html#l00026">$TmpFile</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>, <a class="el" href="model_8php_source.html#l00332">IsRunning()</a>, and <a class="el" href="model_8php_source.html#l00791">RunShellCommand()</a>.</p>

<p class="reference">Referenced by <a class="el" href="Model_2system_8php_source.html#l00975">System\DisplayRemoteTime()</a>, <a class="el" href="Model_2system_8php_source.html#l00990">System\SetRemoteTime()</a>, <a class="el" href="collectd_8php_source.html#l00055">Collectd\Stop()</a>, and <a class="el" href="model_8php_source.html#l00445">Stop()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a4a41a34d3378ee890958973fce464aa8_cgraph.png" border="0" usemap="#aclassModel_a4a41a34d3378ee890958973fce464aa8_cgraph" alt=""/></div>
<map name="aclassModel_a4a41a34d3378ee890958973fce464aa8_cgraph" id="aclassModel_a4a41a34d3378ee890958973fce464aa8_cgraph">
<area shape="rect" title="Kills the given process(es)." alt="" coords="5,80,56,105"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="316,5,408,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="335,104,389,129"/>
<area shape="rect" href="classModel.html#a73fbf3721e73a688382663bf84e1e428" title="Checks if the given process(es) is running." alt="" coords="134,55,221,80"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="104,156,251,181"/>
<area shape="rect" href="classModel.html#aead9ffea53f83ba54a7bc722dbc81841" title="Selects user processes from ps output." alt="" coords="299,55,425,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a4a41a34d3378ee890958973fce464aa8_icgraph.png" border="0" usemap="#aclassModel_a4a41a34d3378ee890958973fce464aa8_icgraph" alt=""/></div>
<map name="aclassModel_a4a41a34d3378ee890958973fce464aa8_icgraph" id="aclassModel_a4a41a34d3378ee890958973fce464aa8_icgraph">
<area shape="rect" title="Kills the given process(es)." alt="" coords="261,80,312,105"/>
<area shape="rect" href="classSystem.html#a1ffd9dc72330e3a8049e5565d8861ea5" title="Displays datetime from the given time server." alt="" coords="5,5,213,31"/>
<area shape="rect" href="classSystem.html#a7d00602ba2d2adb8db74ff7712fc1bd4" title="Sets datetime from the given time server." alt="" coords="19,55,199,80"/>
<area shape="rect" href="classCollectd.html#a0f17de803b9ad897ee1e879e90982bd2" title="Kills collectd with the KILL signal, if the parent Stop() call fails." alt="" coords="55,104,163,129"/>
<area shape="rect" href="classModel.html#a0f17de803b9ad897ee1e879e90982bd2" title="Stops module process(es)" alt="" coords="84,153,135,179"/>
</map>
</div>

</div>
</div>
<a id="ae6201c722387cb7120a3447378f73271" name="ae6201c722387cb7120a3447378f73271"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6201c722387cb7120a3447378f73271">&#9670;&#160;</a></span>PostProcessCols()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PostProcessCols </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$cols</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Further processes parser output fields. </p>
<p>Used by statistics collector functions.</p>
<dl class="section attention"><dt>Attention</dt><dd>This cannot be done in the parser. Because details of the Link field is lost, which are needed on log pages.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$cols</td><td>Updated parser output. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classHttpdlogs.html#ae6201c722387cb7120a3447378f73271">Httpdlogs</a>.</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01548">1548</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1549</span>    {</div>
<div class="line"><span class="lineno"> 1550</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01919">UpdateStats()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ae6201c722387cb7120a3447378f73271_icgraph.png" border="0" usemap="#aclassModel_ae6201c722387cb7120a3447378f73271_icgraph" alt=""/></div>
<map name="aclassModel_ae6201c722387cb7120a3447378f73271_icgraph" id="aclassModel_ae6201c722387cb7120a3447378f73271_icgraph">
<area shape="rect" title="Further processes parser output fields." alt="" coords="455,55,583,80"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="304,55,407,80"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,29,243,55"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,79,256,104"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="afb9609a07caf72ce5cc529f4dcca949f" name="afb9609a07caf72ce5cc529f4dcca949f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb9609a07caf72ce5cc529f4dcca949f">&#9670;&#160;</a></span>PrepareFileForDownload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PrepareFileForDownload </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepares file for download over WUI. </p>
<dl class="section return"><dt>Returns</dt><dd>mixed File name or FALSE on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01557">1557</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1558</span>    {</div>
<div class="line"><span class="lineno"> 1559</span>        <span class="keywordflow">if</span> (!$this-&gt;ValidateFile($file)) {</div>
<div class="line"><span class="lineno"> 1560</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1561</span>        }</div>
<div class="line"><span class="lineno"> 1562</span> </div>
<div class="line"><span class="lineno"> 1563</span>        $tmpdir= <a class="code hl_variable" href="defs_8php.html#aa8d15384fc15e1dedc917fe43ebf78e2">PFFWDIR</a>.<span class="stringliteral">&#39;/downloads&#39;</span>;</div>
<div class="line"><span class="lineno"> 1564</span>        <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= 0;</div>
<div class="line"><span class="lineno"> 1565</span>        <span class="keywordflow">if</span> (!file_exists($tmpdir)) {</div>
<div class="line"><span class="lineno"> 1566</span>            exec(<span class="stringliteral">&quot;/bin/mkdir -p $tmpdir 2&gt;&amp;1&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno"> 1567</span>        }</div>
<div class="line"><span class="lineno"> 1568</span>        </div>
<div class="line"><span class="lineno"> 1569</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno"> 1570</span>            exec(<span class="stringliteral">&quot;/bin/rm -f $tmpdir/* 2&gt;&amp;1&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno"> 1571</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno"> 1572</span>                $tmpfile= <span class="stringliteral">&quot;$tmpdir/&quot;</span>.basename($file);</div>
<div class="line"><span class="lineno"> 1573</span>                exec(<span class="stringliteral">&quot;/bin/cp $file $tmpfile 2&gt;&amp;1&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno"> 1574</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno"> 1575</span>                    exec(<span class="stringliteral">&quot;/sbin/chown www:www $tmpfile 2&gt;&amp;1&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno"> 1576</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno"> 1577</span>                        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>($tmpfile);</div>
<div class="line"><span class="lineno"> 1578</span>                    }</div>
<div class="line"><span class="lineno"> 1579</span>                }</div>
<div class="line"><span class="lineno"> 1580</span>            }</div>
<div class="line"><span class="lineno"> 1581</span>        }</div>
<div class="line"><span class="lineno"> 1582</span>        $errout= implode(<span class="stringliteral">&quot;\n&quot;</span>, $output);</div>
<div class="line"><span class="lineno"> 1583</span>        <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>($errout);</div>
<div class="line"><span class="lineno"> 1584</span>        <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;FAILED: $errout&quot;</span>);</div>
<div class="line"><span class="lineno"> 1585</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1586</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>, <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>, <a class="el" href="defs_8php_source.html#l00034">PFFWDIR</a>, and <a class="el" href="model_8php_source.html#l01838">ValidateFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_afb9609a07caf72ce5cc529f4dcca949f_cgraph.png" border="0" usemap="#aclassModel_afb9609a07caf72ce5cc529f4dcca949f_cgraph" alt=""/></div>
<map name="aclassModel_afb9609a07caf72ce5cc529f4dcca949f_cgraph" id="aclassModel_afb9609a07caf72ce5cc529f4dcca949f_cgraph">
<area shape="rect" title="Prepares file for download over WUI." alt="" coords="5,81,185,107"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="237,5,329,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="565,107,619,132"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="249,107,316,132"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="233,156,332,181"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="380,157,517,183"/>
</map>
</div>

</div>
</div>
<a id="a24813c8e79a850571607408548a88528" name="a24813c8e79a850571607408548a88528"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24813c8e79a850571607408548a88528">&#9670;&#160;</a></span>PutFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PutFile </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$contents</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes contents to file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Config filename. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$contents</td><td>Contents to write. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed Output of file_put_contents() or FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00862">862</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  863</span>    {</div>
<div class="line"><span class="lineno">  864</span>        <span class="keywordflow">if</span> (file_exists($file)) {</div>
<div class="line"><span class="lineno">  865</span>            <span class="keywordflow">return</span> file_put_contents($file, $contents, LOCK_EX);</div>
<div class="line"><span class="lineno">  866</span>        }</div>
<div class="line"><span class="lineno">  867</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  868</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02117">SaveStats()</a>, and <a class="el" href="model_8php_source.html#l03123">SetNewsyslogConfig()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a24813c8e79a850571607408548a88528_icgraph.png" border="0" usemap="#aclassModel_a24813c8e79a850571607408548a88528_icgraph" alt=""/></div>
<map name="aclassModel_a24813c8e79a850571607408548a88528_icgraph" id="aclassModel_a24813c8e79a850571607408548a88528_icgraph">
<area shape="rect" title="Writes contents to file." alt="" coords="657,80,724,105"/>
<area shape="rect" href="classModel.html#ab5448888d58c0402bcc575e3a5cd9e9e" title="Saves collected statistics with the current line count and stat() output." alt="" coords="489,55,575,80"/>
<area shape="rect" href="classModel.html#a6bd903872ce2d86a25252a84248f2e3f" title="Sets newsyslog configuration for log file." alt="" coords="455,104,609,129"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="304,55,407,80"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,29,243,55"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,79,256,104"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="aa97184370ce56f1abd12ae18ddbf2c40" name="aa97184370ce56f1abd12ae18ddbf2c40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa97184370ce56f1abd12ae18ddbf2c40">&#9670;&#160;</a></span>ReplaceRegexp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ReplaceRegexp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$matchre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$replacere</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Searches a needle and replaces with a value in the given file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Config file. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$matchre</td><td>Match re. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$replacere</td><td>Replace re. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00968">968</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  969</span>    {</div>
<div class="line"><span class="lineno">  970</span>        <span class="keywordflow">if</span> (copy($file, $file.<span class="stringliteral">&#39;.bak&#39;</span>)) {</div>
<div class="line"><span class="lineno">  971</span>            $contents= preg_replace($matchre, $replacere, file_get_contents($file), 1, $count);</div>
<div class="line"><span class="lineno">  972</span>            <span class="keywordflow">if</span> ($contents !== NULL &amp;&amp; $count === 1) {</div>
<div class="line"><span class="lineno">  973</span>                file_put_contents($file, $contents);</div>
<div class="line"><span class="lineno">  974</span>                <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  975</span>            }</div>
<div class="line"><span class="lineno">  976</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  977</span>                <span class="comment">// Replace failure may not be important, we sometimes search and try to replace possibly nonexistent needles</span></div>
<div class="line"><span class="lineno">  978</span>                <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Cannot replace in: $file&quot;</span>);</div>
<div class="line"><span class="lineno">  979</span>            }</div>
<div class="line"><span class="lineno">  980</span>        }</div>
<div class="line"><span class="lineno">  981</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  982</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Cannot copy file: $file&quot;</span>);</div>
<div class="line"><span class="lineno">  983</span>        }</div>
<div class="line"><span class="lineno">  984</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  985</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>.</p>

<p class="reference">Referenced by <a class="el" href="Model_2system_8php_source.html#l00405">System\DelHost()</a>, <a class="el" href="model_8php_source.html#l02553">DisableName()</a>, <a class="el" href="Model_2system_8php_source.html#l01564">System\DisableNotifier()</a>, <a class="el" href="model_8php_source.html#l02544">DisableNVP()</a>, <a class="el" href="Model_2system_8php_source.html#l01337">System\DisableServiceRcConfLocal()</a>, <a class="el" href="Model_2system_8php_source.html#l01348">System\DisableServiceRcLocal()</a>, <a class="el" href="model_8php_source.html#l02536">EnableName()</a>, <a class="el" href="Model_2system_8php_source.html#l01584">System\EnableNotifier()</a>, <a class="el" href="model_8php_source.html#l02527">EnableNVP()</a>, <a class="el" href="Model_2system_8php_source.html#l01372">System\EnableServiceRcConfLocal()</a>, <a class="el" href="Model_2system_8php_source.html#l01385">System\EnableServiceRcLocal()</a>, <a class="el" href="symon_8php_source.html#l00117">Symon\SetConf()</a>, <a class="el" href="symon_8php_source.html#l00260">Symon\SetCpus()</a>, <a class="el" href="Model_2dhcpd_8php_source.html#l00275">Dhcpd\SetDhcpdConf()</a>, <a class="el" href="Model_2dhcpd_8php_source.html#l00181">Dhcpd\SetIfs()</a>, <a class="el" href="symon_8php_source.html#l00093">Symon\SetIfs()</a>, <a class="el" href="Model_2system_8php_source.html#l01207">System\SetManCgiHome()</a>, <a class="el" href="Model_2system_8php_source.html#l00814">System\SetNameServer()</a>, <a class="el" href="Model_2dhcpd_8php_source.html#l00243">Dhcpd\SetOption()</a>, <a class="el" href="symon_8php_source.html#l00301">Symon\SetPartitions()</a>, <a class="el" href="Model_2dhcpd_8php_source.html#l00257">Dhcpd\SetRange()</a>, <a class="el" href="Model_2system_8php_source.html#l00827">System\SetRootEmail()</a>, and <a class="el" href="symon_8php_source.html#l00278">Symon\SetSensors()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aa97184370ce56f1abd12ae18ddbf2c40_cgraph.png" border="0" usemap="#aclassModel_aa97184370ce56f1abd12ae18ddbf2c40_cgraph" alt=""/></div>
<map name="aclassModel_aa97184370ce56f1abd12ae18ddbf2c40_cgraph" id="aclassModel_aa97184370ce56f1abd12ae18ddbf2c40_cgraph">
<area shape="rect" title="Searches a needle and replaces with a value in the given file." alt="" coords="5,5,128,31"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="176,5,268,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aa97184370ce56f1abd12ae18ddbf2c40_icgraph.png" border="0" usemap="#aclassModel_aa97184370ce56f1abd12ae18ddbf2c40_icgraph" alt=""/></div>
<map name="aclassModel_aa97184370ce56f1abd12ae18ddbf2c40_icgraph" id="aclassModel_aa97184370ce56f1abd12ae18ddbf2c40_icgraph">
<area shape="rect" title="Searches a needle and replaces with a value in the given file." alt="" coords="703,580,825,605"/>
<area shape="rect" href="classSystem.html#a3a530bfd8a776d55344d8122cab77469" title="Deletes host line from hosts file." alt="" coords="480,5,607,31"/>
<area shape="rect" href="classModel.html#a997af94797f7368e6f273a6f9f63d8a8" title="Disables a Name." alt="" coords="488,153,599,179"/>
<area shape="rect" href="classSystem.html#a9ab68d76ae284801fab86bc79307f163" title=" " alt="" coords="457,104,629,129"/>
<area shape="rect" href="classModel.html#a05257350a817e0a8da3dfaa868c623b1" title="Disables an NVP." alt="" coords="494,55,593,80"/>
<area shape="rect" href="classSystem.html#a4e594b13d3033b5cbc33d058e7601c2d" title="Turn off (disable) service startup in rc.conf.local." alt="" coords="434,253,653,293"/>
<area shape="rect" href="classSystem.html#a8e8c70ccebed0fc6e5a96402f33b002a" title="Turn off (disable) service startup in rc.local." alt="" coords="432,203,655,228"/>
<area shape="rect" href="classModel.html#a65410624e4cac2f3429147c621873382" title="Enables a Name: configuration item without value." alt="" coords="491,416,596,441"/>
<area shape="rect" href="classSystem.html#a35859a78a5736fe2821b4531775d4443" title=" " alt="" coords="460,367,627,392"/>
<area shape="rect" href="classModel.html#af8a29b93534e66eb054051710d774895" title="Enables an NVP configuration item with value." alt="" coords="497,317,590,343"/>
<area shape="rect" href="classSystem.html#a35dbaab405c8a07cba37b4a253b4bade" title="Turn on (enable) service startup in rc.conf.local." alt="" coords="437,515,650,555"/>
<area shape="rect" href="classSystem.html#a93af2ff9e1a06c35ad0870f6ff51cd3e" title="Turn on (enable) service startup in rc.local." alt="" coords="435,465,652,491"/>
<area shape="rect" href="classSymon.html#a7cfa59b60de90b66fac33786564689da" title="Sets interface names in the symon and symux config files." alt="" coords="482,580,605,605"/>
<area shape="rect" href="classSymon.html#a8c586413d2b45bcb21c3ef170e641e69" title=" " alt="" coords="481,629,605,655"/>
<area shape="rect" href="classDhcpd.html#a04b594220b8e02597d5e871a4f71a874" title="Sets dhcpd configuration." alt="" coords="5,828,164,853"/>
<area shape="rect" href="classDhcpd.html#a1a87501d4bbc360e41b6ae3487fea361" title="Sets dhcpd interfaces." alt="" coords="491,1027,595,1052"/>
<area shape="rect" href="classSymon.html#a8a838a5a93147d20d19f2f4c44a16b23" title="Sets interface names in the layout files." alt="" coords="489,777,597,803"/>
<area shape="rect" href="classSystem.html#af02c4260858b31c97d512b72b68e3fc9" title="Set int_net." alt="" coords="451,827,635,852"/>
<area shape="rect" href="classSystem.html#ae4217fec0664943b8bec39928f5a66c8" title="Changes nameserver." alt="" coords="455,876,632,901"/>
<area shape="rect" href="classDhcpd.html#a10c46094ac1154529962c05d7746980e" title="Sets the value of the given dhcpd option." alt="" coords="478,728,609,753"/>
<area shape="rect" href="classSymon.html#a0e98d8a401fc7d293c027316be99f6b8" title=" " alt="" coords="467,977,620,1003"/>
<area shape="rect" href="classDhcpd.html#a1b56e203683177fd18806ee4dfd4cecc" title="Sets dhcpd range option." alt="" coords="479,679,608,704"/>
<area shape="rect" href="classSystem.html#a01c46f6f48d8aec5c8ed6fa98183798c" title="Changes root e&#45;mail address." alt="" coords="462,1076,625,1101"/>
<area shape="rect" href="classSymon.html#a50f7fad3eb7f171ae72bcafa7c8a2275" title=" " alt="" coords="472,1125,615,1151"/>
<area shape="rect" href="classSystem.html#ae71ff078bde201e683fe532347febfd7" title="Adds host line to hosts file." alt="" coords="233,5,363,31"/>
<area shape="rect" href="classModel.html#a45811aad99c24bbd1afd2c51d6aaac37" title="Disables a configuration item in conf file." alt="" coords="247,104,349,129"/>
<area shape="rect" href="classSystem.html#aa1fde596bca2fbb737d9818321b55e91" title="Turn off (disable) service startup." alt="" coords="212,232,384,257"/>
<area shape="rect" href="classModel.html#a6abe8763d4525946e15e0d9784d500b8" title="Enables a configuration item in conf file." alt="" coords="250,367,346,392"/>
<area shape="rect" href="classSystem.html#ad3a8a9f79ad33c163c269244d66b356a" title="Turn on (enable) service startup." alt="" coords="215,495,381,520"/>
<area shape="rect" href="classDhcpd.html#a8e88b2ac10b789e5aaa32dfbc7a8cccc" title="Adds a dhcpd interface to listen." alt="" coords="34,1027,135,1052"/>
<area shape="rect" href="classDhcpd.html#a86bbfb98cd42d2a36891000beff08549" title="Deletes a dhcpd interface to listen." alt="" coords="249,1001,347,1027"/>
<area shape="rect" href="classDhcpd.html#ab6cf9d91b80a332efa987969bbf2dfa4" title="Sets dhcpd configuration." alt="" coords="229,728,367,753"/>
</map>
</div>

</div>
</div>
<a id="a9b098af2c181aba08669ccbc185af5d8" name="a9b098af2c181aba08669ccbc185af5d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b098af2c181aba08669ccbc185af5d8">&#9670;&#160;</a></span>RunShellCommand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RunShellCommand </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$cmd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the given shell command and returns its output as string. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000025">Todo:</a></b></dt><dd>Fix return value checks in some references, RunShellCommand() does not return FALSE</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$cmd</td><td>Command string to run. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string Command result in a string. </dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>Do not use shell_exec() here, because it is disabled when PHP is running in safe_mode </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Not all shell commands return 0 on success, such as grep, date... Hence, do not check return value</dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00791">791</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  792</span>    {</div>
<div class="line"><span class="lineno">  796</span>        exec($cmd, $output);</div>
<div class="line"><span class="lineno">  797</span>        <span class="keywordflow">if</span> (is_array($output)) {</div>
<div class="line"><span class="lineno">  798</span>            <span class="keywordflow">return</span> implode(<span class="stringliteral">&quot;\n&quot;</span>, $output);</div>
<div class="line"><span class="lineno">  799</span>        }</div>
<div class="line"><span class="lineno">  800</span>        <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  801</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Model_2dhcpd_8php_source.html#l00305">Dhcpd\_getArpTable()</a>, <a class="el" href="model_8php_source.html#l01279">_getFileLineCount()</a>, <a class="el" href="openssh_8php_source.html#l00090">Openssh\_getFileLineCount()</a>, <a class="el" href="Model_2pf_8php_source.html#l00542">Pf\_getFileLineCount()</a>, <a class="el" href="Model_2system_8php_source.html#l00468">System\_getIfConfig()</a>, <a class="el" href="openssh_8php_source.html#l00154">Openssh\_getLiveLogs()</a>, <a class="el" href="Model_2pf_8php_source.html#l00617">Pf\_getLiveLogs()</a>, <a class="el" href="Model_2system_8php_source.html#l00660">System\_getModuleInfo()</a>, <a class="el" href="model_8php_source.html#l03154">_getPartitions()</a>, <a class="el" href="Model_2system_8php_source.html#l01221">System\_getPartitions()</a>, <a class="el" href="model_8php_source.html#l01036">_getPhyIfs()</a>, <a class="el" href="Model_2pf_8php_source.html#l00655">Pf\_getStateCount()</a>, <a class="el" href="model_8php_source.html#l03050">_getSysCtl()</a>, <a class="el" href="Model_2system_8php_source.html#l00975">System\DisplayRemoteTime()</a>, <a class="el" href="model_8php_source.html#l01520">GetFileFirstLine()</a>, <a class="el" href="model_8php_source.html#l00811">GetFiles()</a>, <a class="el" href="openssh_8php_source.html#l00118">Openssh\GetLogs()</a>, <a class="el" href="Model_2pf_8php_source.html#l00572">Pf\GetLogs()</a>, <a class="el" href="model_8php_source.html#l01613">GetProcStatLines()</a>, <a class="el" href="model_8php_source.html#l02063">GetStatsFileInfo()</a>, <a class="el" href="model_8php_source.html#l01704">GetStatsLogLines()</a>, <a class="el" href="Model_2system_8php_source.html#l01229">System\GetSystemInfo()</a>, <a class="el" href="collectd_8php_source.html#l00042">Collectd\GetVersion()</a>, <a class="el" href="dnsmasq_8php_source.html#l00057">Dnsmasq\GetVersion()</a>, <a class="el" href="Model_2httpd_8php_source.html#l00041">Httpd\GetVersion()</a>, <a class="el" href="model_8php_source.html#l02672">GetVersion()</a>, <a class="el" href="model_8php_source.html#l02660">IsModulePidRunning()</a>, <a class="el" href="Model_2pf_8php_source.html#l00144">Pf\IsRunning()</a>, <a class="el" href="model_8php_source.html#l02588">Kill()</a>, <a class="el" href="model_8php_source.html#l02629">KillPid()</a>, <a class="el" href="model_8php_source.html#l00462">Pkill()</a>, <a class="el" href="Model_2system_8php_source.html#l00962">System\Restart()</a>, <a class="el" href="Model_2system_8php_source.html#l00990">System\SetRemoteTime()</a>, <a class="el" href="Model_2system_8php_source.html#l00951">System\Shutdown()</a>, and <a class="el" href="Model_2system_8php_source.html#l00858">System\UpdateMailAliases()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a9b098af2c181aba08669ccbc185af5d8_icgraph.png" border="0" usemap="#aclassModel_a9b098af2c181aba08669ccbc185af5d8_icgraph" alt=""/></div>
<map name="aclassModel_a9b098af2c181aba08669ccbc185af5d8_icgraph" id="aclassModel_a9b098af2c181aba08669ccbc185af5d8_icgraph">
<area shape="rect" title="Runs the given shell command and returns its output as string." alt="" coords="687,871,833,896"/>
<area shape="rect" href="classDhcpd.html#a107dc08748424350811474f49f7558cf" title=" " alt="" coords="464,29,615,55"/>
<area shape="rect" href="classModel.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="470,476,609,501"/>
<area shape="rect" href="classOpenssh.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="440,131,639,156"/>
<area shape="rect" href="classPf.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="462,180,617,205"/>
<area shape="rect" href="classSystem.html#a8f266bbe68428102e21654d0ce0ad832" title=" " alt="" coords="463,229,616,255"/>
<area shape="rect" href="classOpenssh.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="456,279,623,304"/>
<area shape="rect" href="classPf.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="477,328,601,353"/>
<area shape="rect" href="classSystem.html#a65ffe7950ba3a608bd8839a16ab88fe5" title=" " alt="" coords="451,377,627,403"/>
<area shape="rect" href="classModel.html#a941c3c7c9570b1a241f58024b3cc7963" title="Returns all partitions mounted." alt="" coords="484,624,595,649"/>
<area shape="rect" href="classSystem.html#a941c3c7c9570b1a241f58024b3cc7963" title="Returns all partitions mounted." alt="" coords="457,575,621,600"/>
<area shape="rect" href="classModel.html#a917be6afd7db6dec41becb528b1690d5" title=" " alt="" coords="494,427,585,452"/>
<area shape="rect" href="classPf.html#affff9e51fb2f2d1b6902cd781cfc4d33" title=" " alt="" coords="470,673,609,699"/>
<area shape="rect" href="classModel.html#a5e24130261dd255285454c45adc570eb" title=" " alt="" coords="494,969,585,995"/>
<area shape="rect" href="classSystem.html#a1ffd9dc72330e3a8049e5565d8861ea5" title="Displays datetime from the given time server." alt="" coords="180,1169,388,1195"/>
<area shape="rect" href="classModel.html#ad8f9b01c41c50fcef015cc5444236024" title="Gets first line of file." alt="" coords="478,723,601,748"/>
<area shape="rect" href="classModel.html#aa4ee9332ba73886bc02ffb1903a050ba" title="Returns files with the given filepath pattern." alt="" coords="502,772,577,797"/>
<area shape="rect" href="classOpenssh.html#a3cd1d5510b23ec577d9d124f9e05a449" title="Gets lines in log file." alt="" coords="472,821,607,847"/>
<area shape="rect" href="classPf.html#a3cd1d5510b23ec577d9d124f9e05a449" title="Gets lines in log file." alt="" coords="493,871,585,896"/>
<area shape="rect" href="classModel.html#a392e2975b79f55e83ed15c7c6ed8725c" title="Collects text statistics for the proc stats general page." alt="" coords="473,920,606,945"/>
<area shape="rect" href="classModel.html#a2ef1e4c1d1fadd3c6696a101cd2aa7e5" title="Gets previous line count and stat() from statistics file." alt="" coords="476,525,603,551"/>
<area shape="rect" href="classModel.html#ad26e67d9a70c2182a67b939ae61b6d01" title="Builds generic grep command and extracts log lines." alt="" coords="217,129,351,155"/>
<area shape="rect" href="classSystem.html#a8dd6fe957cf137b1ac7fba58dfc19d2b" title="Gets system information." alt="" coords="453,1071,625,1096"/>
<area shape="rect" href="classCollectd.html#ac9a300b28f440e32170130534117802e" title="Gets software version string." alt="" coords="464,1120,615,1145"/>
<area shape="rect" href="classDnsmasq.html#ac9a300b28f440e32170130534117802e" title="Gets software version string." alt="" coords="460,1169,619,1195"/>
<area shape="rect" href="classHttpd.html#ac9a300b28f440e32170130534117802e" title="Gets software version string." alt="" coords="473,1219,606,1244"/>
<area shape="rect" href="classModel.html#ac9a300b28f440e32170130534117802e" title="Gets software version string." alt="" coords="493,1268,586,1293"/>
<area shape="rect" href="classModel.html#a93da2b4fba63c0813e0210b9d61b5ede" title="Checks if the pid is running." alt="" coords="462,1569,617,1595"/>
<area shape="rect" href="classModel.html#a68390acfc08f9138f4ec2fcc1e18ef7e" title="Kills process with the given pid." alt="" coords="253,1544,315,1569"/>
<area shape="rect" href="classPf.html#a73fbf3721e73a688382663bf84e1e428" title="Checks if pf is enabled or not." alt="" coords="488,1419,591,1444"/>
<area shape="rect" href="classModel.html#aeb3147c61c1c08d30c6b360ba839b213" title="Stops module&#39;s parent process with its pid." alt="" coords="518,1468,561,1493"/>
<area shape="rect" href="classModel.html#a4a41a34d3378ee890958973fce464aa8" title="Kills the given process(es)." alt="" coords="514,1317,565,1343"/>
<area shape="rect" href="classSystem.html#a7d00602ba2d2adb8db74ff7712fc1bd4" title="Sets datetime from the given time server." alt="" coords="194,1343,374,1368"/>
<area shape="rect" href="classSystem.html#a07c2efd2b813bc974c545fcf33783926" title="Restarts the system." alt="" coords="478,1619,601,1644"/>
<area shape="rect" href="classSystem.html#a7a28685b91bcce6b83b26e8d89ea3dee" title="Halts and powers the system down." alt="" coords="470,1668,609,1693"/>
<area shape="rect" href="classSystem.html#a63fe9a960016cbab10ae7db33026de7c" title="Updates mail aliases." alt="" coords="441,1717,638,1743"/>
<area shape="rect" href="classDhcpd.html#a2098bc3392b8cf60eeacce3c674a3983" title=" " alt="" coords="176,55,392,80"/>
<area shape="rect" href="classDhcpd.html#a877ec4d441366844660c27babee71d1a" title="Gets arp table." alt="" coords="211,5,357,31"/>
<area shape="rect" href="classModel.html#ab1e8cbbabce3210438cebad028f153d7" title="Gets the number of lines added to log files since last tmp file update." alt="" coords="214,525,354,551"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="15,475,118,500"/>
<area shape="rect" href="classModel.html#aeea778b449fceb9e5e77cc98440ac4bd" title="Gets line count of the given log file." alt="" coords="217,424,351,449"/>
<area shape="rect" href="classSystem.html#a6baa62a81a32e122dde71ac97c46fe9a" title="Reads hostname, gateway, and interface configuration." alt="" coords="215,301,353,327"/>
<area shape="rect" href="classSystem.html#a3303bbb179d383a51f6981bcf65372a8" title="Reads interface configuration." alt="" coords="210,229,358,255"/>
<area shape="rect" href="classSymon.html#a7cfa59b60de90b66fac33786564689da" title="Sets interface names in the symon and symux config files." alt="" coords="5,919,128,944"/>
<area shape="rect" href="classSymon.html#a0e98d8a401fc7d293c027316be99f6b8" title=" " alt="" coords="207,624,361,649"/>
<area shape="rect" href="classSystem.html#a272de03ad0df8fd45a52b3297cff7aff" title="Gets partition list." alt="" coords="205,575,363,600"/>
<area shape="rect" href="classModel.html#aa7dc2e292df1ab234a44e9e2a5b170b0" title="Extracts physical interface names from ifconfig output." alt="" coords="241,375,327,400"/>
<area shape="rect" href="classPf.html#a65ffe7950ba3a608bd8839a16ab88fe5" title=" " alt="" coords="214,775,354,800"/>
<area shape="rect" href="classPf.html#ac714c065acd4348f73a48b6fb9d9c9dc" title="Gets pf state count." alt="" coords="217,725,351,751"/>
<area shape="rect" href="classModel.html#ad150b90d723746fef93c906fb8548a9e" title="Finds sysctl temp and fan sensors." alt="" coords="236,969,332,995"/>
</map>
</div>

</div>
</div>
<a id="ab5448888d58c0402bcc575e3a5cd9e9e" name="ab5448888d58c0402bcc575e3a5cd9e9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5448888d58c0402bcc575e3a5cd9e9e">&#9670;&#160;</a></span>SaveStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SaveStats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$briefstats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$linecount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Saves collected statistics with the current line count and stat() output. </p>
<dl class="section attention"><dt>Attention</dt><dd>Line count should be obtained before statistics collection, otherwise new lines appended during stats processing may be skipped, hence the $linecount param.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$logfile</td><td>Log file. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$stats</td><td>Statistics. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$briefstats</td><td>Brief statistics. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$linecount</td><td>Line count. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02117">2117</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2118</span>    {</div>
<div class="line"><span class="lineno"> 2119</span>        $origfile= $this-&gt;GetOrigFileName($logfile);</div>
<div class="line"><span class="lineno"> 2120</span>        $statsfile= $this-&gt;GetStatsFileName($logfile);</div>
<div class="line"><span class="lineno"> 2121</span> </div>
<div class="line"><span class="lineno"> 2122</span>        $savestats=</div>
<div class="line"><span class="lineno"> 2123</span>            <span class="stringliteral">&#39;&lt;filestat&gt;&#39;</span>.</div>
<div class="line"><span class="lineno"> 2124</span>            json_encode(</div>
<div class="line"><span class="lineno"> 2125</span>                array(</div>
<div class="line"><span class="lineno"> 2126</span>                    <span class="stringliteral">&#39;linecount&#39;</span> =&gt; $linecount,</div>
<div class="line"><span class="lineno"> 2127</span>                    <span class="stringliteral">&#39;stat&#39;</span>      =&gt; stat($origfile),</div>
<div class="line"><span class="lineno"> 2128</span>                    )</div>
<div class="line"><span class="lineno"> 2129</span>            ).</div>
<div class="line"><span class="lineno"> 2130</span>            <span class="stringliteral">&#39;&lt;/filestat&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.</div>
<div class="line"><span class="lineno"> 2131</span>            json_encode(</div>
<div class="line"><span class="lineno"> 2132</span>                array(</div>
<div class="line"><span class="lineno"> 2133</span>                    <span class="stringliteral">&#39;stats&#39;</span>     =&gt; $stats,</div>
<div class="line"><span class="lineno"> 2134</span>                    <span class="stringliteral">&#39;briefstats&#39;</span>=&gt; $briefstats,</div>
<div class="line"><span class="lineno"> 2135</span>                    )</div>
<div class="line"><span class="lineno"> 2136</span>            );</div>
<div class="line"><span class="lineno"> 2137</span>        </div>
<div class="line"><span class="lineno"> 2138</span>        $statsdir= dirname($statsfile);</div>
<div class="line"><span class="lineno"> 2139</span>        <span class="keywordflow">if</span> (!file_exists($statsdir)) {</div>
<div class="line"><span class="lineno"> 2140</span>            exec(<span class="stringliteral">&#39;/bin/mkdir -p &#39;</span>.$statsdir);</div>
<div class="line"><span class="lineno"> 2141</span>        }</div>
<div class="line"><span class="lineno"> 2142</span>        </div>
<div class="line"><span class="lineno"> 2143</span>        exec(<span class="stringliteral">&#39;/usr/bin/touch &#39;</span>.$statsfile);</div>
<div class="line"><span class="lineno"> 2144</span>        $this-&gt;PutFile($statsfile, $savestats);</div>
<div class="line"><span class="lineno"> 2145</span>        <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Saved stats to: $statsfile&quot;</span>);</div>
<div class="line"><span class="lineno"> 2146</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="model_8php_source.html#l01594">GetOrigFileName()</a>, <a class="el" href="model_8php_source.html#l02096">GetStatsFileName()</a>, and <a class="el" href="model_8php_source.html#l00862">PutFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01919">UpdateStats()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ab5448888d58c0402bcc575e3a5cd9e9e_cgraph.png" border="0" usemap="#aclassModel_ab5448888d58c0402bcc575e3a5cd9e9e_cgraph" alt=""/></div>
<map name="aclassModel_ab5448888d58c0402bcc575e3a5cd9e9e_cgraph" id="aclassModel_ab5448888d58c0402bcc575e3a5cd9e9e_cgraph">
<area shape="rect" title="Saves collected statistics with the current line count and stat() output." alt="" coords="5,81,92,107"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="164,5,256,31"/>
<area shape="rect" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7" title="Gets the original file name for the given log file." alt="" coords="328,81,463,107"/>
<area shape="rect" href="classModel.html#ae24c34977ae6864272b678fe40fdb09a" title="Gets name of the tmp statistics file for the given log file." alt="" coords="140,107,280,132"/>
<area shape="rect" href="classModel.html#a24813c8e79a850571607408548a88528" title="Writes contents to file." alt="" coords="177,156,243,181"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ab5448888d58c0402bcc575e3a5cd9e9e_icgraph.png" border="0" usemap="#aclassModel_ab5448888d58c0402bcc575e3a5cd9e9e_icgraph" alt=""/></div>
<map name="aclassModel_ab5448888d58c0402bcc575e3a5cd9e9e_icgraph" id="aclassModel_ab5448888d58c0402bcc575e3a5cd9e9e_icgraph">
<area shape="rect" title="Saves collected statistics with the current line count and stat() output." alt="" coords="455,55,541,80"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="304,55,407,80"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,29,243,55"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,79,256,104"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="a151a013af243c2c1255caf53dffadc9b" name="a151a013af243c2c1255caf53dffadc9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a151a013af243c2c1255caf53dffadc9b">&#9670;&#160;</a></span>SearchFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SearchFile </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$re</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$set</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$trimchars</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Searches the given file with the given regex. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Config file. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$re</td><td>Regex to search the file with, should have end markers. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$set</td><td>There may be multiple parentheses in $re, which one to return. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$trimchars</td><td>If given, these chars are trimmed on the left or right. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed String found or FALSE if no match. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00929">929</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  930</span>    {</div>
<div class="line"><span class="lineno">  931</span>        <span class="comment">// There may be multiple matching NVPs</span></div>
<div class="line"><span class="lineno">  932</span>        <span class="keywordflow">if</span> (preg_match_all($re, file_get_contents($file), $match)) {</div>
<div class="line"><span class="lineno">  933</span>            <span class="comment">// Index 0 always gives full matches, so use index 1</span></div>
<div class="line"><span class="lineno">  934</span>            <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= $match[1][$set];</div>
<div class="line"><span class="lineno">  935</span>            <span class="keywordflow">if</span> ($trimchars !== <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno">  936</span>                <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= trim(<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>, $trimchars);</div>
<div class="line"><span class="lineno">  937</span>            }</div>
<div class="line"><span class="lineno">  938</span>            <span class="keywordflow">return</span> rtrim(<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno">  939</span>        }</div>
<div class="line"><span class="lineno">  940</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  941</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>.</p>

<p class="reference">Referenced by <a class="el" href="Model_2dhcpd_8php_source.html#l00127">Dhcpd\_getIfs()</a>, <a class="el" href="model_8php_source.html#l02441">GetDisabledName()</a>, <a class="el" href="model_8php_source.html#l02417">GetDisabledNVP()</a>, <a class="el" href="model_8php_source.html#l02429">GetName()</a>, <a class="el" href="Model_2system_8php_source.html#l00442">System\GetNameServer()</a>, <a class="el" href="model_8php_source.html#l00915">GetNVP()</a>, <a class="el" href="Model_2dhcpd_8php_source.html#l00194">Dhcpd\GetOption()</a>, <a class="el" href="Model_2dhcpd_8php_source.html#l00204">Dhcpd\GetRange()</a>, <a class="el" href="Model_2system_8php_source.html#l00452">System\GetRootEmail()</a>, <a class="el" href="Model_2system_8php_source.html#l01275">System\GetServiceStatRcConfLocal()</a>, <a class="el" href="Model_2system_8php_source.html#l01287">System\GetServiceStatRcLocal()</a>, and <a class="el" href="Model_2system_8php_source.html#l01558">System\IsNotifierEnabled()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a151a013af243c2c1255caf53dffadc9b_icgraph.png" border="0" usemap="#aclassModel_a151a013af243c2c1255caf53dffadc9b_icgraph" alt=""/></div>
<map name="aclassModel_a151a013af243c2c1255caf53dffadc9b_icgraph" id="aclassModel_a151a013af243c2c1255caf53dffadc9b_icgraph">
<area shape="rect" title="Searches the given file with the given regex." alt="" coords="851,402,940,427"/>
<area shape="rect" href="classDhcpd.html#a9511320b9872aead409f9be5ac942122" title=" " alt="" coords="636,81,747,106"/>
<area shape="rect" href="classModel.html#a6a716268fcbfd5197d5055df81c2dbc5" title="Checks if commented&#45;out Name exists." alt="" coords="621,229,762,254"/>
<area shape="rect" href="classModel.html#a1aebe30cc76f4942c0333005444fb00f" title="Reads value of commented&#45;out NVP." alt="" coords="627,179,756,205"/>
<area shape="rect" href="classModel.html#ae6cc2dcb5a8fe07db88766823322be7e" title="Checks if Name exists." alt="" coords="649,278,733,303"/>
<area shape="rect" href="classSystem.html#a2fbd383f7bf3bfbec581cb5c42d8c4c7" title="Reads nameserver setting." alt="" coords="602,377,781,402"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="655,327,727,353"/>
<area shape="rect" href="classDhcpd.html#a033c094b5472bdc653d6a0672ceb2b28" title="Reads the value of the given dhcpd option." alt="" coords="625,426,758,451"/>
<area shape="rect" href="classDhcpd.html#aae69fbe200ad80522a57bbba8f62c691" title="Reads dhcpd range option." alt="" coords="626,475,757,501"/>
<area shape="rect" href="classSystem.html#a16a9c3234c5fe7a46dce1f8e13514dae" title="Reads root e&#45;mail address." alt="" coords="609,525,774,550"/>
<area shape="rect" href="classSystem.html#ab991b373017cf08337fee32a8f52e2ce" title="Gets service startup status in rc.conf.local." alt="" coords="582,665,801,705"/>
<area shape="rect" href="classSystem.html#a4931cd6cb25fa48e27d5f7520444b0c0" title="Gets service startup status in rc.local." alt="" coords="580,775,803,801"/>
<area shape="rect" href="classSystem.html#ad87f076a746be808dbe36ced5c7a1a68" title=" " alt="" coords="598,870,785,895"/>
<area shape="rect" href="classDhcpd.html#a8e88b2ac10b789e5aaa32dfbc7a8cccc" title="Adds a dhcpd interface to listen." alt="" coords="85,30,186,55"/>
<area shape="rect" href="classDhcpd.html#a86bbfb98cd42d2a36891000beff08549" title="Deletes a dhcpd interface to listen." alt="" coords="373,130,472,155"/>
<area shape="rect" href="classDhcpd.html#ade8e406a98e0ded7913d3ddbcb5ed116" title="Gets the list of dhcpd interfaces from rc.conf.local file." alt="" coords="369,31,476,57"/>
<area shape="rect" href="classDhcpd.html#a58a42cd2dbcf0483f1da759a8d283d58" title="Starts dhcpd with the list of interfaces obtained from rc.conf.local file." alt="" coords="373,81,472,106"/>
<area shape="rect" href="classModel.html#a9aefd70a0fc1481512f149df7a0376aa" title="Returns all disabled configuration for a given configuration type." alt="" coords="353,179,492,205"/>
<area shape="rect" href="classModel.html#a7b5bd25430f02d1925323e19f2861a9e" title="Gets all configuration for a given configuration type." alt="" coords="71,154,200,179"/>
<area shape="rect" href="classModel.html#ae81727132988d14931750ce5e1c88bd7" title="Returns all enabled configuration for a given configuration type." alt="" coords="382,229,463,254"/>
<area shape="rect" href="classModel.html#aa572c51a6d4aa52ec3029518451a05fe" title=" " alt="" coords="383,278,463,303"/>
<area shape="rect" href="classModel.html#a7abfd365d79fd5b34b3aab5d4ff0c770" title=" " alt="" coords="385,377,461,402"/>
<area shape="rect" href="classDnsmasq.html#a6ce8641410dc2a28206b2e8f6c9db6ff" title="Gets the interface that the DNS forwarder binds to listen for requests." alt="" coords="339,327,506,353"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="387,771,458,797"/>
<area shape="rect" href="classSystem.html#a6baa62a81a32e122dde71ac97c46fe9a" title="Reads hostname, gateway, and interface configuration." alt="" coords="66,351,205,377"/>
<area shape="rect" href="classModel.html#a190806315bf8a8147417f3735ba66bc5" title="Get ext_if." alt="" coords="98,203,173,229"/>
<area shape="rect" href="classModel.html#a5cf12375d05dca29b3c81333ff1882a2" title="Gets service statuses." alt="" coords="68,253,203,278"/>
<area shape="rect" href="classSystem.html#a6c0c91116842cbcd97f4311fea0acc8c" title="Restarts the network." alt="" coords="71,302,200,327"/>
<area shape="rect" href="classModel.html#a14573cc2fd34870091dfe7e8aa1ab171" title="Get int_if." alt="" coords="100,401,171,426"/>
<area shape="rect" href="classSystem.html#a7c21107fcd868c9590f376c07f02afaf" title=" " alt="" coords="69,1289,202,1314"/>
<area shape="rect" href="classSystem.html#a91b60c705c31df895a96ff1480ce85db" title=" " alt="" coords="46,450,225,475"/>
<area shape="rect" href="classSystem.html#a6f28b1520f68197fc3089c87d3ee5a86" title=" " alt="" coords="70,499,201,525"/>
<area shape="rect" href="classSystem.html#a77b569ce1603eae5f71e4f90e9e5c3a0" title=" " alt="" coords="48,549,223,574"/>
<area shape="rect" href="classSystem.html#a84af1d367e28f412bc9a7e07464defc6" title=" " alt="" coords="5,598,265,623"/>
<area shape="rect" href="classSystem.html#a896e4c34afa76bb1359be66b348597f6" title=" " alt="" coords="8,647,263,673"/>
<area shape="rect" href="classModel.html#a4c5f8b05e5cbfffe696da52ce05f066a" title="Sets the value of NVP configuration." alt="" coords="81,697,190,722"/>
<area shape="rect" href="classModel.html#a859ad1e51288c4d72ed9eda0f6f5e43e" title="Sets default locale." alt="" coords="69,746,202,771"/>
<area shape="rect" href="classModel.html#a396fea6ec5c2ad29ebee26ea36723133" title="Enables or disables HTTPs." alt="" coords="76,795,195,821"/>
<area shape="rect" href="classModel.html#abbf4c282267beb7f8667d0882d82b983" title="Enables or disables help boxes." alt="" coords="86,845,185,870"/>
<area shape="rect" href="classPf.html#a8a838a5a93147d20d19f2f4c44a16b23" title="Sets interface names in pf.conf." alt="" coords="97,894,173,919"/>
<area shape="rect" href="classPf.html#ae936293c9b2b0d90849d2c17acc1e6e8" title="Sets int_net." alt="" coords="86,943,185,969"/>
<area shape="rect" href="classDnsmasq.html#aafd6db1bc365b4992ffdc2894821194f" title="Sets the interface that the DNS forwarder binds to listen for requests." alt="" coords="53,993,218,1018"/>
<area shape="rect" href="classModel.html#ace6809a36e1a52e1dde4c9d6d662ca4c" title="Sets global log level." alt="" coords="85,1042,186,1067"/>
<area shape="rect" href="classModel.html#ad3d333424199ea8d1475ffb779b5407c" title="Sets the max number of nested anchors allowed." alt="" coords="52,1091,219,1117"/>
<area shape="rect" href="classModel.html#a396a20de76a1a352c40b3eb64d21bce9" title="Sets max file size to process." alt="" coords="43,1141,228,1166"/>
<area shape="rect" href="classSystem.html#a59df788be29e03ef99af4f3a16fdb1a0" title=" " alt="" coords="74,1190,197,1215"/>
<area shape="rect" href="classSystem.html#af6fa08d72148c73798549ca54163b619" title=" " alt="" coords="60,1239,211,1265"/>
<area shape="rect" href="classSystem.html#a808c908777b00099fd26d81392a16cea" title="Gets service start stati." alt="" coords="313,821,532,846"/>
<area shape="rect" href="classSystem.html#a9ab68d76ae284801fab86bc79307f163" title=" " alt="" coords="337,919,509,945"/>
<area shape="rect" href="classSystem.html#a35859a78a5736fe2821b4531775d4443" title=" " alt="" coords="339,870,506,895"/>
</map>
</div>

</div>
</div>
<a id="a42dee43d638f627934bd6bca7b8f1397" name="a42dee43d638f627934bd6bca7b8f1397"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42dee43d638f627934bd6bca7b8f1397">&#9670;&#160;</a></span>SearchFileAll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SearchFileAll </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$re</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$set</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Multi-searches a given file with a given regexp. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Config file. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$re</td><td>Regexp to search the file with, should have end markers. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$set</td><td>There may be multiple parentheses in $re, which one to return. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed String found or FALSE on fail. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000027">Todo:</a></b></dt><dd>What to do multiple matching NVPs </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00951">951</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  952</span>    {</div>
<div class="line"><span class="lineno">  954</span>        <span class="keywordflow">if</span> (preg_match_all($re, file_get_contents($file), $match)) {</div>
<div class="line"><span class="lineno">  955</span>            <span class="keywordflow">return</span> implode(<span class="stringliteral">&quot;\n&quot;</span>, array_values($match[$set]));</div>
<div class="line"><span class="lineno">  956</span>        }</div>
<div class="line"><span class="lineno">  957</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  958</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Model_2system_8php_source.html#l00415">System\GetHosts()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a42dee43d638f627934bd6bca7b8f1397_icgraph.png" border="0" usemap="#aclassModel_a42dee43d638f627934bd6bca7b8f1397_icgraph" alt=""/></div>
<map name="aclassModel_a42dee43d638f627934bd6bca7b8f1397_icgraph" id="aclassModel_a42dee43d638f627934bd6bca7b8f1397_icgraph">
<area shape="rect" title="Multi&#45;searches a given file with a given regexp." alt="" coords="188,5,295,31"/>
<area shape="rect" href="classSystem.html#a32eb4a51971a43b958a7af6f4465696a" title="Reads hosts file contents." alt="" coords="5,5,140,31"/>
</map>
</div>

</div>
</div>
<a id="aacf995c8c1f12fe1a00b653fd790c3ef" name="aacf995c8c1f12fe1a00b653fd790c3ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacf995c8c1f12fe1a00b653fd790c3ef">&#9670;&#160;</a></span>SelectLogFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SelectLogFile </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the log file under the tmp folder. </p>
<p>Updates the tmp file if the original file is modified. Updates the stat info of the file in the tmp statistics file, which is used to check file modification.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Original file name. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string Pathname of the log file. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01060">1060</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1061</span>    {</div>
<div class="line"><span class="lineno"> 1062</span>        <span class="keywordflow">if</span> ($file === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1063</span>            $file= <a class="code hl_variable" href="logs_8archives_8php.html#a09ce856a444e6c8704d1c5cc9f63e347">$this-&gt;LogFile</a>;</div>
<div class="line"><span class="lineno"> 1064</span>        }</div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>        <span class="keywordflow">if</span> (!$this-&gt;ValidateFile($file)) {</div>
<div class="line"><span class="lineno"> 1067</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1068</span>        }</div>
<div class="line"><span class="lineno"> 1069</span> </div>
<div class="line"><span class="lineno"> 1070</span>        $file= $this-&gt;<a class="code hl_function" href="classModel.html#a7ece271b0ef8636736f58b3b75268931">GetTmpLogFileName</a>($file);</div>
<div class="line"><span class="lineno"> 1071</span> </div>
<div class="line"><span class="lineno"> 1072</span>        <span class="keywordflow">if</span> (!file_exists($file) || $this-&gt;<a class="code hl_function" href="classModel.html#adef576154f41b9e06cbf28bb1a4f74b8">IsLogFileModified</a>($file)) {</div>
<div class="line"><span class="lineno"> 1073</span>            <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classModel.html#ad4d7aefbd214d3da3f1965e6ddddb998">UpdateTmpLogFile</a>($file)) {</div>
<div class="line"><span class="lineno"> 1074</span>                <span class="comment">// Update stats to update file stat info only</span></div>
<div class="line"><span class="lineno"> 1075</span>                $this-&gt;<a class="code hl_function" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c">UpdateStats</a>($file, $stats, $briefstats);</div>
<div class="line"><span class="lineno"> 1076</span>            }</div>
<div class="line"><span class="lineno"> 1077</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1078</span>                $file= <a class="code hl_variable" href="logs_8archives_8php.html#a09ce856a444e6c8704d1c5cc9f63e347">$this-&gt;LogFile</a>;</div>
<div class="line"><span class="lineno"> 1079</span>                <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Logfile tmp copy update failed, defaulting to: $file&quot;</span>);</div>
<div class="line"><span class="lineno"> 1080</span>            }</div>
<div class="line"><span class="lineno"> 1081</span>        }</div>
<div class="line"><span class="lineno"> 1082</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd">Output</a>($file);</div>
<div class="line"><span class="lineno"> 1083</span>    }</div>
<div class="ttc" id="aclassModel_html_a7ece271b0ef8636736f58b3b75268931"><div class="ttname"><a href="classModel.html#a7ece271b0ef8636736f58b3b75268931">Model\GetTmpLogFileName</a></div><div class="ttdeci">GetTmpLogFileName($file)</div><div class="ttdoc">Gets the name of the file in the tmp folder.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l01127">model.php:1127</a></div></div>
<div class="ttc" id="aclassModel_html_ad4d7aefbd214d3da3f1965e6ddddb998"><div class="ttname"><a href="classModel.html#ad4d7aefbd214d3da3f1965e6ddddb998">Model\UpdateTmpLogFile</a></div><div class="ttdeci">UpdateTmpLogFile($file)</div><div class="ttdoc">Copies the original log file to tmp folder.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l01144">model.php:1144</a></div></div>
<div class="ttc" id="aclassModel_html_adef576154f41b9e06cbf28bb1a4f74b8"><div class="ttname"><a href="classModel.html#adef576154f41b9e06cbf28bb1a4f74b8">Model\IsLogFileModified</a></div><div class="ttdeci">IsLogFileModified($logfile)</div><div class="ttdoc">Checks if the given log file has been updated.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l01094">model.php:1094</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="logs_8archives_8php_source.html#l00044">$LogFile</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="model_8php_source.html#l01127">GetTmpLogFileName()</a>, <a class="el" href="model_8php_source.html#l01094">IsLogFileModified()</a>, <a class="el" href="Model_2include_8php_source.html#l00108">Output()</a>, <a class="el" href="model_8php_source.html#l01919">UpdateStats()</a>, <a class="el" href="model_8php_source.html#l01144">UpdateTmpLogFile()</a>, and <a class="el" href="model_8php_source.html#l01838">ValidateFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aacf995c8c1f12fe1a00b653fd790c3ef_cgraph.png" border="0" usemap="#aclassModel_aacf995c8c1f12fe1a00b653fd790c3ef_cgraph" alt=""/></div>
<map name="aclassModel_aacf995c8c1f12fe1a00b653fd790c3ef_cgraph" id="aclassModel_aacf995c8c1f12fe1a00b653fd790c3ef_cgraph">
<area shape="rect" title="Gets the log file under the tmp folder." alt="" coords="5,560,113,585"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="789,535,881,560"/>
<area shape="rect" href="classModel.html#a7ece271b0ef8636736f58b3b75268931" title="Gets the name of the file in the tmp folder." alt="" coords="161,459,320,484"/>
<area shape="rect" href="classModel.html#adef576154f41b9e06cbf28bb1a4f74b8" title="Checks if the given log file has been updated." alt="" coords="373,509,507,535"/>
<area shape="rect" href="Model_2include_8php.html#af6395f757480163a2a2645bbb2cdb8cd" title="Sets or updates $Output with the given message." alt="" coords="207,560,274,585"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="189,332,292,357"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="786,957,885,983"/>
<area shape="rect" href="classModel.html#ad4d7aefbd214d3da3f1965e6ddddb998" title="Copies the original log file to tmp folder." alt="" coords="169,763,313,788"/>
<area shape="rect" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7" title="Gets the original file name for the given log file." alt="" coords="980,408,1115,433"/>
<area shape="rect" href="classModel.html#a2ef1e4c1d1fadd3c6696a101cd2aa7e5" title="Gets previous line count and stat() from statistics file." alt="" coords="566,509,693,535"/>
<area shape="rect" href="classModel.html#ae24c34977ae6864272b678fe40fdb09a" title="Gets name of the tmp statistics file for the given log file." alt="" coords="765,408,905,433"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="762,763,909,788"/>
<area shape="rect" href="classModel.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="560,763,699,788"/>
<area shape="rect" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09" title=" " alt="" coords="972,55,1123,80"/>
<area shape="rect" href="classModel.html#ac23e08bf49a305b2d76f11cecc62ba4c" title="Day statistics collector." alt="" coords="377,55,503,80"/>
<area shape="rect" href="classModel.html#ab1e8cbbabce3210438cebad028f153d7" title="Gets the number of lines added to log files since last tmp file update." alt="" coords="370,459,510,484"/>
<area shape="rect" href="classModel.html#a1149c6f5338677a1a74e8a4964826e80" title="Gets saved statistics for the given log file." alt="" coords="570,205,689,231"/>
<area shape="rect" href="classModel.html#ad26e67d9a70c2182a67b939ae61b6d01" title="Builds generic grep command and extracts log lines." alt="" coords="562,913,697,939"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="387,307,493,332"/>
<area shape="rect" href="classModel.html#ae6201c722387cb7120a3447378f73271" title="Further processes parser output fields." alt="" coords="376,356,504,381"/>
<area shape="rect" href="classModel.html#ab5448888d58c0402bcc575e3a5cd9e9e" title="Saves collected statistics with the current line count and stat() output." alt="" coords="586,156,673,181"/>
<area shape="rect" href="classModel.html#a3827d539c75623fd5345ab590caaa2cb" title="Generates the module specific datetime regexp for filtering logs." alt="" coords="747,713,924,739"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="1171,971,1224,996"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="979,945,1116,971"/>
<area shape="rect" href="classModel.html#abe3e76f34ef7907cc5fcc6d2840bf081" title="Hour statistics collector." alt="" coords="564,55,695,80"/>
<area shape="rect" href="classModel.html#a10ffb35c34bab2bd539a5a945a489625" title="Increments stats for the given values." alt="" coords="798,5,873,31"/>
<area shape="rect" href="classModel.html#a3b4ab5022e1e5883d5292c024eaaf8c1" title="Minute statistics collector." alt="" coords="763,55,908,80"/>
<area shape="rect" href="classModel.html#a91890c866a00b75b002e6b1016e6b43c" title="Reads file contents." alt="" coords="801,257,869,283"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="566,307,693,332"/>
<area shape="rect" href="classModel.html#a24813c8e79a850571607408548a88528" title="Writes contents to file." alt="" coords="802,156,869,181"/>
<area shape="rect" href="classModel.html#a5cdc13ae8497b92e1c6cbf8b85c6d43c" title="Uncompresses gzipped log file to tmp dir." alt="" coords="368,864,512,889"/>
<area shape="rect" href="classModel.html#a620707dcc4093d4ca002e3dfdfa68af1" title="Deletes the given file or directory." alt="" coords="585,864,673,889"/>
</map>
</div>

</div>
</div>
<a id="aead9ffea53f83ba54a7bc722dbc81841" name="aead9ffea53f83ba54a7bc722dbc81841"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aead9ffea53f83ba54a7bc722dbc81841">&#9670;&#160;</a></span>SelectProcesses()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SelectProcesses </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$psout</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Selects user processes from ps output. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$psout</td><td>ps output obtained elsewhere. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array Parsed ps output of user processes. </dd></dl>

<p>Reimplemented in <a class="el" href="classSystem.html#aead9ffea53f83ba54a7bc722dbc81841">System</a>.</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00372">372</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  373</span>    {</div>
<div class="line"><span class="lineno">  374</span>        <span class="comment">//   PID STARTED  %CPU      TIME %MEM   RSS   VSZ STAT  PRI  NI TTY      USER     GROUP    COMMAND</span></div>
<div class="line"><span class="lineno">  375</span>        <span class="comment">//     1  5:10PM   0.0   0:00.03  0.0   388   412 Is     10   0 ??       root     wheel    /sbin/init</span></div>
<div class="line"><span class="lineno">  376</span>        <span class="comment">// Skip processes running on terminals, e.g. vi, tail, man</span></div>
<div class="line"><span class="lineno">  377</span>        <span class="comment">// Select based on daemon user</span></div>
<div class="line"><span class="lineno">  378</span>        $re= <span class="stringliteral">&quot;/^\s*(\d+)\s+(\S+)\s+(\S+)\s+(\S+)\s+(\S+)\s+(\d+)\s+(\d+)\s+(\S+)\s+(\d+)\s+(\d+)\s+\?\?\s+($this-&gt;User)\s+(\S+)\s+(.+)$/&quot;</span>;</div>
<div class="line"><span class="lineno">  379</span>        </div>
<div class="line"><span class="lineno">  380</span>        $processes= array();</div>
<div class="line"><span class="lineno">  381</span>        <span class="keywordflow">foreach</span> ($psout as $line) {</div>
<div class="line"><span class="lineno">  382</span>            <span class="keywordflow">if</span> (preg_match($re, $line, $match)) {</div>
<div class="line"><span class="lineno">  383</span>                <span class="comment">// Skip processes initiated by this WUI</span></div>
<div class="line"><span class="lineno">  384</span>                <span class="keywordflow">if</span> (!preg_match(<span class="stringliteral">&#39;/\b(ctlr\.php|grep|kill|pkill)\b/&#39;</span>, $match[13])) {</div>
<div class="line"><span class="lineno">  385</span>                    $processes[]= array(</div>
<div class="line"><span class="lineno">  386</span>                        $match[1],</div>
<div class="line"><span class="lineno">  387</span>                        $match[2],</div>
<div class="line"><span class="lineno">  388</span>                        $match[3],</div>
<div class="line"><span class="lineno">  389</span>                        $match[4],</div>
<div class="line"><span class="lineno">  390</span>                        $match[5],</div>
<div class="line"><span class="lineno">  391</span>                        $match[6],</div>
<div class="line"><span class="lineno">  392</span>                        $match[7],</div>
<div class="line"><span class="lineno">  393</span>                        $match[8],</div>
<div class="line"><span class="lineno">  394</span>                        $match[9],</div>
<div class="line"><span class="lineno">  395</span>                        $match[10],</div>
<div class="line"><span class="lineno">  396</span>                        $match[11],</div>
<div class="line"><span class="lineno">  397</span>                        $match[12],</div>
<div class="line"><span class="lineno">  398</span>                        $match[13],</div>
<div class="line"><span class="lineno">  399</span>                        );</div>
<div class="line"><span class="lineno">  400</span>                }</div>
<div class="line"><span class="lineno">  401</span>            }</div>
<div class="line"><span class="lineno">  402</span>        }</div>
<div class="line"><span class="lineno">  403</span>        <span class="keywordflow">return</span> $processes;</div>
<div class="line"><span class="lineno">  404</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l00354">GetProcList()</a>, and <a class="el" href="model_8php_source.html#l00332">IsRunning()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_aead9ffea53f83ba54a7bc722dbc81841_icgraph.png" border="0" usemap="#aclassModel_aead9ffea53f83ba54a7bc722dbc81841_icgraph" alt=""/></div>
<map name="aclassModel_aead9ffea53f83ba54a7bc722dbc81841_icgraph" id="aclassModel_aead9ffea53f83ba54a7bc722dbc81841_icgraph">
<area shape="rect" title="Selects user processes from ps output." alt="" coords="636,80,763,105"/>
<area shape="rect" href="classModel.html#ac63c8a259bd05dfef1e6979a2c1f76d0" title="Gets the list of processes running." alt="" coords="492,55,588,80"/>
<area shape="rect" href="classModel.html#a73fbf3721e73a688382663bf84e1e428" title="Checks if the given process(es) is running." alt="" coords="497,104,583,129"/>
<area shape="rect" href="classModel.html#a5b9d9c5affe24f91a3151fa107ee80e4" title=" " alt="" coords="283,5,422,31"/>
<area shape="rect" href="classSystem.html#a9d579394f9aad623cebfb05d17af0774" title="Reads datetime temporary output file." alt="" coords="261,55,444,80"/>
<area shape="rect" href="classModel.html#aeb3147c61c1c08d30c6b360ba839b213" title="Stops module&#39;s parent process with its pid." alt="" coords="331,104,374,129"/>
<area shape="rect" href="classModel.html#a4a41a34d3378ee890958973fce464aa8" title="Kills the given process(es)." alt="" coords="327,153,378,179"/>
<area shape="rect" href="classModel.html#a58a42cd2dbcf0483f1da759a8d283d58" title="Start module process(es)." alt="" coords="326,203,379,228"/>
<area shape="rect" href="classModel.html#ac74f9ae5abb475786f8f9278af56e953" title=" " alt="" coords="42,5,177,31"/>
<area shape="rect" href="classSystem.html#a1ffd9dc72330e3a8049e5565d8861ea5" title="Displays datetime from the given time server." alt="" coords="5,79,213,104"/>
<area shape="rect" href="classSystem.html#a7d00602ba2d2adb8db74ff7712fc1bd4" title="Sets datetime from the given time server." alt="" coords="19,128,199,153"/>
<area shape="rect" href="classCollectd.html#a0f17de803b9ad897ee1e879e90982bd2" title="Kills collectd with the KILL signal, if the parent Stop() call fails." alt="" coords="55,177,163,203"/>
<area shape="rect" href="classModel.html#a0f17de803b9ad897ee1e879e90982bd2" title="Stops module process(es)" alt="" coords="84,227,135,252"/>
</map>
</div>

</div>
</div>
<a id="a63e6c944f6d63934ee3f05c24bc3e122" name="a63e6c944f6d63934ee3f05c24bc3e122"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63e6c944f6d63934ee3f05c24bc3e122">&#9670;&#160;</a></span>SetConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetConfig </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$confname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets configuration file based on config type provided. </p>
<p>Certain modules have configuration divided into multiple pages/files, hence they override this method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$confname</td><td>Config type </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02581">2581</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2582</span>    {</div>
<div class="line"><span class="lineno"> 2583</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02508">DisableConf()</a>, <a class="el" href="model_8php_source.html#l02494">EnableConf()</a>, <a class="el" href="model_8php_source.html#l02305">GetConfigValues()</a>, and <a class="el" href="model_8php_source.html#l02455">SetConfValue()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a63e6c944f6d63934ee3f05c24bc3e122_icgraph.png" border="0" usemap="#aclassModel_a63e6c944f6d63934ee3f05c24bc3e122_icgraph" alt=""/></div>
<map name="aclassModel_a63e6c944f6d63934ee3f05c24bc3e122_icgraph" id="aclassModel_a63e6c944f6d63934ee3f05c24bc3e122_icgraph">
<area shape="rect" title="Sets configuration file based on config type provided." alt="" coords="183,80,267,105"/>
<area shape="rect" href="classModel.html#a45811aad99c24bbd1afd2c51d6aaac37" title="Disables a configuration item in conf file." alt="" coords="19,5,121,31"/>
<area shape="rect" href="classModel.html#a6abe8763d4525946e15e0d9784d500b8" title="Enables a configuration item in conf file." alt="" coords="22,55,118,80"/>
<area shape="rect" href="classModel.html#a7b5bd25430f02d1925323e19f2861a9e" title="Gets all configuration for a given configuration type." alt="" coords="5,104,135,129"/>
<area shape="rect" href="classModel.html#a4c5f8b05e5cbfffe696da52ce05f066a" title="Sets the value of NVP configuration." alt="" coords="15,153,125,179"/>
</map>
</div>

</div>
</div>
<a id="a4c5f8b05e5cbfffe696da52ce05f066a" name="a4c5f8b05e5cbfffe696da52ce05f066a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c5f8b05e5cbfffe696da52ce05f066a">&#9670;&#160;</a></span>SetConfValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetConfValue </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$newvalue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the value of NVP configuration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$name</td><td>Config name </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$newvalue</td><td>New Config value </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$conf</td><td>Config type </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$group</td><td>E2guardian group </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l02455">2455</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2456</span>    {</div>
<div class="line"><span class="lineno"> 2457</span>        $this-&gt;SetConfig($conf);</div>
<div class="line"><span class="lineno"> 2458</span>        <span class="keywordflow">if</span> (isset($this-&gt;Config[$name][<span class="stringliteral">&#39;type&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2459</span>            $re= $this-&gt;Config[$name][<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><span class="lineno"> 2460</span>        }</div>
<div class="line"><span class="lineno"> 2461</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2462</span>            $re= <span class="stringliteral">&#39;.*&#39;</span>;</div>
<div class="line"><span class="lineno"> 2463</span>        }</div>
<div class="line"><span class="lineno"> 2464</span> </div>
<div class="line"><span class="lineno"> 2465</span>        <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&quot;/^($re)$/&quot;</span>, $newvalue)) {</div>
<div class="line"><span class="lineno"> 2466</span>            $file= $this-&gt;<a class="code hl_function" href="classModel.html#ae08f1955abf4f7b5ca00ec1fec76041f">GetConfFile</a>($conf, $group);</div>
<div class="line"><span class="lineno"> 2467</span>            <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de">SetNVP</a>($file, $name, $newvalue);</div>
<div class="line"><span class="lineno"> 2468</span>        }</div>
<div class="line"><span class="lineno"> 2469</span>        <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>(_(<span class="stringliteral">&#39;Invalid value&#39;</span>).<span class="stringliteral">&quot;: $name: $newvalue&quot;</span>);</div>
<div class="line"><span class="lineno"> 2470</span>        <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_NOTICE, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Configuration change failed, invalid value: $name: $newvalue&quot;</span>);</div>
<div class="line"><span class="lineno"> 2471</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2472</span>    }</div>
<div class="ttc" id="aclassModel_html_abcd01c30cbd8fa9ac1c84340e5ed33de"><div class="ttname"><a href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de">Model\SetNVP</a></div><div class="ttdeci">SetNVP($file, $name, $newvalue)</div><div class="ttdoc">Changes value of NVP.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l00878">model.php:878</a></div></div>
<div class="ttc" id="aclassModel_html_ae08f1955abf4f7b5ca00ec1fec76041f"><div class="ttname"><a href="classModel.html#ae08f1955abf4f7b5ca00ec1fec76041f">Model\GetConfFile</a></div><div class="ttdeci">GetConfFile($conf, $group)</div><div class="ttdoc">Returns configuration file of the module.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l02568">model.php:2568</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>, <a class="el" href="model_8php_source.html#l02568">GetConfFile()</a>, <a class="el" href="model_8php_source.html#l02581">SetConfig()</a>, and <a class="el" href="model_8php_source.html#l00878">SetNVP()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a4c5f8b05e5cbfffe696da52ce05f066a_cgraph.png" border="0" usemap="#aclassModel_a4c5f8b05e5cbfffe696da52ce05f066a_cgraph" alt=""/></div>
<map name="aclassModel_a4c5f8b05e5cbfffe696da52ce05f066a_cgraph" id="aclassModel_a4c5f8b05e5cbfffe696da52ce05f066a_cgraph">
<area shape="rect" title="Sets the value of NVP configuration." alt="" coords="5,76,115,101"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="309,39,401,64"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="185,27,239,52"/>
<area shape="rect" href="classModel.html#ae08f1955abf4f7b5ca00ec1fec76041f" title="Returns configuration file of the module." alt="" coords="163,76,261,101"/>
<area shape="rect" href="classModel.html#a63e6c944f6d63934ee3f05c24bc3e122" title="Sets configuration file based on config type provided." alt="" coords="170,125,254,151"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="177,175,247,200"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="321,149,389,175"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="319,199,391,224"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="449,199,539,224"/>
</map>
</div>

</div>
</div>
<a id="a859ad1e51288c4d72ed9eda0f6f5e43e" name="a859ad1e51288c4d72ed9eda0f6f5e43e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a859ad1e51288c4d72ed9eda0f6f5e43e">&#9670;&#160;</a></span>SetDefaultLocale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetDefaultLocale </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$locale</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets default locale. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$locale</td><td>Locale. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00646">646</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  647</span>    {</div>
<div class="line"><span class="lineno">  648</span>        global <a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a>, <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a>;</div>
<div class="line"><span class="lineno">  649</span> </div>
<div class="line"><span class="lineno">  650</span>        <span class="comment">// Append semi-colon to new value, this setting is a PHP line</span></div>
<div class="line"><span class="lineno">  651</span>        <span class="keywordflow">return</span> $this-&gt;SetNVP(<a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a> . <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a> . <span class="stringliteral">&#39;/lib/setup.php&#39;</span>, <span class="stringliteral">&#39;\$DefaultLocale&#39;</span>, $locale.<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><span class="lineno">  652</span>    }</div>
<div class="ttc" id="actlr_8php_html_a3c60c4d05948280e2c028ad791e7cc82"><div class="ttname"><a href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a></div><div class="ttdeci">$ROOT</div><div class="ttdef"><b>Definition:</b> <a href="ctlr_8php_source.html#l00031">ctlr.php:31</a></div></div>
<div class="ttc" id="adefs_8php_html_a0ac6c8d143cab83c5d5d10b3bf606f11"><div class="ttname"><a href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a></div><div class="ttdeci">$TEST_DIR_SRC</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00440">defs.php:440</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00031">$ROOT</a>, <a class="el" href="defs_8php_source.html#l00440">$TEST_DIR_SRC</a>, and <a class="el" href="model_8php_source.html#l00878">SetNVP()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a859ad1e51288c4d72ed9eda0f6f5e43e_cgraph.png" border="0" usemap="#aclassModel_a859ad1e51288c4d72ed9eda0f6f5e43e_cgraph" alt=""/></div>
<map name="aclassModel_a859ad1e51288c4d72ed9eda0f6f5e43e_cgraph" id="aclassModel_a859ad1e51288c4d72ed9eda0f6f5e43e_cgraph">
<area shape="rect" title="Sets default locale." alt="" coords="5,55,139,80"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="187,55,257,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="305,5,397,31"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="317,55,385,80"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="315,104,387,129"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="445,104,535,129"/>
</map>
</div>

</div>
</div>
<a id="a396fea6ec5c2ad29ebee26ea36723133" name="a396fea6ec5c2ad29ebee26ea36723133"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a396fea6ec5c2ad29ebee26ea36723133">&#9670;&#160;</a></span>SetForceHTTPs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetForceHTTPs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$bool</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables or disables HTTPs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$bool</td><td>'TRUE' to enable, 'FALSE' otherwise. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00660">660</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  661</span>    {</div>
<div class="line"><span class="lineno">  662</span>        global <a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a>, <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a>;</div>
<div class="line"><span class="lineno">  663</span>        </div>
<div class="line"><span class="lineno">  664</span>        <span class="comment">// Append semi-colon to new value, this setting is a PHP line</span></div>
<div class="line"><span class="lineno">  665</span>        <span class="keywordflow">return</span> $this-&gt;SetNVP(<a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a> . <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a> . <span class="stringliteral">&#39;/lib/setup.php&#39;</span>, <span class="stringliteral">&#39;\$ForceHTTPs&#39;</span>, $bool.<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><span class="lineno">  666</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00031">$ROOT</a>, <a class="el" href="defs_8php_source.html#l00440">$TEST_DIR_SRC</a>, and <a class="el" href="model_8php_source.html#l00878">SetNVP()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a396fea6ec5c2ad29ebee26ea36723133_cgraph.png" border="0" usemap="#aclassModel_a396fea6ec5c2ad29ebee26ea36723133_cgraph" alt=""/></div>
<map name="aclassModel_a396fea6ec5c2ad29ebee26ea36723133_cgraph" id="aclassModel_a396fea6ec5c2ad29ebee26ea36723133_cgraph">
<area shape="rect" title="Enables or disables HTTPs." alt="" coords="5,55,124,80"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="172,55,243,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="291,5,383,31"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="303,55,371,80"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="301,104,373,129"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="431,104,520,129"/>
</map>
</div>

</div>
</div>
<a id="abbf4c282267beb7f8667d0882d82b983" name="abbf4c282267beb7f8667d0882d82b983"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbf4c282267beb7f8667d0882d82b983">&#9670;&#160;</a></span>SetHelpBox()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetHelpBox </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$bool</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables or disables help boxes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$bool</td><td>'TRUE' to enable, 'FALSE' otherwise. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00612">612</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  613</span>    {</div>
<div class="line"><span class="lineno">  614</span>        global <a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a>, <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a>;</div>
<div class="line"><span class="lineno">  615</span>        </div>
<div class="line"><span class="lineno">  616</span>        <span class="comment">// Append semi-colon to new value, this setting is a PHP line</span></div>
<div class="line"><span class="lineno">  617</span>        <span class="keywordflow">return</span> $this-&gt;SetNVP(<a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a> . <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a> . <span class="stringliteral">&#39;/View/lib/setup.php&#39;</span>, <span class="stringliteral">&#39;\$ShowHelpBox&#39;</span>, $bool.<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><span class="lineno">  618</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00031">$ROOT</a>, <a class="el" href="defs_8php_source.html#l00440">$TEST_DIR_SRC</a>, and <a class="el" href="model_8php_source.html#l00878">SetNVP()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_abbf4c282267beb7f8667d0882d82b983_cgraph.png" border="0" usemap="#aclassModel_abbf4c282267beb7f8667d0882d82b983_cgraph" alt=""/></div>
<map name="aclassModel_abbf4c282267beb7f8667d0882d82b983_cgraph" id="aclassModel_abbf4c282267beb7f8667d0882d82b983_cgraph">
<area shape="rect" title="Enables or disables help boxes." alt="" coords="5,55,104,80"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="152,55,223,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="271,5,363,31"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="283,55,351,80"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="281,104,353,129"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="411,104,500,129"/>
</map>
</div>

</div>
</div>
<a id="ace6809a36e1a52e1dde4c9d6d662ca4c" name="ace6809a36e1a52e1dde4c9d6d662ca4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace6809a36e1a52e1dde4c9d6d662ca4c">&#9670;&#160;</a></span>SetLogLevel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetLogLevel </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$level</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets global log level. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$level</td><td>Level to set to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00598">598</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  599</span>    {</div>
<div class="line"><span class="lineno">  600</span>        global <a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a>, <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a>;</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>        <span class="comment">// Append semi-colon to new value, this setting is a PHP line</span></div>
<div class="line"><span class="lineno">  603</span>        <span class="keywordflow">return</span> $this-&gt;SetNVP(<a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a> . <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a> . <span class="stringliteral">&#39;/lib/setup.php&#39;</span>, <span class="stringliteral">&#39;\$LOG_LEVEL&#39;</span>, $level.<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><span class="lineno">  604</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00031">$ROOT</a>, <a class="el" href="defs_8php_source.html#l00440">$TEST_DIR_SRC</a>, and <a class="el" href="model_8php_source.html#l00878">SetNVP()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ace6809a36e1a52e1dde4c9d6d662ca4c_cgraph.png" border="0" usemap="#aclassModel_ace6809a36e1a52e1dde4c9d6d662ca4c_cgraph" alt=""/></div>
<map name="aclassModel_ace6809a36e1a52e1dde4c9d6d662ca4c_cgraph" id="aclassModel_ace6809a36e1a52e1dde4c9d6d662ca4c_cgraph">
<area shape="rect" title="Sets global log level." alt="" coords="5,55,107,80"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="155,55,225,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="273,5,365,31"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="285,55,353,80"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="283,104,355,129"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="413,104,503,129"/>
</map>
</div>

</div>
</div>
<a id="ad3d333424199ea8d1475ffb779b5407c" name="ad3d333424199ea8d1475ffb779b5407c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3d333424199ea8d1475ffb779b5407c">&#9670;&#160;</a></span>SetMaxAnchorNesting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetMaxAnchorNesting </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$max</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the max number of nested anchors allowed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$max</td><td>Number of nested anchors allowed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00688">688</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  689</span>    {</div>
<div class="line"><span class="lineno">  690</span>        global <a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a>, <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a>;</div>
<div class="line"><span class="lineno">  691</span>        </div>
<div class="line"><span class="lineno">  692</span>        <span class="comment">// Append semi-colon to new value, this setting is a PHP line</span></div>
<div class="line"><span class="lineno">  693</span>        <span class="keywordflow">return</span> $this-&gt;SetNVP(<a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a> . <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a> . <span class="stringliteral">&#39;/lib/setup.php&#39;</span>, <span class="stringliteral">&#39;\$MaxAnchorNesting&#39;</span>, $max.<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><span class="lineno">  694</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00031">$ROOT</a>, <a class="el" href="defs_8php_source.html#l00440">$TEST_DIR_SRC</a>, and <a class="el" href="model_8php_source.html#l00878">SetNVP()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ad3d333424199ea8d1475ffb779b5407c_cgraph.png" border="0" usemap="#aclassModel_ad3d333424199ea8d1475ffb779b5407c_cgraph" alt=""/></div>
<map name="aclassModel_ad3d333424199ea8d1475ffb779b5407c_cgraph" id="aclassModel_ad3d333424199ea8d1475ffb779b5407c_cgraph">
<area shape="rect" title="Sets the max number of nested anchors allowed." alt="" coords="5,55,172,80"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="220,55,291,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="339,5,431,31"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="351,55,419,80"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="349,104,421,129"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="479,104,568,129"/>
</map>
</div>

</div>
</div>
<a id="a396a20de76a1a352c40b3eb64d21bce9" name="a396a20de76a1a352c40b3eb64d21bce9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a396a20de76a1a352c40b3eb64d21bce9">&#9670;&#160;</a></span>SetMaxFileSizeToProcess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetMaxFileSizeToProcess </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets max file size to process. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$size</td><td>Max size in MB. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00736">736</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  737</span>    {</div>
<div class="line"><span class="lineno">  738</span>        global <a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a>, <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a>;</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span>        <span class="keywordflow">if</span> ($size &lt; 1) {</div>
<div class="line"><span class="lineno">  741</span>            $size= 1;</div>
<div class="line"><span class="lineno">  742</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($size &gt; 1000) {</div>
<div class="line"><span class="lineno">  743</span>            $size= 1000;</div>
<div class="line"><span class="lineno">  744</span>        }</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>        <span class="comment">// Append semi-colon to new value, this setting is a PHP line</span></div>
<div class="line"><span class="lineno">  747</span>        <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de">SetNVP</a>(<a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a> . <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a> . <span class="stringliteral">&#39;/lib/setup.php&#39;</span>, <span class="stringliteral">&#39;\$MaxFileSizeToProcess&#39;</span>, $size.<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><span class="lineno">  748</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00031">$ROOT</a>, <a class="el" href="defs_8php_source.html#l00440">$TEST_DIR_SRC</a>, and <a class="el" href="model_8php_source.html#l00878">SetNVP()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a396a20de76a1a352c40b3eb64d21bce9_cgraph.png" border="0" usemap="#aclassModel_a396a20de76a1a352c40b3eb64d21bce9_cgraph" alt=""/></div>
<map name="aclassModel_a396a20de76a1a352c40b3eb64d21bce9_cgraph" id="aclassModel_a396a20de76a1a352c40b3eb64d21bce9_cgraph">
<area shape="rect" title="Sets max file size to process." alt="" coords="5,55,191,80"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="239,55,309,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="357,5,449,31"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="369,55,437,80"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="367,104,439,129"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="497,104,587,129"/>
</map>
</div>

</div>
</div>
<a id="a6bd903872ce2d86a25252a84248f2e3f" name="a6bd903872ce2d86a25252a84248f2e3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bd903872ce2d86a25252a84248f2e3f">&#9670;&#160;</a></span>SetNewsyslogConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetNewsyslogConfig </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$when</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets newsyslog configuration for log file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Log file pathname </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$count</td><td>How many archives to keep </td></tr>
    <tr><td class="paramtype"></td><td class="paramname">int/*</td><td>$size Max site to rotate, or don't care </td></tr>
    <tr><td class="paramtype"></td><td class="paramname">int/*</td><td>$when Interval to rotate in hours, or don't care </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l03123">3123</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3124</span>    {</div>
<div class="line"><span class="lineno"> 3125</span>        <span class="keywordflow">if</span> (copy($this-&gt;newSyslogConf, $this-&gt;newSyslogConf.<span class="stringliteral">&#39;.bak&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 3126</span>            <span class="keywordflow">if</span> (($contents= $this-&gt;GetFile($this-&gt;newSyslogConf)) !== FALSE) {</div>
<div class="line"><span class="lineno"> 3127</span>                $re_filepath= <a class="code hl_function" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9">Escape</a>($file, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno"> 3128</span>                $re_owner= <span class="stringliteral">&#39;([\w:]+|)&#39;</span>;</div>
<div class="line"><span class="lineno"> 3129</span>                $re_mode= <span class="stringliteral">&#39;(\d+)&#39;</span>;</div>
<div class="line"><span class="lineno"> 3130</span>                $re_count= <span class="stringliteral">&#39;(\d+)&#39;</span>;</div>
<div class="line"><span class="lineno"> 3131</span>                $re_size= <span class="stringliteral">&#39;(\d+|\*)&#39;</span>;</div>
<div class="line"><span class="lineno"> 3132</span>                $re_when= <span class="stringliteral">&#39;(\d+|\*)&#39;</span>;</div>
<div class="line"><span class="lineno"> 3133</span> </div>
<div class="line"><span class="lineno"> 3134</span>                $re= <span class="stringliteral">&quot;/^(\s*$re_filepath\s+$re_owner\s*$re_mode\s+)$re_count(\s+)$re_size(\s+)$re_when(\s+.*)$/m&quot;</span>;</div>
<div class="line"><span class="lineno"> 3135</span>                $re_replace= <span class="stringliteral">&#39;${1}&#39;</span>.$count.<span class="stringliteral">&#39;${5}&#39;</span>.$size.<span class="stringliteral">&#39;${7}&#39;</span>.$when.<span class="stringliteral">&#39;${9}&#39;</span>;</div>
<div class="line"><span class="lineno"> 3136</span>                <span class="keywordflow">if</span> (($newcontents= preg_replace($re, $re_replace, $contents)) !== FALSE) {</div>
<div class="line"><span class="lineno"> 3137</span>                    $this-&gt;PutFile($this-&gt;newSyslogConf, $newcontents);</div>
<div class="line"><span class="lineno"> 3138</span>                    <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 3139</span>                }</div>
<div class="line"><span class="lineno"> 3140</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3141</span>                    <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Cannot set new value: $file, $count, $size, $when&quot;</span>);</div>
<div class="line"><span class="lineno"> 3142</span>                }</div>
<div class="line"><span class="lineno"> 3143</span>            }</div>
<div class="line"><span class="lineno"> 3144</span>        }</div>
<div class="line"><span class="lineno"> 3145</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3146</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Cannot copy file $this-&gt;newSyslogConf&quot;</span>);</div>
<div class="line"><span class="lineno"> 3147</span>        }</div>
<div class="line"><span class="lineno"> 3148</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 3149</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="lib_2lib_8php_source.html#l00080">Escape()</a>, <a class="el" href="model_8php_source.html#l00822">GetFile()</a>, and <a class="el" href="model_8php_source.html#l00862">PutFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a6bd903872ce2d86a25252a84248f2e3f_cgraph.png" border="0" usemap="#aclassModel_a6bd903872ce2d86a25252a84248f2e3f_cgraph" alt=""/></div>
<map name="aclassModel_a6bd903872ce2d86a25252a84248f2e3f_cgraph" id="aclassModel_a6bd903872ce2d86a25252a84248f2e3f_cgraph">
<area shape="rect" title="Sets newsyslog configuration for log file." alt="" coords="5,80,160,105"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="208,5,300,31"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="220,55,288,80"/>
<area shape="rect" href="classModel.html#a91890c866a00b75b002e6b1016e6b43c" title="Reads file contents." alt="" coords="220,104,288,129"/>
<area shape="rect" href="classModel.html#a24813c8e79a850571607408548a88528" title="Writes contents to file." alt="" coords="221,153,287,179"/>
</map>
</div>

</div>
</div>
<a id="abcd01c30cbd8fa9ac1c84340e5ed33de" name="abcd01c30cbd8fa9ac1c84340e5ed33de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcd01c30cbd8fa9ac1c84340e5ed33de">&#9670;&#160;</a></span>SetNVP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetNVP </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$newvalue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Changes value of NVP. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Config file. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$name</td><td>Name of NVP. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$newvalue</td><td>New value to set. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Backslash should be escaped first, or causes double escapes</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000026">Todo:</a></b></dt><dd>Put strings between single quotes, otherwise PHP conf files complain about certain chars, such as ':' </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00878">878</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  879</span>    {</div>
<div class="line"><span class="lineno">  880</span>        <span class="keywordflow">if</span> (copy($file, $file.<span class="stringliteral">&#39;.bak&#39;</span>)) {</div>
<div class="line"><span class="lineno">  881</span>            <span class="keywordflow">if</span> (($value= $this-&gt;GetNVP($file, $name)) !== FALSE) {</div>
<div class="line"><span class="lineno">  883</span>                $value= <a class="code hl_function" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9">Escape</a>($value, <span class="stringliteral">&#39;\/$^*().-[]&quot;&#39;</span>);</div>
<div class="line"><span class="lineno">  884</span>                $re= <span class="stringliteral">&quot;^(\h*$name\b\h*$this-&gt;NVPS\h*)($value)(\h*$this-&gt;COMC.*|\h*)$&quot;</span>;</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  887</span>                $contents= preg_replace(<span class="stringliteral">&quot;/$re/m&quot;</span>, <span class="stringliteral">&#39;${1}&#39;</span>.$newvalue.<span class="stringliteral">&#39;${3}&#39;</span>, file_get_contents($file), 1, $count);</div>
<div class="line"><span class="lineno">  888</span>                <span class="keywordflow">if</span> ($contents !== NULL &amp;&amp; $count == 1) {</div>
<div class="line"><span class="lineno">  889</span>                    file_put_contents($file, $contents);</div>
<div class="line"><span class="lineno">  890</span>                    <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  891</span>                }</div>
<div class="line"><span class="lineno">  892</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  893</span>                    <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Cannot set new value $file, $name, new: $newvalue, old: $value, re: $re, $count&quot;</span>);</div>
<div class="line"><span class="lineno">  894</span>                }</div>
<div class="line"><span class="lineno">  895</span>            }</div>
<div class="line"><span class="lineno">  896</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  897</span>                <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Cannot find NVP: $file, $name&quot;</span>);</div>
<div class="line"><span class="lineno">  898</span>            }</div>
<div class="line"><span class="lineno">  899</span>        }</div>
<div class="line"><span class="lineno">  900</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  901</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Cannot copy file: $file&quot;</span>);</div>
<div class="line"><span class="lineno">  902</span>        }</div>
<div class="line"><span class="lineno">  903</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  904</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="lib_2lib_8php_source.html#l00080">Escape()</a>, and <a class="el" href="model_8php_source.html#l00915">GetNVP()</a>.</p>

<p class="reference">Referenced by <a class="el" href="Model_2system_8php_source.html#l01700">System\AddFilter()</a>, <a class="el" href="Model_2system_8php_source.html#l01668">System\AddNotifierUser()</a>, <a class="el" href="Model_2system_8php_source.html#l01715">System\DelFilter()</a>, <a class="el" href="Model_2system_8php_source.html#l01684">System\DelNotifierUser()</a>, <a class="el" href="Model_2system_8php_source.html#l01643">System\DisableNotifierSSLVerifyPeer()</a>, <a class="el" href="Model_2system_8php_source.html#l01651">System\EnableNotifierSSLVerifyPeer()</a>, <a class="el" href="model_8php_source.html#l02455">SetConfValue()</a>, <a class="el" href="model_8php_source.html#l00646">SetDefaultLocale()</a>, <a class="el" href="model_8php_source.html#l00660">SetForceHTTPs()</a>, <a class="el" href="model_8php_source.html#l00612">SetHelpBox()</a>, <a class="el" href="Model_2pf_8php_source.html#l00121">Pf\SetIfs()</a>, <a class="el" href="Model_2pf_8php_source.html#l00134">Pf\SetIntnet()</a>, <a class="el" href="dnsmasq_8php_source.html#l00082">Dnsmasq\SetListenOn()</a>, <a class="el" href="model_8php_source.html#l00598">SetLogLevel()</a>, <a class="el" href="model_8php_source.html#l00688">SetMaxAnchorNesting()</a>, <a class="el" href="model_8php_source.html#l00736">SetMaxFileSizeToProcess()</a>, <a class="el" href="Model_2system_8php_source.html#l01838">System\SetMFS()</a>, <a class="el" href="Model_2system_8php_source.html#l01843">System\SetMFSSize()</a>, <a class="el" href="Model_2system_8php_source.html#l01659">System\SetNotifierAPIKey()</a>, <a class="el" href="Model_2system_8php_source.html#l01634">System\SetNotifierHost()</a>, <a class="el" href="Model_2system_8php_source.html#l01743">System\SetNotifierTimeout()</a>, <a class="el" href="Model_2system_8php_source.html#l01626">System\SetNotifyLevel()</a>, <a class="el" href="model_8php_source.html#l00704">SetPfctlTimeout()</a>, <a class="el" href="model_8php_source.html#l00775">SetReloadRate()</a>, <a class="el" href="model_8php_source.html#l00628">SetSessionTimeout()</a>, <a class="el" href="model_8php_source.html#l00718">SetStatusCheckInterval()</a>, <a class="el" href="Model_2system_8php_source.html#l01848">System\SetSyncMFS()</a>, and <a class="el" href="model_8php_source.html#l00674">SetUseSSH()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_abcd01c30cbd8fa9ac1c84340e5ed33de_cgraph.png" border="0" usemap="#aclassModel_abcd01c30cbd8fa9ac1c84340e5ed33de_cgraph" alt=""/></div>
<map name="aclassModel_abcd01c30cbd8fa9ac1c84340e5ed33de_cgraph" id="aclassModel_abcd01c30cbd8fa9ac1c84340e5ed33de_cgraph">
<area shape="rect" title="Changes value of NVP." alt="" coords="5,55,76,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="124,5,216,31"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="136,55,204,80"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="134,104,206,129"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="264,104,353,129"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_abcd01c30cbd8fa9ac1c84340e5ed33de_icgraph.png" border="0" usemap="#aclassModel_abcd01c30cbd8fa9ac1c84340e5ed33de_icgraph" alt=""/></div>
<map name="aclassModel_abcd01c30cbd8fa9ac1c84340e5ed33de_icgraph" id="aclassModel_abcd01c30cbd8fa9ac1c84340e5ed33de_icgraph">
<area shape="rect" title="Changes value of NVP." alt="" coords="496,672,567,697"/>
<area shape="rect" href="classSystem.html#a7c21107fcd868c9590f376c07f02afaf" title=" " alt="" coords="251,5,385,31"/>
<area shape="rect" href="classSystem.html#a91b60c705c31df895a96ff1480ce85db" title=" " alt="" coords="229,55,407,80"/>
<area shape="rect" href="classSystem.html#a6f28b1520f68197fc3089c87d3ee5a86" title=" " alt="" coords="253,104,383,129"/>
<area shape="rect" href="classSystem.html#a77b569ce1603eae5f71e4f90e9e5c3a0" title=" " alt="" coords="231,153,405,179"/>
<area shape="rect" href="classSystem.html#a84af1d367e28f412bc9a7e07464defc6" title=" " alt="" coords="188,203,448,228"/>
<area shape="rect" href="classSystem.html#a896e4c34afa76bb1359be66b348597f6" title=" " alt="" coords="191,252,445,277"/>
<area shape="rect" href="classModel.html#a4c5f8b05e5cbfffe696da52ce05f066a" title="Sets the value of NVP configuration." alt="" coords="263,301,373,327"/>
<area shape="rect" href="classModel.html#a859ad1e51288c4d72ed9eda0f6f5e43e" title="Sets default locale." alt="" coords="251,351,385,376"/>
<area shape="rect" href="classModel.html#a396fea6ec5c2ad29ebee26ea36723133" title="Enables or disables HTTPs." alt="" coords="259,400,377,425"/>
<area shape="rect" href="classModel.html#abbf4c282267beb7f8667d0882d82b983" title="Enables or disables help boxes." alt="" coords="269,449,367,475"/>
<area shape="rect" href="classPf.html#a8a838a5a93147d20d19f2f4c44a16b23" title="Sets interface names in pf.conf." alt="" coords="280,499,356,524"/>
<area shape="rect" href="classPf.html#ae936293c9b2b0d90849d2c17acc1e6e8" title="Sets int_net." alt="" coords="269,548,367,573"/>
<area shape="rect" href="classDnsmasq.html#aafd6db1bc365b4992ffdc2894821194f" title="Sets the interface that the DNS forwarder binds to listen for requests." alt="" coords="235,597,401,623"/>
<area shape="rect" href="classModel.html#ace6809a36e1a52e1dde4c9d6d662ca4c" title="Sets global log level." alt="" coords="267,647,369,672"/>
<area shape="rect" href="classModel.html#ad3d333424199ea8d1475ffb779b5407c" title="Sets the max number of nested anchors allowed." alt="" coords="235,696,401,721"/>
<area shape="rect" href="classModel.html#a396a20de76a1a352c40b3eb64d21bce9" title="Sets max file size to process." alt="" coords="225,745,411,771"/>
<area shape="rect" href="classSystem.html#a59df788be29e03ef99af4f3a16fdb1a0" title=" " alt="" coords="257,795,379,820"/>
<area shape="rect" href="classSystem.html#af6fa08d72148c73798549ca54163b619" title=" " alt="" coords="243,844,393,869"/>
<area shape="rect" href="classSystem.html#ae08f689f2d21a3414d7f1f667a0d5350" title=" " alt="" coords="223,893,413,919"/>
<area shape="rect" href="classSystem.html#ac188e028fb53e14e566562ae2e805f09" title=" " alt="" coords="231,943,405,968"/>
<area shape="rect" href="classSystem.html#a43705d78ea353c6e76f34342df25ea58" title=" " alt="" coords="219,992,417,1017"/>
<area shape="rect" href="classSystem.html#a3ad0b53500536d14f25a7d95f819a977" title=" " alt="" coords="233,1041,403,1067"/>
<area shape="rect" href="classModel.html#a2b4ff4a876f224dcd90e3d5cb3e288a4" title="Sets pfctl timeout." alt="" coords="255,1091,381,1116"/>
<area shape="rect" href="classModel.html#add75f616f424040c62005634d34c20b0" title="Sets default reload rate." alt="" coords="259,1140,377,1165"/>
<area shape="rect" href="classModel.html#a3070438f6bedf2aeeeb313d7c32e5e1e" title="Sets session timeout." alt="" coords="245,1189,391,1215"/>
<area shape="rect" href="classModel.html#a31cfb3981a2789a48b91e3b2ea325681" title="Sets status check interval." alt="" coords="231,1239,405,1264"/>
<area shape="rect" href="classSystem.html#ad6ebf17ff7b76e126f2c94d29bde51d4" title=" " alt="" coords="241,1288,395,1313"/>
<area shape="rect" href="classModel.html#a760367a76e1eae0a8e8e7bc6c9e0579e" title="Enables or disables SSH." alt="" coords="271,1337,365,1363"/>
<area shape="rect" href="classModel.html#a5cf12375d05dca29b3c81333ff1882a2" title="Gets service statuses." alt="" coords="5,1239,140,1264"/>
</map>
</div>

</div>
</div>
<a id="a356c4619bee6a35594a2ee7ecb7f9d2d" name="a356c4619bee6a35594a2ee7ecb7f9d2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a356c4619bee6a35594a2ee7ecb7f9d2d">&#9670;&#160;</a></span>SetPassword()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetPassword </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$passwd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets user's password in the system password file. </p>
<p>Note that passwords are double encrypted.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$user</td><td>User name. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$passwd</td><td>SHA encrypted password. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00571">571</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  572</span>    {</div>
<div class="line"><span class="lineno">  573</span>        exec(<span class="stringliteral">&quot;/bin/cat /etc/master.passwd | /usr/bin/grep -E &#39;^$user:&#39; 2&gt;&amp;1&quot;</span>, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno">  574</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno">  575</span>            $line= $output[0];</div>
<div class="line"><span class="lineno">  576</span>            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&quot;/^$user:[^:]+(:.+)$/&quot;</span>, $line, $match)) {</div>
<div class="line"><span class="lineno">  577</span>                unset($output);</div>
<div class="line"><span class="lineno">  578</span>                $cmdline= <span class="stringliteral">&#39;/usr/bin/chpass -a &quot;&#39;</span> . $user . <span class="stringliteral">&#39;:$(/usr/bin/encrypt &#39;</span> . $passwd . <span class="charliteral">&#39;)&#39;</span> . $match[1] . <span class="charliteral">&#39;&quot;&#39;</span>;</div>
<div class="line"><span class="lineno">  579</span>                exec($cmdline, $output, <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>);</div>
<div class="line"><span class="lineno">  580</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === 0) {</div>
<div class="line"><span class="lineno">  581</span>                    <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  582</span>                }</div>
<div class="line"><span class="lineno">  583</span>            }</div>
<div class="line"><span class="lineno">  584</span>        }</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>        $errout= implode(<span class="stringliteral">&quot;\n&quot;</span>, $output);</div>
<div class="line"><span class="lineno">  587</span>        <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>($errout);</div>
<div class="line"><span class="lineno">  588</span>        <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Set password failed: $errout&quot;</span>);</div>
<div class="line"><span class="lineno">  589</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  590</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, and <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a356c4619bee6a35594a2ee7ecb7f9d2d_cgraph.png" border="0" usemap="#aclassModel_a356c4619bee6a35594a2ee7ecb7f9d2d_cgraph" alt=""/></div>
<map name="aclassModel_a356c4619bee6a35594a2ee7ecb7f9d2d_cgraph" id="aclassModel_a356c4619bee6a35594a2ee7ecb7f9d2d_cgraph">
<area shape="rect" title="Sets user&#39;s password in the system password file." alt="" coords="5,31,109,56"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="157,5,249,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="177,55,230,80"/>
</map>
</div>

</div>
</div>
<a id="a2b4ff4a876f224dcd90e3d5cb3e288a4" name="a2b4ff4a876f224dcd90e3d5cb3e288a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b4ff4a876f224dcd90e3d5cb3e288a4">&#9670;&#160;</a></span>SetPfctlTimeout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetPfctlTimeout </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$timeout</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets pfctl timeout. </p>
<p>Note that setting this value to 0 effectively fails all pfctl calls.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$timeout</td><td><a class="el" href="classModel_1_1Timeout.html">Timeout</a> waiting pfctl output in seconds. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00704">704</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  705</span>    {</div>
<div class="line"><span class="lineno">  706</span>        global <a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a>, <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a>;</div>
<div class="line"><span class="lineno">  707</span>        </div>
<div class="line"><span class="lineno">  708</span>        <span class="comment">// Append semi-colon to new value, this setting is a PHP line</span></div>
<div class="line"><span class="lineno">  709</span>        <span class="keywordflow">return</span> $this-&gt;SetNVP(<a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a> . <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a> . <span class="stringliteral">&#39;/lib/setup.php&#39;</span>, <span class="stringliteral">&#39;\$PfctlTimeout&#39;</span>, $timeout.<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><span class="lineno">  710</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00031">$ROOT</a>, <a class="el" href="defs_8php_source.html#l00440">$TEST_DIR_SRC</a>, and <a class="el" href="model_8php_source.html#l00878">SetNVP()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a2b4ff4a876f224dcd90e3d5cb3e288a4_cgraph.png" border="0" usemap="#aclassModel_a2b4ff4a876f224dcd90e3d5cb3e288a4_cgraph" alt=""/></div>
<map name="aclassModel_a2b4ff4a876f224dcd90e3d5cb3e288a4_cgraph" id="aclassModel_a2b4ff4a876f224dcd90e3d5cb3e288a4_cgraph">
<area shape="rect" title="Sets pfctl timeout." alt="" coords="5,55,132,80"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="180,55,251,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="299,5,391,31"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="311,55,379,80"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="309,104,381,129"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="439,104,528,129"/>
</map>
</div>

</div>
</div>
<a id="add75f616f424040c62005634d34c20b0" name="add75f616f424040c62005634d34c20b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add75f616f424040c62005634d34c20b0">&#9670;&#160;</a></span>SetReloadRate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetReloadRate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$rate</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets default reload rate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$rate</td><td>Reload rate in seconds. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00775">775</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  776</span>    {</div>
<div class="line"><span class="lineno">  777</span>        global <a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a>, <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a>;</div>
<div class="line"><span class="lineno">  778</span>        </div>
<div class="line"><span class="lineno">  779</span>        <span class="comment">// Append semi-colon to new value, this setting is a PHP line</span></div>
<div class="line"><span class="lineno">  780</span>        <span class="keywordflow">return</span> $this-&gt;SetNVP(<a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a> . <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a> . <span class="stringliteral">&#39;/View/lib/setup.php&#39;</span>, <span class="stringliteral">&#39;\$DefaultReloadRate&#39;</span>, $rate.<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><span class="lineno">  781</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00031">$ROOT</a>, <a class="el" href="defs_8php_source.html#l00440">$TEST_DIR_SRC</a>, and <a class="el" href="model_8php_source.html#l00878">SetNVP()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_add75f616f424040c62005634d34c20b0_cgraph.png" border="0" usemap="#aclassModel_add75f616f424040c62005634d34c20b0_cgraph" alt=""/></div>
<map name="aclassModel_add75f616f424040c62005634d34c20b0_cgraph" id="aclassModel_add75f616f424040c62005634d34c20b0_cgraph">
<area shape="rect" title="Sets default reload rate." alt="" coords="5,55,124,80"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="172,55,243,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="291,5,383,31"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="303,55,371,80"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="301,104,373,129"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="431,104,520,129"/>
</map>
</div>

</div>
</div>
<a id="a3070438f6bedf2aeeeb313d7c32e5e1e" name="a3070438f6bedf2aeeeb313d7c32e5e1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3070438f6bedf2aeeeb313d7c32e5e1e">&#9670;&#160;</a></span>SetSessionTimeout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetSessionTimeout </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$timeout</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets session timeout. </p>
<p>If the given values is less than 10, we set the timeout to 10 seconds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$timeout</td><td><a class="el" href="classModel_1_1Timeout.html">Timeout</a> in seconds. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00628">628</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  629</span>    {</div>
<div class="line"><span class="lineno">  630</span>        global <a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a>, <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a>;</div>
<div class="line"><span class="lineno">  631</span> </div>
<div class="line"><span class="lineno">  632</span>        <span class="keywordflow">if</span> ($timeout &lt; 10) {</div>
<div class="line"><span class="lineno">  633</span>            $timeout= 10;</div>
<div class="line"><span class="lineno">  634</span>        }</div>
<div class="line"><span class="lineno">  635</span>        </div>
<div class="line"><span class="lineno">  636</span>        <span class="comment">// Append semi-colon to new value, this setting is a PHP line</span></div>
<div class="line"><span class="lineno">  637</span>        <span class="keywordflow">return</span> $this-&gt;SetNVP(<a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a> . <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a> . <span class="stringliteral">&#39;/View/lib/setup.php&#39;</span>, <span class="stringliteral">&#39;\$SessionTimeout&#39;</span>, $timeout.<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><span class="lineno">  638</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00031">$ROOT</a>, <a class="el" href="defs_8php_source.html#l00440">$TEST_DIR_SRC</a>, and <a class="el" href="model_8php_source.html#l00878">SetNVP()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a3070438f6bedf2aeeeb313d7c32e5e1e_cgraph.png" border="0" usemap="#aclassModel_a3070438f6bedf2aeeeb313d7c32e5e1e_cgraph" alt=""/></div>
<map name="aclassModel_a3070438f6bedf2aeeeb313d7c32e5e1e_cgraph" id="aclassModel_a3070438f6bedf2aeeeb313d7c32e5e1e_cgraph">
<area shape="rect" title="Sets session timeout." alt="" coords="5,55,152,80"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="200,55,271,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="319,5,411,31"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="331,55,399,80"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="329,104,401,129"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="459,104,548,129"/>
</map>
</div>

</div>
</div>
<a id="a31cfb3981a2789a48b91e3b2ea325681" name="a31cfb3981a2789a48b91e3b2ea325681"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31cfb3981a2789a48b91e3b2ea325681">&#9670;&#160;</a></span>SetStatusCheckInterval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetStatusCheckInterval </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$interval</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets status check interval. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$interval</td><td>Interval to check module statuses. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00718">718</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  719</span>    {</div>
<div class="line"><span class="lineno">  720</span>        global <a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a>, <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a>;</div>
<div class="line"><span class="lineno">  721</span>        </div>
<div class="line"><span class="lineno">  722</span>        <span class="keywordflow">if</span> ($interval &lt; 10) {</div>
<div class="line"><span class="lineno">  723</span>            $interval= 10;</div>
<div class="line"><span class="lineno">  724</span>        }</div>
<div class="line"><span class="lineno">  725</span>        </div>
<div class="line"><span class="lineno">  726</span>        <span class="comment">// Append semi-colon to new value, this setting is a PHP line</span></div>
<div class="line"><span class="lineno">  727</span>        <span class="keywordflow">return</span> $this-&gt;SetNVP(<a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a> . <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a> . <span class="stringliteral">&#39;/lib/setup.php&#39;</span>, <span class="stringliteral">&#39;\$StatusCheckInterval&#39;</span>, $interval.<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><span class="lineno">  728</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00031">$ROOT</a>, <a class="el" href="defs_8php_source.html#l00440">$TEST_DIR_SRC</a>, and <a class="el" href="model_8php_source.html#l00878">SetNVP()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02683">GetServiceStatus()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a31cfb3981a2789a48b91e3b2ea325681_cgraph.png" border="0" usemap="#aclassModel_a31cfb3981a2789a48b91e3b2ea325681_cgraph" alt=""/></div>
<map name="aclassModel_a31cfb3981a2789a48b91e3b2ea325681_cgraph" id="aclassModel_a31cfb3981a2789a48b91e3b2ea325681_cgraph">
<area shape="rect" title="Sets status check interval." alt="" coords="5,55,180,80"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="228,55,299,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="347,5,439,31"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="359,55,427,80"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="357,104,429,129"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="487,104,576,129"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a31cfb3981a2789a48b91e3b2ea325681_icgraph.png" border="0" usemap="#aclassModel_a31cfb3981a2789a48b91e3b2ea325681_icgraph" alt=""/></div>
<map name="aclassModel_a31cfb3981a2789a48b91e3b2ea325681_icgraph" id="aclassModel_a31cfb3981a2789a48b91e3b2ea325681_icgraph">
<area shape="rect" title="Sets status check interval." alt="" coords="188,5,363,31"/>
<area shape="rect" href="classModel.html#a5cf12375d05dca29b3c81333ff1882a2" title="Gets service statuses." alt="" coords="5,5,140,31"/>
</map>
</div>

</div>
</div>
<a id="a760367a76e1eae0a8e8e7bc6c9e0579e" name="a760367a76e1eae0a8e8e7bc6c9e0579e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a760367a76e1eae0a8e8e7bc6c9e0579e">&#9670;&#160;</a></span>SetUseSSH()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SetUseSSH </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$bool</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables or disables SSH. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$bool</td><td>'TRUE' to enable, 'FALSE' otherwise. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00674">674</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  675</span>    {</div>
<div class="line"><span class="lineno">  676</span>        global <a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a>, <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a>;</div>
<div class="line"><span class="lineno">  677</span>        </div>
<div class="line"><span class="lineno">  678</span>        <span class="comment">// Append semi-colon to new value, this setting is a PHP line</span></div>
<div class="line"><span class="lineno">  679</span>        <span class="keywordflow">return</span> $this-&gt;SetNVP(<a class="code hl_variable" href="ctlr_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a> . <a class="code hl_variable" href="defs_8php.html#a0ac6c8d143cab83c5d5d10b3bf606f11">$TEST_DIR_SRC</a> . <span class="stringliteral">&#39;/View/lib/setup.php&#39;</span>, <span class="stringliteral">&#39;\$UseSSH&#39;</span>, $bool.<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><span class="lineno">  680</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00031">$ROOT</a>, <a class="el" href="defs_8php_source.html#l00440">$TEST_DIR_SRC</a>, and <a class="el" href="model_8php_source.html#l00878">SetNVP()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a760367a76e1eae0a8e8e7bc6c9e0579e_cgraph.png" border="0" usemap="#aclassModel_a760367a76e1eae0a8e8e7bc6c9e0579e_cgraph" alt=""/></div>
<map name="aclassModel_a760367a76e1eae0a8e8e7bc6c9e0579e_cgraph" id="aclassModel_a760367a76e1eae0a8e8e7bc6c9e0579e_cgraph">
<area shape="rect" title="Enables or disables SSH." alt="" coords="5,55,100,80"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="148,55,219,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="267,5,359,31"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="279,55,347,80"/>
<area shape="rect" href="classModel.html#a8f197a5f9e014dc06404352d2f4b7e20" title="Reads value of NVP." alt="" coords="277,104,349,129"/>
<area shape="rect" href="classModel.html#a151a013af243c2c1255caf53dffadc9b" title="Searches the given file with the given regex." alt="" coords="407,104,496,129"/>
</map>
</div>

</div>
</div>
<a id="a58a42cd2dbcf0483f1da759a8d283d58" name="a58a42cd2dbcf0483f1da759a8d283d58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58a42cd2dbcf0483f1da759a8d283d58">&#9670;&#160;</a></span>Start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start module process(es). </p>
<p>Waits PROC_STAT_TIMEOUT times.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000021">Todo:</a></b></dt><dd>Actually should stop retrying on error?</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000022">Todo:</a></b></dt><dd>Check $TmpFile for error messages, if so break out instead </dd></dl>

<p>Reimplemented in <a class="el" href="classDhcpd.html#a58a42cd2dbcf0483f1da759a8d283d58">Dhcpd</a>, and <a class="el" href="classPf.html#a58a42cd2dbcf0483f1da759a8d283d58">Pf</a>.</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00415">415</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  416</span>    {</div>
<div class="line"><span class="lineno">  417</span>        global <a class="code hl_variable" href="Controller_2lib_8php.html#a934f13a80ef6f9bc5b5f861e6746792c">$TmpFile</a>, <a class="code hl_variable" href="Controller_2lib_8php.html#ad1cf49d749aa2c1b8e2e53b5b95357e6">$RetvalFile</a>;</div>
<div class="line"><span class="lineno">  418</span>        </div>
<div class="line"><span class="lineno">  419</span>        exec($this-&gt;StartCmd.<span class="stringliteral">&quot; &gt; $TmpFile 2&gt;&amp;1 &amp;&amp; echo -n &#39;0&#39; &gt; $RetvalFile || echo -n &#39;1&#39; &gt; $RetvalFile &amp;&quot;</span>, $output);</div>
<div class="line"><span class="lineno">  420</span>        <a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a>= file_get_contents(<a class="code hl_variable" href="Controller_2lib_8php.html#ad1cf49d749aa2c1b8e2e53b5b95357e6">$RetvalFile</a>);</div>
<div class="line"><span class="lineno">  421</span>        </div>
<div class="line"><span class="lineno">  422</span>        $running= FALSE;</div>
<div class="line"><span class="lineno">  423</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a80b96347dc2ad0d4e3748dc87db72731">$retval</a> === <span class="charliteral">&#39;0&#39;</span>) {</div>
<div class="line"><span class="lineno">  424</span>            $count= 0;</div>
<div class="line"><span class="lineno">  425</span>            <span class="keywordflow">while</span> (!($running= $this-&gt;IsRunning()) &amp;&amp; $count++ &lt; self::PROC_STAT_TIMEOUT) {</div>
<div class="line"><span class="lineno">  427</span>                exec(<span class="stringliteral">&#39;/bin/sleep &#39;</span> . self::PROC_STAT_SLEEP_TIME);</div>
<div class="line"><span class="lineno">  428</span>            }</div>
<div class="line"><span class="lineno">  429</span>        }</div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span>        <span class="comment">// Start command is redirected to tmp file, report its contents, success or failure</span></div>
<div class="line"><span class="lineno">  432</span>        $output= file_get_contents(<a class="code hl_variable" href="Controller_2lib_8php.html#a934f13a80ef6f9bc5b5f861e6746792c">$TmpFile</a>);</div>
<div class="line"><span class="lineno">  433</span>        <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>($output);</div>
<div class="line"><span class="lineno">  434</span>        <span class="keywordflow">if</span> (!$running) {</div>
<div class="line"><span class="lineno">  435</span>            <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Start failed with: $output&quot;</span>);</div>
<div class="line"><span class="lineno">  436</span>        }</div>
<div class="line"><span class="lineno">  437</span>        <span class="keywordflow">return</span> $running;</div>
<div class="line"><span class="lineno">  438</span>    }</div>
<div class="ttc" id="aController_2lib_8php_html_ad1cf49d749aa2c1b8e2e53b5b95357e6"><div class="ttname"><a href="Controller_2lib_8php.html#ad1cf49d749aa2c1b8e2e53b5b95357e6">$RetvalFile</a></div><div class="ttdeci">$RetvalFile</div><div class="ttdoc">Return value redirect file.</div><div class="ttdef"><b>Definition:</b> <a href="Controller_2lib_8php_source.html#l00029">lib.php:29</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00072">$retval</a>, <a class="el" href="Controller_2lib_8php_source.html#l00029">$RetvalFile</a>, <a class="el" href="Controller_2lib_8php_source.html#l00026">$TmpFile</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>, and <a class="el" href="model_8php_source.html#l00332">IsRunning()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a58a42cd2dbcf0483f1da759a8d283d58_cgraph.png" border="0" usemap="#aclassModel_a58a42cd2dbcf0483f1da759a8d283d58_cgraph" alt=""/></div>
<map name="aclassModel_a58a42cd2dbcf0483f1da759a8d283d58_cgraph" id="aclassModel_a58a42cd2dbcf0483f1da759a8d283d58_cgraph">
<area shape="rect" title="Start module process(es)." alt="" coords="5,55,59,80"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="259,5,351,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="278,104,331,129"/>
<area shape="rect" href="classModel.html#a73fbf3721e73a688382663bf84e1e428" title="Checks if the given process(es) is running." alt="" coords="107,55,193,80"/>
<area shape="rect" href="classModel.html#aead9ffea53f83ba54a7bc722dbc81841" title="Selects user processes from ps output." alt="" coords="241,55,368,80"/>
</map>
</div>

</div>
</div>
<a id="a0f17de803b9ad897ee1e879e90982bd2" name="a0f17de803b9ad897ee1e879e90982bd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f17de803b9ad897ee1e879e90982bd2">&#9670;&#160;</a></span>Stop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stops module process(es) </p>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p>Reimplemented in <a class="el" href="classCollectd.html#a0f17de803b9ad897ee1e879e90982bd2">Collectd</a>, and <a class="el" href="classPf.html#a0f17de803b9ad897ee1e879e90982bd2">Pf</a>.</p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00445">445</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  446</span>    {</div>
<div class="line"><span class="lineno">  447</span>        <span class="keywordflow">return</span> $this-&gt;Pkill($this-&gt;Proc);</div>
<div class="line"><span class="lineno">  448</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l00462">Pkill()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a0f17de803b9ad897ee1e879e90982bd2_cgraph.png" border="0" usemap="#aclassModel_a0f17de803b9ad897ee1e879e90982bd2_cgraph" alt=""/></div>
<map name="aclassModel_a0f17de803b9ad897ee1e879e90982bd2_cgraph" id="aclassModel_a0f17de803b9ad897ee1e879e90982bd2_cgraph">
<area shape="rect" title="Stops module process(es)" alt="" coords="5,80,56,105"/>
<area shape="rect" href="classModel.html#a4a41a34d3378ee890958973fce464aa8" title="Kills the given process(es)." alt="" coords="104,80,155,105"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="415,5,507,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="434,104,487,129"/>
<area shape="rect" href="classModel.html#a73fbf3721e73a688382663bf84e1e428" title="Checks if the given process(es) is running." alt="" coords="233,55,319,80"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="203,156,349,181"/>
<area shape="rect" href="classModel.html#aead9ffea53f83ba54a7bc722dbc81841" title="Selects user processes from ps output." alt="" coords="397,55,524,80"/>
</map>
</div>

</div>
</div>
<a id="a4b2587fd477dfc21d60f1185c624521c" name="a4b2587fd477dfc21d60f1185c624521c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b2587fd477dfc21d60f1185c624521c">&#9670;&#160;</a></span>UpdateStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UpdateStats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$briefstats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates statistics incrementally, both brief and full. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$logfile</td><td>Log file pathname. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$stats</td><td>Full stats. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$briefstats</td><td>Brief stats. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01919">1919</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1920</span>    {</div>
<div class="line"><span class="lineno"> 1921</span>        global <a class="code hl_variable" href="defs_8php.html#acaae7b246b0fd77ae6400fa4868a593b">$StatsConf</a>;</div>
<div class="line"><span class="lineno"> 1922</span> </div>
<div class="line"><span class="lineno"> 1923</span>        $stats= array();</div>
<div class="line"><span class="lineno"> 1924</span>        $briefstats= array();</div>
<div class="line"><span class="lineno"> 1925</span>        $linecount= 0;</div>
<div class="line"><span class="lineno"> 1926</span> </div>
<div class="line"><span class="lineno"> 1927</span>        <span class="keywordflow">if</span> (isset(<a class="code hl_variable" href="defs_8php.html#acaae7b246b0fd77ae6400fa4868a593b">$StatsConf</a>[$this-&gt;Name])) {</div>
<div class="line"><span class="lineno"> 1928</span>            $statsdefs= <a class="code hl_variable" href="defs_8php.html#acaae7b246b0fd77ae6400fa4868a593b">$StatsConf</a>[$this-&gt;Name];</div>
<div class="line"><span class="lineno"> 1929</span> </div>
<div class="line"><span class="lineno"> 1930</span>            $needle= <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1931</span>            <span class="keywordflow">if</span> (isset($statsdefs[<span class="stringliteral">&#39;Total&#39;</span>][<span class="stringliteral">&#39;Needle&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1932</span>                $needle= $statsdefs[<span class="stringliteral">&#39;Total&#39;</span>][<span class="stringliteral">&#39;Needle&#39;</span>];</div>
<div class="line"><span class="lineno"> 1933</span>            }</div>
<div class="line"><span class="lineno"> 1934</span> </div>
<div class="line"><span class="lineno"> 1935</span>            <span class="comment">// Line count should be obtained here, see SaveStats() for explanation</span></div>
<div class="line"><span class="lineno"> 1936</span>            $linecount= $this-&gt;_getFileLineCount($logfile, $needle);</div>
<div class="line"><span class="lineno"> 1937</span> </div>
<div class="line"><span class="lineno"> 1938</span>            <span class="keywordflow">if</span> ($this-&gt;CountDiffLogLines($logfile, $tail)) {</div>
<div class="line"><span class="lineno"> 1939</span>                $this-&gt;GetSavedStats($logfile, $stats, $briefstats);</div>
<div class="line"><span class="lineno"> 1940</span>            }</div>
<div class="line"><span class="lineno"> 1941</span> </div>
<div class="line"><span class="lineno"> 1942</span>            $lines= $this-&gt;<a class="code hl_function" href="classModel.html#ad26e67d9a70c2182a67b939ae61b6d01">GetStatsLogLines</a>($logfile, $tail);</div>
<div class="line"><span class="lineno"> 1943</span>            <span class="keywordflow">if</span> ($lines === FALSE) {</div>
<div class="line"><span class="lineno"> 1944</span>                <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1945</span>            }</div>
<div class="line"><span class="lineno"> 1946</span> </div>
<div class="line"><span class="lineno"> 1947</span>            <span class="keywordflow">if</span> ($lines !== <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1948</span>                $lines= explode(<span class="stringliteral">&quot;\n&quot;</span>, $lines);</div>
<div class="line"><span class="lineno"> 1949</span> </div>
<div class="line"><span class="lineno"> 1950</span>                <span class="keywordflow">foreach</span> ($lines as $line) {</div>
<div class="line"><span class="lineno"> 1951</span>                    unset($values);</div>
<div class="line"><span class="lineno"> 1952</span>                    <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb">ParseLogLine</a>($line, $values)) {</div>
<div class="line"><span class="lineno"> 1953</span>                        <span class="comment">// Post-processing modifies link and/or datetime values.</span></div>
<div class="line"><span class="lineno"> 1954</span>                        $this-&gt;<a class="code hl_function" href="classModel.html#ae6201c722387cb7120a3447378f73271">PostProcessCols</a>($values);</div>
<div class="line"><span class="lineno"> 1955</span> </div>
<div class="line"><span class="lineno"> 1956</span>                        $this-&gt;<a class="code hl_function" href="classModel.html#ac23e08bf49a305b2d76f11cecc62ba4c">CollectDayStats</a>($statsdefs, $values, $line, $stats);</div>
<div class="line"><span class="lineno"> 1957</span> </div>
<div class="line"><span class="lineno"> 1958</span>                        $briefstatsdefs= $statsdefs[<span class="stringliteral">&#39;Total&#39;</span>][<span class="stringliteral">&#39;BriefStats&#39;</span>];</div>
<div class="line"><span class="lineno"> 1959</span> </div>
<div class="line"><span class="lineno"> 1960</span>                        <span class="keywordflow">if</span> (isset($briefstatsdefs)) {</div>
<div class="line"><span class="lineno"> 1961</span>                            <span class="keywordflow">if</span> (!isset($briefstatsdefs[<span class="stringliteral">&#39;Date&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1962</span>                                <span class="comment">// Always collect Date field</span></div>
<div class="line"><span class="lineno"> 1963</span>                                $briefstatsdefs[<span class="stringliteral">&#39;Date&#39;</span>] = _(<span class="stringliteral">&#39;Requests by date&#39;</span>);</div>
<div class="line"><span class="lineno"> 1964</span>                            }</div>
<div class="line"><span class="lineno"> 1965</span> </div>
<div class="line"><span class="lineno"> 1966</span>                            <span class="comment">// Collect the fields listed under BriefStats</span></div>
<div class="line"><span class="lineno"> 1967</span>                            <span class="keywordflow">foreach</span> ($briefstatsdefs as $name =&gt; $title) {</div>
<div class="line"><span class="lineno"> 1968</span>                                <span class="keywordflow">if</span> (isset($values[$name])) {</div>
<div class="line"><span class="lineno"> 1969</span>                                    <a class="code hl_function" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09">AddValueCreateKey</a>($briefstats[$name], $values[$name], 1);</div>
<div class="line"><span class="lineno"> 1970</span>                                }</div>
<div class="line"><span class="lineno"> 1971</span>                            }</div>
<div class="line"><span class="lineno"> 1972</span>                        }</div>
<div class="line"><span class="lineno"> 1973</span>                    }</div>
<div class="line"><span class="lineno"> 1974</span>                }</div>
<div class="line"><span class="lineno"> 1975</span>            }</div>
<div class="line"><span class="lineno"> 1976</span>        }</div>
<div class="line"><span class="lineno"> 1977</span> </div>
<div class="line"><span class="lineno"> 1978</span>        $this-&gt;<a class="code hl_function" href="classModel.html#ab5448888d58c0402bcc575e3a5cd9e9e">SaveStats</a>($logfile, $stats, $briefstats, $linecount);</div>
<div class="line"><span class="lineno"> 1979</span>    }</div>
<div class="ttc" id="aclassModel_html_ab5448888d58c0402bcc575e3a5cd9e9e"><div class="ttname"><a href="classModel.html#ab5448888d58c0402bcc575e3a5cd9e9e">Model\SaveStats</a></div><div class="ttdeci">SaveStats($logfile, $stats, $briefstats, $linecount)</div><div class="ttdoc">Saves collected statistics with the current line count and stat() output.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l02117">model.php:2117</a></div></div>
<div class="ttc" id="aclassModel_html_ac23e08bf49a305b2d76f11cecc62ba4c"><div class="ttname"><a href="classModel.html#ac23e08bf49a305b2d76f11cecc62ba4c">Model\CollectDayStats</a></div><div class="ttdeci">CollectDayStats($statsdefs, $values, $line, &amp;$stats)</div><div class="ttdoc">Day statistics collector.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l02164">model.php:2164</a></div></div>
<div class="ttc" id="aclassModel_html_ad26e67d9a70c2182a67b939ae61b6d01"><div class="ttname"><a href="classModel.html#ad26e67d9a70c2182a67b939ae61b6d01">Model\GetStatsLogLines</a></div><div class="ttdeci">GetStatsLogLines($logfile, $tail=-1)</div><div class="ttdoc">Builds generic grep command and extracts log lines.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l01704">model.php:1704</a></div></div>
<div class="ttc" id="aclassModel_html_ae6201c722387cb7120a3447378f73271"><div class="ttname"><a href="classModel.html#ae6201c722387cb7120a3447378f73271">Model\PostProcessCols</a></div><div class="ttdeci">PostProcessCols(&amp;$cols)</div><div class="ttdoc">Further processes parser output fields.</div><div class="ttdef"><b>Definition:</b> <a href="model_8php_source.html#l01548">model.php:1548</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="defs_8php_source.html#l00202">$StatsConf</a>, <a class="el" href="model_8php_source.html#l01279">_getFileLineCount()</a>, <a class="el" href="lib_2lib_8php_source.html#l00096">AddValueCreateKey()</a>, <a class="el" href="model_8php_source.html#l02164">CollectDayStats()</a>, <a class="el" href="model_8php_source.html#l01873">CountDiffLogLines()</a>, <a class="el" href="model_8php_source.html#l02033">GetSavedStats()</a>, <a class="el" href="model_8php_source.html#l01704">GetStatsLogLines()</a>, <a class="el" href="model_8php_source.html#l01533">ParseLogLine()</a>, <a class="el" href="model_8php_source.html#l01548">PostProcessCols()</a>, and <a class="el" href="model_8php_source.html#l02117">SaveStats()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01780">_getStats()</a>, and <a class="el" href="model_8php_source.html#l01060">SelectLogFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a4b2587fd477dfc21d60f1185c624521c_cgraph.png" border="0" usemap="#aclassModel_a4b2587fd477dfc21d60f1185c624521c_cgraph" alt=""/></div>
<map name="aclassModel_a4b2587fd477dfc21d60f1185c624521c_cgraph" id="aclassModel_a4b2587fd477dfc21d60f1185c624521c_cgraph">
<area shape="rect" title="Updates statistics incrementally, both brief and full." alt="" coords="5,408,108,433"/>
<area shape="rect" href="classModel.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="344,55,483,80"/>
<area shape="rect" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09" title=" " alt="" coords="756,509,907,535"/>
<area shape="rect" href="classModel.html#ac23e08bf49a305b2d76f11cecc62ba4c" title="Day statistics collector." alt="" coords="163,459,289,484"/>
<area shape="rect" href="classModel.html#ab1e8cbbabce3210438cebad028f153d7" title="Gets the number of lines added to log files since last tmp file update." alt="" coords="156,205,296,231"/>
<area shape="rect" href="classModel.html#a1149c6f5338677a1a74e8a4964826e80" title="Gets saved statistics for the given log file." alt="" coords="354,357,473,383"/>
<area shape="rect" href="classModel.html#ad26e67d9a70c2182a67b939ae61b6d01" title="Builds generic grep command and extracts log lines." alt="" coords="346,104,481,129"/>
<area shape="rect" href="classModel.html#ad8dbb64d308bdf8cbe3dfee2c84fb9bb" title="Parses the given log line." alt="" coords="173,611,279,636"/>
<area shape="rect" href="classModel.html#ae6201c722387cb7120a3447378f73271" title="Further processes parser output fields." alt="" coords="162,660,290,685"/>
<area shape="rect" href="classModel.html#ab5448888d58c0402bcc575e3a5cd9e9e" title="Saves collected statistics with the current line count and stat() output." alt="" coords="370,407,457,432"/>
<area shape="rect" href="classModel.html#a3827d539c75623fd5345ab590caaa2cb" title="Generates the module specific datetime regexp for filtering logs." alt="" coords="531,5,708,31"/>
<area shape="rect" href="classModel.html#a9b098af2c181aba08669ccbc185af5d8" title="Runs the given shell command and returns its output as string." alt="" coords="546,104,693,129"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="570,55,669,80"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="955,55,1008,80"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="763,80,900,105"/>
<area shape="rect" href="classModel.html#abe3e76f34ef7907cc5fcc6d2840bf081" title="Hour statistics collector." alt="" coords="348,459,479,484"/>
<area shape="rect" href="classModel.html#a10ffb35c34bab2bd539a5a945a489625" title="Increments stats for the given values." alt="" coords="582,509,657,535"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="573,211,665,236"/>
<area shape="rect" href="classModel.html#a3b4ab5022e1e5883d5292c024eaaf8c1" title="Minute statistics collector." alt="" coords="547,460,692,485"/>
<area shape="rect" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7" title="Gets the original file name for the given log file." alt="" coords="764,260,899,285"/>
<area shape="rect" href="classModel.html#a2ef1e4c1d1fadd3c6696a101cd2aa7e5" title="Gets previous line count and stat() from statistics file." alt="" coords="350,205,477,231"/>
<area shape="rect" href="classModel.html#ae24c34977ae6864272b678fe40fdb09a" title="Gets name of the tmp statistics file for the given log file." alt="" coords="549,260,689,285"/>
<area shape="rect" href="classModel.html#a91890c866a00b75b002e6b1016e6b43c" title="Reads file contents." alt="" coords="585,309,653,335"/>
<area shape="rect" href="classModel.html#af4eb638f282def52a768efc7dbcbc698" title="Parses standard syslog line." alt="" coords="350,611,477,636"/>
<area shape="rect" href="classModel.html#a24813c8e79a850571607408548a88528" title="Writes contents to file." alt="" coords="586,411,653,436"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_a4b2587fd477dfc21d60f1185c624521c_icgraph.png" border="0" usemap="#aclassModel_a4b2587fd477dfc21d60f1185c624521c_icgraph" alt=""/></div>
<map name="aclassModel_a4b2587fd477dfc21d60f1185c624521c_icgraph" id="aclassModel_a4b2587fd477dfc21d60f1185c624521c_icgraph">
<area shape="rect" title="Updates statistics incrementally, both brief and full." alt="" coords="304,55,407,80"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,29,243,55"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,79,256,104"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="ad4d7aefbd214d3da3f1965e6ddddb998" name="ad4d7aefbd214d3da3f1965e6ddddb998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4d7aefbd214d3da3f1965e6ddddb998">&#9670;&#160;</a></span>UpdateTmpLogFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UpdateTmpLogFile </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies the original log file to tmp folder. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>File pathname. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01144">1144</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1145</span>    {</div>
<div class="line"><span class="lineno"> 1146</span>        $origfile= $this-&gt;GetOrigFileName($file);</div>
<div class="line"><span class="lineno"> 1147</span>        </div>
<div class="line"><span class="lineno"> 1148</span>        <span class="keywordflow">if</span> ($this-&gt;CopyLogFileToTmp($origfile, $this-&gt;TmpLogsDir)) {</div>
<div class="line"><span class="lineno"> 1149</span>            <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 1150</span>        }</div>
<div class="line"><span class="lineno"> 1151</span>        <a class="code hl_function" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe">ctlr_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Copy failed: $file&quot;</span>);</div>
<div class="line"><span class="lineno"> 1152</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1153</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8php_source.html#l01654">CopyLogFileToTmp()</a>, <a class="el" href="Model_2include_8php_source.html#l00194">ctlr_syslog()</a>, and <a class="el" href="model_8php_source.html#l01594">GetOrigFileName()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01780">_getStats()</a>, and <a class="el" href="model_8php_source.html#l01060">SelectLogFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ad4d7aefbd214d3da3f1965e6ddddb998_cgraph.png" border="0" usemap="#aclassModel_ad4d7aefbd214d3da3f1965e6ddddb998_cgraph" alt=""/></div>
<map name="aclassModel_ad4d7aefbd214d3da3f1965e6ddddb998_cgraph" id="aclassModel_ad4d7aefbd214d3da3f1965e6ddddb998_cgraph">
<area shape="rect" title="Copies the original log file to tmp folder." alt="" coords="5,56,149,81"/>
<area shape="rect" href="classModel.html#a5cdc13ae8497b92e1c6cbf8b85c6d43c" title="Uncompresses gzipped log file to tmp dir." alt="" coords="197,56,341,81"/>
<area shape="rect" href="Model_2include_8php.html#aacb56ea458e6602b98977b24fbbb4ebe" title="Wrapper for controller error logging via syslog." alt="" coords="559,5,651,31"/>
<area shape="rect" href="classModel.html#adf44e19a68f4a6be9289e2e39a5698f7" title="Gets the original file name for the given log file." alt="" coords="202,105,337,131"/>
<area shape="rect" href="classModel.html#a620707dcc4093d4ca002e3dfdfa68af1" title="Deletes the given file or directory." alt="" coords="395,56,483,81"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="721,132,775,157"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="389,157,488,183"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="536,208,673,233"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ad4d7aefbd214d3da3f1965e6ddddb998_icgraph.png" border="0" usemap="#aclassModel_ad4d7aefbd214d3da3f1965e6ddddb998_icgraph" alt=""/></div>
<map name="aclassModel_ad4d7aefbd214d3da3f1965e6ddddb998_icgraph" id="aclassModel_ad4d7aefbd214d3da3f1965e6ddddb998_icgraph">
<area shape="rect" title="Copies the original log file to tmp folder." alt="" coords="304,55,448,80"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="161,29,243,55"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="148,79,256,104"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,100,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="afb379dac54166aba28a4e7e22d0fa772" name="afb379dac54166aba28a4e7e22d0fa772"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb379dac54166aba28a4e7e22d0fa772">&#9670;&#160;</a></span>ValidateFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ValidateFile </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$reportFileExistResult</em> = <code>TRUE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>File pathname. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$reportFileExistResult</td><td>Whether to report if file does not exist. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE on success, FALSE on fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01838">1838</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1839</span>    {</div>
<div class="line"><span class="lineno"> 1840</span>        global <a class="code hl_variable" href="lib_2setup_8php.html#a6777d01259af3695f55bea92e5cdf115">$MaxFileSizeToProcess</a>;</div>
<div class="line"><span class="lineno"> 1841</span> </div>
<div class="line"><span class="lineno"> 1842</span>        <span class="keywordflow">if</span> (!$this-&gt;ValidateFileExists($file, $reportFileExistResult)) {</div>
<div class="line"><span class="lineno"> 1843</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1844</span>        }</div>
<div class="line"><span class="lineno"> 1845</span> </div>
<div class="line"><span class="lineno"> 1846</span>        $filestat= stat($file);</div>
<div class="line"><span class="lineno"> 1847</span>        <span class="keywordflow">if</span> ($filestat[<span class="stringliteral">&#39;size&#39;</span>] &gt; <a class="code hl_variable" href="lib_2setup_8php.html#a6777d01259af3695f55bea92e5cdf115">$MaxFileSizeToProcess</a>*1000000) {</div>
<div class="line"><span class="lineno"> 1848</span>            $error_msg= preg_replace(<span class="stringliteral">&#39;/&lt;SIZE&gt;/&#39;</span>, <a class="code hl_variable" href="lib_2setup_8php.html#a6777d01259af3695f55bea92e5cdf115">$MaxFileSizeToProcess</a>, _(<span class="stringliteral">&#39;File too large, will not process files larger than &lt;SIZE&gt; MB&#39;</span>));</div>
<div class="line"><span class="lineno"> 1849</span>            <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>(<span class="stringliteral">&quot;$error_msg: $file = &quot;</span>.$filestat[<span class="stringliteral">&#39;size&#39;</span>]);</div>
<div class="line"><span class="lineno"> 1850</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1851</span>        }</div>
<div class="line"><span class="lineno"> 1852</span>        <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 1853</span>    }</div>
<div class="ttc" id="alib_2setup_8php_html_a6777d01259af3695f55bea92e5cdf115"><div class="ttname"><a href="lib_2setup_8php.html#a6777d01259af3695f55bea92e5cdf115">$MaxFileSizeToProcess</a></div><div class="ttdeci">$MaxFileSizeToProcess</div><div class="ttdoc">Max size in MB for log and statistics files to process.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2setup_8php_source.html#l00044">setup.php:44</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="lib_2setup_8php_source.html#l00044">$MaxFileSizeToProcess</a>, <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>, and <a class="el" href="model_8php_source.html#l01855">ValidateFileExists()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01279">_getFileLineCount()</a>, <a class="el" href="openssh_8php_source.html#l00090">Openssh\_getFileLineCount()</a>, <a class="el" href="Model_2pf_8php_source.html#l00542">Pf\_getFileLineCount()</a>, <a class="el" href="model_8php_source.html#l01407">_getLiveLogs()</a>, <a class="el" href="openssh_8php_source.html#l00154">Openssh\_getLiveLogs()</a>, <a class="el" href="Model_2pf_8php_source.html#l00617">Pf\_getLiveLogs()</a>, <a class="el" href="model_8php_source.html#l01780">_getStats()</a>, <a class="el" href="model_8php_source.html#l01654">CopyLogFileToTmp()</a>, <a class="el" href="model_8php_source.html#l01335">GetLogs()</a>, <a class="el" href="openssh_8php_source.html#l00118">Openssh\GetLogs()</a>, <a class="el" href="Model_2pf_8php_source.html#l00572">Pf\GetLogs()</a>, <a class="el" href="model_8php_source.html#l01613">GetProcStatLines()</a>, <a class="el" href="model_8php_source.html#l01704">GetStatsLogLines()</a>, <a class="el" href="model_8php_source.html#l01557">PrepareFileForDownload()</a>, and <a class="el" href="model_8php_source.html#l01060">SelectLogFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_afb379dac54166aba28a4e7e22d0fa772_cgraph.png" border="0" usemap="#aclassModel_afb379dac54166aba28a4e7e22d0fa772_cgraph" alt=""/></div>
<map name="aclassModel_afb379dac54166aba28a4e7e22d0fa772_cgraph" id="aclassModel_afb379dac54166aba28a4e7e22d0fa772_cgraph">
<area shape="rect" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="5,5,104,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="337,5,391,31"/>
<area shape="rect" href="classModel.html#ab81972f4cb26c1d07ac429589bb4d62d" title=" " alt="" coords="152,31,289,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_afb379dac54166aba28a4e7e22d0fa772_icgraph.png" border="0" usemap="#aclassModel_afb379dac54166aba28a4e7e22d0fa772_icgraph" alt=""/></div>
<map name="aclassModel_afb379dac54166aba28a4e7e22d0fa772_icgraph" id="aclassModel_afb379dac54166aba28a4e7e22d0fa772_icgraph">
<area shape="rect" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="961,425,1060,450"/>
<area shape="rect" href="classModel.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="745,100,883,125"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="174,126,257,152"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="161,201,269,226"/>
<area shape="rect" href="classOpenssh.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="715,326,913,352"/>
<area shape="rect" href="classPf.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="737,376,891,401"/>
<area shape="rect" href="classModel.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="761,425,867,450"/>
<area shape="rect" href="classOpenssh.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="731,474,897,500"/>
<area shape="rect" href="classPf.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="752,524,876,549"/>
<area shape="rect" href="classModel.html#a5cdc13ae8497b92e1c6cbf8b85c6d43c" title="Uncompresses gzipped log file to tmp dir." alt="" coords="523,225,667,250"/>
<area shape="rect" href="classModel.html#a3cd1d5510b23ec577d9d124f9e05a449" title="Gets lines in log file." alt="" coords="777,573,851,598"/>
<area shape="rect" href="classOpenssh.html#a3cd1d5510b23ec577d9d124f9e05a449" title="Gets lines in log file." alt="" coords="747,622,881,648"/>
<area shape="rect" href="classPf.html#a3cd1d5510b23ec577d9d124f9e05a449" title="Gets lines in log file." alt="" coords="768,672,860,697"/>
<area shape="rect" href="classModel.html#a392e2975b79f55e83ed15c7c6ed8725c" title="Collects text statistics for the proc stats general page." alt="" coords="747,721,881,746"/>
<area shape="rect" href="classModel.html#ad26e67d9a70c2182a67b939ae61b6d01" title="Builds generic grep command and extracts log lines." alt="" coords="527,176,662,201"/>
<area shape="rect" href="classModel.html#afb9609a07caf72ce5cc529f4dcca949f" title="Prepares file for download over WUI." alt="" coords="724,770,904,796"/>
<area shape="rect" href="classModel.html#ab1e8cbbabce3210438cebad028f153d7" title="Gets the number of lines added to log files since last tmp file update." alt="" coords="525,77,665,102"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="351,126,454,152"/>
<area shape="rect" href="classModel.html#aeea778b449fceb9e5e77cc98440ac4bd" title="Gets line count of the given log file." alt="" coords="528,126,661,152"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,102,100,128"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,152,92,177"/>
<area shape="rect" href="classModel.html#a75a2cec868b2b3cf1d0f2ae81a799298" title=" " alt="" coords="546,449,643,474"/>
<area shape="rect" href="classModel.html#abd1e082730aeee7890560b4ca2ee0a62" title="Gets logs for live logs pages." alt="" coords="543,400,646,425"/>
<area shape="rect" href="classModel.html#a5b9d9c5affe24f91a3151fa107ee80e4" title=" " alt="" coords="333,424,472,449"/>
<area shape="rect" href="classModel.html#ab735f5a4ded9f9c9a5b04f182205fd7d" title=" " alt="" coords="359,473,446,498"/>
<area shape="rect" href="classModel.html#ac74f9ae5abb475786f8f9278af56e953" title=" " alt="" coords="148,424,283,449"/>
<area shape="rect" href="classModel.html#ad4d7aefbd214d3da3f1965e6ddddb998" title="Copies the original log file to tmp folder." alt="" coords="331,201,475,226"/>
</map>
</div>

</div>
</div>
<a id="ab81972f4cb26c1d07ac429589bb4d62d" name="ab81972f4cb26c1d07ac429589bb4d62d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab81972f4cb26c1d07ac429589bb4d62d">&#9670;&#160;</a></span>ValidateFileExists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ValidateFileExists </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$reportFileExistResult</em> = <code>TRUE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l01855">1855</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1856</span>    {</div>
<div class="line"><span class="lineno"> 1857</span>        <span class="keywordflow">if</span> (!file_exists($file)) {</div>
<div class="line"><span class="lineno"> 1858</span>            <span class="keywordflow">if</span> ($reportFileExistResult) {</div>
<div class="line"><span class="lineno"> 1859</span>                <a class="code hl_function" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928">Error</a>(_(<span class="stringliteral">&#39;File does not exit&#39;</span>).<span class="stringliteral">&#39;: &#39;</span>.$file);</div>
<div class="line"><span class="lineno"> 1860</span>            }</div>
<div class="line"><span class="lineno"> 1861</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1862</span>        }</div>
<div class="line"><span class="lineno"> 1863</span>        <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 1864</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Model_2include_8php_source.html#l00131">Error()</a>.</p>

<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l01437">GetLastLogs()</a>, and <a class="el" href="model_8php_source.html#l01838">ValidateFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ab81972f4cb26c1d07ac429589bb4d62d_cgraph.png" border="0" usemap="#aclassModel_ab81972f4cb26c1d07ac429589bb4d62d_cgraph" alt=""/></div>
<map name="aclassModel_ab81972f4cb26c1d07ac429589bb4d62d_cgraph" id="aclassModel_ab81972f4cb26c1d07ac429589bb4d62d_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,143,31"/>
<area shape="rect" href="Model_2include_8php.html#a5afab85a7aaf19395f9a0e86cae76928" title="Sets or updates $Error with the given message." alt="" coords="191,5,244,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classModel_ab81972f4cb26c1d07ac429589bb4d62d_icgraph.png" border="0" usemap="#aclassModel_ab81972f4cb26c1d07ac429589bb4d62d_icgraph" alt=""/></div>
<map name="aclassModel_ab81972f4cb26c1d07ac429589bb4d62d_icgraph" id="aclassModel_ab81972f4cb26c1d07ac429589bb4d62d_icgraph">
<area shape="rect" title=" " alt="" coords="1112,407,1249,432"/>
<area shape="rect" href="classModel.html#aaf87c48d0be7e3e4563be72e08f120b0" title=" " alt="" coords="961,382,1064,407"/>
<area shape="rect" href="classModel.html#afb379dac54166aba28a4e7e22d0fa772" title="Checks if the given file exists and not larger than $MaxFileSizeToProcess in MBs." alt="" coords="963,431,1062,456"/>
<area shape="rect" href="classModel.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="745,106,883,131"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="174,132,257,158"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="161,207,269,232"/>
<area shape="rect" href="classOpenssh.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="715,332,913,358"/>
<area shape="rect" href="classPf.html#aec3d644e69b54bae382fe3aa894c0879" title=" " alt="" coords="737,382,891,407"/>
<area shape="rect" href="classModel.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="761,431,867,456"/>
<area shape="rect" href="classOpenssh.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="731,480,897,506"/>
<area shape="rect" href="classPf.html#a80a9c7ffc5b622913366185669db13f8" title="Gets logs for live logs pages, the actual method." alt="" coords="752,530,876,555"/>
<area shape="rect" href="classModel.html#a5cdc13ae8497b92e1c6cbf8b85c6d43c" title="Uncompresses gzipped log file to tmp dir." alt="" coords="523,231,667,256"/>
<area shape="rect" href="classModel.html#a3cd1d5510b23ec577d9d124f9e05a449" title="Gets lines in log file." alt="" coords="777,579,851,604"/>
<area shape="rect" href="classOpenssh.html#a3cd1d5510b23ec577d9d124f9e05a449" title="Gets lines in log file." alt="" coords="747,628,881,654"/>
<area shape="rect" href="classPf.html#a3cd1d5510b23ec577d9d124f9e05a449" title="Gets lines in log file." alt="" coords="768,678,860,703"/>
<area shape="rect" href="classModel.html#a392e2975b79f55e83ed15c7c6ed8725c" title="Collects text statistics for the proc stats general page." alt="" coords="747,727,881,752"/>
<area shape="rect" href="classModel.html#ad26e67d9a70c2182a67b939ae61b6d01" title="Builds generic grep command and extracts log lines." alt="" coords="527,182,662,207"/>
<area shape="rect" href="classModel.html#afb9609a07caf72ce5cc529f4dcca949f" title="Prepares file for download over WUI." alt="" coords="724,776,904,802"/>
<area shape="rect" href="classModel.html#ab1e8cbbabce3210438cebad028f153d7" title="Gets the number of lines added to log files since last tmp file update." alt="" coords="525,83,665,108"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="351,132,454,158"/>
<area shape="rect" href="classModel.html#aeea778b449fceb9e5e77cc98440ac4bd" title="Gets line count of the given log file." alt="" coords="528,132,661,158"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,108,100,134"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,158,92,183"/>
<area shape="rect" href="classModel.html#a75a2cec868b2b3cf1d0f2ae81a799298" title=" " alt="" coords="546,455,643,480"/>
<area shape="rect" href="classModel.html#abd1e082730aeee7890560b4ca2ee0a62" title="Gets logs for live logs pages." alt="" coords="543,406,646,431"/>
<area shape="rect" href="classModel.html#a5b9d9c5affe24f91a3151fa107ee80e4" title=" " alt="" coords="333,430,472,455"/>
<area shape="rect" href="classModel.html#ab735f5a4ded9f9c9a5b04f182205fd7d" title=" " alt="" coords="359,479,446,504"/>
<area shape="rect" href="classModel.html#ac74f9ae5abb475786f8f9278af56e953" title=" " alt="" coords="148,430,283,455"/>
<area shape="rect" href="classModel.html#ad4d7aefbd214d3da3f1965e6ddddb998" title="Copies the original log file to tmp folder." alt="" coords="331,207,475,232"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a id="aecc7046be658ffe343bc3a80a05989d6" name="aecc7046be658ffe343bc3a80a05989d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecc7046be658ffe343bc3a80a05989d6">&#9670;&#160;</a></span>$CmdLogStart</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$CmdLogStart = '/usr/bin/head -1 &lt;LF&gt;'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00070">70</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a7944f085df794e2c339d32c263672463" name="a7944f085df794e2c339d32c263672463"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7944f085df794e2c339d32c263672463">&#9670;&#160;</a></span>$CollectdFifoFolder</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$CollectdFifoFolder = PFFWDIR.'/collectd/fifo'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00082">82</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a506cdea0e774d00e4a4f0fd3006ccde6" name="a506cdea0e774d00e4a4f0fd3006ccde6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a506cdea0e774d00e4a4f0fd3006ccde6">&#9670;&#160;</a></span>$CollectdName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$CollectdName = ''</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Used in collectd rrd and fifo file names. </p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00080">80</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a6a43e9fdce01db0b8d3e2b34b980c241" name="a6a43e9fdce01db0b8d3e2b34b980c241"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a43e9fdce01db0b8d3e2b34b980c241">&#9670;&#160;</a></span>$CollectdRrdFolder</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$CollectdRrdFolder = PFFWDIR.'/collectd/rrd/localhost'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00081">81</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a0400b8e33b224a6c59480c6f32e4b261" name="a0400b8e33b224a6c59480c6f32e4b261"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0400b8e33b224a6c59480c6f32e4b261">&#9670;&#160;</a></span>$COMC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$COMC = '#'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00056">56</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a9c7b0180201dacbbea3b4959bc257b9c" name="a9c7b0180201dacbbea3b4959bc257b9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c7b0180201dacbbea3b4959bc257b9c">&#9670;&#160;</a></span>$Commands</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$Commands = array()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Argument lists and descriptions of commands. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000018">Todo:</a></b></dt><dd>Should we implement $Commands using Interfaces in OOP?</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">array</td><td>argv Array of arg types in order. </td></tr>
    <tr><td class="paramname">string</td><td>desc Description of the shell function. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00053">53</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="aa03d84f7a8bbfcb5f3ca9cc4e6c91a8c" name="aa03d84f7a8bbfcb5f3ca9cc4e6c91a8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa03d84f7a8bbfcb5f3ca9cc4e6c91a8c">&#9670;&#160;</a></span>$ConfFile</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$ConfFile = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00065">65</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="ac2e162a2e94a6861acb555bb17919717" name="ac2e162a2e94a6861acb555bb17919717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2e162a2e94a6861acb555bb17919717">&#9670;&#160;</a></span>$Config</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$Config = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00066">66</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a16d4a0f2690f73b941741636d93ff962" name="a16d4a0f2690f73b941741636d93ff962"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16d4a0f2690f73b941741636d93ff962">&#9670;&#160;</a></span>$dateTimeFormat</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$dateTimeFormat = 'M j H:i:s'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This datetime format is for error logs, not access logs. </p>
<p>Certain modules use the default syslog format. </p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00088">88</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a09ce856a444e6c8704d1c5cc9f63e347" name="a09ce856a444e6c8704d1c5cc9f63e347"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09ce856a444e6c8704d1c5cc9f63e347">&#9670;&#160;</a></span>$LogFile</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$LogFile = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00058">58</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a90efb261c13e9a3e16ed2b0563dec08d" name="a90efb261c13e9a3e16ed2b0563dec08d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90efb261c13e9a3e16ed2b0563dec08d">&#9670;&#160;</a></span>$Name</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$Name = ''</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section attention"><dt>Attention</dt><dd>Should be updated in constructors of children </dd></dl>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00030">30</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a7fc5c8cb4f856fd6066c4b4f12254321" name="a7fc5c8cb4f856fd6066c4b4f12254321"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fc5c8cb4f856fd6066c4b4f12254321">&#9670;&#160;</a></span>$Nesting</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$Nesting = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Keeps the count of nested anchors in inline rules. </p>

<p class="definition">Definition at line <a class="el" href="Model_2lib_2Anchor_8php_source.html#l00026">26</a> of file <a class="el" href="Model_2lib_2Anchor_8php_source.html">Anchor.php</a>.</p>

</div>
</div>
<a id="aabdfb1b0a42cc5cc9dee4bab322e4bdc" name="aabdfb1b0a42cc5cc9dee4bab322e4bdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabdfb1b0a42cc5cc9dee4bab322e4bdc">&#9670;&#160;</a></span>$newSyslogConf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$newSyslogConf = '/etc/newsyslog.conf'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00084">84</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a241473971eee4015ff567b0a2ddd69a0" name="a241473971eee4015ff567b0a2ddd69a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a241473971eee4015ff567b0a2ddd69a0">&#9670;&#160;</a></span>$NVPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$NVPS = '='</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00055">55</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a386f9a88efbebc72ab5669b927503235" name="a386f9a88efbebc72ab5669b927503235"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a386f9a88efbebc72ab5669b927503235">&#9670;&#160;</a></span>$PFFWDIR</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$<a class="el" href="defs_8php.html#aa8d15384fc15e1dedc917fe43ebf78e2">PFFWDIR</a> = <a class="el" href="defs_8php.html#aa8d15384fc15e1dedc917fe43ebf78e2">PFFWDIR</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Makes the PFFWDIR define easier to use in functions, without adding a global var. </p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00075">75</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a8a572fc2c1faaac0479dcda390666042" name="a8a572fc2c1faaac0479dcda390666042"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a572fc2c1faaac0479dcda390666042">&#9670;&#160;</a></span>$PfRulesFile</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$PfRulesFile = '/etc/pf.conf'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00063">63</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a21d9c74bb030acf2c58fc04a3e2421cb" name="a21d9c74bb030acf2c58fc04a3e2421cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21d9c74bb030acf2c58fc04a3e2421cb">&#9670;&#160;</a></span>$PidFile</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$PidFile = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00077">77</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a42126d9267d0d3d37d824eefc58baa42" name="a42126d9267d0d3d37d824eefc58baa42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42126d9267d0d3d37d824eefc58baa42">&#9670;&#160;</a></span>$Proc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$Proc = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00032">32</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a6ed5c1b8c0dee6594cb0afd49f0b9750" name="a6ed5c1b8c0dee6594cb0afd49f0b9750"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ed5c1b8c0dee6594cb0afd49f0b9750">&#9670;&#160;</a></span>$psCmd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$psCmd = '/bin/ps arwwx -o pid,start,%cpu,time,%mem,rss,vsz,stat,pri,nice,tty,user,group,command | /usr/bin/grep -v -e grep | /usr/bin/grep -E &lt;PROC&gt;'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00037">37</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a39672e159647946bae12cec464b15b73" name="a39672e159647946bae12cec464b15b73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39672e159647946bae12cec464b15b73">&#9670;&#160;</a></span>$rcConfLocal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">$rcConfLocal = '/etc/rc.conf.local'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00061">61</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a69b3b446371042a6cc08124b54c8be8d" name="a69b3b446371042a6cc08124b54c8be8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69b3b446371042a6cc08124b54c8be8d">&#9670;&#160;</a></span>$ReloadCmd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$ReloadCmd = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00068">68</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="afdf16e6be60850ef6ade179a6018caab" name="afdf16e6be60850ef6ade179a6018caab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdf16e6be60850ef6ade179a6018caab">&#9670;&#160;</a></span>$StartCmd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$StartCmd = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00039">39</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="ac8f3243fedb9ea1936571728529a3832" name="ac8f3243fedb9ea1936571728529a3832"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8f3243fedb9ea1936571728529a3832">&#9670;&#160;</a></span>$TmpLogsDir</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$TmpLogsDir = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00059">59</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a77cc6ebf3902e67557ab5de9317a11c2" name="a77cc6ebf3902e67557ab5de9317a11c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77cc6ebf3902e67557ab5de9317a11c2">&#9670;&#160;</a></span>$User</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$User = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00033">33</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a3676f8d6824dd8545ac5262a7d839161" name="a3676f8d6824dd8545ac5262a7d839161"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3676f8d6824dd8545ac5262a7d839161">&#9670;&#160;</a></span>$VersionCmd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$VersionCmd = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00072">72</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a13912bdecf95fd51b565bc7100f9e2f6" name="a13912bdecf95fd51b565bc7100f9e2f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13912bdecf95fd51b565bc7100f9e2f6">&#9670;&#160;</a></span>PROC_STAT_SLEEP_TIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const PROC_STAT_SLEEP_TIME = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00043">43</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<a id="a8fadf0af39f87db5dbae30e1e2a80341" name="a8fadf0af39f87db5dbae30e1e2a80341"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fadf0af39f87db5dbae30e1e2a80341">&#9670;&#160;</a></span>PROC_STAT_TIMEOUT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const PROC_STAT_TIMEOUT = 30</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Max number of iterations to try while starting or stopping processes. </p>

<p class="definition">Definition at line <a class="el" href="model_8php_source.html#l00042">42</a> of file <a class="el" href="model_8php_source.html">model.php</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/Model/<a class="el" href="model_8php_source.html">model.php</a></li>
<li>src/Model/lib/<a class="el" href="Model_2lib_2Anchor_8php_source.html">Anchor.php</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classModel.html">Model</a></li>
    <li class="footer">Generated on Sun Apr 30 2023 00:52:49 for PF Firewall by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
