<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PF Firewall: Crypt_RSA Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PF Firewall<span id="projectnumber">&#160;7.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classCrypt__RSA.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle"><div class="title">Crypt_RSA Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a095c5d389db211932136b53f25f39685"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a095c5d389db211932136b53f25f39685">__construct</a> ()</td></tr>
<tr class="memdesc:a095c5d389db211932136b53f25f39685"><td class="mdescLeft">&#160;</td><td class="mdescRight">The constructor.  <br /></td></tr>
<tr class="separator:a095c5d389db211932136b53f25f39685"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ffaab04d34f40e24b7e2d265f2b7b9f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a3ffaab04d34f40e24b7e2d265f2b7b9f">Crypt_RSA</a> ()</td></tr>
<tr class="memdesc:a3ffaab04d34f40e24b7e2d265f2b7b9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">PHP4 compatible Default Constructor.  <br /></td></tr>
<tr class="separator:a3ffaab04d34f40e24b7e2d265f2b7b9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c89d16d1494dbaef6d353e2f62ce02c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a9c89d16d1494dbaef6d353e2f62ce02c">createKey</a> ($bits=1024, $timeout=false, $partial=array())</td></tr>
<tr class="memdesc:a9c89d16d1494dbaef6d353e2f62ce02c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create public / private key pair.  <br /></td></tr>
<tr class="separator:a9c89d16d1494dbaef6d353e2f62ce02c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bd18359bf21cecc783d2fde56b48045"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a2bd18359bf21cecc783d2fde56b48045">_convertPrivateKey</a> ($n, $e, $d, $primes, $exponents, $coefficients)</td></tr>
<tr class="memdesc:a2bd18359bf21cecc783d2fde56b48045"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a private key to the appropriate format.  <br /></td></tr>
<tr class="separator:a2bd18359bf21cecc783d2fde56b48045"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ac38a64a86bc6963da281cf08c78d7a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a1ac38a64a86bc6963da281cf08c78d7a">_convertPublicKey</a> ($n, $e)</td></tr>
<tr class="memdesc:a1ac38a64a86bc6963da281cf08c78d7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a public key to the appropriate format.  <br /></td></tr>
<tr class="separator:a1ac38a64a86bc6963da281cf08c78d7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a269d4a2cf9ac198a73cfcb4bc3b8f9b5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5">_parseKey</a> ($key, $type)</td></tr>
<tr class="memdesc:a269d4a2cf9ac198a73cfcb4bc3b8f9b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Break a public or private key down into its constituant components.  <br /></td></tr>
<tr class="separator:a269d4a2cf9ac198a73cfcb4bc3b8f9b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75cce10cdf81be6dc84881c28b3379b7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a75cce10cdf81be6dc84881c28b3379b7">getSize</a> ()</td></tr>
<tr class="memdesc:a75cce10cdf81be6dc84881c28b3379b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the key size.  <br /></td></tr>
<tr class="separator:a75cce10cdf81be6dc84881c28b3379b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac51308488f6dc3efa4acfee235823825"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ac51308488f6dc3efa4acfee235823825">_start_element_handler</a> ($parser, $name, $attribs)</td></tr>
<tr class="memdesc:ac51308488f6dc3efa4acfee235823825"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start Element Handler.  <br /></td></tr>
<tr class="separator:ac51308488f6dc3efa4acfee235823825"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a377b31b7ccc7fd14f08679e6640a6c3b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a377b31b7ccc7fd14f08679e6640a6c3b">_stop_element_handler</a> ($parser, $name)</td></tr>
<tr class="memdesc:a377b31b7ccc7fd14f08679e6640a6c3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop Element Handler.  <br /></td></tr>
<tr class="separator:a377b31b7ccc7fd14f08679e6640a6c3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac43f351fa8637af55dd825eadef765e9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ac43f351fa8637af55dd825eadef765e9">_data_handler</a> ($parser, $data)</td></tr>
<tr class="memdesc:ac43f351fa8637af55dd825eadef765e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data Handler.  <br /></td></tr>
<tr class="separator:ac43f351fa8637af55dd825eadef765e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecd4eb5e57d8881db518d98009bd75ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#aecd4eb5e57d8881db518d98009bd75ee">loadKey</a> ($key, $type=false)</td></tr>
<tr class="memdesc:aecd4eb5e57d8881db518d98009bd75ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads a public or private key.  <br /></td></tr>
<tr class="separator:aecd4eb5e57d8881db518d98009bd75ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb198e11b62e4f096ea176fbc57ae226"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#afb198e11b62e4f096ea176fbc57ae226">setPassword</a> ($password=false)</td></tr>
<tr class="memdesc:afb198e11b62e4f096ea176fbc57ae226"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the password.  <br /></td></tr>
<tr class="separator:afb198e11b62e4f096ea176fbc57ae226"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c291d208f8e9a8ea7e0e4b6335a61a9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a5c291d208f8e9a8ea7e0e4b6335a61a9">setPublicKey</a> ($key=false, $type=false)</td></tr>
<tr class="memdesc:a5c291d208f8e9a8ea7e0e4b6335a61a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the public key.  <br /></td></tr>
<tr class="separator:a5c291d208f8e9a8ea7e0e4b6335a61a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a871b11d67cc3a8f62e4c0306e64c7c1b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a871b11d67cc3a8f62e4c0306e64c7c1b">setPrivateKey</a> ($key=false, $type=false)</td></tr>
<tr class="memdesc:a871b11d67cc3a8f62e4c0306e64c7c1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the private key.  <br /></td></tr>
<tr class="separator:a871b11d67cc3a8f62e4c0306e64c7c1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2537bd11389611acfb24dfd719fa8314"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a2537bd11389611acfb24dfd719fa8314">getPublicKey</a> ($type=<a class="el" href="RSA_8php.html#a4741a3919471f37f2156fa615d24a49f">CRYPT_RSA_PUBLIC_FORMAT_PKCS8</a>)</td></tr>
<tr class="memdesc:a2537bd11389611acfb24dfd719fa8314"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the public key.  <br /></td></tr>
<tr class="separator:a2537bd11389611acfb24dfd719fa8314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ef3a2fd4f138fef0ce7a3b5770d8e43"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a9ef3a2fd4f138fef0ce7a3b5770d8e43">getPublicKeyFingerprint</a> ($algorithm='md5')</td></tr>
<tr class="memdesc:a9ef3a2fd4f138fef0ce7a3b5770d8e43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the public key's fingerprint.  <br /></td></tr>
<tr class="separator:a9ef3a2fd4f138fef0ce7a3b5770d8e43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9220b3460a198b0e587361a34333a6e3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a9220b3460a198b0e587361a34333a6e3">getPrivateKey</a> ($type=<a class="el" href="RSA_8php.html#a15eeb8d9dc1af1411f1549d4702c8a00">CRYPT_RSA_PUBLIC_FORMAT_PKCS1</a>)</td></tr>
<tr class="memdesc:a9220b3460a198b0e587361a34333a6e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the private key.  <br /></td></tr>
<tr class="separator:a9220b3460a198b0e587361a34333a6e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b1b2e0f348855a387167ec571c21371"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a8b1b2e0f348855a387167ec571c21371">_getPrivatePublicKey</a> ($mode=<a class="el" href="RSA_8php.html#a4741a3919471f37f2156fa615d24a49f">CRYPT_RSA_PUBLIC_FORMAT_PKCS8</a>)</td></tr>
<tr class="memdesc:a8b1b2e0f348855a387167ec571c21371"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a minimalistic private key.  <br /></td></tr>
<tr class="separator:a8b1b2e0f348855a387167ec571c21371"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7516ca30af0db3cdbf9a7739b48ce91d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a7516ca30af0db3cdbf9a7739b48ce91d">__toString</a> ()</td></tr>
<tr class="memdesc:a7516ca30af0db3cdbf9a7739b48ce91d"><td class="mdescLeft">&#160;</td><td class="mdescRight">__toString() magic method  <br /></td></tr>
<tr class="separator:a7516ca30af0db3cdbf9a7739b48ce91d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0cb87b388bc74d63dc884accdca8713"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ad0cb87b388bc74d63dc884accdca8713">__clone</a> ()</td></tr>
<tr class="memdesc:ad0cb87b388bc74d63dc884accdca8713"><td class="mdescLeft">&#160;</td><td class="mdescRight">__clone() magic method  <br /></td></tr>
<tr class="separator:ad0cb87b388bc74d63dc884accdca8713"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63369f75f78aece549868cebbf270794"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a63369f75f78aece549868cebbf270794">_generateMinMax</a> ($bits)</td></tr>
<tr class="memdesc:a63369f75f78aece549868cebbf270794"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates the smallest and largest numbers requiring $bits bits.  <br /></td></tr>
<tr class="separator:a63369f75f78aece549868cebbf270794"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae88f34bdbb000851150beff041dcb0fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a> (&amp;$string)</td></tr>
<tr class="memdesc:ae88f34bdbb000851150beff041dcb0fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">DER-decode the length.  <br /></td></tr>
<tr class="separator:ae88f34bdbb000851150beff041dcb0fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9967d86f5c5bdf50e4bc80cf1a9c018"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a> ($length)</td></tr>
<tr class="memdesc:ab9967d86f5c5bdf50e4bc80cf1a9c018"><td class="mdescLeft">&#160;</td><td class="mdescRight">DER-encode the length.  <br /></td></tr>
<tr class="separator:ab9967d86f5c5bdf50e4bc80cf1a9c018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab009fa6f4ba09daa679a30e9b5bcfe35"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a> (&amp;$string, $index=1)</td></tr>
<tr class="memdesc:ab009fa6f4ba09daa679a30e9b5bcfe35"><td class="mdescLeft">&#160;</td><td class="mdescRight">String Shift.  <br /></td></tr>
<tr class="separator:ab009fa6f4ba09daa679a30e9b5bcfe35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a328ed81271f621fb5637c11ed378bf46"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a328ed81271f621fb5637c11ed378bf46">setPrivateKeyFormat</a> ($format)</td></tr>
<tr class="memdesc:a328ed81271f621fb5637c11ed378bf46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the private key format.  <br /></td></tr>
<tr class="separator:a328ed81271f621fb5637c11ed378bf46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9bb6561d72fe782783912c995b6b5f1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ab9bb6561d72fe782783912c995b6b5f1">setPublicKeyFormat</a> ($format)</td></tr>
<tr class="memdesc:ab9bb6561d72fe782783912c995b6b5f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the public key format.  <br /></td></tr>
<tr class="separator:ab9bb6561d72fe782783912c995b6b5f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6c0bf5357622f2aea1b76623ae52d76"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ab6c0bf5357622f2aea1b76623ae52d76">setHash</a> ($hash)</td></tr>
<tr class="memdesc:ab6c0bf5357622f2aea1b76623ae52d76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines which hashing function should be used.  <br /></td></tr>
<tr class="separator:ab6c0bf5357622f2aea1b76623ae52d76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa10d5d9f489e469dcecd3df6aef2c286"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#aa10d5d9f489e469dcecd3df6aef2c286">setMGFHash</a> ($hash)</td></tr>
<tr class="memdesc:aa10d5d9f489e469dcecd3df6aef2c286"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines which hashing function should be used for the mask generation function.  <br /></td></tr>
<tr class="separator:aa10d5d9f489e469dcecd3df6aef2c286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af16596bc0e249b6ce396a65317a74756"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#af16596bc0e249b6ce396a65317a74756">setSaltLength</a> ($sLen)</td></tr>
<tr class="memdesc:af16596bc0e249b6ce396a65317a74756"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the salt length.  <br /></td></tr>
<tr class="separator:af16596bc0e249b6ce396a65317a74756"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dbb5187f86756281452e726a0c3d87b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b">_i2osp</a> ($x, $xLen)</td></tr>
<tr class="memdesc:a7dbb5187f86756281452e726a0c3d87b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integer-to-Octet-String primitive.  <br /></td></tr>
<tr class="separator:a7dbb5187f86756281452e726a0c3d87b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfc45b22328d38a3e36ce78eb1fceab1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#acfc45b22328d38a3e36ce78eb1fceab1">_os2ip</a> ($x)</td></tr>
<tr class="memdesc:acfc45b22328d38a3e36ce78eb1fceab1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Octet-String-to-Integer primitive.  <br /></td></tr>
<tr class="separator:acfc45b22328d38a3e36ce78eb1fceab1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46927f0a9e61928ad1fd683f250dbce9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9">_exponentiate</a> ($x)</td></tr>
<tr class="memdesc:a46927f0a9e61928ad1fd683f250dbce9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exponentiate with or without Chinese Remainder Theorem.  <br /></td></tr>
<tr class="separator:a46927f0a9e61928ad1fd683f250dbce9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44ab71ffba98c8fe3172f8d2dc69e443"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443">_blind</a> ($x, $r, $i)</td></tr>
<tr class="memdesc:a44ab71ffba98c8fe3172f8d2dc69e443"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs RSA Blinding.  <br /></td></tr>
<tr class="separator:a44ab71ffba98c8fe3172f8d2dc69e443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1479196d348b439c4a2f1ec8c72f9dd3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a1479196d348b439c4a2f1ec8c72f9dd3">_equals</a> ($x, $y)</td></tr>
<tr class="memdesc:a1479196d348b439c4a2f1ec8c72f9dd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs blinded RSA equality testing.  <br /></td></tr>
<tr class="separator:a1479196d348b439c4a2f1ec8c72f9dd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5157f032e713c0485ba64caebea03bd4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a5157f032e713c0485ba64caebea03bd4">_rsaep</a> ($m)</td></tr>
<tr class="memdesc:a5157f032e713c0485ba64caebea03bd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">RSAEP.  <br /></td></tr>
<tr class="separator:a5157f032e713c0485ba64caebea03bd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7fd9226ba1559b8cfe7d42423021ee1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ae7fd9226ba1559b8cfe7d42423021ee1">_rsadp</a> ($c)</td></tr>
<tr class="memdesc:ae7fd9226ba1559b8cfe7d42423021ee1"><td class="mdescLeft">&#160;</td><td class="mdescRight">RSADP.  <br /></td></tr>
<tr class="separator:ae7fd9226ba1559b8cfe7d42423021ee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a812ed7b5c58b1d3281ca8263b0eb9c38"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a812ed7b5c58b1d3281ca8263b0eb9c38">_rsasp1</a> ($m)</td></tr>
<tr class="memdesc:a812ed7b5c58b1d3281ca8263b0eb9c38"><td class="mdescLeft">&#160;</td><td class="mdescRight">RSASP1.  <br /></td></tr>
<tr class="separator:a812ed7b5c58b1d3281ca8263b0eb9c38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fe05e8ee49b3d3064c09ff852c3bf34"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a2fe05e8ee49b3d3064c09ff852c3bf34">_rsavp1</a> ($s)</td></tr>
<tr class="memdesc:a2fe05e8ee49b3d3064c09ff852c3bf34"><td class="mdescLeft">&#160;</td><td class="mdescRight">RSAVP1.  <br /></td></tr>
<tr class="separator:a2fe05e8ee49b3d3064c09ff852c3bf34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfcfdb9ca9cc5a3eeceee10ebcf793e0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#abfcfdb9ca9cc5a3eeceee10ebcf793e0">_mgf1</a> ($mgfSeed, $maskLen)</td></tr>
<tr class="memdesc:abfcfdb9ca9cc5a3eeceee10ebcf793e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">MGF1.  <br /></td></tr>
<tr class="separator:abfcfdb9ca9cc5a3eeceee10ebcf793e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43d2341a9ffbeadcf13400dbe48988cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a43d2341a9ffbeadcf13400dbe48988cc">_rsaes_oaep_encrypt</a> ($m, $l='')</td></tr>
<tr class="memdesc:a43d2341a9ffbeadcf13400dbe48988cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">RSAES-OAEP-ENCRYPT.  <br /></td></tr>
<tr class="separator:a43d2341a9ffbeadcf13400dbe48988cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7c3d5295c0bb7b4bcdaa30d17e3bac7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ad7c3d5295c0bb7b4bcdaa30d17e3bac7">_rsaes_oaep_decrypt</a> ($c, $l='')</td></tr>
<tr class="memdesc:ad7c3d5295c0bb7b4bcdaa30d17e3bac7"><td class="mdescLeft">&#160;</td><td class="mdescRight">RSAES-OAEP-DECRYPT.  <br /></td></tr>
<tr class="separator:ad7c3d5295c0bb7b4bcdaa30d17e3bac7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a4bf86d0bc8f236078fee29827dc683"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a5a4bf86d0bc8f236078fee29827dc683">_raw_encrypt</a> ($m)</td></tr>
<tr class="memdesc:a5a4bf86d0bc8f236078fee29827dc683"><td class="mdescLeft">&#160;</td><td class="mdescRight">Raw Encryption / Decryption.  <br /></td></tr>
<tr class="separator:a5a4bf86d0bc8f236078fee29827dc683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47bed67c0d9c4ecc11da13e0ad3cddb0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a47bed67c0d9c4ecc11da13e0ad3cddb0">_rsaes_pkcs1_v1_5_encrypt</a> ($m)</td></tr>
<tr class="memdesc:a47bed67c0d9c4ecc11da13e0ad3cddb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">RSAES-PKCS1-V1_5-ENCRYPT.  <br /></td></tr>
<tr class="separator:a47bed67c0d9c4ecc11da13e0ad3cddb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7171e1af643c02e2167394607a4f4c26"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a7171e1af643c02e2167394607a4f4c26">_rsaes_pkcs1_v1_5_decrypt</a> ($c)</td></tr>
<tr class="memdesc:a7171e1af643c02e2167394607a4f4c26"><td class="mdescLeft">&#160;</td><td class="mdescRight">RSAES-PKCS1-V1_5-DECRYPT.  <br /></td></tr>
<tr class="separator:a7171e1af643c02e2167394607a4f4c26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1766412b33feaf27a58c51171f4a8f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ab1766412b33feaf27a58c51171f4a8f0">_emsa_pss_encode</a> ($m, $emBits)</td></tr>
<tr class="memdesc:ab1766412b33feaf27a58c51171f4a8f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">EMSA-PSS-ENCODE.  <br /></td></tr>
<tr class="separator:ab1766412b33feaf27a58c51171f4a8f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a823206322297e3b89a2e04897cdc64c3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a823206322297e3b89a2e04897cdc64c3">_emsa_pss_verify</a> ($m, $em, $emBits)</td></tr>
<tr class="memdesc:a823206322297e3b89a2e04897cdc64c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">EMSA-PSS-VERIFY.  <br /></td></tr>
<tr class="separator:a823206322297e3b89a2e04897cdc64c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41d7b44f4ff751df9dc5bc9a2e1a5875"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a41d7b44f4ff751df9dc5bc9a2e1a5875">_rsassa_pss_sign</a> ($m)</td></tr>
<tr class="memdesc:a41d7b44f4ff751df9dc5bc9a2e1a5875"><td class="mdescLeft">&#160;</td><td class="mdescRight">RSASSA-PSS-SIGN.  <br /></td></tr>
<tr class="separator:a41d7b44f4ff751df9dc5bc9a2e1a5875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14d4abcd8f2ca6604b948026e0c553ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a14d4abcd8f2ca6604b948026e0c553ba">_rsassa_pss_verify</a> ($m, $s)</td></tr>
<tr class="memdesc:a14d4abcd8f2ca6604b948026e0c553ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">RSASSA-PSS-VERIFY.  <br /></td></tr>
<tr class="separator:a14d4abcd8f2ca6604b948026e0c553ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7c7477da0e0045974ee1a8d1795d73f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ac7c7477da0e0045974ee1a8d1795d73f">_emsa_pkcs1_v1_5_encode</a> ($m, $emLen)</td></tr>
<tr class="memdesc:ac7c7477da0e0045974ee1a8d1795d73f"><td class="mdescLeft">&#160;</td><td class="mdescRight">EMSA-PKCS1-V1_5-ENCODE.  <br /></td></tr>
<tr class="separator:ac7c7477da0e0045974ee1a8d1795d73f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af65bce0b24a7aeeb274b776ba732aa15"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#af65bce0b24a7aeeb274b776ba732aa15">_emsa_pkcs1_v1_5_encode_without_null</a> ($m, $emLen)</td></tr>
<tr class="memdesc:af65bce0b24a7aeeb274b776ba732aa15"><td class="mdescLeft">&#160;</td><td class="mdescRight">EMSA-PKCS1-V1_5-ENCODE (without NULL)  <br /></td></tr>
<tr class="separator:af65bce0b24a7aeeb274b776ba732aa15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7919feaaf410567587520ae62d0f375a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a7919feaaf410567587520ae62d0f375a">_rsassa_pkcs1_v1_5_sign</a> ($m)</td></tr>
<tr class="memdesc:a7919feaaf410567587520ae62d0f375a"><td class="mdescLeft">&#160;</td><td class="mdescRight">RSASSA-PKCS1-V1_5-SIGN.  <br /></td></tr>
<tr class="separator:a7919feaaf410567587520ae62d0f375a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bac0d7f59f81a08f34e937e71fa4264"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a9bac0d7f59f81a08f34e937e71fa4264">_rsassa_pkcs1_v1_5_verify</a> ($m, $s)</td></tr>
<tr class="memdesc:a9bac0d7f59f81a08f34e937e71fa4264"><td class="mdescLeft">&#160;</td><td class="mdescRight">RSASSA-PKCS1-V1_5-VERIFY.  <br /></td></tr>
<tr class="separator:a9bac0d7f59f81a08f34e937e71fa4264"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c3f88cca5b61fb0c79d57cce592c16b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a5c3f88cca5b61fb0c79d57cce592c16b">setEncryptionMode</a> ($mode)</td></tr>
<tr class="memdesc:a5c3f88cca5b61fb0c79d57cce592c16b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set Encryption Mode.  <br /></td></tr>
<tr class="separator:a5c3f88cca5b61fb0c79d57cce592c16b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e2e42e58327ce1242da88d13f0af9ac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a4e2e42e58327ce1242da88d13f0af9ac">setSignatureMode</a> ($mode)</td></tr>
<tr class="memdesc:a4e2e42e58327ce1242da88d13f0af9ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set Signature Mode.  <br /></td></tr>
<tr class="separator:a4e2e42e58327ce1242da88d13f0af9ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a169d67ad53abdd4e6d1cd931fe15e839"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a169d67ad53abdd4e6d1cd931fe15e839">setComment</a> ($comment)</td></tr>
<tr class="memdesc:a169d67ad53abdd4e6d1cd931fe15e839"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set public key comment.  <br /></td></tr>
<tr class="separator:a169d67ad53abdd4e6d1cd931fe15e839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb57c3d1b74c19589ba1d641ea1a390e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#adb57c3d1b74c19589ba1d641ea1a390e">getComment</a> ()</td></tr>
<tr class="memdesc:adb57c3d1b74c19589ba1d641ea1a390e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get public key comment.  <br /></td></tr>
<tr class="separator:adb57c3d1b74c19589ba1d641ea1a390e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5ceadf7c30ea677b755c6085b23f2a5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#aa5ceadf7c30ea677b755c6085b23f2a5">encrypt</a> ($plaintext)</td></tr>
<tr class="memdesc:aa5ceadf7c30ea677b755c6085b23f2a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encryption.  <br /></td></tr>
<tr class="separator:aa5ceadf7c30ea677b755c6085b23f2a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7668d56408ddd5f0cd7e8e745afd9d9a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a7668d56408ddd5f0cd7e8e745afd9d9a">decrypt</a> ($ciphertext)</td></tr>
<tr class="memdesc:a7668d56408ddd5f0cd7e8e745afd9d9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decryption.  <br /></td></tr>
<tr class="separator:a7668d56408ddd5f0cd7e8e745afd9d9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe0890f90bae8c6cab81312df152652b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#abe0890f90bae8c6cab81312df152652b">sign</a> ($message)</td></tr>
<tr class="memdesc:abe0890f90bae8c6cab81312df152652b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a signature.  <br /></td></tr>
<tr class="separator:abe0890f90bae8c6cab81312df152652b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91b3194ffeb55cb91eb28202ea8fe666"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a91b3194ffeb55cb91eb28202ea8fe666">verify</a> ($message, $signature)</td></tr>
<tr class="memdesc:a91b3194ffeb55cb91eb28202ea8fe666"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies a signature.  <br /></td></tr>
<tr class="separator:a91b3194ffeb55cb91eb28202ea8fe666"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a009e0a2396931d62c87d27f4e2372024"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a009e0a2396931d62c87d27f4e2372024">_extractBER</a> ($str)</td></tr>
<tr class="memdesc:a009e0a2396931d62c87d27f4e2372024"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract raw BER from Base64 encoding.  <br /></td></tr>
<tr class="separator:a009e0a2396931d62c87d27f4e2372024"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a3df958928cd7d9367ad3562920c50715"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a3df958928cd7d9367ad3562920c50715">$zero</a></td></tr>
<tr class="separator:a3df958928cd7d9367ad3562920c50715"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95601f0019d098a2b40f33f5939e799b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a95601f0019d098a2b40f33f5939e799b">$one</a></td></tr>
<tr class="separator:a95601f0019d098a2b40f33f5939e799b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa20f553bc527aabe01e71da515ff75d4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#aa20f553bc527aabe01e71da515ff75d4">$privateKeyFormat</a> = <a class="el" href="RSA_8php.html#a72160567057c92a07f17877a8e6a1465">CRYPT_RSA_PRIVATE_FORMAT_PKCS1</a></td></tr>
<tr class="separator:aa20f553bc527aabe01e71da515ff75d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f6921fa02e68aa30aef8812c1b8ca48"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a0f6921fa02e68aa30aef8812c1b8ca48">$publicKeyFormat</a> = <a class="el" href="RSA_8php.html#a4741a3919471f37f2156fa615d24a49f">CRYPT_RSA_PUBLIC_FORMAT_PKCS8</a></td></tr>
<tr class="separator:a0f6921fa02e68aa30aef8812c1b8ca48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17709e191d11322c1bbca0b4c2533b6a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a17709e191d11322c1bbca0b4c2533b6a">$modulus</a></td></tr>
<tr class="separator:a17709e191d11322c1bbca0b4c2533b6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6726cfaa85d4b8299d2b0f034cbf178"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ad6726cfaa85d4b8299d2b0f034cbf178">$k</a></td></tr>
<tr class="separator:ad6726cfaa85d4b8299d2b0f034cbf178"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbf61ed0170ad53e99e059308433a360"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#acbf61ed0170ad53e99e059308433a360">$exponent</a></td></tr>
<tr class="separator:acbf61ed0170ad53e99e059308433a360"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3512d5a4383616be363bc390ae3e7ec7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a3512d5a4383616be363bc390ae3e7ec7">$primes</a></td></tr>
<tr class="separator:a3512d5a4383616be363bc390ae3e7ec7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49441857b4bc8d5573cba6fea45f400d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a49441857b4bc8d5573cba6fea45f400d">$exponents</a></td></tr>
<tr class="separator:a49441857b4bc8d5573cba6fea45f400d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2484451bccf0a9d944d2cb27fa103678"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a2484451bccf0a9d944d2cb27fa103678">$coefficients</a></td></tr>
<tr class="separator:a2484451bccf0a9d944d2cb27fa103678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cfa85883d33ac59bd9d0c56caf73222"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a6cfa85883d33ac59bd9d0c56caf73222">$hashName</a></td></tr>
<tr class="separator:a6cfa85883d33ac59bd9d0c56caf73222"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9fdf6f2c8fb45c1d3bb9a176802b2ad"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ac9fdf6f2c8fb45c1d3bb9a176802b2ad">$hash</a></td></tr>
<tr class="separator:ac9fdf6f2c8fb45c1d3bb9a176802b2ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4aa655b2082413abc404eb92f3776e1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ae4aa655b2082413abc404eb92f3776e1">$hLen</a></td></tr>
<tr class="separator:ae4aa655b2082413abc404eb92f3776e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8efc7039497bc1c39c5817d77df2dca8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a8efc7039497bc1c39c5817d77df2dca8">$sLen</a></td></tr>
<tr class="separator:a8efc7039497bc1c39c5817d77df2dca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae76a5323d6eed343a9558b01d35ccf8f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ae76a5323d6eed343a9558b01d35ccf8f">$mgfHash</a></td></tr>
<tr class="separator:ae76a5323d6eed343a9558b01d35ccf8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0047ea03c5a2f14b7f5fa05cdee07fc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#ab0047ea03c5a2f14b7f5fa05cdee07fc">$mgfHLen</a></td></tr>
<tr class="separator:ab0047ea03c5a2f14b7f5fa05cdee07fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af27332d55518bfb56c1d594048350da3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#af27332d55518bfb56c1d594048350da3">$encryptionMode</a> = <a class="el" href="RSA_8php.html#a7e1ceaf622bb14486567072ec1d800af">CRYPT_RSA_ENCRYPTION_OAEP</a></td></tr>
<tr class="separator:af27332d55518bfb56c1d594048350da3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b3599db49cf1495ca08f8d193efaf04"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a3b3599db49cf1495ca08f8d193efaf04">$signatureMode</a> = <a class="el" href="RSA_8php.html#a3a0a5d8321ce543e3f8e5031571a8c6f">CRYPT_RSA_SIGNATURE_PSS</a></td></tr>
<tr class="separator:a3b3599db49cf1495ca08f8d193efaf04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67c17fc0cf6463311de6c63b2cdf2d67"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a67c17fc0cf6463311de6c63b2cdf2d67">$publicExponent</a> = false</td></tr>
<tr class="separator:a67c17fc0cf6463311de6c63b2cdf2d67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a607686ef9f99ea7c42f4f3dd3dbb2b0d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a607686ef9f99ea7c42f4f3dd3dbb2b0d">$password</a> = false</td></tr>
<tr class="separator:a607686ef9f99ea7c42f4f3dd3dbb2b0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2409c247baf67a1d4c6b9a1789cfc088"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a> = array()</td></tr>
<tr class="separator:a2409c247baf67a1d4c6b9a1789cfc088"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c4c58e377f6c66ca38c8ea97666fc5e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a2c4c58e377f6c66ca38c8ea97666fc5e">$current</a></td></tr>
<tr class="separator:a2c4c58e377f6c66ca38c8ea97666fc5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e265c431ca42bf2f20753540bb64d00"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a3e265c431ca42bf2f20753540bb64d00">$configFile</a></td></tr>
<tr class="separator:a3e265c431ca42bf2f20753540bb64d00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a536677acc0163c53c067316a97456e6c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__RSA.html#a536677acc0163c53c067316a97456e6c">$comment</a> = 'phpseclib-generated-key'</td></tr>
<tr class="separator:a536677acc0163c53c067316a97456e6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00284">284</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a095c5d389db211932136b53f25f39685" name="a095c5d389db211932136b53f25f39685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a095c5d389db211932136b53f25f39685">&#9670;&#160;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__construct </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The constructor. </p>
<p>If you want to make use of the openssl extension, you'll need to set the mode manually, yourself. The reason <a class="el" href="classCrypt__RSA.html">Crypt_RSA</a> doesn't do it is because OpenSSL doesn't fail gracefully. openssl_pkey_new(), in particular, requires openssl.cnf be present somewhere and, unfortunately, the only real way to find out is too late.</p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classCrypt__RSA.html">Crypt_RSA</a> @access public </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00498">498</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  499</span>    {</div>
<div class="line"><span class="lineno">  500</span>        global <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>;</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>        <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Math_BigInteger&#39;</span>)) {</div>
<div class="line"><span class="lineno">  503</span>            include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Math/BigInteger.php&#39;</span>;</div>
<div class="line"><span class="lineno">  504</span>        }</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>        $this-&gt;configFile = <a class="code hl_variable" href="RSA_8php.html#a8b2acab00f673ebc20fed2f1ecbb184b">CRYPT_RSA_OPENSSL_CONFIG</a>;</div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span>        <span class="keywordflow">if</span> (!defined(<span class="stringliteral">&#39;CRYPT_RSA_MODE&#39;</span>)) {</div>
<div class="line"><span class="lineno">  509</span>            <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  510</span>                <span class="comment">// Math/BigInteger&#39;s openssl requirements are a little less stringent than Crypt/RSA&#39;s. in particular,</span></div>
<div class="line"><span class="lineno">  511</span>                <span class="comment">// Math/BigInteger doesn&#39;t require an openssl.cfg file whereas Crypt/RSA does. so if Math/BigInteger</span></div>
<div class="line"><span class="lineno">  512</span>                <span class="comment">// can&#39;t use OpenSSL it can be pretty trivially assumed, then, that Crypt/RSA can&#39;t either.</span></div>
<div class="line"><span class="lineno">  513</span>                <span class="keywordflow">case</span> defined(<span class="stringliteral">&#39;MATH_BIGINTEGER_OPENSSL_DISABLE&#39;</span>):</div>
<div class="line"><span class="lineno">  514</span>                    define(<span class="stringliteral">&#39;CRYPT_RSA_MODE&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#a856c68b4ad5c3c071c9218b1520ba4a0">CRYPT_RSA_MODE_INTERNAL</a>);</div>
<div class="line"><span class="lineno">  515</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  516</span>                <span class="comment">// openssl_pkey_get_details - which is used in the only place Crypt/RSA.php uses OpenSSL - was introduced in PHP 5.2.0</span></div>
<div class="line"><span class="lineno">  517</span>                <span class="keywordflow">case</span> !function_exists(<span class="stringliteral">&#39;openssl_pkey_get_details&#39;</span>):</div>
<div class="line"><span class="lineno">  518</span>                    define(<span class="stringliteral">&#39;CRYPT_RSA_MODE&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#a856c68b4ad5c3c071c9218b1520ba4a0">CRYPT_RSA_MODE_INTERNAL</a>);</div>
<div class="line"><span class="lineno">  519</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  520</span>                <span class="keywordflow">case</span> function_exists(<span class="stringliteral">&#39;phpinfo&#39;</span>) &amp;&amp; extension_loaded(<span class="stringliteral">&#39;openssl&#39;</span>) &amp;&amp; version_compare(<a class="code hl_variable" href="configtest_8php.html#a3c1ade165b70ecbf36a71bc64671334a">PHP_VERSION</a>, <span class="stringliteral">&#39;4.2.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>) &amp;&amp; file_exists($this-&gt;configFile):</div>
<div class="line"><span class="lineno">  521</span>                    <span class="comment">// some versions of XAMPP have mismatched versions of OpenSSL which causes it not to work</span></div>
<div class="line"><span class="lineno">  522</span>                    ob_start();</div>
<div class="line"><span class="lineno">  523</span>                    @phpinfo();</div>
<div class="line"><span class="lineno">  524</span>                    $content = ob_get_contents();</div>
<div class="line"><span class="lineno">  525</span>                    ob_end_clean();</div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span>                    preg_match_all(<span class="stringliteral">&#39;#OpenSSL (Header|Library) Version(.*)#im&#39;</span>, $content, $matches);</div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span>                    $versions = array();</div>
<div class="line"><span class="lineno">  530</span>                    <span class="keywordflow">if</span> (!empty($matches[1])) {</div>
<div class="line"><span class="lineno">  531</span>                        <span class="keywordflow">for</span> ($i = 0; $i &lt; count($matches[1]); $i++) {</div>
<div class="line"><span class="lineno">  532</span>                            $fullVersion = trim(str_replace(<span class="stringliteral">&#39;=&gt;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, strip_tags($matches[2][$i])));</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>                            <span class="comment">// Remove letter part in OpenSSL version</span></div>
<div class="line"><span class="lineno">  535</span>                            <span class="keywordflow">if</span> (!preg_match(<span class="stringliteral">&#39;/(\d+\.\d+\.\d+)/i&#39;</span>, $fullVersion, $m)) {</div>
<div class="line"><span class="lineno">  536</span>                                $versions[$matches[1][$i]] = $fullVersion;</div>
<div class="line"><span class="lineno">  537</span>                            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  538</span>                                $versions[$matches[1][$i]] = $m[0];</div>
<div class="line"><span class="lineno">  539</span>                            }</div>
<div class="line"><span class="lineno">  540</span>                        }</div>
<div class="line"><span class="lineno">  541</span>                    }</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>                    <span class="comment">// it doesn&#39;t appear that OpenSSL versions were reported upon until PHP 5.3+</span></div>
<div class="line"><span class="lineno">  544</span>                    <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  545</span>                        <span class="keywordflow">case</span> !isset($versions[<span class="stringliteral">&#39;Header&#39;</span>]):</div>
<div class="line"><span class="lineno">  546</span>                        case !isset($versions[<span class="stringliteral">&#39;Library&#39;</span>]):</div>
<div class="line"><span class="lineno">  547</span>                        case $versions[<span class="stringliteral">&#39;Header&#39;</span>] == $versions[<span class="stringliteral">&#39;Library&#39;</span>]:</div>
<div class="line"><span class="lineno">  548</span>                        case version_compare($versions[<span class="stringliteral">&#39;Header&#39;</span>], <span class="stringliteral">&#39;1.0.0&#39;</span>) &gt;= 0 &amp;&amp; version_compare($versions[<span class="stringliteral">&#39;Library&#39;</span>], <span class="stringliteral">&#39;1.0.0&#39;</span>) &gt;= 0:</div>
<div class="line"><span class="lineno">  549</span>                            define(<span class="stringliteral">&#39;CRYPT_RSA_MODE&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#ab30d852541dea7311f2e48f2db6d179e">CRYPT_RSA_MODE_OPENSSL</a>);</div>
<div class="line"><span class="lineno">  550</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  551</span>                        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  552</span>                            define(<span class="stringliteral">&#39;CRYPT_RSA_MODE&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#a856c68b4ad5c3c071c9218b1520ba4a0">CRYPT_RSA_MODE_INTERNAL</a>);</div>
<div class="line"><span class="lineno">  553</span>                            define(<span class="stringliteral">&#39;MATH_BIGINTEGER_OPENSSL_DISABLE&#39;</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  554</span>                    }</div>
<div class="line"><span class="lineno">  555</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  556</span>                <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  557</span>                    define(<span class="stringliteral">&#39;CRYPT_RSA_MODE&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#a856c68b4ad5c3c071c9218b1520ba4a0">CRYPT_RSA_MODE_INTERNAL</a>);</div>
<div class="line"><span class="lineno">  558</span>            }</div>
<div class="line"><span class="lineno">  559</span>        }</div>
<div class="line"><span class="lineno">  560</span> </div>
<div class="line"><span class="lineno">  561</span>        $this-&gt;zero = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>();</div>
<div class="line"><span class="lineno">  562</span>        $this-&gt;one = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>(1);</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>        $this-&gt;hash = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__Hash.html">Crypt_Hash</a>(<span class="stringliteral">&#39;sha1&#39;</span>);</div>
<div class="line"><span class="lineno">  565</span>        $this-&gt;hLen = $this-&gt;hash-&gt;getLength();</div>
<div class="line"><span class="lineno">  566</span>        $this-&gt;hashName = <span class="stringliteral">&#39;sha1&#39;</span>;</div>
<div class="line"><span class="lineno">  567</span>        $this-&gt;mgfHash = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__Hash.html">Crypt_Hash</a>(<span class="stringliteral">&#39;sha1&#39;</span>);</div>
<div class="line"><span class="lineno">  568</span>        $this-&gt;mgfHLen = $this-&gt;mgfHash-&gt;getLength();</div>
<div class="line"><span class="lineno">  569</span>    }</div>
<div class="ttc" id="aRSA_8php_html_a856c68b4ad5c3c071c9218b1520ba4a0"><div class="ttname"><a href="RSA_8php.html#a856c68b4ad5c3c071c9218b1520ba4a0">CRYPT_RSA_MODE_INTERNAL</a></div><div class="ttdeci">const CRYPT_RSA_MODE_INTERNAL</div><div class="ttdoc">#-</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00176">RSA.php:176</a></div></div>
<div class="ttc" id="aRSA_8php_html_a8b2acab00f673ebc20fed2f1ecbb184b"><div class="ttname"><a href="RSA_8php.html#a8b2acab00f673ebc20fed2f1ecbb184b">CRYPT_RSA_OPENSSL_CONFIG</a></div><div class="ttdeci">const CRYPT_RSA_OPENSSL_CONFIG</div><div class="ttdoc">#-</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00188">RSA.php:188</a></div></div>
<div class="ttc" id="aRSA_8php_html_ab30d852541dea7311f2e48f2db6d179e"><div class="ttname"><a href="RSA_8php.html#ab30d852541dea7311f2e48f2db6d179e">CRYPT_RSA_MODE_OPENSSL</a></div><div class="ttdeci">const CRYPT_RSA_MODE_OPENSSL</div><div class="ttdoc">To use the OpenSSL library.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00182">RSA.php:182</a></div></div>
<div class="ttc" id="aconfigtest_8php_html_a3c1ade165b70ecbf36a71bc64671334a"><div class="ttname"><a href="configtest_8php.html#a3c1ade165b70ecbf36a71bc64671334a">PHP_VERSION</a></div><div class="ttdeci">print PHP_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="configtest_8php_source.html#l00041">configtest.php:41</a></div></div>
<div class="ttc" id="ainstall_8php_html_a1cf4c1ce4d54df11a660775bb7c5bbd8"><div class="ttname"><a href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a></div><div class="ttdeci">$VIEW_PATH</div><div class="ttdef"><b>Definition:</b> <a href="install_8php_source.html#l00039">install.php:39</a></div></div>
<div class="ttc" id="anamespaceCrypt__Hash_html"><div class="ttname"><a href="namespaceCrypt__Hash.html">Crypt_Hash</a></div><div class="ttdoc">#-</div></div>
<div class="ttc" id="anamespaceMath__BigInteger_html"><div class="ttname"><a href="namespaceMath__BigInteger.html">Math_BigInteger</a></div><div class="ttdoc">Pure-PHP arbitrary precision integer arithmetic library.</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="install_8php_source.html#l00039">$VIEW_PATH</a>, <a class="el" href="RSA_8php_source.html#l00176">CRYPT_RSA_MODE_INTERNAL</a>, <a class="el" href="RSA_8php_source.html#l00182">CRYPT_RSA_MODE_OPENSSL</a>, <a class="el" href="RSA_8php_source.html#l00188">CRYPT_RSA_OPENSSL_CONFIG</a>, and <a class="el" href="configtest_8php_source.html#l00041">PHP_VERSION</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l00577">Crypt_RSA()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a095c5d389db211932136b53f25f39685_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a095c5d389db211932136b53f25f39685_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a095c5d389db211932136b53f25f39685_icgraph" id="aclassCrypt__RSA_a095c5d389db211932136b53f25f39685_icgraph">
<area shape="rect" title="The constructor." alt="" coords="144,5,240,31"/>
<area shape="rect" href="classCrypt__RSA.html#a3ffaab04d34f40e24b7e2d265f2b7b9f" title="PHP4 compatible Default Constructor." alt="" coords="5,5,96,31"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ad0cb87b388bc74d63dc884accdca8713" name="ad0cb87b388bc74d63dc884accdca8713"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0cb87b388bc74d63dc884accdca8713">&#9670;&#160;</a></span>__clone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__clone </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>__clone() magic method </p>
<p>@access public </p><dl class="section return"><dt>Returns</dt><dd><a class="el" href="classCrypt__RSA.html">Crypt_RSA</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02098">2098</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2099</span>    {</div>
<div class="line"><span class="lineno"> 2100</span>        $key = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__RSA.html">Crypt_RSA</a>();</div>
<div class="line"><span class="lineno"> 2101</span>        $key-&gt;loadKey($this);</div>
<div class="line"><span class="lineno"> 2102</span>        <span class="keywordflow">return</span> $key;</div>
<div class="line"><span class="lineno"> 2103</span>    }</div>
<div class="ttc" id="anamespaceCrypt__RSA_html"><div class="ttname"><a href="namespaceCrypt__RSA.html">Crypt_RSA</a></div><div class="ttdoc">#-</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7516ca30af0db3cdbf9a7739b48ce91d" name="a7516ca30af0db3cdbf9a7739b48ce91d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7516ca30af0db3cdbf9a7739b48ce91d">&#9670;&#160;</a></span>__toString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__toString </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>__toString() magic method </p>
<p>@access public </p><dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02082">2082</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2083</span>    {</div>
<div class="line"><span class="lineno"> 2084</span>        $key = $this-&gt;getPrivateKey($this-&gt;privateKeyFormat);</div>
<div class="line"><span class="lineno"> 2085</span>        <span class="keywordflow">if</span> ($key !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2086</span>            <span class="keywordflow">return</span> $key;</div>
<div class="line"><span class="lineno"> 2087</span>        }</div>
<div class="line"><span class="lineno"> 2088</span>        $key = $this-&gt;_getPrivatePublicKey($this-&gt;publicKeyFormat);</div>
<div class="line"><span class="lineno"> 2089</span>        <span class="keywordflow">return</span> $key !== <span class="keyword">false</span> ? $key : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 2090</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02063">_getPrivatePublicKey()</a>, and <a class="el" href="RSA_8php_source.html#l02040">getPrivateKey()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a7516ca30af0db3cdbf9a7739b48ce91d_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a7516ca30af0db3cdbf9a7739b48ce91d_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a7516ca30af0db3cdbf9a7739b48ce91d_cgraph" id="aclassCrypt__RSA_a7516ca30af0db3cdbf9a7739b48ce91d_cgraph">
<area shape="rect" title="__toString() magic method" alt="" coords="5,31,92,56"/>
<area shape="rect" href="classCrypt__RSA.html#a8b1b2e0f348855a387167ec571c21371" title="Returns a minimalistic private key." alt="" coords="140,5,299,31"/>
<area shape="rect" href="classCrypt__RSA.html#a9220b3460a198b0e587361a34333a6e3" title="Returns the private key." alt="" coords="163,55,276,80"/>
<area shape="rect" href="classCrypt__RSA.html#a1ac38a64a86bc6963da281cf08c78d7a" title="Convert a public key to the appropriate format." alt="" coords="350,5,491,31"/>
<area shape="rect" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018" title="DER&#45;encode the length." alt="" coords="543,31,663,56"/>
<area shape="rect" href="classCrypt__RSA.html#a2bd18359bf21cecc783d2fde56b48045" title="Convert a private key to the appropriate format." alt="" coords="347,55,495,80"/>
</map>
</div>

</div>
</div>
<a id="a44ab71ffba98c8fe3172f8d2dc69e443" name="a44ab71ffba98c8fe3172f8d2dc69e443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44ab71ffba98c8fe3172f8d2dc69e443">&#9670;&#160;</a></span>_blind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_blind </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs RSA Blinding. </p>
<p>Protects against timing attacks by employing RSA Blinding. Returns $x-&gt;modPow($this-&gt;exponents[$i], $this-&gt;primes[$i])</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a></td><td class="paramname">$x</td><td></td></tr>
    <tr><td class="paramtype"><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a></td><td class="paramname">$r</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$i</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02414">2414</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2415</span>    {</div>
<div class="line"><span class="lineno"> 2416</span>        $x = $x-&gt;multiply(<a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>-&gt;modPow($this-&gt;publicExponent, $this-&gt;primes[$i]));</div>
<div class="line"><span class="lineno"> 2417</span>        $x = $x-&gt;modPow($this-&gt;exponents[$i], $this-&gt;primes[$i]);</div>
<div class="line"><span class="lineno"> 2418</span> </div>
<div class="line"><span class="lineno"> 2419</span>        <a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = <a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>-&gt;modInverse($this-&gt;primes[$i]);</div>
<div class="line"><span class="lineno"> 2420</span>        $x = $x-&gt;multiply(<a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>);</div>
<div class="line"><span class="lineno"> 2421</span>        list(, $x) = $x-&gt;divide($this-&gt;primes[$i]);</div>
<div class="line"><span class="lineno"> 2422</span> </div>
<div class="line"><span class="lineno"> 2423</span>        <span class="keywordflow">return</span> $x;</div>
<div class="line"><span class="lineno"> 2424</span>    }</div>
<div class="ttc" id="aconfigtest_8php_html_a8abe176bc41afd728f32ba8c506cbd98"><div class="ttname"><a href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a></div><div class="ttdeci">$r</div><div class="ttdef"><b>Definition:</b> <a href="configtest_8php_source.html#l00066">configtest.php:66</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="configtest_8php_source.html#l00066">$r</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l02328">_exponentiate()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a44ab71ffba98c8fe3172f8d2dc69e443_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a44ab71ffba98c8fe3172f8d2dc69e443_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a44ab71ffba98c8fe3172f8d2dc69e443_icgraph" id="aclassCrypt__RSA_a44ab71ffba98c8fe3172f8d2dc69e443_icgraph">
<area shape="rect" title="Performs RSA Blinding." alt="" coords="659,228,720,253"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="496,228,611,253"/>
<area shape="rect" href="classCrypt__RSA.html#ae7fd9226ba1559b8cfe7d42423021ee1" title="RSADP." alt="" coords="379,55,444,80"/>
<area shape="rect" href="classCrypt__RSA.html#a5157f032e713c0485ba64caebea03bd4" title="RSAEP." alt="" coords="379,179,444,204"/>
<area shape="rect" href="classCrypt__RSA.html#a812ed7b5c58b1d3281ca8263b0eb9c38" title="RSASP1." alt="" coords="375,252,447,277"/>
<area shape="rect" href="classCrypt__RSA.html#a2fe05e8ee49b3d3064c09ff852c3bf34" title="RSAVP1." alt="" coords="375,359,448,384"/>
<area shape="rect" href="classCrypt__RSA.html#ad7c3d5295c0bb7b4bcdaa30d17e3bac7" title="RSAES&#45;OAEP&#45;DECRYPT." alt="" coords="146,5,305,31"/>
<area shape="rect" href="classCrypt__RSA.html#a7171e1af643c02e2167394607a4f4c26" title="RSAES&#45;PKCS1&#45;V1_5&#45;DECRYPT." alt="" coords="124,55,327,80"/>
<area shape="rect" href="classCrypt__RSA.html#a5a4bf86d0bc8f236078fee29827dc683" title="Raw Encryption / Decryption." alt="" coords="171,104,280,129"/>
<area shape="rect" href="classCrypt__RSA.html#a43d2341a9ffbeadcf13400dbe48988cc" title="RSAES&#45;OAEP&#45;ENCRYPT." alt="" coords="146,153,305,179"/>
<area shape="rect" href="classCrypt__RSA.html#a47bed67c0d9c4ecc11da13e0ad3cddb0" title="RSAES&#45;PKCS1&#45;V1_5&#45;ENCRYPT." alt="" coords="124,203,327,228"/>
<area shape="rect" href="classCrypt__RSA.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encryption." alt="" coords="5,153,76,179"/>
<area shape="rect" href="classCrypt__RSA.html#a7919feaaf410567587520ae62d0f375a" title="RSASSA&#45;PKCS1&#45;V1_5&#45;SIGN." alt="" coords="131,252,319,277"/>
<area shape="rect" href="classCrypt__RSA.html#a41d7b44f4ff751df9dc5bc9a2e1a5875" title="RSASSA&#45;PSS&#45;SIGN." alt="" coords="158,301,293,327"/>
<area shape="rect" href="classCrypt__RSA.html#abe0890f90bae8c6cab81312df152652b" title="Create a signature." alt="" coords="16,277,65,303"/>
<area shape="rect" href="classCrypt__RSA.html#a9bac0d7f59f81a08f34e937e71fa4264" title="RSASSA&#45;PKCS1&#45;V1_5&#45;VERIFY." alt="" coords="148,351,303,391"/>
<area shape="rect" href="classCrypt__RSA.html#a14d4abcd8f2ca6604b948026e0c553ba" title="RSASSA&#45;PSS&#45;VERIFY." alt="" coords="153,416,297,441"/>
<area shape="rect" href="classCrypt__RSA.html#a91b3194ffeb55cb91eb28202ea8fe666" title="Verifies a signature." alt="" coords="11,387,70,412"/>
</map>
</div>

</div>
</div>
<a id="a2bd18359bf21cecc783d2fde56b48045" name="a2bd18359bf21cecc783d2fde56b48045"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bd18359bf21cecc783d2fde56b48045">&#9670;&#160;</a></span>_convertPrivateKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_convertPrivateKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$primes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$exponents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$coefficients</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a private key to the appropriate format. </p>
<p>@access private </p><dl class="section see"><dt>See also</dt><dd>self::setPrivateKeyFormat() </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a></td><td class="paramname">$n</td><td></td></tr>
    <tr><td class="paramtype"><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a></td><td class="paramname">$e</td><td></td></tr>
    <tr><td class="paramtype"><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a></td><td class="paramname">$d</td><td></td></tr>
    <tr><td class="paramtype"></td><td class="paramname">array&lt;int,Math_BigInteger&gt;</td><td>$primes </td></tr>
    <tr><td class="paramtype"></td><td class="paramname">array&lt;int,Math_BigInteger&gt;</td><td>$exponents </td></tr>
    <tr><td class="paramtype"></td><td class="paramname">array&lt;int,Math_BigInteger&gt;</td><td>$coefficients </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00781">781</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  782</span>    {</div>
<div class="line"><span class="lineno">  783</span>        global <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>;</div>
<div class="line"><span class="lineno">  784</span> </div>
<div class="line"><span class="lineno">  785</span>        $signed = $this-&gt;privateKeyFormat != <a class="code hl_variable" href="RSA_8php.html#a079b3a2b5b60dd742b6801f5fb426a8b">CRYPT_RSA_PRIVATE_FORMAT_XML</a>;</div>
<div class="line"><span class="lineno">  786</span>        $num_primes = count($primes);</div>
<div class="line"><span class="lineno">  787</span>        $raw = array(</div>
<div class="line"><span class="lineno">  788</span>            <span class="stringliteral">&#39;version&#39;</span> =&gt; $num_primes == 2 ? chr(0) : chr(1), <span class="comment">// two-prime vs. multi</span></div>
<div class="line"><span class="lineno">  789</span>            <span class="stringliteral">&#39;modulus&#39;</span> =&gt; $n-&gt;toBytes($signed),</div>
<div class="line"><span class="lineno">  790</span>            <span class="stringliteral">&#39;publicExponent&#39;</span> =&gt; $e-&gt;toBytes($signed),</div>
<div class="line"><span class="lineno">  791</span>            <span class="stringliteral">&#39;privateExponent&#39;</span> =&gt; $d-&gt;toBytes($signed),</div>
<div class="line"><span class="lineno">  792</span>            <span class="stringliteral">&#39;prime1&#39;</span> =&gt; $primes[1]-&gt;toBytes($signed),</div>
<div class="line"><span class="lineno">  793</span>            <span class="stringliteral">&#39;prime2&#39;</span> =&gt; $primes[2]-&gt;toBytes($signed),</div>
<div class="line"><span class="lineno">  794</span>            <span class="stringliteral">&#39;exponent1&#39;</span> =&gt; $exponents[1]-&gt;toBytes($signed),</div>
<div class="line"><span class="lineno">  795</span>            <span class="stringliteral">&#39;exponent2&#39;</span> =&gt; $exponents[2]-&gt;toBytes($signed),</div>
<div class="line"><span class="lineno">  796</span>            <span class="stringliteral">&#39;coefficient&#39;</span> =&gt; $coefficients[2]-&gt;toBytes($signed)</div>
<div class="line"><span class="lineno">  797</span>        );</div>
<div class="line"><span class="lineno">  798</span> </div>
<div class="line"><span class="lineno">  799</span>        <span class="comment">// if the format in question does not support multi-prime rsa and multi-prime rsa was used,</span></div>
<div class="line"><span class="lineno">  800</span>        <span class="comment">// call _convertPublicKey() instead.</span></div>
<div class="line"><span class="lineno">  801</span>        <span class="keywordflow">switch</span> ($this-&gt;privateKeyFormat) {</div>
<div class="line"><span class="lineno">  802</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#a079b3a2b5b60dd742b6801f5fb426a8b">CRYPT_RSA_PRIVATE_FORMAT_XML</a>:</div>
<div class="line"><span class="lineno">  803</span>                <span class="keywordflow">if</span> ($num_primes != 2) {</div>
<div class="line"><span class="lineno">  804</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  805</span>                }</div>
<div class="line"><span class="lineno">  806</span>                <span class="keywordflow">return</span> <span class="stringliteral">&quot;&lt;RSAKeyValue&gt;\r\n&quot;</span> .</div>
<div class="line"><span class="lineno">  807</span>                       <span class="stringliteral">&#39;  &lt;Modulus&gt;&#39;</span> . base64_encode($raw[<span class="stringliteral">&#39;modulus&#39;</span>]) . <span class="stringliteral">&quot;&lt;/Modulus&gt;\r\n&quot;</span> .</div>
<div class="line"><span class="lineno">  808</span>                       <span class="stringliteral">&#39;  &lt;Exponent&gt;&#39;</span> . base64_encode($raw[<span class="stringliteral">&#39;publicExponent&#39;</span>]) . <span class="stringliteral">&quot;&lt;/Exponent&gt;\r\n&quot;</span> .</div>
<div class="line"><span class="lineno">  809</span>                       <span class="stringliteral">&#39;  &lt;P&gt;&#39;</span> . base64_encode($raw[<span class="stringliteral">&#39;prime1&#39;</span>]) . <span class="stringliteral">&quot;&lt;/P&gt;\r\n&quot;</span> .</div>
<div class="line"><span class="lineno">  810</span>                       <span class="stringliteral">&#39;  &lt;Q&gt;&#39;</span> . base64_encode($raw[<span class="stringliteral">&#39;prime2&#39;</span>]) . <span class="stringliteral">&quot;&lt;/Q&gt;\r\n&quot;</span> .</div>
<div class="line"><span class="lineno">  811</span>                       <span class="stringliteral">&#39;  &lt;DP&gt;&#39;</span> . base64_encode($raw[<span class="stringliteral">&#39;exponent1&#39;</span>]) . <span class="stringliteral">&quot;&lt;/DP&gt;\r\n&quot;</span> .</div>
<div class="line"><span class="lineno">  812</span>                       <span class="stringliteral">&#39;  &lt;DQ&gt;&#39;</span> . base64_encode($raw[<span class="stringliteral">&#39;exponent2&#39;</span>]) . <span class="stringliteral">&quot;&lt;/DQ&gt;\r\n&quot;</span> .</div>
<div class="line"><span class="lineno">  813</span>                       <span class="stringliteral">&#39;  &lt;InverseQ&gt;&#39;</span> . base64_encode($raw[<span class="stringliteral">&#39;coefficient&#39;</span>]) . <span class="stringliteral">&quot;&lt;/InverseQ&gt;\r\n&quot;</span> .</div>
<div class="line"><span class="lineno">  814</span>                       <span class="stringliteral">&#39;  &lt;D&gt;&#39;</span> . base64_encode($raw[<span class="stringliteral">&#39;privateExponent&#39;</span>]) . <span class="stringliteral">&quot;&lt;/D&gt;\r\n&quot;</span> .</div>
<div class="line"><span class="lineno">  815</span>                       <span class="stringliteral">&#39;&lt;/RSAKeyValue&gt;&#39;</span>;</div>
<div class="line"><span class="lineno">  816</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  817</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#a20b24fa8e7681b564ff3085d4c1d5406">CRYPT_RSA_PRIVATE_FORMAT_PUTTY</a>:</div>
<div class="line"><span class="lineno">  818</span>                <span class="keywordflow">if</span> ($num_primes != 2) {</div>
<div class="line"><span class="lineno">  819</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  820</span>                }</div>
<div class="line"><span class="lineno">  821</span>                $key = <span class="stringliteral">&quot;PuTTY-User-Key-File-2: ssh-rsa\r\nEncryption: &quot;</span>;</div>
<div class="line"><span class="lineno">  822</span>                $encryption = (!empty($this-&gt;password) || is_string($this-&gt;password)) ? <span class="stringliteral">&#39;aes256-cbc&#39;</span> : <span class="stringliteral">&#39;none&#39;</span>;</div>
<div class="line"><span class="lineno">  823</span>                $key.= $encryption;</div>
<div class="line"><span class="lineno">  824</span>                $key.= <span class="stringliteral">&quot;\r\nComment: &quot;</span> . $this-&gt;comment . <span class="stringliteral">&quot;\r\n&quot;</span>;</div>
<div class="line"><span class="lineno">  825</span>                $public = pack(</div>
<div class="line"><span class="lineno">  826</span>                    <span class="stringliteral">&#39;Na*Na*Na*&#39;</span>,</div>
<div class="line"><span class="lineno">  827</span>                    strlen(<span class="stringliteral">&#39;ssh-rsa&#39;</span>),</div>
<div class="line"><span class="lineno">  828</span>                    <span class="stringliteral">&#39;ssh-rsa&#39;</span>,</div>
<div class="line"><span class="lineno">  829</span>                    strlen($raw[<span class="stringliteral">&#39;publicExponent&#39;</span>]),</div>
<div class="line"><span class="lineno">  830</span>                    $raw[<span class="stringliteral">&#39;publicExponent&#39;</span>],</div>
<div class="line"><span class="lineno">  831</span>                    strlen($raw[<span class="stringliteral">&#39;modulus&#39;</span>]),</div>
<div class="line"><span class="lineno">  832</span>                    $raw[<span class="stringliteral">&#39;modulus&#39;</span>]</div>
<div class="line"><span class="lineno">  833</span>                );</div>
<div class="line"><span class="lineno">  834</span>                $source = pack(</div>
<div class="line"><span class="lineno">  835</span>                    <span class="stringliteral">&#39;Na*Na*Na*Na*&#39;</span>,</div>
<div class="line"><span class="lineno">  836</span>                    strlen(<span class="stringliteral">&#39;ssh-rsa&#39;</span>),</div>
<div class="line"><span class="lineno">  837</span>                    <span class="stringliteral">&#39;ssh-rsa&#39;</span>,</div>
<div class="line"><span class="lineno">  838</span>                    strlen($encryption),</div>
<div class="line"><span class="lineno">  839</span>                    $encryption,</div>
<div class="line"><span class="lineno">  840</span>                    strlen($this-&gt;comment),</div>
<div class="line"><span class="lineno">  841</span>                    $this-&gt;comment,</div>
<div class="line"><span class="lineno">  842</span>                    strlen($public),</div>
<div class="line"><span class="lineno">  843</span>                    $public</div>
<div class="line"><span class="lineno">  844</span>                );</div>
<div class="line"><span class="lineno">  845</span>                $public = base64_encode($public);</div>
<div class="line"><span class="lineno">  846</span>                $key.= <span class="stringliteral">&quot;Public-Lines: &quot;</span> . ((strlen($public) + 63) &gt;&gt; 6) . <span class="stringliteral">&quot;\r\n&quot;</span>;</div>
<div class="line"><span class="lineno">  847</span>                $key.= chunk_split($public, 64);</div>
<div class="line"><span class="lineno">  848</span>                $private = pack(</div>
<div class="line"><span class="lineno">  849</span>                    <span class="stringliteral">&#39;Na*Na*Na*Na*&#39;</span>,</div>
<div class="line"><span class="lineno">  850</span>                    strlen($raw[<span class="stringliteral">&#39;privateExponent&#39;</span>]),</div>
<div class="line"><span class="lineno">  851</span>                    $raw[<span class="stringliteral">&#39;privateExponent&#39;</span>],</div>
<div class="line"><span class="lineno">  852</span>                    strlen($raw[<span class="stringliteral">&#39;prime1&#39;</span>]),</div>
<div class="line"><span class="lineno">  853</span>                    $raw[<span class="stringliteral">&#39;prime1&#39;</span>],</div>
<div class="line"><span class="lineno">  854</span>                    strlen($raw[<span class="stringliteral">&#39;prime2&#39;</span>]),</div>
<div class="line"><span class="lineno">  855</span>                    $raw[<span class="stringliteral">&#39;prime2&#39;</span>],</div>
<div class="line"><span class="lineno">  856</span>                    strlen($raw[<span class="stringliteral">&#39;coefficient&#39;</span>]),</div>
<div class="line"><span class="lineno">  857</span>                    $raw[<span class="stringliteral">&#39;coefficient&#39;</span>]</div>
<div class="line"><span class="lineno">  858</span>                );</div>
<div class="line"><span class="lineno">  859</span>                <span class="keywordflow">if</span> (empty($this-&gt;password) &amp;&amp; !is_string($this-&gt;password)) {</div>
<div class="line"><span class="lineno">  860</span>                    $source.= pack(<span class="stringliteral">&#39;Na*&#39;</span>, strlen($private), $private);</div>
<div class="line"><span class="lineno">  861</span>                    $hashkey = <span class="stringliteral">&#39;putty-private-key-file-mac-key&#39;</span>;</div>
<div class="line"><span class="lineno">  862</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  863</span>                    $private.= crypt_random_string(16 - (strlen($private) &amp; 15));</div>
<div class="line"><span class="lineno">  864</span>                    $source.= pack(<span class="stringliteral">&#39;Na*&#39;</span>, strlen($private), $private);</div>
<div class="line"><span class="lineno">  865</span>                    <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_AES&#39;</span>)) {</div>
<div class="line"><span class="lineno">  866</span>                        include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/AES.php&#39;</span>;</div>
<div class="line"><span class="lineno">  867</span>                    }</div>
<div class="line"><span class="lineno">  868</span>                    $sequence = 0;</div>
<div class="line"><span class="lineno">  869</span>                    $symkey = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  870</span>                    <span class="keywordflow">while</span> (strlen($symkey) &lt; 32) {</div>
<div class="line"><span class="lineno">  871</span>                        $temp = pack(<span class="stringliteral">&#39;Na*&#39;</span>, $sequence++, $this-&gt;password);</div>
<div class="line"><span class="lineno">  872</span>                        $symkey.= pack(<span class="stringliteral">&#39;H*&#39;</span>, sha1($temp));</div>
<div class="line"><span class="lineno">  873</span>                    }</div>
<div class="line"><span class="lineno">  874</span>                    $symkey = substr($symkey, 0, 32);</div>
<div class="line"><span class="lineno">  875</span>                    $crypto = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__AES.html">Crypt_AES</a>();</div>
<div class="line"><span class="lineno">  876</span> </div>
<div class="line"><span class="lineno">  877</span>                    $crypto-&gt;setKey($symkey);</div>
<div class="line"><span class="lineno">  878</span>                    $crypto-&gt;disablePadding();</div>
<div class="line"><span class="lineno">  879</span>                    $private = $crypto-&gt;encrypt($private);</div>
<div class="line"><span class="lineno">  880</span>                    $hashkey = <span class="stringliteral">&#39;putty-private-key-file-mac-key&#39;</span> . $this-&gt;password;</div>
<div class="line"><span class="lineno">  881</span>                }</div>
<div class="line"><span class="lineno">  882</span> </div>
<div class="line"><span class="lineno">  883</span>                $private = base64_encode($private);</div>
<div class="line"><span class="lineno">  884</span>                $key.= <span class="stringliteral">&#39;Private-Lines: &#39;</span> . ((strlen($private) + 63) &gt;&gt; 6) . <span class="stringliteral">&quot;\r\n&quot;</span>;</div>
<div class="line"><span class="lineno">  885</span>                $key.= chunk_split($private, 64);</div>
<div class="line"><span class="lineno">  886</span>                <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_Hash&#39;</span>)) {</div>
<div class="line"><span class="lineno">  887</span>                    include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/Hash.php&#39;</span>;</div>
<div class="line"><span class="lineno">  888</span>                }</div>
<div class="line"><span class="lineno">  889</span>                <a class="code hl_variable" href="classCrypt__RSA.html#ac9fdf6f2c8fb45c1d3bb9a176802b2ad">$hash</a> = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__Hash.html">Crypt_Hash</a>(<span class="stringliteral">&#39;sha1&#39;</span>);</div>
<div class="line"><span class="lineno">  890</span>                <a class="code hl_variable" href="classCrypt__RSA.html#ac9fdf6f2c8fb45c1d3bb9a176802b2ad">$hash</a>-&gt;setKey(pack(<span class="stringliteral">&#39;H*&#39;</span>, sha1($hashkey)));</div>
<div class="line"><span class="lineno">  891</span>                $key.= <span class="stringliteral">&#39;Private-MAC: &#39;</span> . bin2hex(<a class="code hl_variable" href="classCrypt__RSA.html#ac9fdf6f2c8fb45c1d3bb9a176802b2ad">$hash</a>-&gt;hash($source)) . <span class="stringliteral">&quot;\r\n&quot;</span>;</div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span>                <span class="keywordflow">return</span> $key;</div>
<div class="line"><span class="lineno">  894</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#aa33af2fe22ee3914635fe1e74bb3f8cf">CRYPT_RSA_PRIVATE_FORMAT_OPENSSH</a>:</div>
<div class="line"><span class="lineno">  895</span>                <span class="keywordflow">if</span> ($num_primes != 2) {</div>
<div class="line"><span class="lineno">  896</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  897</span>                }</div>
<div class="line"><span class="lineno">  898</span>                $publicKey = pack(<span class="stringliteral">&#39;Na*Na*Na*&#39;</span>, strlen(<span class="stringliteral">&#39;ssh-rsa&#39;</span>), <span class="stringliteral">&#39;ssh-rsa&#39;</span>, strlen($raw[<span class="stringliteral">&#39;publicExponent&#39;</span>]), $raw[<span class="stringliteral">&#39;publicExponent&#39;</span>], strlen($raw[<span class="stringliteral">&#39;modulus&#39;</span>]), $raw[<span class="stringliteral">&#39;modulus&#39;</span>]);</div>
<div class="line"><span class="lineno">  899</span>                $privateKey = pack(</div>
<div class="line"><span class="lineno">  900</span>                    <span class="stringliteral">&#39;Na*Na*Na*Na*Na*Na*Na*&#39;</span>,</div>
<div class="line"><span class="lineno">  901</span>                    strlen(<span class="stringliteral">&#39;ssh-rsa&#39;</span>),</div>
<div class="line"><span class="lineno">  902</span>                    <span class="stringliteral">&#39;ssh-rsa&#39;</span>,</div>
<div class="line"><span class="lineno">  903</span>                    strlen($raw[<span class="stringliteral">&#39;modulus&#39;</span>]),</div>
<div class="line"><span class="lineno">  904</span>                    $raw[<span class="stringliteral">&#39;modulus&#39;</span>],</div>
<div class="line"><span class="lineno">  905</span>                    strlen($raw[<span class="stringliteral">&#39;publicExponent&#39;</span>]),</div>
<div class="line"><span class="lineno">  906</span>                    $raw[<span class="stringliteral">&#39;publicExponent&#39;</span>],</div>
<div class="line"><span class="lineno">  907</span>                    strlen($raw[<span class="stringliteral">&#39;privateExponent&#39;</span>]),</div>
<div class="line"><span class="lineno">  908</span>                    $raw[<span class="stringliteral">&#39;privateExponent&#39;</span>],</div>
<div class="line"><span class="lineno">  909</span>                    strlen($raw[<span class="stringliteral">&#39;coefficient&#39;</span>]),</div>
<div class="line"><span class="lineno">  910</span>                    $raw[<span class="stringliteral">&#39;coefficient&#39;</span>],</div>
<div class="line"><span class="lineno">  911</span>                    strlen($raw[<span class="stringliteral">&#39;prime1&#39;</span>]),</div>
<div class="line"><span class="lineno">  912</span>                    $raw[<span class="stringliteral">&#39;prime1&#39;</span>],</div>
<div class="line"><span class="lineno">  913</span>                    strlen($raw[<span class="stringliteral">&#39;prime2&#39;</span>]),</div>
<div class="line"><span class="lineno">  914</span>                    $raw[<span class="stringliteral">&#39;prime2&#39;</span>]</div>
<div class="line"><span class="lineno">  915</span>                );</div>
<div class="line"><span class="lineno">  916</span>                $checkint = crypt_random_string(4);</div>
<div class="line"><span class="lineno">  917</span>                $paddedKey = pack(</div>
<div class="line"><span class="lineno">  918</span>                    <span class="stringliteral">&#39;a*Na*&#39;</span>,</div>
<div class="line"><span class="lineno">  919</span>                    $checkint . $checkint . $privateKey,</div>
<div class="line"><span class="lineno">  920</span>                    strlen($this-&gt;comment),</div>
<div class="line"><span class="lineno">  921</span>                    $this-&gt;comment</div>
<div class="line"><span class="lineno">  922</span>                );</div>
<div class="line"><span class="lineno">  923</span>                $paddingLength = (7 * strlen($paddedKey)) % 8;</div>
<div class="line"><span class="lineno">  924</span>                <span class="keywordflow">for</span> ($i = 1; $i &lt;= $paddingLength; $i++) {</div>
<div class="line"><span class="lineno">  925</span>                    $paddedKey.= chr($i);</div>
<div class="line"><span class="lineno">  926</span>                }</div>
<div class="line"><span class="lineno">  927</span>                $key = pack(</div>
<div class="line"><span class="lineno">  928</span>                    <span class="stringliteral">&#39;Na*Na*Na*NNa*Na*&#39;</span>,</div>
<div class="line"><span class="lineno">  929</span>                    strlen(<span class="stringliteral">&#39;none&#39;</span>),</div>
<div class="line"><span class="lineno">  930</span>                    <span class="stringliteral">&#39;none&#39;</span>,</div>
<div class="line"><span class="lineno">  931</span>                    strlen(<span class="stringliteral">&#39;none&#39;</span>),</div>
<div class="line"><span class="lineno">  932</span>                    <span class="stringliteral">&#39;none&#39;</span>,</div>
<div class="line"><span class="lineno">  933</span>                    0,</div>
<div class="line"><span class="lineno">  934</span>                    <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line"><span class="lineno">  935</span>                    1,</div>
<div class="line"><span class="lineno">  936</span>                    strlen($publicKey),</div>
<div class="line"><span class="lineno">  937</span>                    $publicKey,</div>
<div class="line"><span class="lineno">  938</span>                    strlen($paddedKey),</div>
<div class="line"><span class="lineno">  939</span>                    $paddedKey</div>
<div class="line"><span class="lineno">  940</span>                );</div>
<div class="line"><span class="lineno">  941</span>                $key = <span class="stringliteral">&quot;openssh-key-v1\0$key&quot;</span>;</div>
<div class="line"><span class="lineno">  942</span> </div>
<div class="line"><span class="lineno">  943</span>                <span class="keywordflow">return</span> <span class="stringliteral">&quot;-----BEGIN OPENSSH PRIVATE KEY-----\n&quot;</span> .</div>
<div class="line"><span class="lineno">  944</span>                       chunk_split(base64_encode($key), 70, <span class="stringliteral">&quot;\n&quot;</span>) .</div>
<div class="line"><span class="lineno">  945</span>                       <span class="stringliteral">&quot;-----END OPENSSH PRIVATE KEY-----\n&quot;</span>;</div>
<div class="line"><span class="lineno">  946</span>            <span class="keywordflow">default</span>: <span class="comment">// eg. CRYPT_RSA_PRIVATE_FORMAT_PKCS1</span></div>
<div class="line"><span class="lineno">  947</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a> = array();</div>
<div class="line"><span class="lineno">  948</span>                <span class="keywordflow">foreach</span> ($raw as $name =&gt; $value) {</div>
<div class="line"><span class="lineno">  949</span>                    <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[$name] = pack(<span class="stringliteral">&#39;Ca*a*&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#a4da67fb1e37ca9dc84a0a8b54707b76a">CRYPT_RSA_ASN1_INTEGER</a>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($value)), $value);</div>
<div class="line"><span class="lineno">  950</span>                }</div>
<div class="line"><span class="lineno">  951</span> </div>
<div class="line"><span class="lineno">  952</span>                $RSAPrivateKey = implode(<span class="stringliteral">&#39;&#39;</span>, $components);</div>
<div class="line"><span class="lineno">  953</span> </div>
<div class="line"><span class="lineno">  954</span>                <span class="keywordflow">if</span> ($num_primes &gt; 2) {</div>
<div class="line"><span class="lineno">  955</span>                    $OtherPrimeInfos = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  956</span>                    <span class="keywordflow">for</span> ($i = 3; $i &lt;= $num_primes; $i++) {</div>
<div class="line"><span class="lineno">  957</span>                        <span class="comment">// OtherPrimeInfos ::= SEQUENCE SIZE(1..MAX) OF OtherPrimeInfo</span></div>
<div class="line"><span class="lineno">  958</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  959</span>                        <span class="comment">// OtherPrimeInfo ::= SEQUENCE {</span></div>
<div class="line"><span class="lineno">  960</span>                        <span class="comment">//     prime             INTEGER,  -- ri</span></div>
<div class="line"><span class="lineno">  961</span>                        <span class="comment">//     exponent          INTEGER,  -- di</span></div>
<div class="line"><span class="lineno">  962</span>                        <span class="comment">//     coefficient       INTEGER   -- ti</span></div>
<div class="line"><span class="lineno">  963</span>                        <span class="comment">// }</span></div>
<div class="line"><span class="lineno">  964</span>                        $OtherPrimeInfo = pack(<span class="stringliteral">&#39;Ca*a*&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#a4da67fb1e37ca9dc84a0a8b54707b76a">CRYPT_RSA_ASN1_INTEGER</a>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($primes[$i]-&gt;toBytes(<span class="keyword">true</span>))), $primes[$i]-&gt;toBytes(<span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">  965</span>                        $OtherPrimeInfo.= pack(<span class="stringliteral">&#39;Ca*a*&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#a4da67fb1e37ca9dc84a0a8b54707b76a">CRYPT_RSA_ASN1_INTEGER</a>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($exponents[$i]-&gt;toBytes(<span class="keyword">true</span>))), $exponents[$i]-&gt;toBytes(<span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">  966</span>                        $OtherPrimeInfo.= pack(<span class="stringliteral">&#39;Ca*a*&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#a4da67fb1e37ca9dc84a0a8b54707b76a">CRYPT_RSA_ASN1_INTEGER</a>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($coefficients[$i]-&gt;toBytes(<span class="keyword">true</span>))), $coefficients[$i]-&gt;toBytes(<span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">  967</span>                        $OtherPrimeInfos.= pack(<span class="stringliteral">&#39;Ca*a*&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($OtherPrimeInfo)), $OtherPrimeInfo);</div>
<div class="line"><span class="lineno">  968</span>                    }</div>
<div class="line"><span class="lineno">  969</span>                    $RSAPrivateKey.= pack(<span class="stringliteral">&#39;Ca*a*&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($OtherPrimeInfos)), $OtherPrimeInfos);</div>
<div class="line"><span class="lineno">  970</span>                }</div>
<div class="line"><span class="lineno">  971</span> </div>
<div class="line"><span class="lineno">  972</span>                $RSAPrivateKey = pack(<span class="stringliteral">&#39;Ca*a*&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($RSAPrivateKey)), $RSAPrivateKey);</div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>                <span class="keywordflow">if</span> ($this-&gt;privateKeyFormat == <a class="code hl_variable" href="RSA_8php.html#a52ff67a766f547b0fd9d895b57253789">CRYPT_RSA_PRIVATE_FORMAT_PKCS8</a>) {</div>
<div class="line"><span class="lineno">  975</span>                    $rsaOID = pack(<span class="stringliteral">&#39;H*&#39;</span>, <span class="stringliteral">&#39;300d06092a864886f70d0101010500&#39;</span>); <span class="comment">// hex version of MA0GCSqGSIb3DQEBAQUA</span></div>
<div class="line"><span class="lineno">  976</span>                    $RSAPrivateKey = pack(</div>
<div class="line"><span class="lineno">  977</span>                        <span class="stringliteral">&#39;Ca*a*Ca*a*&#39;</span>,</div>
<div class="line"><span class="lineno">  978</span>                        <a class="code hl_variable" href="RSA_8php.html#a4da67fb1e37ca9dc84a0a8b54707b76a">CRYPT_RSA_ASN1_INTEGER</a>,</div>
<div class="line"><span class="lineno">  979</span>                        <span class="stringliteral">&quot;\01\00&quot;</span>,</div>
<div class="line"><span class="lineno">  980</span>                        $rsaOID,</div>
<div class="line"><span class="lineno">  981</span>                        4,</div>
<div class="line"><span class="lineno">  982</span>                        $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($RSAPrivateKey)),</div>
<div class="line"><span class="lineno">  983</span>                        $RSAPrivateKey</div>
<div class="line"><span class="lineno">  984</span>                    );</div>
<div class="line"><span class="lineno">  985</span>                    $RSAPrivateKey = pack(<span class="stringliteral">&#39;Ca*a*&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($RSAPrivateKey)), $RSAPrivateKey);</div>
<div class="line"><span class="lineno">  986</span>                    <span class="keywordflow">if</span> (!empty($this-&gt;password) || is_string($this-&gt;password)) {</div>
<div class="line"><span class="lineno">  987</span>                        $salt = crypt_random_string(8);</div>
<div class="line"><span class="lineno">  988</span>                        $iterationCount = 2048;</div>
<div class="line"><span class="lineno">  989</span> </div>
<div class="line"><span class="lineno">  990</span>                        <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_DES&#39;</span>)) {</div>
<div class="line"><span class="lineno">  991</span>                            include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/DES.php&#39;</span>;</div>
<div class="line"><span class="lineno">  992</span>                        }</div>
<div class="line"><span class="lineno">  993</span>                        $crypto = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__DES.html">Crypt_DES</a>();</div>
<div class="line"><span class="lineno">  994</span>                        $crypto-&gt;setPassword($this-&gt;password, <span class="stringliteral">&#39;pbkdf1&#39;</span>, <span class="stringliteral">&#39;md5&#39;</span>, $salt, $iterationCount);</div>
<div class="line"><span class="lineno">  995</span>                        $RSAPrivateKey = $crypto-&gt;encrypt($RSAPrivateKey);</div>
<div class="line"><span class="lineno">  996</span> </div>
<div class="line"><span class="lineno">  997</span>                        $parameters = pack(</div>
<div class="line"><span class="lineno">  998</span>                            <span class="stringliteral">&#39;Ca*a*Ca*N&#39;</span>,</div>
<div class="line"><span class="lineno">  999</span>                            <a class="code hl_variable" href="RSA_8php.html#a6738c0ed84daf614510fd20bb0b75a1b">CRYPT_RSA_ASN1_OCTETSTRING</a>,</div>
<div class="line"><span class="lineno"> 1000</span>                            $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($salt)),</div>
<div class="line"><span class="lineno"> 1001</span>                            $salt,</div>
<div class="line"><span class="lineno"> 1002</span>                            <a class="code hl_variable" href="RSA_8php.html#a4da67fb1e37ca9dc84a0a8b54707b76a">CRYPT_RSA_ASN1_INTEGER</a>,</div>
<div class="line"><span class="lineno"> 1003</span>                            $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(4),</div>
<div class="line"><span class="lineno"> 1004</span>                            $iterationCount</div>
<div class="line"><span class="lineno"> 1005</span>                        );</div>
<div class="line"><span class="lineno"> 1006</span>                        $pbeWithMD5AndDES_CBC = <span class="stringliteral">&quot;\x2a\x86\x48\x86\xf7\x0d\x01\x05\x03&quot;</span>;</div>
<div class="line"><span class="lineno"> 1007</span> </div>
<div class="line"><span class="lineno"> 1008</span>                        $encryptionAlgorithm = pack(</div>
<div class="line"><span class="lineno"> 1009</span>                            <span class="stringliteral">&#39;Ca*a*Ca*a*&#39;</span>,</div>
<div class="line"><span class="lineno"> 1010</span>                            <a class="code hl_variable" href="RSA_8php.html#ab9ee890fc2ddebc146db7e951b871cc0">CRYPT_RSA_ASN1_OBJECT</a>,</div>
<div class="line"><span class="lineno"> 1011</span>                            $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($pbeWithMD5AndDES_CBC)),</div>
<div class="line"><span class="lineno"> 1012</span>                            $pbeWithMD5AndDES_CBC,</div>
<div class="line"><span class="lineno"> 1013</span>                            <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1014</span>                            $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($parameters)),</div>
<div class="line"><span class="lineno"> 1015</span>                            $parameters</div>
<div class="line"><span class="lineno"> 1016</span>                        );</div>
<div class="line"><span class="lineno"> 1017</span> </div>
<div class="line"><span class="lineno"> 1018</span>                        $RSAPrivateKey = pack(</div>
<div class="line"><span class="lineno"> 1019</span>                            <span class="stringliteral">&#39;Ca*a*Ca*a*&#39;</span>,</div>
<div class="line"><span class="lineno"> 1020</span>                            <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1021</span>                            $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($encryptionAlgorithm)),</div>
<div class="line"><span class="lineno"> 1022</span>                            $encryptionAlgorithm,</div>
<div class="line"><span class="lineno"> 1023</span>                            <a class="code hl_variable" href="RSA_8php.html#a6738c0ed84daf614510fd20bb0b75a1b">CRYPT_RSA_ASN1_OCTETSTRING</a>,</div>
<div class="line"><span class="lineno"> 1024</span>                            $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($RSAPrivateKey)),</div>
<div class="line"><span class="lineno"> 1025</span>                            $RSAPrivateKey</div>
<div class="line"><span class="lineno"> 1026</span>                        );</div>
<div class="line"><span class="lineno"> 1027</span> </div>
<div class="line"><span class="lineno"> 1028</span>                        $RSAPrivateKey = pack(<span class="stringliteral">&#39;Ca*a*&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($RSAPrivateKey)), $RSAPrivateKey);</div>
<div class="line"><span class="lineno"> 1029</span> </div>
<div class="line"><span class="lineno"> 1030</span>                        $RSAPrivateKey = <span class="stringliteral">&quot;-----BEGIN ENCRYPTED PRIVATE KEY-----\r\n&quot;</span> .</div>
<div class="line"><span class="lineno"> 1031</span>                                         chunk_split(base64_encode($RSAPrivateKey), 64) .</div>
<div class="line"><span class="lineno"> 1032</span>                                         <span class="stringliteral">&#39;-----END ENCRYPTED PRIVATE KEY-----&#39;</span>;</div>
<div class="line"><span class="lineno"> 1033</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1034</span>                        $RSAPrivateKey = <span class="stringliteral">&quot;-----BEGIN PRIVATE KEY-----\r\n&quot;</span> .</div>
<div class="line"><span class="lineno"> 1035</span>                                         chunk_split(base64_encode($RSAPrivateKey), 64) .</div>
<div class="line"><span class="lineno"> 1036</span>                                         <span class="stringliteral">&#39;-----END PRIVATE KEY-----&#39;</span>;</div>
<div class="line"><span class="lineno"> 1037</span>                    }</div>
<div class="line"><span class="lineno"> 1038</span>                    <span class="keywordflow">return</span> $RSAPrivateKey;</div>
<div class="line"><span class="lineno"> 1039</span>                }</div>
<div class="line"><span class="lineno"> 1040</span> </div>
<div class="line"><span class="lineno"> 1041</span>                <span class="keywordflow">if</span> (!empty($this-&gt;password) || is_string($this-&gt;password)) {</div>
<div class="line"><span class="lineno"> 1042</span>                    $iv = crypt_random_string(8);</div>
<div class="line"><span class="lineno"> 1043</span>                    $symkey = pack(<span class="stringliteral">&#39;H*&#39;</span>, md5($this-&gt;password . $iv)); <span class="comment">// symkey is short for symmetric key</span></div>
<div class="line"><span class="lineno"> 1044</span>                    $symkey.= substr(pack(<span class="stringliteral">&#39;H*&#39;</span>, md5($symkey . $this-&gt;password . $iv)), 0, 8);</div>
<div class="line"><span class="lineno"> 1045</span>                    <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_TripleDES&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 1046</span>                        include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/TripleDES.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 1047</span>                    }</div>
<div class="line"><span class="lineno"> 1048</span>                    $des = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__TripleDES.html">Crypt_TripleDES</a>();</div>
<div class="line"><span class="lineno"> 1049</span>                    $des-&gt;setKey($symkey);</div>
<div class="line"><span class="lineno"> 1050</span>                    $des-&gt;setIV($iv);</div>
<div class="line"><span class="lineno"> 1051</span>                    $iv = strtoupper(bin2hex($iv));</div>
<div class="line"><span class="lineno"> 1052</span>                    $RSAPrivateKey = <span class="stringliteral">&quot;-----BEGIN RSA PRIVATE KEY-----\r\n&quot;</span> .</div>
<div class="line"><span class="lineno"> 1053</span>                                     <span class="stringliteral">&quot;Proc-Type: 4,ENCRYPTED\r\n&quot;</span> .</div>
<div class="line"><span class="lineno"> 1054</span>                                     <span class="stringliteral">&quot;DEK-Info: DES-EDE3-CBC,$iv\r\n&quot;</span> .</div>
<div class="line"><span class="lineno"> 1055</span>                                     <span class="stringliteral">&quot;\r\n&quot;</span> .</div>
<div class="line"><span class="lineno"> 1056</span>                                     chunk_split(base64_encode($des-&gt;encrypt($RSAPrivateKey)), 64) .</div>
<div class="line"><span class="lineno"> 1057</span>                                     <span class="stringliteral">&#39;-----END RSA PRIVATE KEY-----&#39;</span>;</div>
<div class="line"><span class="lineno"> 1058</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1059</span>                    $RSAPrivateKey = <span class="stringliteral">&quot;-----BEGIN RSA PRIVATE KEY-----\r\n&quot;</span> .</div>
<div class="line"><span class="lineno"> 1060</span>                                     chunk_split(base64_encode($RSAPrivateKey), 64) .</div>
<div class="line"><span class="lineno"> 1061</span>                                     <span class="stringliteral">&#39;-----END RSA PRIVATE KEY-----&#39;</span>;</div>
<div class="line"><span class="lineno"> 1062</span>                }</div>
<div class="line"><span class="lineno"> 1063</span> </div>
<div class="line"><span class="lineno"> 1064</span>                <span class="keywordflow">return</span> $RSAPrivateKey;</div>
<div class="line"><span class="lineno"> 1065</span>        }</div>
<div class="line"><span class="lineno"> 1066</span>    }</div>
<div class="ttc" id="aRSA_8php_html_a079b3a2b5b60dd742b6801f5fb426a8b"><div class="ttname"><a href="RSA_8php.html#a079b3a2b5b60dd742b6801f5fb426a8b">CRYPT_RSA_PRIVATE_FORMAT_XML</a></div><div class="ttdeci">const CRYPT_RSA_PRIVATE_FORMAT_XML</div><div class="ttdoc">XML formatted private key.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00208">RSA.php:208</a></div></div>
<div class="ttc" id="aRSA_8php_html_a20b24fa8e7681b564ff3085d4c1d5406"><div class="ttname"><a href="RSA_8php.html#a20b24fa8e7681b564ff3085d4c1d5406">CRYPT_RSA_PRIVATE_FORMAT_PUTTY</a></div><div class="ttdeci">const CRYPT_RSA_PRIVATE_FORMAT_PUTTY</div><div class="ttdoc">PuTTY formatted private key.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00204">RSA.php:204</a></div></div>
<div class="ttc" id="aRSA_8php_html_a4da67fb1e37ca9dc84a0a8b54707b76a"><div class="ttname"><a href="RSA_8php.html#a4da67fb1e37ca9dc84a0a8b54707b76a">CRYPT_RSA_ASN1_INTEGER</a></div><div class="ttdeci">const CRYPT_RSA_ASN1_INTEGER</div><div class="ttdoc">#-</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00150">RSA.php:150</a></div></div>
<div class="ttc" id="aRSA_8php_html_a52ff67a766f547b0fd9d895b57253789"><div class="ttname"><a href="RSA_8php.html#a52ff67a766f547b0fd9d895b57253789">CRYPT_RSA_PRIVATE_FORMAT_PKCS8</a></div><div class="ttdeci">const CRYPT_RSA_PRIVATE_FORMAT_PKCS8</div><div class="ttdoc">PKCS#8 formatted private key.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00212">RSA.php:212</a></div></div>
<div class="ttc" id="aRSA_8php_html_a6738c0ed84daf614510fd20bb0b75a1b"><div class="ttname"><a href="RSA_8php.html#a6738c0ed84daf614510fd20bb0b75a1b">CRYPT_RSA_ASN1_OCTETSTRING</a></div><div class="ttdeci">const CRYPT_RSA_ASN1_OCTETSTRING</div><div class="ttdoc">ASN1 Octet String.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00158">RSA.php:158</a></div></div>
<div class="ttc" id="aRSA_8php_html_a9806a4116e85771b38ccbe23b0ede937"><div class="ttname"><a href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a></div><div class="ttdeci">const CRYPT_RSA_ASN1_SEQUENCE</div><div class="ttdoc">ASN1 Sequence (with the constucted bit set)</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00166">RSA.php:166</a></div></div>
<div class="ttc" id="aRSA_8php_html_aa33af2fe22ee3914635fe1e74bb3f8cf"><div class="ttname"><a href="RSA_8php.html#aa33af2fe22ee3914635fe1e74bb3f8cf">CRYPT_RSA_PRIVATE_FORMAT_OPENSSH</a></div><div class="ttdeci">const CRYPT_RSA_PRIVATE_FORMAT_OPENSSH</div><div class="ttdoc">OpenSSH formatted private key.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00216">RSA.php:216</a></div></div>
<div class="ttc" id="aRSA_8php_html_ab9ee890fc2ddebc146db7e951b871cc0"><div class="ttname"><a href="RSA_8php.html#ab9ee890fc2ddebc146db7e951b871cc0">CRYPT_RSA_ASN1_OBJECT</a></div><div class="ttdeci">const CRYPT_RSA_ASN1_OBJECT</div><div class="ttdoc">ASN1 Object Identifier.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00162">RSA.php:162</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_a2409c247baf67a1d4c6b9a1789cfc088"><div class="ttname"><a href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">Crypt_RSA\$components</a></div><div class="ttdeci">$components</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00456">RSA.php:456</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_ab9967d86f5c5bdf50e4bc80cf1a9c018"><div class="ttname"><a href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">Crypt_RSA\_encodeLength</a></div><div class="ttdeci">_encodeLength($length)</div><div class="ttdoc">DER-encode the length.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l02162">RSA.php:2162</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_ac9fdf6f2c8fb45c1d3bb9a176802b2ad"><div class="ttname"><a href="classCrypt__RSA.html#ac9fdf6f2c8fb45c1d3bb9a176802b2ad">Crypt_RSA\$hash</a></div><div class="ttdeci">$hash</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00380">RSA.php:380</a></div></div>
<div class="ttc" id="anamespaceCrypt__AES_html"><div class="ttname"><a href="namespaceCrypt__AES.html">Crypt_AES</a></div><div class="ttdoc">#-</div></div>
<div class="ttc" id="anamespaceCrypt__DES_html"><div class="ttname"><a href="namespaceCrypt__DES.html">Crypt_DES</a></div><div class="ttdoc">#-</div></div>
<div class="ttc" id="anamespaceCrypt__TripleDES_html"><div class="ttname"><a href="namespaceCrypt__TripleDES.html">Crypt_TripleDES</a></div><div class="ttdoc">#-</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="install_8php_source.html#l00039">$VIEW_PATH</a>, <a class="el" href="RSA_8php_source.html#l02162">_encodeLength()</a>, <a class="el" href="RSA_8php_source.html#l00150">CRYPT_RSA_ASN1_INTEGER</a>, <a class="el" href="RSA_8php_source.html#l00162">CRYPT_RSA_ASN1_OBJECT</a>, <a class="el" href="RSA_8php_source.html#l00158">CRYPT_RSA_ASN1_OCTETSTRING</a>, <a class="el" href="RSA_8php_source.html#l00166">CRYPT_RSA_ASN1_SEQUENCE</a>, <a class="el" href="RSA_8php_source.html#l00216">CRYPT_RSA_PRIVATE_FORMAT_OPENSSH</a>, <a class="el" href="RSA_8php_source.html#l00212">CRYPT_RSA_PRIVATE_FORMAT_PKCS8</a>, <a class="el" href="RSA_8php_source.html#l00204">CRYPT_RSA_PRIVATE_FORMAT_PUTTY</a>, and <a class="el" href="RSA_8php_source.html#l00208">CRYPT_RSA_PRIVATE_FORMAT_XML</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l00596">createKey()</a>, and <a class="el" href="RSA_8php_source.html#l02040">getPrivateKey()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a2bd18359bf21cecc783d2fde56b48045_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a2bd18359bf21cecc783d2fde56b48045_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a2bd18359bf21cecc783d2fde56b48045_cgraph" id="aclassCrypt__RSA_a2bd18359bf21cecc783d2fde56b48045_cgraph">
<area shape="rect" title="Convert a private key to the appropriate format." alt="" coords="5,5,153,31"/>
<area shape="rect" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018" title="DER&#45;encode the length." alt="" coords="201,5,321,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a2bd18359bf21cecc783d2fde56b48045_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a2bd18359bf21cecc783d2fde56b48045_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a2bd18359bf21cecc783d2fde56b48045_icgraph" id="aclassCrypt__RSA_a2bd18359bf21cecc783d2fde56b48045_icgraph">
<area shape="rect" title="Convert a private key to the appropriate format." alt="" coords="301,31,449,56"/>
<area shape="rect" href="classCrypt__RSA.html#a9c89d16d1494dbaef6d353e2f62ce02c" title="Create public / private key pair." alt="" coords="153,5,240,31"/>
<area shape="rect" href="classCrypt__RSA.html#a9220b3460a198b0e587361a34333a6e3" title="Returns the private key." alt="" coords="140,55,253,80"/>
<area shape="rect" href="classCrypt__RSA.html#a7516ca30af0db3cdbf9a7739b48ce91d" title="__toString() magic method" alt="" coords="5,55,92,80"/>
</map>
</div>

</div>
</div>
<a id="a1ac38a64a86bc6963da281cf08c78d7a" name="a1ac38a64a86bc6963da281cf08c78d7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ac38a64a86bc6963da281cf08c78d7a">&#9670;&#160;</a></span>_convertPublicKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_convertPublicKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a public key to the appropriate format. </p>
<p>@access private </p><dl class="section see"><dt>See also</dt><dd>self::setPublicKeyFormat() </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a></td><td class="paramname">$n</td><td></td></tr>
    <tr><td class="paramtype"><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a></td><td class="paramname">$e</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string|array&lt;string,<a class="el" href="classMath__BigInteger.html">Math_BigInteger</a>&gt; </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l01077">1077</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1078</span>    {</div>
<div class="line"><span class="lineno"> 1079</span>        $signed = $this-&gt;publicKeyFormat != <a class="code hl_variable" href="RSA_8php.html#a31bc387c1d18654ce5877d588a0b0a89">CRYPT_RSA_PUBLIC_FORMAT_XML</a>;</div>
<div class="line"><span class="lineno"> 1080</span> </div>
<div class="line"><span class="lineno"> 1081</span>        $modulus = $n-&gt;toBytes($signed);</div>
<div class="line"><span class="lineno"> 1082</span>        $publicExponent = $e-&gt;toBytes($signed);</div>
<div class="line"><span class="lineno"> 1083</span> </div>
<div class="line"><span class="lineno"> 1084</span>        <span class="keywordflow">switch</span> ($this-&gt;publicKeyFormat) {</div>
<div class="line"><span class="lineno"> 1085</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#aefa5f08fd7a48e3c6299a0bc4b35184d">CRYPT_RSA_PUBLIC_FORMAT_RAW</a>:</div>
<div class="line"><span class="lineno"> 1086</span>                <span class="keywordflow">return</span> array(<span class="charliteral">&#39;e&#39;</span> =&gt; $e-&gt;copy(), <span class="charliteral">&#39;n&#39;</span> =&gt; $n-&gt;copy());</div>
<div class="line"><span class="lineno"> 1087</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#a31bc387c1d18654ce5877d588a0b0a89">CRYPT_RSA_PUBLIC_FORMAT_XML</a>:</div>
<div class="line"><span class="lineno"> 1088</span>                <span class="keywordflow">return</span> <span class="stringliteral">&quot;&lt;RSAKeyValue&gt;\r\n&quot;</span> .</div>
<div class="line"><span class="lineno"> 1089</span>                       <span class="stringliteral">&#39;  &lt;Modulus&gt;&#39;</span> . base64_encode($modulus) . <span class="stringliteral">&quot;&lt;/Modulus&gt;\r\n&quot;</span> .</div>
<div class="line"><span class="lineno"> 1090</span>                       <span class="stringliteral">&#39;  &lt;Exponent&gt;&#39;</span> . base64_encode($publicExponent) . <span class="stringliteral">&quot;&lt;/Exponent&gt;\r\n&quot;</span> .</div>
<div class="line"><span class="lineno"> 1091</span>                       <span class="stringliteral">&#39;&lt;/RSAKeyValue&gt;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1092</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1093</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#ad392896470610c196028e017e2c5e00c">CRYPT_RSA_PUBLIC_FORMAT_OPENSSH</a>:</div>
<div class="line"><span class="lineno"> 1094</span>                <span class="comment">// from &lt;http://tools.ietf.org/html/rfc4253#page-15&gt;:</span></div>
<div class="line"><span class="lineno"> 1095</span>                <span class="comment">// string    &quot;ssh-rsa&quot;</span></div>
<div class="line"><span class="lineno"> 1096</span>                <span class="comment">// mpint     e</span></div>
<div class="line"><span class="lineno"> 1097</span>                <span class="comment">// mpint     n</span></div>
<div class="line"><span class="lineno"> 1098</span>                $RSAPublicKey = pack(<span class="stringliteral">&#39;Na*Na*Na*&#39;</span>, strlen(<span class="stringliteral">&#39;ssh-rsa&#39;</span>), <span class="stringliteral">&#39;ssh-rsa&#39;</span>, strlen($publicExponent), $publicExponent, strlen($modulus), $modulus);</div>
<div class="line"><span class="lineno"> 1099</span>                $RSAPublicKey = <span class="stringliteral">&#39;ssh-rsa &#39;</span> . base64_encode($RSAPublicKey) . <span class="charliteral">&#39; &#39;</span> . $this-&gt;comment;</div>
<div class="line"><span class="lineno"> 1100</span> </div>
<div class="line"><span class="lineno"> 1101</span>                <span class="keywordflow">return</span> $RSAPublicKey;</div>
<div class="line"><span class="lineno"> 1102</span>            <span class="keywordflow">default</span>: <span class="comment">// eg. CRYPT_RSA_PUBLIC_FORMAT_PKCS1_RAW or CRYPT_RSA_PUBLIC_FORMAT_PKCS1</span></div>
<div class="line"><span class="lineno"> 1103</span>                <span class="comment">// from &lt;http://tools.ietf.org/html/rfc3447#appendix-A.1.1&gt;:</span></div>
<div class="line"><span class="lineno"> 1104</span>                <span class="comment">// RSAPublicKey ::= SEQUENCE {</span></div>
<div class="line"><span class="lineno"> 1105</span>                <span class="comment">//     modulus           INTEGER,  -- n</span></div>
<div class="line"><span class="lineno"> 1106</span>                <span class="comment">//     publicExponent    INTEGER   -- e</span></div>
<div class="line"><span class="lineno"> 1107</span>                <span class="comment">// }</span></div>
<div class="line"><span class="lineno"> 1108</span>                $components = array(</div>
<div class="line"><span class="lineno"> 1109</span>                    <span class="stringliteral">&#39;modulus&#39;</span> =&gt; pack(<span class="stringliteral">&#39;Ca*a*&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#a4da67fb1e37ca9dc84a0a8b54707b76a">CRYPT_RSA_ASN1_INTEGER</a>, $this-&gt;_encodeLength(strlen($modulus)), $modulus),</div>
<div class="line"><span class="lineno"> 1110</span>                    <span class="stringliteral">&#39;publicExponent&#39;</span> =&gt; pack(<span class="stringliteral">&#39;Ca*a*&#39;</span>, <a class="code hl_variable" href="RSA_8php.html#a4da67fb1e37ca9dc84a0a8b54707b76a">CRYPT_RSA_ASN1_INTEGER</a>, $this-&gt;_encodeLength(strlen($publicExponent)), $publicExponent)</div>
<div class="line"><span class="lineno"> 1111</span>                );</div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span>                $RSAPublicKey = pack(</div>
<div class="line"><span class="lineno"> 1114</span>                    <span class="stringliteral">&#39;Ca*a*a*&#39;</span>,</div>
<div class="line"><span class="lineno"> 1115</span>                    <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1116</span>                    $this-&gt;_encodeLength(strlen($components[<span class="stringliteral">&#39;modulus&#39;</span>]) + strlen($components[<span class="stringliteral">&#39;publicExponent&#39;</span>])),</div>
<div class="line"><span class="lineno"> 1117</span>                    $components[<span class="stringliteral">&#39;modulus&#39;</span>],</div>
<div class="line"><span class="lineno"> 1118</span>                    $components[<span class="stringliteral">&#39;publicExponent&#39;</span>]</div>
<div class="line"><span class="lineno"> 1119</span>                );</div>
<div class="line"><span class="lineno"> 1120</span> </div>
<div class="line"><span class="lineno"> 1121</span>                <span class="keywordflow">if</span> ($this-&gt;publicKeyFormat == <a class="code hl_variable" href="RSA_8php.html#ab26de7c0badd9522a931df31e142486a">CRYPT_RSA_PUBLIC_FORMAT_PKCS1_RAW</a>) {</div>
<div class="line"><span class="lineno"> 1122</span>                    $RSAPublicKey = <span class="stringliteral">&quot;-----BEGIN RSA PUBLIC KEY-----\r\n&quot;</span> .</div>
<div class="line"><span class="lineno"> 1123</span>                                    chunk_split(base64_encode($RSAPublicKey), 64) .</div>
<div class="line"><span class="lineno"> 1124</span>                                    <span class="stringliteral">&#39;-----END RSA PUBLIC KEY-----&#39;</span>;</div>
<div class="line"><span class="lineno"> 1125</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1126</span>                    <span class="comment">// sequence(oid(1.2.840.113549.1.1.1), null)) = rsaEncryption.</span></div>
<div class="line"><span class="lineno"> 1127</span>                    $rsaOID = pack(<span class="stringliteral">&#39;H*&#39;</span>, <span class="stringliteral">&#39;300d06092a864886f70d0101010500&#39;</span>); <span class="comment">// hex version of MA0GCSqGSIb3DQEBAQUA</span></div>
<div class="line"><span class="lineno"> 1128</span>                    $RSAPublicKey = chr(0) . $RSAPublicKey;</div>
<div class="line"><span class="lineno"> 1129</span>                    $RSAPublicKey = chr(3) . $this-&gt;_encodeLength(strlen($RSAPublicKey)) . $RSAPublicKey;</div>
<div class="line"><span class="lineno"> 1130</span> </div>
<div class="line"><span class="lineno"> 1131</span>                    $RSAPublicKey = pack(</div>
<div class="line"><span class="lineno"> 1132</span>                        <span class="stringliteral">&#39;Ca*a*&#39;</span>,</div>
<div class="line"><span class="lineno"> 1133</span>                        <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1134</span>                        $this-&gt;_encodeLength(strlen($rsaOID . $RSAPublicKey)),</div>
<div class="line"><span class="lineno"> 1135</span>                        $rsaOID . $RSAPublicKey</div>
<div class="line"><span class="lineno"> 1136</span>                    );</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span>                    $RSAPublicKey = <span class="stringliteral">&quot;-----BEGIN PUBLIC KEY-----\r\n&quot;</span> .</div>
<div class="line"><span class="lineno"> 1139</span>                                     chunk_split(base64_encode($RSAPublicKey), 64) .</div>
<div class="line"><span class="lineno"> 1140</span>                                     <span class="stringliteral">&#39;-----END PUBLIC KEY-----&#39;</span>;</div>
<div class="line"><span class="lineno"> 1141</span>                }</div>
<div class="line"><span class="lineno"> 1142</span> </div>
<div class="line"><span class="lineno"> 1143</span>                <span class="keywordflow">return</span> $RSAPublicKey;</div>
<div class="line"><span class="lineno"> 1144</span>        }</div>
<div class="line"><span class="lineno"> 1145</span>    }</div>
<div class="ttc" id="aRSA_8php_html_a31bc387c1d18654ce5877d588a0b0a89"><div class="ttname"><a href="RSA_8php.html#a31bc387c1d18654ce5877d588a0b0a89">CRYPT_RSA_PUBLIC_FORMAT_XML</a></div><div class="ttdeci">const CRYPT_RSA_PUBLIC_FORMAT_XML</div><div class="ttdoc">XML formatted public key.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00254">RSA.php:254</a></div></div>
<div class="ttc" id="aRSA_8php_html_ab26de7c0badd9522a931df31e142486a"><div class="ttname"><a href="RSA_8php.html#ab26de7c0badd9522a931df31e142486a">CRYPT_RSA_PUBLIC_FORMAT_PKCS1_RAW</a></div><div class="ttdeci">const CRYPT_RSA_PUBLIC_FORMAT_PKCS1_RAW</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00250">RSA.php:250</a></div></div>
<div class="ttc" id="aRSA_8php_html_ad392896470610c196028e017e2c5e00c"><div class="ttname"><a href="RSA_8php.html#ad392896470610c196028e017e2c5e00c">CRYPT_RSA_PUBLIC_FORMAT_OPENSSH</a></div><div class="ttdeci">const CRYPT_RSA_PUBLIC_FORMAT_OPENSSH</div><div class="ttdoc">OpenSSH formatted public key.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00260">RSA.php:260</a></div></div>
<div class="ttc" id="aRSA_8php_html_aefa5f08fd7a48e3c6299a0bc4b35184d"><div class="ttname"><a href="RSA_8php.html#aefa5f08fd7a48e3c6299a0bc4b35184d">CRYPT_RSA_PUBLIC_FORMAT_RAW</a></div><div class="ttdeci">const CRYPT_RSA_PUBLIC_FORMAT_RAW</div><div class="ttdoc">#-</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00237">RSA.php:237</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02162">_encodeLength()</a>, <a class="el" href="RSA_8php_source.html#l00150">CRYPT_RSA_ASN1_INTEGER</a>, <a class="el" href="RSA_8php_source.html#l00166">CRYPT_RSA_ASN1_SEQUENCE</a>, <a class="el" href="RSA_8php_source.html#l00260">CRYPT_RSA_PUBLIC_FORMAT_OPENSSH</a>, <a class="el" href="RSA_8php_source.html#l00250">CRYPT_RSA_PUBLIC_FORMAT_PKCS1_RAW</a>, <a class="el" href="RSA_8php_source.html#l00237">CRYPT_RSA_PUBLIC_FORMAT_RAW</a>, and <a class="el" href="RSA_8php_source.html#l00254">CRYPT_RSA_PUBLIC_FORMAT_XML</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l02063">_getPrivatePublicKey()</a>, <a class="el" href="RSA_8php_source.html#l00596">createKey()</a>, and <a class="el" href="RSA_8php_source.html#l01982">getPublicKey()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a1ac38a64a86bc6963da281cf08c78d7a_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a1ac38a64a86bc6963da281cf08c78d7a_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a1ac38a64a86bc6963da281cf08c78d7a_cgraph" id="aclassCrypt__RSA_a1ac38a64a86bc6963da281cf08c78d7a_cgraph">
<area shape="rect" title="Convert a public key to the appropriate format." alt="" coords="5,5,147,31"/>
<area shape="rect" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018" title="DER&#45;encode the length." alt="" coords="195,5,315,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a1ac38a64a86bc6963da281cf08c78d7a_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a1ac38a64a86bc6963da281cf08c78d7a_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a1ac38a64a86bc6963da281cf08c78d7a_icgraph" id="aclassCrypt__RSA_a1ac38a64a86bc6963da281cf08c78d7a_icgraph">
<area shape="rect" title="Convert a public key to the appropriate format." alt="" coords="347,55,488,80"/>
<area shape="rect" href="classCrypt__RSA.html#a8b1b2e0f348855a387167ec571c21371" title="Returns a minimalistic private key." alt="" coords="140,5,299,31"/>
<area shape="rect" href="classCrypt__RSA.html#a9c89d16d1494dbaef6d353e2f62ce02c" title="Create public / private key pair." alt="" coords="176,55,263,80"/>
<area shape="rect" href="classCrypt__RSA.html#a2537bd11389611acfb24dfd719fa8314" title="Returns the public key." alt="" coords="166,104,273,129"/>
<area shape="rect" href="classCrypt__RSA.html#a7516ca30af0db3cdbf9a7739b48ce91d" title="__toString() magic method" alt="" coords="5,5,92,31"/>
</map>
</div>

</div>
</div>
<a id="ac43f351fa8637af55dd825eadef765e9" name="ac43f351fa8637af55dd825eadef765e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac43f351fa8637af55dd825eadef765e9">&#9670;&#160;</a></span>_data_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_data_handler </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$parser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Data Handler. </p>
<p>Called by xml_set_character_data_handler()</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">resource</td><td class="paramname">$parser</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$data</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l01724">1724</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1725</span>    {</div>
<div class="line"><span class="lineno"> 1726</span>        <span class="keywordflow">if</span> (!isset($this-&gt;current) || is_object($this-&gt;current)) {</div>
<div class="line"><span class="lineno"> 1727</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1728</span>        }</div>
<div class="line"><span class="lineno"> 1729</span>        $this-&gt;current.= trim($data);</div>
<div class="line"><span class="lineno"> 1730</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae88f34bdbb000851150beff041dcb0fe" name="ae88f34bdbb000851150beff041dcb0fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae88f34bdbb000851150beff041dcb0fe">&#9670;&#160;</a></span>_decodeLength()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_decodeLength </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$string</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>DER-decode the length. </p>
<p>DER supports lengths up to (2**8)**127, however, we'll only support lengths up to (2**8)**4. See <code><a class="el" href="">X.690 paragraph 8.1.3</a></code> for more information.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$string</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02141">2141</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2142</span>    {</div>
<div class="line"><span class="lineno"> 2143</span>        $length = ord($this-&gt;_string_shift($string));</div>
<div class="line"><span class="lineno"> 2144</span>        <span class="keywordflow">if</span> ($length &amp; 0x80) { <span class="comment">// definite length, long form</span></div>
<div class="line"><span class="lineno"> 2145</span>            $length&amp;= 0x7F;</div>
<div class="line"><span class="lineno"> 2146</span>            $temp = $this-&gt;_string_shift($string, $length);</div>
<div class="line"><span class="lineno"> 2147</span>            list(, $length) = unpack(<span class="charliteral">&#39;N&#39;</span>, substr(str_pad($temp, 4, chr(0), STR_PAD_LEFT), -4));</div>
<div class="line"><span class="lineno"> 2148</span>        }</div>
<div class="line"><span class="lineno"> 2149</span>        <span class="keywordflow">return</span> $length;</div>
<div class="line"><span class="lineno"> 2150</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02182">_string_shift()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l01157">_parseKey()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_ae88f34bdbb000851150beff041dcb0fe_cgraph.png" border="0" usemap="#aclassCrypt__RSA_ae88f34bdbb000851150beff041dcb0fe_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_ae88f34bdbb000851150beff041dcb0fe_cgraph" id="aclassCrypt__RSA_ae88f34bdbb000851150beff041dcb0fe_cgraph">
<area shape="rect" title="DER&#45;decode the length." alt="" coords="5,5,125,31"/>
<area shape="rect" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35" title="String Shift." alt="" coords="173,5,275,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_ae88f34bdbb000851150beff041dcb0fe_icgraph.png" border="0" usemap="#aclassCrypt__RSA_ae88f34bdbb000851150beff041dcb0fe_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_ae88f34bdbb000851150beff041dcb0fe_icgraph" id="aclassCrypt__RSA_ae88f34bdbb000851150beff041dcb0fe_icgraph">
<area shape="rect" title="DER&#45;decode the length." alt="" coords="579,56,699,81"/>
<area shape="rect" href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5" title="Break a public or private key down into its constituant components." alt="" coords="441,56,531,81"/>
<area shape="rect" href="classCrypt__RSA.html#a9c89d16d1494dbaef6d353e2f62ce02c" title="Create public / private key pair." alt="" coords="297,5,384,31"/>
<area shape="rect" href="classCrypt__RSA.html#aecd4eb5e57d8881db518d98009bd75ee" title="Loads a public or private key." alt="" coords="165,81,240,107"/>
<area shape="rect" href="classCrypt__RSA.html#a5c291d208f8e9a8ea7e0e4b6335a61a9" title="Defines the public key." alt="" coords="288,107,393,132"/>
<area shape="rect" href="classCrypt__RSA.html#a871b11d67cc3a8f62e4c0306e64c7c1b" title="Defines the private key." alt="" coords="5,81,117,107"/>
</map>
</div>

</div>
</div>
<a id="ac7c7477da0e0045974ee1a8d1795d73f" name="ac7c7477da0e0045974ee1a8d1795d73f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7c7477da0e0045974ee1a8d1795d73f">&#9670;&#160;</a></span>_emsa_pkcs1_v1_5_encode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_emsa_pkcs1_v1_5_encode </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$emLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>EMSA-PKCS1-V1_5-ENCODE. </p>
<p>See <code><a class="el" href="">RFC3447#section-9.2</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$m</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$emLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02968">2968</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2969</span>    {</div>
<div class="line"><span class="lineno"> 2970</span>        $h = $this-&gt;hash-&gt;hash($m);</div>
<div class="line"><span class="lineno"> 2971</span>        <span class="keywordflow">if</span> ($h === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2972</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2973</span>        }</div>
<div class="line"><span class="lineno"> 2974</span> </div>
<div class="line"><span class="lineno"> 2975</span>        <span class="comment">// see http://tools.ietf.org/html/rfc3447#page-43</span></div>
<div class="line"><span class="lineno"> 2976</span>        <span class="keywordflow">switch</span> ($this-&gt;hashName) {</div>
<div class="line"><span class="lineno"> 2977</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;md2&#39;</span>:</div>
<div class="line"><span class="lineno"> 2978</span>                $t = pack(<span class="stringliteral">&#39;H*&#39;</span>, <span class="stringliteral">&#39;3020300c06082a864886f70d020205000410&#39;</span>);</div>
<div class="line"><span class="lineno"> 2979</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2980</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;md5&#39;</span>:</div>
<div class="line"><span class="lineno"> 2981</span>                $t = pack(<span class="stringliteral">&#39;H*&#39;</span>, <span class="stringliteral">&#39;3020300c06082a864886f70d020505000410&#39;</span>);</div>
<div class="line"><span class="lineno"> 2982</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2983</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha1&#39;</span>:</div>
<div class="line"><span class="lineno"> 2984</span>                $t = pack(<span class="stringliteral">&#39;H*&#39;</span>, <span class="stringliteral">&#39;3021300906052b0e03021a05000414&#39;</span>);</div>
<div class="line"><span class="lineno"> 2985</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2986</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha256&#39;</span>:</div>
<div class="line"><span class="lineno"> 2987</span>                $t = pack(<span class="stringliteral">&#39;H*&#39;</span>, <span class="stringliteral">&#39;3031300d060960864801650304020105000420&#39;</span>);</div>
<div class="line"><span class="lineno"> 2988</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2989</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha384&#39;</span>:</div>
<div class="line"><span class="lineno"> 2990</span>                $t = pack(<span class="stringliteral">&#39;H*&#39;</span>, <span class="stringliteral">&#39;3041300d060960864801650304020205000430&#39;</span>);</div>
<div class="line"><span class="lineno"> 2991</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2992</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha512&#39;</span>:</div>
<div class="line"><span class="lineno"> 2993</span>                $t = pack(<span class="stringliteral">&#39;H*&#39;</span>, <span class="stringliteral">&#39;3051300d060960864801650304020305000440&#39;</span>);</div>
<div class="line"><span class="lineno"> 2994</span>        }</div>
<div class="line"><span class="lineno"> 2995</span>        $t.= $h;</div>
<div class="line"><span class="lineno"> 2996</span>        $tLen = strlen($t);</div>
<div class="line"><span class="lineno"> 2997</span> </div>
<div class="line"><span class="lineno"> 2998</span>        <span class="keywordflow">if</span> ($emLen &lt; $tLen + 11) {</div>
<div class="line"><span class="lineno"> 2999</span>            user_error(<span class="stringliteral">&#39;Intended encoded message length too short&#39;</span>);</div>
<div class="line"><span class="lineno"> 3000</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3001</span>        }</div>
<div class="line"><span class="lineno"> 3002</span> </div>
<div class="line"><span class="lineno"> 3003</span>        $ps = str_repeat(chr(0xFF), $emLen - $tLen - 3);</div>
<div class="line"><span class="lineno"> 3004</span> </div>
<div class="line"><span class="lineno"> 3005</span>        $em = <span class="stringliteral">&quot;\0\1$ps\0$t&quot;</span>;</div>
<div class="line"><span class="lineno"> 3006</span> </div>
<div class="line"><span class="lineno"> 3007</span>        <span class="keywordflow">return</span> $em;</div>
<div class="line"><span class="lineno"> 3008</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l03072">_rsassa_pkcs1_v1_5_sign()</a>, and <a class="el" href="RSA_8php_source.html#l03103">_rsassa_pkcs1_v1_5_verify()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_ac7c7477da0e0045974ee1a8d1795d73f_icgraph.png" border="0" usemap="#aclassCrypt__RSA_ac7c7477da0e0045974ee1a8d1795d73f_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_ac7c7477da0e0045974ee1a8d1795d73f_icgraph" id="aclassCrypt__RSA_ac7c7477da0e0045974ee1a8d1795d73f_icgraph">
<area shape="rect" title="EMSA&#45;PKCS1&#45;V1_5&#45;ENCODE." alt="" coords="348,35,551,60"/>
<area shape="rect" href="classCrypt__RSA.html#a7919feaaf410567587520ae62d0f375a" title="RSASSA&#45;PKCS1&#45;V1_5&#45;SIGN." alt="" coords="112,5,300,31"/>
<area shape="rect" href="classCrypt__RSA.html#a9bac0d7f59f81a08f34e937e71fa4264" title="RSASSA&#45;PKCS1&#45;V1_5&#45;VERIFY." alt="" coords="129,55,283,95"/>
<area shape="rect" href="classCrypt__RSA.html#abe0890f90bae8c6cab81312df152652b" title="Create a signature." alt="" coords="10,5,59,31"/>
<area shape="rect" href="classCrypt__RSA.html#a91b3194ffeb55cb91eb28202ea8fe666" title="Verifies a signature." alt="" coords="5,63,64,88"/>
</map>
</div>

</div>
</div>
<a id="af65bce0b24a7aeeb274b776ba732aa15" name="af65bce0b24a7aeeb274b776ba732aa15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af65bce0b24a7aeeb274b776ba732aa15">&#9670;&#160;</a></span>_emsa_pkcs1_v1_5_encode_without_null()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_emsa_pkcs1_v1_5_encode_without_null </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$emLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>EMSA-PKCS1-V1_5-ENCODE (without NULL) </p>
<p>Quoting <a href="https://tools.ietf.org/html/rfc8017#page-65">https://tools.ietf.org/html/rfc8017#page-65</a>,</p>
<p>"The parameters field associated with id-sha1, id-sha224, id-sha256,
 id-sha384, id-sha512, id-sha512/224, and id-sha512/256 should
 generally be omitted, but if present, it shall have a value of type
 NULL"</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$m</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$emLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l03025">3025</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3026</span>    {</div>
<div class="line"><span class="lineno"> 3027</span>        $h = $this-&gt;hash-&gt;hash($m);</div>
<div class="line"><span class="lineno"> 3028</span>        <span class="keywordflow">if</span> ($h === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3029</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3030</span>        }</div>
<div class="line"><span class="lineno"> 3031</span> </div>
<div class="line"><span class="lineno"> 3032</span>        <span class="keywordflow">switch</span> ($this-&gt;hashName) {</div>
<div class="line"><span class="lineno"> 3033</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha1&#39;</span>:</div>
<div class="line"><span class="lineno"> 3034</span>                $t = pack(<span class="stringliteral">&#39;H*&#39;</span>, <span class="stringliteral">&#39;301f300706052b0e03021a0414&#39;</span>);</div>
<div class="line"><span class="lineno"> 3035</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3036</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha256&#39;</span>:</div>
<div class="line"><span class="lineno"> 3037</span>                $t = pack(<span class="stringliteral">&#39;H*&#39;</span>, <span class="stringliteral">&#39;302f300b06096086480165030402010420&#39;</span>);</div>
<div class="line"><span class="lineno"> 3038</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3039</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha384&#39;</span>:</div>
<div class="line"><span class="lineno"> 3040</span>                $t = pack(<span class="stringliteral">&#39;H*&#39;</span>, <span class="stringliteral">&#39;303f300b06096086480165030402020430&#39;</span>);</div>
<div class="line"><span class="lineno"> 3041</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3042</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha512&#39;</span>:</div>
<div class="line"><span class="lineno"> 3043</span>                $t = pack(<span class="stringliteral">&#39;H*&#39;</span>, <span class="stringliteral">&#39;304f300b06096086480165030402030440&#39;</span>);</div>
<div class="line"><span class="lineno"> 3044</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3045</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3046</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3047</span>        }</div>
<div class="line"><span class="lineno"> 3048</span>        $t.= $h;</div>
<div class="line"><span class="lineno"> 3049</span>        $tLen = strlen($t);</div>
<div class="line"><span class="lineno"> 3050</span> </div>
<div class="line"><span class="lineno"> 3051</span>        <span class="keywordflow">if</span> ($emLen &lt; $tLen + 11) {</div>
<div class="line"><span class="lineno"> 3052</span>            user_error(<span class="stringliteral">&#39;Intended encoded message length too short&#39;</span>);</div>
<div class="line"><span class="lineno"> 3053</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3054</span>        }</div>
<div class="line"><span class="lineno"> 3055</span> </div>
<div class="line"><span class="lineno"> 3056</span>        $ps = str_repeat(chr(0xFF), $emLen - $tLen - 3);</div>
<div class="line"><span class="lineno"> 3057</span> </div>
<div class="line"><span class="lineno"> 3058</span>        $em = <span class="stringliteral">&quot;\0\1$ps\0$t&quot;</span>;</div>
<div class="line"><span class="lineno"> 3059</span> </div>
<div class="line"><span class="lineno"> 3060</span>        <span class="keywordflow">return</span> $em;</div>
<div class="line"><span class="lineno"> 3061</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l03103">_rsassa_pkcs1_v1_5_verify()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_af65bce0b24a7aeeb274b776ba732aa15_icgraph.png" border="0" usemap="#aclassCrypt__RSA_af65bce0b24a7aeeb274b776ba732aa15_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_af65bce0b24a7aeeb274b776ba732aa15_icgraph" id="aclassCrypt__RSA_af65bce0b24a7aeeb274b776ba732aa15_icgraph">
<area shape="rect" title="EMSA&#45;PKCS1&#45;V1_5&#45;ENCODE (without NULL)" alt="" coords="315,5,517,45"/>
<area shape="rect" href="classCrypt__RSA.html#a9bac0d7f59f81a08f34e937e71fa4264" title="RSASSA&#45;PKCS1&#45;V1_5&#45;VERIFY." alt="" coords="112,5,267,45"/>
<area shape="rect" href="classCrypt__RSA.html#a91b3194ffeb55cb91eb28202ea8fe666" title="Verifies a signature." alt="" coords="5,13,64,38"/>
</map>
</div>

</div>
</div>
<a id="ab1766412b33feaf27a58c51171f4a8f0" name="ab1766412b33feaf27a58c51171f4a8f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1766412b33feaf27a58c51171f4a8f0">&#9670;&#160;</a></span>_emsa_pss_encode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_emsa_pss_encode </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$emBits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>EMSA-PSS-ENCODE. </p>
<p>See <code><a class="el" href="">RFC3447#section-9.1.1</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$m</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$emBits</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02818">2818</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2819</span>    {</div>
<div class="line"><span class="lineno"> 2820</span>        <span class="comment">// if $m is larger than two million terrabytes and you&#39;re using sha1, PKCS#1 suggests a &quot;Label too long&quot; error</span></div>
<div class="line"><span class="lineno"> 2821</span>        <span class="comment">// be output.</span></div>
<div class="line"><span class="lineno"> 2822</span> </div>
<div class="line"><span class="lineno"> 2823</span>        $emLen = ($emBits + 1) &gt;&gt; 3; <span class="comment">// ie. ceil($emBits / 8)</span></div>
<div class="line"><span class="lineno"> 2824</span>        $sLen = $this-&gt;sLen !== <span class="keyword">null</span> ? $this-&gt;sLen : $this-&gt;hLen;</div>
<div class="line"><span class="lineno"> 2825</span> </div>
<div class="line"><span class="lineno"> 2826</span>        $mHash = $this-&gt;hash-&gt;hash($m);</div>
<div class="line"><span class="lineno"> 2827</span>        <span class="keywordflow">if</span> ($emLen &lt; $this-&gt;hLen + $sLen + 2) {</div>
<div class="line"><span class="lineno"> 2828</span>            user_error(<span class="stringliteral">&#39;Encoding error&#39;</span>);</div>
<div class="line"><span class="lineno"> 2829</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2830</span>        }</div>
<div class="line"><span class="lineno"> 2831</span> </div>
<div class="line"><span class="lineno"> 2832</span>        $salt = crypt_random_string($sLen);</div>
<div class="line"><span class="lineno"> 2833</span>        $m2 = <span class="stringliteral">&quot;\0\0\0\0\0\0\0\0&quot;</span> . $mHash . $salt;</div>
<div class="line"><span class="lineno"> 2834</span>        $h = $this-&gt;hash-&gt;hash($m2);</div>
<div class="line"><span class="lineno"> 2835</span>        $ps = str_repeat(chr(0), $emLen - $sLen - $this-&gt;hLen - 2);</div>
<div class="line"><span class="lineno"> 2836</span>        $db = $ps . chr(1) . $salt;</div>
<div class="line"><span class="lineno"> 2837</span>        $dbMask = $this-&gt;_mgf1($h, $emLen - $this-&gt;hLen - 1);</div>
<div class="line"><span class="lineno"> 2838</span>        $maskedDB = $db ^ $dbMask;</div>
<div class="line"><span class="lineno"> 2839</span>        $maskedDB[0] = ~chr(0xFF &lt;&lt; ($emBits &amp; 7)) &amp; $maskedDB[0];</div>
<div class="line"><span class="lineno"> 2840</span>        $em = $maskedDB . $h . chr(0xBC);</div>
<div class="line"><span class="lineno"> 2841</span> </div>
<div class="line"><span class="lineno"> 2842</span>        <span class="keywordflow">return</span> $em;</div>
<div class="line"><span class="lineno"> 2843</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02541">_mgf1()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l02901">_rsassa_pss_sign()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_ab1766412b33feaf27a58c51171f4a8f0_cgraph.png" border="0" usemap="#aclassCrypt__RSA_ab1766412b33feaf27a58c51171f4a8f0_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_ab1766412b33feaf27a58c51171f4a8f0_cgraph" id="aclassCrypt__RSA_ab1766412b33feaf27a58c51171f4a8f0_cgraph">
<area shape="rect" title="EMSA&#45;PSS&#45;ENCODE." alt="" coords="5,5,153,31"/>
<area shape="rect" href="classCrypt__RSA.html#abfcfdb9ca9cc5a3eeceee10ebcf793e0" title="MGF1." alt="" coords="201,5,264,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_ab1766412b33feaf27a58c51171f4a8f0_icgraph.png" border="0" usemap="#aclassCrypt__RSA_ab1766412b33feaf27a58c51171f4a8f0_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_ab1766412b33feaf27a58c51171f4a8f0_icgraph" id="aclassCrypt__RSA_ab1766412b33feaf27a58c51171f4a8f0_icgraph">
<area shape="rect" title="EMSA&#45;PSS&#45;ENCODE." alt="" coords="285,5,433,31"/>
<area shape="rect" href="classCrypt__RSA.html#a41d7b44f4ff751df9dc5bc9a2e1a5875" title="RSASSA&#45;PSS&#45;SIGN." alt="" coords="103,5,237,31"/>
<area shape="rect" href="classCrypt__RSA.html#abe0890f90bae8c6cab81312df152652b" title="Create a signature." alt="" coords="5,5,55,31"/>
</map>
</div>

</div>
</div>
<a id="a823206322297e3b89a2e04897cdc64c3" name="a823206322297e3b89a2e04897cdc64c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a823206322297e3b89a2e04897cdc64c3">&#9670;&#160;</a></span>_emsa_pss_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_emsa_pss_verify </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$em</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$emBits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>EMSA-PSS-VERIFY. </p>
<p>See <code><a class="el" href="">RFC3447#section-9.1.2</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$m</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$em</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$emBits</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02856">2856</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2857</span>    {</div>
<div class="line"><span class="lineno"> 2858</span>        <span class="comment">// if $m is larger than two million terrabytes and you&#39;re using sha1, PKCS#1 suggests a &quot;Label too long&quot; error</span></div>
<div class="line"><span class="lineno"> 2859</span>        <span class="comment">// be output.</span></div>
<div class="line"><span class="lineno"> 2860</span> </div>
<div class="line"><span class="lineno"> 2861</span>        $emLen = ($emBits + 7) &gt;&gt; 3; <span class="comment">// ie. ceil($emBits / 8);</span></div>
<div class="line"><span class="lineno"> 2862</span>        $sLen = $this-&gt;sLen !== <span class="keyword">null</span> ? $this-&gt;sLen : $this-&gt;hLen;</div>
<div class="line"><span class="lineno"> 2863</span> </div>
<div class="line"><span class="lineno"> 2864</span>        $mHash = $this-&gt;hash-&gt;hash($m);</div>
<div class="line"><span class="lineno"> 2865</span>        <span class="keywordflow">if</span> ($emLen &lt; $this-&gt;hLen + $sLen + 2) {</div>
<div class="line"><span class="lineno"> 2866</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2867</span>        }</div>
<div class="line"><span class="lineno"> 2868</span> </div>
<div class="line"><span class="lineno"> 2869</span>        <span class="keywordflow">if</span> ($em[strlen($em) - 1] != chr(0xBC)) {</div>
<div class="line"><span class="lineno"> 2870</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2871</span>        }</div>
<div class="line"><span class="lineno"> 2872</span> </div>
<div class="line"><span class="lineno"> 2873</span>        $maskedDB = substr($em, 0, -$this-&gt;hLen - 1);</div>
<div class="line"><span class="lineno"> 2874</span>        $h = substr($em, -$this-&gt;hLen - 1, $this-&gt;hLen);</div>
<div class="line"><span class="lineno"> 2875</span>        $temp = chr(0xFF &lt;&lt; ($emBits &amp; 7));</div>
<div class="line"><span class="lineno"> 2876</span>        <span class="keywordflow">if</span> ((~$maskedDB[0] &amp; $temp) != $temp) {</div>
<div class="line"><span class="lineno"> 2877</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2878</span>        }</div>
<div class="line"><span class="lineno"> 2879</span>        $dbMask = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#abfcfdb9ca9cc5a3eeceee10ebcf793e0">_mgf1</a>($h, $emLen - $this-&gt;hLen - 1);</div>
<div class="line"><span class="lineno"> 2880</span>        $db = $maskedDB ^ $dbMask;</div>
<div class="line"><span class="lineno"> 2881</span>        $db[0] = ~chr(0xFF &lt;&lt; ($emBits &amp; 7)) &amp; $db[0];</div>
<div class="line"><span class="lineno"> 2882</span>        $temp = $emLen - $this-&gt;hLen - <a class="code hl_variable" href="classCrypt__RSA.html#a8efc7039497bc1c39c5817d77df2dca8">$sLen</a> - 2;</div>
<div class="line"><span class="lineno"> 2883</span>        <span class="keywordflow">if</span> (substr($db, 0, $temp) != str_repeat(chr(0), $temp) || ord($db[$temp]) != 1) {</div>
<div class="line"><span class="lineno"> 2884</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2885</span>        }</div>
<div class="line"><span class="lineno"> 2886</span>        $salt = substr($db, $temp + 1); <span class="comment">// should be $sLen long</span></div>
<div class="line"><span class="lineno"> 2887</span>        $m2 = <span class="stringliteral">&quot;\0\0\0\0\0\0\0\0&quot;</span> . $mHash . $salt;</div>
<div class="line"><span class="lineno"> 2888</span>        $h2 = $this-&gt;hash-&gt;hash($m2);</div>
<div class="line"><span class="lineno"> 2889</span>        <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a1479196d348b439c4a2f1ec8c72f9dd3">_equals</a>($h, $h2);</div>
<div class="line"><span class="lineno"> 2890</span>    }</div>
<div class="ttc" id="aclassCrypt__RSA_html_a1479196d348b439c4a2f1ec8c72f9dd3"><div class="ttname"><a href="classCrypt__RSA.html#a1479196d348b439c4a2f1ec8c72f9dd3">Crypt_RSA\_equals</a></div><div class="ttdeci">_equals($x, $y)</div><div class="ttdoc">Performs blinded RSA equality testing.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l02440">RSA.php:2440</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_a8efc7039497bc1c39c5817d77df2dca8"><div class="ttname"><a href="classCrypt__RSA.html#a8efc7039497bc1c39c5817d77df2dca8">Crypt_RSA\$sLen</a></div><div class="ttdeci">$sLen</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00396">RSA.php:396</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_abfcfdb9ca9cc5a3eeceee10ebcf793e0"><div class="ttname"><a href="classCrypt__RSA.html#abfcfdb9ca9cc5a3eeceee10ebcf793e0">Crypt_RSA\_mgf1</a></div><div class="ttdeci">_mgf1($mgfSeed, $maskLen)</div><div class="ttdoc">MGF1.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l02541">RSA.php:2541</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02440">_equals()</a>, and <a class="el" href="RSA_8php_source.html#l02541">_mgf1()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l02928">_rsassa_pss_verify()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a823206322297e3b89a2e04897cdc64c3_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a823206322297e3b89a2e04897cdc64c3_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a823206322297e3b89a2e04897cdc64c3_cgraph" id="aclassCrypt__RSA_a823206322297e3b89a2e04897cdc64c3_cgraph">
<area shape="rect" title="EMSA&#45;PSS&#45;VERIFY." alt="" coords="5,31,144,56"/>
<area shape="rect" href="classCrypt__RSA.html#a1479196d348b439c4a2f1ec8c72f9dd3" title="Performs blinded RSA equality testing." alt="" coords="192,5,264,31"/>
<area shape="rect" href="classCrypt__RSA.html#abfcfdb9ca9cc5a3eeceee10ebcf793e0" title="MGF1." alt="" coords="197,55,259,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a823206322297e3b89a2e04897cdc64c3_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a823206322297e3b89a2e04897cdc64c3_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a823206322297e3b89a2e04897cdc64c3_icgraph" id="aclassCrypt__RSA_a823206322297e3b89a2e04897cdc64c3_icgraph">
<area shape="rect" title="EMSA&#45;PSS&#45;VERIFY." alt="" coords="304,5,443,31"/>
<area shape="rect" href="classCrypt__RSA.html#a14d4abcd8f2ca6604b948026e0c553ba" title="RSASSA&#45;PSS&#45;VERIFY." alt="" coords="112,5,256,31"/>
<area shape="rect" href="classCrypt__RSA.html#a91b3194ffeb55cb91eb28202ea8fe666" title="Verifies a signature." alt="" coords="5,5,64,31"/>
</map>
</div>

</div>
</div>
<a id="ab9967d86f5c5bdf50e4bc80cf1a9c018" name="ab9967d86f5c5bdf50e4bc80cf1a9c018"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9967d86f5c5bdf50e4bc80cf1a9c018">&#9670;&#160;</a></span>_encodeLength()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_encodeLength </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$length</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>DER-encode the length. </p>
<p>DER supports lengths up to (2**8)**127, however, we'll only support lengths up to (2**8)**4. See <code><a class="el" href="">X.690 paragraph 8.1.3</a></code> for more information.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$length</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02162">2162</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2163</span>    {</div>
<div class="line"><span class="lineno"> 2164</span>        <span class="keywordflow">if</span> ($length &lt;= 0x7F) {</div>
<div class="line"><span class="lineno"> 2165</span>            <span class="keywordflow">return</span> chr($length);</div>
<div class="line"><span class="lineno"> 2166</span>        }</div>
<div class="line"><span class="lineno"> 2167</span> </div>
<div class="line"><span class="lineno"> 2168</span>        $temp = ltrim(pack(<span class="charliteral">&#39;N&#39;</span>, $length), chr(0));</div>
<div class="line"><span class="lineno"> 2169</span>        <span class="keywordflow">return</span> pack(<span class="stringliteral">&#39;Ca*&#39;</span>, 0x80 | strlen($temp), $temp);</div>
<div class="line"><span class="lineno"> 2170</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l00781">_convertPrivateKey()</a>, and <a class="el" href="RSA_8php_source.html#l01077">_convertPublicKey()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_ab9967d86f5c5bdf50e4bc80cf1a9c018_icgraph.png" border="0" usemap="#aclassCrypt__RSA_ab9967d86f5c5bdf50e4bc80cf1a9c018_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_ab9967d86f5c5bdf50e4bc80cf1a9c018_icgraph" id="aclassCrypt__RSA_ab9967d86f5c5bdf50e4bc80cf1a9c018_icgraph">
<area shape="rect" title="DER&#45;encode the length." alt="" coords="543,80,663,105"/>
<area shape="rect" href="classCrypt__RSA.html#a2bd18359bf21cecc783d2fde56b48045" title="Convert a private key to the appropriate format." alt="" coords="347,55,495,80"/>
<area shape="rect" href="classCrypt__RSA.html#a1ac38a64a86bc6963da281cf08c78d7a" title="Convert a public key to the appropriate format." alt="" coords="350,104,491,129"/>
<area shape="rect" href="classCrypt__RSA.html#a9c89d16d1494dbaef6d353e2f62ce02c" title="Create public / private key pair." alt="" coords="176,55,263,80"/>
<area shape="rect" href="classCrypt__RSA.html#a9220b3460a198b0e587361a34333a6e3" title="Returns the private key." alt="" coords="163,5,276,31"/>
<area shape="rect" href="classCrypt__RSA.html#a7516ca30af0db3cdbf9a7739b48ce91d" title="__toString() magic method" alt="" coords="5,55,92,80"/>
<area shape="rect" href="classCrypt__RSA.html#a8b1b2e0f348855a387167ec571c21371" title="Returns a minimalistic private key." alt="" coords="140,104,299,129"/>
<area shape="rect" href="classCrypt__RSA.html#a2537bd11389611acfb24dfd719fa8314" title="Returns the public key." alt="" coords="166,153,273,179"/>
</map>
</div>

</div>
</div>
<a id="a1479196d348b439c4a2f1ec8c72f9dd3" name="a1479196d348b439c4a2f1ec8c72f9dd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1479196d348b439c4a2f1ec8c72f9dd3">&#9670;&#160;</a></span>_equals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_equals </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs blinded RSA equality testing. </p>
<p>Protects against a particular type of timing attack described.</p>
<p>See <code><a class="el" href="">A Lesson In Timing Attacks (or, Don't use MessageDigest.isEquals)</a></code></p>
<p>Thanks for the heads up singpolyma!</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$x</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$y</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02440">2440</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2441</span>    {</div>
<div class="line"><span class="lineno"> 2442</span>        <span class="keywordflow">if</span> (function_exists(<span class="stringliteral">&#39;hash_equals&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 2443</span>            <span class="keywordflow">return</span> hash_equals($x, $y);</div>
<div class="line"><span class="lineno"> 2444</span>        }</div>
<div class="line"><span class="lineno"> 2445</span> </div>
<div class="line"><span class="lineno"> 2446</span>        <span class="keywordflow">if</span> (strlen($x) != strlen($y)) {</div>
<div class="line"><span class="lineno"> 2447</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2448</span>        }</div>
<div class="line"><span class="lineno"> 2449</span> </div>
<div class="line"><span class="lineno"> 2450</span>        $result = <span class="stringliteral">&quot;\0&quot;</span>;</div>
<div class="line"><span class="lineno"> 2451</span>        $x^= $y;</div>
<div class="line"><span class="lineno"> 2452</span>        <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($x); $i++) {</div>
<div class="line"><span class="lineno"> 2453</span>            $result|= $x[$i];</div>
<div class="line"><span class="lineno"> 2454</span>        }</div>
<div class="line"><span class="lineno"> 2455</span> </div>
<div class="line"><span class="lineno"> 2456</span>        <span class="keywordflow">return</span> $result === <span class="stringliteral">&quot;\0&quot;</span>;</div>
<div class="line"><span class="lineno"> 2457</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l02856">_emsa_pss_verify()</a>, <a class="el" href="RSA_8php_source.html#l02629">_rsaes_oaep_decrypt()</a>, and <a class="el" href="RSA_8php_source.html#l03103">_rsassa_pkcs1_v1_5_verify()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a1479196d348b439c4a2f1ec8c72f9dd3_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a1479196d348b439c4a2f1ec8c72f9dd3_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a1479196d348b439c4a2f1ec8c72f9dd3_icgraph" id="aclassCrypt__RSA_a1479196d348b439c4a2f1ec8c72f9dd3_icgraph">
<area shape="rect" title="Performs blinded RSA equality testing." alt="" coords="521,55,593,80"/>
<area shape="rect" href="classCrypt__RSA.html#a823206322297e3b89a2e04897cdc64c3" title="EMSA&#45;PSS&#45;VERIFY." alt="" coords="325,5,463,31"/>
<area shape="rect" href="classCrypt__RSA.html#ad7c3d5295c0bb7b4bcdaa30d17e3bac7" title="RSAES&#45;OAEP&#45;DECRYPT." alt="" coords="315,55,473,80"/>
<area shape="rect" href="classCrypt__RSA.html#a9bac0d7f59f81a08f34e937e71fa4264" title="RSASSA&#45;PKCS1&#45;V1_5&#45;VERIFY." alt="" coords="112,77,267,117"/>
<area shape="rect" href="classCrypt__RSA.html#a14d4abcd8f2ca6604b948026e0c553ba" title="RSASSA&#45;PSS&#45;VERIFY." alt="" coords="117,16,261,41"/>
<area shape="rect" href="classCrypt__RSA.html#a91b3194ffeb55cb91eb28202ea8fe666" title="Verifies a signature." alt="" coords="5,56,64,81"/>
</map>
</div>

</div>
</div>
<a id="a46927f0a9e61928ad1fd683f250dbce9" name="a46927f0a9e61928ad1fd683f250dbce9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46927f0a9e61928ad1fd683f250dbce9">&#9670;&#160;</a></span>_exponentiate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_exponentiate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Exponentiate with or without Chinese Remainder Theorem. </p>
<p>See <code><a class="el" href="">RFC3447#section-5.1.2</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a></td><td class="paramname">$x</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02328">2328</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2329</span>    {</div>
<div class="line"><span class="lineno"> 2330</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2331</span>            <span class="keywordflow">case</span> empty($this-&gt;primes):</div>
<div class="line"><span class="lineno"> 2332</span>            case $this-&gt;primes[1]-&gt;equals($this-&gt;zero):</div>
<div class="line"><span class="lineno"> 2333</span>            case empty($this-&gt;coefficients):</div>
<div class="line"><span class="lineno"> 2334</span>            case $this-&gt;coefficients[2]-&gt;equals($this-&gt;zero):</div>
<div class="line"><span class="lineno"> 2335</span>            case empty($this-&gt;exponents):</div>
<div class="line"><span class="lineno"> 2336</span>            case $this-&gt;exponents[1]-&gt;equals($this-&gt;zero):</div>
<div class="line"><span class="lineno"> 2337</span>                return $x-&gt;modPow($this-&gt;exponent, $this-&gt;modulus);</div>
<div class="line"><span class="lineno"> 2338</span>        }</div>
<div class="line"><span class="lineno"> 2339</span> </div>
<div class="line"><span class="lineno"> 2340</span>        $num_primes = count($this-&gt;primes);</div>
<div class="line"><span class="lineno"> 2341</span> </div>
<div class="line"><span class="lineno"> 2342</span>        <span class="keywordflow">if</span> (defined(<span class="stringliteral">&#39;CRYPT_RSA_DISABLE_BLINDING&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 2343</span>            $m_i = array(</div>
<div class="line"><span class="lineno"> 2344</span>                1 =&gt; $x-&gt;modPow($this-&gt;exponents[1], $this-&gt;primes[1]),</div>
<div class="line"><span class="lineno"> 2345</span>                2 =&gt; $x-&gt;modPow($this-&gt;exponents[2], $this-&gt;primes[2])</div>
<div class="line"><span class="lineno"> 2346</span>            );</div>
<div class="line"><span class="lineno"> 2347</span>            $h = $m_i[1]-&gt;subtract($m_i[2]);</div>
<div class="line"><span class="lineno"> 2348</span>            $h = $h-&gt;multiply($this-&gt;coefficients[2]);</div>
<div class="line"><span class="lineno"> 2349</span>            list(, $h) = $h-&gt;divide($this-&gt;primes[1]);</div>
<div class="line"><span class="lineno"> 2350</span>            $m = $m_i[2]-&gt;add($h-&gt;multiply($this-&gt;primes[2]));</div>
<div class="line"><span class="lineno"> 2351</span> </div>
<div class="line"><span class="lineno"> 2352</span>            <a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = $this-&gt;primes[1];</div>
<div class="line"><span class="lineno"> 2353</span>            <span class="keywordflow">for</span> ($i = 3; $i &lt;= $num_primes; $i++) {</div>
<div class="line"><span class="lineno"> 2354</span>                $m_i = $x-&gt;modPow($this-&gt;exponents[$i], $this-&gt;primes[$i]);</div>
<div class="line"><span class="lineno"> 2355</span> </div>
<div class="line"><span class="lineno"> 2356</span>                <a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = <a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>-&gt;multiply($this-&gt;primes[$i - 1]);</div>
<div class="line"><span class="lineno"> 2357</span> </div>
<div class="line"><span class="lineno"> 2358</span>                $h = $m_i-&gt;subtract($m);</div>
<div class="line"><span class="lineno"> 2359</span>                $h = $h-&gt;multiply($this-&gt;coefficients[$i]);</div>
<div class="line"><span class="lineno"> 2360</span>                list(, $h) = $h-&gt;divide($this-&gt;primes[$i]);</div>
<div class="line"><span class="lineno"> 2361</span> </div>
<div class="line"><span class="lineno"> 2362</span>                $m = $m-&gt;add(<a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>-&gt;multiply($h));</div>
<div class="line"><span class="lineno"> 2363</span>            }</div>
<div class="line"><span class="lineno"> 2364</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2365</span>            $smallest = $this-&gt;primes[1];</div>
<div class="line"><span class="lineno"> 2366</span>            <span class="keywordflow">for</span> ($i = 2; $i &lt;= $num_primes; $i++) {</div>
<div class="line"><span class="lineno"> 2367</span>                <span class="keywordflow">if</span> ($smallest-&gt;compare($this-&gt;primes[$i]) &gt; 0) {</div>
<div class="line"><span class="lineno"> 2368</span>                    $smallest = $this-&gt;primes[$i];</div>
<div class="line"><span class="lineno"> 2369</span>                }</div>
<div class="line"><span class="lineno"> 2370</span>            }</div>
<div class="line"><span class="lineno"> 2371</span> </div>
<div class="line"><span class="lineno"> 2372</span>            <a class="code hl_variable" href="classCrypt__RSA.html#a95601f0019d098a2b40f33f5939e799b">$one</a> = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>(1);</div>
<div class="line"><span class="lineno"> 2373</span> </div>
<div class="line"><span class="lineno"> 2374</span>            <a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = <a class="code hl_variable" href="classCrypt__RSA.html#a95601f0019d098a2b40f33f5939e799b">$one</a>-&gt;random($one, $smallest-&gt;subtract($one));</div>
<div class="line"><span class="lineno"> 2375</span> </div>
<div class="line"><span class="lineno"> 2376</span>            $m_i = array(</div>
<div class="line"><span class="lineno"> 2377</span>                1 =&gt; $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443">_blind</a>($x, <a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, 1),</div>
<div class="line"><span class="lineno"> 2378</span>                2 =&gt; $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443">_blind</a>($x, <a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, 2)</div>
<div class="line"><span class="lineno"> 2379</span>            );</div>
<div class="line"><span class="lineno"> 2380</span>            $h = $m_i[1]-&gt;subtract($m_i[2]);</div>
<div class="line"><span class="lineno"> 2381</span>            $h = $h-&gt;multiply($this-&gt;coefficients[2]);</div>
<div class="line"><span class="lineno"> 2382</span>            list(, $h) = $h-&gt;divide($this-&gt;primes[1]);</div>
<div class="line"><span class="lineno"> 2383</span>            $m = $m_i[2]-&gt;add($h-&gt;multiply($this-&gt;primes[2]));</div>
<div class="line"><span class="lineno"> 2384</span> </div>
<div class="line"><span class="lineno"> 2385</span>            <a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = $this-&gt;primes[1];</div>
<div class="line"><span class="lineno"> 2386</span>            <span class="keywordflow">for</span> ($i = 3; $i &lt;= $num_primes; $i++) {</div>
<div class="line"><span class="lineno"> 2387</span>                $m_i = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443">_blind</a>($x, <a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, $i);</div>
<div class="line"><span class="lineno"> 2388</span> </div>
<div class="line"><span class="lineno"> 2389</span>                <a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = <a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>-&gt;multiply($this-&gt;primes[$i - 1]);</div>
<div class="line"><span class="lineno"> 2390</span> </div>
<div class="line"><span class="lineno"> 2391</span>                $h = $m_i-&gt;subtract($m);</div>
<div class="line"><span class="lineno"> 2392</span>                $h = $h-&gt;multiply($this-&gt;coefficients[$i]);</div>
<div class="line"><span class="lineno"> 2393</span>                list(, $h) = $h-&gt;divide($this-&gt;primes[$i]);</div>
<div class="line"><span class="lineno"> 2394</span> </div>
<div class="line"><span class="lineno"> 2395</span>                $m = $m-&gt;add(<a class="code hl_variable" href="configtest_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>-&gt;multiply($h));</div>
<div class="line"><span class="lineno"> 2396</span>            }</div>
<div class="line"><span class="lineno"> 2397</span>        }</div>
<div class="line"><span class="lineno"> 2398</span> </div>
<div class="line"><span class="lineno"> 2399</span>        <span class="keywordflow">return</span> $m;</div>
<div class="line"><span class="lineno"> 2400</span>    }</div>
<div class="ttc" id="aclassCrypt__RSA_html_a44ab71ffba98c8fe3172f8d2dc69e443"><div class="ttname"><a href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443">Crypt_RSA\_blind</a></div><div class="ttdeci">_blind($x, $r, $i)</div><div class="ttdoc">Performs RSA Blinding.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l02414">RSA.php:2414</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_a95601f0019d098a2b40f33f5939e799b"><div class="ttname"><a href="classCrypt__RSA.html#a95601f0019d098a2b40f33f5939e799b">Crypt_RSA\$one</a></div><div class="ttdeci">$one</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00300">RSA.php:300</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="configtest_8php_source.html#l00066">$r</a>, and <a class="el" href="RSA_8php_source.html#l02414">_blind()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l02486">_rsadp()</a>, <a class="el" href="RSA_8php_source.html#l02468">_rsaep()</a>, <a class="el" href="RSA_8php_source.html#l02504">_rsasp1()</a>, and <a class="el" href="RSA_8php_source.html#l02522">_rsavp1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a46927f0a9e61928ad1fd683f250dbce9_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a46927f0a9e61928ad1fd683f250dbce9_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a46927f0a9e61928ad1fd683f250dbce9_cgraph" id="aclassCrypt__RSA_a46927f0a9e61928ad1fd683f250dbce9_cgraph">
<area shape="rect" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="5,5,120,31"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="168,5,229,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a46927f0a9e61928ad1fd683f250dbce9_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a46927f0a9e61928ad1fd683f250dbce9_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a46927f0a9e61928ad1fd683f250dbce9_icgraph" id="aclassCrypt__RSA_a46927f0a9e61928ad1fd683f250dbce9_icgraph">
<area shape="rect" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="496,228,611,253"/>
<area shape="rect" href="classCrypt__RSA.html#ae7fd9226ba1559b8cfe7d42423021ee1" title="RSADP." alt="" coords="379,55,444,80"/>
<area shape="rect" href="classCrypt__RSA.html#a5157f032e713c0485ba64caebea03bd4" title="RSAEP." alt="" coords="379,179,444,204"/>
<area shape="rect" href="classCrypt__RSA.html#a812ed7b5c58b1d3281ca8263b0eb9c38" title="RSASP1." alt="" coords="375,252,447,277"/>
<area shape="rect" href="classCrypt__RSA.html#a2fe05e8ee49b3d3064c09ff852c3bf34" title="RSAVP1." alt="" coords="375,359,448,384"/>
<area shape="rect" href="classCrypt__RSA.html#ad7c3d5295c0bb7b4bcdaa30d17e3bac7" title="RSAES&#45;OAEP&#45;DECRYPT." alt="" coords="146,5,305,31"/>
<area shape="rect" href="classCrypt__RSA.html#a7171e1af643c02e2167394607a4f4c26" title="RSAES&#45;PKCS1&#45;V1_5&#45;DECRYPT." alt="" coords="124,55,327,80"/>
<area shape="rect" href="classCrypt__RSA.html#a5a4bf86d0bc8f236078fee29827dc683" title="Raw Encryption / Decryption." alt="" coords="171,104,280,129"/>
<area shape="rect" href="classCrypt__RSA.html#a43d2341a9ffbeadcf13400dbe48988cc" title="RSAES&#45;OAEP&#45;ENCRYPT." alt="" coords="146,153,305,179"/>
<area shape="rect" href="classCrypt__RSA.html#a47bed67c0d9c4ecc11da13e0ad3cddb0" title="RSAES&#45;PKCS1&#45;V1_5&#45;ENCRYPT." alt="" coords="124,203,327,228"/>
<area shape="rect" href="classCrypt__RSA.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encryption." alt="" coords="5,153,76,179"/>
<area shape="rect" href="classCrypt__RSA.html#a7919feaaf410567587520ae62d0f375a" title="RSASSA&#45;PKCS1&#45;V1_5&#45;SIGN." alt="" coords="131,252,319,277"/>
<area shape="rect" href="classCrypt__RSA.html#a41d7b44f4ff751df9dc5bc9a2e1a5875" title="RSASSA&#45;PSS&#45;SIGN." alt="" coords="158,301,293,327"/>
<area shape="rect" href="classCrypt__RSA.html#abe0890f90bae8c6cab81312df152652b" title="Create a signature." alt="" coords="16,277,65,303"/>
<area shape="rect" href="classCrypt__RSA.html#a9bac0d7f59f81a08f34e937e71fa4264" title="RSASSA&#45;PKCS1&#45;V1_5&#45;VERIFY." alt="" coords="148,351,303,391"/>
<area shape="rect" href="classCrypt__RSA.html#a14d4abcd8f2ca6604b948026e0c553ba" title="RSASSA&#45;PSS&#45;VERIFY." alt="" coords="153,416,297,441"/>
<area shape="rect" href="classCrypt__RSA.html#a91b3194ffeb55cb91eb28202ea8fe666" title="Verifies a signature." alt="" coords="11,387,70,412"/>
</map>
</div>

</div>
</div>
<a id="a009e0a2396931d62c87d27f4e2372024" name="a009e0a2396931d62c87d27f4e2372024"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a009e0a2396931d62c87d27f4e2372024">&#9670;&#160;</a></span>_extractBER()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_extractBER </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract raw BER from Base64 encoding. </p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$str</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l03336">3336</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3337</span>    {</div>
<div class="line"><span class="lineno"> 3338</span>        <span class="comment">/* X.509 certs are assumed to be base64 encoded but sometimes they&#39;ll have additional things in them</span></div>
<div class="line"><span class="lineno"> 3339</span><span class="comment">         * above and beyond the ceritificate.</span></div>
<div class="line"><span class="lineno"> 3340</span><span class="comment">         * ie. some may have the following preceding the -----BEGIN CERTIFICATE----- line:</span></div>
<div class="line"><span class="lineno"> 3341</span><span class="comment">         *</span></div>
<div class="line"><span class="lineno"> 3342</span><span class="comment">         * Bag Attributes</span></div>
<div class="line"><span class="lineno"> 3343</span><span class="comment">         *     localKeyID: 01 00 00 00</span></div>
<div class="line"><span class="lineno"> 3344</span><span class="comment">         * subject=/O=organization/OU=org unit/CN=common name</span></div>
<div class="line"><span class="lineno"> 3345</span><span class="comment">         * issuer=/O=organization/CN=common name</span></div>
<div class="line"><span class="lineno"> 3346</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 3347</span>        $temp = preg_replace(<span class="stringliteral">&#39;#.*?^-+[^-]+-+[\r\n ]*$#ms&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $str, 1);</div>
<div class="line"><span class="lineno"> 3348</span>        <span class="comment">// remove the -----BEGIN CERTIFICATE----- and -----END CERTIFICATE----- stuff</span></div>
<div class="line"><span class="lineno"> 3349</span>        $temp = preg_replace(<span class="stringliteral">&#39;#-+[^-]+-+#&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $temp);</div>
<div class="line"><span class="lineno"> 3350</span>        <span class="comment">// remove new lines</span></div>
<div class="line"><span class="lineno"> 3351</span>        $temp = str_replace(array(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot;\n&quot;</span>, <span class="charliteral">&#39; &#39;</span>), <span class="stringliteral">&#39;&#39;</span>, $temp);</div>
<div class="line"><span class="lineno"> 3352</span>        $temp = preg_match(<span class="stringliteral">&#39;#^[a-zA-Z\d/+]*={0,2}$#&#39;</span>, $temp) ? base64_decode($temp) : false;</div>
<div class="line"><span class="lineno"> 3353</span>        <span class="keywordflow">return</span> $temp != <span class="keyword">false</span> ? $temp : $str;</div>
<div class="line"><span class="lineno"> 3354</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l01157">_parseKey()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a009e0a2396931d62c87d27f4e2372024_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a009e0a2396931d62c87d27f4e2372024_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a009e0a2396931d62c87d27f4e2372024_icgraph" id="aclassCrypt__RSA_a009e0a2396931d62c87d27f4e2372024_icgraph">
<area shape="rect" title="Extract raw BER from Base64 encoding." alt="" coords="579,56,680,81"/>
<area shape="rect" href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5" title="Break a public or private key down into its constituant components." alt="" coords="441,56,531,81"/>
<area shape="rect" href="classCrypt__RSA.html#a9c89d16d1494dbaef6d353e2f62ce02c" title="Create public / private key pair." alt="" coords="297,5,384,31"/>
<area shape="rect" href="classCrypt__RSA.html#aecd4eb5e57d8881db518d98009bd75ee" title="Loads a public or private key." alt="" coords="165,81,240,107"/>
<area shape="rect" href="classCrypt__RSA.html#a5c291d208f8e9a8ea7e0e4b6335a61a9" title="Defines the public key." alt="" coords="288,107,393,132"/>
<area shape="rect" href="classCrypt__RSA.html#a871b11d67cc3a8f62e4c0306e64c7c1b" title="Defines the private key." alt="" coords="5,81,117,107"/>
</map>
</div>

</div>
</div>
<a id="a63369f75f78aece549868cebbf270794" name="a63369f75f78aece549868cebbf270794"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63369f75f78aece549868cebbf270794">&#9670;&#160;</a></span>_generateMinMax()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_generateMinMax </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$bits</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates the smallest and largest numbers requiring $bits bits. </p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$bits</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02112">2112</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2113</span>    {</div>
<div class="line"><span class="lineno"> 2114</span>        $bytes = $bits &gt;&gt; 3;</div>
<div class="line"><span class="lineno"> 2115</span>        $min = str_repeat(chr(0), $bytes);</div>
<div class="line"><span class="lineno"> 2116</span>        $max = str_repeat(chr(0xFF), $bytes);</div>
<div class="line"><span class="lineno"> 2117</span>        $msb = $bits &amp; 7;</div>
<div class="line"><span class="lineno"> 2118</span>        <span class="keywordflow">if</span> ($msb) {</div>
<div class="line"><span class="lineno"> 2119</span>            $min = chr(1 &lt;&lt; ($msb - 1)) . $min;</div>
<div class="line"><span class="lineno"> 2120</span>            $max = chr((1 &lt;&lt; $msb) - 1) . $max;</div>
<div class="line"><span class="lineno"> 2121</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2122</span>            $min[0] = chr(0x80);</div>
<div class="line"><span class="lineno"> 2123</span>        }</div>
<div class="line"><span class="lineno"> 2124</span> </div>
<div class="line"><span class="lineno"> 2125</span>        <span class="keywordflow">return</span> array(</div>
<div class="line"><span class="lineno"> 2126</span>            <span class="stringliteral">&#39;min&#39;</span> =&gt; <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($min, 256),</div>
<div class="line"><span class="lineno"> 2127</span>            <span class="stringliteral">&#39;max&#39;</span> =&gt; <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($max, 256)</div>
<div class="line"><span class="lineno"> 2128</span>        );</div>
<div class="line"><span class="lineno"> 2129</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l00596">createKey()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a63369f75f78aece549868cebbf270794_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a63369f75f78aece549868cebbf270794_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a63369f75f78aece549868cebbf270794_icgraph" id="aclassCrypt__RSA_a63369f75f78aece549868cebbf270794_icgraph">
<area shape="rect" title="Generates the smallest and largest numbers requiring $bits bits." alt="" coords="140,5,279,31"/>
<area shape="rect" href="classCrypt__RSA.html#a9c89d16d1494dbaef6d353e2f62ce02c" title="Create public / private key pair." alt="" coords="5,5,92,31"/>
</map>
</div>

</div>
</div>
<a id="a8b1b2e0f348855a387167ec571c21371" name="a8b1b2e0f348855a387167ec571c21371"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b1b2e0f348855a387167ec571c21371">&#9670;&#160;</a></span>_getPrivatePublicKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getPrivatePublicKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mode</em> = <code><a class="el" href="RSA_8php.html#a4741a3919471f37f2156fa615d24a49f">CRYPT_RSA_PUBLIC_FORMAT_PKCS8</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a minimalistic private key. </p>
<p>Returns the private key without the prime number constituants. Structurally identical to a public key that hasn't been set as the public key</p>
<dl class="section see"><dt>See also</dt><dd>self::getPrivateKey() @access private </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$mode</td><td>optional </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02063">2063</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2064</span>    {</div>
<div class="line"><span class="lineno"> 2065</span>        <span class="keywordflow">if</span> (empty($this-&gt;modulus) || empty($this-&gt;exponent)) {</div>
<div class="line"><span class="lineno"> 2066</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2067</span>        }</div>
<div class="line"><span class="lineno"> 2068</span> </div>
<div class="line"><span class="lineno"> 2069</span>        $oldFormat = $this-&gt;publicKeyFormat;</div>
<div class="line"><span class="lineno"> 2070</span>        $this-&gt;publicKeyFormat = $mode;</div>
<div class="line"><span class="lineno"> 2071</span>        $temp = $this-&gt;_convertPublicKey($this-&gt;modulus, $this-&gt;exponent);</div>
<div class="line"><span class="lineno"> 2072</span>        $this-&gt;publicKeyFormat = $oldFormat;</div>
<div class="line"><span class="lineno"> 2073</span>        <span class="keywordflow">return</span> $temp;</div>
<div class="line"><span class="lineno"> 2074</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l01077">_convertPublicKey()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l02082">__toString()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a8b1b2e0f348855a387167ec571c21371_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a8b1b2e0f348855a387167ec571c21371_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a8b1b2e0f348855a387167ec571c21371_cgraph" id="aclassCrypt__RSA_a8b1b2e0f348855a387167ec571c21371_cgraph">
<area shape="rect" title="Returns a minimalistic private key." alt="" coords="5,5,164,31"/>
<area shape="rect" href="classCrypt__RSA.html#a1ac38a64a86bc6963da281cf08c78d7a" title="Convert a public key to the appropriate format." alt="" coords="212,5,353,31"/>
<area shape="rect" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018" title="DER&#45;encode the length." alt="" coords="401,5,521,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a8b1b2e0f348855a387167ec571c21371_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a8b1b2e0f348855a387167ec571c21371_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a8b1b2e0f348855a387167ec571c21371_icgraph" id="aclassCrypt__RSA_a8b1b2e0f348855a387167ec571c21371_icgraph">
<area shape="rect" title="Returns a minimalistic private key." alt="" coords="140,5,299,31"/>
<area shape="rect" href="classCrypt__RSA.html#a7516ca30af0db3cdbf9a7739b48ce91d" title="__toString() magic method" alt="" coords="5,5,92,31"/>
</map>
</div>

</div>
</div>
<a id="a7dbb5187f86756281452e726a0c3d87b" name="a7dbb5187f86756281452e726a0c3d87b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dbb5187f86756281452e726a0c3d87b">&#9670;&#160;</a></span>_i2osp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_i2osp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$xLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Integer-to-Octet-String primitive. </p>
<p>See <code><a class="el" href="">RFC3447#section-4.1</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a></td><td class="paramname">$x</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$xLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02295">2295</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2296</span>    {</div>
<div class="line"><span class="lineno"> 2297</span>        $x = $x-&gt;toBytes();</div>
<div class="line"><span class="lineno"> 2298</span>        <span class="keywordflow">if</span> (strlen($x) &gt; $xLen) {</div>
<div class="line"><span class="lineno"> 2299</span>            user_error(<span class="stringliteral">&#39;Integer too large&#39;</span>);</div>
<div class="line"><span class="lineno"> 2300</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2301</span>        }</div>
<div class="line"><span class="lineno"> 2302</span>        <span class="keywordflow">return</span> str_pad($x, $xLen, chr(0), STR_PAD_LEFT);</div>
<div class="line"><span class="lineno"> 2303</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l02694">_raw_encrypt()</a>, <a class="el" href="RSA_8php_source.html#l02629">_rsaes_oaep_decrypt()</a>, <a class="el" href="RSA_8php_source.html#l02566">_rsaes_oaep_encrypt()</a>, <a class="el" href="RSA_8php_source.html#l02769">_rsaes_pkcs1_v1_5_decrypt()</a>, <a class="el" href="RSA_8php_source.html#l02710">_rsaes_pkcs1_v1_5_encrypt()</a>, <a class="el" href="RSA_8php_source.html#l03072">_rsassa_pkcs1_v1_5_sign()</a>, <a class="el" href="RSA_8php_source.html#l03103">_rsassa_pkcs1_v1_5_verify()</a>, <a class="el" href="RSA_8php_source.html#l02901">_rsassa_pss_sign()</a>, and <a class="el" href="RSA_8php_source.html#l02928">_rsassa_pss_verify()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a7dbb5187f86756281452e726a0c3d87b_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a7dbb5187f86756281452e726a0c3d87b_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a7dbb5187f86756281452e726a0c3d87b_icgraph" id="aclassCrypt__RSA_a7dbb5187f86756281452e726a0c3d87b_icgraph">
<area shape="rect" title="Integer&#45;to&#45;Octet&#45;String primitive." alt="" coords="375,203,439,228"/>
<area shape="rect" href="classCrypt__RSA.html#a5a4bf86d0bc8f236078fee29827dc683" title="Raw Encryption / Decryption." alt="" coords="171,5,280,31"/>
<area shape="rect" href="classCrypt__RSA.html#ad7c3d5295c0bb7b4bcdaa30d17e3bac7" title="RSAES&#45;OAEP&#45;DECRYPT." alt="" coords="146,55,305,80"/>
<area shape="rect" href="classCrypt__RSA.html#a43d2341a9ffbeadcf13400dbe48988cc" title="RSAES&#45;OAEP&#45;ENCRYPT." alt="" coords="146,104,305,129"/>
<area shape="rect" href="classCrypt__RSA.html#a7171e1af643c02e2167394607a4f4c26" title="RSAES&#45;PKCS1&#45;V1_5&#45;DECRYPT." alt="" coords="124,153,327,179"/>
<area shape="rect" href="classCrypt__RSA.html#a47bed67c0d9c4ecc11da13e0ad3cddb0" title="RSAES&#45;PKCS1&#45;V1_5&#45;ENCRYPT." alt="" coords="124,203,327,228"/>
<area shape="rect" href="classCrypt__RSA.html#a7919feaaf410567587520ae62d0f375a" title="RSASSA&#45;PKCS1&#45;V1_5&#45;SIGN." alt="" coords="131,252,319,277"/>
<area shape="rect" href="classCrypt__RSA.html#a9bac0d7f59f81a08f34e937e71fa4264" title="RSASSA&#45;PKCS1&#45;V1_5&#45;VERIFY." alt="" coords="148,351,303,391"/>
<area shape="rect" href="classCrypt__RSA.html#a41d7b44f4ff751df9dc5bc9a2e1a5875" title="RSASSA&#45;PSS&#45;SIGN." alt="" coords="158,301,293,327"/>
<area shape="rect" href="classCrypt__RSA.html#a14d4abcd8f2ca6604b948026e0c553ba" title="RSASSA&#45;PSS&#45;VERIFY." alt="" coords="153,416,297,441"/>
<area shape="rect" href="classCrypt__RSA.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encryption." alt="" coords="5,104,76,129"/>
<area shape="rect" href="classCrypt__RSA.html#abe0890f90bae8c6cab81312df152652b" title="Create a signature." alt="" coords="16,277,65,303"/>
<area shape="rect" href="classCrypt__RSA.html#a91b3194ffeb55cb91eb28202ea8fe666" title="Verifies a signature." alt="" coords="11,387,70,412"/>
</map>
</div>

</div>
</div>
<a id="abfcfdb9ca9cc5a3eeceee10ebcf793e0" name="abfcfdb9ca9cc5a3eeceee10ebcf793e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfcfdb9ca9cc5a3eeceee10ebcf793e0">&#9670;&#160;</a></span>_mgf1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_mgf1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mgfSeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$maskLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>MGF1. </p>
<p>See <code><a class="el" href="">RFC3447#appendix-B.2.1</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$mgfSeed</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$maskLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02541">2541</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2542</span>    {</div>
<div class="line"><span class="lineno"> 2543</span>        <span class="comment">// if $maskLen would yield strings larger than 4GB, PKCS#1 suggests a &quot;Mask too long&quot; error be output.</span></div>
<div class="line"><span class="lineno"> 2544</span> </div>
<div class="line"><span class="lineno"> 2545</span>        $t = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 2546</span>        $count = ceil($maskLen / $this-&gt;mgfHLen);</div>
<div class="line"><span class="lineno"> 2547</span>        <span class="keywordflow">for</span> ($i = 0; $i &lt; $count; $i++) {</div>
<div class="line"><span class="lineno"> 2548</span>            $c = pack(<span class="charliteral">&#39;N&#39;</span>, $i);</div>
<div class="line"><span class="lineno"> 2549</span>            $t.= $this-&gt;mgfHash-&gt;hash($mgfSeed . $c);</div>
<div class="line"><span class="lineno"> 2550</span>        }</div>
<div class="line"><span class="lineno"> 2551</span> </div>
<div class="line"><span class="lineno"> 2552</span>        <span class="keywordflow">return</span> substr($t, 0, $maskLen);</div>
<div class="line"><span class="lineno"> 2553</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l02818">_emsa_pss_encode()</a>, <a class="el" href="RSA_8php_source.html#l02856">_emsa_pss_verify()</a>, <a class="el" href="RSA_8php_source.html#l02629">_rsaes_oaep_decrypt()</a>, and <a class="el" href="RSA_8php_source.html#l02566">_rsaes_oaep_encrypt()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_abfcfdb9ca9cc5a3eeceee10ebcf793e0_icgraph.png" border="0" usemap="#aclassCrypt__RSA_abfcfdb9ca9cc5a3eeceee10ebcf793e0_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_abfcfdb9ca9cc5a3eeceee10ebcf793e0_icgraph" id="aclassCrypt__RSA_abfcfdb9ca9cc5a3eeceee10ebcf793e0_icgraph">
<area shape="rect" title="MGF1." alt="" coords="511,80,573,105"/>
<area shape="rect" href="classCrypt__RSA.html#ab1766412b33feaf27a58c51171f4a8f0" title="EMSA&#45;PSS&#45;ENCODE." alt="" coords="309,5,457,31"/>
<area shape="rect" href="classCrypt__RSA.html#a823206322297e3b89a2e04897cdc64c3" title="EMSA&#45;PSS&#45;VERIFY." alt="" coords="314,55,453,80"/>
<area shape="rect" href="classCrypt__RSA.html#ad7c3d5295c0bb7b4bcdaa30d17e3bac7" title="RSAES&#45;OAEP&#45;DECRYPT." alt="" coords="304,104,463,129"/>
<area shape="rect" href="classCrypt__RSA.html#a43d2341a9ffbeadcf13400dbe48988cc" title="RSAES&#45;OAEP&#45;ENCRYPT." alt="" coords="304,153,463,179"/>
<area shape="rect" href="classCrypt__RSA.html#a41d7b44f4ff751df9dc5bc9a2e1a5875" title="RSASSA&#45;PSS&#45;SIGN." alt="" coords="117,5,251,31"/>
<area shape="rect" href="classCrypt__RSA.html#abe0890f90bae8c6cab81312df152652b" title="Create a signature." alt="" coords="10,5,59,31"/>
<area shape="rect" href="classCrypt__RSA.html#a14d4abcd8f2ca6604b948026e0c553ba" title="RSASSA&#45;PSS&#45;VERIFY." alt="" coords="112,55,256,80"/>
<area shape="rect" href="classCrypt__RSA.html#a91b3194ffeb55cb91eb28202ea8fe666" title="Verifies a signature." alt="" coords="5,55,64,80"/>
<area shape="rect" href="classCrypt__RSA.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encryption." alt="" coords="149,153,219,179"/>
</map>
</div>

</div>
</div>
<a id="acfc45b22328d38a3e36ce78eb1fceab1" name="acfc45b22328d38a3e36ce78eb1fceab1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfc45b22328d38a3e36ce78eb1fceab1">&#9670;&#160;</a></span>_os2ip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_os2ip </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Octet-String-to-Integer primitive. </p>
<p>See <code><a class="el" href="">RFC3447#section-4.2</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int&#160;|&#160;string&#160;|&#160;resource</td><td class="paramname">$x</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02314">2314</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2315</span>    {</div>
<div class="line"><span class="lineno"> 2316</span>        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($x, 256);</div>
<div class="line"><span class="lineno"> 2317</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l02694">_raw_encrypt()</a>, <a class="el" href="RSA_8php_source.html#l02629">_rsaes_oaep_decrypt()</a>, <a class="el" href="RSA_8php_source.html#l02566">_rsaes_oaep_encrypt()</a>, <a class="el" href="RSA_8php_source.html#l02769">_rsaes_pkcs1_v1_5_decrypt()</a>, <a class="el" href="RSA_8php_source.html#l02710">_rsaes_pkcs1_v1_5_encrypt()</a>, <a class="el" href="RSA_8php_source.html#l03072">_rsassa_pkcs1_v1_5_sign()</a>, <a class="el" href="RSA_8php_source.html#l03103">_rsassa_pkcs1_v1_5_verify()</a>, <a class="el" href="RSA_8php_source.html#l02901">_rsassa_pss_sign()</a>, and <a class="el" href="RSA_8php_source.html#l02928">_rsassa_pss_verify()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_acfc45b22328d38a3e36ce78eb1fceab1_icgraph.png" border="0" usemap="#aclassCrypt__RSA_acfc45b22328d38a3e36ce78eb1fceab1_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_acfc45b22328d38a3e36ce78eb1fceab1_icgraph" id="aclassCrypt__RSA_acfc45b22328d38a3e36ce78eb1fceab1_icgraph">
<area shape="rect" title="Octet&#45;String&#45;to&#45;Integer primitive." alt="" coords="375,203,439,228"/>
<area shape="rect" href="classCrypt__RSA.html#a5a4bf86d0bc8f236078fee29827dc683" title="Raw Encryption / Decryption." alt="" coords="171,5,280,31"/>
<area shape="rect" href="classCrypt__RSA.html#ad7c3d5295c0bb7b4bcdaa30d17e3bac7" title="RSAES&#45;OAEP&#45;DECRYPT." alt="" coords="146,55,305,80"/>
<area shape="rect" href="classCrypt__RSA.html#a43d2341a9ffbeadcf13400dbe48988cc" title="RSAES&#45;OAEP&#45;ENCRYPT." alt="" coords="146,104,305,129"/>
<area shape="rect" href="classCrypt__RSA.html#a7171e1af643c02e2167394607a4f4c26" title="RSAES&#45;PKCS1&#45;V1_5&#45;DECRYPT." alt="" coords="124,153,327,179"/>
<area shape="rect" href="classCrypt__RSA.html#a47bed67c0d9c4ecc11da13e0ad3cddb0" title="RSAES&#45;PKCS1&#45;V1_5&#45;ENCRYPT." alt="" coords="124,203,327,228"/>
<area shape="rect" href="classCrypt__RSA.html#a7919feaaf410567587520ae62d0f375a" title="RSASSA&#45;PKCS1&#45;V1_5&#45;SIGN." alt="" coords="131,252,319,277"/>
<area shape="rect" href="classCrypt__RSA.html#a9bac0d7f59f81a08f34e937e71fa4264" title="RSASSA&#45;PKCS1&#45;V1_5&#45;VERIFY." alt="" coords="148,351,303,391"/>
<area shape="rect" href="classCrypt__RSA.html#a41d7b44f4ff751df9dc5bc9a2e1a5875" title="RSASSA&#45;PSS&#45;SIGN." alt="" coords="158,301,293,327"/>
<area shape="rect" href="classCrypt__RSA.html#a14d4abcd8f2ca6604b948026e0c553ba" title="RSASSA&#45;PSS&#45;VERIFY." alt="" coords="153,416,297,441"/>
<area shape="rect" href="classCrypt__RSA.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encryption." alt="" coords="5,104,76,129"/>
<area shape="rect" href="classCrypt__RSA.html#abe0890f90bae8c6cab81312df152652b" title="Create a signature." alt="" coords="16,277,65,303"/>
<area shape="rect" href="classCrypt__RSA.html#a91b3194ffeb55cb91eb28202ea8fe666" title="Verifies a signature." alt="" coords="11,387,70,412"/>
</map>
</div>

</div>
</div>
<a id="a269d4a2cf9ac198a73cfcb4bc3b8f9b5" name="a269d4a2cf9ac198a73cfcb4bc3b8f9b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a269d4a2cf9ac198a73cfcb4bc3b8f9b5">&#9670;&#160;</a></span>_parseKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_parseKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Break a public or private key down into its constituant components. </p>
<p>@access private </p><dl class="section see"><dt>See also</dt><dd>self::_convertPublicKey() </dd>
<dd>
self::_convertPrivateKey() </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$type</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l01157">1157</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1158</span>    {</div>
<div class="line"><span class="lineno"> 1159</span>        global <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>;</div>
<div class="line"><span class="lineno"> 1160</span> </div>
<div class="line"><span class="lineno"> 1161</span>        <span class="keywordflow">if</span> ($type != <a class="code hl_variable" href="RSA_8php.html#aefa5f08fd7a48e3c6299a0bc4b35184d">CRYPT_RSA_PUBLIC_FORMAT_RAW</a> &amp;&amp; !is_string($key)) {</div>
<div class="line"><span class="lineno"> 1162</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1163</span>        }</div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span>        <span class="keywordflow">switch</span> ($type) {</div>
<div class="line"><span class="lineno"> 1166</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#aefa5f08fd7a48e3c6299a0bc4b35184d">CRYPT_RSA_PUBLIC_FORMAT_RAW</a>:</div>
<div class="line"><span class="lineno"> 1167</span>                <span class="keywordflow">if</span> (!is_array($key)) {</div>
<div class="line"><span class="lineno"> 1168</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1169</span>                }</div>
<div class="line"><span class="lineno"> 1170</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a> = array();</div>
<div class="line"><span class="lineno"> 1171</span>                <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 1172</span>                    <span class="keywordflow">case</span> isset($key[<span class="charliteral">&#39;e&#39;</span>]):</div>
<div class="line"><span class="lineno"> 1173</span>                        <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;publicExponent&#39;</span>] = $key[<span class="stringliteral">&#39;e&#39;</span>]-&gt;copy();</div>
<div class="line"><span class="lineno"> 1174</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1175</span>                    <span class="keywordflow">case</span> isset($key[<span class="stringliteral">&#39;exponent&#39;</span>]):</div>
<div class="line"><span class="lineno"> 1176</span>                        <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;publicExponent&#39;</span>] = $key[<span class="stringliteral">&#39;exponent&#39;</span>]-&gt;copy();</div>
<div class="line"><span class="lineno"> 1177</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1178</span>                    <span class="keywordflow">case</span> isset($key[<span class="stringliteral">&#39;publicExponent&#39;</span>]):</div>
<div class="line"><span class="lineno"> 1179</span>                        <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;publicExponent&#39;</span>] = $key[<span class="stringliteral">&#39;publicExponent&#39;</span>]-&gt;copy();</div>
<div class="line"><span class="lineno"> 1180</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1181</span>                    <span class="keywordflow">case</span> isset($key[0]):</div>
<div class="line"><span class="lineno"> 1182</span>                        <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;publicExponent&#39;</span>] = $key[0]-&gt;copy();</div>
<div class="line"><span class="lineno"> 1183</span>                }</div>
<div class="line"><span class="lineno"> 1184</span>                <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 1185</span>                    <span class="keywordflow">case</span> isset($key[<span class="charliteral">&#39;n&#39;</span>]):</div>
<div class="line"><span class="lineno"> 1186</span>                        <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;modulus&#39;</span>] = $key[<span class="stringliteral">&#39;n&#39;</span>]-&gt;copy();</div>
<div class="line"><span class="lineno"> 1187</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1188</span>                    <span class="keywordflow">case</span> isset($key[<span class="stringliteral">&#39;modulo&#39;</span>]):</div>
<div class="line"><span class="lineno"> 1189</span>                        <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;modulus&#39;</span>] = $key[<span class="stringliteral">&#39;modulo&#39;</span>]-&gt;copy();</div>
<div class="line"><span class="lineno"> 1190</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1191</span>                    <span class="keywordflow">case</span> isset($key[<span class="stringliteral">&#39;modulus&#39;</span>]):</div>
<div class="line"><span class="lineno"> 1192</span>                        <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;modulus&#39;</span>] = $key[<span class="stringliteral">&#39;modulus&#39;</span>]-&gt;copy();</div>
<div class="line"><span class="lineno"> 1193</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1194</span>                    <span class="keywordflow">case</span> isset($key[1]):</div>
<div class="line"><span class="lineno"> 1195</span>                        <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;modulus&#39;</span>] = $key[1]-&gt;copy();</div>
<div class="line"><span class="lineno"> 1196</span>                }</div>
<div class="line"><span class="lineno"> 1197</span>                <span class="keywordflow">return</span> isset($components[<span class="stringliteral">&#39;modulus&#39;</span>]) &amp;&amp; isset($components[<span class="stringliteral">&#39;publicExponent&#39;</span>]) ? <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a> : <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1198</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#a72160567057c92a07f17877a8e6a1465">CRYPT_RSA_PRIVATE_FORMAT_PKCS1</a>:</div>
<div class="line"><span class="lineno"> 1199</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#a52ff67a766f547b0fd9d895b57253789">CRYPT_RSA_PRIVATE_FORMAT_PKCS8</a>:</div>
<div class="line"><span class="lineno"> 1200</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#a15eeb8d9dc1af1411f1549d4702c8a00">CRYPT_RSA_PUBLIC_FORMAT_PKCS1</a>:</div>
<div class="line"><span class="lineno"> 1201</span>                <span class="comment">/* Although PKCS#1 proposes a format that public and private keys can use, encrypting them is</span></div>
<div class="line"><span class="lineno"> 1202</span><span class="comment">                   &quot;outside the scope&quot; of PKCS#1.  PKCS#1 then refers you to PKCS#12 and PKCS#15 if you&#39;re wanting to</span></div>
<div class="line"><span class="lineno"> 1203</span><span class="comment">                   protect private keys, however, that&#39;s not what OpenSSL* does.  OpenSSL protects private keys by adding</span></div>
<div class="line"><span class="lineno"> 1204</span><span class="comment">                   two new &quot;fields&quot; to the key - DEK-Info and Proc-Type.  These fields are discussed here:</span></div>
<div class="line"><span class="lineno"> 1205</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1206</span><span class="comment">                   http://tools.ietf.org/html/rfc1421#section-4.6.1.1</span></div>
<div class="line"><span class="lineno"> 1207</span><span class="comment">                   http://tools.ietf.org/html/rfc1421#section-4.6.1.3</span></div>
<div class="line"><span class="lineno"> 1208</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1209</span><span class="comment">                   DES-EDE3-CBC as an algorithm, however, is not discussed anywhere, near as I can tell.</span></div>
<div class="line"><span class="lineno"> 1210</span><span class="comment">                   DES-CBC and DES-EDE are discussed in RFC1423, however, DES-EDE3-CBC isn&#39;t, nor is its key derivation</span></div>
<div class="line"><span class="lineno"> 1211</span><span class="comment">                   function.  As is, the definitive authority on this encoding scheme isn&#39;t the IETF but rather OpenSSL&#39;s</span></div>
<div class="line"><span class="lineno"> 1212</span><span class="comment">                   own implementation.  ie. the implementation *is* the standard and any bugs that may exist in that</span></div>
<div class="line"><span class="lineno"> 1213</span><span class="comment">                   implementation are part of the standard, as well.</span></div>
<div class="line"><span class="lineno"> 1214</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1215</span><span class="comment">                   * OpenSSL is the de facto standard.  It&#39;s utilized by OpenSSH and other projects */</span></div>
<div class="line"><span class="lineno"> 1216</span>                <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;#DEK-Info: (.+),(.+)#&#39;</span>, $key, $matches)) {</div>
<div class="line"><span class="lineno"> 1217</span>                    $iv = pack(<span class="stringliteral">&#39;H*&#39;</span>, trim($matches[2]));</div>
<div class="line"><span class="lineno"> 1218</span>                    $symkey = pack(<span class="stringliteral">&#39;H*&#39;</span>, md5($this-&gt;password . substr($iv, 0, 8))); <span class="comment">// symkey is short for symmetric key</span></div>
<div class="line"><span class="lineno"> 1219</span>                    $symkey.= pack(<span class="stringliteral">&#39;H*&#39;</span>, md5($symkey . $this-&gt;password . substr($iv, 0, 8)));</div>
<div class="line"><span class="lineno"> 1220</span>                    <span class="comment">// remove the Proc-Type / DEK-Info sections as they&#39;re no longer needed</span></div>
<div class="line"><span class="lineno"> 1221</span>                    $key = preg_replace(<span class="stringliteral">&#39;#^(?:Proc-Type|DEK-Info): .*#m&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $key);</div>
<div class="line"><span class="lineno"> 1222</span>                    $ciphertext = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a009e0a2396931d62c87d27f4e2372024">_extractBER</a>($key);</div>
<div class="line"><span class="lineno"> 1223</span>                    <span class="keywordflow">if</span> ($ciphertext === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1224</span>                        $ciphertext = $key;</div>
<div class="line"><span class="lineno"> 1225</span>                    }</div>
<div class="line"><span class="lineno"> 1226</span>                    <span class="keywordflow">switch</span> ($matches[1]) {</div>
<div class="line"><span class="lineno"> 1227</span>                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;AES-256-CBC&#39;</span>:</div>
<div class="line"><span class="lineno"> 1228</span>                            <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_AES&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 1229</span>                                include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/AES.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 1230</span>                            }</div>
<div class="line"><span class="lineno"> 1231</span>                            $crypto = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__AES.html">Crypt_AES</a>();</div>
<div class="line"><span class="lineno"> 1232</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1233</span>                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;AES-128-CBC&#39;</span>:</div>
<div class="line"><span class="lineno"> 1234</span>                            <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_AES&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 1235</span>                                include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/AES.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 1236</span>                            }</div>
<div class="line"><span class="lineno"> 1237</span>                            $symkey = substr($symkey, 0, 16);</div>
<div class="line"><span class="lineno"> 1238</span>                            $crypto = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__AES.html">Crypt_AES</a>();</div>
<div class="line"><span class="lineno"> 1239</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1240</span>                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;DES-EDE3-CFB&#39;</span>:</div>
<div class="line"><span class="lineno"> 1241</span>                            <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_TripleDES&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 1242</span>                                include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/TripleDES.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 1243</span>                            }</div>
<div class="line"><span class="lineno"> 1244</span>                            $crypto = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__TripleDES.html">Crypt_TripleDES</a>(<a class="code hl_variable" href="DES_8php.html#a27e44c5f752c39733ebbd21170d527f0">CRYPT_DES_MODE_CFB</a>);</div>
<div class="line"><span class="lineno"> 1245</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1246</span>                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;DES-EDE3-CBC&#39;</span>:</div>
<div class="line"><span class="lineno"> 1247</span>                            <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_TripleDES&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 1248</span>                                include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/TripleDES.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 1249</span>                            }</div>
<div class="line"><span class="lineno"> 1250</span>                            $symkey = substr($symkey, 0, 24);</div>
<div class="line"><span class="lineno"> 1251</span>                            $crypto = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__TripleDES.html">Crypt_TripleDES</a>();</div>
<div class="line"><span class="lineno"> 1252</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1253</span>                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;DES-CBC&#39;</span>:</div>
<div class="line"><span class="lineno"> 1254</span>                            <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_DES&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 1255</span>                                include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/DES.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 1256</span>                            }</div>
<div class="line"><span class="lineno"> 1257</span>                            $crypto = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__DES.html">Crypt_DES</a>();</div>
<div class="line"><span class="lineno"> 1258</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1259</span>                        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1260</span>                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1261</span>                    }</div>
<div class="line"><span class="lineno"> 1262</span>                    $crypto-&gt;setKey($symkey);</div>
<div class="line"><span class="lineno"> 1263</span>                    $crypto-&gt;setIV($iv);</div>
<div class="line"><span class="lineno"> 1264</span>                    $decoded = $crypto-&gt;decrypt($ciphertext);</div>
<div class="line"><span class="lineno"> 1265</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1266</span>                    $decoded = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a009e0a2396931d62c87d27f4e2372024">_extractBER</a>($key);</div>
<div class="line"><span class="lineno"> 1267</span>                }</div>
<div class="line"><span class="lineno"> 1268</span> </div>
<div class="line"><span class="lineno"> 1269</span>                <span class="keywordflow">if</span> ($decoded !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1270</span>                    $key = $decoded;</div>
<div class="line"><span class="lineno"> 1271</span>                }</div>
<div class="line"><span class="lineno"> 1272</span> </div>
<div class="line"><span class="lineno"> 1273</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a> = array();</div>
<div class="line"><span class="lineno"> 1274</span> </div>
<div class="line"><span class="lineno"> 1275</span>                <span class="keywordflow">if</span> (ord($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key)) != <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>) {</div>
<div class="line"><span class="lineno"> 1276</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1277</span>                }</div>
<div class="line"><span class="lineno"> 1278</span>                <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key) != strlen($key)) {</div>
<div class="line"><span class="lineno"> 1279</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1280</span>                }</div>
<div class="line"><span class="lineno"> 1281</span> </div>
<div class="line"><span class="lineno"> 1282</span>                $tag = ord($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key));</div>
<div class="line"><span class="lineno"> 1283</span>                <span class="comment">/* intended for keys for which OpenSSL&#39;s asn1parse returns the following:</span></div>
<div class="line"><span class="lineno"> 1284</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1285</span><span class="comment">                    0:d=0  hl=4 l= 631 cons: SEQUENCE</span></div>
<div class="line"><span class="lineno"> 1286</span><span class="comment">                    4:d=1  hl=2 l=   1 prim:  INTEGER           :00</span></div>
<div class="line"><span class="lineno"> 1287</span><span class="comment">                    7:d=1  hl=2 l=  13 cons:  SEQUENCE</span></div>
<div class="line"><span class="lineno"> 1288</span><span class="comment">                    9:d=2  hl=2 l=   9 prim:   OBJECT            :rsaEncryption</span></div>
<div class="line"><span class="lineno"> 1289</span><span class="comment">                   20:d=2  hl=2 l=   0 prim:   NULL</span></div>
<div class="line"><span class="lineno"> 1290</span><span class="comment">                   22:d=1  hl=4 l= 609 prim:  OCTET STRING</span></div>
<div class="line"><span class="lineno"> 1291</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1292</span><span class="comment">                   ie. PKCS8 keys*/</span></div>
<div class="line"><span class="lineno"> 1293</span> </div>
<div class="line"><span class="lineno"> 1294</span>                <span class="keywordflow">if</span> ($tag == <a class="code hl_variable" href="RSA_8php.html#a4da67fb1e37ca9dc84a0a8b54707b76a">CRYPT_RSA_ASN1_INTEGER</a> &amp;&amp; substr($key, 0, 3) == <span class="stringliteral">&quot;\x01\x00\x30&quot;</span>) {</div>
<div class="line"><span class="lineno"> 1295</span>                    $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, 3);</div>
<div class="line"><span class="lineno"> 1296</span>                    $tag = <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>;</div>
<div class="line"><span class="lineno"> 1297</span>                }</div>
<div class="line"><span class="lineno"> 1298</span> </div>
<div class="line"><span class="lineno"> 1299</span>                <span class="keywordflow">if</span> ($tag == <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>) {</div>
<div class="line"><span class="lineno"> 1300</span>                    $temp = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key));</div>
<div class="line"><span class="lineno"> 1301</span>                    <span class="keywordflow">if</span> (ord($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($temp)) != <a class="code hl_variable" href="RSA_8php.html#ab9ee890fc2ddebc146db7e951b871cc0">CRYPT_RSA_ASN1_OBJECT</a>) {</div>
<div class="line"><span class="lineno"> 1302</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1303</span>                    }</div>
<div class="line"><span class="lineno"> 1304</span>                    $length = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($temp);</div>
<div class="line"><span class="lineno"> 1305</span>                    <span class="keywordflow">switch</span> ($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($temp, $length)) {</div>
<div class="line"><span class="lineno"> 1306</span>                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;\x2a\x86\x48\x86\xf7\x0d\x01\x01\x01&quot;</span>: <span class="comment">// rsaEncryption</span></div>
<div class="line"><span class="lineno"> 1307</span>                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;\x2A\x86\x48\x86\xF7\x0D\x01\x01\x0A&quot;</span>: <span class="comment">// rsaPSS</span></div>
<div class="line"><span class="lineno"> 1308</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1309</span>                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;\x2a\x86\x48\x86\xf7\x0d\x01\x05\x03&quot;</span>: <span class="comment">// pbeWithMD5AndDES-CBC</span></div>
<div class="line"><span class="lineno"> 1310</span>                            <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1311</span><span class="comment">                               PBEParameter ::= SEQUENCE {</span></div>
<div class="line"><span class="lineno"> 1312</span><span class="comment">                                   salt OCTET STRING (SIZE(8)),</span></div>
<div class="line"><span class="lineno"> 1313</span><span class="comment">                                   iterationCount INTEGER }</span></div>
<div class="line"><span class="lineno"> 1314</span><span class="comment">                            */</span></div>
<div class="line"><span class="lineno"> 1315</span>                            <span class="keywordflow">if</span> (ord($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($temp)) != <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>) {</div>
<div class="line"><span class="lineno"> 1316</span>                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1317</span>                            }</div>
<div class="line"><span class="lineno"> 1318</span>                            <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($temp) != strlen($temp)) {</div>
<div class="line"><span class="lineno"> 1319</span>                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1320</span>                            }</div>
<div class="line"><span class="lineno"> 1321</span>                            $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($temp); <span class="comment">// assume it&#39;s an octet string</span></div>
<div class="line"><span class="lineno"> 1322</span>                            $salt = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($temp, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($temp));</div>
<div class="line"><span class="lineno"> 1323</span>                            <span class="keywordflow">if</span> (ord($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($temp)) != <a class="code hl_variable" href="RSA_8php.html#a4da67fb1e37ca9dc84a0a8b54707b76a">CRYPT_RSA_ASN1_INTEGER</a>) {</div>
<div class="line"><span class="lineno"> 1324</span>                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1325</span>                            }</div>
<div class="line"><span class="lineno"> 1326</span>                            $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($temp);</div>
<div class="line"><span class="lineno"> 1327</span>                            list(, $iterationCount) = unpack(<span class="charliteral">&#39;N&#39;</span>, str_pad($temp, 4, chr(0), STR_PAD_LEFT));</div>
<div class="line"><span class="lineno"> 1328</span>                            $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key); <span class="comment">// assume it&#39;s an octet string</span></div>
<div class="line"><span class="lineno"> 1329</span>                            $length = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1330</span>                            <span class="keywordflow">if</span> (strlen($key) != $length) {</div>
<div class="line"><span class="lineno"> 1331</span>                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1332</span>                            }</div>
<div class="line"><span class="lineno"> 1333</span> </div>
<div class="line"><span class="lineno"> 1334</span>                            <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_DES&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 1335</span>                                include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/DES.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 1336</span>                            }</div>
<div class="line"><span class="lineno"> 1337</span>                            $crypto = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__DES.html">Crypt_DES</a>();</div>
<div class="line"><span class="lineno"> 1338</span>                            $crypto-&gt;setPassword($this-&gt;password, <span class="stringliteral">&#39;pbkdf1&#39;</span>, <span class="stringliteral">&#39;md5&#39;</span>, $salt, $iterationCount);</div>
<div class="line"><span class="lineno"> 1339</span>                            $key = $crypto-&gt;decrypt($key);</div>
<div class="line"><span class="lineno"> 1340</span>                            <span class="keywordflow">if</span> ($key === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1341</span>                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1342</span>                            }</div>
<div class="line"><span class="lineno"> 1343</span>                            <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5">_parseKey</a>($key, <a class="code hl_variable" href="RSA_8php.html#a72160567057c92a07f17877a8e6a1465">CRYPT_RSA_PRIVATE_FORMAT_PKCS1</a>);</div>
<div class="line"><span class="lineno"> 1344</span>                        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1345</span>                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1346</span>                    }</div>
<div class="line"><span class="lineno"> 1347</span>                    <span class="comment">/* intended for keys for which OpenSSL&#39;s asn1parse returns the following:</span></div>
<div class="line"><span class="lineno"> 1348</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1349</span><span class="comment">                        0:d=0  hl=4 l= 290 cons: SEQUENCE</span></div>
<div class="line"><span class="lineno"> 1350</span><span class="comment">                        4:d=1  hl=2 l=  13 cons:  SEQUENCE</span></div>
<div class="line"><span class="lineno"> 1351</span><span class="comment">                        6:d=2  hl=2 l=   9 prim:   OBJECT            :rsaEncryption</span></div>
<div class="line"><span class="lineno"> 1352</span><span class="comment">                       17:d=2  hl=2 l=   0 prim:   NULL</span></div>
<div class="line"><span class="lineno"> 1353</span><span class="comment">                       19:d=1  hl=4 l= 271 prim:  BIT STRING */</span></div>
<div class="line"><span class="lineno"> 1354</span>                    $tag = ord($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key)); <span class="comment">// skip over the BIT STRING / OCTET STRING tag</span></div>
<div class="line"><span class="lineno"> 1355</span>                    $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key); <span class="comment">// skip over the BIT STRING / OCTET STRING length</span></div>
<div class="line"><span class="lineno"> 1356</span>                    <span class="comment">// &quot;The initial octet shall encode, as an unsigned binary integer wtih bit 1 as the least significant bit, the number of</span></div>
<div class="line"><span class="lineno"> 1357</span>                    <span class="comment">//  unused bits in the final subsequent octet. The number shall be in the range zero to seven.&quot;</span></div>
<div class="line"><span class="lineno"> 1358</span>                    <span class="comment">//  -- http://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf (section 8.6.2.2)</span></div>
<div class="line"><span class="lineno"> 1359</span>                    <span class="keywordflow">if</span> ($tag == <a class="code hl_variable" href="RSA_8php.html#ade97d3ebeb5b790cfd5233ff28e6e39f">CRYPT_RSA_ASN1_BITSTRING</a>) {</div>
<div class="line"><span class="lineno"> 1360</span>                        $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key);</div>
<div class="line"><span class="lineno"> 1361</span>                    }</div>
<div class="line"><span class="lineno"> 1362</span>                    <span class="keywordflow">if</span> (ord($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key)) != <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>) {</div>
<div class="line"><span class="lineno"> 1363</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1364</span>                    }</div>
<div class="line"><span class="lineno"> 1365</span>                    <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key) != strlen($key)) {</div>
<div class="line"><span class="lineno"> 1366</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1367</span>                    }</div>
<div class="line"><span class="lineno"> 1368</span>                    $tag = ord($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key));</div>
<div class="line"><span class="lineno"> 1369</span>                }</div>
<div class="line"><span class="lineno"> 1370</span>                <span class="keywordflow">if</span> ($tag != <a class="code hl_variable" href="RSA_8php.html#a4da67fb1e37ca9dc84a0a8b54707b76a">CRYPT_RSA_ASN1_INTEGER</a>) {</div>
<div class="line"><span class="lineno"> 1371</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1372</span>                }</div>
<div class="line"><span class="lineno"> 1373</span> </div>
<div class="line"><span class="lineno"> 1374</span>                $length = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1375</span>                $temp = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length);</div>
<div class="line"><span class="lineno"> 1376</span>                <span class="keywordflow">if</span> (strlen($temp) != 1 || ord($temp) &gt; 2) {</div>
<div class="line"><span class="lineno"> 1377</span>                    <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;modulus&#39;</span>] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($temp, 256);</div>
<div class="line"><span class="lineno"> 1378</span>                    $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key); <span class="comment">// skip over CRYPT_RSA_ASN1_INTEGER</span></div>
<div class="line"><span class="lineno"> 1379</span>                    $length = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1380</span>                    <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[$type == <a class="code hl_variable" href="RSA_8php.html#a15eeb8d9dc1af1411f1549d4702c8a00">CRYPT_RSA_PUBLIC_FORMAT_PKCS1</a> ? <span class="stringliteral">&#39;publicExponent&#39;</span> : <span class="stringliteral">&#39;privateExponent&#39;</span>] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length), 256);</div>
<div class="line"><span class="lineno"> 1381</span> </div>
<div class="line"><span class="lineno"> 1382</span>                    <span class="keywordflow">return</span> <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>;</div>
<div class="line"><span class="lineno"> 1383</span>                }</div>
<div class="line"><span class="lineno"> 1384</span>                <span class="keywordflow">if</span> (ord($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key)) != <a class="code hl_variable" href="RSA_8php.html#a4da67fb1e37ca9dc84a0a8b54707b76a">CRYPT_RSA_ASN1_INTEGER</a>) {</div>
<div class="line"><span class="lineno"> 1385</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1386</span>                }</div>
<div class="line"><span class="lineno"> 1387</span>                $length = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1388</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;modulus&#39;</span>] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length), 256);</div>
<div class="line"><span class="lineno"> 1389</span>                $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key);</div>
<div class="line"><span class="lineno"> 1390</span>                $length = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1391</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;publicExponent&#39;</span>] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length), 256);</div>
<div class="line"><span class="lineno"> 1392</span>                $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key);</div>
<div class="line"><span class="lineno"> 1393</span>                $length = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1394</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;privateExponent&#39;</span>] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length), 256);</div>
<div class="line"><span class="lineno"> 1395</span>                $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key);</div>
<div class="line"><span class="lineno"> 1396</span>                $length = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1397</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;primes&#39;</span>] = array(1 =&gt; <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length), 256));</div>
<div class="line"><span class="lineno"> 1398</span>                $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key);</div>
<div class="line"><span class="lineno"> 1399</span>                $length = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1400</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;primes&#39;</span>][] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length), 256);</div>
<div class="line"><span class="lineno"> 1401</span>                $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key);</div>
<div class="line"><span class="lineno"> 1402</span>                $length = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1403</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;exponents&#39;</span>] = array(1 =&gt; <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length), 256));</div>
<div class="line"><span class="lineno"> 1404</span>                $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key);</div>
<div class="line"><span class="lineno"> 1405</span>                $length = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1406</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;exponents&#39;</span>][] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length), 256);</div>
<div class="line"><span class="lineno"> 1407</span>                $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key);</div>
<div class="line"><span class="lineno"> 1408</span>                $length = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1409</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;coefficients&#39;</span>] = array(2 =&gt; <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length), 256));</div>
<div class="line"><span class="lineno"> 1410</span> </div>
<div class="line"><span class="lineno"> 1411</span>                <span class="keywordflow">if</span> (!empty($key)) {</div>
<div class="line"><span class="lineno"> 1412</span>                    <span class="keywordflow">if</span> (ord($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key)) != <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>) {</div>
<div class="line"><span class="lineno"> 1413</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1414</span>                    }</div>
<div class="line"><span class="lineno"> 1415</span>                    $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1416</span>                    <span class="keywordflow">while</span> (!empty($key)) {</div>
<div class="line"><span class="lineno"> 1417</span>                        <span class="keywordflow">if</span> (ord($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key)) != <a class="code hl_variable" href="RSA_8php.html#a9806a4116e85771b38ccbe23b0ede937">CRYPT_RSA_ASN1_SEQUENCE</a>) {</div>
<div class="line"><span class="lineno"> 1418</span>                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1419</span>                        }</div>
<div class="line"><span class="lineno"> 1420</span>                        $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1421</span>                        $key = substr($key, 1);</div>
<div class="line"><span class="lineno"> 1422</span>                        $length = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1423</span>                        <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;primes&#39;</span>][] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length), 256);</div>
<div class="line"><span class="lineno"> 1424</span>                        $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key);</div>
<div class="line"><span class="lineno"> 1425</span>                        $length = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1426</span>                        <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;exponents&#39;</span>][] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length), 256);</div>
<div class="line"><span class="lineno"> 1427</span>                        $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key);</div>
<div class="line"><span class="lineno"> 1428</span>                        $length = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">_decodeLength</a>($key);</div>
<div class="line"><span class="lineno"> 1429</span>                        <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;coefficients&#39;</span>][] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length), 256);</div>
<div class="line"><span class="lineno"> 1430</span>                    }</div>
<div class="line"><span class="lineno"> 1431</span>                }</div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span>                <span class="keywordflow">return</span> <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>;</div>
<div class="line"><span class="lineno"> 1434</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#ad392896470610c196028e017e2c5e00c">CRYPT_RSA_PUBLIC_FORMAT_OPENSSH</a>:</div>
<div class="line"><span class="lineno"> 1435</span>                $parts = explode(<span class="charliteral">&#39; &#39;</span>, $key, 3);</div>
<div class="line"><span class="lineno"> 1436</span> </div>
<div class="line"><span class="lineno"> 1437</span>                $key = isset($parts[1]) ? base64_decode($parts[1]) : false;</div>
<div class="line"><span class="lineno"> 1438</span>                <span class="keywordflow">if</span> ($key === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1439</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1440</span>                }</div>
<div class="line"><span class="lineno"> 1441</span> </div>
<div class="line"><span class="lineno"> 1442</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a536677acc0163c53c067316a97456e6c">$comment</a> = isset($parts[2]) ? $parts[2] : <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1443</span> </div>
<div class="line"><span class="lineno"> 1444</span>                $cleanup = substr($key, 0, 11) == <span class="stringliteral">&quot;\0\0\0\7ssh-rsa&quot;</span>;</div>
<div class="line"><span class="lineno"> 1445</span> </div>
<div class="line"><span class="lineno"> 1446</span>                <span class="keywordflow">if</span> (strlen($key) &lt;= 4) {</div>
<div class="line"><span class="lineno"> 1447</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1448</span>                }</div>
<div class="line"><span class="lineno"> 1449</span>                extract(unpack(<span class="stringliteral">&#39;Nlength&#39;</span>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, 4)));</div>
<div class="line"><span class="lineno"> 1450</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a67c17fc0cf6463311de6c63b2cdf2d67">$publicExponent</a> = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length), -256);</div>
<div class="line"><span class="lineno"> 1451</span>                <span class="keywordflow">if</span> (strlen($key) &lt;= 4) {</div>
<div class="line"><span class="lineno"> 1452</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1453</span>                }</div>
<div class="line"><span class="lineno"> 1454</span>                extract(unpack(<span class="stringliteral">&#39;Nlength&#39;</span>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, 4)));</div>
<div class="line"><span class="lineno"> 1455</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a17709e191d11322c1bbca0b4c2533b6a">$modulus</a> = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length), -256);</div>
<div class="line"><span class="lineno"> 1456</span> </div>
<div class="line"><span class="lineno"> 1457</span>                <span class="keywordflow">if</span> ($cleanup &amp;&amp; strlen($key)) {</div>
<div class="line"><span class="lineno"> 1458</span>                    <span class="keywordflow">if</span> (strlen($key) &lt;= 4) {</div>
<div class="line"><span class="lineno"> 1459</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1460</span>                    }</div>
<div class="line"><span class="lineno"> 1461</span>                    extract(unpack(<span class="stringliteral">&#39;Nlength&#39;</span>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, 4)));</div>
<div class="line"><span class="lineno"> 1462</span>                    $realModulus = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($key, $length), -256);</div>
<div class="line"><span class="lineno"> 1463</span>                    <span class="keywordflow">return</span> strlen($key) ? false : array(</div>
<div class="line"><span class="lineno"> 1464</span>                        <span class="stringliteral">&#39;modulus&#39;</span> =&gt; $realModulus,</div>
<div class="line"><span class="lineno"> 1465</span>                        <span class="stringliteral">&#39;publicExponent&#39;</span> =&gt; $modulus,</div>
<div class="line"><span class="lineno"> 1466</span>                        <span class="stringliteral">&#39;comment&#39;</span> =&gt; $comment</div>
<div class="line"><span class="lineno"> 1467</span>                    );</div>
<div class="line"><span class="lineno"> 1468</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1469</span>                    <span class="keywordflow">return</span> strlen($key) ? false : array(</div>
<div class="line"><span class="lineno"> 1470</span>                        <span class="stringliteral">&#39;modulus&#39;</span> =&gt; $modulus,</div>
<div class="line"><span class="lineno"> 1471</span>                        <span class="stringliteral">&#39;publicExponent&#39;</span> =&gt; $publicExponent,</div>
<div class="line"><span class="lineno"> 1472</span>                        <span class="stringliteral">&#39;comment&#39;</span> =&gt; $comment</div>
<div class="line"><span class="lineno"> 1473</span>                    );</div>
<div class="line"><span class="lineno"> 1474</span>                }</div>
<div class="line"><span class="lineno"> 1475</span>            <span class="comment">// http://www.w3.org/TR/xmldsig-core/#sec-RSAKeyValue</span></div>
<div class="line"><span class="lineno"> 1476</span>            <span class="comment">// http://en.wikipedia.org/wiki/XML_Signature</span></div>
<div class="line"><span class="lineno"> 1477</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#a079b3a2b5b60dd742b6801f5fb426a8b">CRYPT_RSA_PRIVATE_FORMAT_XML</a>:</div>
<div class="line"><span class="lineno"> 1478</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#a31bc387c1d18654ce5877d588a0b0a89">CRYPT_RSA_PUBLIC_FORMAT_XML</a>:</div>
<div class="line"><span class="lineno"> 1479</span>                $this-&gt;components = array();</div>
<div class="line"><span class="lineno"> 1480</span> </div>
<div class="line"><span class="lineno"> 1481</span>                $xml = xml_parser_create(<span class="stringliteral">&#39;UTF-8&#39;</span>);</div>
<div class="line"><span class="lineno"> 1482</span>                xml_set_object($xml, $this);</div>
<div class="line"><span class="lineno"> 1483</span>                xml_set_element_handler($xml, <span class="stringliteral">&#39;_start_element_handler&#39;</span>, <span class="stringliteral">&#39;_stop_element_handler&#39;</span>);</div>
<div class="line"><span class="lineno"> 1484</span>                xml_set_character_data_handler($xml, <span class="stringliteral">&#39;_data_handler&#39;</span>);</div>
<div class="line"><span class="lineno"> 1485</span>                <span class="comment">// add &lt;xml&gt;&lt;/xml&gt; to account for &quot;dangling&quot; tags like &lt;BitStrength&gt;...&lt;/BitStrength&gt; that are sometimes added</span></div>
<div class="line"><span class="lineno"> 1486</span>                <span class="keywordflow">if</span> (!xml_parse($xml, <span class="stringliteral">&#39;&lt;xml&gt;&#39;</span> . $key . <span class="stringliteral">&#39;&lt;/xml&gt;&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 1487</span>                    xml_parser_free($xml);</div>
<div class="line"><span class="lineno"> 1488</span>                    unset($xml);</div>
<div class="line"><span class="lineno"> 1489</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1490</span>                }</div>
<div class="line"><span class="lineno"> 1491</span> </div>
<div class="line"><span class="lineno"> 1492</span>                xml_parser_free($xml);</div>
<div class="line"><span class="lineno"> 1493</span>                unset($xml);</div>
<div class="line"><span class="lineno"> 1494</span> </div>
<div class="line"><span class="lineno"> 1495</span>                <span class="keywordflow">return</span> isset($this-&gt;components[<span class="stringliteral">&#39;modulus&#39;</span>]) &amp;&amp; isset($this-&gt;components[<span class="stringliteral">&#39;publicExponent&#39;</span>]) ? $this-&gt;components : <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1496</span>            <span class="comment">// from PuTTY&#39;s SSHPUBK.C</span></div>
<div class="line"><span class="lineno"> 1497</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#a20b24fa8e7681b564ff3085d4c1d5406">CRYPT_RSA_PRIVATE_FORMAT_PUTTY</a>:</div>
<div class="line"><span class="lineno"> 1498</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a> = array();</div>
<div class="line"><span class="lineno"> 1499</span>                $key = preg_split(<span class="stringliteral">&#39;#\r\n|\r|\n#&#39;</span>, $key);</div>
<div class="line"><span class="lineno"> 1500</span>                $type = trim(preg_replace(<span class="stringliteral">&#39;#PuTTY-User-Key-File-2: (.+)#&#39;</span>, <span class="stringliteral">&#39;$1&#39;</span>, $key[0]));</div>
<div class="line"><span class="lineno"> 1501</span>                <span class="keywordflow">if</span> ($type != <span class="stringliteral">&#39;ssh-rsa&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1502</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1503</span>                }</div>
<div class="line"><span class="lineno"> 1504</span>                $encryption = trim(preg_replace(<span class="stringliteral">&#39;#Encryption: (.+)#&#39;</span>, <span class="stringliteral">&#39;$1&#39;</span>, $key[1]));</div>
<div class="line"><span class="lineno"> 1505</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a536677acc0163c53c067316a97456e6c">$comment</a> = trim(preg_replace(<span class="stringliteral">&#39;#Comment: (.+)#&#39;</span>, <span class="stringliteral">&#39;$1&#39;</span>, $key[2]));</div>
<div class="line"><span class="lineno"> 1506</span> </div>
<div class="line"><span class="lineno"> 1507</span>                $publicLength = trim(preg_replace(<span class="stringliteral">&#39;#Public-Lines: (\d+)#&#39;</span>, <span class="stringliteral">&#39;$1&#39;</span>, $key[3]));</div>
<div class="line"><span class="lineno"> 1508</span>                $public = base64_decode(implode(<span class="stringliteral">&#39;&#39;</span>, array_map(<span class="stringliteral">&#39;trim&#39;</span>, array_slice($key, 4, $publicLength))));</div>
<div class="line"><span class="lineno"> 1509</span>                $public = substr($public, 11);</div>
<div class="line"><span class="lineno"> 1510</span>                extract(unpack(<span class="stringliteral">&#39;Nlength&#39;</span>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($public, 4)));</div>
<div class="line"><span class="lineno"> 1511</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;publicExponent&#39;</span>] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($public, $length), -256);</div>
<div class="line"><span class="lineno"> 1512</span>                extract(unpack(<span class="stringliteral">&#39;Nlength&#39;</span>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($public, 4)));</div>
<div class="line"><span class="lineno"> 1513</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;modulus&#39;</span>] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($public, $length), -256);</div>
<div class="line"><span class="lineno"> 1514</span> </div>
<div class="line"><span class="lineno"> 1515</span>                $privateLength = trim(preg_replace(<span class="stringliteral">&#39;#Private-Lines: (\d+)#&#39;</span>, <span class="stringliteral">&#39;$1&#39;</span>, $key[$publicLength + 4]));</div>
<div class="line"><span class="lineno"> 1516</span>                $private = base64_decode(implode(<span class="stringliteral">&#39;&#39;</span>, array_map(<span class="stringliteral">&#39;trim&#39;</span>, array_slice($key, $publicLength + 5, $privateLength))));</div>
<div class="line"><span class="lineno"> 1517</span> </div>
<div class="line"><span class="lineno"> 1518</span>                <span class="keywordflow">switch</span> ($encryption) {</div>
<div class="line"><span class="lineno"> 1519</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;aes256-cbc&#39;</span>:</div>
<div class="line"><span class="lineno"> 1520</span>                        <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_AES&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 1521</span>                            include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/AES.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 1522</span>                        }</div>
<div class="line"><span class="lineno"> 1523</span>                        $symkey = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1524</span>                        $sequence = 0;</div>
<div class="line"><span class="lineno"> 1525</span>                        <span class="keywordflow">while</span> (strlen($symkey) &lt; 32) {</div>
<div class="line"><span class="lineno"> 1526</span>                            $temp = pack(<span class="stringliteral">&#39;Na*&#39;</span>, $sequence++, $this-&gt;password);</div>
<div class="line"><span class="lineno"> 1527</span>                            $symkey.= pack(<span class="stringliteral">&#39;H*&#39;</span>, sha1($temp));</div>
<div class="line"><span class="lineno"> 1528</span>                        }</div>
<div class="line"><span class="lineno"> 1529</span>                        $symkey = substr($symkey, 0, 32);</div>
<div class="line"><span class="lineno"> 1530</span>                        $crypto = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__AES.html">Crypt_AES</a>();</div>
<div class="line"><span class="lineno"> 1531</span>                }</div>
<div class="line"><span class="lineno"> 1532</span> </div>
<div class="line"><span class="lineno"> 1533</span>                <span class="keywordflow">if</span> ($encryption != <span class="stringliteral">&#39;none&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1534</span>                    $crypto-&gt;setKey($symkey);</div>
<div class="line"><span class="lineno"> 1535</span>                    $crypto-&gt;disablePadding();</div>
<div class="line"><span class="lineno"> 1536</span>                    $private = $crypto-&gt;decrypt($private);</div>
<div class="line"><span class="lineno"> 1537</span>                    <span class="keywordflow">if</span> ($private === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1538</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1539</span>                    }</div>
<div class="line"><span class="lineno"> 1540</span>                }</div>
<div class="line"><span class="lineno"> 1541</span> </div>
<div class="line"><span class="lineno"> 1542</span>                extract(unpack(<span class="stringliteral">&#39;Nlength&#39;</span>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($private, 4)));</div>
<div class="line"><span class="lineno"> 1543</span>                <span class="keywordflow">if</span> (strlen($private) &lt; $length) {</div>
<div class="line"><span class="lineno"> 1544</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1545</span>                }</div>
<div class="line"><span class="lineno"> 1546</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;privateExponent&#39;</span>] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($private, $length), -256);</div>
<div class="line"><span class="lineno"> 1547</span>                extract(unpack(<span class="stringliteral">&#39;Nlength&#39;</span>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($private, 4)));</div>
<div class="line"><span class="lineno"> 1548</span>                <span class="keywordflow">if</span> (strlen($private) &lt; $length) {</div>
<div class="line"><span class="lineno"> 1549</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1550</span>                }</div>
<div class="line"><span class="lineno"> 1551</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;primes&#39;</span>] = array(1 =&gt; <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($private, $length), -256));</div>
<div class="line"><span class="lineno"> 1552</span>                extract(unpack(<span class="stringliteral">&#39;Nlength&#39;</span>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($private, 4)));</div>
<div class="line"><span class="lineno"> 1553</span>                <span class="keywordflow">if</span> (strlen($private) &lt; $length) {</div>
<div class="line"><span class="lineno"> 1554</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1555</span>                }</div>
<div class="line"><span class="lineno"> 1556</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;primes&#39;</span>][] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($private, $length), -256);</div>
<div class="line"><span class="lineno"> 1557</span> </div>
<div class="line"><span class="lineno"> 1558</span>                $temp = <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;primes&#39;</span>][1]-&gt;subtract($this-&gt;one);</div>
<div class="line"><span class="lineno"> 1559</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;exponents&#39;</span>] = array(1 =&gt; $components[<span class="stringliteral">&#39;publicExponent&#39;</span>]-&gt;modInverse($temp));</div>
<div class="line"><span class="lineno"> 1560</span>                $temp = <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;primes&#39;</span>][2]-&gt;subtract($this-&gt;one);</div>
<div class="line"><span class="lineno"> 1561</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;exponents&#39;</span>][] = <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;publicExponent&#39;</span>]-&gt;modInverse($temp);</div>
<div class="line"><span class="lineno"> 1562</span> </div>
<div class="line"><span class="lineno"> 1563</span>                extract(unpack(<span class="stringliteral">&#39;Nlength&#39;</span>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($private, 4)));</div>
<div class="line"><span class="lineno"> 1564</span>                <span class="keywordflow">if</span> (strlen($private) &lt; $length) {</div>
<div class="line"><span class="lineno"> 1565</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1566</span>                }</div>
<div class="line"><span class="lineno"> 1567</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;coefficients&#39;</span>] = array(2 =&gt; <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($private, $length), -256));</div>
<div class="line"><span class="lineno"> 1568</span> </div>
<div class="line"><span class="lineno"> 1569</span>                <span class="keywordflow">return</span> <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>;</div>
<div class="line"><span class="lineno"> 1570</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#aa33af2fe22ee3914635fe1e74bb3f8cf">CRYPT_RSA_PRIVATE_FORMAT_OPENSSH</a>:</div>
<div class="line"><span class="lineno"> 1571</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a> = array();</div>
<div class="line"><span class="lineno"> 1572</span>                $decoded = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a009e0a2396931d62c87d27f4e2372024">_extractBER</a>($key);</div>
<div class="line"><span class="lineno"> 1573</span>                $magic = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($decoded, 15);</div>
<div class="line"><span class="lineno"> 1574</span>                <span class="keywordflow">if</span> ($magic !== <span class="stringliteral">&quot;openssh-key-v1\0&quot;</span>) {</div>
<div class="line"><span class="lineno"> 1575</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1576</span>                }</div>
<div class="line"><span class="lineno"> 1577</span>                $options = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($decoded, 24);</div>
<div class="line"><span class="lineno"> 1578</span>                <span class="comment">// \0\0\0\4none = ciphername</span></div>
<div class="line"><span class="lineno"> 1579</span>                <span class="comment">// \0\0\0\4none = kdfname</span></div>
<div class="line"><span class="lineno"> 1580</span>                <span class="comment">// \0\0\0\0 = kdfoptions</span></div>
<div class="line"><span class="lineno"> 1581</span>                <span class="comment">// \0\0\0\1 = numkeys</span></div>
<div class="line"><span class="lineno"> 1582</span>                <span class="keywordflow">if</span> ($options != <span class="stringliteral">&quot;\0\0\0\4none\0\0\0\4none\0\0\0\0\0\0\0\1&quot;</span>) {</div>
<div class="line"><span class="lineno"> 1583</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1584</span>                }</div>
<div class="line"><span class="lineno"> 1585</span>                extract(unpack(<span class="stringliteral">&#39;Nlength&#39;</span>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($decoded, 4)));</div>
<div class="line"><span class="lineno"> 1586</span>                <span class="keywordflow">if</span> (strlen($decoded) &lt; $length) {</div>
<div class="line"><span class="lineno"> 1587</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1588</span>                }</div>
<div class="line"><span class="lineno"> 1589</span>                $publicKey = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($decoded, $length);</div>
<div class="line"><span class="lineno"> 1590</span>                extract(unpack(<span class="stringliteral">&#39;Nlength&#39;</span>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($decoded, 4)));</div>
<div class="line"><span class="lineno"> 1591</span>                <span class="keywordflow">if</span> (strlen($decoded) &lt; $length) {</div>
<div class="line"><span class="lineno"> 1592</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1593</span>                }</div>
<div class="line"><span class="lineno"> 1594</span>                $paddedKey = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($decoded, $length);</div>
<div class="line"><span class="lineno"> 1595</span> </div>
<div class="line"><span class="lineno"> 1596</span>                <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($publicKey, 11) !== <span class="stringliteral">&quot;\0\0\0\7ssh-rsa&quot;</span>) {</div>
<div class="line"><span class="lineno"> 1597</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1598</span>                }</div>
<div class="line"><span class="lineno"> 1599</span> </div>
<div class="line"><span class="lineno"> 1600</span>                $checkint1 = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($paddedKey, 4);</div>
<div class="line"><span class="lineno"> 1601</span>                $checkint2 = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($paddedKey, 4);</div>
<div class="line"><span class="lineno"> 1602</span>                <span class="keywordflow">if</span> (strlen($checkint1) != 4 || $checkint1 !== $checkint2) {</div>
<div class="line"><span class="lineno"> 1603</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1604</span>                }</div>
<div class="line"><span class="lineno"> 1605</span> </div>
<div class="line"><span class="lineno"> 1606</span>                <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($paddedKey, 11) !== <span class="stringliteral">&quot;\0\0\0\7ssh-rsa&quot;</span>) {</div>
<div class="line"><span class="lineno"> 1607</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1608</span>                }</div>
<div class="line"><span class="lineno"> 1609</span> </div>
<div class="line"><span class="lineno"> 1610</span>                $values = array(</div>
<div class="line"><span class="lineno"> 1611</span>                    &amp;$components[<span class="stringliteral">&#39;modulus&#39;</span>],</div>
<div class="line"><span class="lineno"> 1612</span>                    &amp;$components[<span class="stringliteral">&#39;publicExponent&#39;</span>],</div>
<div class="line"><span class="lineno"> 1613</span>                    &amp;$components[<span class="stringliteral">&#39;privateExponent&#39;</span>],</div>
<div class="line"><span class="lineno"> 1614</span>                    &amp;$components[<span class="stringliteral">&#39;coefficients&#39;</span>][2],</div>
<div class="line"><span class="lineno"> 1615</span>                    &amp;$components[<span class="stringliteral">&#39;primes&#39;</span>][1],</div>
<div class="line"><span class="lineno"> 1616</span>                    &amp;$components[<span class="stringliteral">&#39;primes&#39;</span>][2]</div>
<div class="line"><span class="lineno"> 1617</span>                );</div>
<div class="line"><span class="lineno"> 1618</span> </div>
<div class="line"><span class="lineno"> 1619</span>                <span class="keywordflow">for</span> ($i = 0; $i &lt; count($values); $i++) {</div>
<div class="line"><span class="lineno"> 1620</span>                    extract(unpack(<span class="stringliteral">&#39;Nlength&#39;</span>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($paddedKey, 4)));</div>
<div class="line"><span class="lineno"> 1621</span>                    <span class="keywordflow">if</span> (strlen($paddedKey) &lt; $length) {</div>
<div class="line"><span class="lineno"> 1622</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1623</span>                    }</div>
<div class="line"><span class="lineno"> 1624</span>                    $values[$i] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($paddedKey, $length), -256);</div>
<div class="line"><span class="lineno"> 1625</span>                }</div>
<div class="line"><span class="lineno"> 1626</span> </div>
<div class="line"><span class="lineno"> 1627</span>                extract(unpack(<span class="stringliteral">&#39;Nlength&#39;</span>, $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($paddedKey, 4)));</div>
<div class="line"><span class="lineno"> 1628</span>                <span class="keywordflow">if</span> (strlen($paddedKey) &lt; $length) {</div>
<div class="line"><span class="lineno"> 1629</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1630</span>                }</div>
<div class="line"><span class="lineno"> 1631</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;comment&#39;</span>] = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($decoded, $length);</div>
<div class="line"><span class="lineno"> 1632</span> </div>
<div class="line"><span class="lineno"> 1633</span>                $temp = <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;primes&#39;</span>][1]-&gt;subtract($this-&gt;one);</div>
<div class="line"><span class="lineno"> 1634</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;exponents&#39;</span>] = array(1 =&gt; $components[<span class="stringliteral">&#39;publicExponent&#39;</span>]-&gt;modInverse($temp));</div>
<div class="line"><span class="lineno"> 1635</span>                $temp = <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;primes&#39;</span>][2]-&gt;subtract($this-&gt;one);</div>
<div class="line"><span class="lineno"> 1636</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;exponents&#39;</span>][] = <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;publicExponent&#39;</span>]-&gt;modInverse($temp);</div>
<div class="line"><span class="lineno"> 1637</span> </div>
<div class="line"><span class="lineno"> 1638</span>                <span class="keywordflow">return</span> <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>;</div>
<div class="line"><span class="lineno"> 1639</span>        }</div>
<div class="line"><span class="lineno"> 1640</span> </div>
<div class="line"><span class="lineno"> 1641</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1642</span>    }</div>
<div class="ttc" id="aDES_8php_html_a27e44c5f752c39733ebbd21170d527f0"><div class="ttname"><a href="DES_8php.html#a27e44c5f752c39733ebbd21170d527f0">CRYPT_DES_MODE_CFB</a></div><div class="ttdeci">const CRYPT_DES_MODE_CFB</div><div class="ttdoc">Encrypt / decrypt using the Cipher Feedback mode.</div><div class="ttdef"><b>Definition:</b> <a href="DES_8php_source.html#l00115">DES.php:115</a></div></div>
<div class="ttc" id="aRSA_8php_html_a15eeb8d9dc1af1411f1549d4702c8a00"><div class="ttname"><a href="RSA_8php.html#a15eeb8d9dc1af1411f1549d4702c8a00">CRYPT_RSA_PUBLIC_FORMAT_PKCS1</a></div><div class="ttdeci">const CRYPT_RSA_PUBLIC_FORMAT_PKCS1</div><div class="ttdoc">PKCS#1 formatted public key (raw)</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00249">RSA.php:249</a></div></div>
<div class="ttc" id="aRSA_8php_html_a72160567057c92a07f17877a8e6a1465"><div class="ttname"><a href="RSA_8php.html#a72160567057c92a07f17877a8e6a1465">CRYPT_RSA_PRIVATE_FORMAT_PKCS1</a></div><div class="ttdeci">const CRYPT_RSA_PRIVATE_FORMAT_PKCS1</div><div class="ttdoc">#+ @access public</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00200">RSA.php:200</a></div></div>
<div class="ttc" id="aRSA_8php_html_ade97d3ebeb5b790cfd5233ff28e6e39f"><div class="ttname"><a href="RSA_8php.html#ade97d3ebeb5b790cfd5233ff28e6e39f">CRYPT_RSA_ASN1_BITSTRING</a></div><div class="ttdeci">const CRYPT_RSA_ASN1_BITSTRING</div><div class="ttdoc">ASN1 Bit String.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00154">RSA.php:154</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_a009e0a2396931d62c87d27f4e2372024"><div class="ttname"><a href="classCrypt__RSA.html#a009e0a2396931d62c87d27f4e2372024">Crypt_RSA\_extractBER</a></div><div class="ttdeci">_extractBER($str)</div><div class="ttdoc">Extract raw BER from Base64 encoding.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l03336">RSA.php:3336</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_a17709e191d11322c1bbca0b4c2533b6a"><div class="ttname"><a href="classCrypt__RSA.html#a17709e191d11322c1bbca0b4c2533b6a">Crypt_RSA\$modulus</a></div><div class="ttdeci">$modulus</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00324">RSA.php:324</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_a269d4a2cf9ac198a73cfcb4bc3b8f9b5"><div class="ttname"><a href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5">Crypt_RSA\_parseKey</a></div><div class="ttdeci">_parseKey($key, $type)</div><div class="ttdoc">Break a public or private key down into its constituant components.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l01157">RSA.php:1157</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_a536677acc0163c53c067316a97456e6c"><div class="ttname"><a href="classCrypt__RSA.html#a536677acc0163c53c067316a97456e6c">Crypt_RSA\$comment</a></div><div class="ttdeci">$comment</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00486">RSA.php:486</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_a67c17fc0cf6463311de6c63b2cdf2d67"><div class="ttname"><a href="classCrypt__RSA.html#a67c17fc0cf6463311de6c63b2cdf2d67">Crypt_RSA\$publicExponent</a></div><div class="ttdeci">$publicExponent</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00436">RSA.php:436</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_ab009fa6f4ba09daa679a30e9b5bcfe35"><div class="ttname"><a href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35">Crypt_RSA\_string_shift</a></div><div class="ttdeci">_string_shift(&amp;$string, $index=1)</div><div class="ttdoc">String Shift.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l02182">RSA.php:2182</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_ae88f34bdbb000851150beff041dcb0fe"><div class="ttname"><a href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe">Crypt_RSA\_decodeLength</a></div><div class="ttdeci">_decodeLength(&amp;$string)</div><div class="ttdoc">DER-decode the length.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l02141">RSA.php:2141</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="install_8php_source.html#l00039">$VIEW_PATH</a>, <a class="el" href="RSA_8php_source.html#l02141">_decodeLength()</a>, <a class="el" href="RSA_8php_source.html#l03336">_extractBER()</a>, <a class="el" href="RSA_8php_source.html#l01157">_parseKey()</a>, <a class="el" href="RSA_8php_source.html#l02182">_string_shift()</a>, <a class="el" href="DES_8php_source.html#l00115">CRYPT_DES_MODE_CFB</a>, <a class="el" href="RSA_8php_source.html#l00154">CRYPT_RSA_ASN1_BITSTRING</a>, <a class="el" href="RSA_8php_source.html#l00150">CRYPT_RSA_ASN1_INTEGER</a>, <a class="el" href="RSA_8php_source.html#l00162">CRYPT_RSA_ASN1_OBJECT</a>, <a class="el" href="RSA_8php_source.html#l00166">CRYPT_RSA_ASN1_SEQUENCE</a>, <a class="el" href="RSA_8php_source.html#l00216">CRYPT_RSA_PRIVATE_FORMAT_OPENSSH</a>, <a class="el" href="RSA_8php_source.html#l00200">CRYPT_RSA_PRIVATE_FORMAT_PKCS1</a>, <a class="el" href="RSA_8php_source.html#l00212">CRYPT_RSA_PRIVATE_FORMAT_PKCS8</a>, <a class="el" href="RSA_8php_source.html#l00204">CRYPT_RSA_PRIVATE_FORMAT_PUTTY</a>, <a class="el" href="RSA_8php_source.html#l00208">CRYPT_RSA_PRIVATE_FORMAT_XML</a>, <a class="el" href="RSA_8php_source.html#l00260">CRYPT_RSA_PUBLIC_FORMAT_OPENSSH</a>, <a class="el" href="RSA_8php_source.html#l00249">CRYPT_RSA_PUBLIC_FORMAT_PKCS1</a>, <a class="el" href="RSA_8php_source.html#l00237">CRYPT_RSA_PUBLIC_FORMAT_RAW</a>, and <a class="el" href="RSA_8php_source.html#l00254">CRYPT_RSA_PUBLIC_FORMAT_XML</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l01157">_parseKey()</a>, <a class="el" href="RSA_8php_source.html#l00596">createKey()</a>, <a class="el" href="RSA_8php_source.html#l01741">loadKey()</a>, and <a class="el" href="RSA_8php_source.html#l01893">setPublicKey()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a269d4a2cf9ac198a73cfcb4bc3b8f9b5_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a269d4a2cf9ac198a73cfcb4bc3b8f9b5_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a269d4a2cf9ac198a73cfcb4bc3b8f9b5_cgraph" id="aclassCrypt__RSA_a269d4a2cf9ac198a73cfcb4bc3b8f9b5_cgraph">
<area shape="rect" title="Break a public or private key down into its constituant components." alt="" coords="5,56,95,81"/>
<area shape="rect" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe" title="DER&#45;decode the length." alt="" coords="143,5,263,31"/>
<area shape="rect" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35" title="String Shift." alt="" coords="311,31,412,56"/>
<area shape="rect" href="classCrypt__RSA.html#a009e0a2396931d62c87d27f4e2372024" title="Extract raw BER from Base64 encoding." alt="" coords="152,107,253,132"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a269d4a2cf9ac198a73cfcb4bc3b8f9b5_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a269d4a2cf9ac198a73cfcb4bc3b8f9b5_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a269d4a2cf9ac198a73cfcb4bc3b8f9b5_icgraph" id="aclassCrypt__RSA_a269d4a2cf9ac198a73cfcb4bc3b8f9b5_icgraph">
<area shape="rect" title="Break a public or private key down into its constituant components." alt="" coords="441,56,531,81"/>
<area shape="rect" href="classCrypt__RSA.html#a9c89d16d1494dbaef6d353e2f62ce02c" title="Create public / private key pair." alt="" coords="297,5,384,31"/>
<area shape="rect" href="classCrypt__RSA.html#aecd4eb5e57d8881db518d98009bd75ee" title="Loads a public or private key." alt="" coords="165,81,240,107"/>
<area shape="rect" href="classCrypt__RSA.html#a5c291d208f8e9a8ea7e0e4b6335a61a9" title="Defines the public key." alt="" coords="288,107,393,132"/>
<area shape="rect" href="classCrypt__RSA.html#a871b11d67cc3a8f62e4c0306e64c7c1b" title="Defines the private key." alt="" coords="5,81,117,107"/>
</map>
</div>

</div>
</div>
<a id="a5a4bf86d0bc8f236078fee29827dc683" name="a5a4bf86d0bc8f236078fee29827dc683"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a4bf86d0bc8f236078fee29827dc683">&#9670;&#160;</a></span>_raw_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_raw_encrypt </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Raw Encryption / Decryption. </p>
<p>Doesn't use padding and is not recommended.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$m</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02694">2694</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2695</span>    {</div>
<div class="line"><span class="lineno"> 2696</span>        $temp = $this-&gt;_os2ip($m);</div>
<div class="line"><span class="lineno"> 2697</span>        $temp = $this-&gt;_rsaep($temp);</div>
<div class="line"><span class="lineno"> 2698</span>        <span class="keywordflow">return</span>  $this-&gt;_i2osp($temp, $this-&gt;k);</div>
<div class="line"><span class="lineno"> 2699</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02295">_i2osp()</a>, <a class="el" href="RSA_8php_source.html#l02314">_os2ip()</a>, and <a class="el" href="RSA_8php_source.html#l02468">_rsaep()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l03202">encrypt()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a5a4bf86d0bc8f236078fee29827dc683_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a5a4bf86d0bc8f236078fee29827dc683_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a5a4bf86d0bc8f236078fee29827dc683_cgraph" id="aclassCrypt__RSA_a5a4bf86d0bc8f236078fee29827dc683_cgraph">
<area shape="rect" title="Raw Encryption / Decryption." alt="" coords="5,55,115,80"/>
<area shape="rect" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b" title="Integer&#45;to&#45;Octet&#45;String primitive." alt="" coords="163,5,227,31"/>
<area shape="rect" href="classCrypt__RSA.html#acfc45b22328d38a3e36ce78eb1fceab1" title="Octet&#45;String&#45;to&#45;Integer primitive." alt="" coords="163,55,227,80"/>
<area shape="rect" href="classCrypt__RSA.html#a5157f032e713c0485ba64caebea03bd4" title="RSAEP." alt="" coords="163,104,228,129"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="276,104,391,129"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="439,104,500,129"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a5a4bf86d0bc8f236078fee29827dc683_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a5a4bf86d0bc8f236078fee29827dc683_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a5a4bf86d0bc8f236078fee29827dc683_icgraph" id="aclassCrypt__RSA_a5a4bf86d0bc8f236078fee29827dc683_icgraph">
<area shape="rect" title="Raw Encryption / Decryption." alt="" coords="124,5,233,31"/>
<area shape="rect" href="classCrypt__RSA.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encryption." alt="" coords="5,5,76,31"/>
</map>
</div>

</div>
</div>
<a id="ae7fd9226ba1559b8cfe7d42423021ee1" name="ae7fd9226ba1559b8cfe7d42423021ee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7fd9226ba1559b8cfe7d42423021ee1">&#9670;&#160;</a></span>_rsadp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_rsadp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RSADP. </p>
<p>See <code><a class="el" href="">RFC3447#section-5.1.2</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a></td><td class="paramname">$c</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02486">2486</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2487</span>    {</div>
<div class="line"><span class="lineno"> 2488</span>        <span class="keywordflow">if</span> ($c-&gt;compare($this-&gt;zero) &lt; 0 || $c-&gt;compare($this-&gt;modulus) &gt; 0) {</div>
<div class="line"><span class="lineno"> 2489</span>            user_error(<span class="stringliteral">&#39;Ciphertext representative out of range&#39;</span>);</div>
<div class="line"><span class="lineno"> 2490</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2491</span>        }</div>
<div class="line"><span class="lineno"> 2492</span>        <span class="keywordflow">return</span> $this-&gt;_exponentiate($c);</div>
<div class="line"><span class="lineno"> 2493</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02328">_exponentiate()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l02629">_rsaes_oaep_decrypt()</a>, and <a class="el" href="RSA_8php_source.html#l02769">_rsaes_pkcs1_v1_5_decrypt()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_ae7fd9226ba1559b8cfe7d42423021ee1_cgraph.png" border="0" usemap="#aclassCrypt__RSA_ae7fd9226ba1559b8cfe7d42423021ee1_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_ae7fd9226ba1559b8cfe7d42423021ee1_cgraph" id="aclassCrypt__RSA_ae7fd9226ba1559b8cfe7d42423021ee1_cgraph">
<area shape="rect" title="RSADP." alt="" coords="5,5,71,31"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="119,5,233,31"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="281,5,343,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_ae7fd9226ba1559b8cfe7d42423021ee1_icgraph.png" border="0" usemap="#aclassCrypt__RSA_ae7fd9226ba1559b8cfe7d42423021ee1_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_ae7fd9226ba1559b8cfe7d42423021ee1_icgraph" id="aclassCrypt__RSA_ae7fd9226ba1559b8cfe7d42423021ee1_icgraph">
<area shape="rect" title="RSADP." alt="" coords="256,31,321,56"/>
<area shape="rect" href="classCrypt__RSA.html#ad7c3d5295c0bb7b4bcdaa30d17e3bac7" title="RSAES&#45;OAEP&#45;DECRYPT." alt="" coords="27,5,186,31"/>
<area shape="rect" href="classCrypt__RSA.html#a7171e1af643c02e2167394607a4f4c26" title="RSAES&#45;PKCS1&#45;V1_5&#45;DECRYPT." alt="" coords="5,55,208,80"/>
</map>
</div>

</div>
</div>
<a id="a5157f032e713c0485ba64caebea03bd4" name="a5157f032e713c0485ba64caebea03bd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5157f032e713c0485ba64caebea03bd4">&#9670;&#160;</a></span>_rsaep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_rsaep </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RSAEP. </p>
<p>See <code><a class="el" href="">RFC3447#section-5.1.1</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a></td><td class="paramname">$m</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02468">2468</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2469</span>    {</div>
<div class="line"><span class="lineno"> 2470</span>        <span class="keywordflow">if</span> ($m-&gt;compare($this-&gt;zero) &lt; 0 || $m-&gt;compare($this-&gt;modulus) &gt; 0) {</div>
<div class="line"><span class="lineno"> 2471</span>            user_error(<span class="stringliteral">&#39;Message representative out of range&#39;</span>);</div>
<div class="line"><span class="lineno"> 2472</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2473</span>        }</div>
<div class="line"><span class="lineno"> 2474</span>        <span class="keywordflow">return</span> $this-&gt;_exponentiate($m);</div>
<div class="line"><span class="lineno"> 2475</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02328">_exponentiate()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l02694">_raw_encrypt()</a>, <a class="el" href="RSA_8php_source.html#l02566">_rsaes_oaep_encrypt()</a>, and <a class="el" href="RSA_8php_source.html#l02710">_rsaes_pkcs1_v1_5_encrypt()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a5157f032e713c0485ba64caebea03bd4_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a5157f032e713c0485ba64caebea03bd4_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a5157f032e713c0485ba64caebea03bd4_cgraph" id="aclassCrypt__RSA_a5157f032e713c0485ba64caebea03bd4_cgraph">
<area shape="rect" title="RSAEP." alt="" coords="5,5,71,31"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="119,5,233,31"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="281,5,343,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a5157f032e713c0485ba64caebea03bd4_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a5157f032e713c0485ba64caebea03bd4_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a5157f032e713c0485ba64caebea03bd4_icgraph" id="aclassCrypt__RSA_a5157f032e713c0485ba64caebea03bd4_icgraph">
<area shape="rect" title="RSAEP." alt="" coords="375,55,440,80"/>
<area shape="rect" href="classCrypt__RSA.html#a5a4bf86d0bc8f236078fee29827dc683" title="Raw Encryption / Decryption." alt="" coords="171,5,280,31"/>
<area shape="rect" href="classCrypt__RSA.html#a43d2341a9ffbeadcf13400dbe48988cc" title="RSAES&#45;OAEP&#45;ENCRYPT." alt="" coords="146,55,305,80"/>
<area shape="rect" href="classCrypt__RSA.html#a47bed67c0d9c4ecc11da13e0ad3cddb0" title="RSAES&#45;PKCS1&#45;V1_5&#45;ENCRYPT." alt="" coords="124,104,327,129"/>
<area shape="rect" href="classCrypt__RSA.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encryption." alt="" coords="5,55,76,80"/>
</map>
</div>

</div>
</div>
<a id="ad7c3d5295c0bb7b4bcdaa30d17e3bac7" name="ad7c3d5295c0bb7b4bcdaa30d17e3bac7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7c3d5295c0bb7b4bcdaa30d17e3bac7">&#9670;&#160;</a></span>_rsaes_oaep_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_rsaes_oaep_decrypt </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$l</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RSAES-OAEP-DECRYPT. </p>
<p>See <code><a class="el" href="">RFC3447#section-7.1.2</a></code>. The fact that the error messages aren't distinguishable from one another hinders debugging, but, to quote from RFC3447::section-7.1.2:</p>
<p>Note. Care must be taken to ensure that an opponent cannot distinguish the different error conditions in Step 3.g, whether by error message or timing, or, more generally, learn partial information about the encoded message EM. Otherwise an opponent may be able to obtain useful information about the decryption of the ciphertext C, leading to a chosen-ciphertext attack such as the one observed by Manger [36].</p>
<p>As for $l... to quote from <code><a class="el" href="">RFC3447#page-17</a></code>:</p>
<p>Both the encryption and the decryption operations of RSAES-OAEP take the value of a label L as input. In this version of PKCS #1, L is the empty string; other uses of the label are outside the scope of this document.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$c</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$l</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02629">2629</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2630</span>    {</div>
<div class="line"><span class="lineno"> 2631</span>        <span class="comment">// Length checking</span></div>
<div class="line"><span class="lineno"> 2632</span> </div>
<div class="line"><span class="lineno"> 2633</span>        <span class="comment">// if $l is larger than two million terrabytes and you&#39;re using sha1, PKCS#1 suggests a &quot;Label too long&quot; error</span></div>
<div class="line"><span class="lineno"> 2634</span>        <span class="comment">// be output.</span></div>
<div class="line"><span class="lineno"> 2635</span> </div>
<div class="line"><span class="lineno"> 2636</span>        <span class="keywordflow">if</span> (strlen($c) != $this-&gt;k || $this-&gt;k &lt; 2 * $this-&gt;hLen + 2) {</div>
<div class="line"><span class="lineno"> 2637</span>            user_error(<span class="stringliteral">&#39;Decryption error&#39;</span>);</div>
<div class="line"><span class="lineno"> 2638</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2639</span>        }</div>
<div class="line"><span class="lineno"> 2640</span> </div>
<div class="line"><span class="lineno"> 2641</span>        <span class="comment">// RSA decryption</span></div>
<div class="line"><span class="lineno"> 2642</span> </div>
<div class="line"><span class="lineno"> 2643</span>        $c = $this-&gt;_os2ip($c);</div>
<div class="line"><span class="lineno"> 2644</span>        $m = $this-&gt;_rsadp($c);</div>
<div class="line"><span class="lineno"> 2645</span>        <span class="keywordflow">if</span> ($m === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2646</span>            user_error(<span class="stringliteral">&#39;Decryption error&#39;</span>);</div>
<div class="line"><span class="lineno"> 2647</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2648</span>        }</div>
<div class="line"><span class="lineno"> 2649</span>        $em = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b">_i2osp</a>($m, $this-&gt;k);</div>
<div class="line"><span class="lineno"> 2650</span> </div>
<div class="line"><span class="lineno"> 2651</span>        <span class="comment">// EME-OAEP decoding</span></div>
<div class="line"><span class="lineno"> 2652</span> </div>
<div class="line"><span class="lineno"> 2653</span>        $lHash = $this-&gt;hash-&gt;hash($l);</div>
<div class="line"><span class="lineno"> 2654</span>        $y = ord($em[0]);</div>
<div class="line"><span class="lineno"> 2655</span>        $maskedSeed = substr($em, 1, $this-&gt;hLen);</div>
<div class="line"><span class="lineno"> 2656</span>        $maskedDB = substr($em, $this-&gt;hLen + 1);</div>
<div class="line"><span class="lineno"> 2657</span>        $seedMask = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#abfcfdb9ca9cc5a3eeceee10ebcf793e0">_mgf1</a>($maskedDB, $this-&gt;hLen);</div>
<div class="line"><span class="lineno"> 2658</span>        $seed = $maskedSeed ^ $seedMask;</div>
<div class="line"><span class="lineno"> 2659</span>        $dbMask = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#abfcfdb9ca9cc5a3eeceee10ebcf793e0">_mgf1</a>($seed, $this-&gt;k - $this-&gt;hLen - 1);</div>
<div class="line"><span class="lineno"> 2660</span>        $db = $maskedDB ^ $dbMask;</div>
<div class="line"><span class="lineno"> 2661</span>        $lHash2 = substr($db, 0, $this-&gt;hLen);</div>
<div class="line"><span class="lineno"> 2662</span>        $m = substr($db, $this-&gt;hLen);</div>
<div class="line"><span class="lineno"> 2663</span>        $hashesMatch = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a1479196d348b439c4a2f1ec8c72f9dd3">_equals</a>($lHash, $lHash2);</div>
<div class="line"><span class="lineno"> 2664</span>        $leadingZeros = 1;</div>
<div class="line"><span class="lineno"> 2665</span>        $patternMatch = 0;</div>
<div class="line"><span class="lineno"> 2666</span>        $offset = 0;</div>
<div class="line"><span class="lineno"> 2667</span>        <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($m); $i++) {</div>
<div class="line"><span class="lineno"> 2668</span>            $patternMatch|= $leadingZeros &amp; ($m[$i] === <span class="stringliteral">&quot;\1&quot;</span>);</div>
<div class="line"><span class="lineno"> 2669</span>            $leadingZeros&amp;= $m[$i] === <span class="stringliteral">&quot;\0&quot;</span>;</div>
<div class="line"><span class="lineno"> 2670</span>            $offset+= $patternMatch ? 0 : 1;</div>
<div class="line"><span class="lineno"> 2671</span>        }</div>
<div class="line"><span class="lineno"> 2672</span> </div>
<div class="line"><span class="lineno"> 2673</span>        <span class="comment">// we do | instead of || to avoid https://en.wikipedia.org/wiki/Short-circuit_evaluation</span></div>
<div class="line"><span class="lineno"> 2674</span>        <span class="comment">// to protect against timing attacks</span></div>
<div class="line"><span class="lineno"> 2675</span>        <span class="keywordflow">if</span> (!$hashesMatch | !$patternMatch) {</div>
<div class="line"><span class="lineno"> 2676</span>            user_error(<span class="stringliteral">&#39;Decryption error&#39;</span>);</div>
<div class="line"><span class="lineno"> 2677</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2678</span>        }</div>
<div class="line"><span class="lineno"> 2679</span> </div>
<div class="line"><span class="lineno"> 2680</span>        <span class="comment">// Output the message M</span></div>
<div class="line"><span class="lineno"> 2681</span> </div>
<div class="line"><span class="lineno"> 2682</span>        <span class="keywordflow">return</span> substr($m, $offset + 1);</div>
<div class="line"><span class="lineno"> 2683</span>    }</div>
<div class="ttc" id="aclassCrypt__RSA_html_a7dbb5187f86756281452e726a0c3d87b"><div class="ttname"><a href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b">Crypt_RSA\_i2osp</a></div><div class="ttdeci">_i2osp($x, $xLen)</div><div class="ttdoc">Integer-to-Octet-String primitive.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l02295">RSA.php:2295</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02440">_equals()</a>, <a class="el" href="RSA_8php_source.html#l02295">_i2osp()</a>, <a class="el" href="RSA_8php_source.html#l02541">_mgf1()</a>, <a class="el" href="RSA_8php_source.html#l02314">_os2ip()</a>, and <a class="el" href="RSA_8php_source.html#l02486">_rsadp()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_ad7c3d5295c0bb7b4bcdaa30d17e3bac7_cgraph.png" border="0" usemap="#aclassCrypt__RSA_ad7c3d5295c0bb7b4bcdaa30d17e3bac7_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_ad7c3d5295c0bb7b4bcdaa30d17e3bac7_cgraph" id="aclassCrypt__RSA_ad7c3d5295c0bb7b4bcdaa30d17e3bac7_cgraph">
<area shape="rect" title="RSAES&#45;OAEP&#45;DECRYPT." alt="" coords="5,104,164,129"/>
<area shape="rect" href="classCrypt__RSA.html#a1479196d348b439c4a2f1ec8c72f9dd3" title="Performs blinded RSA equality testing." alt="" coords="212,5,284,31"/>
<area shape="rect" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b" title="Integer&#45;to&#45;Octet&#45;String primitive." alt="" coords="216,55,280,80"/>
<area shape="rect" href="classCrypt__RSA.html#abfcfdb9ca9cc5a3eeceee10ebcf793e0" title="MGF1." alt="" coords="217,104,279,129"/>
<area shape="rect" href="classCrypt__RSA.html#acfc45b22328d38a3e36ce78eb1fceab1" title="Octet&#45;String&#45;to&#45;Integer primitive." alt="" coords="216,153,280,179"/>
<area shape="rect" href="classCrypt__RSA.html#ae7fd9226ba1559b8cfe7d42423021ee1" title="RSADP." alt="" coords="215,203,281,228"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="332,203,447,228"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="495,203,556,228"/>
</map>
</div>

</div>
</div>
<a id="a43d2341a9ffbeadcf13400dbe48988cc" name="a43d2341a9ffbeadcf13400dbe48988cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43d2341a9ffbeadcf13400dbe48988cc">&#9670;&#160;</a></span>_rsaes_oaep_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_rsaes_oaep_encrypt </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$l</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RSAES-OAEP-ENCRYPT. </p>
<p>See <code><a class="el" href="">RFC3447#section-7.1.1</a></code> and {<a href="http://en.wikipedia.org/wiki/Optimal_Asymmetric_Encryption_Padding">http://en.wikipedia.org/wiki/Optimal_Asymmetric_Encryption_Padding</a> OAES}.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$m</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$l</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02566">2566</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2567</span>    {</div>
<div class="line"><span class="lineno"> 2568</span>        $mLen = strlen($m);</div>
<div class="line"><span class="lineno"> 2569</span> </div>
<div class="line"><span class="lineno"> 2570</span>        <span class="comment">// Length checking</span></div>
<div class="line"><span class="lineno"> 2571</span> </div>
<div class="line"><span class="lineno"> 2572</span>        <span class="comment">// if $l is larger than two million terrabytes and you&#39;re using sha1, PKCS#1 suggests a &quot;Label too long&quot; error</span></div>
<div class="line"><span class="lineno"> 2573</span>        <span class="comment">// be output.</span></div>
<div class="line"><span class="lineno"> 2574</span> </div>
<div class="line"><span class="lineno"> 2575</span>        <span class="keywordflow">if</span> ($mLen &gt; $this-&gt;k - 2 * $this-&gt;hLen - 2) {</div>
<div class="line"><span class="lineno"> 2576</span>            user_error(<span class="stringliteral">&#39;Message too long&#39;</span>);</div>
<div class="line"><span class="lineno"> 2577</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2578</span>        }</div>
<div class="line"><span class="lineno"> 2579</span> </div>
<div class="line"><span class="lineno"> 2580</span>        <span class="comment">// EME-OAEP encoding</span></div>
<div class="line"><span class="lineno"> 2581</span> </div>
<div class="line"><span class="lineno"> 2582</span>        $lHash = $this-&gt;hash-&gt;hash($l);</div>
<div class="line"><span class="lineno"> 2583</span>        $ps = str_repeat(chr(0), $this-&gt;k - $mLen - 2 * $this-&gt;hLen - 2);</div>
<div class="line"><span class="lineno"> 2584</span>        $db = $lHash . $ps . chr(1) . $m;</div>
<div class="line"><span class="lineno"> 2585</span>        $seed = crypt_random_string($this-&gt;hLen);</div>
<div class="line"><span class="lineno"> 2586</span>        $dbMask = $this-&gt;_mgf1($seed, $this-&gt;k - $this-&gt;hLen - 1);</div>
<div class="line"><span class="lineno"> 2587</span>        $maskedDB = $db ^ $dbMask;</div>
<div class="line"><span class="lineno"> 2588</span>        $seedMask = $this-&gt;_mgf1($maskedDB, $this-&gt;hLen);</div>
<div class="line"><span class="lineno"> 2589</span>        $maskedSeed = $seed ^ $seedMask;</div>
<div class="line"><span class="lineno"> 2590</span>        $em = chr(0) . $maskedSeed . $maskedDB;</div>
<div class="line"><span class="lineno"> 2591</span> </div>
<div class="line"><span class="lineno"> 2592</span>        <span class="comment">// RSA encryption</span></div>
<div class="line"><span class="lineno"> 2593</span> </div>
<div class="line"><span class="lineno"> 2594</span>        $m = $this-&gt;_os2ip($em);</div>
<div class="line"><span class="lineno"> 2595</span>        $c = $this-&gt;_rsaep($m);</div>
<div class="line"><span class="lineno"> 2596</span>        $c = $this-&gt;_i2osp($c, $this-&gt;k);</div>
<div class="line"><span class="lineno"> 2597</span> </div>
<div class="line"><span class="lineno"> 2598</span>        <span class="comment">// Output the ciphertext C</span></div>
<div class="line"><span class="lineno"> 2599</span> </div>
<div class="line"><span class="lineno"> 2600</span>        <span class="keywordflow">return</span> $c;</div>
<div class="line"><span class="lineno"> 2601</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02295">_i2osp()</a>, <a class="el" href="RSA_8php_source.html#l02541">_mgf1()</a>, <a class="el" href="RSA_8php_source.html#l02314">_os2ip()</a>, and <a class="el" href="RSA_8php_source.html#l02468">_rsaep()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l03202">encrypt()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a43d2341a9ffbeadcf13400dbe48988cc_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a43d2341a9ffbeadcf13400dbe48988cc_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a43d2341a9ffbeadcf13400dbe48988cc_cgraph" id="aclassCrypt__RSA_a43d2341a9ffbeadcf13400dbe48988cc_cgraph">
<area shape="rect" title="RSAES&#45;OAEP&#45;ENCRYPT." alt="" coords="5,80,164,105"/>
<area shape="rect" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b" title="Integer&#45;to&#45;Octet&#45;String primitive." alt="" coords="213,5,277,31"/>
<area shape="rect" href="classCrypt__RSA.html#abfcfdb9ca9cc5a3eeceee10ebcf793e0" title="MGF1." alt="" coords="213,55,276,80"/>
<area shape="rect" href="classCrypt__RSA.html#acfc45b22328d38a3e36ce78eb1fceab1" title="Octet&#45;String&#45;to&#45;Integer primitive." alt="" coords="213,104,277,129"/>
<area shape="rect" href="classCrypt__RSA.html#a5157f032e713c0485ba64caebea03bd4" title="RSAEP." alt="" coords="212,153,277,179"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="325,153,440,179"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="488,153,549,179"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a43d2341a9ffbeadcf13400dbe48988cc_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a43d2341a9ffbeadcf13400dbe48988cc_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a43d2341a9ffbeadcf13400dbe48988cc_icgraph" id="aclassCrypt__RSA_a43d2341a9ffbeadcf13400dbe48988cc_icgraph">
<area shape="rect" title="RSAES&#45;OAEP&#45;ENCRYPT." alt="" coords="124,5,283,31"/>
<area shape="rect" href="classCrypt__RSA.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encryption." alt="" coords="5,5,76,31"/>
</map>
</div>

</div>
</div>
<a id="a7171e1af643c02e2167394607a4f4c26" name="a7171e1af643c02e2167394607a4f4c26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7171e1af643c02e2167394607a4f4c26">&#9670;&#160;</a></span>_rsaes_pkcs1_v1_5_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_rsaes_pkcs1_v1_5_decrypt </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RSAES-PKCS1-V1_5-DECRYPT. </p>
<p>See <code><a class="el" href="">RFC3447#section-7.2.2</a></code>.</p>
<p>For compatibility purposes, this function departs slightly from the description given in RFC3447. The reason being that RFC2313::section-8.1 (PKCS#1 v1.5) states that ciphertext's encrypted by the private key should have the second byte set to either 0 or 1 and that ciphertext's encrypted by the public key should have the second byte set to 2. In RFC3447 (PKCS#1 v2.1), the second byte is supposed to be 2 regardless of which key is used. For compatibility purposes, we'll just check to make sure the second byte is 2 or less. If it is, we'll accept the decrypted string as valid.</p>
<p>As a consequence of this, a private key encrypted ciphertext produced with <a class="el" href="classCrypt__RSA.html">Crypt_RSA</a> may not decrypt with a strictly PKCS#1 v1.5 compliant RSA implementation. Public key encrypted ciphertext's should but not private key encrypted ciphertext's.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$c</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02769">2769</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2770</span>    {</div>
<div class="line"><span class="lineno"> 2771</span>        <span class="comment">// Length checking</span></div>
<div class="line"><span class="lineno"> 2772</span> </div>
<div class="line"><span class="lineno"> 2773</span>        <span class="keywordflow">if</span> (strlen($c) != $this-&gt;k) { <span class="comment">// or if k &lt; 11</span></div>
<div class="line"><span class="lineno"> 2774</span>            user_error(<span class="stringliteral">&#39;Decryption error&#39;</span>);</div>
<div class="line"><span class="lineno"> 2775</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2776</span>        }</div>
<div class="line"><span class="lineno"> 2777</span> </div>
<div class="line"><span class="lineno"> 2778</span>        <span class="comment">// RSA decryption</span></div>
<div class="line"><span class="lineno"> 2779</span> </div>
<div class="line"><span class="lineno"> 2780</span>        $c = $this-&gt;_os2ip($c);</div>
<div class="line"><span class="lineno"> 2781</span>        $m = $this-&gt;_rsadp($c);</div>
<div class="line"><span class="lineno"> 2782</span> </div>
<div class="line"><span class="lineno"> 2783</span>        <span class="keywordflow">if</span> ($m === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2784</span>            user_error(<span class="stringliteral">&#39;Decryption error&#39;</span>);</div>
<div class="line"><span class="lineno"> 2785</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2786</span>        }</div>
<div class="line"><span class="lineno"> 2787</span>        $em = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b">_i2osp</a>($m, $this-&gt;k);</div>
<div class="line"><span class="lineno"> 2788</span> </div>
<div class="line"><span class="lineno"> 2789</span>        <span class="comment">// EME-PKCS1-v1_5 decoding</span></div>
<div class="line"><span class="lineno"> 2790</span> </div>
<div class="line"><span class="lineno"> 2791</span>        <span class="keywordflow">if</span> (ord($em[0]) != 0 || ord($em[1]) &gt; 2) {</div>
<div class="line"><span class="lineno"> 2792</span>            user_error(<span class="stringliteral">&#39;Decryption error&#39;</span>);</div>
<div class="line"><span class="lineno"> 2793</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2794</span>        }</div>
<div class="line"><span class="lineno"> 2795</span> </div>
<div class="line"><span class="lineno"> 2796</span>        $ps = substr($em, 2, strpos($em, chr(0), 2) - 2);</div>
<div class="line"><span class="lineno"> 2797</span>        $m = substr($em, strlen($ps) + 3);</div>
<div class="line"><span class="lineno"> 2798</span> </div>
<div class="line"><span class="lineno"> 2799</span>        <span class="keywordflow">if</span> (strlen($ps) &lt; 8) {</div>
<div class="line"><span class="lineno"> 2800</span>            user_error(<span class="stringliteral">&#39;Decryption error&#39;</span>);</div>
<div class="line"><span class="lineno"> 2801</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2802</span>        }</div>
<div class="line"><span class="lineno"> 2803</span> </div>
<div class="line"><span class="lineno"> 2804</span>        <span class="comment">// Output M</span></div>
<div class="line"><span class="lineno"> 2805</span> </div>
<div class="line"><span class="lineno"> 2806</span>        <span class="keywordflow">return</span> $m;</div>
<div class="line"><span class="lineno"> 2807</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02295">_i2osp()</a>, <a class="el" href="RSA_8php_source.html#l02314">_os2ip()</a>, and <a class="el" href="RSA_8php_source.html#l02486">_rsadp()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a7171e1af643c02e2167394607a4f4c26_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a7171e1af643c02e2167394607a4f4c26_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a7171e1af643c02e2167394607a4f4c26_cgraph" id="aclassCrypt__RSA_a7171e1af643c02e2167394607a4f4c26_cgraph">
<area shape="rect" title="RSAES&#45;PKCS1&#45;V1_5&#45;DECRYPT." alt="" coords="5,55,208,80"/>
<area shape="rect" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b" title="Integer&#45;to&#45;Octet&#45;String primitive." alt="" coords="257,5,321,31"/>
<area shape="rect" href="classCrypt__RSA.html#acfc45b22328d38a3e36ce78eb1fceab1" title="Octet&#45;String&#45;to&#45;Integer primitive." alt="" coords="257,55,321,80"/>
<area shape="rect" href="classCrypt__RSA.html#ae7fd9226ba1559b8cfe7d42423021ee1" title="RSADP." alt="" coords="256,104,321,129"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="369,104,484,129"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="532,104,593,129"/>
</map>
</div>

</div>
</div>
<a id="a47bed67c0d9c4ecc11da13e0ad3cddb0" name="a47bed67c0d9c4ecc11da13e0ad3cddb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47bed67c0d9c4ecc11da13e0ad3cddb0">&#9670;&#160;</a></span>_rsaes_pkcs1_v1_5_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_rsaes_pkcs1_v1_5_encrypt </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RSAES-PKCS1-V1_5-ENCRYPT. </p>
<p>See <code><a class="el" href="">RFC3447#section-7.2.1</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$m</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02710">2710</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2711</span>    {</div>
<div class="line"><span class="lineno"> 2712</span>        $mLen = strlen($m);</div>
<div class="line"><span class="lineno"> 2713</span> </div>
<div class="line"><span class="lineno"> 2714</span>        <span class="comment">// Length checking</span></div>
<div class="line"><span class="lineno"> 2715</span> </div>
<div class="line"><span class="lineno"> 2716</span>        <span class="keywordflow">if</span> ($mLen &gt; $this-&gt;k - 11) {</div>
<div class="line"><span class="lineno"> 2717</span>            user_error(<span class="stringliteral">&#39;Message too long&#39;</span>);</div>
<div class="line"><span class="lineno"> 2718</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2719</span>        }</div>
<div class="line"><span class="lineno"> 2720</span> </div>
<div class="line"><span class="lineno"> 2721</span>        <span class="comment">// EME-PKCS1-v1_5 encoding</span></div>
<div class="line"><span class="lineno"> 2722</span> </div>
<div class="line"><span class="lineno"> 2723</span>        $psLen = $this-&gt;k - $mLen - 3;</div>
<div class="line"><span class="lineno"> 2724</span>        $ps = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 2725</span>        <span class="keywordflow">while</span> (strlen($ps) != $psLen) {</div>
<div class="line"><span class="lineno"> 2726</span>            $temp = crypt_random_string($psLen - strlen($ps));</div>
<div class="line"><span class="lineno"> 2727</span>            $temp = str_replace(<span class="stringliteral">&quot;\x00&quot;</span>, <span class="stringliteral">&#39;&#39;</span>, $temp);</div>
<div class="line"><span class="lineno"> 2728</span>            $ps.= $temp;</div>
<div class="line"><span class="lineno"> 2729</span>        }</div>
<div class="line"><span class="lineno"> 2730</span>        $type = 2;</div>
<div class="line"><span class="lineno"> 2731</span>        <span class="comment">// see the comments of _rsaes_pkcs1_v1_5_decrypt() to understand why this is being done</span></div>
<div class="line"><span class="lineno"> 2732</span>        <span class="keywordflow">if</span> (defined(<span class="stringliteral">&#39;CRYPT_RSA_PKCS15_COMPAT&#39;</span>) &amp;&amp; (!isset($this-&gt;publicExponent) || $this-&gt;exponent !== $this-&gt;publicExponent)) {</div>
<div class="line"><span class="lineno"> 2733</span>            $type = 1;</div>
<div class="line"><span class="lineno"> 2734</span>            <span class="comment">// &quot;The padding string PS shall consist of k-3-||D|| octets. ... for block type 01, they shall have value FF&quot;</span></div>
<div class="line"><span class="lineno"> 2735</span>            $ps = str_repeat(<span class="stringliteral">&quot;\xFF&quot;</span>, $psLen);</div>
<div class="line"><span class="lineno"> 2736</span>        }</div>
<div class="line"><span class="lineno"> 2737</span>        $em = chr(0) . chr($type) . $ps . chr(0) . $m;</div>
<div class="line"><span class="lineno"> 2738</span> </div>
<div class="line"><span class="lineno"> 2739</span>        <span class="comment">// RSA encryption</span></div>
<div class="line"><span class="lineno"> 2740</span>        $m = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#acfc45b22328d38a3e36ce78eb1fceab1">_os2ip</a>($em);</div>
<div class="line"><span class="lineno"> 2741</span>        $c = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a5157f032e713c0485ba64caebea03bd4">_rsaep</a>($m);</div>
<div class="line"><span class="lineno"> 2742</span>        $c = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b">_i2osp</a>($c, $this-&gt;k);</div>
<div class="line"><span class="lineno"> 2743</span> </div>
<div class="line"><span class="lineno"> 2744</span>        <span class="comment">// Output the ciphertext C</span></div>
<div class="line"><span class="lineno"> 2745</span> </div>
<div class="line"><span class="lineno"> 2746</span>        <span class="keywordflow">return</span> $c;</div>
<div class="line"><span class="lineno"> 2747</span>    }</div>
<div class="ttc" id="aclassCrypt__RSA_html_a5157f032e713c0485ba64caebea03bd4"><div class="ttname"><a href="classCrypt__RSA.html#a5157f032e713c0485ba64caebea03bd4">Crypt_RSA\_rsaep</a></div><div class="ttdeci">_rsaep($m)</div><div class="ttdoc">RSAEP.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l02468">RSA.php:2468</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_acfc45b22328d38a3e36ce78eb1fceab1"><div class="ttname"><a href="classCrypt__RSA.html#acfc45b22328d38a3e36ce78eb1fceab1">Crypt_RSA\_os2ip</a></div><div class="ttdeci">_os2ip($x)</div><div class="ttdoc">Octet-String-to-Integer primitive.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l02314">RSA.php:2314</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02295">_i2osp()</a>, <a class="el" href="RSA_8php_source.html#l02314">_os2ip()</a>, and <a class="el" href="RSA_8php_source.html#l02468">_rsaep()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l03202">encrypt()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a47bed67c0d9c4ecc11da13e0ad3cddb0_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a47bed67c0d9c4ecc11da13e0ad3cddb0_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a47bed67c0d9c4ecc11da13e0ad3cddb0_cgraph" id="aclassCrypt__RSA_a47bed67c0d9c4ecc11da13e0ad3cddb0_cgraph">
<area shape="rect" title="RSAES&#45;PKCS1&#45;V1_5&#45;ENCRYPT." alt="" coords="5,55,208,80"/>
<area shape="rect" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b" title="Integer&#45;to&#45;Octet&#45;String primitive." alt="" coords="257,5,321,31"/>
<area shape="rect" href="classCrypt__RSA.html#acfc45b22328d38a3e36ce78eb1fceab1" title="Octet&#45;String&#45;to&#45;Integer primitive." alt="" coords="257,55,321,80"/>
<area shape="rect" href="classCrypt__RSA.html#a5157f032e713c0485ba64caebea03bd4" title="RSAEP." alt="" coords="256,104,321,129"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="369,104,484,129"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="532,104,593,129"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a47bed67c0d9c4ecc11da13e0ad3cddb0_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a47bed67c0d9c4ecc11da13e0ad3cddb0_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a47bed67c0d9c4ecc11da13e0ad3cddb0_icgraph" id="aclassCrypt__RSA_a47bed67c0d9c4ecc11da13e0ad3cddb0_icgraph">
<area shape="rect" title="RSAES&#45;PKCS1&#45;V1_5&#45;ENCRYPT." alt="" coords="124,5,327,31"/>
<area shape="rect" href="classCrypt__RSA.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encryption." alt="" coords="5,5,76,31"/>
</map>
</div>

</div>
</div>
<a id="a812ed7b5c58b1d3281ca8263b0eb9c38" name="a812ed7b5c58b1d3281ca8263b0eb9c38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a812ed7b5c58b1d3281ca8263b0eb9c38">&#9670;&#160;</a></span>_rsasp1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_rsasp1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RSASP1. </p>
<p>See <code><a class="el" href="">RFC3447#section-5.2.1</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a></td><td class="paramname">$m</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02504">2504</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2505</span>    {</div>
<div class="line"><span class="lineno"> 2506</span>        <span class="keywordflow">if</span> ($m-&gt;compare($this-&gt;zero) &lt; 0 || $m-&gt;compare($this-&gt;modulus) &gt; 0) {</div>
<div class="line"><span class="lineno"> 2507</span>            user_error(<span class="stringliteral">&#39;Message representative out of range&#39;</span>);</div>
<div class="line"><span class="lineno"> 2508</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2509</span>        }</div>
<div class="line"><span class="lineno"> 2510</span>        <span class="keywordflow">return</span> $this-&gt;_exponentiate($m);</div>
<div class="line"><span class="lineno"> 2511</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02328">_exponentiate()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l03072">_rsassa_pkcs1_v1_5_sign()</a>, and <a class="el" href="RSA_8php_source.html#l02901">_rsassa_pss_sign()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a812ed7b5c58b1d3281ca8263b0eb9c38_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a812ed7b5c58b1d3281ca8263b0eb9c38_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a812ed7b5c58b1d3281ca8263b0eb9c38_cgraph" id="aclassCrypt__RSA_a812ed7b5c58b1d3281ca8263b0eb9c38_cgraph">
<area shape="rect" title="RSASP1." alt="" coords="5,5,77,31"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="125,5,240,31"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="288,5,349,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a812ed7b5c58b1d3281ca8263b0eb9c38_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a812ed7b5c58b1d3281ca8263b0eb9c38_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a812ed7b5c58b1d3281ca8263b0eb9c38_icgraph" id="aclassCrypt__RSA_a812ed7b5c58b1d3281ca8263b0eb9c38_icgraph">
<area shape="rect" title="RSASP1." alt="" coords="339,31,411,56"/>
<area shape="rect" href="classCrypt__RSA.html#a7919feaaf410567587520ae62d0f375a" title="RSASSA&#45;PKCS1&#45;V1_5&#45;SIGN." alt="" coords="103,5,291,31"/>
<area shape="rect" href="classCrypt__RSA.html#a41d7b44f4ff751df9dc5bc9a2e1a5875" title="RSASSA&#45;PSS&#45;SIGN." alt="" coords="129,55,264,80"/>
<area shape="rect" href="classCrypt__RSA.html#abe0890f90bae8c6cab81312df152652b" title="Create a signature." alt="" coords="5,31,55,56"/>
</map>
</div>

</div>
</div>
<a id="a7919feaaf410567587520ae62d0f375a" name="a7919feaaf410567587520ae62d0f375a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7919feaaf410567587520ae62d0f375a">&#9670;&#160;</a></span>_rsassa_pkcs1_v1_5_sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_rsassa_pkcs1_v1_5_sign </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RSASSA-PKCS1-V1_5-SIGN. </p>
<p>See <code><a class="el" href="">RFC3447#section-8.2.1</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$m</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l03072">3072</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3073</span>    {</div>
<div class="line"><span class="lineno"> 3074</span>        <span class="comment">// EMSA-PKCS1-v1_5 encoding</span></div>
<div class="line"><span class="lineno"> 3075</span> </div>
<div class="line"><span class="lineno"> 3076</span>        $em = $this-&gt;_emsa_pkcs1_v1_5_encode($m, $this-&gt;k);</div>
<div class="line"><span class="lineno"> 3077</span>        <span class="keywordflow">if</span> ($em === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3078</span>            user_error(<span class="stringliteral">&#39;RSA modulus too short&#39;</span>);</div>
<div class="line"><span class="lineno"> 3079</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3080</span>        }</div>
<div class="line"><span class="lineno"> 3081</span> </div>
<div class="line"><span class="lineno"> 3082</span>        <span class="comment">// RSA signature</span></div>
<div class="line"><span class="lineno"> 3083</span> </div>
<div class="line"><span class="lineno"> 3084</span>        $m = $this-&gt;_os2ip($em);</div>
<div class="line"><span class="lineno"> 3085</span>        $s = $this-&gt;_rsasp1($m);</div>
<div class="line"><span class="lineno"> 3086</span>        $s = $this-&gt;_i2osp($s, $this-&gt;k);</div>
<div class="line"><span class="lineno"> 3087</span> </div>
<div class="line"><span class="lineno"> 3088</span>        <span class="comment">// Output the signature S</span></div>
<div class="line"><span class="lineno"> 3089</span> </div>
<div class="line"><span class="lineno"> 3090</span>        <span class="keywordflow">return</span> $s;</div>
<div class="line"><span class="lineno"> 3091</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02968">_emsa_pkcs1_v1_5_encode()</a>, <a class="el" href="RSA_8php_source.html#l02295">_i2osp()</a>, <a class="el" href="RSA_8php_source.html#l02314">_os2ip()</a>, and <a class="el" href="RSA_8php_source.html#l02504">_rsasp1()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l03290">sign()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a7919feaaf410567587520ae62d0f375a_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a7919feaaf410567587520ae62d0f375a_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a7919feaaf410567587520ae62d0f375a_cgraph" id="aclassCrypt__RSA_a7919feaaf410567587520ae62d0f375a_cgraph">
<area shape="rect" title="RSASSA&#45;PKCS1&#45;V1_5&#45;SIGN." alt="" coords="5,80,193,105"/>
<area shape="rect" href="classCrypt__RSA.html#ac7c7477da0e0045974ee1a8d1795d73f" title="EMSA&#45;PKCS1&#45;V1_5&#45;ENCODE." alt="" coords="241,5,444,31"/>
<area shape="rect" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b" title="Integer&#45;to&#45;Octet&#45;String primitive." alt="" coords="311,55,375,80"/>
<area shape="rect" href="classCrypt__RSA.html#acfc45b22328d38a3e36ce78eb1fceab1" title="Octet&#45;String&#45;to&#45;Integer primitive." alt="" coords="311,104,375,129"/>
<area shape="rect" href="classCrypt__RSA.html#a812ed7b5c58b1d3281ca8263b0eb9c38" title="RSASP1." alt="" coords="307,153,379,179"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="492,153,607,179"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="655,153,716,179"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a7919feaaf410567587520ae62d0f375a_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a7919feaaf410567587520ae62d0f375a_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a7919feaaf410567587520ae62d0f375a_icgraph" id="aclassCrypt__RSA_a7919feaaf410567587520ae62d0f375a_icgraph">
<area shape="rect" title="RSASSA&#45;PKCS1&#45;V1_5&#45;SIGN." alt="" coords="103,5,291,31"/>
<area shape="rect" href="classCrypt__RSA.html#abe0890f90bae8c6cab81312df152652b" title="Create a signature." alt="" coords="5,5,55,31"/>
</map>
</div>

</div>
</div>
<a id="a9bac0d7f59f81a08f34e937e71fa4264" name="a9bac0d7f59f81a08f34e937e71fa4264"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bac0d7f59f81a08f34e937e71fa4264">&#9670;&#160;</a></span>_rsassa_pkcs1_v1_5_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_rsassa_pkcs1_v1_5_verify </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RSASSA-PKCS1-V1_5-VERIFY. </p>
<p>See <code><a class="el" href="">RFC3447#section-8.2.2</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$m</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$s</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l03103">3103</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3104</span>    {</div>
<div class="line"><span class="lineno"> 3105</span>        <span class="comment">// Length checking</span></div>
<div class="line"><span class="lineno"> 3106</span> </div>
<div class="line"><span class="lineno"> 3107</span>        <span class="keywordflow">if</span> (strlen($s) != $this-&gt;k) {</div>
<div class="line"><span class="lineno"> 3108</span>            user_error(<span class="stringliteral">&#39;Invalid signature&#39;</span>);</div>
<div class="line"><span class="lineno"> 3109</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3110</span>        }</div>
<div class="line"><span class="lineno"> 3111</span> </div>
<div class="line"><span class="lineno"> 3112</span>        <span class="comment">// RSA verification</span></div>
<div class="line"><span class="lineno"> 3113</span> </div>
<div class="line"><span class="lineno"> 3114</span>        $s = $this-&gt;_os2ip($s);</div>
<div class="line"><span class="lineno"> 3115</span>        $m2 = $this-&gt;_rsavp1($s);</div>
<div class="line"><span class="lineno"> 3116</span>        <span class="keywordflow">if</span> ($m2 === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3117</span>            user_error(<span class="stringliteral">&#39;Invalid signature&#39;</span>);</div>
<div class="line"><span class="lineno"> 3118</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3119</span>        }</div>
<div class="line"><span class="lineno"> 3120</span>        $em = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b">_i2osp</a>($m2, $this-&gt;k);</div>
<div class="line"><span class="lineno"> 3121</span>        <span class="keywordflow">if</span> ($em === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3122</span>            user_error(<span class="stringliteral">&#39;Invalid signature&#39;</span>);</div>
<div class="line"><span class="lineno"> 3123</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3124</span>        }</div>
<div class="line"><span class="lineno"> 3125</span> </div>
<div class="line"><span class="lineno"> 3126</span>        <span class="comment">// EMSA-PKCS1-v1_5 encoding</span></div>
<div class="line"><span class="lineno"> 3127</span> </div>
<div class="line"><span class="lineno"> 3128</span>        $em2 = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#ac7c7477da0e0045974ee1a8d1795d73f">_emsa_pkcs1_v1_5_encode</a>($m, $this-&gt;k);</div>
<div class="line"><span class="lineno"> 3129</span>        $em3 = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#af65bce0b24a7aeeb274b776ba732aa15">_emsa_pkcs1_v1_5_encode_without_null</a>($m, $this-&gt;k);</div>
<div class="line"><span class="lineno"> 3130</span> </div>
<div class="line"><span class="lineno"> 3131</span>        <span class="keywordflow">if</span> ($em2 === <span class="keyword">false</span> &amp;&amp; $em3 === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3132</span>            user_error(<span class="stringliteral">&#39;RSA modulus too short&#39;</span>);</div>
<div class="line"><span class="lineno"> 3133</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3134</span>        }</div>
<div class="line"><span class="lineno"> 3135</span> </div>
<div class="line"><span class="lineno"> 3136</span>        <span class="comment">// Compare</span></div>
<div class="line"><span class="lineno"> 3137</span> </div>
<div class="line"><span class="lineno"> 3138</span>        <span class="keywordflow">return</span> ($em2 !== <span class="keyword">false</span> &amp;&amp; $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a1479196d348b439c4a2f1ec8c72f9dd3">_equals</a>($em, $em2)) ||</div>
<div class="line"><span class="lineno"> 3139</span>               ($em3 !== <span class="keyword">false</span> &amp;&amp; $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a1479196d348b439c4a2f1ec8c72f9dd3">_equals</a>($em, $em3));</div>
<div class="line"><span class="lineno"> 3140</span>    }</div>
<div class="ttc" id="aclassCrypt__RSA_html_ac7c7477da0e0045974ee1a8d1795d73f"><div class="ttname"><a href="classCrypt__RSA.html#ac7c7477da0e0045974ee1a8d1795d73f">Crypt_RSA\_emsa_pkcs1_v1_5_encode</a></div><div class="ttdeci">_emsa_pkcs1_v1_5_encode($m, $emLen)</div><div class="ttdoc">EMSA-PKCS1-V1_5-ENCODE.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l02968">RSA.php:2968</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_af65bce0b24a7aeeb274b776ba732aa15"><div class="ttname"><a href="classCrypt__RSA.html#af65bce0b24a7aeeb274b776ba732aa15">Crypt_RSA\_emsa_pkcs1_v1_5_encode_without_null</a></div><div class="ttdeci">_emsa_pkcs1_v1_5_encode_without_null($m, $emLen)</div><div class="ttdoc">EMSA-PKCS1-V1_5-ENCODE (without NULL)</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l03025">RSA.php:3025</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02968">_emsa_pkcs1_v1_5_encode()</a>, <a class="el" href="RSA_8php_source.html#l03025">_emsa_pkcs1_v1_5_encode_without_null()</a>, <a class="el" href="RSA_8php_source.html#l02440">_equals()</a>, <a class="el" href="RSA_8php_source.html#l02295">_i2osp()</a>, <a class="el" href="RSA_8php_source.html#l02314">_os2ip()</a>, and <a class="el" href="RSA_8php_source.html#l02522">_rsavp1()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l03314">verify()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a9bac0d7f59f81a08f34e937e71fa4264_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a9bac0d7f59f81a08f34e937e71fa4264_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a9bac0d7f59f81a08f34e937e71fa4264_cgraph" id="aclassCrypt__RSA_a9bac0d7f59f81a08f34e937e71fa4264_cgraph">
<area shape="rect" title="RSASSA&#45;PKCS1&#45;V1_5&#45;VERIFY." alt="" coords="5,138,160,178"/>
<area shape="rect" href="classCrypt__RSA.html#ac7c7477da0e0045974ee1a8d1795d73f" title="EMSA&#45;PKCS1&#45;V1_5&#45;ENCODE." alt="" coords="208,5,411,31"/>
<area shape="rect" href="classCrypt__RSA.html#af65bce0b24a7aeeb274b776ba732aa15" title="EMSA&#45;PKCS1&#45;V1_5&#45;ENCODE (without NULL)" alt="" coords="208,55,411,95"/>
<area shape="rect" href="classCrypt__RSA.html#a1479196d348b439c4a2f1ec8c72f9dd3" title="Performs blinded RSA equality testing." alt="" coords="273,120,345,145"/>
<area shape="rect" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b" title="Integer&#45;to&#45;Octet&#45;String primitive." alt="" coords="277,169,341,195"/>
<area shape="rect" href="classCrypt__RSA.html#acfc45b22328d38a3e36ce78eb1fceab1" title="Octet&#45;String&#45;to&#45;Integer primitive." alt="" coords="277,219,341,244"/>
<area shape="rect" href="classCrypt__RSA.html#a2fe05e8ee49b3d3064c09ff852c3bf34" title="RSAVP1." alt="" coords="273,268,346,293"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="459,268,573,293"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="621,268,683,293"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a9bac0d7f59f81a08f34e937e71fa4264_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a9bac0d7f59f81a08f34e937e71fa4264_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a9bac0d7f59f81a08f34e937e71fa4264_icgraph" id="aclassCrypt__RSA_a9bac0d7f59f81a08f34e937e71fa4264_icgraph">
<area shape="rect" title="RSASSA&#45;PKCS1&#45;V1_5&#45;VERIFY." alt="" coords="112,5,267,45"/>
<area shape="rect" href="classCrypt__RSA.html#a91b3194ffeb55cb91eb28202ea8fe666" title="Verifies a signature." alt="" coords="5,13,64,38"/>
</map>
</div>

</div>
</div>
<a id="a41d7b44f4ff751df9dc5bc9a2e1a5875" name="a41d7b44f4ff751df9dc5bc9a2e1a5875"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41d7b44f4ff751df9dc5bc9a2e1a5875">&#9670;&#160;</a></span>_rsassa_pss_sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_rsassa_pss_sign </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RSASSA-PSS-SIGN. </p>
<p>See <code><a class="el" href="">RFC3447#section-8.1.1</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$m</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02901">2901</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2902</span>    {</div>
<div class="line"><span class="lineno"> 2903</span>        <span class="comment">// EMSA-PSS encoding</span></div>
<div class="line"><span class="lineno"> 2904</span> </div>
<div class="line"><span class="lineno"> 2905</span>        $em = $this-&gt;_emsa_pss_encode($m, 8 * $this-&gt;k - 1);</div>
<div class="line"><span class="lineno"> 2906</span> </div>
<div class="line"><span class="lineno"> 2907</span>        <span class="comment">// RSA signature</span></div>
<div class="line"><span class="lineno"> 2908</span> </div>
<div class="line"><span class="lineno"> 2909</span>        $m = $this-&gt;_os2ip($em);</div>
<div class="line"><span class="lineno"> 2910</span>        $s = $this-&gt;_rsasp1($m);</div>
<div class="line"><span class="lineno"> 2911</span>        $s = $this-&gt;_i2osp($s, $this-&gt;k);</div>
<div class="line"><span class="lineno"> 2912</span> </div>
<div class="line"><span class="lineno"> 2913</span>        <span class="comment">// Output the signature S</span></div>
<div class="line"><span class="lineno"> 2914</span> </div>
<div class="line"><span class="lineno"> 2915</span>        <span class="keywordflow">return</span> $s;</div>
<div class="line"><span class="lineno"> 2916</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02818">_emsa_pss_encode()</a>, <a class="el" href="RSA_8php_source.html#l02295">_i2osp()</a>, <a class="el" href="RSA_8php_source.html#l02314">_os2ip()</a>, and <a class="el" href="RSA_8php_source.html#l02504">_rsasp1()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l03290">sign()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a41d7b44f4ff751df9dc5bc9a2e1a5875_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a41d7b44f4ff751df9dc5bc9a2e1a5875_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a41d7b44f4ff751df9dc5bc9a2e1a5875_cgraph" id="aclassCrypt__RSA_a41d7b44f4ff751df9dc5bc9a2e1a5875_cgraph">
<area shape="rect" title="RSASSA&#45;PSS&#45;SIGN." alt="" coords="5,80,140,105"/>
<area shape="rect" href="classCrypt__RSA.html#ab1766412b33feaf27a58c51171f4a8f0" title="EMSA&#45;PSS&#45;ENCODE." alt="" coords="188,5,336,31"/>
<area shape="rect" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b" title="Integer&#45;to&#45;Octet&#45;String primitive." alt="" coords="230,55,294,80"/>
<area shape="rect" href="classCrypt__RSA.html#acfc45b22328d38a3e36ce78eb1fceab1" title="Octet&#45;String&#45;to&#45;Integer primitive." alt="" coords="230,104,294,129"/>
<area shape="rect" href="classCrypt__RSA.html#a812ed7b5c58b1d3281ca8263b0eb9c38" title="RSASP1." alt="" coords="226,153,298,179"/>
<area shape="rect" href="classCrypt__RSA.html#abfcfdb9ca9cc5a3eeceee10ebcf793e0" title="MGF1." alt="" coords="410,5,473,31"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="384,153,499,179"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="547,153,608,179"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a41d7b44f4ff751df9dc5bc9a2e1a5875_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a41d7b44f4ff751df9dc5bc9a2e1a5875_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a41d7b44f4ff751df9dc5bc9a2e1a5875_icgraph" id="aclassCrypt__RSA_a41d7b44f4ff751df9dc5bc9a2e1a5875_icgraph">
<area shape="rect" title="RSASSA&#45;PSS&#45;SIGN." alt="" coords="103,5,237,31"/>
<area shape="rect" href="classCrypt__RSA.html#abe0890f90bae8c6cab81312df152652b" title="Create a signature." alt="" coords="5,5,55,31"/>
</map>
</div>

</div>
</div>
<a id="a14d4abcd8f2ca6604b948026e0c553ba" name="a14d4abcd8f2ca6604b948026e0c553ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14d4abcd8f2ca6604b948026e0c553ba">&#9670;&#160;</a></span>_rsassa_pss_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_rsassa_pss_verify </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RSASSA-PSS-VERIFY. </p>
<p>See <code><a class="el" href="">RFC3447#section-8.1.2</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$m</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$s</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02928">2928</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2929</span>    {</div>
<div class="line"><span class="lineno"> 2930</span>        <span class="comment">// Length checking</span></div>
<div class="line"><span class="lineno"> 2931</span> </div>
<div class="line"><span class="lineno"> 2932</span>        <span class="keywordflow">if</span> (strlen($s) != $this-&gt;k) {</div>
<div class="line"><span class="lineno"> 2933</span>            user_error(<span class="stringliteral">&#39;Invalid signature&#39;</span>);</div>
<div class="line"><span class="lineno"> 2934</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2935</span>        }</div>
<div class="line"><span class="lineno"> 2936</span> </div>
<div class="line"><span class="lineno"> 2937</span>        <span class="comment">// RSA verification</span></div>
<div class="line"><span class="lineno"> 2938</span> </div>
<div class="line"><span class="lineno"> 2939</span>        $modBits = strlen($this-&gt;modulus-&gt;toBits());</div>
<div class="line"><span class="lineno"> 2940</span> </div>
<div class="line"><span class="lineno"> 2941</span>        $s2 = $this-&gt;_os2ip($s);</div>
<div class="line"><span class="lineno"> 2942</span>        $m2 = $this-&gt;_rsavp1($s2);</div>
<div class="line"><span class="lineno"> 2943</span>        <span class="keywordflow">if</span> ($m2 === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2944</span>            user_error(<span class="stringliteral">&#39;Invalid signature&#39;</span>);</div>
<div class="line"><span class="lineno"> 2945</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2946</span>        }</div>
<div class="line"><span class="lineno"> 2947</span>        $em = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b">_i2osp</a>($m2, $this-&gt;k);</div>
<div class="line"><span class="lineno"> 2948</span>        <span class="keywordflow">if</span> ($em === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2949</span>            user_error(<span class="stringliteral">&#39;Invalid signature&#39;</span>);</div>
<div class="line"><span class="lineno"> 2950</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2951</span>        }</div>
<div class="line"><span class="lineno"> 2952</span> </div>
<div class="line"><span class="lineno"> 2953</span>        <span class="comment">// EMSA-PSS verification</span></div>
<div class="line"><span class="lineno"> 2954</span> </div>
<div class="line"><span class="lineno"> 2955</span>        <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a823206322297e3b89a2e04897cdc64c3">_emsa_pss_verify</a>($m, $em, $modBits - 1);</div>
<div class="line"><span class="lineno"> 2956</span>    }</div>
<div class="ttc" id="aclassCrypt__RSA_html_a823206322297e3b89a2e04897cdc64c3"><div class="ttname"><a href="classCrypt__RSA.html#a823206322297e3b89a2e04897cdc64c3">Crypt_RSA\_emsa_pss_verify</a></div><div class="ttdeci">_emsa_pss_verify($m, $em, $emBits)</div><div class="ttdoc">EMSA-PSS-VERIFY.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l02856">RSA.php:2856</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02856">_emsa_pss_verify()</a>, <a class="el" href="RSA_8php_source.html#l02295">_i2osp()</a>, <a class="el" href="RSA_8php_source.html#l02314">_os2ip()</a>, and <a class="el" href="RSA_8php_source.html#l02522">_rsavp1()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l03314">verify()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a14d4abcd8f2ca6604b948026e0c553ba_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a14d4abcd8f2ca6604b948026e0c553ba_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a14d4abcd8f2ca6604b948026e0c553ba_cgraph" id="aclassCrypt__RSA_a14d4abcd8f2ca6604b948026e0c553ba_cgraph">
<area shape="rect" title="RSASSA&#45;PSS&#45;VERIFY." alt="" coords="5,104,149,129"/>
<area shape="rect" href="classCrypt__RSA.html#a823206322297e3b89a2e04897cdc64c3" title="EMSA&#45;PSS&#45;VERIFY." alt="" coords="197,29,336,55"/>
<area shape="rect" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b" title="Integer&#45;to&#45;Octet&#45;String primitive." alt="" coords="235,79,299,104"/>
<area shape="rect" href="classCrypt__RSA.html#acfc45b22328d38a3e36ce78eb1fceab1" title="Octet&#45;String&#45;to&#45;Integer primitive." alt="" coords="235,128,299,153"/>
<area shape="rect" href="classCrypt__RSA.html#a2fe05e8ee49b3d3064c09ff852c3bf34" title="RSAVP1." alt="" coords="230,177,303,203"/>
<area shape="rect" href="classCrypt__RSA.html#a1479196d348b439c4a2f1ec8c72f9dd3" title="Performs blinded RSA equality testing." alt="" coords="405,5,477,31"/>
<area shape="rect" href="classCrypt__RSA.html#abfcfdb9ca9cc5a3eeceee10ebcf793e0" title="MGF1." alt="" coords="410,55,473,80"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="384,177,499,203"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="547,177,608,203"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a14d4abcd8f2ca6604b948026e0c553ba_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a14d4abcd8f2ca6604b948026e0c553ba_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a14d4abcd8f2ca6604b948026e0c553ba_icgraph" id="aclassCrypt__RSA_a14d4abcd8f2ca6604b948026e0c553ba_icgraph">
<area shape="rect" title="RSASSA&#45;PSS&#45;VERIFY." alt="" coords="112,5,256,31"/>
<area shape="rect" href="classCrypt__RSA.html#a91b3194ffeb55cb91eb28202ea8fe666" title="Verifies a signature." alt="" coords="5,5,64,31"/>
</map>
</div>

</div>
</div>
<a id="a2fe05e8ee49b3d3064c09ff852c3bf34" name="a2fe05e8ee49b3d3064c09ff852c3bf34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fe05e8ee49b3d3064c09ff852c3bf34">&#9670;&#160;</a></span>_rsavp1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_rsavp1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RSAVP1. </p>
<p>See <code><a class="el" href="">RFC3447#section-5.2.2</a></code>.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a></td><td class="paramname">$s</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classMath__BigInteger.html">Math_BigInteger</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02522">2522</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2523</span>    {</div>
<div class="line"><span class="lineno"> 2524</span>        <span class="keywordflow">if</span> ($s-&gt;compare($this-&gt;zero) &lt; 0 || $s-&gt;compare($this-&gt;modulus) &gt; 0) {</div>
<div class="line"><span class="lineno"> 2525</span>            user_error(<span class="stringliteral">&#39;Signature representative out of range&#39;</span>);</div>
<div class="line"><span class="lineno"> 2526</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2527</span>        }</div>
<div class="line"><span class="lineno"> 2528</span>        <span class="keywordflow">return</span> $this-&gt;_exponentiate($s);</div>
<div class="line"><span class="lineno"> 2529</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02328">_exponentiate()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l03103">_rsassa_pkcs1_v1_5_verify()</a>, and <a class="el" href="RSA_8php_source.html#l02928">_rsassa_pss_verify()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a2fe05e8ee49b3d3064c09ff852c3bf34_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a2fe05e8ee49b3d3064c09ff852c3bf34_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a2fe05e8ee49b3d3064c09ff852c3bf34_cgraph" id="aclassCrypt__RSA_a2fe05e8ee49b3d3064c09ff852c3bf34_cgraph">
<area shape="rect" title="RSAVP1." alt="" coords="5,5,79,31"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="127,5,241,31"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="289,5,351,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a2fe05e8ee49b3d3064c09ff852c3bf34_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a2fe05e8ee49b3d3064c09ff852c3bf34_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a2fe05e8ee49b3d3064c09ff852c3bf34_icgraph" id="aclassCrypt__RSA_a2fe05e8ee49b3d3064c09ff852c3bf34_icgraph">
<area shape="rect" title="RSAVP1." alt="" coords="315,42,388,67"/>
<area shape="rect" href="classCrypt__RSA.html#a9bac0d7f59f81a08f34e937e71fa4264" title="RSASSA&#45;PKCS1&#45;V1_5&#45;VERIFY." alt="" coords="112,5,267,45"/>
<area shape="rect" href="classCrypt__RSA.html#a14d4abcd8f2ca6604b948026e0c553ba" title="RSASSA&#45;PSS&#45;VERIFY." alt="" coords="117,70,261,95"/>
<area shape="rect" href="classCrypt__RSA.html#a91b3194ffeb55cb91eb28202ea8fe666" title="Verifies a signature." alt="" coords="5,42,64,67"/>
</map>
</div>

</div>
</div>
<a id="ac51308488f6dc3efa4acfee235823825" name="ac51308488f6dc3efa4acfee235823825"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac51308488f6dc3efa4acfee235823825">&#9670;&#160;</a></span>_start_element_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_start_element_handler </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$parser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$attribs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start Element Handler. </p>
<p>Called by xml_set_element_handler()</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">resource</td><td class="paramname">$parser</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$name</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$attribs</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l01667">1667</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1668</span>    {</div>
<div class="line"><span class="lineno"> 1669</span>        <span class="comment">//$name = strtoupper($name);</span></div>
<div class="line"><span class="lineno"> 1670</span>        <span class="keywordflow">switch</span> ($name) {</div>
<div class="line"><span class="lineno"> 1671</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;MODULUS&#39;</span>:</div>
<div class="line"><span class="lineno"> 1672</span>                $this-&gt;current = &amp;$this-&gt;components[<span class="stringliteral">&#39;modulus&#39;</span>];</div>
<div class="line"><span class="lineno"> 1673</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1674</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;EXPONENT&#39;</span>:</div>
<div class="line"><span class="lineno"> 1675</span>                $this-&gt;current = &amp;$this-&gt;components[<span class="stringliteral">&#39;publicExponent&#39;</span>];</div>
<div class="line"><span class="lineno"> 1676</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1677</span>            <span class="keywordflow">case</span> <span class="charliteral">&#39;P&#39;</span>:</div>
<div class="line"><span class="lineno"> 1678</span>                $this-&gt;current = &amp;$this-&gt;components[<span class="stringliteral">&#39;primes&#39;</span>][1];</div>
<div class="line"><span class="lineno"> 1679</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1680</span>            <span class="keywordflow">case</span> <span class="charliteral">&#39;Q&#39;</span>:</div>
<div class="line"><span class="lineno"> 1681</span>                $this-&gt;current = &amp;$this-&gt;components[<span class="stringliteral">&#39;primes&#39;</span>][2];</div>
<div class="line"><span class="lineno"> 1682</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1683</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;DP&#39;</span>:</div>
<div class="line"><span class="lineno"> 1684</span>                $this-&gt;current = &amp;$this-&gt;components[<span class="stringliteral">&#39;exponents&#39;</span>][1];</div>
<div class="line"><span class="lineno"> 1685</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1686</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;DQ&#39;</span>:</div>
<div class="line"><span class="lineno"> 1687</span>                $this-&gt;current = &amp;$this-&gt;components[<span class="stringliteral">&#39;exponents&#39;</span>][2];</div>
<div class="line"><span class="lineno"> 1688</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1689</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;INVERSEQ&#39;</span>:</div>
<div class="line"><span class="lineno"> 1690</span>                $this-&gt;current = &amp;$this-&gt;components[<span class="stringliteral">&#39;coefficients&#39;</span>][2];</div>
<div class="line"><span class="lineno"> 1691</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1692</span>            <span class="keywordflow">case</span> <span class="charliteral">&#39;D&#39;</span>:</div>
<div class="line"><span class="lineno"> 1693</span>                $this-&gt;current = &amp;$this-&gt;components[<span class="stringliteral">&#39;privateExponent&#39;</span>];</div>
<div class="line"><span class="lineno"> 1694</span>        }</div>
<div class="line"><span class="lineno"> 1695</span>        $this-&gt;current = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1696</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a377b31b7ccc7fd14f08679e6640a6c3b" name="a377b31b7ccc7fd14f08679e6640a6c3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a377b31b7ccc7fd14f08679e6640a6c3b">&#9670;&#160;</a></span>_stop_element_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_stop_element_handler </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$parser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop Element Handler. </p>
<p>Called by xml_set_element_handler()</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">resource</td><td class="paramname">$parser</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$name</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l01707">1707</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1708</span>    {</div>
<div class="line"><span class="lineno"> 1709</span>        <span class="keywordflow">if</span> (isset($this-&gt;current)) {</div>
<div class="line"><span class="lineno"> 1710</span>            $this-&gt;current = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>(base64_decode($this-&gt;current), 256);</div>
<div class="line"><span class="lineno"> 1711</span>            unset($this-&gt;current);</div>
<div class="line"><span class="lineno"> 1712</span>        }</div>
<div class="line"><span class="lineno"> 1713</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab009fa6f4ba09daa679a30e9b5bcfe35" name="ab009fa6f4ba09daa679a30e9b5bcfe35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab009fa6f4ba09daa679a30e9b5bcfe35">&#9670;&#160;</a></span>_string_shift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_string_shift </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$index</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>String Shift. </p>
<p>Inspired by array_shift</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$string</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$index</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string @access private </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02182">2182</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2183</span>    {</div>
<div class="line"><span class="lineno"> 2184</span>        $substr = substr($string, 0, $index);</div>
<div class="line"><span class="lineno"> 2185</span>        $string = substr($string, $index);</div>
<div class="line"><span class="lineno"> 2186</span>        <span class="keywordflow">return</span> $substr;</div>
<div class="line"><span class="lineno"> 2187</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l02141">_decodeLength()</a>, and <a class="el" href="RSA_8php_source.html#l01157">_parseKey()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_ab009fa6f4ba09daa679a30e9b5bcfe35_icgraph.png" border="0" usemap="#aclassCrypt__RSA_ab009fa6f4ba09daa679a30e9b5bcfe35_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_ab009fa6f4ba09daa679a30e9b5bcfe35_icgraph" id="aclassCrypt__RSA_ab009fa6f4ba09daa679a30e9b5bcfe35_icgraph">
<area shape="rect" title="String Shift." alt="" coords="747,56,848,81"/>
<area shape="rect" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe" title="DER&#45;decode the length." alt="" coords="579,31,699,56"/>
<area shape="rect" href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5" title="Break a public or private key down into its constituant components." alt="" coords="441,56,531,81"/>
<area shape="rect" href="classCrypt__RSA.html#a9c89d16d1494dbaef6d353e2f62ce02c" title="Create public / private key pair." alt="" coords="297,5,384,31"/>
<area shape="rect" href="classCrypt__RSA.html#aecd4eb5e57d8881db518d98009bd75ee" title="Loads a public or private key." alt="" coords="165,81,240,107"/>
<area shape="rect" href="classCrypt__RSA.html#a5c291d208f8e9a8ea7e0e4b6335a61a9" title="Defines the public key." alt="" coords="288,107,393,132"/>
<area shape="rect" href="classCrypt__RSA.html#a871b11d67cc3a8f62e4c0306e64c7c1b" title="Defines the private key." alt="" coords="5,81,117,107"/>
</map>
</div>

</div>
</div>
<a id="a9c89d16d1494dbaef6d353e2f62ce02c" name="a9c89d16d1494dbaef6d353e2f62ce02c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c89d16d1494dbaef6d353e2f62ce02c">&#9670;&#160;</a></span>createKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">createKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$bits</em> = <code>1024</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$timeout</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$partial</em> = <code>array()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create public / private key pair. </p>
<p>Returns an array with the following three elements:</p><ul>
<li>'privatekey': The private key.</li>
<li>'publickey': The public key.</li>
<li>'partialkey': A partially computed key (if the execution time exceeded $timeout). Will need to be passed back to Crypt_RSA::createKey() as the third parameter for further processing.</li>
</ul>
<p>@access public </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$bits</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$timeout</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$partial</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00596">596</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  597</span>    {</div>
<div class="line"><span class="lineno">  598</span>        <span class="keywordflow">if</span> (!defined(<span class="stringliteral">&#39;CRYPT_RSA_EXPONENT&#39;</span>)) {</div>
<div class="line"><span class="lineno">  599</span>            <span class="comment">// http://en.wikipedia.org/wiki/65537_%28number%29</span></div>
<div class="line"><span class="lineno">  600</span>            define(<span class="stringliteral">&#39;CRYPT_RSA_EXPONENT&#39;</span>, <span class="stringliteral">&#39;65537&#39;</span>);</div>
<div class="line"><span class="lineno">  601</span>        }</div>
<div class="line"><span class="lineno">  602</span>        <span class="comment">// per &lt;http://cseweb.ucsd.edu/~hovav/dist/survey.pdf#page=5&gt;, this number ought not result in primes smaller</span></div>
<div class="line"><span class="lineno">  603</span>        <span class="comment">// than 256 bits. as a consequence if the key you&#39;re trying to create is 1024 bits and you&#39;ve set CRYPT_RSA_SMALLEST_PRIME</span></div>
<div class="line"><span class="lineno">  604</span>        <span class="comment">// to 384 bits then you&#39;re going to get a 384 bit prime and a 640 bit prime (384 + 1024 % 384). at least if</span></div>
<div class="line"><span class="lineno">  605</span>        <span class="comment">// CRYPT_RSA_MODE is set to CRYPT_RSA_MODE_INTERNAL. if CRYPT_RSA_MODE is set to CRYPT_RSA_MODE_OPENSSL then</span></div>
<div class="line"><span class="lineno">  606</span>        <span class="comment">// CRYPT_RSA_SMALLEST_PRIME is ignored (ie. multi-prime RSA support is more intended as a way to speed up RSA key</span></div>
<div class="line"><span class="lineno">  607</span>        <span class="comment">// generation when there&#39;s a chance neither gmp nor OpenSSL are installed)</span></div>
<div class="line"><span class="lineno">  608</span>        <span class="keywordflow">if</span> (!defined(<span class="stringliteral">&#39;CRYPT_RSA_SMALLEST_PRIME&#39;</span>)) {</div>
<div class="line"><span class="lineno">  609</span>            define(<span class="stringliteral">&#39;CRYPT_RSA_SMALLEST_PRIME&#39;</span>, 4096);</div>
<div class="line"><span class="lineno">  610</span>        }</div>
<div class="line"><span class="lineno">  611</span> </div>
<div class="line"><span class="lineno">  612</span>        <span class="comment">// OpenSSL uses 65537 as the exponent and requires RSA keys be 384 bits minimum</span></div>
<div class="line"><span class="lineno">  613</span>        <span class="keywordflow">if</span> (CRYPT_RSA_MODE == <a class="code hl_variable" href="RSA_8php.html#ab30d852541dea7311f2e48f2db6d179e">CRYPT_RSA_MODE_OPENSSL</a> &amp;&amp; $bits &gt;= 384 &amp;&amp; CRYPT_RSA_EXPONENT == 65537) {</div>
<div class="line"><span class="lineno">  614</span>            $config = array();</div>
<div class="line"><span class="lineno">  615</span>            <span class="keywordflow">if</span> (isset($this-&gt;configFile)) {</div>
<div class="line"><span class="lineno">  616</span>                $config[<span class="stringliteral">&#39;config&#39;</span>] = $this-&gt;configFile;</div>
<div class="line"><span class="lineno">  617</span>            }</div>
<div class="line"><span class="lineno">  618</span>            $rsa = openssl_pkey_new(array(<span class="stringliteral">&#39;private_key_bits&#39;</span> =&gt; $bits) + $config);</div>
<div class="line"><span class="lineno">  619</span>            openssl_pkey_export($rsa, $privatekey, <span class="keyword">null</span>, $config);</div>
<div class="line"><span class="lineno">  620</span>            $publickey = openssl_pkey_get_details($rsa);</div>
<div class="line"><span class="lineno">  621</span>            $publickey = $publickey[<span class="stringliteral">&#39;key&#39;</span>];</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>            $privatekey = call_user_func_array(array($this, <span class="stringliteral">&#39;_convertPrivateKey&#39;</span>), array_values($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5">_parseKey</a>($privatekey, <a class="code hl_variable" href="RSA_8php.html#a72160567057c92a07f17877a8e6a1465">CRYPT_RSA_PRIVATE_FORMAT_PKCS1</a>)));</div>
<div class="line"><span class="lineno">  624</span>            $publickey = call_user_func_array(array($this, <span class="stringliteral">&#39;_convertPublicKey&#39;</span>), array_values($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5">_parseKey</a>($publickey, <a class="code hl_variable" href="RSA_8php.html#a15eeb8d9dc1af1411f1549d4702c8a00">CRYPT_RSA_PUBLIC_FORMAT_PKCS1</a>)));</div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span>            <span class="comment">// clear the buffer of error strings stemming from a minimalistic openssl.cnf</span></div>
<div class="line"><span class="lineno">  627</span>            <span class="keywordflow">while</span> (openssl_error_string() !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  628</span>            }</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span>            <span class="keywordflow">return</span> array(</div>
<div class="line"><span class="lineno">  631</span>                <span class="stringliteral">&#39;privatekey&#39;</span> =&gt; $privatekey,</div>
<div class="line"><span class="lineno">  632</span>                <span class="stringliteral">&#39;publickey&#39;</span> =&gt; $publickey,</div>
<div class="line"><span class="lineno">  633</span>                <span class="stringliteral">&#39;partialkey&#39;</span> =&gt; <span class="keyword">false</span></div>
<div class="line"><span class="lineno">  634</span>            );</div>
<div class="line"><span class="lineno">  635</span>        }</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>        <span class="keyword">static</span> $e;</div>
<div class="line"><span class="lineno">  638</span>        <span class="keywordflow">if</span> (!isset($e)) {</div>
<div class="line"><span class="lineno">  639</span>            $e = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>(CRYPT_RSA_EXPONENT);</div>
<div class="line"><span class="lineno">  640</span>        }</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>        extract($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a63369f75f78aece549868cebbf270794">_generateMinMax</a>($bits));</div>
<div class="line"><span class="lineno">  643</span>        $absoluteMin = $min;</div>
<div class="line"><span class="lineno">  644</span>        $temp = $bits &gt;&gt; 1; <span class="comment">// divide by two to see how many bits P and Q would be</span></div>
<div class="line"><span class="lineno">  645</span>        <span class="keywordflow">if</span> ($temp &gt; CRYPT_RSA_SMALLEST_PRIME) {</div>
<div class="line"><span class="lineno">  646</span>            $num_primes = floor($bits / CRYPT_RSA_SMALLEST_PRIME);</div>
<div class="line"><span class="lineno">  647</span>            $temp = CRYPT_RSA_SMALLEST_PRIME;</div>
<div class="line"><span class="lineno">  648</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  649</span>            $num_primes = 2;</div>
<div class="line"><span class="lineno">  650</span>        }</div>
<div class="line"><span class="lineno">  651</span>        extract($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a63369f75f78aece549868cebbf270794">_generateMinMax</a>($temp + $bits % $temp));</div>
<div class="line"><span class="lineno">  652</span>        $finalMax = $max;</div>
<div class="line"><span class="lineno">  653</span>        extract($this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a63369f75f78aece549868cebbf270794">_generateMinMax</a>($temp));</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>        $generator = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>();</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>        $n = $this-&gt;one-&gt;copy();</div>
<div class="line"><span class="lineno">  658</span>        <span class="keywordflow">if</span> (!empty($partial)) {</div>
<div class="line"><span class="lineno">  659</span>            extract(unserialize($partial));</div>
<div class="line"><span class="lineno">  660</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  661</span>            <a class="code hl_variable" href="classCrypt__RSA.html#a49441857b4bc8d5573cba6fea45f400d">$exponents</a> = <a class="code hl_variable" href="classCrypt__RSA.html#a2484451bccf0a9d944d2cb27fa103678">$coefficients</a> = <a class="code hl_variable" href="classCrypt__RSA.html#a3512d5a4383616be363bc390ae3e7ec7">$primes</a> = array();</div>
<div class="line"><span class="lineno">  662</span>            $lcm = array(</div>
<div class="line"><span class="lineno">  663</span>                <span class="stringliteral">&#39;top&#39;</span> =&gt; $this-&gt;one-&gt;copy(),</div>
<div class="line"><span class="lineno">  664</span>                <span class="stringliteral">&#39;bottom&#39;</span> =&gt; <span class="keyword">false</span></div>
<div class="line"><span class="lineno">  665</span>            );</div>
<div class="line"><span class="lineno">  666</span>        }</div>
<div class="line"><span class="lineno">  667</span> </div>
<div class="line"><span class="lineno">  668</span>        $start = time();</div>
<div class="line"><span class="lineno">  669</span>        $i0 = count($primes) + 1;</div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>        <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno">  672</span>            <span class="keywordflow">for</span> ($i = $i0; $i &lt;= $num_primes; $i++) {</div>
<div class="line"><span class="lineno">  673</span>                <span class="keywordflow">if</span> ($timeout !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  674</span>                    $timeout-= time() - $start;</div>
<div class="line"><span class="lineno">  675</span>                    $start = time();</div>
<div class="line"><span class="lineno">  676</span>                    <span class="keywordflow">if</span> ($timeout &lt;= 0) {</div>
<div class="line"><span class="lineno">  677</span>                        <span class="keywordflow">return</span> array(</div>
<div class="line"><span class="lineno">  678</span>                            <span class="stringliteral">&#39;privatekey&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line"><span class="lineno">  679</span>                            <span class="stringliteral">&#39;publickey&#39;</span>  =&gt; <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line"><span class="lineno">  680</span>                            <span class="stringliteral">&#39;partialkey&#39;</span> =&gt; serialize(array(</div>
<div class="line"><span class="lineno">  681</span>                                <span class="stringliteral">&#39;primes&#39;</span> =&gt; $primes,</div>
<div class="line"><span class="lineno">  682</span>                                <span class="stringliteral">&#39;coefficients&#39;</span> =&gt; $coefficients,</div>
<div class="line"><span class="lineno">  683</span>                                <span class="stringliteral">&#39;lcm&#39;</span> =&gt; $lcm,</div>
<div class="line"><span class="lineno">  684</span>                                <span class="stringliteral">&#39;exponents&#39;</span> =&gt; $exponents</div>
<div class="line"><span class="lineno">  685</span>                            ))</div>
<div class="line"><span class="lineno">  686</span>                        );</div>
<div class="line"><span class="lineno">  687</span>                    }</div>
<div class="line"><span class="lineno">  688</span>                }</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>                <span class="keywordflow">if</span> ($i == $num_primes) {</div>
<div class="line"><span class="lineno">  691</span>                    list($min, $temp) = $absoluteMin-&gt;divide($n);</div>
<div class="line"><span class="lineno">  692</span>                    <span class="keywordflow">if</span> (!$temp-&gt;equals($this-&gt;zero)) {</div>
<div class="line"><span class="lineno">  693</span>                        $min = $min-&gt;add($this-&gt;one); <span class="comment">// ie. ceil()</span></div>
<div class="line"><span class="lineno">  694</span>                    }</div>
<div class="line"><span class="lineno">  695</span>                    <a class="code hl_variable" href="classCrypt__RSA.html#a3512d5a4383616be363bc390ae3e7ec7">$primes</a>[$i] = $generator-&gt;randomPrime($min, $finalMax, $timeout);</div>
<div class="line"><span class="lineno">  696</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  697</span>                    <a class="code hl_variable" href="classCrypt__RSA.html#a3512d5a4383616be363bc390ae3e7ec7">$primes</a>[$i] = $generator-&gt;randomPrime($min, $max, $timeout);</div>
<div class="line"><span class="lineno">  698</span>                }</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>                <span class="keywordflow">if</span> ($primes[$i] === <span class="keyword">false</span>) { <span class="comment">// if we&#39;ve reached the timeout</span></div>
<div class="line"><span class="lineno">  701</span>                    <span class="keywordflow">if</span> (count($primes) &gt; 1) {</div>
<div class="line"><span class="lineno">  702</span>                        $partialkey = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  703</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  704</span>                        array_pop($primes);</div>
<div class="line"><span class="lineno">  705</span>                        $partialkey = serialize(array(</div>
<div class="line"><span class="lineno">  706</span>                            <span class="stringliteral">&#39;primes&#39;</span> =&gt; $primes,</div>
<div class="line"><span class="lineno">  707</span>                            <span class="stringliteral">&#39;coefficients&#39;</span> =&gt; $coefficients,</div>
<div class="line"><span class="lineno">  708</span>                            <span class="stringliteral">&#39;lcm&#39;</span> =&gt; $lcm,</div>
<div class="line"><span class="lineno">  709</span>                            <span class="stringliteral">&#39;exponents&#39;</span> =&gt; $exponents</div>
<div class="line"><span class="lineno">  710</span>                        ));</div>
<div class="line"><span class="lineno">  711</span>                    }</div>
<div class="line"><span class="lineno">  712</span> </div>
<div class="line"><span class="lineno">  713</span>                    <span class="keywordflow">return</span> array(</div>
<div class="line"><span class="lineno">  714</span>                        <span class="stringliteral">&#39;privatekey&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line"><span class="lineno">  715</span>                        <span class="stringliteral">&#39;publickey&#39;</span>  =&gt; <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line"><span class="lineno">  716</span>                        <span class="stringliteral">&#39;partialkey&#39;</span> =&gt; $partialkey</div>
<div class="line"><span class="lineno">  717</span>                    );</div>
<div class="line"><span class="lineno">  718</span>                }</div>
<div class="line"><span class="lineno">  719</span> </div>
<div class="line"><span class="lineno">  720</span>                <span class="comment">// the first coefficient is calculated differently from the rest</span></div>
<div class="line"><span class="lineno">  721</span>                <span class="comment">// ie. instead of being $primes[1]-&gt;modInverse($primes[2]), it&#39;s $primes[2]-&gt;modInverse($primes[1])</span></div>
<div class="line"><span class="lineno">  722</span>                <span class="keywordflow">if</span> ($i &gt; 2) {</div>
<div class="line"><span class="lineno">  723</span>                    <a class="code hl_variable" href="classCrypt__RSA.html#a2484451bccf0a9d944d2cb27fa103678">$coefficients</a>[$i] = $n-&gt;modInverse($primes[$i]);</div>
<div class="line"><span class="lineno">  724</span>                }</div>
<div class="line"><span class="lineno">  725</span> </div>
<div class="line"><span class="lineno">  726</span>                $n = $n-&gt;multiply($primes[$i]);</div>
<div class="line"><span class="lineno">  727</span> </div>
<div class="line"><span class="lineno">  728</span>                $temp = <a class="code hl_variable" href="classCrypt__RSA.html#a3512d5a4383616be363bc390ae3e7ec7">$primes</a>[$i]-&gt;subtract($this-&gt;one);</div>
<div class="line"><span class="lineno">  729</span> </div>
<div class="line"><span class="lineno">  730</span>                <span class="comment">// textbook RSA implementations use Euler&#39;s totient function instead of the least common multiple.</span></div>
<div class="line"><span class="lineno">  731</span>                <span class="comment">// see http://en.wikipedia.org/wiki/Euler%27s_totient_function</span></div>
<div class="line"><span class="lineno">  732</span>                $lcm[<span class="stringliteral">&#39;top&#39;</span>] = $lcm[<span class="stringliteral">&#39;top&#39;</span>]-&gt;multiply($temp);</div>
<div class="line"><span class="lineno">  733</span>                $lcm[<span class="stringliteral">&#39;bottom&#39;</span>] = $lcm[<span class="stringliteral">&#39;bottom&#39;</span>] === <span class="keyword">false</span> ? $temp : $lcm[<span class="stringliteral">&#39;bottom&#39;</span>]-&gt;gcd($temp);</div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a49441857b4bc8d5573cba6fea45f400d">$exponents</a>[$i] = $e-&gt;modInverse($temp);</div>
<div class="line"><span class="lineno">  736</span>            }</div>
<div class="line"><span class="lineno">  737</span> </div>
<div class="line"><span class="lineno">  738</span>            list($temp) = $lcm[<span class="stringliteral">&#39;top&#39;</span>]-&gt;divide($lcm[<span class="stringliteral">&#39;bottom&#39;</span>]);</div>
<div class="line"><span class="lineno">  739</span>            $gcd = $temp-&gt;gcd($e);</div>
<div class="line"><span class="lineno">  740</span>            $i0 = 1;</div>
<div class="line"><span class="lineno">  741</span>        } <span class="keywordflow">while</span> (!$gcd-&gt;equals($this-&gt;one));</div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>        $d = $e-&gt;modInverse($temp);</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>        <a class="code hl_variable" href="classCrypt__RSA.html#a2484451bccf0a9d944d2cb27fa103678">$coefficients</a>[2] = <a class="code hl_variable" href="classCrypt__RSA.html#a3512d5a4383616be363bc390ae3e7ec7">$primes</a>[2]-&gt;modInverse($primes[1]);</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>        <span class="comment">// from &lt;http://tools.ietf.org/html/rfc3447#appendix-A.1.2&gt;:</span></div>
<div class="line"><span class="lineno">  748</span>        <span class="comment">// RSAPrivateKey ::= SEQUENCE {</span></div>
<div class="line"><span class="lineno">  749</span>        <span class="comment">//     version           Version,</span></div>
<div class="line"><span class="lineno">  750</span>        <span class="comment">//     modulus           INTEGER,  -- n</span></div>
<div class="line"><span class="lineno">  751</span>        <span class="comment">//     publicExponent    INTEGER,  -- e</span></div>
<div class="line"><span class="lineno">  752</span>        <span class="comment">//     privateExponent   INTEGER,  -- d</span></div>
<div class="line"><span class="lineno">  753</span>        <span class="comment">//     prime1            INTEGER,  -- p</span></div>
<div class="line"><span class="lineno">  754</span>        <span class="comment">//     prime2            INTEGER,  -- q</span></div>
<div class="line"><span class="lineno">  755</span>        <span class="comment">//     exponent1         INTEGER,  -- d mod (p-1)</span></div>
<div class="line"><span class="lineno">  756</span>        <span class="comment">//     exponent2         INTEGER,  -- d mod (q-1)</span></div>
<div class="line"><span class="lineno">  757</span>        <span class="comment">//     coefficient       INTEGER,  -- (inverse of q) mod p</span></div>
<div class="line"><span class="lineno">  758</span>        <span class="comment">//     otherPrimeInfos   OtherPrimeInfos OPTIONAL</span></div>
<div class="line"><span class="lineno">  759</span>        <span class="comment">// }</span></div>
<div class="line"><span class="lineno">  760</span> </div>
<div class="line"><span class="lineno">  761</span>        <span class="keywordflow">return</span> array(</div>
<div class="line"><span class="lineno">  762</span>            <span class="stringliteral">&#39;privatekey&#39;</span> =&gt; $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a2bd18359bf21cecc783d2fde56b48045">_convertPrivateKey</a>($n, $e, $d, $primes, $exponents, $coefficients),</div>
<div class="line"><span class="lineno">  763</span>            <span class="stringliteral">&#39;publickey&#39;</span>  =&gt; $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a1ac38a64a86bc6963da281cf08c78d7a">_convertPublicKey</a>($n, $e),</div>
<div class="line"><span class="lineno">  764</span>            <span class="stringliteral">&#39;partialkey&#39;</span> =&gt; <span class="keyword">false</span></div>
<div class="line"><span class="lineno">  765</span>        );</div>
<div class="line"><span class="lineno">  766</span>    }</div>
<div class="ttc" id="aclassCrypt__RSA_html_a1ac38a64a86bc6963da281cf08c78d7a"><div class="ttname"><a href="classCrypt__RSA.html#a1ac38a64a86bc6963da281cf08c78d7a">Crypt_RSA\_convertPublicKey</a></div><div class="ttdeci">_convertPublicKey($n, $e)</div><div class="ttdoc">Convert a public key to the appropriate format.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l01077">RSA.php:1077</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_a2484451bccf0a9d944d2cb27fa103678"><div class="ttname"><a href="classCrypt__RSA.html#a2484451bccf0a9d944d2cb27fa103678">Crypt_RSA\$coefficients</a></div><div class="ttdeci">$coefficients</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00364">RSA.php:364</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_a2bd18359bf21cecc783d2fde56b48045"><div class="ttname"><a href="classCrypt__RSA.html#a2bd18359bf21cecc783d2fde56b48045">Crypt_RSA\_convertPrivateKey</a></div><div class="ttdeci">_convertPrivateKey($n, $e, $d, $primes, $exponents, $coefficients)</div><div class="ttdoc">Convert a private key to the appropriate format.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00781">RSA.php:781</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_a3512d5a4383616be363bc390ae3e7ec7"><div class="ttname"><a href="classCrypt__RSA.html#a3512d5a4383616be363bc390ae3e7ec7">Crypt_RSA\$primes</a></div><div class="ttdeci">$primes</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00348">RSA.php:348</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_a49441857b4bc8d5573cba6fea45f400d"><div class="ttname"><a href="classCrypt__RSA.html#a49441857b4bc8d5573cba6fea45f400d">Crypt_RSA\$exponents</a></div><div class="ttdeci">$exponents</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00356">RSA.php:356</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_a63369f75f78aece549868cebbf270794"><div class="ttname"><a href="classCrypt__RSA.html#a63369f75f78aece549868cebbf270794">Crypt_RSA\_generateMinMax</a></div><div class="ttdeci">_generateMinMax($bits)</div><div class="ttdoc">Generates the smallest and largest numbers requiring $bits bits.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l02112">RSA.php:2112</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l00781">_convertPrivateKey()</a>, <a class="el" href="RSA_8php_source.html#l01077">_convertPublicKey()</a>, <a class="el" href="RSA_8php_source.html#l02112">_generateMinMax()</a>, <a class="el" href="RSA_8php_source.html#l01157">_parseKey()</a>, <a class="el" href="RSA_8php_source.html#l00182">CRYPT_RSA_MODE_OPENSSL</a>, <a class="el" href="RSA_8php_source.html#l00200">CRYPT_RSA_PRIVATE_FORMAT_PKCS1</a>, and <a class="el" href="RSA_8php_source.html#l00249">CRYPT_RSA_PUBLIC_FORMAT_PKCS1</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a9c89d16d1494dbaef6d353e2f62ce02c_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a9c89d16d1494dbaef6d353e2f62ce02c_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a9c89d16d1494dbaef6d353e2f62ce02c_cgraph" id="aclassCrypt__RSA_a9c89d16d1494dbaef6d353e2f62ce02c_cgraph">
<area shape="rect" title="Create public / private key pair." alt="" coords="5,80,92,105"/>
<area shape="rect" href="classCrypt__RSA.html#a2bd18359bf21cecc783d2fde56b48045" title="Convert a private key to the appropriate format." alt="" coords="140,5,288,31"/>
<area shape="rect" href="classCrypt__RSA.html#a1ac38a64a86bc6963da281cf08c78d7a" title="Convert a public key to the appropriate format." alt="" coords="143,55,285,80"/>
<area shape="rect" href="classCrypt__RSA.html#a63369f75f78aece549868cebbf270794" title="Generates the smallest and largest numbers requiring $bits bits." alt="" coords="145,104,283,129"/>
<area shape="rect" href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5" title="Break a public or private key down into its constituant components." alt="" coords="169,177,259,203"/>
<area shape="rect" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018" title="DER&#45;encode the length." alt="" coords="336,31,456,56"/>
<area shape="rect" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe" title="DER&#45;decode the length." alt="" coords="336,127,456,152"/>
<area shape="rect" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35" title="String Shift." alt="" coords="504,152,605,177"/>
<area shape="rect" href="classCrypt__RSA.html#a009e0a2396931d62c87d27f4e2372024" title="Extract raw BER from Base64 encoding." alt="" coords="345,228,447,253"/>
</map>
</div>

</div>
</div>
<a id="a3ffaab04d34f40e24b7e2d265f2b7b9f" name="a3ffaab04d34f40e24b7e2d265f2b7b9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ffaab04d34f40e24b7e2d265f2b7b9f">&#9670;&#160;</a></span>Crypt_RSA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCrypt__RSA.html">Crypt_RSA</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PHP4 compatible Default Constructor. </p>
<dl class="section see"><dt>See also</dt><dd>self::__construct() @access public </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00577">577</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  578</span>    {</div>
<div class="line"><span class="lineno">  579</span>        $this-&gt;__construct();</div>
<div class="line"><span class="lineno">  580</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l00498">__construct()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a3ffaab04d34f40e24b7e2d265f2b7b9f_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a3ffaab04d34f40e24b7e2d265f2b7b9f_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a3ffaab04d34f40e24b7e2d265f2b7b9f_cgraph" id="aclassCrypt__RSA_a3ffaab04d34f40e24b7e2d265f2b7b9f_cgraph">
<area shape="rect" title="PHP4 compatible Default Constructor." alt="" coords="5,5,96,31"/>
<area shape="rect" href="classCrypt__RSA.html#a095c5d389db211932136b53f25f39685" title="The constructor." alt="" coords="144,5,240,31"/>
</map>
</div>

</div>
</div>
<a id="a7668d56408ddd5f0cd7e8e745afd9d9a" name="a7668d56408ddd5f0cd7e8e745afd9d9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7668d56408ddd5f0cd7e8e745afd9d9a">&#9670;&#160;</a></span>decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">decrypt </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ciphertext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decryption. </p>
<dl class="section see"><dt>See also</dt><dd>self::encrypt() @access public </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$ciphertext</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l03248">3248</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3249</span>    {</div>
<div class="line"><span class="lineno"> 3250</span>        <span class="keywordflow">if</span> ($this-&gt;k &lt;= 0) {</div>
<div class="line"><span class="lineno"> 3251</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3252</span>        }</div>
<div class="line"><span class="lineno"> 3253</span> </div>
<div class="line"><span class="lineno"> 3254</span>        $ciphertext = str_split($ciphertext, $this-&gt;k);</div>
<div class="line"><span class="lineno"> 3255</span>        $ciphertext[count($ciphertext) - 1] = str_pad($ciphertext[count($ciphertext) - 1], $this-&gt;k, chr(0), STR_PAD_LEFT);</div>
<div class="line"><span class="lineno"> 3256</span> </div>
<div class="line"><span class="lineno"> 3257</span>        $plaintext = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 3258</span> </div>
<div class="line"><span class="lineno"> 3259</span>        <span class="keywordflow">switch</span> ($this-&gt;encryptionMode) {</div>
<div class="line"><span class="lineno"> 3260</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#ada45b5308fa9f459da83c25a7a36bc92">CRYPT_RSA_ENCRYPTION_NONE</a>:</div>
<div class="line"><span class="lineno"> 3261</span>                $decrypt = <span class="stringliteral">&#39;_raw_encrypt&#39;</span>;</div>
<div class="line"><span class="lineno"> 3262</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3263</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#a894e6caa9f035b785736fd6456eb7833">CRYPT_RSA_ENCRYPTION_PKCS1</a>:</div>
<div class="line"><span class="lineno"> 3264</span>                $decrypt = <span class="stringliteral">&#39;_rsaes_pkcs1_v1_5_decrypt&#39;</span>;</div>
<div class="line"><span class="lineno"> 3265</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3266</span>            <span class="comment">//case CRYPT_RSA_ENCRYPTION_OAEP:</span></div>
<div class="line"><span class="lineno"> 3267</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3268</span>                $decrypt = <span class="stringliteral">&#39;_rsaes_oaep_decrypt&#39;</span>;</div>
<div class="line"><span class="lineno"> 3269</span>        }</div>
<div class="line"><span class="lineno"> 3270</span> </div>
<div class="line"><span class="lineno"> 3271</span>        <span class="keywordflow">foreach</span> ($ciphertext as $c) {</div>
<div class="line"><span class="lineno"> 3272</span>            $temp = $this-&gt;$decrypt($c);</div>
<div class="line"><span class="lineno"> 3273</span>            <span class="keywordflow">if</span> ($temp === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3274</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3275</span>            }</div>
<div class="line"><span class="lineno"> 3276</span>            $plaintext.= $temp;</div>
<div class="line"><span class="lineno"> 3277</span>        }</div>
<div class="line"><span class="lineno"> 3278</span> </div>
<div class="line"><span class="lineno"> 3279</span>        <span class="keywordflow">return</span> $plaintext;</div>
<div class="line"><span class="lineno"> 3280</span>    }</div>
<div class="ttc" id="aRSA_8php_html_a894e6caa9f035b785736fd6456eb7833"><div class="ttname"><a href="RSA_8php.html#a894e6caa9f035b785736fd6456eb7833">CRYPT_RSA_ENCRYPTION_PKCS1</a></div><div class="ttdeci">const CRYPT_RSA_ENCRYPTION_PKCS1</div><div class="ttdoc">Use PKCS#1 padding.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00109">RSA.php:109</a></div></div>
<div class="ttc" id="aRSA_8php_html_ada45b5308fa9f459da83c25a7a36bc92"><div class="ttname"><a href="RSA_8php.html#ada45b5308fa9f459da83c25a7a36bc92">CRYPT_RSA_ENCRYPTION_NONE</a></div><div class="ttdeci">const CRYPT_RSA_ENCRYPTION_NONE</div><div class="ttdoc">Do not use any padding.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00116">RSA.php:116</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l00116">CRYPT_RSA_ENCRYPTION_NONE</a>, and <a class="el" href="RSA_8php_source.html#l00109">CRYPT_RSA_ENCRYPTION_PKCS1</a>.</p>

</div>
</div>
<a id="aa5ceadf7c30ea677b755c6085b23f2a5" name="aa5ceadf7c30ea677b755c6085b23f2a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5ceadf7c30ea677b755c6085b23f2a5">&#9670;&#160;</a></span>encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encrypt </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$plaintext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encryption. </p>
<p>Both CRYPT_RSA_ENCRYPTION_OAEP and CRYPT_RSA_ENCRYPTION_PKCS1 both place limits on how long $plaintext can be. If $plaintext exceeds those limits it will be broken up so that it does and the resultant ciphertext's will be concatenated together.</p>
<dl class="section see"><dt>See also</dt><dd>self::decrypt() @access public </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$plaintext</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l03202">3202</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3203</span>    {</div>
<div class="line"><span class="lineno"> 3204</span>        <span class="keywordflow">switch</span> ($this-&gt;encryptionMode) {</div>
<div class="line"><span class="lineno"> 3205</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#ada45b5308fa9f459da83c25a7a36bc92">CRYPT_RSA_ENCRYPTION_NONE</a>:</div>
<div class="line"><span class="lineno"> 3206</span>                $plaintext = str_split($plaintext, $this-&gt;k);</div>
<div class="line"><span class="lineno"> 3207</span>                $ciphertext = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 3208</span>                <span class="keywordflow">foreach</span> ($plaintext as $m) {</div>
<div class="line"><span class="lineno"> 3209</span>                    $ciphertext.= $this-&gt;_raw_encrypt($m);</div>
<div class="line"><span class="lineno"> 3210</span>                }</div>
<div class="line"><span class="lineno"> 3211</span>                <span class="keywordflow">return</span> $ciphertext;</div>
<div class="line"><span class="lineno"> 3212</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#a894e6caa9f035b785736fd6456eb7833">CRYPT_RSA_ENCRYPTION_PKCS1</a>:</div>
<div class="line"><span class="lineno"> 3213</span>                $length = $this-&gt;k - 11;</div>
<div class="line"><span class="lineno"> 3214</span>                <span class="keywordflow">if</span> ($length &lt;= 0) {</div>
<div class="line"><span class="lineno"> 3215</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3216</span>                }</div>
<div class="line"><span class="lineno"> 3217</span> </div>
<div class="line"><span class="lineno"> 3218</span>                $plaintext = str_split($plaintext, $length);</div>
<div class="line"><span class="lineno"> 3219</span>                $ciphertext = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 3220</span>                <span class="keywordflow">foreach</span> ($plaintext as $m) {</div>
<div class="line"><span class="lineno"> 3221</span>                    $ciphertext.= $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a47bed67c0d9c4ecc11da13e0ad3cddb0">_rsaes_pkcs1_v1_5_encrypt</a>($m);</div>
<div class="line"><span class="lineno"> 3222</span>                }</div>
<div class="line"><span class="lineno"> 3223</span>                <span class="keywordflow">return</span> $ciphertext;</div>
<div class="line"><span class="lineno"> 3224</span>            <span class="comment">//case CRYPT_RSA_ENCRYPTION_OAEP:</span></div>
<div class="line"><span class="lineno"> 3225</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3226</span>                $length = $this-&gt;k - 2 * $this-&gt;hLen - 2;</div>
<div class="line"><span class="lineno"> 3227</span>                <span class="keywordflow">if</span> ($length &lt;= 0) {</div>
<div class="line"><span class="lineno"> 3228</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3229</span>                }</div>
<div class="line"><span class="lineno"> 3230</span> </div>
<div class="line"><span class="lineno"> 3231</span>                $plaintext = str_split($plaintext, $length);</div>
<div class="line"><span class="lineno"> 3232</span>                $ciphertext = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 3233</span>                <span class="keywordflow">foreach</span> ($plaintext as $m) {</div>
<div class="line"><span class="lineno"> 3234</span>                    $ciphertext.= $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a43d2341a9ffbeadcf13400dbe48988cc">_rsaes_oaep_encrypt</a>($m);</div>
<div class="line"><span class="lineno"> 3235</span>                }</div>
<div class="line"><span class="lineno"> 3236</span>                <span class="keywordflow">return</span> $ciphertext;</div>
<div class="line"><span class="lineno"> 3237</span>        }</div>
<div class="line"><span class="lineno"> 3238</span>    }</div>
<div class="ttc" id="aclassCrypt__RSA_html_a43d2341a9ffbeadcf13400dbe48988cc"><div class="ttname"><a href="classCrypt__RSA.html#a43d2341a9ffbeadcf13400dbe48988cc">Crypt_RSA\_rsaes_oaep_encrypt</a></div><div class="ttdeci">_rsaes_oaep_encrypt($m, $l='')</div><div class="ttdoc">RSAES-OAEP-ENCRYPT.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l02566">RSA.php:2566</a></div></div>
<div class="ttc" id="aclassCrypt__RSA_html_a47bed67c0d9c4ecc11da13e0ad3cddb0"><div class="ttname"><a href="classCrypt__RSA.html#a47bed67c0d9c4ecc11da13e0ad3cddb0">Crypt_RSA\_rsaes_pkcs1_v1_5_encrypt</a></div><div class="ttdeci">_rsaes_pkcs1_v1_5_encrypt($m)</div><div class="ttdoc">RSAES-PKCS1-V1_5-ENCRYPT.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l02710">RSA.php:2710</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l02694">_raw_encrypt()</a>, <a class="el" href="RSA_8php_source.html#l02566">_rsaes_oaep_encrypt()</a>, <a class="el" href="RSA_8php_source.html#l02710">_rsaes_pkcs1_v1_5_encrypt()</a>, <a class="el" href="RSA_8php_source.html#l00116">CRYPT_RSA_ENCRYPTION_NONE</a>, and <a class="el" href="RSA_8php_source.html#l00109">CRYPT_RSA_ENCRYPTION_PKCS1</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_aa5ceadf7c30ea677b755c6085b23f2a5_cgraph.png" border="0" usemap="#aclassCrypt__RSA_aa5ceadf7c30ea677b755c6085b23f2a5_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_aa5ceadf7c30ea677b755c6085b23f2a5_cgraph" id="aclassCrypt__RSA_aa5ceadf7c30ea677b755c6085b23f2a5_cgraph">
<area shape="rect" title="Encryption." alt="" coords="5,55,76,80"/>
<area shape="rect" href="classCrypt__RSA.html#a5a4bf86d0bc8f236078fee29827dc683" title="Raw Encryption / Decryption." alt="" coords="171,55,280,80"/>
<area shape="rect" href="classCrypt__RSA.html#a43d2341a9ffbeadcf13400dbe48988cc" title="RSAES&#45;OAEP&#45;ENCRYPT." alt="" coords="146,104,305,129"/>
<area shape="rect" href="classCrypt__RSA.html#a47bed67c0d9c4ecc11da13e0ad3cddb0" title="RSAES&#45;PKCS1&#45;V1_5&#45;ENCRYPT." alt="" coords="124,5,327,31"/>
<area shape="rect" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b" title="Integer&#45;to&#45;Octet&#45;String primitive." alt="" coords="375,5,439,31"/>
<area shape="rect" href="classCrypt__RSA.html#acfc45b22328d38a3e36ce78eb1fceab1" title="Octet&#45;String&#45;to&#45;Integer primitive." alt="" coords="375,55,439,80"/>
<area shape="rect" href="classCrypt__RSA.html#a5157f032e713c0485ba64caebea03bd4" title="RSAEP." alt="" coords="375,104,440,129"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="488,104,603,129"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="651,104,712,129"/>
<area shape="rect" href="classCrypt__RSA.html#abfcfdb9ca9cc5a3eeceee10ebcf793e0" title="MGF1." alt="" coords="376,153,439,179"/>
</map>
</div>

</div>
</div>
<a id="adb57c3d1b74c19589ba1d641ea1a390e" name="adb57c3d1b74c19589ba1d641ea1a390e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb57c3d1b74c19589ba1d641ea1a390e">&#9670;&#160;</a></span>getComment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getComment </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get public key comment. </p>
<p>@access public </p><dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l03185">3185</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3186</span>    {</div>
<div class="line"><span class="lineno"> 3187</span>        <span class="keywordflow">return</span> $this-&gt;comment;</div>
<div class="line"><span class="lineno"> 3188</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9220b3460a198b0e587361a34333a6e3" name="a9220b3460a198b0e587361a34333a6e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9220b3460a198b0e587361a34333a6e3">&#9670;&#160;</a></span>getPrivateKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getPrivateKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$type</em> = <code><a class="el" href="RSA_8php.html#a15eeb8d9dc1af1411f1549d4702c8a00">CRYPT_RSA_PUBLIC_FORMAT_PKCS1</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the private key. </p>
<p>The private key is only returned if the currently loaded key contains the constituent prime numbers.</p>
<dl class="section see"><dt>See also</dt><dd>self::getPublicKey() @access public </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$type</td><td>optional </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02040">2040</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2041</span>    {</div>
<div class="line"><span class="lineno"> 2042</span>        <span class="keywordflow">if</span> (empty($this-&gt;primes)) {</div>
<div class="line"><span class="lineno"> 2043</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2044</span>        }</div>
<div class="line"><span class="lineno"> 2045</span> </div>
<div class="line"><span class="lineno"> 2046</span>        $oldFormat = $this-&gt;privateKeyFormat;</div>
<div class="line"><span class="lineno"> 2047</span>        $this-&gt;privateKeyFormat = $type;</div>
<div class="line"><span class="lineno"> 2048</span>        $temp = $this-&gt;_convertPrivateKey($this-&gt;modulus, $this-&gt;publicExponent, $this-&gt;exponent, $this-&gt;primes, $this-&gt;exponents, $this-&gt;coefficients);</div>
<div class="line"><span class="lineno"> 2049</span>        $this-&gt;privateKeyFormat = $oldFormat;</div>
<div class="line"><span class="lineno"> 2050</span>        <span class="keywordflow">return</span> $temp;</div>
<div class="line"><span class="lineno"> 2051</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l00781">_convertPrivateKey()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l02082">__toString()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a9220b3460a198b0e587361a34333a6e3_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a9220b3460a198b0e587361a34333a6e3_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a9220b3460a198b0e587361a34333a6e3_cgraph" id="aclassCrypt__RSA_a9220b3460a198b0e587361a34333a6e3_cgraph">
<area shape="rect" title="Returns the private key." alt="" coords="5,5,119,31"/>
<area shape="rect" href="classCrypt__RSA.html#a2bd18359bf21cecc783d2fde56b48045" title="Convert a private key to the appropriate format." alt="" coords="167,5,315,31"/>
<area shape="rect" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018" title="DER&#45;encode the length." alt="" coords="363,5,483,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a9220b3460a198b0e587361a34333a6e3_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a9220b3460a198b0e587361a34333a6e3_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a9220b3460a198b0e587361a34333a6e3_icgraph" id="aclassCrypt__RSA_a9220b3460a198b0e587361a34333a6e3_icgraph">
<area shape="rect" title="Returns the private key." alt="" coords="140,5,253,31"/>
<area shape="rect" href="classCrypt__RSA.html#a7516ca30af0db3cdbf9a7739b48ce91d" title="__toString() magic method" alt="" coords="5,5,92,31"/>
</map>
</div>

</div>
</div>
<a id="a2537bd11389611acfb24dfd719fa8314" name="a2537bd11389611acfb24dfd719fa8314"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2537bd11389611acfb24dfd719fa8314">&#9670;&#160;</a></span>getPublicKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getPublicKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$type</em> = <code><a class="el" href="RSA_8php.html#a4741a3919471f37f2156fa615d24a49f">CRYPT_RSA_PUBLIC_FORMAT_PKCS8</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the public key. </p>
<p>The public key is only returned under two circumstances - if the private key had the public key embedded within it or if the public key was set via setPublicKey(). If the currently loaded key is supposed to be the public key this function won't return it since this library, for the most part, doesn't distinguish between public and private keys.</p>
<dl class="section see"><dt>See also</dt><dd>self::getPublicKey() @access public </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$type</td><td>optional </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l01982">1982</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1983</span>    {</div>
<div class="line"><span class="lineno"> 1984</span>        <span class="keywordflow">if</span> (empty($this-&gt;modulus) || empty($this-&gt;publicExponent)) {</div>
<div class="line"><span class="lineno"> 1985</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1986</span>        }</div>
<div class="line"><span class="lineno"> 1987</span> </div>
<div class="line"><span class="lineno"> 1988</span>        $oldFormat = $this-&gt;publicKeyFormat;</div>
<div class="line"><span class="lineno"> 1989</span>        $this-&gt;publicKeyFormat = $type;</div>
<div class="line"><span class="lineno"> 1990</span>        $temp = $this-&gt;_convertPublicKey($this-&gt;modulus, $this-&gt;publicExponent);</div>
<div class="line"><span class="lineno"> 1991</span>        $this-&gt;publicKeyFormat = $oldFormat;</div>
<div class="line"><span class="lineno"> 1992</span>        <span class="keywordflow">return</span> $temp;</div>
<div class="line"><span class="lineno"> 1993</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l01077">_convertPublicKey()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a2537bd11389611acfb24dfd719fa8314_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a2537bd11389611acfb24dfd719fa8314_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a2537bd11389611acfb24dfd719fa8314_cgraph" id="aclassCrypt__RSA_a2537bd11389611acfb24dfd719fa8314_cgraph">
<area shape="rect" title="Returns the public key." alt="" coords="5,5,112,31"/>
<area shape="rect" href="classCrypt__RSA.html#a1ac38a64a86bc6963da281cf08c78d7a" title="Convert a public key to the appropriate format." alt="" coords="160,5,301,31"/>
<area shape="rect" href="classCrypt__RSA.html#ab9967d86f5c5bdf50e4bc80cf1a9c018" title="DER&#45;encode the length." alt="" coords="349,5,469,31"/>
</map>
</div>

</div>
</div>
<a id="a9ef3a2fd4f138fef0ce7a3b5770d8e43" name="a9ef3a2fd4f138fef0ce7a3b5770d8e43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ef3a2fd4f138fef0ce7a3b5770d8e43">&#9670;&#160;</a></span>getPublicKeyFingerprint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getPublicKeyFingerprint </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$algorithm</em> = <code>'md5'</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the public key's fingerprint. </p>
<p>The public key's fingerprint is returned, which is equivalent to running <code>ssh-keygen -lf rsa.pub</code>. If there is no public key currently loaded, false is returned. Example output (md5): "c1:b1:30:29:d7:b8:de:6c:97:77:10:d7:46:41:63:87" (as specified by RFC 4716)</p>
<p>@access public </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$algorithm</td><td>The hashing algorithm to be used. Valid options are 'md5' and 'sha256'. False is returned for invalid values. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02007">2007</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2008</span>    {</div>
<div class="line"><span class="lineno"> 2009</span>        <span class="keywordflow">if</span> (empty($this-&gt;modulus) || empty($this-&gt;publicExponent)) {</div>
<div class="line"><span class="lineno"> 2010</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2011</span>        }</div>
<div class="line"><span class="lineno"> 2012</span> </div>
<div class="line"><span class="lineno"> 2013</span>        $modulus = $this-&gt;modulus-&gt;toBytes(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2014</span>        $publicExponent = $this-&gt;publicExponent-&gt;toBytes(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2015</span> </div>
<div class="line"><span class="lineno"> 2016</span>        $RSAPublicKey = pack(<span class="stringliteral">&#39;Na*Na*Na*&#39;</span>, strlen(<span class="stringliteral">&#39;ssh-rsa&#39;</span>), <span class="stringliteral">&#39;ssh-rsa&#39;</span>, strlen($publicExponent), $publicExponent, strlen($modulus), $modulus);</div>
<div class="line"><span class="lineno"> 2017</span> </div>
<div class="line"><span class="lineno"> 2018</span>        <span class="keywordflow">switch</span> ($algorithm) {</div>
<div class="line"><span class="lineno"> 2019</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha256&#39;</span>:</div>
<div class="line"><span class="lineno"> 2020</span>                $hash = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__Hash.html">Crypt_Hash</a>(<span class="stringliteral">&#39;sha256&#39;</span>);</div>
<div class="line"><span class="lineno"> 2021</span>                $base = base64_encode($hash-&gt;hash($RSAPublicKey));</div>
<div class="line"><span class="lineno"> 2022</span>                <span class="keywordflow">return</span> substr($base, 0, strlen($base) - 1);</div>
<div class="line"><span class="lineno"> 2023</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;md5&#39;</span>:</div>
<div class="line"><span class="lineno"> 2024</span>                <span class="keywordflow">return</span> substr(chunk_split(md5($RSAPublicKey), 2, <span class="charliteral">&#39;:&#39;</span>), 0, -1);</div>
<div class="line"><span class="lineno"> 2025</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2026</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2027</span>        }</div>
<div class="line"><span class="lineno"> 2028</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a75cce10cdf81be6dc84881c28b3379b7" name="a75cce10cdf81be6dc84881c28b3379b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75cce10cdf81be6dc84881c28b3379b7">&#9670;&#160;</a></span>getSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getSize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the key size. </p>
<p>More specifically, this returns the size of the modulo in bits.</p>
<p>@access public </p><dl class="section return"><dt>Returns</dt><dd>int </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l01652">1652</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1653</span>    {</div>
<div class="line"><span class="lineno"> 1654</span>        <span class="keywordflow">return</span> !isset($this-&gt;modulus) ? 0 : strlen($this-&gt;modulus-&gt;toBits());</div>
<div class="line"><span class="lineno"> 1655</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aecd4eb5e57d8881db518d98009bd75ee" name="aecd4eb5e57d8881db518d98009bd75ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecd4eb5e57d8881db518d98009bd75ee">&#9670;&#160;</a></span>loadKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">loadKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$type</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads a public or private key. </p>
<p>Returns true on success and false on failure (ie. an incorrect password was provided or the key was malformed)</p>
<p>@access public </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$type</td><td>optional </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l01741">1741</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1742</span>    {</div>
<div class="line"><span class="lineno"> 1743</span>        <span class="keywordflow">if</span> (is_object($key) &amp;&amp; strtolower(get_class($key)) == <span class="stringliteral">&#39;crypt_rsa&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1744</span>            $this-&gt;privateKeyFormat = $key-&gt;privateKeyFormat;</div>
<div class="line"><span class="lineno"> 1745</span>            $this-&gt;publicKeyFormat = $key-&gt;publicKeyFormat;</div>
<div class="line"><span class="lineno"> 1746</span>            $this-&gt;k = $key-&gt;k;</div>
<div class="line"><span class="lineno"> 1747</span>            $this-&gt;hLen = $key-&gt;hLen;</div>
<div class="line"><span class="lineno"> 1748</span>            $this-&gt;sLen = $key-&gt;sLen;</div>
<div class="line"><span class="lineno"> 1749</span>            $this-&gt;mgfHLen = $key-&gt;mgfHLen;</div>
<div class="line"><span class="lineno"> 1750</span>            $this-&gt;encryptionMode = $key-&gt;encryptionMode;</div>
<div class="line"><span class="lineno"> 1751</span>            $this-&gt;signatureMode = $key-&gt;signatureMode;</div>
<div class="line"><span class="lineno"> 1752</span>            $this-&gt;password = $key-&gt;password;</div>
<div class="line"><span class="lineno"> 1753</span>            $this-&gt;configFile = $key-&gt;configFile;</div>
<div class="line"><span class="lineno"> 1754</span>            $this-&gt;comment = $key-&gt;comment;</div>
<div class="line"><span class="lineno"> 1755</span> </div>
<div class="line"><span class="lineno"> 1756</span>            <span class="keywordflow">if</span> (is_object($key-&gt;hash)) {</div>
<div class="line"><span class="lineno"> 1757</span>                $this-&gt;hash = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__Hash.html">Crypt_Hash</a>($key-&gt;hash-&gt;getHash());</div>
<div class="line"><span class="lineno"> 1758</span>            }</div>
<div class="line"><span class="lineno"> 1759</span>            <span class="keywordflow">if</span> (is_object($key-&gt;mgfHash)) {</div>
<div class="line"><span class="lineno"> 1760</span>                $this-&gt;mgfHash = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__Hash.html">Crypt_Hash</a>($key-&gt;mgfHash-&gt;getHash());</div>
<div class="line"><span class="lineno"> 1761</span>            }</div>
<div class="line"><span class="lineno"> 1762</span> </div>
<div class="line"><span class="lineno"> 1763</span>            <span class="keywordflow">if</span> (is_object($key-&gt;modulus)) {</div>
<div class="line"><span class="lineno"> 1764</span>                $this-&gt;modulus = $key-&gt;modulus-&gt;copy();</div>
<div class="line"><span class="lineno"> 1765</span>            }</div>
<div class="line"><span class="lineno"> 1766</span>            <span class="keywordflow">if</span> (is_object($key-&gt;exponent)) {</div>
<div class="line"><span class="lineno"> 1767</span>                $this-&gt;exponent = $key-&gt;exponent-&gt;copy();</div>
<div class="line"><span class="lineno"> 1768</span>            }</div>
<div class="line"><span class="lineno"> 1769</span>            <span class="keywordflow">if</span> (is_object($key-&gt;publicExponent)) {</div>
<div class="line"><span class="lineno"> 1770</span>                $this-&gt;publicExponent = $key-&gt;publicExponent-&gt;copy();</div>
<div class="line"><span class="lineno"> 1771</span>            }</div>
<div class="line"><span class="lineno"> 1772</span> </div>
<div class="line"><span class="lineno"> 1773</span>            $this-&gt;primes = array();</div>
<div class="line"><span class="lineno"> 1774</span>            $this-&gt;exponents = array();</div>
<div class="line"><span class="lineno"> 1775</span>            $this-&gt;coefficients = array();</div>
<div class="line"><span class="lineno"> 1776</span> </div>
<div class="line"><span class="lineno"> 1777</span>            <span class="keywordflow">foreach</span> ($this-&gt;primes as $prime) {</div>
<div class="line"><span class="lineno"> 1778</span>                $this-&gt;primes[] = $prime-&gt;copy();</div>
<div class="line"><span class="lineno"> 1779</span>            }</div>
<div class="line"><span class="lineno"> 1780</span>            <span class="keywordflow">foreach</span> ($this-&gt;exponents as $exponent) {</div>
<div class="line"><span class="lineno"> 1781</span>                $this-&gt;exponents[] = $exponent-&gt;copy();</div>
<div class="line"><span class="lineno"> 1782</span>            }</div>
<div class="line"><span class="lineno"> 1783</span>            <span class="keywordflow">foreach</span> ($this-&gt;coefficients as $coefficient) {</div>
<div class="line"><span class="lineno"> 1784</span>                $this-&gt;coefficients[] = $coefficient-&gt;copy();</div>
<div class="line"><span class="lineno"> 1785</span>            }</div>
<div class="line"><span class="lineno"> 1786</span> </div>
<div class="line"><span class="lineno"> 1787</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1788</span>        }</div>
<div class="line"><span class="lineno"> 1789</span> </div>
<div class="line"><span class="lineno"> 1790</span>        <span class="keywordflow">if</span> ($type === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1791</span>            $types = array(</div>
<div class="line"><span class="lineno"> 1792</span>                <a class="code hl_variable" href="RSA_8php.html#aefa5f08fd7a48e3c6299a0bc4b35184d">CRYPT_RSA_PUBLIC_FORMAT_RAW</a>,</div>
<div class="line"><span class="lineno"> 1793</span>                <a class="code hl_variable" href="RSA_8php.html#a72160567057c92a07f17877a8e6a1465">CRYPT_RSA_PRIVATE_FORMAT_PKCS1</a>,</div>
<div class="line"><span class="lineno"> 1794</span>                <a class="code hl_variable" href="RSA_8php.html#a079b3a2b5b60dd742b6801f5fb426a8b">CRYPT_RSA_PRIVATE_FORMAT_XML</a>,</div>
<div class="line"><span class="lineno"> 1795</span>                <a class="code hl_variable" href="RSA_8php.html#a20b24fa8e7681b564ff3085d4c1d5406">CRYPT_RSA_PRIVATE_FORMAT_PUTTY</a>,</div>
<div class="line"><span class="lineno"> 1796</span>                <a class="code hl_variable" href="RSA_8php.html#ad392896470610c196028e017e2c5e00c">CRYPT_RSA_PUBLIC_FORMAT_OPENSSH</a>,</div>
<div class="line"><span class="lineno"> 1797</span>                <a class="code hl_variable" href="RSA_8php.html#aa33af2fe22ee3914635fe1e74bb3f8cf">CRYPT_RSA_PRIVATE_FORMAT_OPENSSH</a></div>
<div class="line"><span class="lineno"> 1798</span>            );</div>
<div class="line"><span class="lineno"> 1799</span>            <span class="keywordflow">foreach</span> ($types as $type) {</div>
<div class="line"><span class="lineno"> 1800</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a> = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5">_parseKey</a>($key, $type);</div>
<div class="line"><span class="lineno"> 1801</span>                <span class="keywordflow">if</span> ($components !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1802</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1803</span>                }</div>
<div class="line"><span class="lineno"> 1804</span>            }</div>
<div class="line"><span class="lineno"> 1805</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1806</span>            <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a> = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5">_parseKey</a>($key, $type);</div>
<div class="line"><span class="lineno"> 1807</span>        }</div>
<div class="line"><span class="lineno"> 1808</span> </div>
<div class="line"><span class="lineno"> 1809</span>        <span class="keywordflow">if</span> ($components === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1810</span>            $this-&gt;comment = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1811</span>            $this-&gt;modulus = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1812</span>            $this-&gt;k = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1813</span>            $this-&gt;exponent = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1814</span>            $this-&gt;primes = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1815</span>            $this-&gt;exponents = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1816</span>            $this-&gt;coefficients = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1817</span>            $this-&gt;publicExponent = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1818</span> </div>
<div class="line"><span class="lineno"> 1819</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1820</span>        }</div>
<div class="line"><span class="lineno"> 1821</span> </div>
<div class="line"><span class="lineno"> 1822</span>        <span class="keywordflow">if</span> (isset($components[<span class="stringliteral">&#39;comment&#39;</span>]) &amp;&amp; $components[<span class="stringliteral">&#39;comment&#39;</span>] !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1823</span>            $this-&gt;comment = <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;comment&#39;</span>];</div>
<div class="line"><span class="lineno"> 1824</span>        }</div>
<div class="line"><span class="lineno"> 1825</span>        $this-&gt;modulus = <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;modulus&#39;</span>];</div>
<div class="line"><span class="lineno"> 1826</span>        $this-&gt;k = strlen($this-&gt;modulus-&gt;toBytes());</div>
<div class="line"><span class="lineno"> 1827</span>        $this-&gt;exponent = isset($components[<span class="stringliteral">&#39;privateExponent&#39;</span>]) ? <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;privateExponent&#39;</span>] : <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;publicExponent&#39;</span>];</div>
<div class="line"><span class="lineno"> 1828</span>        <span class="keywordflow">if</span> (isset($components[<span class="stringliteral">&#39;primes&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1829</span>            $this-&gt;primes = <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;primes&#39;</span>];</div>
<div class="line"><span class="lineno"> 1830</span>            $this-&gt;exponents = <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;exponents&#39;</span>];</div>
<div class="line"><span class="lineno"> 1831</span>            $this-&gt;coefficients = <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;coefficients&#39;</span>];</div>
<div class="line"><span class="lineno"> 1832</span>            $this-&gt;publicExponent = <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;publicExponent&#39;</span>];</div>
<div class="line"><span class="lineno"> 1833</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1834</span>            $this-&gt;primes = array();</div>
<div class="line"><span class="lineno"> 1835</span>            $this-&gt;exponents = array();</div>
<div class="line"><span class="lineno"> 1836</span>            $this-&gt;coefficients = array();</div>
<div class="line"><span class="lineno"> 1837</span>            $this-&gt;publicExponent = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1838</span>        }</div>
<div class="line"><span class="lineno"> 1839</span> </div>
<div class="line"><span class="lineno"> 1840</span>        <span class="keywordflow">switch</span> ($type) {</div>
<div class="line"><span class="lineno"> 1841</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#ad392896470610c196028e017e2c5e00c">CRYPT_RSA_PUBLIC_FORMAT_OPENSSH</a>:</div>
<div class="line"><span class="lineno"> 1842</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#aefa5f08fd7a48e3c6299a0bc4b35184d">CRYPT_RSA_PUBLIC_FORMAT_RAW</a>:</div>
<div class="line"><span class="lineno"> 1843</span>                $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a5c291d208f8e9a8ea7e0e4b6335a61a9">setPublicKey</a>();</div>
<div class="line"><span class="lineno"> 1844</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1845</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#a72160567057c92a07f17877a8e6a1465">CRYPT_RSA_PRIVATE_FORMAT_PKCS1</a>:</div>
<div class="line"><span class="lineno"> 1846</span>                <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 1847</span>                    <span class="keywordflow">case</span> strpos($key, <span class="stringliteral">&#39;-BEGIN PUBLIC KEY-&#39;</span>) !== <span class="keyword">false</span>:</div>
<div class="line"><span class="lineno"> 1848</span>                    <span class="keywordflow">case</span> strpos($key, <span class="stringliteral">&#39;-BEGIN RSA PUBLIC KEY-&#39;</span>) !== <span class="keyword">false</span>:</div>
<div class="line"><span class="lineno"> 1849</span>                        $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a5c291d208f8e9a8ea7e0e4b6335a61a9">setPublicKey</a>();</div>
<div class="line"><span class="lineno"> 1850</span>                }</div>
<div class="line"><span class="lineno"> 1851</span>        }</div>
<div class="line"><span class="lineno"> 1852</span> </div>
<div class="line"><span class="lineno"> 1853</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1854</span>    }</div>
<div class="ttc" id="aclassCrypt__RSA_html_a5c291d208f8e9a8ea7e0e4b6335a61a9"><div class="ttname"><a href="classCrypt__RSA.html#a5c291d208f8e9a8ea7e0e4b6335a61a9">Crypt_RSA\setPublicKey</a></div><div class="ttdeci">setPublicKey($key=false, $type=false)</div><div class="ttdoc">Defines the public key.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l01893">RSA.php:1893</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l01157">_parseKey()</a>, <a class="el" href="RSA_8php_source.html#l00216">CRYPT_RSA_PRIVATE_FORMAT_OPENSSH</a>, <a class="el" href="RSA_8php_source.html#l00200">CRYPT_RSA_PRIVATE_FORMAT_PKCS1</a>, <a class="el" href="RSA_8php_source.html#l00204">CRYPT_RSA_PRIVATE_FORMAT_PUTTY</a>, <a class="el" href="RSA_8php_source.html#l00208">CRYPT_RSA_PRIVATE_FORMAT_XML</a>, <a class="el" href="RSA_8php_source.html#l00260">CRYPT_RSA_PUBLIC_FORMAT_OPENSSH</a>, <a class="el" href="RSA_8php_source.html#l00237">CRYPT_RSA_PUBLIC_FORMAT_RAW</a>, and <a class="el" href="RSA_8php_source.html#l01893">setPublicKey()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l01953">setPrivateKey()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_aecd4eb5e57d8881db518d98009bd75ee_cgraph.png" border="0" usemap="#aclassCrypt__RSA_aecd4eb5e57d8881db518d98009bd75ee_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_aecd4eb5e57d8881db518d98009bd75ee_cgraph" id="aclassCrypt__RSA_aecd4eb5e57d8881db518d98009bd75ee_cgraph">
<area shape="rect" title="Loads a public or private key." alt="" coords="5,56,80,81"/>
<area shape="rect" href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5" title="Break a public or private key down into its constituant components." alt="" coords="281,56,371,81"/>
<area shape="rect" href="classCrypt__RSA.html#a5c291d208f8e9a8ea7e0e4b6335a61a9" title="Defines the public key." alt="" coords="128,81,233,107"/>
<area shape="rect" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe" title="DER&#45;decode the length." alt="" coords="419,5,539,31"/>
<area shape="rect" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35" title="String Shift." alt="" coords="587,31,688,56"/>
<area shape="rect" href="classCrypt__RSA.html#a009e0a2396931d62c87d27f4e2372024" title="Extract raw BER from Base64 encoding." alt="" coords="428,107,529,132"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_aecd4eb5e57d8881db518d98009bd75ee_icgraph.png" border="0" usemap="#aclassCrypt__RSA_aecd4eb5e57d8881db518d98009bd75ee_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_aecd4eb5e57d8881db518d98009bd75ee_icgraph" id="aclassCrypt__RSA_aecd4eb5e57d8881db518d98009bd75ee_icgraph">
<area shape="rect" title="Loads a public or private key." alt="" coords="165,5,240,31"/>
<area shape="rect" href="classCrypt__RSA.html#a871b11d67cc3a8f62e4c0306e64c7c1b" title="Defines the private key." alt="" coords="5,5,117,31"/>
</map>
</div>

</div>
</div>
<a id="a169d67ad53abdd4e6d1cd931fe15e839" name="a169d67ad53abdd4e6d1cd931fe15e839"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a169d67ad53abdd4e6d1cd931fe15e839">&#9670;&#160;</a></span>setComment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setComment </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$comment</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set public key comment. </p>
<p>@access public </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$comment</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l03174">3174</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3175</span>    {</div>
<div class="line"><span class="lineno"> 3176</span>        $this-&gt;comment = $comment;</div>
<div class="line"><span class="lineno"> 3177</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5c3f88cca5b61fb0c79d57cce592c16b" name="a5c3f88cca5b61fb0c79d57cce592c16b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c3f88cca5b61fb0c79d57cce592c16b">&#9670;&#160;</a></span>setEncryptionMode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setEncryptionMode </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set Encryption Mode. </p>
<p>Valid values include CRYPT_RSA_ENCRYPTION_OAEP and CRYPT_RSA_ENCRYPTION_PKCS1.</p>
<p>@access public </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$mode</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l03150">3150</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3151</span>    {</div>
<div class="line"><span class="lineno"> 3152</span>        $this-&gt;encryptionMode = $mode;</div>
<div class="line"><span class="lineno"> 3153</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab6c0bf5357622f2aea1b76623ae52d76" name="ab6c0bf5357622f2aea1b76623ae52d76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6c0bf5357622f2aea1b76623ae52d76">&#9670;&#160;</a></span>setHash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setHash </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$hash</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines which hashing function should be used. </p>
<p>Used with signature production / verification and (if the encryption mode is CRYPT_RSA_ENCRYPTION_OAEP) encryption and decryption. If $hash isn't supported, sha1 is used.</p>
<p>@access public </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$hash</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02222">2222</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2223</span>    {</div>
<div class="line"><span class="lineno"> 2224</span>        <span class="comment">// Crypt_Hash supports algorithms that PKCS#1 doesn&#39;t support.  md5-96 and sha1-96, for example.</span></div>
<div class="line"><span class="lineno"> 2225</span>        <span class="keywordflow">switch</span> ($hash) {</div>
<div class="line"><span class="lineno"> 2226</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;md2&#39;</span>:</div>
<div class="line"><span class="lineno"> 2227</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;md5&#39;</span>:</div>
<div class="line"><span class="lineno"> 2228</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha1&#39;</span>:</div>
<div class="line"><span class="lineno"> 2229</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha256&#39;</span>:</div>
<div class="line"><span class="lineno"> 2230</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha384&#39;</span>:</div>
<div class="line"><span class="lineno"> 2231</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha512&#39;</span>:</div>
<div class="line"><span class="lineno"> 2232</span>                $this-&gt;hash = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__Hash.html">Crypt_Hash</a>($hash);</div>
<div class="line"><span class="lineno"> 2233</span>                $this-&gt;hashName = $hash;</div>
<div class="line"><span class="lineno"> 2234</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2235</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2236</span>                $this-&gt;hash = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__Hash.html">Crypt_Hash</a>(<span class="stringliteral">&#39;sha1&#39;</span>);</div>
<div class="line"><span class="lineno"> 2237</span>                $this-&gt;hashName = <span class="stringliteral">&#39;sha1&#39;</span>;</div>
<div class="line"><span class="lineno"> 2238</span>        }</div>
<div class="line"><span class="lineno"> 2239</span>        $this-&gt;hLen = $this-&gt;hash-&gt;getLength();</div>
<div class="line"><span class="lineno"> 2240</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa10d5d9f489e469dcecd3df6aef2c286" name="aa10d5d9f489e469dcecd3df6aef2c286"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa10d5d9f489e469dcecd3df6aef2c286">&#9670;&#160;</a></span>setMGFHash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setMGFHash </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$hash</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines which hashing function should be used for the mask generation function. </p>
<p>The mask generation function is used by CRYPT_RSA_ENCRYPTION_OAEP and CRYPT_RSA_SIGNATURE_PSS and although it's best if Hash and MGFHash are set to the same thing this is not a requirement.</p>
<p>@access public </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$hash</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02251">2251</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2252</span>    {</div>
<div class="line"><span class="lineno"> 2253</span>        <span class="comment">// Crypt_Hash supports algorithms that PKCS#1 doesn&#39;t support.  md5-96 and sha1-96, for example.</span></div>
<div class="line"><span class="lineno"> 2254</span>        <span class="keywordflow">switch</span> ($hash) {</div>
<div class="line"><span class="lineno"> 2255</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;md2&#39;</span>:</div>
<div class="line"><span class="lineno"> 2256</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;md5&#39;</span>:</div>
<div class="line"><span class="lineno"> 2257</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha1&#39;</span>:</div>
<div class="line"><span class="lineno"> 2258</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha256&#39;</span>:</div>
<div class="line"><span class="lineno"> 2259</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha384&#39;</span>:</div>
<div class="line"><span class="lineno"> 2260</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha512&#39;</span>:</div>
<div class="line"><span class="lineno"> 2261</span>                $this-&gt;mgfHash = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__Hash.html">Crypt_Hash</a>($hash);</div>
<div class="line"><span class="lineno"> 2262</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2263</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2264</span>                $this-&gt;mgfHash = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__Hash.html">Crypt_Hash</a>(<span class="stringliteral">&#39;sha1&#39;</span>);</div>
<div class="line"><span class="lineno"> 2265</span>        }</div>
<div class="line"><span class="lineno"> 2266</span>        $this-&gt;mgfHLen = $this-&gt;mgfHash-&gt;getLength();</div>
<div class="line"><span class="lineno"> 2267</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afb198e11b62e4f096ea176fbc57ae226" name="afb198e11b62e4f096ea176fbc57ae226"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb198e11b62e4f096ea176fbc57ae226">&#9670;&#160;</a></span>setPassword()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setPassword </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$password</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the password. </p>
<p>Private keys can be encrypted with a password. To unset the password, pass in the empty string or false. Or rather, pass in $password such that empty($password) &amp;&amp; !is_string($password) is true.</p>
<dl class="section see"><dt>See also</dt><dd>self::createKey() </dd>
<dd>
self::loadKey() @access public </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$password</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l01867">1867</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1868</span>    {</div>
<div class="line"><span class="lineno"> 1869</span>        $this-&gt;password = $password;</div>
<div class="line"><span class="lineno"> 1870</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a871b11d67cc3a8f62e4c0306e64c7c1b" name="a871b11d67cc3a8f62e4c0306e64c7c1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a871b11d67cc3a8f62e4c0306e64c7c1b">&#9670;&#160;</a></span>setPrivateKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setPrivateKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$type</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines the private key. </p>
<p>If phpseclib guessed a private key was a public key and loaded it as such it might be desirable to force phpseclib to treat the key as a private key. This function will do that.</p>
<p>Do note that when a new key is loaded the index will be cleared.</p>
<p>Returns true on success, false on failure</p>
<dl class="section see"><dt>See also</dt><dd>self::getPublicKey() @access public </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td>optional </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$type</td><td>optional </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l01953">1953</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1954</span>    {</div>
<div class="line"><span class="lineno"> 1955</span>        <span class="keywordflow">if</span> ($key === <span class="keyword">false</span> &amp;&amp; !empty($this-&gt;publicExponent)) {</div>
<div class="line"><span class="lineno"> 1956</span>            $this-&gt;publicExponent = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1957</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1958</span>        }</div>
<div class="line"><span class="lineno"> 1959</span> </div>
<div class="line"><span class="lineno"> 1960</span>        $rsa = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__RSA.html">Crypt_RSA</a>();</div>
<div class="line"><span class="lineno"> 1961</span>        <span class="keywordflow">if</span> (!$rsa-&gt;loadKey($key, $type)) {</div>
<div class="line"><span class="lineno"> 1962</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1963</span>        }</div>
<div class="line"><span class="lineno"> 1964</span>        $rsa-&gt;publicExponent = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1965</span> </div>
<div class="line"><span class="lineno"> 1966</span>        <span class="comment">// don&#39;t overwrite the old key if the new key is invalid</span></div>
<div class="line"><span class="lineno"> 1967</span>        $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#aecd4eb5e57d8881db518d98009bd75ee">loadKey</a>($rsa);</div>
<div class="line"><span class="lineno"> 1968</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1969</span>    }</div>
<div class="ttc" id="aclassCrypt__RSA_html_aecd4eb5e57d8881db518d98009bd75ee"><div class="ttname"><a href="classCrypt__RSA.html#aecd4eb5e57d8881db518d98009bd75ee">Crypt_RSA\loadKey</a></div><div class="ttdeci">loadKey($key, $type=false)</div><div class="ttdoc">Loads a public or private key.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l01741">RSA.php:1741</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l01741">loadKey()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a871b11d67cc3a8f62e4c0306e64c7c1b_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a871b11d67cc3a8f62e4c0306e64c7c1b_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a871b11d67cc3a8f62e4c0306e64c7c1b_cgraph" id="aclassCrypt__RSA_a871b11d67cc3a8f62e4c0306e64c7c1b_cgraph">
<area shape="rect" title="Defines the private key." alt="" coords="5,56,117,81"/>
<area shape="rect" href="classCrypt__RSA.html#aecd4eb5e57d8881db518d98009bd75ee" title="Loads a public or private key." alt="" coords="165,56,240,81"/>
<area shape="rect" href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5" title="Break a public or private key down into its constituant components." alt="" coords="441,56,531,81"/>
<area shape="rect" href="classCrypt__RSA.html#a5c291d208f8e9a8ea7e0e4b6335a61a9" title="Defines the public key." alt="" coords="288,81,393,107"/>
<area shape="rect" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe" title="DER&#45;decode the length." alt="" coords="579,5,699,31"/>
<area shape="rect" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35" title="String Shift." alt="" coords="747,31,848,56"/>
<area shape="rect" href="classCrypt__RSA.html#a009e0a2396931d62c87d27f4e2372024" title="Extract raw BER from Base64 encoding." alt="" coords="588,107,689,132"/>
</map>
</div>

</div>
</div>
<a id="a328ed81271f621fb5637c11ed378bf46" name="a328ed81271f621fb5637c11ed378bf46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a328ed81271f621fb5637c11ed378bf46">&#9670;&#160;</a></span>setPrivateKeyFormat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setPrivateKeyFormat </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$format</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the private key format. </p>
<dl class="section see"><dt>See also</dt><dd>self::createKey() @access public </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$format</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02196">2196</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2197</span>    {</div>
<div class="line"><span class="lineno"> 2198</span>        $this-&gt;privateKeyFormat = $format;</div>
<div class="line"><span class="lineno"> 2199</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5c291d208f8e9a8ea7e0e4b6335a61a9" name="a5c291d208f8e9a8ea7e0e4b6335a61a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c291d208f8e9a8ea7e0e4b6335a61a9">&#9670;&#160;</a></span>setPublicKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setPublicKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$type</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines the public key. </p>
<p>Some private key formats define the public exponent and some don't. Those that don't define it are problematic when used in certain contexts. For example, in SSH-2, RSA authentication works by sending the public key along with a message signed by the private key to the server. The SSH-2 server looks the public key up in an index of public keys and if it's present then proceeds to verify the signature. Problem is, if your private key doesn't include the public exponent this won't work unless you manually add the public exponent. phpseclib tries to guess if the key being used is the public key but in the event that it guesses incorrectly you might still want to explicitly set the key as being public.</p>
<p>Do note that when a new key is loaded the index will be cleared.</p>
<p>Returns true on success, false on failure</p>
<dl class="section see"><dt>See also</dt><dd>self::getPublicKey() @access public </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td>optional </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$type</td><td>optional </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l01893">1893</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1894</span>    {</div>
<div class="line"><span class="lineno"> 1895</span>        <span class="comment">// if a public key has already been loaded return false</span></div>
<div class="line"><span class="lineno"> 1896</span>        <span class="keywordflow">if</span> (!empty($this-&gt;publicExponent)) {</div>
<div class="line"><span class="lineno"> 1897</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1898</span>        }</div>
<div class="line"><span class="lineno"> 1899</span> </div>
<div class="line"><span class="lineno"> 1900</span>        <span class="keywordflow">if</span> ($key === <span class="keyword">false</span> &amp;&amp; !empty($this-&gt;modulus)) {</div>
<div class="line"><span class="lineno"> 1901</span>            $this-&gt;publicExponent = $this-&gt;exponent;</div>
<div class="line"><span class="lineno"> 1902</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1903</span>        }</div>
<div class="line"><span class="lineno"> 1904</span> </div>
<div class="line"><span class="lineno"> 1905</span>        <span class="keywordflow">if</span> ($type === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1906</span>            $types = array(</div>
<div class="line"><span class="lineno"> 1907</span>                <a class="code hl_variable" href="RSA_8php.html#aefa5f08fd7a48e3c6299a0bc4b35184d">CRYPT_RSA_PUBLIC_FORMAT_RAW</a>,</div>
<div class="line"><span class="lineno"> 1908</span>                <a class="code hl_variable" href="RSA_8php.html#a15eeb8d9dc1af1411f1549d4702c8a00">CRYPT_RSA_PUBLIC_FORMAT_PKCS1</a>,</div>
<div class="line"><span class="lineno"> 1909</span>                <a class="code hl_variable" href="RSA_8php.html#a31bc387c1d18654ce5877d588a0b0a89">CRYPT_RSA_PUBLIC_FORMAT_XML</a>,</div>
<div class="line"><span class="lineno"> 1910</span>                <a class="code hl_variable" href="RSA_8php.html#ad392896470610c196028e017e2c5e00c">CRYPT_RSA_PUBLIC_FORMAT_OPENSSH</a></div>
<div class="line"><span class="lineno"> 1911</span>            );</div>
<div class="line"><span class="lineno"> 1912</span>            <span class="keywordflow">foreach</span> ($types as $type) {</div>
<div class="line"><span class="lineno"> 1913</span>                <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a> = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5">_parseKey</a>($key, $type);</div>
<div class="line"><span class="lineno"> 1914</span>                <span class="keywordflow">if</span> ($components !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1915</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1916</span>                }</div>
<div class="line"><span class="lineno"> 1917</span>            }</div>
<div class="line"><span class="lineno"> 1918</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1919</span>            <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a> = $this-&gt;<a class="code hl_function" href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5">_parseKey</a>($key, $type);</div>
<div class="line"><span class="lineno"> 1920</span>        }</div>
<div class="line"><span class="lineno"> 1921</span> </div>
<div class="line"><span class="lineno"> 1922</span>        <span class="keywordflow">if</span> ($components === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1923</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1924</span>        }</div>
<div class="line"><span class="lineno"> 1925</span> </div>
<div class="line"><span class="lineno"> 1926</span>        <span class="keywordflow">if</span> (empty($this-&gt;modulus) || !$this-&gt;modulus-&gt;equals($components[<span class="stringliteral">&#39;modulus&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1927</span>            $this-&gt;modulus = <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;modulus&#39;</span>];</div>
<div class="line"><span class="lineno"> 1928</span>            $this-&gt;exponent = $this-&gt;publicExponent = <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;publicExponent&#39;</span>];</div>
<div class="line"><span class="lineno"> 1929</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1930</span>        }</div>
<div class="line"><span class="lineno"> 1931</span> </div>
<div class="line"><span class="lineno"> 1932</span>        $this-&gt;publicExponent = <a class="code hl_variable" href="classCrypt__RSA.html#a2409c247baf67a1d4c6b9a1789cfc088">$components</a>[<span class="stringliteral">&#39;publicExponent&#39;</span>];</div>
<div class="line"><span class="lineno"> 1933</span> </div>
<div class="line"><span class="lineno"> 1934</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1935</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l01157">_parseKey()</a>, <a class="el" href="RSA_8php_source.html#l00260">CRYPT_RSA_PUBLIC_FORMAT_OPENSSH</a>, <a class="el" href="RSA_8php_source.html#l00249">CRYPT_RSA_PUBLIC_FORMAT_PKCS1</a>, <a class="el" href="RSA_8php_source.html#l00237">CRYPT_RSA_PUBLIC_FORMAT_RAW</a>, and <a class="el" href="RSA_8php_source.html#l00254">CRYPT_RSA_PUBLIC_FORMAT_XML</a>.</p>

<p class="reference">Referenced by <a class="el" href="RSA_8php_source.html#l01741">loadKey()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a5c291d208f8e9a8ea7e0e4b6335a61a9_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a5c291d208f8e9a8ea7e0e4b6335a61a9_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a5c291d208f8e9a8ea7e0e4b6335a61a9_cgraph" id="aclassCrypt__RSA_a5c291d208f8e9a8ea7e0e4b6335a61a9_cgraph">
<area shape="rect" title="Defines the public key." alt="" coords="5,56,111,81"/>
<area shape="rect" href="classCrypt__RSA.html#a269d4a2cf9ac198a73cfcb4bc3b8f9b5" title="Break a public or private key down into its constituant components." alt="" coords="159,56,248,81"/>
<area shape="rect" href="classCrypt__RSA.html#ae88f34bdbb000851150beff041dcb0fe" title="DER&#45;decode the length." alt="" coords="296,5,416,31"/>
<area shape="rect" href="classCrypt__RSA.html#ab009fa6f4ba09daa679a30e9b5bcfe35" title="String Shift." alt="" coords="464,31,565,56"/>
<area shape="rect" href="classCrypt__RSA.html#a009e0a2396931d62c87d27f4e2372024" title="Extract raw BER from Base64 encoding." alt="" coords="305,107,407,132"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a5c291d208f8e9a8ea7e0e4b6335a61a9_icgraph.png" border="0" usemap="#aclassCrypt__RSA_a5c291d208f8e9a8ea7e0e4b6335a61a9_icgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a5c291d208f8e9a8ea7e0e4b6335a61a9_icgraph" id="aclassCrypt__RSA_a5c291d208f8e9a8ea7e0e4b6335a61a9_icgraph">
<area shape="rect" title="Defines the public key." alt="" coords="288,5,393,31"/>
<area shape="rect" href="classCrypt__RSA.html#aecd4eb5e57d8881db518d98009bd75ee" title="Loads a public or private key." alt="" coords="165,5,240,31"/>
<area shape="rect" href="classCrypt__RSA.html#a871b11d67cc3a8f62e4c0306e64c7c1b" title="Defines the private key." alt="" coords="5,5,117,31"/>
</map>
</div>

</div>
</div>
<a id="ab9bb6561d72fe782783912c995b6b5f1" name="ab9bb6561d72fe782783912c995b6b5f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9bb6561d72fe782783912c995b6b5f1">&#9670;&#160;</a></span>setPublicKeyFormat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setPublicKeyFormat </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$format</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the public key format. </p>
<dl class="section see"><dt>See also</dt><dd>self::createKey() @access public </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$format</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02208">2208</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2209</span>    {</div>
<div class="line"><span class="lineno"> 2210</span>        $this-&gt;publicKeyFormat = $format;</div>
<div class="line"><span class="lineno"> 2211</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af16596bc0e249b6ce396a65317a74756" name="af16596bc0e249b6ce396a65317a74756"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af16596bc0e249b6ce396a65317a74756">&#9670;&#160;</a></span>setSaltLength()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setSaltLength </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$sLen</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the salt length. </p>
<p>To quote from <code><a class="el" href="">RFC3447#page-38</a></code>:</p>
<p>Typical salt lengths in octets are hLen (the length of the output of the hash function Hash) and 0.</p>
<p>@access public </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$sLen</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l02280">2280</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2281</span>    {</div>
<div class="line"><span class="lineno"> 2282</span>        $this-&gt;sLen = $sLen;</div>
<div class="line"><span class="lineno"> 2283</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e2e42e58327ce1242da88d13f0af9ac" name="a4e2e42e58327ce1242da88d13f0af9ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e2e42e58327ce1242da88d13f0af9ac">&#9670;&#160;</a></span>setSignatureMode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setSignatureMode </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set Signature Mode. </p>
<p>Valid values include CRYPT_RSA_SIGNATURE_PSS and CRYPT_RSA_SIGNATURE_PKCS1</p>
<p>@access public </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$mode</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l03163">3163</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3164</span>    {</div>
<div class="line"><span class="lineno"> 3165</span>        $this-&gt;signatureMode = $mode;</div>
<div class="line"><span class="lineno"> 3166</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="abe0890f90bae8c6cab81312df152652b" name="abe0890f90bae8c6cab81312df152652b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe0890f90bae8c6cab81312df152652b">&#9670;&#160;</a></span>sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sign </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$message</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a signature. </p>
<dl class="section see"><dt>See also</dt><dd>self::verify() @access public </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$message</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l03290">3290</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3291</span>    {</div>
<div class="line"><span class="lineno"> 3292</span>        <span class="keywordflow">if</span> (empty($this-&gt;modulus) || empty($this-&gt;exponent)) {</div>
<div class="line"><span class="lineno"> 3293</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3294</span>        }</div>
<div class="line"><span class="lineno"> 3295</span> </div>
<div class="line"><span class="lineno"> 3296</span>        <span class="keywordflow">switch</span> ($this-&gt;signatureMode) {</div>
<div class="line"><span class="lineno"> 3297</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#a8df70582b0c278da510047e13441d495">CRYPT_RSA_SIGNATURE_PKCS1</a>:</div>
<div class="line"><span class="lineno"> 3298</span>                <span class="keywordflow">return</span> $this-&gt;_rsassa_pkcs1_v1_5_sign($message);</div>
<div class="line"><span class="lineno"> 3299</span>            <span class="comment">//case CRYPT_RSA_SIGNATURE_PSS:</span></div>
<div class="line"><span class="lineno"> 3300</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3301</span>                <span class="keywordflow">return</span> $this-&gt;_rsassa_pss_sign($message);</div>
<div class="line"><span class="lineno"> 3302</span>        }</div>
<div class="line"><span class="lineno"> 3303</span>    }</div>
<div class="ttc" id="aRSA_8php_html_a8df70582b0c278da510047e13441d495"><div class="ttname"><a href="RSA_8php.html#a8df70582b0c278da510047e13441d495">CRYPT_RSA_SIGNATURE_PKCS1</a></div><div class="ttdeci">const CRYPT_RSA_SIGNATURE_PKCS1</div><div class="ttdoc">Use the PKCS#1 scheme by default.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00140">RSA.php:140</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l03072">_rsassa_pkcs1_v1_5_sign()</a>, <a class="el" href="RSA_8php_source.html#l02901">_rsassa_pss_sign()</a>, and <a class="el" href="RSA_8php_source.html#l00140">CRYPT_RSA_SIGNATURE_PKCS1</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_abe0890f90bae8c6cab81312df152652b_cgraph.png" border="0" usemap="#aclassCrypt__RSA_abe0890f90bae8c6cab81312df152652b_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_abe0890f90bae8c6cab81312df152652b_cgraph" id="aclassCrypt__RSA_abe0890f90bae8c6cab81312df152652b_cgraph">
<area shape="rect" title="Create a signature." alt="" coords="5,105,55,131"/>
<area shape="rect" href="classCrypt__RSA.html#a7919feaaf410567587520ae62d0f375a" title="RSASSA&#45;PKCS1&#45;V1_5&#45;SIGN." alt="" coords="103,80,291,105"/>
<area shape="rect" href="classCrypt__RSA.html#a41d7b44f4ff751df9dc5bc9a2e1a5875" title="RSASSA&#45;PSS&#45;SIGN." alt="" coords="129,129,264,155"/>
<area shape="rect" href="classCrypt__RSA.html#ac7c7477da0e0045974ee1a8d1795d73f" title="EMSA&#45;PKCS1&#45;V1_5&#45;ENCODE." alt="" coords="339,5,541,31"/>
<area shape="rect" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b" title="Integer&#45;to&#45;Octet&#45;String primitive." alt="" coords="408,55,472,80"/>
<area shape="rect" href="classCrypt__RSA.html#acfc45b22328d38a3e36ce78eb1fceab1" title="Octet&#45;String&#45;to&#45;Integer primitive." alt="" coords="408,104,472,129"/>
<area shape="rect" href="classCrypt__RSA.html#a812ed7b5c58b1d3281ca8263b0eb9c38" title="RSASP1." alt="" coords="404,153,476,179"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="589,153,704,179"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="752,153,813,179"/>
<area shape="rect" href="classCrypt__RSA.html#ab1766412b33feaf27a58c51171f4a8f0" title="EMSA&#45;PSS&#45;ENCODE." alt="" coords="366,203,514,228"/>
<area shape="rect" href="classCrypt__RSA.html#abfcfdb9ca9cc5a3eeceee10ebcf793e0" title="MGF1." alt="" coords="615,203,678,228"/>
</map>
</div>

</div>
</div>
<a id="a91b3194ffeb55cb91eb28202ea8fe666" name="a91b3194ffeb55cb91eb28202ea8fe666"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91b3194ffeb55cb91eb28202ea8fe666">&#9670;&#160;</a></span>verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">verify </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$signature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies a signature. </p>
<dl class="section see"><dt>See also</dt><dd>self::sign() @access public </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$message</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$signature</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l03314">3314</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3315</span>    {</div>
<div class="line"><span class="lineno"> 3316</span>        <span class="keywordflow">if</span> (empty($this-&gt;modulus) || empty($this-&gt;exponent)) {</div>
<div class="line"><span class="lineno"> 3317</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3318</span>        }</div>
<div class="line"><span class="lineno"> 3319</span> </div>
<div class="line"><span class="lineno"> 3320</span>        <span class="keywordflow">switch</span> ($this-&gt;signatureMode) {</div>
<div class="line"><span class="lineno"> 3321</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="RSA_8php.html#a8df70582b0c278da510047e13441d495">CRYPT_RSA_SIGNATURE_PKCS1</a>:</div>
<div class="line"><span class="lineno"> 3322</span>                <span class="keywordflow">return</span> $this-&gt;_rsassa_pkcs1_v1_5_verify($message, $signature);</div>
<div class="line"><span class="lineno"> 3323</span>            <span class="comment">//case CRYPT_RSA_SIGNATURE_PSS:</span></div>
<div class="line"><span class="lineno"> 3324</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3325</span>                <span class="keywordflow">return</span> $this-&gt;_rsassa_pss_verify($message, $signature);</div>
<div class="line"><span class="lineno"> 3326</span>        }</div>
<div class="line"><span class="lineno"> 3327</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l03103">_rsassa_pkcs1_v1_5_verify()</a>, <a class="el" href="RSA_8php_source.html#l02928">_rsassa_pss_verify()</a>, and <a class="el" href="RSA_8php_source.html#l00140">CRYPT_RSA_SIGNATURE_PKCS1</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__RSA_a91b3194ffeb55cb91eb28202ea8fe666_cgraph.png" border="0" usemap="#aclassCrypt__RSA_a91b3194ffeb55cb91eb28202ea8fe666_cgraph" alt=""/></div>
<map name="aclassCrypt__RSA_a91b3194ffeb55cb91eb28202ea8fe666_cgraph" id="aclassCrypt__RSA_a91b3194ffeb55cb91eb28202ea8fe666_cgraph">
<area shape="rect" title="Verifies a signature." alt="" coords="5,196,64,221"/>
<area shape="rect" href="classCrypt__RSA.html#a9bac0d7f59f81a08f34e937e71fa4264" title="RSASSA&#45;PKCS1&#45;V1_5&#45;VERIFY." alt="" coords="112,159,267,199"/>
<area shape="rect" href="classCrypt__RSA.html#a14d4abcd8f2ca6604b948026e0c553ba" title="RSASSA&#45;PSS&#45;VERIFY." alt="" coords="117,224,261,249"/>
<area shape="rect" href="classCrypt__RSA.html#ac7c7477da0e0045974ee1a8d1795d73f" title="EMSA&#45;PKCS1&#45;V1_5&#45;ENCODE." alt="" coords="315,5,517,31"/>
<area shape="rect" href="classCrypt__RSA.html#af65bce0b24a7aeeb274b776ba732aa15" title="EMSA&#45;PKCS1&#45;V1_5&#45;ENCODE (without NULL)" alt="" coords="315,55,517,95"/>
<area shape="rect" href="classCrypt__RSA.html#a1479196d348b439c4a2f1ec8c72f9dd3" title="Performs blinded RSA equality testing." alt="" coords="587,121,659,147"/>
<area shape="rect" href="classCrypt__RSA.html#a7dbb5187f86756281452e726a0c3d87b" title="Integer&#45;to&#45;Octet&#45;String primitive." alt="" coords="384,269,448,295"/>
<area shape="rect" href="classCrypt__RSA.html#acfc45b22328d38a3e36ce78eb1fceab1" title="Octet&#45;String&#45;to&#45;Integer primitive." alt="" coords="384,220,448,245"/>
<area shape="rect" href="classCrypt__RSA.html#a2fe05e8ee49b3d3064c09ff852c3bf34" title="RSAVP1." alt="" coords="379,171,453,196"/>
<area shape="rect" href="classCrypt__RSA.html#a46927f0a9e61928ad1fd683f250dbce9" title="Exponentiate with or without Chinese Remainder Theorem." alt="" coords="565,171,680,196"/>
<area shape="rect" href="classCrypt__RSA.html#a44ab71ffba98c8fe3172f8d2dc69e443" title="Performs RSA Blinding." alt="" coords="728,171,789,196"/>
<area shape="rect" href="classCrypt__RSA.html#a823206322297e3b89a2e04897cdc64c3" title="EMSA&#45;PSS&#45;VERIFY." alt="" coords="347,319,485,344"/>
<area shape="rect" href="classCrypt__RSA.html#abfcfdb9ca9cc5a3eeceee10ebcf793e0" title="MGF1." alt="" coords="591,319,654,344"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a id="a2484451bccf0a9d944d2cb27fa103678" name="a2484451bccf0a9d944d2cb27fa103678"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2484451bccf0a9d944d2cb27fa103678">&#9670;&#160;</a></span>$coefficients</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$coefficients</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00364">364</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="a536677acc0163c53c067316a97456e6c" name="a536677acc0163c53c067316a97456e6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a536677acc0163c53c067316a97456e6c">&#9670;&#160;</a></span>$comment</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$comment = 'phpseclib-generated-key'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00486">486</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="a2409c247baf67a1d4c6b9a1789cfc088" name="a2409c247baf67a1d4c6b9a1789cfc088"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2409c247baf67a1d4c6b9a1789cfc088">&#9670;&#160;</a></span>$components</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$components = array()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00456">456</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="a3e265c431ca42bf2f20753540bb64d00" name="a3e265c431ca42bf2f20753540bb64d00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e265c431ca42bf2f20753540bb64d00">&#9670;&#160;</a></span>$configFile</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$configFile</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00478">478</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="a2c4c58e377f6c66ca38c8ea97666fc5e" name="a2c4c58e377f6c66ca38c8ea97666fc5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c4c58e377f6c66ca38c8ea97666fc5e">&#9670;&#160;</a></span>$current</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$current</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00468">468</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="af27332d55518bfb56c1d594048350da3" name="af27332d55518bfb56c1d594048350da3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af27332d55518bfb56c1d594048350da3">&#9670;&#160;</a></span>$encryptionMode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$encryptionMode = <a class="el" href="RSA_8php.html#a7e1ceaf622bb14486567072ec1d800af">CRYPT_RSA_ENCRYPTION_OAEP</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00420">420</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="acbf61ed0170ad53e99e059308433a360" name="acbf61ed0170ad53e99e059308433a360"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbf61ed0170ad53e99e059308433a360">&#9670;&#160;</a></span>$exponent</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$exponent</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00340">340</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="a49441857b4bc8d5573cba6fea45f400d" name="a49441857b4bc8d5573cba6fea45f400d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49441857b4bc8d5573cba6fea45f400d">&#9670;&#160;</a></span>$exponents</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$exponents</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00356">356</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="ac9fdf6f2c8fb45c1d3bb9a176802b2ad" name="ac9fdf6f2c8fb45c1d3bb9a176802b2ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9fdf6f2c8fb45c1d3bb9a176802b2ad">&#9670;&#160;</a></span>$hash</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$hash</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00380">380</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="a6cfa85883d33ac59bd9d0c56caf73222" name="a6cfa85883d33ac59bd9d0c56caf73222"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cfa85883d33ac59bd9d0c56caf73222">&#9670;&#160;</a></span>$hashName</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$hashName</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00372">372</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="ae4aa655b2082413abc404eb92f3776e1" name="ae4aa655b2082413abc404eb92f3776e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4aa655b2082413abc404eb92f3776e1">&#9670;&#160;</a></span>$hLen</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$hLen</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00388">388</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="ad6726cfaa85d4b8299d2b0f034cbf178" name="ad6726cfaa85d4b8299d2b0f034cbf178"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6726cfaa85d4b8299d2b0f034cbf178">&#9670;&#160;</a></span>$k</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$k</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00332">332</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="ae76a5323d6eed343a9558b01d35ccf8f" name="ae76a5323d6eed343a9558b01d35ccf8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae76a5323d6eed343a9558b01d35ccf8f">&#9670;&#160;</a></span>$mgfHash</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$mgfHash</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00404">404</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="ab0047ea03c5a2f14b7f5fa05cdee07fc" name="ab0047ea03c5a2f14b7f5fa05cdee07fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0047ea03c5a2f14b7f5fa05cdee07fc">&#9670;&#160;</a></span>$mgfHLen</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$mgfHLen</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00412">412</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="a17709e191d11322c1bbca0b4c2533b6a" name="a17709e191d11322c1bbca0b4c2533b6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17709e191d11322c1bbca0b4c2533b6a">&#9670;&#160;</a></span>$modulus</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$modulus</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00324">324</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="a95601f0019d098a2b40f33f5939e799b" name="a95601f0019d098a2b40f33f5939e799b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95601f0019d098a2b40f33f5939e799b">&#9670;&#160;</a></span>$one</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$one</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00300">300</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="a607686ef9f99ea7c42f4f3dd3dbb2b0d" name="a607686ef9f99ea7c42f4f3dd3dbb2b0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a607686ef9f99ea7c42f4f3dd3dbb2b0d">&#9670;&#160;</a></span>$password</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$password = false</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00444">444</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="a3512d5a4383616be363bc390ae3e7ec7" name="a3512d5a4383616be363bc390ae3e7ec7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3512d5a4383616be363bc390ae3e7ec7">&#9670;&#160;</a></span>$primes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$primes</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00348">348</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="aa20f553bc527aabe01e71da515ff75d4" name="aa20f553bc527aabe01e71da515ff75d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa20f553bc527aabe01e71da515ff75d4">&#9670;&#160;</a></span>$privateKeyFormat</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$privateKeyFormat = <a class="el" href="RSA_8php.html#a72160567057c92a07f17877a8e6a1465">CRYPT_RSA_PRIVATE_FORMAT_PKCS1</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00308">308</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="a67c17fc0cf6463311de6c63b2cdf2d67" name="a67c17fc0cf6463311de6c63b2cdf2d67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67c17fc0cf6463311de6c63b2cdf2d67">&#9670;&#160;</a></span>$publicExponent</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$publicExponent = false</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00436">436</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="a0f6921fa02e68aa30aef8812c1b8ca48" name="a0f6921fa02e68aa30aef8812c1b8ca48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f6921fa02e68aa30aef8812c1b8ca48">&#9670;&#160;</a></span>$publicKeyFormat</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$publicKeyFormat = <a class="el" href="RSA_8php.html#a4741a3919471f37f2156fa615d24a49f">CRYPT_RSA_PUBLIC_FORMAT_PKCS8</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00316">316</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="a3b3599db49cf1495ca08f8d193efaf04" name="a3b3599db49cf1495ca08f8d193efaf04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b3599db49cf1495ca08f8d193efaf04">&#9670;&#160;</a></span>$signatureMode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$signatureMode = <a class="el" href="RSA_8php.html#a3a0a5d8321ce543e3f8e5031571a8c6f">CRYPT_RSA_SIGNATURE_PSS</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00428">428</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="a8efc7039497bc1c39c5817d77df2dca8" name="a8efc7039497bc1c39c5817d77df2dca8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8efc7039497bc1c39c5817d77df2dca8">&#9670;&#160;</a></span>$sLen</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$sLen</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00396">396</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<a id="a3df958928cd7d9367ad3562920c50715" name="a3df958928cd7d9367ad3562920c50715"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3df958928cd7d9367ad3562920c50715">&#9670;&#160;</a></span>$zero</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$zero</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RSA_8php_source.html#l00292">292</a> of file <a class="el" href="RSA_8php_source.html">RSA.php</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/View/lib/phpseclib/Crypt/<a class="el" href="RSA_8php_source.html">RSA.php</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classCrypt__RSA.html">Crypt_RSA</a></li>
    <li class="footer">Generated on Sun Apr 30 2023 00:52:48 for PF Firewall by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
