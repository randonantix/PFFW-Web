<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PF Firewall: src/lib/lib.php File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PF Firewall<span id="projectnumber">&#160;7.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('lib_2lib_8php.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">lib.php File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Project-wide common functions.  
<a href="#details">More...</a></p>

<p><a href="lib_2lib_8php_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa975e15cad11aca2e6c6e9c896f6c431"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2lib_8php.html#aa975e15cad11aca2e6c6e9c896f6c431">IsFilePath</a> ($filepath)</td></tr>
<tr class="memdesc:aa975e15cad11aca2e6c6e9c896f6c431"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validates the given file path.  <br /></td></tr>
<tr class="separator:aa975e15cad11aca2e6c6e9c896f6c431"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5de4c118627ef9fcaa8eeed364b7616f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2lib_8php.html#a5de4c118627ef9fcaa8eeed364b7616f">FlattenArray</a> (&amp;$array)</td></tr>
<tr class="memdesc:a5de4c118627ef9fcaa8eeed364b7616f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts an array to a simple value.  <br /></td></tr>
<tr class="separator:a5de4c118627ef9fcaa8eeed364b7616f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a998c26d78939d233b87794689e841eb9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9">Escape</a> ($str, $chars, $no_double_escapes=TRUE)</td></tr>
<tr class="memdesc:a998c26d78939d233b87794689e841eb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Escapes chars.  <br /></td></tr>
<tr class="separator:a998c26d78939d233b87794689e841eb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad33cadb8e288ea78e94fd94045f91e09"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2lib_8php.html#ad33cadb8e288ea78e94fd94045f91e09">AddValueCreateKey</a> (&amp;$data, $name, $value)</td></tr>
<tr class="separator:ad33cadb8e288ea78e94fd94045f91e09"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Project-wide common functions. </p>

<p class="definition">Definition in file <a class="el" href="lib_2lib_8php_source.html">lib.php</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad33cadb8e288ea78e94fd94045f91e09" name="ad33cadb8e288ea78e94fd94045f91e09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad33cadb8e288ea78e94fd94045f91e09">&#9670;&#160;</a></span>AddValueCreateKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AddValueCreateKey </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lib_2lib_8php_source.html#l00096">96</a> of file <a class="el" href="lib_2lib_8php_source.html">lib.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   97</span>{</div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordflow">if</span> (!isset($data[$name])) {</div>
<div class="line"><span class="lineno">   99</span>        $data[$name]= 0;</div>
<div class="line"><span class="lineno">  100</span>    }</div>
<div class="line"><span class="lineno">  101</span>    $data[$name]+= $value;</div>
<div class="line"><span class="lineno">  102</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="model_8php_source.html#l02274">Model\CollectMinuteStats()</a>, <a class="el" href="model_8php_source.html#l02214">Model\IncStats()</a>, <a class="el" href="libwui_8php_source.html#l00998">SumData()</a>, and <a class="el" href="model_8php_source.html#l01919">Model\UpdateStats()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lib_2lib_8php_ad33cadb8e288ea78e94fd94045f91e09_icgraph.png" border="0" usemap="#alib_2lib_8php_ad33cadb8e288ea78e94fd94045f91e09_icgraph" alt=""/></div>
<map name="alib_2lib_8php_ad33cadb8e288ea78e94fd94045f91e09_icgraph" id="alib_2lib_8php_ad33cadb8e288ea78e94fd94045f91e09_icgraph">
<area shape="rect" title=" " alt="" coords="1265,105,1416,131"/>
<area shape="rect" href="classModel.html#a3b4ab5022e1e5883d5292c024eaaf8c1" title="Minute statistics collector." alt="" coords="1028,80,1217,105"/>
<area shape="rect" href="classModel.html#a4b2587fd477dfc21d60f1185c624521c" title="Updates statistics incrementally, both brief and full." alt="" coords="392,55,539,80"/>
<area shape="rect" href="classModel.html#a10ffb35c34bab2bd539a5a945a489625" title="Increments stats for the given values." alt="" coords="1063,129,1182,155"/>
<area shape="rect" href="libwui_8php.html#aa174f78096158e6e3f4b410009feba95" title="Adds statistics values to the given data set." alt="" coords="1081,180,1164,205"/>
<area shape="rect" href="classModel.html#abe3e76f34ef7907cc5fcc6d2840bf081" title="Hour statistics collector." alt="" coords="805,80,980,105"/>
<area shape="rect" href="classModel.html#ac23e08bf49a305b2d76f11cecc62ba4c" title="Day statistics collector." alt="" coords="587,80,757,105"/>
<area shape="rect" href="classModel.html#a879807a0b92e50464699e78d3c216483" title=" " alt="" coords="205,29,331,55"/>
<area shape="rect" href="classModel.html#aacf995c8c1f12fe1a00b653fd790c3ef" title="Gets the log file under the tmp folder." alt="" coords="192,79,344,104"/>
<area shape="rect" href="classModel.html#a2f595c1fea08e09a47f744ff8fec6815" title="Gets both brief and full statistics." alt="" coords="5,5,144,31"/>
<area shape="rect" href="classModel.html#ac746ea8beac01d38d9d0289c6c08fe4a" title="Main statistics collector, as module data set." alt="" coords="13,55,136,80"/>
<area shape="rect" href="libwui_8php.html#a954268445f4f24fc41f8f0d51ef62c51" title="Sums up count fields of data arrays." alt="" coords="845,181,941,207"/>
<area shape="rect" href="libwui_8php.html#a1fa384aebb5cba44b1986f30e53bd12e" title="Sums up count fields of data arrays." alt="" coords="635,181,709,207"/>
<area shape="rect" href="libwui_8php.html#ac40a3675077406b7a3a674d7e7599218" title="Main function that prints both the graph and the NVPs below it." alt="" coords="396,181,535,207"/>
</map>
</div>

</div>
</div>
<a id="a998c26d78939d233b87794689e841eb9" name="a998c26d78939d233b87794689e841eb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a998c26d78939d233b87794689e841eb9">&#9670;&#160;</a></span>Escape()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Escape </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$chars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$no_double_escapes</em> = <code>TRUE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Escapes chars. </p>
<p>Prevents double escapes by default.</p>
<p>preg_quote() double escapes, thus is not suitable. It is not possible to make sure that strings contain no escapes, because this function is used over strings obtained from config files too, which we don't have any control over.</p>
<p>Example: $no_double_escapes as FALSE is used in the code to double escape the $ char.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$str</td><td>String to process. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$chars</td><td>Chars to escape. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$no_double_escapes</td><td>Whether to prevent double escapes. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string Escaped string. </dd></dl>
<p>First remove existing escapes</p>

<p class="definition">Definition at line <a class="el" href="lib_2lib_8php_source.html#l00080">80</a> of file <a class="el" href="lib_2lib_8php_source.html">lib.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   81</span>{</div>
<div class="line"><span class="lineno">   82</span>    <span class="keywordflow">if</span> ($chars !== <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno">   83</span>        $chars_array= str_split($chars);</div>
<div class="line"><span class="lineno">   84</span>        <span class="keywordflow">foreach</span> ($chars_array as $char) {</div>
<div class="line"><span class="lineno">   85</span>            $esc_char= preg_quote($char, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno">   86</span>            <span class="keywordflow">if</span> ($no_double_escapes) {</div>
<div class="line"><span class="lineno">   88</span>                $str= preg_replace(<span class="stringliteral">&quot;/\\\\$esc_char/&quot;</span>, $char, $str);</div>
<div class="line"><span class="lineno">   89</span>            }</div>
<div class="line"><span class="lineno">   90</span>            $str= preg_replace(<span class="stringliteral">&quot;/$esc_char/&quot;</span>, <span class="stringliteral">&quot;\\\\$char&quot;</span>, $str);</div>
<div class="line"><span class="lineno">   91</span>        }</div>
<div class="line"><span class="lineno">   92</span>    }</div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordflow">return</span> $str;</div>
<div class="line"><span class="lineno">   94</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Model_2dhcpd_8php_source.html#l00363">Dhcpd\_getLeases()</a>, <a class="el" href="Model_2system_8php_source.html#l01465">System\DaemonizedRotateLogFile()</a>, <a class="el" href="Model_2system_8php_source.html#l01348">System\DisableServiceRcLocal()</a>, <a class="el" href="Model_2system_8php_source.html#l01385">System\EnableServiceRcLocal()</a>, <a class="el" href="notify_8php_source.html#l00210">FilterKeywords()</a>, <a class="el" href="view_8php_source.html#l00601">View\getLogLineClass()</a>, <a class="el" href="model_8php_source.html#l03088">Model\GetNewsyslogConfig()</a>, <a class="el" href="Model_2system_8php_source.html#l01287">System\GetServiceStatRcLocal()</a>, <a class="el" href="model_8php_source.html#l03123">Model\SetNewsyslogConfig()</a>, and <a class="el" href="model_8php_source.html#l00878">Model\SetNVP()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lib_2lib_8php_a998c26d78939d233b87794689e841eb9_icgraph.png" border="0" usemap="#alib_2lib_8php_a998c26d78939d233b87794689e841eb9_icgraph" alt=""/></div>
<map name="alib_2lib_8php_a998c26d78939d233b87794689e841eb9_icgraph" id="alib_2lib_8php_a998c26d78939d233b87794689e841eb9_icgraph">
<area shape="rect" title="Escapes chars." alt="" coords="856,252,924,277"/>
<area shape="rect" href="classDhcpd.html#a41befaaa7e57ab544a686a23333a2086" title=" " alt="" coords="615,29,755,55"/>
<area shape="rect" href="classSystem.html#a8f54af1e94c8b939b1ebb436baacd58f" title="Rotate log file via newsyslog." alt="" coords="561,79,808,104"/>
<area shape="rect" href="classSystem.html#a8e8c70ccebed0fc6e5a96402f33b002a" title="Turn off (disable) service startup in rc.local." alt="" coords="573,128,796,153"/>
<area shape="rect" href="classSystem.html#a93af2ff9e1a06c35ad0870f6ff51cd3e" title="Turn on (enable) service startup in rc.local." alt="" coords="576,177,793,203"/>
<area shape="rect" href="notify_8php.html#a1533dd11a6f243ee103e120b2b174825" title=" " alt="" coords="625,227,744,252"/>
<area shape="rect" href="classView.html#a7380caec2969c7c943efab862b724b76" title="Determines log line color class." alt="" coords="603,276,767,301"/>
<area shape="rect" href="classModel.html#ac6ce9b164f907bfe360c2f5dee6d1ab1" title="Gets newsyslog configuration for log file." alt="" coords="584,325,785,351"/>
<area shape="rect" href="classSystem.html#a4931cd6cb25fa48e27d5f7520444b0c0" title="Gets service startup status in rc.local." alt="" coords="573,375,796,400"/>
<area shape="rect" href="classModel.html#a6bd903872ce2d86a25252a84248f2e3f" title="Sets newsyslog configuration for log file." alt="" coords="585,424,784,449"/>
<area shape="rect" href="classModel.html#abcd01c30cbd8fa9ac1c84340e5ed33de" title="Changes value of NVP." alt="" coords="627,1040,742,1065"/>
<area shape="rect" href="classDhcpd.html#adef32c4a0164bed3caf5f2efa262b818" title=" " alt="" coords="281,29,486,55"/>
<area shape="rect" href="classDhcpd.html#a6ef19a5a822ec5a4c5b7b33476aadcd3" title="Gets dhcpd leases." alt="" coords="316,79,451,104"/>
<area shape="rect" href="classDhcpd.html#a65ffe7950ba3a608bd8839a16ab88fe5" title=" " alt="" coords="21,5,189,31"/>
<area shape="rect" href="classDhcpd.html#a99c7d07369de88b18f42e1b15595c5a0" title=" " alt="" coords="5,55,205,80"/>
<area shape="rect" href="classSystem.html#aa1fde596bca2fbb737d9818321b55e91" title="Turn off (disable) service startup." alt="" coords="297,128,469,153"/>
<area shape="rect" href="classSystem.html#ad3a8a9f79ad33c163c269244d66b356a" title="Turn on (enable) service startup." alt="" coords="300,177,467,203"/>
<area shape="rect" href="classView.html#a014cbcd14acae8d018129f8030d441d9" title="Generic parser, highlighter, and printer for the log line." alt="" coords="314,276,453,301"/>
<area shape="rect" href="classSystem.html#a808c908777b00099fd26d81392a16cea" title="Gets service start stati." alt="" coords="274,349,493,375"/>
<area shape="rect" href="classSystem.html#a7c21107fcd868c9590f376c07f02afaf" title=" " alt="" coords="317,399,450,424"/>
<area shape="rect" href="classSystem.html#a91b60c705c31df895a96ff1480ce85db" title=" " alt="" coords="294,448,473,473"/>
<area shape="rect" href="classSystem.html#a6f28b1520f68197fc3089c87d3ee5a86" title=" " alt="" coords="318,497,449,523"/>
<area shape="rect" href="classSystem.html#a77b569ce1603eae5f71e4f90e9e5c3a0" title=" " alt="" coords="296,547,471,572"/>
<area shape="rect" href="classSystem.html#a84af1d367e28f412bc9a7e07464defc6" title=" " alt="" coords="253,596,513,621"/>
<area shape="rect" href="classSystem.html#a896e4c34afa76bb1359be66b348597f6" title=" " alt="" coords="256,645,511,671"/>
<area shape="rect" href="classModel.html#a4c5f8b05e5cbfffe696da52ce05f066a" title="Sets the value of NVP configuration." alt="" coords="307,695,460,720"/>
<area shape="rect" href="classModel.html#a859ad1e51288c4d72ed9eda0f6f5e43e" title="Sets default locale." alt="" coords="295,744,472,769"/>
<area shape="rect" href="classModel.html#a396fea6ec5c2ad29ebee26ea36723133" title="Enables or disables HTTPs." alt="" coords="302,793,465,819"/>
<area shape="rect" href="classModel.html#abbf4c282267beb7f8667d0882d82b983" title="Enables or disables help boxes." alt="" coords="312,843,455,868"/>
<area shape="rect" href="classPf.html#a8a838a5a93147d20d19f2f4c44a16b23" title="Sets interface names in pf.conf." alt="" coords="345,892,421,917"/>
<area shape="rect" href="classPf.html#ae936293c9b2b0d90849d2c17acc1e6e8" title="Sets int_net." alt="" coords="334,941,433,967"/>
<area shape="rect" href="classDnsmasq.html#aafd6db1bc365b4992ffdc2894821194f" title="Sets the interface that the DNS forwarder binds to listen for requests." alt="" coords="301,991,466,1016"/>
<area shape="rect" href="classModel.html#ace6809a36e1a52e1dde4c9d6d662ca4c" title="Sets global log level." alt="" coords="311,1040,456,1065"/>
<area shape="rect" href="classModel.html#ad3d333424199ea8d1475ffb779b5407c" title="Sets the max number of nested anchors allowed." alt="" coords="278,1089,489,1115"/>
<area shape="rect" href="classModel.html#a396a20de76a1a352c40b3eb64d21bce9" title="Sets max file size to process." alt="" coords="269,1139,498,1164"/>
<area shape="rect" href="classSystem.html#a59df788be29e03ef99af4f3a16fdb1a0" title=" " alt="" coords="322,1188,445,1213"/>
<area shape="rect" href="classSystem.html#af6fa08d72148c73798549ca54163b619" title=" " alt="" coords="308,1237,459,1263"/>
<area shape="rect" href="classSystem.html#ae08f689f2d21a3414d7f1f667a0d5350" title=" " alt="" coords="289,1287,478,1312"/>
<area shape="rect" href="classSystem.html#ac188e028fb53e14e566562ae2e805f09" title=" " alt="" coords="296,1336,471,1361"/>
<area shape="rect" href="classSystem.html#a43705d78ea353c6e76f34342df25ea58" title=" " alt="" coords="284,1385,483,1411"/>
<area shape="rect" href="classSystem.html#a3ad0b53500536d14f25a7d95f819a977" title=" " alt="" coords="298,1435,469,1460"/>
<area shape="rect" href="classModel.html#a2b4ff4a876f224dcd90e3d5cb3e288a4" title="Sets pfctl timeout." alt="" coords="298,1484,469,1509"/>
<area shape="rect" href="classModel.html#add75f616f424040c62005634d34c20b0" title="Sets default reload rate." alt="" coords="302,1533,465,1559"/>
<area shape="rect" href="classModel.html#a3070438f6bedf2aeeeb313d7c32e5e1e" title="Sets session timeout." alt="" coords="288,1583,479,1608"/>
<area shape="rect" href="classModel.html#a31cfb3981a2789a48b91e3b2ea325681" title="Sets status check interval." alt="" coords="274,1632,493,1657"/>
<area shape="rect" href="classSystem.html#ad6ebf17ff7b76e126f2c94d29bde51d4" title=" " alt="" coords="306,1681,461,1707"/>
<area shape="rect" href="classModel.html#a760367a76e1eae0a8e8e7bc6c9e0579e" title="Enables or disables SSH." alt="" coords="314,1731,453,1756"/>
<area shape="rect" href="classModel.html#a5cf12375d05dca29b3c81333ff1882a2" title="Gets service statuses." alt="" coords="16,1632,195,1657"/>
</map>
</div>

</div>
</div>
<a id="a5de4c118627ef9fcaa8eeed364b7616f" name="a5de4c118627ef9fcaa8eeed364b7616f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5de4c118627ef9fcaa8eeed364b7616f">&#9670;&#160;</a></span>FlattenArray()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FlattenArray </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$array</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts an array to a simple value. </p>
<dl class="section attention"><dt>Attention</dt><dd>Don't use 0 as key to fetch the last value; the last key index may not be 0.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$array</td><td>Array to flatten. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="lib_2lib_8php_source.html#l00057">57</a> of file <a class="el" href="lib_2lib_8php_source.html">lib.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   58</span>{</div>
<div class="line"><span class="lineno">   59</span>    <span class="keywordflow">if</span> (count($array) == 1) {</div>
<div class="line"><span class="lineno">   60</span>        $array= $array[key($array)];</div>
<div class="line"><span class="lineno">   61</span>    }</div>
<div class="line"><span class="lineno">   62</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="View_2pf_2lib_2Rule_8php_source.html#l00527">Rule\inputDelValue()</a>, and <a class="el" href="Model_2lib_2Rule_8php_source.html#l00558">Rule\parseItem()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lib_2lib_8php_a5de4c118627ef9fcaa8eeed364b7616f_icgraph.png" border="0" usemap="#alib_2lib_8php_a5de4c118627ef9fcaa8eeed364b7616f_icgraph" alt=""/></div>
<map name="alib_2lib_8php_a5de4c118627ef9fcaa8eeed364b7616f_icgraph" id="alib_2lib_8php_a5de4c118627ef9fcaa8eeed364b7616f_icgraph">
<area shape="rect" title="Converts an array to a simple value." alt="" coords="236,31,339,56"/>
<area shape="rect" href="classView_1_1Rule.html#a70a2870542805522113dea5b7c0b0aed" title="Deletes the given value from the given key." alt="" coords="5,5,188,31"/>
<area shape="rect" href="classModel_1_1Rule.html#a01df1ad0352a2d0c9c42b7e38ffc1a58" title="Gets the items in delimiters and increments the index once for each word." alt="" coords="14,55,179,80"/>
</map>
</div>

</div>
</div>
<a id="aa975e15cad11aca2e6c6e9c896f6c431" name="aa975e15cad11aca2e6c6e9c896f6c431"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa975e15cad11aca2e6c6e9c896f6c431">&#9670;&#160;</a></span>IsFilePath()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IsFilePath </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$filepath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validates the given file path. </p>
<p>If we are not testing the controller, we should expect regular file paths. For example, _Include or LoadAnchor type of rules accept regular paths, not test ones.</p>
<dl class="section attention"><dt>Attention</dt><dd>? should never appear in regex patterns, this is better than using / or | chars.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$filepath</td><td>File path to validate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool TRUE if valid. </dd></dl>

<p class="definition">Definition at line <a class="el" href="lib_2lib_8php_source.html#l00036">36</a> of file <a class="el" href="lib_2lib_8php_source.html">lib.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   37</span>{</div>
<div class="line"><span class="lineno">   38</span>    global <a class="code hl_variable" href="defs_8php.html#acc42d692f354c3efef04444757307319">$PF_CONFIG_PATH</a>, <a class="code hl_variable" href="defs_8php.html#ab6968827718a035ef457328f390dc45a">$TMP_PATH</a>, <a class="code hl_variable" href="defs_8php.html#a53d3328fcfb475b8665b4b3f95212dc4">$TEST_DIR_PATH</a>;</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>    <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">   41</span>        <span class="comment">// pf configuration files</span></div>
<div class="line"><span class="lineno">   42</span>        preg_match(<span class="stringliteral">&quot;?^($TEST_DIR_PATH|)$PF_CONFIG_PATH/\w[\w.\-_]*$?&quot;</span>, $filepath)</div>
<div class="line"><span class="lineno">   43</span>        || preg_match(<span class="stringliteral">&quot;?^($TEST_DIR_PATH|)/etc/\w[\w.\-_]*$?&quot;</span>, $filepath)</div>
<div class="line"><span class="lineno">   44</span>        <span class="comment">// Uploaded tmp files</span></div>
<div class="line"><span class="lineno">   45</span>        || preg_match(<span class="stringliteral">&quot;?^($TEST_DIR_PATH|)$TMP_PATH/\w[\w.\-_]*$?&quot;</span>, $filepath)</div>
<div class="line"><span class="lineno">   46</span>        <span class="comment">// Log files, statistics and uncompressed logs</span></div>
<div class="line"><span class="lineno">   47</span>        || preg_match(<span class="stringliteral">&#39;?^/var/log/\w[\w./\-_]*$?&#39;</span>, $filepath);</div>
<div class="line"><span class="lineno">   48</span>}</div>
<div class="ttc" id="adefs_8php_html_a53d3328fcfb475b8665b4b3f95212dc4"><div class="ttname"><a href="defs_8php.html#a53d3328fcfb475b8665b4b3f95212dc4">$TEST_DIR_PATH</a></div><div class="ttdeci">$TEST_DIR_PATH</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00438">defs.php:438</a></div></div>
<div class="ttc" id="adefs_8php_html_ab6968827718a035ef457328f390dc45a"><div class="ttname"><a href="defs_8php.html#ab6968827718a035ef457328f390dc45a">$TMP_PATH</a></div><div class="ttdeci">$TMP_PATH</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00436">defs.php:436</a></div></div>
<div class="ttc" id="adefs_8php_html_acc42d692f354c3efef04444757307319"><div class="ttname"><a href="defs_8php.html#acc42d692f354c3efef04444757307319">$PF_CONFIG_PATH</a></div><div class="ttdeci">$PF_CONFIG_PATH</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00435">defs.php:435</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="defs_8php_source.html#l00435">$PF_CONFIG_PATH</a>, <a class="el" href="defs_8php_source.html#l00438">$TEST_DIR_PATH</a>, and <a class="el" href="defs_8php_source.html#l00436">$TMP_PATH</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c85d3e3c5052e9ad9ce18c6863244a25.html">lib</a></li><li class="navelem"><a class="el" href="lib_2lib_8php.html">lib.php</a></li>
    <li class="footer">Generated on Sun Apr 30 2023 00:52:47 for PF Firewall by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
