<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PF Firewall: File_X509 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PF Firewall<span id="projectnumber">&#160;7.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classFile__X509.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle"><div class="title">File_X509 Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a095c5d389db211932136b53f25f39685"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a095c5d389db211932136b53f25f39685">__construct</a> ()</td></tr>
<tr class="memdesc:a095c5d389db211932136b53f25f39685"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default Constructor.  <br /></td></tr>
<tr class="separator:a095c5d389db211932136b53f25f39685"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b796f253d10daa33c4efe72256cb623"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a0b796f253d10daa33c4efe72256cb623">File_X509</a> ()</td></tr>
<tr class="memdesc:a0b796f253d10daa33c4efe72256cb623"><td class="mdescLeft">&#160;</td><td class="mdescRight">PHP4 compatible Default Constructor.  <br /></td></tr>
<tr class="separator:a0b796f253d10daa33c4efe72256cb623"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b1d3038d8f6448b8f7d25f324833376"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376">loadX509</a> ($cert, $mode=<a class="el" href="X509_8php.html#a9159740da3aaa292ada5509eed1f0a5c">FILE_X509_FORMAT_AUTO_DETECT</a>)</td></tr>
<tr class="memdesc:a6b1d3038d8f6448b8f7d25f324833376"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load X.509 certificate.  <br /></td></tr>
<tr class="separator:a6b1d3038d8f6448b8f7d25f324833376"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8e8019a921e4c0651e807c7c1644fcc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#af8e8019a921e4c0651e807c7c1644fcc">saveX509</a> ($cert, $format=<a class="el" href="X509_8php.html#a036042d3a607d01afacc62e969dae3b7">FILE_X509_FORMAT_PEM</a>)</td></tr>
<tr class="memdesc:af8e8019a921e4c0651e807c7c1644fcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save X.509 certificate.  <br /></td></tr>
<tr class="separator:af8e8019a921e4c0651e807c7c1644fcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c34c28604781bdc296e7ade6951a734"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a0c34c28604781bdc296e7ade6951a734">_mapInExtensions</a> (&amp;$root, $path, $asn1)</td></tr>
<tr class="memdesc:a0c34c28604781bdc296e7ade6951a734"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map extension values from octet string to extension-specific internal format.  <br /></td></tr>
<tr class="separator:a0c34c28604781bdc296e7ade6951a734"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc612875837ae70595137c6166f90106"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#afc612875837ae70595137c6166f90106">_mapOutExtensions</a> (&amp;$root, $path, $asn1)</td></tr>
<tr class="memdesc:afc612875837ae70595137c6166f90106"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map extension values from extension-specific internal format to octet string.  <br /></td></tr>
<tr class="separator:afc612875837ae70595137c6166f90106"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acab7579764a0d5973b94cd8bf1c64092"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#acab7579764a0d5973b94cd8bf1c64092">_mapInAttributes</a> (&amp;$root, $path, $asn1)</td></tr>
<tr class="memdesc:acab7579764a0d5973b94cd8bf1c64092"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map attribute values from ANY type to attribute-specific internal format.  <br /></td></tr>
<tr class="separator:acab7579764a0d5973b94cd8bf1c64092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb6786d74bfd53b1a57ea5f72de69ab5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#acb6786d74bfd53b1a57ea5f72de69ab5">_mapOutAttributes</a> (&amp;$root, $path, $asn1)</td></tr>
<tr class="memdesc:acb6786d74bfd53b1a57ea5f72de69ab5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map attribute values from attribute-specific internal format to ANY type.  <br /></td></tr>
<tr class="separator:acb6786d74bfd53b1a57ea5f72de69ab5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a016c0c81b4115631a081d91036c8839f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a016c0c81b4115631a081d91036c8839f">_mapInDNs</a> (&amp;$root, $path, $asn1)</td></tr>
<tr class="memdesc:a016c0c81b4115631a081d91036c8839f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map DN values from ANY type to DN-specific internal format.  <br /></td></tr>
<tr class="separator:a016c0c81b4115631a081d91036c8839f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add37e36fc7605e4b4d1d6f1dc061983c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c">_mapOutDNs</a> (&amp;$root, $path, $asn1)</td></tr>
<tr class="memdesc:add37e36fc7605e4b4d1d6f1dc061983c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map DN values from DN-specific internal format to ANY type.  <br /></td></tr>
<tr class="separator:add37e36fc7605e4b4d1d6f1dc061983c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab691691d441dc6983a12a28ab3e0db1f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f">_getMapping</a> ($extnId)</td></tr>
<tr class="memdesc:ab691691d441dc6983a12a28ab3e0db1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Associate an extension ID to an extension mapping.  <br /></td></tr>
<tr class="separator:ab691691d441dc6983a12a28ab3e0db1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89783012156bb16439adcba84bca93d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a89783012156bb16439adcba84bca93d8">loadCA</a> ($cert)</td></tr>
<tr class="memdesc:a89783012156bb16439adcba84bca93d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load an X.509 certificate as a certificate authority.  <br /></td></tr>
<tr class="separator:a89783012156bb16439adcba84bca93d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afad375b8ebfbf0ed26dc7f1bb74e9ad3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#afad375b8ebfbf0ed26dc7f1bb74e9ad3">validateURL</a> ($url)</td></tr>
<tr class="memdesc:afad375b8ebfbf0ed26dc7f1bb74e9ad3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate an X.509 certificate against a URL.  <br /></td></tr>
<tr class="separator:afad375b8ebfbf0ed26dc7f1bb74e9ad3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22e26094b927b4a84167ccc395d92571"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a22e26094b927b4a84167ccc395d92571">validateDate</a> ($date=null)</td></tr>
<tr class="memdesc:a22e26094b927b4a84167ccc395d92571"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate a date.  <br /></td></tr>
<tr class="separator:a22e26094b927b4a84167ccc395d92571"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84e2629a56c47e5e90ab3a2a0aaf1bda"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a84e2629a56c47e5e90ab3a2a0aaf1bda">_fetchURL</a> ($url)</td></tr>
<tr class="memdesc:a84e2629a56c47e5e90ab3a2a0aaf1bda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fetches a URL.  <br /></td></tr>
<tr class="separator:a84e2629a56c47e5e90ab3a2a0aaf1bda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc2e876f81f33f786d44175e43f96727"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#acc2e876f81f33f786d44175e43f96727">_testForIntermediate</a> ($caonly, $count)</td></tr>
<tr class="memdesc:acc2e876f81f33f786d44175e43f96727"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validates an intermediate cert as identified via authority info access extension.  <br /></td></tr>
<tr class="separator:acc2e876f81f33f786d44175e43f96727"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63e18ebfa877fefabf86d16e0e2ceeaa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa">validateSignature</a> ($caonly=true)</td></tr>
<tr class="memdesc:a63e18ebfa877fefabf86d16e0e2ceeaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate a signature.  <br /></td></tr>
<tr class="separator:a63e18ebfa877fefabf86d16e0e2ceeaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96ee8b07aceb37a5d949447f7349bf12"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a96ee8b07aceb37a5d949447f7349bf12">_validateSignatureCountable</a> ($caonly, $count)</td></tr>
<tr class="memdesc:a96ee8b07aceb37a5d949447f7349bf12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate a signature.  <br /></td></tr>
<tr class="separator:a96ee8b07aceb37a5d949447f7349bf12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab87ce13c549a27cee379b3634e7c02f1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ab87ce13c549a27cee379b3634e7c02f1">_validateSignature</a> ($publicKeyAlgorithm, $publicKey, $signatureAlgorithm, $signature, $signatureSubject)</td></tr>
<tr class="memdesc:ab87ce13c549a27cee379b3634e7c02f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validates a signature.  <br /></td></tr>
<tr class="separator:ab87ce13c549a27cee379b3634e7c02f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3618fd30b8ecd74fba181990eafbf593"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a3618fd30b8ecd74fba181990eafbf593">setRecurLimit</a> ($count)</td></tr>
<tr class="memdesc:a3618fd30b8ecd74fba181990eafbf593"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the recursion limit.  <br /></td></tr>
<tr class="separator:a3618fd30b8ecd74fba181990eafbf593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c7cbfe13e8f69d47e8f7c5642eca301"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a2c7cbfe13e8f69d47e8f7c5642eca301">disableURLFetch</a> ()</td></tr>
<tr class="memdesc:a2c7cbfe13e8f69d47e8f7c5642eca301"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prevents URIs from being automatically retrieved.  <br /></td></tr>
<tr class="separator:a2c7cbfe13e8f69d47e8f7c5642eca301"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23f9c4d9ce04bfcd790bec9d8dae86ed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a23f9c4d9ce04bfcd790bec9d8dae86ed">enableURLFetch</a> ()</td></tr>
<tr class="memdesc:a23f9c4d9ce04bfcd790bec9d8dae86ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allows URIs to be automatically retrieved.  <br /></td></tr>
<tr class="separator:a23f9c4d9ce04bfcd790bec9d8dae86ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a195dac5d2b72ef86fe28250ea43343b8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a195dac5d2b72ef86fe28250ea43343b8">_reformatKey</a> ($algorithm, $key)</td></tr>
<tr class="memdesc:a195dac5d2b72ef86fe28250ea43343b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reformat public keys.  <br /></td></tr>
<tr class="separator:a195dac5d2b72ef86fe28250ea43343b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9faa954720f1e07428b6fdbb6224b715"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a9faa954720f1e07428b6fdbb6224b715">_decodeIP</a> ($ip)</td></tr>
<tr class="memdesc:a9faa954720f1e07428b6fdbb6224b715"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decodes an IP address.  <br /></td></tr>
<tr class="separator:a9faa954720f1e07428b6fdbb6224b715"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dc40504ca91b6ec6dc2e674cc4bd867"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a2dc40504ca91b6ec6dc2e674cc4bd867">_decodeNameConstraintIP</a> ($ip)</td></tr>
<tr class="memdesc:a2dc40504ca91b6ec6dc2e674cc4bd867"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decodes an IP address in a name constraints extension.  <br /></td></tr>
<tr class="separator:a2dc40504ca91b6ec6dc2e674cc4bd867"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae20088641fbf9d929ca9239ad6fb9738"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ae20088641fbf9d929ca9239ad6fb9738">_encodeIP</a> ($ip)</td></tr>
<tr class="memdesc:ae20088641fbf9d929ca9239ad6fb9738"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encodes an IP address.  <br /></td></tr>
<tr class="separator:ae20088641fbf9d929ca9239ad6fb9738"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4e0267f8e236f9707325bce89ce2b0a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ad4e0267f8e236f9707325bce89ce2b0a">_translateDNProp</a> ($propName)</td></tr>
<tr class="memdesc:ad4e0267f8e236f9707325bce89ce2b0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">"Normalizes" a Distinguished Name property  <br /></td></tr>
<tr class="separator:ad4e0267f8e236f9707325bce89ce2b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d9811e02579bdb0c26bb527232e79b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a6d9811e02579bdb0c26bb527232e79b0">setDNProp</a> ($propName, $propValue, $type='utf8String')</td></tr>
<tr class="memdesc:a6d9811e02579bdb0c26bb527232e79b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a Distinguished Name property.  <br /></td></tr>
<tr class="separator:a6d9811e02579bdb0c26bb527232e79b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65782113764c16cb36982e9b29b24fbd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a65782113764c16cb36982e9b29b24fbd">removeDNProp</a> ($propName)</td></tr>
<tr class="memdesc:a65782113764c16cb36982e9b29b24fbd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove Distinguished Name properties.  <br /></td></tr>
<tr class="separator:a65782113764c16cb36982e9b29b24fbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5e331e0ded7b3d7a76452ba6ff70194"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aa5e331e0ded7b3d7a76452ba6ff70194">getDNProp</a> ($propName, $dn=null, $withType=false)</td></tr>
<tr class="memdesc:aa5e331e0ded7b3d7a76452ba6ff70194"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Distinguished Name properties.  <br /></td></tr>
<tr class="separator:aa5e331e0ded7b3d7a76452ba6ff70194"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab442ee31015d58a277f52d5293a00106"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ab442ee31015d58a277f52d5293a00106">setDN</a> ($dn, $merge=false, $type='utf8String')</td></tr>
<tr class="memdesc:ab442ee31015d58a277f52d5293a00106"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a Distinguished Name.  <br /></td></tr>
<tr class="separator:ab442ee31015d58a277f52d5293a00106"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97392a261d56bd64002da7d1e76e8195"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a97392a261d56bd64002da7d1e76e8195">getDN</a> ($format=<a class="el" href="X509_8php.html#a03ccdbecf418c2c8f31dff69c7192b6e">FILE_X509_DN_ARRAY</a>, $dn=null)</td></tr>
<tr class="memdesc:a97392a261d56bd64002da7d1e76e8195"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the Distinguished Name for a certificates subject.  <br /></td></tr>
<tr class="separator:a97392a261d56bd64002da7d1e76e8195"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d9888293c71b3fe2d087776ca31c0eb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a1d9888293c71b3fe2d087776ca31c0eb">getIssuerDN</a> ($format=<a class="el" href="X509_8php.html#a03ccdbecf418c2c8f31dff69c7192b6e">FILE_X509_DN_ARRAY</a>)</td></tr>
<tr class="memdesc:a1d9888293c71b3fe2d087776ca31c0eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the Distinguished Name for a certificate/crl issuer.  <br /></td></tr>
<tr class="separator:a1d9888293c71b3fe2d087776ca31c0eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5fb776b269eef60c472521c6b4dc219"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ae5fb776b269eef60c472521c6b4dc219">getSubjectDN</a> ($format=<a class="el" href="X509_8php.html#a03ccdbecf418c2c8f31dff69c7192b6e">FILE_X509_DN_ARRAY</a>)</td></tr>
<tr class="memdesc:ae5fb776b269eef60c472521c6b4dc219"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the Distinguished Name for a certificate/csr subject Alias of getDN()  <br /></td></tr>
<tr class="separator:ae5fb776b269eef60c472521c6b4dc219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0f40f609ab964e6a8ddf2439fe98e5d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ad0f40f609ab964e6a8ddf2439fe98e5d">getIssuerDNProp</a> ($propName, $withType=false)</td></tr>
<tr class="memdesc:ad0f40f609ab964e6a8ddf2439fe98e5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get an individual Distinguished Name property for a certificate/crl issuer.  <br /></td></tr>
<tr class="separator:ad0f40f609ab964e6a8ddf2439fe98e5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ef1db256262071ba886eb5335084ecf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a7ef1db256262071ba886eb5335084ecf">getSubjectDNProp</a> ($propName, $withType=false)</td></tr>
<tr class="memdesc:a7ef1db256262071ba886eb5335084ecf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get an individual Distinguished Name property for a certificate/csr subject.  <br /></td></tr>
<tr class="separator:a7ef1db256262071ba886eb5335084ecf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72aefa3de97ff30a83063abc3b8ce568"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a72aefa3de97ff30a83063abc3b8ce568">getChain</a> ()</td></tr>
<tr class="memdesc:a72aefa3de97ff30a83063abc3b8ce568"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the certificate chain for the current cert.  <br /></td></tr>
<tr class="separator:a72aefa3de97ff30a83063abc3b8ce568"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaef39adc2ced44086c735a1591449397"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aaef39adc2ced44086c735a1591449397">setPublicKey</a> ($key)</td></tr>
<tr class="memdesc:aaef39adc2ced44086c735a1591449397"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set public key.  <br /></td></tr>
<tr class="separator:aaef39adc2ced44086c735a1591449397"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4be1e2a17c9561456b1cf97f4b757578"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a4be1e2a17c9561456b1cf97f4b757578">setPrivateKey</a> ($key)</td></tr>
<tr class="memdesc:a4be1e2a17c9561456b1cf97f4b757578"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set private key.  <br /></td></tr>
<tr class="separator:a4be1e2a17c9561456b1cf97f4b757578"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76217009a68266241eea571101a61d8a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a76217009a68266241eea571101a61d8a">setChallenge</a> ($challenge)</td></tr>
<tr class="memdesc:a76217009a68266241eea571101a61d8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set challenge.  <br /></td></tr>
<tr class="separator:a76217009a68266241eea571101a61d8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc841edb470c7b8c50e78daaf634228a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#afc841edb470c7b8c50e78daaf634228a">getPublicKey</a> ()</td></tr>
<tr class="memdesc:afc841edb470c7b8c50e78daaf634228a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the public key.  <br /></td></tr>
<tr class="separator:afc841edb470c7b8c50e78daaf634228a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa71d96486f43146d0ff5fa6e46167853"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aa71d96486f43146d0ff5fa6e46167853">loadCSR</a> ($csr, $mode=<a class="el" href="X509_8php.html#a9159740da3aaa292ada5509eed1f0a5c">FILE_X509_FORMAT_AUTO_DETECT</a>)</td></tr>
<tr class="memdesc:aa71d96486f43146d0ff5fa6e46167853"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a Certificate Signing Request.  <br /></td></tr>
<tr class="separator:aa71d96486f43146d0ff5fa6e46167853"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c1ab61eb1f01e39614b1fb1a99bd202"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a9c1ab61eb1f01e39614b1fb1a99bd202">saveCSR</a> ($csr, $format=<a class="el" href="X509_8php.html#a036042d3a607d01afacc62e969dae3b7">FILE_X509_FORMAT_PEM</a>)</td></tr>
<tr class="memdesc:a9c1ab61eb1f01e39614b1fb1a99bd202"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save CSR request.  <br /></td></tr>
<tr class="separator:a9c1ab61eb1f01e39614b1fb1a99bd202"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae796e46a18066a3b745a279fad143dbb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ae796e46a18066a3b745a279fad143dbb">loadSPKAC</a> ($spkac)</td></tr>
<tr class="memdesc:ae796e46a18066a3b745a279fad143dbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a SPKAC CSR.  <br /></td></tr>
<tr class="separator:ae796e46a18066a3b745a279fad143dbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6079ff51d79eadb1bb21c2342f9d0d0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ac6079ff51d79eadb1bb21c2342f9d0d0">saveSPKAC</a> ($spkac, $format=<a class="el" href="X509_8php.html#a036042d3a607d01afacc62e969dae3b7">FILE_X509_FORMAT_PEM</a>)</td></tr>
<tr class="memdesc:ac6079ff51d79eadb1bb21c2342f9d0d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save a SPKAC CSR request.  <br /></td></tr>
<tr class="separator:ac6079ff51d79eadb1bb21c2342f9d0d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0379465670a36ea3a1d2e9a34ea21405"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a0379465670a36ea3a1d2e9a34ea21405">loadCRL</a> ($crl, $mode=<a class="el" href="X509_8php.html#a9159740da3aaa292ada5509eed1f0a5c">FILE_X509_FORMAT_AUTO_DETECT</a>)</td></tr>
<tr class="memdesc:a0379465670a36ea3a1d2e9a34ea21405"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a Certificate Revocation List.  <br /></td></tr>
<tr class="separator:a0379465670a36ea3a1d2e9a34ea21405"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ea29c41d328dc397c2f1de19a178696"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a9ea29c41d328dc397c2f1de19a178696">saveCRL</a> ($crl, $format=<a class="el" href="X509_8php.html#a036042d3a607d01afacc62e969dae3b7">FILE_X509_FORMAT_PEM</a>)</td></tr>
<tr class="memdesc:a9ea29c41d328dc397c2f1de19a178696"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save Certificate Revocation List.  <br /></td></tr>
<tr class="separator:a9ea29c41d328dc397c2f1de19a178696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aecc48efc4e9677b47bd540fc26a089"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089">_timeField</a> ($date)</td></tr>
<tr class="memdesc:a8aecc48efc4e9677b47bd540fc26a089"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to build a time field according to RFC 3280 section.  <br /></td></tr>
<tr class="separator:a8aecc48efc4e9677b47bd540fc26a089"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86265f41fc9ab04b810aa1a14a613477"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477">sign</a> ($issuer, $subject, $signatureAlgorithm='sha1WithRSAEncryption')</td></tr>
<tr class="memdesc:a86265f41fc9ab04b810aa1a14a613477"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sign an X.509 certificate.  <br /></td></tr>
<tr class="separator:a86265f41fc9ab04b810aa1a14a613477"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3826badcacf04dae2371185f6feddde"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde">signCSR</a> ($signatureAlgorithm='sha1WithRSAEncryption')</td></tr>
<tr class="memdesc:ac3826badcacf04dae2371185f6feddde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sign a CSR.  <br /></td></tr>
<tr class="separator:ac3826badcacf04dae2371185f6feddde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7579e46dcabbf3bff17d8e31f1b2cb25"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a7579e46dcabbf3bff17d8e31f1b2cb25">signSPKAC</a> ($signatureAlgorithm='sha1WithRSAEncryption')</td></tr>
<tr class="memdesc:a7579e46dcabbf3bff17d8e31f1b2cb25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sign a SPKAC.  <br /></td></tr>
<tr class="separator:a7579e46dcabbf3bff17d8e31f1b2cb25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b25616309652968bc8a61f44415c14d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d">signCRL</a> ($issuer, $crl, $signatureAlgorithm='sha1WithRSAEncryption')</td></tr>
<tr class="memdesc:a2b25616309652968bc8a61f44415c14d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sign a CRL.  <br /></td></tr>
<tr class="separator:a2b25616309652968bc8a61f44415c14d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26cf1092c86fba52e8cc1bc078ab0b60"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a26cf1092c86fba52e8cc1bc078ab0b60">_sign</a> ($key, $signatureAlgorithm)</td></tr>
<tr class="memdesc:a26cf1092c86fba52e8cc1bc078ab0b60"><td class="mdescLeft">&#160;</td><td class="mdescRight">X.509 certificate signing helper function.  <br /></td></tr>
<tr class="separator:a26cf1092c86fba52e8cc1bc078ab0b60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16ffe0459baa9ea1ddb9e1e8491a10a6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a16ffe0459baa9ea1ddb9e1e8491a10a6">setStartDate</a> ($date)</td></tr>
<tr class="memdesc:a16ffe0459baa9ea1ddb9e1e8491a10a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set certificate start date.  <br /></td></tr>
<tr class="separator:a16ffe0459baa9ea1ddb9e1e8491a10a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74ed2723b9e17798ebd125edcd14cabe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a74ed2723b9e17798ebd125edcd14cabe">setEndDate</a> ($date)</td></tr>
<tr class="memdesc:a74ed2723b9e17798ebd125edcd14cabe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set certificate end date.  <br /></td></tr>
<tr class="separator:a74ed2723b9e17798ebd125edcd14cabe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a023813c1e45a58d395510f3f4364c63a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a023813c1e45a58d395510f3f4364c63a">setSerialNumber</a> ($serial, $base=-256)</td></tr>
<tr class="memdesc:a023813c1e45a58d395510f3f4364c63a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set Serial Number.  <br /></td></tr>
<tr class="separator:a023813c1e45a58d395510f3f4364c63a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa42928e53345a0bc23e9c6288e9f38a7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aa42928e53345a0bc23e9c6288e9f38a7">makeCA</a> ()</td></tr>
<tr class="memdesc:aa42928e53345a0bc23e9c6288e9f38a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turns the certificate into a certificate authority.  <br /></td></tr>
<tr class="separator:aa42928e53345a0bc23e9c6288e9f38a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60bc52a972cab9df3fc002a25de16dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ad60bc52a972cab9df3fc002a25de16dc">_isSubArrayValid</a> ($root, $path)</td></tr>
<tr class="memdesc:ad60bc52a972cab9df3fc002a25de16dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for validity of subarray.  <br /></td></tr>
<tr class="separator:ad60bc52a972cab9df3fc002a25de16dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50d402cfb4c93492899c7a222ddb6803"><td class="memItemLeft" align="right" valign="top">&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a50d402cfb4c93492899c7a222ddb6803">_subArrayUnchecked</a> (&amp;$root, $path, $create=false)</td></tr>
<tr class="memdesc:a50d402cfb4c93492899c7a222ddb6803"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a reference to a subarray.  <br /></td></tr>
<tr class="separator:a50d402cfb4c93492899c7a222ddb6803"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa200f8fe0af46a9daef5d95bfe2ce471"><td class="memItemLeft" align="right" valign="top">&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471">_subArray</a> (&amp;$root, $path, $create=false)</td></tr>
<tr class="memdesc:aa200f8fe0af46a9daef5d95bfe2ce471"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a reference to a subarray.  <br /></td></tr>
<tr class="separator:aa200f8fe0af46a9daef5d95bfe2ce471"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8524c1f84d3dc74f7dd247fd12a122e6"><td class="memItemLeft" align="right" valign="top">&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6">_extensions</a> (&amp;$root, $path=null, $create=false)</td></tr>
<tr class="memdesc:a8524c1f84d3dc74f7dd247fd12a122e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a reference to an extension subarray.  <br /></td></tr>
<tr class="separator:a8524c1f84d3dc74f7dd247fd12a122e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac16dd74cbc682e06b2f35875d04582d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ac16dd74cbc682e06b2f35875d04582d1">_removeExtension</a> ($id, $path=null)</td></tr>
<tr class="memdesc:ac16dd74cbc682e06b2f35875d04582d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove an Extension.  <br /></td></tr>
<tr class="separator:ac16dd74cbc682e06b2f35875d04582d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51d0ffadbcbf965b23238b89fef03484"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a51d0ffadbcbf965b23238b89fef03484">_getExtension</a> ($id, $cert=null, $path=null)</td></tr>
<tr class="memdesc:a51d0ffadbcbf965b23238b89fef03484"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get an Extension.  <br /></td></tr>
<tr class="separator:a51d0ffadbcbf965b23238b89fef03484"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dfd9393f164e45947bac81e5bc97d7f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a7dfd9393f164e45947bac81e5bc97d7f">_getExtensions</a> ($cert=null, $path=null)</td></tr>
<tr class="memdesc:a7dfd9393f164e45947bac81e5bc97d7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a list of all extensions in use.  <br /></td></tr>
<tr class="separator:a7dfd9393f164e45947bac81e5bc97d7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28a18c05603a638bcb114897dffeee6d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a28a18c05603a638bcb114897dffeee6d">_setExtension</a> ($id, $value, $critical=false, $replace=true, $path=null)</td></tr>
<tr class="memdesc:a28a18c05603a638bcb114897dffeee6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set an Extension.  <br /></td></tr>
<tr class="separator:a28a18c05603a638bcb114897dffeee6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa75a9d891292eeddcbf00060e36c0695"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aa75a9d891292eeddcbf00060e36c0695">removeExtension</a> ($id)</td></tr>
<tr class="memdesc:aa75a9d891292eeddcbf00060e36c0695"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a certificate, CSR or CRL Extension.  <br /></td></tr>
<tr class="separator:aa75a9d891292eeddcbf00060e36c0695"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc1207c2b7e8e70f61598815ee07fcdb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">getExtension</a> ($id, $cert=null)</td></tr>
<tr class="memdesc:afc1207c2b7e8e70f61598815ee07fcdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a certificate, CSR or CRL Extension.  <br /></td></tr>
<tr class="separator:afc1207c2b7e8e70f61598815ee07fcdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67b2aa40ccd2623250367494b69280c4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a67b2aa40ccd2623250367494b69280c4">getExtensions</a> ($cert=null)</td></tr>
<tr class="memdesc:a67b2aa40ccd2623250367494b69280c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a list of all extensions in use in certificate, CSR or CRL.  <br /></td></tr>
<tr class="separator:a67b2aa40ccd2623250367494b69280c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec94c39b26c9f4af4efe2ebf74cd914f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f">setExtension</a> ($id, $value, $critical=false, $replace=true)</td></tr>
<tr class="memdesc:aec94c39b26c9f4af4efe2ebf74cd914f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a certificate, CSR or CRL Extension.  <br /></td></tr>
<tr class="separator:aec94c39b26c9f4af4efe2ebf74cd914f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd0554eb35727bf8349119bc5a239059"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#acd0554eb35727bf8349119bc5a239059">removeAttribute</a> ($id, $disposition=<a class="el" href="X509_8php.html#a00c13d4a694558e4a9b24ed9e5462a8e">FILE_X509_ATTR_ALL</a>)</td></tr>
<tr class="memdesc:acd0554eb35727bf8349119bc5a239059"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a CSR attribute.  <br /></td></tr>
<tr class="separator:acd0554eb35727bf8349119bc5a239059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa161754e2510ae51e94934eaf50ebb9d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aa161754e2510ae51e94934eaf50ebb9d">getAttribute</a> ($id, $disposition=<a class="el" href="X509_8php.html#a00c13d4a694558e4a9b24ed9e5462a8e">FILE_X509_ATTR_ALL</a>, $csr=null)</td></tr>
<tr class="memdesc:aa161754e2510ae51e94934eaf50ebb9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a CSR attribute.  <br /></td></tr>
<tr class="separator:aa161754e2510ae51e94934eaf50ebb9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a359f6dfafc17a1d4c9386f5539056825"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a359f6dfafc17a1d4c9386f5539056825">getAttributes</a> ($csr=null)</td></tr>
<tr class="memdesc:a359f6dfafc17a1d4c9386f5539056825"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a list of all CSR attributes in use.  <br /></td></tr>
<tr class="separator:a359f6dfafc17a1d4c9386f5539056825"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c4215dc2b69bac52080d9f174dbfcd6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a4c4215dc2b69bac52080d9f174dbfcd6">setAttribute</a> ($id, $value, $disposition=<a class="el" href="X509_8php.html#a00c13d4a694558e4a9b24ed9e5462a8e">FILE_X509_ATTR_ALL</a>)</td></tr>
<tr class="memdesc:a4c4215dc2b69bac52080d9f174dbfcd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a CSR attribute.  <br /></td></tr>
<tr class="separator:a4c4215dc2b69bac52080d9f174dbfcd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac63bb2f2c855dd8f07d45bc07c864ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aac63bb2f2c855dd8f07d45bc07c864ba">setKeyIdentifier</a> ($value)</td></tr>
<tr class="memdesc:aac63bb2f2c855dd8f07d45bc07c864ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the subject key identifier.  <br /></td></tr>
<tr class="separator:aac63bb2f2c855dd8f07d45bc07c864ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4e1b70f7a5845e4777064b242a35d56"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ae4e1b70f7a5845e4777064b242a35d56">computeKeyIdentifier</a> ($key=null, $method=1)</td></tr>
<tr class="memdesc:ae4e1b70f7a5845e4777064b242a35d56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute a public key identifier.  <br /></td></tr>
<tr class="separator:ae4e1b70f7a5845e4777064b242a35d56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd3e81dc470c99af40c0aee99fcdab75"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#abd3e81dc470c99af40c0aee99fcdab75">_formatSubjectPublicKey</a> ()</td></tr>
<tr class="memdesc:abd3e81dc470c99af40c0aee99fcdab75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format a public key as appropriate.  <br /></td></tr>
<tr class="separator:abd3e81dc470c99af40c0aee99fcdab75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2400a644664fad908c8bd05995f6c8c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ab2400a644664fad908c8bd05995f6c8c">setDomain</a> ()</td></tr>
<tr class="memdesc:ab2400a644664fad908c8bd05995f6c8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the domain name's which the cert is to be valid for.  <br /></td></tr>
<tr class="separator:ab2400a644664fad908c8bd05995f6c8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a1b0df6932e2aa9ee3bc0d0d5828a0d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a9a1b0df6932e2aa9ee3bc0d0d5828a0d">setIPAddress</a> ()</td></tr>
<tr class="memdesc:a9a1b0df6932e2aa9ee3bc0d0d5828a0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the IP Addresses's which the cert is to be valid for.  <br /></td></tr>
<tr class="separator:a9a1b0df6932e2aa9ee3bc0d0d5828a0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa392681095261b3594bb8b92462f3e86"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aa392681095261b3594bb8b92462f3e86">_dnsName</a> ($domain)</td></tr>
<tr class="memdesc:aa392681095261b3594bb8b92462f3e86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to build domain array.  <br /></td></tr>
<tr class="separator:aa392681095261b3594bb8b92462f3e86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fa6ee0a38e86ffc0448d5f820fee30d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a2fa6ee0a38e86ffc0448d5f820fee30d">_iPAddress</a> ($address)</td></tr>
<tr class="memdesc:a2fa6ee0a38e86ffc0448d5f820fee30d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to build IP Address array.  <br /></td></tr>
<tr class="separator:a2fa6ee0a38e86ffc0448d5f820fee30d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fd951ac4d21092f644bd6528c171bcb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a8fd951ac4d21092f644bd6528c171bcb">_revokedCertificate</a> (&amp;$rclist, $serial, $create=false)</td></tr>
<tr class="memdesc:a8fd951ac4d21092f644bd6528c171bcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the index of a revoked certificate.  <br /></td></tr>
<tr class="separator:a8fd951ac4d21092f644bd6528c171bcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d0898bce518129997e439126cde0c96"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a9d0898bce518129997e439126cde0c96">revoke</a> ($serial, $date=null)</td></tr>
<tr class="memdesc:a9d0898bce518129997e439126cde0c96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Revoke a certificate.  <br /></td></tr>
<tr class="separator:a9d0898bce518129997e439126cde0c96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ca4f043b6d009999c7b86d6f8b939cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a8ca4f043b6d009999c7b86d6f8b939cc">unrevoke</a> ($serial)</td></tr>
<tr class="memdesc:a8ca4f043b6d009999c7b86d6f8b939cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unrevoke a certificate.  <br /></td></tr>
<tr class="separator:a8ca4f043b6d009999c7b86d6f8b939cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1bb98de862919e64965b293697f3b8d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aa1bb98de862919e64965b293697f3b8d">getRevoked</a> ($serial)</td></tr>
<tr class="memdesc:aa1bb98de862919e64965b293697f3b8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a revoked certificate.  <br /></td></tr>
<tr class="separator:aa1bb98de862919e64965b293697f3b8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa81e0f1f5f3b4d42074cb6cdc69f6434"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aa81e0f1f5f3b4d42074cb6cdc69f6434">listRevoked</a> ($crl=null)</td></tr>
<tr class="memdesc:aa81e0f1f5f3b4d42074cb6cdc69f6434"><td class="mdescLeft">&#160;</td><td class="mdescRight">List revoked certificates.  <br /></td></tr>
<tr class="separator:aa81e0f1f5f3b4d42074cb6cdc69f6434"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a436596da8ebdb29da908604cc2c0b1b5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a436596da8ebdb29da908604cc2c0b1b5">removeRevokedCertificateExtension</a> ($serial, $id)</td></tr>
<tr class="memdesc:a436596da8ebdb29da908604cc2c0b1b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a Revoked Certificate Extension.  <br /></td></tr>
<tr class="separator:a436596da8ebdb29da908604cc2c0b1b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a402e41419a2999b330874e39d0dd2a34"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a402e41419a2999b330874e39d0dd2a34">getRevokedCertificateExtension</a> ($serial, $id, $crl=null)</td></tr>
<tr class="memdesc:a402e41419a2999b330874e39d0dd2a34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a Revoked Certificate Extension.  <br /></td></tr>
<tr class="separator:a402e41419a2999b330874e39d0dd2a34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b45d9da1caa86e25f79910036ad8eee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a2b45d9da1caa86e25f79910036ad8eee">getRevokedCertificateExtensions</a> ($serial, $crl=null)</td></tr>
<tr class="memdesc:a2b45d9da1caa86e25f79910036ad8eee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a list of all extensions in use for a given revoked certificate.  <br /></td></tr>
<tr class="separator:a2b45d9da1caa86e25f79910036ad8eee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ba1f404bda71c06dc86b209616f53d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a28ba1f404bda71c06dc86b209616f53d">setRevokedCertificateExtension</a> ($serial, $id, $value, $critical=false, $replace=true)</td></tr>
<tr class="memdesc:a28ba1f404bda71c06dc86b209616f53d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a Revoked Certificate Extension.  <br /></td></tr>
<tr class="separator:a28ba1f404bda71c06dc86b209616f53d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a009e0a2396931d62c87d27f4e2372024"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a009e0a2396931d62c87d27f4e2372024">_extractBER</a> ($str)</td></tr>
<tr class="memdesc:a009e0a2396931d62c87d27f4e2372024"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract raw BER from Base64 encoding.  <br /></td></tr>
<tr class="separator:a009e0a2396931d62c87d27f4e2372024"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92cea46b70ba6a1c077f7e7e68ec9aa0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a92cea46b70ba6a1c077f7e7e68ec9aa0">getOID</a> ($name)</td></tr>
<tr class="memdesc:a92cea46b70ba6a1c077f7e7e68ec9aa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the OID corresponding to a name.  <br /></td></tr>
<tr class="separator:a92cea46b70ba6a1c077f7e7e68ec9aa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a81539de76c2aedb72804271f0babf584"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a81539de76c2aedb72804271f0babf584">$Certificate</a></td></tr>
<tr class="separator:a81539de76c2aedb72804271f0babf584"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac020f52153cf900b4280912dc6f7cfbc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ac020f52153cf900b4280912dc6f7cfbc">$DirectoryString</a></td></tr>
<tr class="memdesc:ac020f52153cf900b4280912dc6f7cfbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">#+ ASN.1 syntax for various extensions  <br /></td></tr>
<tr class="separator:ac020f52153cf900b4280912dc6f7cfbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35a009c15525cb0fd7ea5fe1cdde6b93"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a35a009c15525cb0fd7ea5fe1cdde6b93">$PKCS9String</a></td></tr>
<tr class="separator:a35a009c15525cb0fd7ea5fe1cdde6b93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a857632ef8e304de8304c04bd9d8b6ff3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a857632ef8e304de8304c04bd9d8b6ff3">$AttributeValue</a></td></tr>
<tr class="separator:a857632ef8e304de8304c04bd9d8b6ff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90a669de695cf2714560d3d428a9bffe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a90a669de695cf2714560d3d428a9bffe">$Extensions</a></td></tr>
<tr class="separator:a90a669de695cf2714560d3d428a9bffe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab083e36c90d152051210e0213ae63a9b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ab083e36c90d152051210e0213ae63a9b">$KeyUsage</a></td></tr>
<tr class="separator:ab083e36c90d152051210e0213ae63a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2200284add3fc613e0d755f1c2dc19fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a2200284add3fc613e0d755f1c2dc19fe">$ExtKeyUsageSyntax</a></td></tr>
<tr class="separator:a2200284add3fc613e0d755f1c2dc19fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6f7cd75bf049b48d346d94ec6cfce0b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#af6f7cd75bf049b48d346d94ec6cfce0b">$BasicConstraints</a></td></tr>
<tr class="separator:af6f7cd75bf049b48d346d94ec6cfce0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ea7b21cd35eaad3ddba1f8591f0ba34"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a0ea7b21cd35eaad3ddba1f8591f0ba34">$KeyIdentifier</a></td></tr>
<tr class="separator:a0ea7b21cd35eaad3ddba1f8591f0ba34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c361644212b39f2db0dcd26d787028d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a1c361644212b39f2db0dcd26d787028d">$CRLDistributionPoints</a></td></tr>
<tr class="separator:a1c361644212b39f2db0dcd26d787028d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa22f5ca854f976db49bd0e5a2a702d8b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aa22f5ca854f976db49bd0e5a2a702d8b">$AuthorityKeyIdentifier</a></td></tr>
<tr class="separator:aa22f5ca854f976db49bd0e5a2a702d8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3993c66da20de874ad6e3d72fc94730d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a3993c66da20de874ad6e3d72fc94730d">$CertificatePolicies</a></td></tr>
<tr class="separator:a3993c66da20de874ad6e3d72fc94730d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f1b3d83907dad45c90204f75ccca97a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a2f1b3d83907dad45c90204f75ccca97a">$AuthorityInfoAccessSyntax</a></td></tr>
<tr class="separator:a2f1b3d83907dad45c90204f75ccca97a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6713e20606d747e709f13d8a4456a1db"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a6713e20606d747e709f13d8a4456a1db">$SubjectAltName</a></td></tr>
<tr class="separator:a6713e20606d747e709f13d8a4456a1db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb40429ebc6c8cdc3917065c59c3c46d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#abb40429ebc6c8cdc3917065c59c3c46d">$SubjectDirectoryAttributes</a></td></tr>
<tr class="separator:abb40429ebc6c8cdc3917065c59c3c46d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29027799ab4c4799c3641146daeabc75"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a29027799ab4c4799c3641146daeabc75">$PrivateKeyUsagePeriod</a></td></tr>
<tr class="separator:a29027799ab4c4799c3641146daeabc75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b3921a26a9432b975886e9a3ac576ec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a7b3921a26a9432b975886e9a3ac576ec">$IssuerAltName</a></td></tr>
<tr class="separator:a7b3921a26a9432b975886e9a3ac576ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dd032993d6d65f5fd578e54b4172617"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a0dd032993d6d65f5fd578e54b4172617">$PolicyMappings</a></td></tr>
<tr class="separator:a0dd032993d6d65f5fd578e54b4172617"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ec0f5819f272583b4e81eb3b5ae71bf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a9ec0f5819f272583b4e81eb3b5ae71bf">$NameConstraints</a></td></tr>
<tr class="separator:a9ec0f5819f272583b4e81eb3b5ae71bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a978b13df42e0d99d24b79e21763bb34f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a978b13df42e0d99d24b79e21763bb34f">$CPSuri</a></td></tr>
<tr class="separator:a978b13df42e0d99d24b79e21763bb34f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c742caf2fc5fd1463a4181b87b69288"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a0c742caf2fc5fd1463a4181b87b69288">$UserNotice</a></td></tr>
<tr class="separator:a0c742caf2fc5fd1463a4181b87b69288"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac786c1b3b59019082fb437c5c731c08b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ac786c1b3b59019082fb437c5c731c08b">$netscape_cert_type</a></td></tr>
<tr class="separator:ac786c1b3b59019082fb437c5c731c08b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26151049490a35186d0aeee63c25b660"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a26151049490a35186d0aeee63c25b660">$netscape_comment</a></td></tr>
<tr class="separator:a26151049490a35186d0aeee63c25b660"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee1528a6ef26dfec58ee2049fa0d5eba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aee1528a6ef26dfec58ee2049fa0d5eba">$netscape_ca_policy_url</a></td></tr>
<tr class="separator:aee1528a6ef26dfec58ee2049fa0d5eba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90efb261c13e9a3e16ed2b0563dec08d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a90efb261c13e9a3e16ed2b0563dec08d">$Name</a></td></tr>
<tr class="separator:a90efb261c13e9a3e16ed2b0563dec08d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9c0f5b10e956d7137dc70546a9edabb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ab9c0f5b10e956d7137dc70546a9edabb">$RelativeDistinguishedName</a></td></tr>
<tr class="separator:ab9c0f5b10e956d7137dc70546a9edabb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f8be9ea21954d157e3a2bb1647b6a16"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a2f8be9ea21954d157e3a2bb1647b6a16">$CRLNumber</a></td></tr>
<tr class="separator:a2f8be9ea21954d157e3a2bb1647b6a16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9771dd54b9a2c36930b559656b5263af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a9771dd54b9a2c36930b559656b5263af">$CRLReason</a></td></tr>
<tr class="separator:a9771dd54b9a2c36930b559656b5263af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c6ec66ab0f66ab7861a6816b14c5888"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a3c6ec66ab0f66ab7861a6816b14c5888">$IssuingDistributionPoint</a></td></tr>
<tr class="separator:a3c6ec66ab0f66ab7861a6816b14c5888"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41cc02dfc1778b249655503e29f4e91d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a41cc02dfc1778b249655503e29f4e91d">$InvalidityDate</a></td></tr>
<tr class="separator:a41cc02dfc1778b249655503e29f4e91d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95e381d17d40c84aad41995e0806edf6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a95e381d17d40c84aad41995e0806edf6">$CertificateIssuer</a></td></tr>
<tr class="separator:a95e381d17d40c84aad41995e0806edf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a024c5aee022e4a581309c16810fce445"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a024c5aee022e4a581309c16810fce445">$HoldInstructionCode</a></td></tr>
<tr class="separator:a024c5aee022e4a581309c16810fce445"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44a1785358b5d0f315d0303bf24a79e2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a44a1785358b5d0f315d0303bf24a79e2">$SignedPublicKeyAndChallenge</a></td></tr>
<tr class="separator:a44a1785358b5d0f315d0303bf24a79e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ed248a6cad1d4f5dbfa3d5d4816ea74"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a2ed248a6cad1d4f5dbfa3d5d4816ea74">$PostalAddress</a></td></tr>
<tr class="memdesc:a2ed248a6cad1d4f5dbfa3d5d4816ea74"><td class="mdescLeft">&#160;</td><td class="mdescRight">#-  <br /></td></tr>
<tr class="separator:a2ed248a6cad1d4f5dbfa3d5d4816ea74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4873356d11288f27532dfe1cb94725d3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a4873356d11288f27532dfe1cb94725d3">$CertificationRequest</a></td></tr>
<tr class="separator:a4873356d11288f27532dfe1cb94725d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7bc8a9e6dcb09461949fb23697f70fc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ae7bc8a9e6dcb09461949fb23697f70fc">$CertificateList</a></td></tr>
<tr class="separator:ae7bc8a9e6dcb09461949fb23697f70fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec1788b361bcb8be2632e5a0e3b8097b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aec1788b361bcb8be2632e5a0e3b8097b">$dn</a></td></tr>
<tr class="separator:aec1788b361bcb8be2632e5a0e3b8097b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d1062abadc25a988fb1aa01bfea74fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a8d1062abadc25a988fb1aa01bfea74fe">$publicKey</a></td></tr>
<tr class="separator:a8d1062abadc25a988fb1aa01bfea74fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0efebc1f06535a262ea0c2d33d794502"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a0efebc1f06535a262ea0c2d33d794502">$privateKey</a></td></tr>
<tr class="separator:a0efebc1f06535a262ea0c2d33d794502"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9922171de7141e7f4f8ebd13acee549c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a9922171de7141e7f4f8ebd13acee549c">$oids</a></td></tr>
<tr class="separator:a9922171de7141e7f4f8ebd13acee549c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9842d7405c8068070534e0fb485abe0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#ae9842d7405c8068070534e0fb485abe0">$CAs</a></td></tr>
<tr class="separator:ae9842d7405c8068070534e0fb485abe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13ce82673cd9b9e0aebbd6c10010a686"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a13ce82673cd9b9e0aebbd6c10010a686">$currentCert</a></td></tr>
<tr class="separator:a13ce82673cd9b9e0aebbd6c10010a686"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc5038cc6c10571997d5cef6f7c85782"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#abc5038cc6c10571997d5cef6f7c85782">$signatureSubject</a></td></tr>
<tr class="separator:abc5038cc6c10571997d5cef6f7c85782"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a288a4b22573d5731fe3f52c55263c5f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a288a4b22573d5731fe3f52c55263c5f3">$startDate</a></td></tr>
<tr class="separator:a288a4b22573d5731fe3f52c55263c5f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a398d961fce9d555095d8e8251c060465"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a398d961fce9d555095d8e8251c060465">$endDate</a></td></tr>
<tr class="separator:a398d961fce9d555095d8e8251c060465"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a679efcb06902f4395826045f1b6346ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a679efcb06902f4395826045f1b6346ab">$serialNumber</a></td></tr>
<tr class="separator:a679efcb06902f4395826045f1b6346ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe105562ae62a8d6ed648ead14d2677c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#afe105562ae62a8d6ed648ead14d2677c">$currentKeyIdentifier</a></td></tr>
<tr class="separator:afe105562ae62a8d6ed648ead14d2677c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae2ec3b0fb507ac82ccbfbbedfa9b864"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#aae2ec3b0fb507ac82ccbfbbedfa9b864">$caFlag</a> = false</td></tr>
<tr class="separator:aae2ec3b0fb507ac82ccbfbbedfa9b864"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eda9302616e36a3bbed9c5769b2fbdb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a2eda9302616e36a3bbed9c5769b2fbdb">$challenge</a></td></tr>
<tr class="separator:a2eda9302616e36a3bbed9c5769b2fbdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02205494b83b199ba35de7bf3c6db477"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#a02205494b83b199ba35de7bf3c6db477">$recur_limit</a> = 5</td></tr>
<tr class="separator:a02205494b83b199ba35de7bf3c6db477"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abce4a4282325e154bdedab72a1e3583f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__X509.html#abce4a4282325e154bdedab72a1e3583f">$disable_url_fetch</a> = false</td></tr>
<tr class="separator:abce4a4282325e154bdedab72a1e3583f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00136">136</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a095c5d389db211932136b53f25f39685" name="a095c5d389db211932136b53f25f39685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a095c5d389db211932136b53f25f39685">&#9670;&#160;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__construct </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default Constructor. </p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classFile__X509.html">File_X509</a> @access public </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00345">345</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  346</span>    {</div>
<div class="line"><span class="lineno">  347</span>        global <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>;</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>        <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Math_BigInteger&#39;</span>)) {</div>
<div class="line"><span class="lineno">  350</span>            include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Math/BigInteger.php&#39;</span>;</div>
<div class="line"><span class="lineno">  351</span>        }</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>        <span class="comment">// Explicitly Tagged Module, 1988 Syntax</span></div>
<div class="line"><span class="lineno">  354</span>        <span class="comment">// http://tools.ietf.org/html/rfc5280#appendix-A.1</span></div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>        $this-&gt;DirectoryString = array(</div>
<div class="line"><span class="lineno">  357</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>,</div>
<div class="line"><span class="lineno">  358</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  359</span>                <span class="stringliteral">&#39;teletexString&#39;</span>   =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a5f903ee9a5fc70fcbff1af967c53083b">FILE_ASN1_TYPE_TELETEX_STRING</a>),</div>
<div class="line"><span class="lineno">  360</span>                <span class="stringliteral">&#39;printableString&#39;</span> =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>),</div>
<div class="line"><span class="lineno">  361</span>                <span class="stringliteral">&#39;universalString&#39;</span> =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#ae7f15dadff8bafe3f5268f472bd1253d">FILE_ASN1_TYPE_UNIVERSAL_STRING</a>),</div>
<div class="line"><span class="lineno">  362</span>                <span class="stringliteral">&#39;utf8String&#39;</span>      =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>),</div>
<div class="line"><span class="lineno">  363</span>                <span class="stringliteral">&#39;bmpString&#39;</span>       =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#afae5a2a5df49e80953c2bb088f9ce8fb">FILE_ASN1_TYPE_BMP_STRING</a>)</div>
<div class="line"><span class="lineno">  364</span>            )</div>
<div class="line"><span class="lineno">  365</span>        );</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>        $this-&gt;PKCS9String = array(</div>
<div class="line"><span class="lineno">  368</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>,</div>
<div class="line"><span class="lineno">  369</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  370</span>                <span class="stringliteral">&#39;ia5String&#39;</span>       =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a>),</div>
<div class="line"><span class="lineno">  371</span>                <span class="stringliteral">&#39;directoryString&#39;</span> =&gt; $this-&gt;DirectoryString</div>
<div class="line"><span class="lineno">  372</span>            )</div>
<div class="line"><span class="lineno">  373</span>        );</div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span>        $this-&gt;AttributeValue = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a96290e3bf3e87b630bc435b0beac8582">FILE_ASN1_TYPE_ANY</a>);</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>        $AttributeType = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>);</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>        $AttributeTypeAndValue = array(</div>
<div class="line"><span class="lineno">  380</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  381</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  382</span>                <span class="stringliteral">&#39;type&#39;</span> =&gt; $AttributeType,</div>
<div class="line"><span class="lineno">  383</span>                <span class="stringliteral">&#39;value&#39;</span>=&gt; $this-&gt;AttributeValue</div>
<div class="line"><span class="lineno">  384</span>            )</div>
<div class="line"><span class="lineno">  385</span>        );</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  388</span><span class="comment">        In practice, RDNs containing multiple name-value pairs (called &quot;multivalued RDNs&quot;) are rare,</span></div>
<div class="line"><span class="lineno">  389</span><span class="comment">        but they can be useful at times when either there is no unique attribute in the entry or you</span></div>
<div class="line"><span class="lineno">  390</span><span class="comment">        want to ensure that the entry&#39;s DN contains some useful identifying information.</span></div>
<div class="line"><span class="lineno">  391</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  392</span><span class="comment">        - https://www.opends.org/wiki/page/DefinitionRelativeDistinguishedName</span></div>
<div class="line"><span class="lineno">  393</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno">  394</span>        $this-&gt;RelativeDistinguishedName = array(</div>
<div class="line"><span class="lineno">  395</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ade866784098f01a9cb1e6901dec0bfca">FILE_ASN1_TYPE_SET</a>,</div>
<div class="line"><span class="lineno">  396</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno">  397</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno">  398</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; $AttributeTypeAndValue</div>
<div class="line"><span class="lineno">  399</span>        );</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>        <span class="comment">// http://tools.ietf.org/html/rfc5280#section-4.1.2.4</span></div>
<div class="line"><span class="lineno">  402</span>        $RDNSequence = array(</div>
<div class="line"><span class="lineno">  403</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  404</span>            <span class="comment">// RDNSequence does not define a min or a max, which means it doesn&#39;t have one</span></div>
<div class="line"><span class="lineno">  405</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 0,</div>
<div class="line"><span class="lineno">  406</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno">  407</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; $this-&gt;RelativeDistinguishedName</div>
<div class="line"><span class="lineno">  408</span>        );</div>
<div class="line"><span class="lineno">  409</span> </div>
<div class="line"><span class="lineno">  410</span>        $this-&gt;Name = array(</div>
<div class="line"><span class="lineno">  411</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>,</div>
<div class="line"><span class="lineno">  412</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  413</span>                <span class="stringliteral">&#39;rdnSequence&#39;</span> =&gt; $RDNSequence</div>
<div class="line"><span class="lineno">  414</span>            )</div>
<div class="line"><span class="lineno">  415</span>        );</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>        <span class="comment">// http://tools.ietf.org/html/rfc5280#section-4.1.1.2</span></div>
<div class="line"><span class="lineno">  418</span>        $AlgorithmIdentifier = array(</div>
<div class="line"><span class="lineno">  419</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  420</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  421</span>                <span class="stringliteral">&#39;algorithm&#39;</span>  =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>),</div>
<div class="line"><span class="lineno">  422</span>                <span class="stringliteral">&#39;parameters&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  423</span>                                    <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a96290e3bf3e87b630bc435b0beac8582">FILE_ASN1_TYPE_ANY</a>,</div>
<div class="line"><span class="lineno">  424</span>                                    <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  425</span>                                )</div>
<div class="line"><span class="lineno">  426</span>            )</div>
<div class="line"><span class="lineno">  427</span>        );</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  430</span><span class="comment">           A certificate using system MUST reject the certificate if it encounters</span></div>
<div class="line"><span class="lineno">  431</span><span class="comment">           a critical extension it does not recognize; however, a non-critical</span></div>
<div class="line"><span class="lineno">  432</span><span class="comment">           extension may be ignored if it is not recognized.</span></div>
<div class="line"><span class="lineno">  433</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  434</span><span class="comment">           http://tools.ietf.org/html/rfc5280#section-4.2</span></div>
<div class="line"><span class="lineno">  435</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno">  436</span>        $Extension = array(</div>
<div class="line"><span class="lineno">  437</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  438</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  439</span>                <span class="stringliteral">&#39;extnId&#39;</span>   =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>),</div>
<div class="line"><span class="lineno">  440</span>                <span class="stringliteral">&#39;critical&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  441</span>                                  <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a7466606a3e1d863445b1be09b85f1148">FILE_ASN1_TYPE_BOOLEAN</a>,</div>
<div class="line"><span class="lineno">  442</span>                                  <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  443</span>                                  <span class="stringliteral">&#39;default&#39;</span>  =&gt; <span class="keyword">false</span></div>
<div class="line"><span class="lineno">  444</span>                              ),</div>
<div class="line"><span class="lineno">  445</span>                <span class="stringliteral">&#39;extnValue&#39;</span> =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a5cbfd497aefacbfc5766e0b266022fc2">FILE_ASN1_TYPE_OCTET_STRING</a>)</div>
<div class="line"><span class="lineno">  446</span>            )</div>
<div class="line"><span class="lineno">  447</span>        );</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>        $this-&gt;Extensions = array(</div>
<div class="line"><span class="lineno">  450</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  451</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno">  452</span>            <span class="comment">// technically, it&#39;s MAX, but we&#39;ll assume anything &lt; 0 is MAX</span></div>
<div class="line"><span class="lineno">  453</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno">  454</span>            <span class="comment">// if &#39;children&#39; isn&#39;t an array then &#39;min&#39; and &#39;max&#39; must be defined</span></div>
<div class="line"><span class="lineno">  455</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; $Extension</div>
<div class="line"><span class="lineno">  456</span>        );</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>        $SubjectPublicKeyInfo = array(</div>
<div class="line"><span class="lineno">  459</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  460</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  461</span>                <span class="stringliteral">&#39;algorithm&#39;</span>        =&gt; $AlgorithmIdentifier,</div>
<div class="line"><span class="lineno">  462</span>                <span class="stringliteral">&#39;subjectPublicKey&#39;</span> =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>)</div>
<div class="line"><span class="lineno">  463</span>            )</div>
<div class="line"><span class="lineno">  464</span>        );</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>        $UniqueIdentifier = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>);</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>        $Time = array(</div>
<div class="line"><span class="lineno">  469</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>,</div>
<div class="line"><span class="lineno">  470</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  471</span>                <span class="stringliteral">&#39;utcTime&#39;</span>     =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a842b61be906cf8882ae9b54a974231ba">FILE_ASN1_TYPE_UTC_TIME</a>),</div>
<div class="line"><span class="lineno">  472</span>                <span class="stringliteral">&#39;generalTime&#39;</span> =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a8ad0c6d6389ce6c6fb2e633814cbfd42">FILE_ASN1_TYPE_GENERALIZED_TIME</a>)</div>
<div class="line"><span class="lineno">  473</span>            )</div>
<div class="line"><span class="lineno">  474</span>        );</div>
<div class="line"><span class="lineno">  475</span> </div>
<div class="line"><span class="lineno">  476</span>        <span class="comment">// http://tools.ietf.org/html/rfc5280#section-4.1.2.5</span></div>
<div class="line"><span class="lineno">  477</span>        $Validity = array(</div>
<div class="line"><span class="lineno">  478</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  479</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  480</span>                <span class="stringliteral">&#39;notBefore&#39;</span> =&gt; $Time,</div>
<div class="line"><span class="lineno">  481</span>                <span class="stringliteral">&#39;notAfter&#39;</span>  =&gt; $Time</div>
<div class="line"><span class="lineno">  482</span>            )</div>
<div class="line"><span class="lineno">  483</span>        );</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>        $CertificateSerialNumber = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a9c3b70985b245c865ddf8874cc422ba6">FILE_ASN1_TYPE_INTEGER</a>);</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>        $Version = array(</div>
<div class="line"><span class="lineno">  488</span>            <span class="stringliteral">&#39;type&#39;</span>    =&gt; <a class="code hl_variable" href="ASN1_8php.html#a9c3b70985b245c865ddf8874cc422ba6">FILE_ASN1_TYPE_INTEGER</a>,</div>
<div class="line"><span class="lineno">  489</span>            <span class="stringliteral">&#39;mapping&#39;</span> =&gt; array(<span class="stringliteral">&#39;v1&#39;</span>, <span class="stringliteral">&#39;v2&#39;</span>, <span class="stringliteral">&#39;v3&#39;</span>)</div>
<div class="line"><span class="lineno">  490</span>        );</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>        <span class="comment">// assert($TBSCertificate[&#39;children&#39;][&#39;signature&#39;] == $Certificate[&#39;children&#39;][&#39;signatureAlgorithm&#39;])</span></div>
<div class="line"><span class="lineno">  493</span>        $TBSCertificate = array(</div>
<div class="line"><span class="lineno">  494</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  495</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  496</span>                <span class="comment">// technically, default implies optional, but we&#39;ll define it as being optional, none-the-less, just to</span></div>
<div class="line"><span class="lineno">  497</span>                <span class="comment">// reenforce that fact</span></div>
<div class="line"><span class="lineno">  498</span>                <span class="stringliteral">&#39;version&#39;</span>             =&gt; array(</div>
<div class="line"><span class="lineno">  499</span>                                             <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno">  500</span>                                             <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  501</span>                                             <span class="stringliteral">&#39;explicit&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  502</span>                                             <span class="stringliteral">&#39;default&#39;</span>  =&gt; <span class="stringliteral">&#39;v1&#39;</span></div>
<div class="line"><span class="lineno">  503</span>                                         ) + $Version,</div>
<div class="line"><span class="lineno">  504</span>                <span class="stringliteral">&#39;serialNumber&#39;</span>         =&gt; $CertificateSerialNumber,</div>
<div class="line"><span class="lineno">  505</span>                <span class="stringliteral">&#39;signature&#39;</span>            =&gt; $AlgorithmIdentifier,</div>
<div class="line"><span class="lineno">  506</span>                <span class="stringliteral">&#39;issuer&#39;</span>               =&gt; $this-&gt;Name,</div>
<div class="line"><span class="lineno">  507</span>                <span class="stringliteral">&#39;validity&#39;</span>             =&gt; $Validity,</div>
<div class="line"><span class="lineno">  508</span>                <span class="stringliteral">&#39;subject&#39;</span>              =&gt; $this-&gt;Name,</div>
<div class="line"><span class="lineno">  509</span>                <span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span> =&gt; $SubjectPublicKeyInfo,</div>
<div class="line"><span class="lineno">  510</span>                <span class="comment">// implicit means that the T in the TLV structure is to be rewritten, regardless of the type</span></div>
<div class="line"><span class="lineno">  511</span>                <span class="stringliteral">&#39;issuerUniqueID&#39;</span>       =&gt; array(</div>
<div class="line"><span class="lineno">  512</span>                                               <span class="stringliteral">&#39;constant&#39;</span> =&gt; 1,</div>
<div class="line"><span class="lineno">  513</span>                                               <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  514</span>                                               <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  515</span>                                           ) + $UniqueIdentifier,</div>
<div class="line"><span class="lineno">  516</span>                <span class="stringliteral">&#39;subjectUniqueID&#39;</span>       =&gt; array(</div>
<div class="line"><span class="lineno">  517</span>                                               <span class="stringliteral">&#39;constant&#39;</span> =&gt; 2,</div>
<div class="line"><span class="lineno">  518</span>                                               <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  519</span>                                               <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  520</span>                                           ) + $UniqueIdentifier,</div>
<div class="line"><span class="lineno">  521</span>                <span class="comment">// &lt;http://tools.ietf.org/html/rfc2459#page-74&gt; doesn&#39;t use the EXPLICIT keyword but if</span></div>
<div class="line"><span class="lineno">  522</span>                <span class="comment">// it&#39;s not IMPLICIT, it&#39;s EXPLICIT</span></div>
<div class="line"><span class="lineno">  523</span>                <span class="stringliteral">&#39;extensions&#39;</span>            =&gt; array(</div>
<div class="line"><span class="lineno">  524</span>                                               <span class="stringliteral">&#39;constant&#39;</span> =&gt; 3,</div>
<div class="line"><span class="lineno">  525</span>                                               <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  526</span>                                               <span class="stringliteral">&#39;explicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  527</span>                                           ) + $this-&gt;Extensions</div>
<div class="line"><span class="lineno">  528</span>            )</div>
<div class="line"><span class="lineno">  529</span>        );</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>        $this-&gt;Certificate = array(</div>
<div class="line"><span class="lineno">  532</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  533</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  534</span>                 <span class="stringliteral">&#39;tbsCertificate&#39;</span>     =&gt; $TBSCertificate,</div>
<div class="line"><span class="lineno">  535</span>                 <span class="stringliteral">&#39;signatureAlgorithm&#39;</span> =&gt; $AlgorithmIdentifier,</div>
<div class="line"><span class="lineno">  536</span>                 <span class="stringliteral">&#39;signature&#39;</span>          =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>)</div>
<div class="line"><span class="lineno">  537</span>            )</div>
<div class="line"><span class="lineno">  538</span>        );</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>        $this-&gt;KeyUsage = array(</div>
<div class="line"><span class="lineno">  541</span>            <span class="stringliteral">&#39;type&#39;</span>    =&gt; <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>,</div>
<div class="line"><span class="lineno">  542</span>            <span class="stringliteral">&#39;mapping&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  543</span>                <span class="stringliteral">&#39;digitalSignature&#39;</span>,</div>
<div class="line"><span class="lineno">  544</span>                <span class="stringliteral">&#39;nonRepudiation&#39;</span>,</div>
<div class="line"><span class="lineno">  545</span>                <span class="stringliteral">&#39;keyEncipherment&#39;</span>,</div>
<div class="line"><span class="lineno">  546</span>                <span class="stringliteral">&#39;dataEncipherment&#39;</span>,</div>
<div class="line"><span class="lineno">  547</span>                <span class="stringliteral">&#39;keyAgreement&#39;</span>,</div>
<div class="line"><span class="lineno">  548</span>                <span class="stringliteral">&#39;keyCertSign&#39;</span>,</div>
<div class="line"><span class="lineno">  549</span>                <span class="stringliteral">&#39;cRLSign&#39;</span>,</div>
<div class="line"><span class="lineno">  550</span>                <span class="stringliteral">&#39;encipherOnly&#39;</span>,</div>
<div class="line"><span class="lineno">  551</span>                <span class="stringliteral">&#39;decipherOnly&#39;</span></div>
<div class="line"><span class="lineno">  552</span>            )</div>
<div class="line"><span class="lineno">  553</span>        );</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>        $this-&gt;BasicConstraints = array(</div>
<div class="line"><span class="lineno">  556</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  557</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  558</span>                <span class="stringliteral">&#39;cA&#39;</span>                =&gt; array(</div>
<div class="line"><span class="lineno">  559</span>                                                 <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a7466606a3e1d863445b1be09b85f1148">FILE_ASN1_TYPE_BOOLEAN</a>,</div>
<div class="line"><span class="lineno">  560</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  561</span>                                                 <span class="stringliteral">&#39;default&#39;</span>  =&gt; <span class="keyword">false</span></div>
<div class="line"><span class="lineno">  562</span>                                       ),</div>
<div class="line"><span class="lineno">  563</span>                <span class="stringliteral">&#39;pathLenConstraint&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  564</span>                                                 <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a9c3b70985b245c865ddf8874cc422ba6">FILE_ASN1_TYPE_INTEGER</a>,</div>
<div class="line"><span class="lineno">  565</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  566</span>                                       )</div>
<div class="line"><span class="lineno">  567</span>            )</div>
<div class="line"><span class="lineno">  568</span>        );</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>        $this-&gt;KeyIdentifier = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a5cbfd497aefacbfc5766e0b266022fc2">FILE_ASN1_TYPE_OCTET_STRING</a>);</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>        $OrganizationalUnitNames = array(</div>
<div class="line"><span class="lineno">  573</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  574</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno">  575</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; 4, <span class="comment">// ub-organizational-units</span></div>
<div class="line"><span class="lineno">  576</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>)</div>
<div class="line"><span class="lineno">  577</span>        );</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>        $PersonalName = array(</div>
<div class="line"><span class="lineno">  580</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ade866784098f01a9cb1e6901dec0bfca">FILE_ASN1_TYPE_SET</a>,</div>
<div class="line"><span class="lineno">  581</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  582</span>                <span class="stringliteral">&#39;surname&#39;</span>              =&gt; array(</div>
<div class="line"><span class="lineno">  583</span>                                           <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>,</div>
<div class="line"><span class="lineno">  584</span>                                           <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno">  585</span>                                           <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  586</span>                                           <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  587</span>                                         ),</div>
<div class="line"><span class="lineno">  588</span>                <span class="stringliteral">&#39;given-name&#39;</span>           =&gt; array(</div>
<div class="line"><span class="lineno">  589</span>                                           <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>,</div>
<div class="line"><span class="lineno">  590</span>                                           <span class="stringliteral">&#39;constant&#39;</span> =&gt; 1,</div>
<div class="line"><span class="lineno">  591</span>                                           <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  592</span>                                           <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  593</span>                                         ),</div>
<div class="line"><span class="lineno">  594</span>                <span class="stringliteral">&#39;initials&#39;</span>             =&gt; array(</div>
<div class="line"><span class="lineno">  595</span>                                           <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>,</div>
<div class="line"><span class="lineno">  596</span>                                           <span class="stringliteral">&#39;constant&#39;</span> =&gt; 2,</div>
<div class="line"><span class="lineno">  597</span>                                           <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  598</span>                                           <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  599</span>                                         ),</div>
<div class="line"><span class="lineno">  600</span>                <span class="stringliteral">&#39;generation-qualifier&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  601</span>                                           <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>,</div>
<div class="line"><span class="lineno">  602</span>                                           <span class="stringliteral">&#39;constant&#39;</span> =&gt; 3,</div>
<div class="line"><span class="lineno">  603</span>                                           <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  604</span>                                           <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  605</span>                                         )</div>
<div class="line"><span class="lineno">  606</span>            )</div>
<div class="line"><span class="lineno">  607</span>        );</div>
<div class="line"><span class="lineno">  608</span> </div>
<div class="line"><span class="lineno">  609</span>        $NumericUserIdentifier = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#af269bb1254bc4f65a21327c39530c0eb">FILE_ASN1_TYPE_NUMERIC_STRING</a>);</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>        $OrganizationName = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>);</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>        $PrivateDomainName = array(</div>
<div class="line"><span class="lineno">  614</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>,</div>
<div class="line"><span class="lineno">  615</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  616</span>                <span class="stringliteral">&#39;numeric&#39;</span>   =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#af269bb1254bc4f65a21327c39530c0eb">FILE_ASN1_TYPE_NUMERIC_STRING</a>),</div>
<div class="line"><span class="lineno">  617</span>                <span class="stringliteral">&#39;printable&#39;</span> =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>)</div>
<div class="line"><span class="lineno">  618</span>            )</div>
<div class="line"><span class="lineno">  619</span>        );</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>        $TerminalIdentifier = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>);</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>        $NetworkAddress = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#af269bb1254bc4f65a21327c39530c0eb">FILE_ASN1_TYPE_NUMERIC_STRING</a>);</div>
<div class="line"><span class="lineno">  624</span> </div>
<div class="line"><span class="lineno">  625</span>        $AdministrationDomainName = array(</div>
<div class="line"><span class="lineno">  626</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>,</div>
<div class="line"><span class="lineno">  627</span>            <span class="comment">// if class isn&#39;t present it&#39;s assumed to be FILE_ASN1_CLASS_UNIVERSAL or</span></div>
<div class="line"><span class="lineno">  628</span>            <span class="comment">// (if constant is present) FILE_ASN1_CLASS_CONTEXT_SPECIFIC</span></div>
<div class="line"><span class="lineno">  629</span>            <span class="stringliteral">&#39;class&#39;</span>    =&gt; <a class="code hl_variable" href="ASN1_8php.html#a77bc62de1f11def34ebec1b8ef064baf">FILE_ASN1_CLASS_APPLICATION</a>,</div>
<div class="line"><span class="lineno">  630</span>            <span class="stringliteral">&#39;cast&#39;</span>     =&gt; 2,</div>
<div class="line"><span class="lineno">  631</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  632</span>                <span class="stringliteral">&#39;numeric&#39;</span>   =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#af269bb1254bc4f65a21327c39530c0eb">FILE_ASN1_TYPE_NUMERIC_STRING</a>),</div>
<div class="line"><span class="lineno">  633</span>                <span class="stringliteral">&#39;printable&#39;</span> =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>)</div>
<div class="line"><span class="lineno">  634</span>            )</div>
<div class="line"><span class="lineno">  635</span>        );</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>        $CountryName = array(</div>
<div class="line"><span class="lineno">  638</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>,</div>
<div class="line"><span class="lineno">  639</span>            <span class="comment">// if class isn&#39;t present it&#39;s assumed to be FILE_ASN1_CLASS_UNIVERSAL or</span></div>
<div class="line"><span class="lineno">  640</span>            <span class="comment">// (if constant is present) FILE_ASN1_CLASS_CONTEXT_SPECIFIC</span></div>
<div class="line"><span class="lineno">  641</span>            <span class="stringliteral">&#39;class&#39;</span>    =&gt; <a class="code hl_variable" href="ASN1_8php.html#a77bc62de1f11def34ebec1b8ef064baf">FILE_ASN1_CLASS_APPLICATION</a>,</div>
<div class="line"><span class="lineno">  642</span>            <span class="stringliteral">&#39;cast&#39;</span>     =&gt; 1,</div>
<div class="line"><span class="lineno">  643</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  644</span>                <span class="stringliteral">&#39;x121-dcc-code&#39;</span>        =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#af269bb1254bc4f65a21327c39530c0eb">FILE_ASN1_TYPE_NUMERIC_STRING</a>),</div>
<div class="line"><span class="lineno">  645</span>                <span class="stringliteral">&#39;iso-3166-alpha2-code&#39;</span> =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>)</div>
<div class="line"><span class="lineno">  646</span>            )</div>
<div class="line"><span class="lineno">  647</span>        );</div>
<div class="line"><span class="lineno">  648</span> </div>
<div class="line"><span class="lineno">  649</span>        $AnotherName = array(</div>
<div class="line"><span class="lineno">  650</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  651</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  652</span>                 <span class="stringliteral">&#39;type-id&#39;</span> =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>),</div>
<div class="line"><span class="lineno">  653</span>                 <span class="stringliteral">&#39;value&#39;</span>   =&gt; array(</div>
<div class="line"><span class="lineno">  654</span>                                  <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a96290e3bf3e87b630bc435b0beac8582">FILE_ASN1_TYPE_ANY</a>,</div>
<div class="line"><span class="lineno">  655</span>                                  <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno">  656</span>                                  <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  657</span>                                  <span class="stringliteral">&#39;explicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  658</span>                              )</div>
<div class="line"><span class="lineno">  659</span>            )</div>
<div class="line"><span class="lineno">  660</span>        );</div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span>        $ExtensionAttribute = array(</div>
<div class="line"><span class="lineno">  663</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  664</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  665</span>                 <span class="stringliteral">&#39;extension-attribute-type&#39;</span>  =&gt; array(</div>
<div class="line"><span class="lineno">  666</span>                                                    <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>,</div>
<div class="line"><span class="lineno">  667</span>                                                    <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno">  668</span>                                                    <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  669</span>                                                    <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  670</span>                                                ),</div>
<div class="line"><span class="lineno">  671</span>                 <span class="stringliteral">&#39;extension-attribute-value&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  672</span>                                                    <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a96290e3bf3e87b630bc435b0beac8582">FILE_ASN1_TYPE_ANY</a>,</div>
<div class="line"><span class="lineno">  673</span>                                                    <span class="stringliteral">&#39;constant&#39;</span> =&gt; 1,</div>
<div class="line"><span class="lineno">  674</span>                                                    <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  675</span>                                                    <span class="stringliteral">&#39;explicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  676</span>                                                )</div>
<div class="line"><span class="lineno">  677</span>            )</div>
<div class="line"><span class="lineno">  678</span>        );</div>
<div class="line"><span class="lineno">  679</span> </div>
<div class="line"><span class="lineno">  680</span>        $ExtensionAttributes = array(</div>
<div class="line"><span class="lineno">  681</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ade866784098f01a9cb1e6901dec0bfca">FILE_ASN1_TYPE_SET</a>,</div>
<div class="line"><span class="lineno">  682</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno">  683</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; 256, <span class="comment">// ub-extension-attributes</span></div>
<div class="line"><span class="lineno">  684</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; $ExtensionAttribute</div>
<div class="line"><span class="lineno">  685</span>        );</div>
<div class="line"><span class="lineno">  686</span> </div>
<div class="line"><span class="lineno">  687</span>        $BuiltInDomainDefinedAttribute = array(</div>
<div class="line"><span class="lineno">  688</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  689</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  690</span>                 <span class="stringliteral">&#39;type&#39;</span>  =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>),</div>
<div class="line"><span class="lineno">  691</span>                 <span class="stringliteral">&#39;value&#39;</span> =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>)</div>
<div class="line"><span class="lineno">  692</span>            )</div>
<div class="line"><span class="lineno">  693</span>        );</div>
<div class="line"><span class="lineno">  694</span> </div>
<div class="line"><span class="lineno">  695</span>        $BuiltInDomainDefinedAttributes = array(</div>
<div class="line"><span class="lineno">  696</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  697</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno">  698</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; 4, <span class="comment">// ub-domain-defined-attributes</span></div>
<div class="line"><span class="lineno">  699</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; $BuiltInDomainDefinedAttribute</div>
<div class="line"><span class="lineno">  700</span>        );</div>
<div class="line"><span class="lineno">  701</span> </div>
<div class="line"><span class="lineno">  702</span>        $BuiltInStandardAttributes =  array(</div>
<div class="line"><span class="lineno">  703</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  704</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  705</span>                <span class="stringliteral">&#39;country-name&#39;</span>               =&gt; array(<span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>) + $CountryName,</div>
<div class="line"><span class="lineno">  706</span>                <span class="stringliteral">&#39;administration-domain-name&#39;</span> =&gt; array(<span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>) + $AdministrationDomainName,</div>
<div class="line"><span class="lineno">  707</span>                <span class="stringliteral">&#39;network-address&#39;</span>            =&gt; array(</div>
<div class="line"><span class="lineno">  708</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno">  709</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  710</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  711</span>                                               ) + $NetworkAddress,</div>
<div class="line"><span class="lineno">  712</span>                <span class="stringliteral">&#39;terminal-identifier&#39;</span>        =&gt; array(</div>
<div class="line"><span class="lineno">  713</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 1,</div>
<div class="line"><span class="lineno">  714</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  715</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  716</span>                                               ) + $TerminalIdentifier,</div>
<div class="line"><span class="lineno">  717</span>                <span class="stringliteral">&#39;private-domain-name&#39;</span>        =&gt; array(</div>
<div class="line"><span class="lineno">  718</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 2,</div>
<div class="line"><span class="lineno">  719</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  720</span>                                                 <span class="stringliteral">&#39;explicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  721</span>                                               ) + $PrivateDomainName,</div>
<div class="line"><span class="lineno">  722</span>                <span class="stringliteral">&#39;organization-name&#39;</span>          =&gt; array(</div>
<div class="line"><span class="lineno">  723</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 3,</div>
<div class="line"><span class="lineno">  724</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  725</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  726</span>                                               ) + $OrganizationName,</div>
<div class="line"><span class="lineno">  727</span>                <span class="stringliteral">&#39;numeric-user-identifier&#39;</span>    =&gt; array(</div>
<div class="line"><span class="lineno">  728</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 4,</div>
<div class="line"><span class="lineno">  729</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  730</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  731</span>                                               ) + $NumericUserIdentifier,</div>
<div class="line"><span class="lineno">  732</span>                <span class="stringliteral">&#39;personal-name&#39;</span>              =&gt; array(</div>
<div class="line"><span class="lineno">  733</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 5,</div>
<div class="line"><span class="lineno">  734</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  735</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  736</span>                                               ) + $PersonalName,</div>
<div class="line"><span class="lineno">  737</span>                <span class="stringliteral">&#39;organizational-unit-names&#39;</span>  =&gt; array(</div>
<div class="line"><span class="lineno">  738</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 6,</div>
<div class="line"><span class="lineno">  739</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  740</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  741</span>                                               ) + $OrganizationalUnitNames</div>
<div class="line"><span class="lineno">  742</span>            )</div>
<div class="line"><span class="lineno">  743</span>        );</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>        $ORAddress = array(</div>
<div class="line"><span class="lineno">  746</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  747</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  748</span>                 <span class="stringliteral">&#39;built-in-standard-attributes&#39;</span>       =&gt; $BuiltInStandardAttributes,</div>
<div class="line"><span class="lineno">  749</span>                 <span class="stringliteral">&#39;built-in-domain-defined-attributes&#39;</span> =&gt; array(<span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>) + $BuiltInDomainDefinedAttributes,</div>
<div class="line"><span class="lineno">  750</span>                 <span class="stringliteral">&#39;extension-attributes&#39;</span>               =&gt; array(<span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>) + $ExtensionAttributes</div>
<div class="line"><span class="lineno">  751</span>            )</div>
<div class="line"><span class="lineno">  752</span>        );</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>        $EDIPartyName = array(</div>
<div class="line"><span class="lineno">  755</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  756</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  757</span>                 <span class="stringliteral">&#39;nameAssigner&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  758</span>                                    <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno">  759</span>                                    <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  760</span>                                    <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  761</span>                                ) + $this-&gt;DirectoryString,</div>
<div class="line"><span class="lineno">  762</span>                 <span class="comment">// partyName is technically required but File_ASN1 doesn&#39;t currently support non-optional constants and</span></div>
<div class="line"><span class="lineno">  763</span>                 <span class="comment">// setting it to optional gets the job done in any event.</span></div>
<div class="line"><span class="lineno">  764</span>                 <span class="stringliteral">&#39;partyName&#39;</span>    =&gt; array(</div>
<div class="line"><span class="lineno">  765</span>                                    <span class="stringliteral">&#39;constant&#39;</span> =&gt; 1,</div>
<div class="line"><span class="lineno">  766</span>                                    <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  767</span>                                    <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  768</span>                                ) + $this-&gt;DirectoryString</div>
<div class="line"><span class="lineno">  769</span>            )</div>
<div class="line"><span class="lineno">  770</span>        );</div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span>        $GeneralName = array(</div>
<div class="line"><span class="lineno">  773</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>,</div>
<div class="line"><span class="lineno">  774</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  775</span>                <span class="stringliteral">&#39;otherName&#39;</span>                 =&gt; array(</div>
<div class="line"><span class="lineno">  776</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno">  777</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  778</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  779</span>                                               ) + $AnotherName,</div>
<div class="line"><span class="lineno">  780</span>                <span class="stringliteral">&#39;rfc822Name&#39;</span>                =&gt; array(</div>
<div class="line"><span class="lineno">  781</span>                                                 <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a>,</div>
<div class="line"><span class="lineno">  782</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 1,</div>
<div class="line"><span class="lineno">  783</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  784</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  785</span>                                               ),</div>
<div class="line"><span class="lineno">  786</span>                <span class="stringliteral">&#39;dNSName&#39;</span>                   =&gt; array(</div>
<div class="line"><span class="lineno">  787</span>                                                 <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a>,</div>
<div class="line"><span class="lineno">  788</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 2,</div>
<div class="line"><span class="lineno">  789</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  790</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  791</span>                                               ),</div>
<div class="line"><span class="lineno">  792</span>                <span class="stringliteral">&#39;x400Address&#39;</span>               =&gt; array(</div>
<div class="line"><span class="lineno">  793</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 3,</div>
<div class="line"><span class="lineno">  794</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  795</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  796</span>                                               ) + $ORAddress,</div>
<div class="line"><span class="lineno">  797</span>                <span class="stringliteral">&#39;directoryName&#39;</span>             =&gt; array(</div>
<div class="line"><span class="lineno">  798</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 4,</div>
<div class="line"><span class="lineno">  799</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  800</span>                                                 <span class="stringliteral">&#39;explicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  801</span>                                               ) + $this-&gt;Name,</div>
<div class="line"><span class="lineno">  802</span>                <span class="stringliteral">&#39;ediPartyName&#39;</span>              =&gt; array(</div>
<div class="line"><span class="lineno">  803</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 5,</div>
<div class="line"><span class="lineno">  804</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  805</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  806</span>                                               ) + $EDIPartyName,</div>
<div class="line"><span class="lineno">  807</span>                <span class="stringliteral">&#39;uniformResourceIdentifier&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  808</span>                                                 <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a>,</div>
<div class="line"><span class="lineno">  809</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 6,</div>
<div class="line"><span class="lineno">  810</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  811</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  812</span>                                               ),</div>
<div class="line"><span class="lineno">  813</span>                <span class="stringliteral">&#39;iPAddress&#39;</span>                 =&gt; array(</div>
<div class="line"><span class="lineno">  814</span>                                                 <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a5cbfd497aefacbfc5766e0b266022fc2">FILE_ASN1_TYPE_OCTET_STRING</a>,</div>
<div class="line"><span class="lineno">  815</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 7,</div>
<div class="line"><span class="lineno">  816</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  817</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  818</span>                                               ),</div>
<div class="line"><span class="lineno">  819</span>                <span class="stringliteral">&#39;registeredID&#39;</span>              =&gt; array(</div>
<div class="line"><span class="lineno">  820</span>                                                 <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>,</div>
<div class="line"><span class="lineno">  821</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 8,</div>
<div class="line"><span class="lineno">  822</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  823</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  824</span>                                               )</div>
<div class="line"><span class="lineno">  825</span>            )</div>
<div class="line"><span class="lineno">  826</span>        );</div>
<div class="line"><span class="lineno">  827</span> </div>
<div class="line"><span class="lineno">  828</span>        $GeneralNames = array(</div>
<div class="line"><span class="lineno">  829</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  830</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno">  831</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno">  832</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; $GeneralName</div>
<div class="line"><span class="lineno">  833</span>        );</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>        $this-&gt;IssuerAltName = $GeneralNames;</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>        $ReasonFlags = array(</div>
<div class="line"><span class="lineno">  838</span>            <span class="stringliteral">&#39;type&#39;</span>    =&gt; <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>,</div>
<div class="line"><span class="lineno">  839</span>            <span class="stringliteral">&#39;mapping&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  840</span>                <span class="stringliteral">&#39;unused&#39;</span>,</div>
<div class="line"><span class="lineno">  841</span>                <span class="stringliteral">&#39;keyCompromise&#39;</span>,</div>
<div class="line"><span class="lineno">  842</span>                <span class="stringliteral">&#39;cACompromise&#39;</span>,</div>
<div class="line"><span class="lineno">  843</span>                <span class="stringliteral">&#39;affiliationChanged&#39;</span>,</div>
<div class="line"><span class="lineno">  844</span>                <span class="stringliteral">&#39;superseded&#39;</span>,</div>
<div class="line"><span class="lineno">  845</span>                <span class="stringliteral">&#39;cessationOfOperation&#39;</span>,</div>
<div class="line"><span class="lineno">  846</span>                <span class="stringliteral">&#39;certificateHold&#39;</span>,</div>
<div class="line"><span class="lineno">  847</span>                <span class="stringliteral">&#39;privilegeWithdrawn&#39;</span>,</div>
<div class="line"><span class="lineno">  848</span>                <span class="stringliteral">&#39;aACompromise&#39;</span></div>
<div class="line"><span class="lineno">  849</span>            )</div>
<div class="line"><span class="lineno">  850</span>        );</div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span>        $DistributionPointName = array(</div>
<div class="line"><span class="lineno">  853</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>,</div>
<div class="line"><span class="lineno">  854</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  855</span>                <span class="stringliteral">&#39;fullName&#39;</span>                =&gt; array(</div>
<div class="line"><span class="lineno">  856</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno">  857</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  858</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  859</span>                                       ) + $GeneralNames,</div>
<div class="line"><span class="lineno">  860</span>                <span class="stringliteral">&#39;nameRelativeToCRLIssuer&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  861</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 1,</div>
<div class="line"><span class="lineno">  862</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  863</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  864</span>                                       ) + $this-&gt;RelativeDistinguishedName</div>
<div class="line"><span class="lineno">  865</span>            )</div>
<div class="line"><span class="lineno">  866</span>        );</div>
<div class="line"><span class="lineno">  867</span> </div>
<div class="line"><span class="lineno">  868</span>        $DistributionPoint = array(</div>
<div class="line"><span class="lineno">  869</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  870</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  871</span>                <span class="stringliteral">&#39;distributionPoint&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  872</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno">  873</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  874</span>                                                 <span class="stringliteral">&#39;explicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  875</span>                                       ) + $DistributionPointName,</div>
<div class="line"><span class="lineno">  876</span>                <span class="stringliteral">&#39;reasons&#39;</span>           =&gt; array(</div>
<div class="line"><span class="lineno">  877</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 1,</div>
<div class="line"><span class="lineno">  878</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  879</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  880</span>                                       ) + $ReasonFlags,</div>
<div class="line"><span class="lineno">  881</span>                <span class="stringliteral">&#39;cRLIssuer&#39;</span>         =&gt; array(</div>
<div class="line"><span class="lineno">  882</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 2,</div>
<div class="line"><span class="lineno">  883</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  884</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  885</span>                                       ) + $GeneralNames</div>
<div class="line"><span class="lineno">  886</span>            )</div>
<div class="line"><span class="lineno">  887</span>        );</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span>        $this-&gt;CRLDistributionPoints = array(</div>
<div class="line"><span class="lineno">  890</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  891</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno">  892</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno">  893</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; $DistributionPoint</div>
<div class="line"><span class="lineno">  894</span>        );</div>
<div class="line"><span class="lineno">  895</span> </div>
<div class="line"><span class="lineno">  896</span>        $this-&gt;AuthorityKeyIdentifier = array(</div>
<div class="line"><span class="lineno">  897</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  898</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  899</span>                <span class="stringliteral">&#39;keyIdentifier&#39;</span>             =&gt; array(</div>
<div class="line"><span class="lineno">  900</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno">  901</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  902</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  903</span>                                               ) + $this-&gt;KeyIdentifier,</div>
<div class="line"><span class="lineno">  904</span>                <span class="stringliteral">&#39;authorityCertIssuer&#39;</span>       =&gt; array(</div>
<div class="line"><span class="lineno">  905</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 1,</div>
<div class="line"><span class="lineno">  906</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  907</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  908</span>                                               ) + $GeneralNames,</div>
<div class="line"><span class="lineno">  909</span>                <span class="stringliteral">&#39;authorityCertSerialNumber&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  910</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 2,</div>
<div class="line"><span class="lineno">  911</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  912</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno">  913</span>                                               ) + $CertificateSerialNumber</div>
<div class="line"><span class="lineno">  914</span>            )</div>
<div class="line"><span class="lineno">  915</span>        );</div>
<div class="line"><span class="lineno">  916</span> </div>
<div class="line"><span class="lineno">  917</span>        $PolicyQualifierId = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>);</div>
<div class="line"><span class="lineno">  918</span> </div>
<div class="line"><span class="lineno">  919</span>        $PolicyQualifierInfo = array(</div>
<div class="line"><span class="lineno">  920</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  921</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  922</span>                <span class="stringliteral">&#39;policyQualifierId&#39;</span> =&gt; $PolicyQualifierId,</div>
<div class="line"><span class="lineno">  923</span>                <span class="stringliteral">&#39;qualifier&#39;</span>         =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a96290e3bf3e87b630bc435b0beac8582">FILE_ASN1_TYPE_ANY</a>)</div>
<div class="line"><span class="lineno">  924</span>            )</div>
<div class="line"><span class="lineno">  925</span>        );</div>
<div class="line"><span class="lineno">  926</span> </div>
<div class="line"><span class="lineno">  927</span>        $CertPolicyId = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>);</div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>        $PolicyInformation = array(</div>
<div class="line"><span class="lineno">  930</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  931</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  932</span>                <span class="stringliteral">&#39;policyIdentifier&#39;</span> =&gt; $CertPolicyId,</div>
<div class="line"><span class="lineno">  933</span>                <span class="stringliteral">&#39;policyQualifiers&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  934</span>                                          <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  935</span>                                          <span class="stringliteral">&#39;min&#39;</span>      =&gt; 0,</div>
<div class="line"><span class="lineno">  936</span>                                          <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno">  937</span>                                          <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  938</span>                                          <span class="stringliteral">&#39;children&#39;</span> =&gt; $PolicyQualifierInfo</div>
<div class="line"><span class="lineno">  939</span>                                      )</div>
<div class="line"><span class="lineno">  940</span>            )</div>
<div class="line"><span class="lineno">  941</span>        );</div>
<div class="line"><span class="lineno">  942</span> </div>
<div class="line"><span class="lineno">  943</span>        $this-&gt;CertificatePolicies = array(</div>
<div class="line"><span class="lineno">  944</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  945</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno">  946</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno">  947</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; $PolicyInformation</div>
<div class="line"><span class="lineno">  948</span>        );</div>
<div class="line"><span class="lineno">  949</span> </div>
<div class="line"><span class="lineno">  950</span>        $this-&gt;PolicyMappings = array(</div>
<div class="line"><span class="lineno">  951</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  952</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno">  953</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno">  954</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  955</span>                              <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  956</span>                              <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  957</span>                                  <span class="stringliteral">&#39;issuerDomainPolicy&#39;</span> =&gt; $CertPolicyId,</div>
<div class="line"><span class="lineno">  958</span>                                  <span class="stringliteral">&#39;subjectDomainPolicy&#39;</span> =&gt; $CertPolicyId</div>
<div class="line"><span class="lineno">  959</span>                              )</div>
<div class="line"><span class="lineno">  960</span>                       )</div>
<div class="line"><span class="lineno">  961</span>        );</div>
<div class="line"><span class="lineno">  962</span> </div>
<div class="line"><span class="lineno">  963</span>        $KeyPurposeId = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>);</div>
<div class="line"><span class="lineno">  964</span> </div>
<div class="line"><span class="lineno">  965</span>        $this-&gt;ExtKeyUsageSyntax = array(</div>
<div class="line"><span class="lineno">  966</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  967</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno">  968</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno">  969</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; $KeyPurposeId</div>
<div class="line"><span class="lineno">  970</span>        );</div>
<div class="line"><span class="lineno">  971</span> </div>
<div class="line"><span class="lineno">  972</span>        $AccessDescription = array(</div>
<div class="line"><span class="lineno">  973</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  974</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  975</span>                <span class="stringliteral">&#39;accessMethod&#39;</span>   =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>),</div>
<div class="line"><span class="lineno">  976</span>                <span class="stringliteral">&#39;accessLocation&#39;</span> =&gt; $GeneralName</div>
<div class="line"><span class="lineno">  977</span>            )</div>
<div class="line"><span class="lineno">  978</span>        );</div>
<div class="line"><span class="lineno">  979</span> </div>
<div class="line"><span class="lineno">  980</span>        $this-&gt;AuthorityInfoAccessSyntax = array(</div>
<div class="line"><span class="lineno">  981</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  982</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno">  983</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno">  984</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; $AccessDescription</div>
<div class="line"><span class="lineno">  985</span>        );</div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span>        $this-&gt;SubjectInfoAccessSyntax = array(</div>
<div class="line"><span class="lineno">  988</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  989</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno">  990</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno">  991</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; $AccessDescription</div>
<div class="line"><span class="lineno">  992</span>        );</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span>        $this-&gt;SubjectAltName = $GeneralNames;</div>
<div class="line"><span class="lineno">  995</span> </div>
<div class="line"><span class="lineno">  996</span>        $this-&gt;PrivateKeyUsagePeriod = array(</div>
<div class="line"><span class="lineno">  997</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno">  998</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">  999</span>                <span class="stringliteral">&#39;notBefore&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1000</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno"> 1001</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1002</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1003</span>                                                 <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a8ad0c6d6389ce6c6fb2e633814cbfd42">FILE_ASN1_TYPE_GENERALIZED_TIME</a>),</div>
<div class="line"><span class="lineno"> 1004</span>                <span class="stringliteral">&#39;notAfter&#39;</span>  =&gt; array(</div>
<div class="line"><span class="lineno"> 1005</span>                                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 1,</div>
<div class="line"><span class="lineno"> 1006</span>                                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1007</span>                                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1008</span>                                                 <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a8ad0c6d6389ce6c6fb2e633814cbfd42">FILE_ASN1_TYPE_GENERALIZED_TIME</a>)</div>
<div class="line"><span class="lineno"> 1009</span>            )</div>
<div class="line"><span class="lineno"> 1010</span>        );</div>
<div class="line"><span class="lineno"> 1011</span> </div>
<div class="line"><span class="lineno"> 1012</span>        $BaseDistance = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a9c3b70985b245c865ddf8874cc422ba6">FILE_ASN1_TYPE_INTEGER</a>);</div>
<div class="line"><span class="lineno"> 1013</span> </div>
<div class="line"><span class="lineno"> 1014</span>        $GeneralSubtree = array(</div>
<div class="line"><span class="lineno"> 1015</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1016</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1017</span>                <span class="stringliteral">&#39;base&#39;</span>    =&gt; $GeneralName,</div>
<div class="line"><span class="lineno"> 1018</span>                <span class="stringliteral">&#39;minimum&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1019</span>                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno"> 1020</span>                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1021</span>                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1022</span>                                 <span class="stringliteral">&#39;default&#39;</span> =&gt; <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>(0)</div>
<div class="line"><span class="lineno"> 1023</span>                             ) + $BaseDistance,</div>
<div class="line"><span class="lineno"> 1024</span>                <span class="stringliteral">&#39;maximum&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1025</span>                                 <span class="stringliteral">&#39;constant&#39;</span> =&gt; 1,</div>
<div class="line"><span class="lineno"> 1026</span>                                 <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1027</span>                                 <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1028</span>                             ) + $BaseDistance</div>
<div class="line"><span class="lineno"> 1029</span>            )</div>
<div class="line"><span class="lineno"> 1030</span>        );</div>
<div class="line"><span class="lineno"> 1031</span> </div>
<div class="line"><span class="lineno"> 1032</span>        $GeneralSubtrees = array(</div>
<div class="line"><span class="lineno"> 1033</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1034</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno"> 1035</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno"> 1036</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; $GeneralSubtree</div>
<div class="line"><span class="lineno"> 1037</span>        );</div>
<div class="line"><span class="lineno"> 1038</span> </div>
<div class="line"><span class="lineno"> 1039</span>        $this-&gt;NameConstraints = array(</div>
<div class="line"><span class="lineno"> 1040</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1041</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1042</span>                <span class="stringliteral">&#39;permittedSubtrees&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1043</span>                                           <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno"> 1044</span>                                           <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1045</span>                                           <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno"> 1046</span>                                       ) + $GeneralSubtrees,</div>
<div class="line"><span class="lineno"> 1047</span>                <span class="stringliteral">&#39;excludedSubtrees&#39;</span>  =&gt; array(</div>
<div class="line"><span class="lineno"> 1048</span>                                           <span class="stringliteral">&#39;constant&#39;</span> =&gt; 1,</div>
<div class="line"><span class="lineno"> 1049</span>                                           <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1050</span>                                           <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno"> 1051</span>                                       ) + $GeneralSubtrees</div>
<div class="line"><span class="lineno"> 1052</span>            )</div>
<div class="line"><span class="lineno"> 1053</span>        );</div>
<div class="line"><span class="lineno"> 1054</span> </div>
<div class="line"><span class="lineno"> 1055</span>        $this-&gt;CPSuri = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a>);</div>
<div class="line"><span class="lineno"> 1056</span> </div>
<div class="line"><span class="lineno"> 1057</span>        $DisplayText = array(</div>
<div class="line"><span class="lineno"> 1058</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>,</div>
<div class="line"><span class="lineno"> 1059</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1060</span>                <span class="stringliteral">&#39;ia5String&#39;</span>     =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a>),</div>
<div class="line"><span class="lineno"> 1061</span>                <span class="stringliteral">&#39;visibleString&#39;</span> =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a5301a15003ac88ef62b1b097a8f99e8b">FILE_ASN1_TYPE_VISIBLE_STRING</a>),</div>
<div class="line"><span class="lineno"> 1062</span>                <span class="stringliteral">&#39;bmpString&#39;</span>     =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#afae5a2a5df49e80953c2bb088f9ce8fb">FILE_ASN1_TYPE_BMP_STRING</a>),</div>
<div class="line"><span class="lineno"> 1063</span>                <span class="stringliteral">&#39;utf8String&#39;</span>    =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>)</div>
<div class="line"><span class="lineno"> 1064</span>            )</div>
<div class="line"><span class="lineno"> 1065</span>        );</div>
<div class="line"><span class="lineno"> 1066</span> </div>
<div class="line"><span class="lineno"> 1067</span>        $NoticeReference = array(</div>
<div class="line"><span class="lineno"> 1068</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1069</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1070</span>                <span class="stringliteral">&#39;organization&#39;</span>  =&gt; $DisplayText,</div>
<div class="line"><span class="lineno"> 1071</span>                <span class="stringliteral">&#39;noticeNumbers&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1072</span>                                       <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1073</span>                                       <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno"> 1074</span>                                       <span class="stringliteral">&#39;max&#39;</span>      =&gt; 200,</div>
<div class="line"><span class="lineno"> 1075</span>                                       <span class="stringliteral">&#39;children&#39;</span> =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a9c3b70985b245c865ddf8874cc422ba6">FILE_ASN1_TYPE_INTEGER</a>)</div>
<div class="line"><span class="lineno"> 1076</span>                                   )</div>
<div class="line"><span class="lineno"> 1077</span>            )</div>
<div class="line"><span class="lineno"> 1078</span>        );</div>
<div class="line"><span class="lineno"> 1079</span> </div>
<div class="line"><span class="lineno"> 1080</span>        $this-&gt;UserNotice = array(</div>
<div class="line"><span class="lineno"> 1081</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1082</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1083</span>                <span class="stringliteral">&#39;noticeRef&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1084</span>                                           <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1085</span>                                           <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno"> 1086</span>                                       ) + $NoticeReference,</div>
<div class="line"><span class="lineno"> 1087</span>                <span class="stringliteral">&#39;explicitText&#39;</span>  =&gt; array(</div>
<div class="line"><span class="lineno"> 1088</span>                                           <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1089</span>                                           <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno"> 1090</span>                                       ) + $DisplayText</div>
<div class="line"><span class="lineno"> 1091</span>            )</div>
<div class="line"><span class="lineno"> 1092</span>        );</div>
<div class="line"><span class="lineno"> 1093</span> </div>
<div class="line"><span class="lineno"> 1094</span>        <span class="comment">// mapping is from &lt;http://www.mozilla.org/projects/security/pki/nss/tech-notes/tn3.html&gt;</span></div>
<div class="line"><span class="lineno"> 1095</span>        $this-&gt;netscape_cert_type = array(</div>
<div class="line"><span class="lineno"> 1096</span>            <span class="stringliteral">&#39;type&#39;</span>    =&gt; <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>,</div>
<div class="line"><span class="lineno"> 1097</span>            <span class="stringliteral">&#39;mapping&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1098</span>                <span class="stringliteral">&#39;SSLClient&#39;</span>,</div>
<div class="line"><span class="lineno"> 1099</span>                <span class="stringliteral">&#39;SSLServer&#39;</span>,</div>
<div class="line"><span class="lineno"> 1100</span>                <span class="stringliteral">&#39;Email&#39;</span>,</div>
<div class="line"><span class="lineno"> 1101</span>                <span class="stringliteral">&#39;ObjectSigning&#39;</span>,</div>
<div class="line"><span class="lineno"> 1102</span>                <span class="stringliteral">&#39;Reserved&#39;</span>,</div>
<div class="line"><span class="lineno"> 1103</span>                <span class="stringliteral">&#39;SSLCA&#39;</span>,</div>
<div class="line"><span class="lineno"> 1104</span>                <span class="stringliteral">&#39;EmailCA&#39;</span>,</div>
<div class="line"><span class="lineno"> 1105</span>                <span class="stringliteral">&#39;ObjectSigningCA&#39;</span></div>
<div class="line"><span class="lineno"> 1106</span>            )</div>
<div class="line"><span class="lineno"> 1107</span>        );</div>
<div class="line"><span class="lineno"> 1108</span> </div>
<div class="line"><span class="lineno"> 1109</span>        $this-&gt;netscape_comment = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a>);</div>
<div class="line"><span class="lineno"> 1110</span>        $this-&gt;netscape_ca_policy_url = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a>);</div>
<div class="line"><span class="lineno"> 1111</span> </div>
<div class="line"><span class="lineno"> 1112</span>        <span class="comment">// attribute is used in RFC2986 but we&#39;re using the RFC5280 definition</span></div>
<div class="line"><span class="lineno"> 1113</span> </div>
<div class="line"><span class="lineno"> 1114</span>        $Attribute = array(</div>
<div class="line"><span class="lineno"> 1115</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1116</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1117</span>                <span class="stringliteral">&#39;type&#39;</span> =&gt; $AttributeType,</div>
<div class="line"><span class="lineno"> 1118</span>                <span class="stringliteral">&#39;value&#39;</span>=&gt; array(</div>
<div class="line"><span class="lineno"> 1119</span>                              <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ade866784098f01a9cb1e6901dec0bfca">FILE_ASN1_TYPE_SET</a>,</div>
<div class="line"><span class="lineno"> 1120</span>                              <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno"> 1121</span>                              <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno"> 1122</span>                              <span class="stringliteral">&#39;children&#39;</span> =&gt; $this-&gt;AttributeValue</div>
<div class="line"><span class="lineno"> 1123</span>                          )</div>
<div class="line"><span class="lineno"> 1124</span>            )</div>
<div class="line"><span class="lineno"> 1125</span>        );</div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span>        $this-&gt;SubjectDirectoryAttributes = array(</div>
<div class="line"><span class="lineno"> 1128</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1129</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno"> 1130</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno"> 1131</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; $Attribute</div>
<div class="line"><span class="lineno"> 1132</span>        );</div>
<div class="line"><span class="lineno"> 1133</span> </div>
<div class="line"><span class="lineno"> 1134</span>        <span class="comment">// adapted from &lt;http://tools.ietf.org/html/rfc2986&gt;</span></div>
<div class="line"><span class="lineno"> 1135</span> </div>
<div class="line"><span class="lineno"> 1136</span>        $Attributes = array(</div>
<div class="line"><span class="lineno"> 1137</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ade866784098f01a9cb1e6901dec0bfca">FILE_ASN1_TYPE_SET</a>,</div>
<div class="line"><span class="lineno"> 1138</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno"> 1139</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno"> 1140</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; $Attribute</div>
<div class="line"><span class="lineno"> 1141</span>        );</div>
<div class="line"><span class="lineno"> 1142</span> </div>
<div class="line"><span class="lineno"> 1143</span>        $CertificationRequestInfo = array(</div>
<div class="line"><span class="lineno"> 1144</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1145</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1146</span>                <span class="stringliteral">&#39;version&#39;</span>       =&gt; array(</div>
<div class="line"><span class="lineno"> 1147</span>                                       <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a9c3b70985b245c865ddf8874cc422ba6">FILE_ASN1_TYPE_INTEGER</a>,</div>
<div class="line"><span class="lineno"> 1148</span>                                       <span class="stringliteral">&#39;mapping&#39;</span> =&gt; array(<span class="stringliteral">&#39;v1&#39;</span>)</div>
<div class="line"><span class="lineno"> 1149</span>                                   ),</div>
<div class="line"><span class="lineno"> 1150</span>                <span class="stringliteral">&#39;subject&#39;</span>       =&gt; $this-&gt;Name,</div>
<div class="line"><span class="lineno"> 1151</span>                <span class="stringliteral">&#39;subjectPKInfo&#39;</span> =&gt; $SubjectPublicKeyInfo,</div>
<div class="line"><span class="lineno"> 1152</span>                <span class="stringliteral">&#39;attributes&#39;</span>    =&gt; array(</div>
<div class="line"><span class="lineno"> 1153</span>                                       <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno"> 1154</span>                                       <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1155</span>                                       <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno"> 1156</span>                                   ) + $Attributes,</div>
<div class="line"><span class="lineno"> 1157</span>            )</div>
<div class="line"><span class="lineno"> 1158</span>        );</div>
<div class="line"><span class="lineno"> 1159</span> </div>
<div class="line"><span class="lineno"> 1160</span>        $this-&gt;CertificationRequest = array(</div>
<div class="line"><span class="lineno"> 1161</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1162</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1163</span>                <span class="stringliteral">&#39;certificationRequestInfo&#39;</span> =&gt; $CertificationRequestInfo,</div>
<div class="line"><span class="lineno"> 1164</span>                <span class="stringliteral">&#39;signatureAlgorithm&#39;</span>       =&gt; $AlgorithmIdentifier,</div>
<div class="line"><span class="lineno"> 1165</span>                <span class="stringliteral">&#39;signature&#39;</span>                =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>)</div>
<div class="line"><span class="lineno"> 1166</span>            )</div>
<div class="line"><span class="lineno"> 1167</span>        );</div>
<div class="line"><span class="lineno"> 1168</span> </div>
<div class="line"><span class="lineno"> 1169</span>        $RevokedCertificate = array(</div>
<div class="line"><span class="lineno"> 1170</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1171</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1172</span>                              <span class="stringliteral">&#39;userCertificate&#39;</span>    =&gt; $CertificateSerialNumber,</div>
<div class="line"><span class="lineno"> 1173</span>                              <span class="stringliteral">&#39;revocationDate&#39;</span>     =&gt; $Time,</div>
<div class="line"><span class="lineno"> 1174</span>                              <span class="stringliteral">&#39;crlEntryExtensions&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1175</span>                                                          <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno"> 1176</span>                                                      ) + $this-&gt;Extensions</div>
<div class="line"><span class="lineno"> 1177</span>                          )</div>
<div class="line"><span class="lineno"> 1178</span>        );</div>
<div class="line"><span class="lineno"> 1179</span> </div>
<div class="line"><span class="lineno"> 1180</span>        $TBSCertList = array(</div>
<div class="line"><span class="lineno"> 1181</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1182</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1183</span>                <span class="stringliteral">&#39;version&#39;</span>             =&gt; array(</div>
<div class="line"><span class="lineno"> 1184</span>                                             <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1185</span>                                             <span class="stringliteral">&#39;default&#39;</span>  =&gt; <span class="stringliteral">&#39;v1&#39;</span></div>
<div class="line"><span class="lineno"> 1186</span>                                         ) + $Version,</div>
<div class="line"><span class="lineno"> 1187</span>                <span class="stringliteral">&#39;signature&#39;</span>           =&gt; $AlgorithmIdentifier,</div>
<div class="line"><span class="lineno"> 1188</span>                <span class="stringliteral">&#39;issuer&#39;</span>              =&gt; $this-&gt;Name,</div>
<div class="line"><span class="lineno"> 1189</span>                <span class="stringliteral">&#39;thisUpdate&#39;</span>          =&gt; $Time,</div>
<div class="line"><span class="lineno"> 1190</span>                <span class="stringliteral">&#39;nextUpdate&#39;</span>          =&gt; array(</div>
<div class="line"><span class="lineno"> 1191</span>                                             <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno"> 1192</span>                                         ) + $Time,</div>
<div class="line"><span class="lineno"> 1193</span>                <span class="stringliteral">&#39;revokedCertificates&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1194</span>                                             <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1195</span>                                             <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1196</span>                                             <span class="stringliteral">&#39;min&#39;</span>      =&gt; 0,</div>
<div class="line"><span class="lineno"> 1197</span>                                             <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno"> 1198</span>                                             <span class="stringliteral">&#39;children&#39;</span> =&gt; $RevokedCertificate</div>
<div class="line"><span class="lineno"> 1199</span>                                         ),</div>
<div class="line"><span class="lineno"> 1200</span>                <span class="stringliteral">&#39;crlExtensions&#39;</span>       =&gt; array(</div>
<div class="line"><span class="lineno"> 1201</span>                                             <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno"> 1202</span>                                             <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1203</span>                                             <span class="stringliteral">&#39;explicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno"> 1204</span>                                         ) + $this-&gt;Extensions</div>
<div class="line"><span class="lineno"> 1205</span>            )</div>
<div class="line"><span class="lineno"> 1206</span>        );</div>
<div class="line"><span class="lineno"> 1207</span> </div>
<div class="line"><span class="lineno"> 1208</span>        $this-&gt;CertificateList = array(</div>
<div class="line"><span class="lineno"> 1209</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1210</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1211</span>                <span class="stringliteral">&#39;tbsCertList&#39;</span>        =&gt; $TBSCertList,</div>
<div class="line"><span class="lineno"> 1212</span>                <span class="stringliteral">&#39;signatureAlgorithm&#39;</span> =&gt; $AlgorithmIdentifier,</div>
<div class="line"><span class="lineno"> 1213</span>                <span class="stringliteral">&#39;signature&#39;</span>          =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>)</div>
<div class="line"><span class="lineno"> 1214</span>            )</div>
<div class="line"><span class="lineno"> 1215</span>        );</div>
<div class="line"><span class="lineno"> 1216</span> </div>
<div class="line"><span class="lineno"> 1217</span>        $this-&gt;CRLNumber = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a9c3b70985b245c865ddf8874cc422ba6">FILE_ASN1_TYPE_INTEGER</a>);</div>
<div class="line"><span class="lineno"> 1218</span> </div>
<div class="line"><span class="lineno"> 1219</span>        $this-&gt;CRLReason = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a96edb7b260fa5df901e8f458cb77064e">FILE_ASN1_TYPE_ENUMERATED</a>,</div>
<div class="line"><span class="lineno"> 1220</span>           <span class="stringliteral">&#39;mapping&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1221</span>                            <span class="stringliteral">&#39;unspecified&#39;</span>,</div>
<div class="line"><span class="lineno"> 1222</span>                            <span class="stringliteral">&#39;keyCompromise&#39;</span>,</div>
<div class="line"><span class="lineno"> 1223</span>                            <span class="stringliteral">&#39;cACompromise&#39;</span>,</div>
<div class="line"><span class="lineno"> 1224</span>                            <span class="stringliteral">&#39;affiliationChanged&#39;</span>,</div>
<div class="line"><span class="lineno"> 1225</span>                            <span class="stringliteral">&#39;superseded&#39;</span>,</div>
<div class="line"><span class="lineno"> 1226</span>                            <span class="stringliteral">&#39;cessationOfOperation&#39;</span>,</div>
<div class="line"><span class="lineno"> 1227</span>                            <span class="stringliteral">&#39;certificateHold&#39;</span>,</div>
<div class="line"><span class="lineno"> 1228</span>                            <span class="comment">// Value 7 is not used.</span></div>
<div class="line"><span class="lineno"> 1229</span>                            8 =&gt; <span class="stringliteral">&#39;removeFromCRL&#39;</span>,</div>
<div class="line"><span class="lineno"> 1230</span>                            <span class="stringliteral">&#39;privilegeWithdrawn&#39;</span>,</div>
<div class="line"><span class="lineno"> 1231</span>                            <span class="stringliteral">&#39;aACompromise&#39;</span></div>
<div class="line"><span class="lineno"> 1232</span>            )</div>
<div class="line"><span class="lineno"> 1233</span>        );</div>
<div class="line"><span class="lineno"> 1234</span> </div>
<div class="line"><span class="lineno"> 1235</span>        $this-&gt;IssuingDistributionPoint = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1236</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1237</span>                <span class="stringliteral">&#39;distributionPoint&#39;</span>          =&gt; array(</div>
<div class="line"><span class="lineno"> 1238</span>                                                    <span class="stringliteral">&#39;constant&#39;</span> =&gt; 0,</div>
<div class="line"><span class="lineno"> 1239</span>                                                    <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1240</span>                                                    <span class="stringliteral">&#39;explicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno"> 1241</span>                                                ) + $DistributionPointName,</div>
<div class="line"><span class="lineno"> 1242</span>                <span class="stringliteral">&#39;onlyContainsUserCerts&#39;</span>      =&gt; array(</div>
<div class="line"><span class="lineno"> 1243</span>                                                    <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a7466606a3e1d863445b1be09b85f1148">FILE_ASN1_TYPE_BOOLEAN</a>,</div>
<div class="line"><span class="lineno"> 1244</span>                                                    <span class="stringliteral">&#39;constant&#39;</span> =&gt; 1,</div>
<div class="line"><span class="lineno"> 1245</span>                                                    <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1246</span>                                                    <span class="stringliteral">&#39;default&#39;</span>  =&gt; <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 1247</span>                                                    <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno"> 1248</span>                                                ),</div>
<div class="line"><span class="lineno"> 1249</span>                <span class="stringliteral">&#39;onlyContainsCACerts&#39;</span>        =&gt; array(</div>
<div class="line"><span class="lineno"> 1250</span>                                                    <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a7466606a3e1d863445b1be09b85f1148">FILE_ASN1_TYPE_BOOLEAN</a>,</div>
<div class="line"><span class="lineno"> 1251</span>                                                    <span class="stringliteral">&#39;constant&#39;</span> =&gt; 2,</div>
<div class="line"><span class="lineno"> 1252</span>                                                    <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1253</span>                                                    <span class="stringliteral">&#39;default&#39;</span>  =&gt; <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 1254</span>                                                    <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno"> 1255</span>                                                ),</div>
<div class="line"><span class="lineno"> 1256</span>                <span class="stringliteral">&#39;onlySomeReasons&#39;</span>           =&gt; array(</div>
<div class="line"><span class="lineno"> 1257</span>                                                    <span class="stringliteral">&#39;constant&#39;</span> =&gt; 3,</div>
<div class="line"><span class="lineno"> 1258</span>                                                    <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1259</span>                                                    <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno"> 1260</span>                                                ) + $ReasonFlags,</div>
<div class="line"><span class="lineno"> 1261</span>                <span class="stringliteral">&#39;indirectCRL&#39;</span>               =&gt; array(</div>
<div class="line"><span class="lineno"> 1262</span>                                                    <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a7466606a3e1d863445b1be09b85f1148">FILE_ASN1_TYPE_BOOLEAN</a>,</div>
<div class="line"><span class="lineno"> 1263</span>                                                    <span class="stringliteral">&#39;constant&#39;</span> =&gt; 4,</div>
<div class="line"><span class="lineno"> 1264</span>                                                    <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1265</span>                                                    <span class="stringliteral">&#39;default&#39;</span>  =&gt; <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 1266</span>                                                    <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno"> 1267</span>                                                ),</div>
<div class="line"><span class="lineno"> 1268</span>                <span class="stringliteral">&#39;onlyContainsAttributeCerts&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1269</span>                                                    <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#a7466606a3e1d863445b1be09b85f1148">FILE_ASN1_TYPE_BOOLEAN</a>,</div>
<div class="line"><span class="lineno"> 1270</span>                                                    <span class="stringliteral">&#39;constant&#39;</span> =&gt; 5,</div>
<div class="line"><span class="lineno"> 1271</span>                                                    <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1272</span>                                                    <span class="stringliteral">&#39;default&#39;</span>  =&gt; <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 1273</span>                                                    <span class="stringliteral">&#39;implicit&#39;</span> =&gt; <span class="keyword">true</span></div>
<div class="line"><span class="lineno"> 1274</span>                                                )</div>
<div class="line"><span class="lineno"> 1275</span>                          )</div>
<div class="line"><span class="lineno"> 1276</span>        );</div>
<div class="line"><span class="lineno"> 1277</span> </div>
<div class="line"><span class="lineno"> 1278</span>        $this-&gt;InvalidityDate = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a8ad0c6d6389ce6c6fb2e633814cbfd42">FILE_ASN1_TYPE_GENERALIZED_TIME</a>);</div>
<div class="line"><span class="lineno"> 1279</span> </div>
<div class="line"><span class="lineno"> 1280</span>        $this-&gt;CertificateIssuer = $GeneralNames;</div>
<div class="line"><span class="lineno"> 1281</span> </div>
<div class="line"><span class="lineno"> 1282</span>        $this-&gt;HoldInstructionCode = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>);</div>
<div class="line"><span class="lineno"> 1283</span> </div>
<div class="line"><span class="lineno"> 1284</span>        $PublicKeyAndChallenge = array(</div>
<div class="line"><span class="lineno"> 1285</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1286</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1287</span>                <span class="stringliteral">&#39;spki&#39;</span>      =&gt; $SubjectPublicKeyInfo,</div>
<div class="line"><span class="lineno"> 1288</span>                <span class="stringliteral">&#39;challenge&#39;</span> =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a>)</div>
<div class="line"><span class="lineno"> 1289</span>            )</div>
<div class="line"><span class="lineno"> 1290</span>        );</div>
<div class="line"><span class="lineno"> 1291</span> </div>
<div class="line"><span class="lineno"> 1292</span>        $this-&gt;SignedPublicKeyAndChallenge = array(</div>
<div class="line"><span class="lineno"> 1293</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1294</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 1295</span>                <span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span> =&gt; $PublicKeyAndChallenge,</div>
<div class="line"><span class="lineno"> 1296</span>                <span class="stringliteral">&#39;signatureAlgorithm&#39;</span>    =&gt; $AlgorithmIdentifier,</div>
<div class="line"><span class="lineno"> 1297</span>                <span class="stringliteral">&#39;signature&#39;</span>             =&gt; array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>)</div>
<div class="line"><span class="lineno"> 1298</span>            )</div>
<div class="line"><span class="lineno"> 1299</span>        );</div>
<div class="line"><span class="lineno"> 1300</span> </div>
<div class="line"><span class="lineno"> 1301</span>        $this-&gt;PostalAddress = array(</div>
<div class="line"><span class="lineno"> 1302</span>            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>,</div>
<div class="line"><span class="lineno"> 1303</span>            <span class="stringliteral">&#39;optional&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1304</span>            <span class="stringliteral">&#39;min&#39;</span>      =&gt; 1,</div>
<div class="line"><span class="lineno"> 1305</span>            <span class="stringliteral">&#39;max&#39;</span>      =&gt; -1,</div>
<div class="line"><span class="lineno"> 1306</span>            <span class="stringliteral">&#39;children&#39;</span> =&gt; $this-&gt;DirectoryString</div>
<div class="line"><span class="lineno"> 1307</span>        );</div>
<div class="line"><span class="lineno"> 1308</span> </div>
<div class="line"><span class="lineno"> 1309</span>        <span class="comment">// OIDs from RFC5280 and those RFCs mentioned in RFC5280#section-4.1.1.2</span></div>
<div class="line"><span class="lineno"> 1310</span>        $this-&gt;oids = array(</div>
<div class="line"><span class="lineno"> 1311</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7&#39;</span> =&gt; <span class="stringliteral">&#39;id-pkix&#39;</span>,</div>
<div class="line"><span class="lineno"> 1312</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.1&#39;</span> =&gt; <span class="stringliteral">&#39;id-pe&#39;</span>,</div>
<div class="line"><span class="lineno"> 1313</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.2&#39;</span> =&gt; <span class="stringliteral">&#39;id-qt&#39;</span>,</div>
<div class="line"><span class="lineno"> 1314</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.3&#39;</span> =&gt; <span class="stringliteral">&#39;id-kp&#39;</span>,</div>
<div class="line"><span class="lineno"> 1315</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.48&#39;</span> =&gt; <span class="stringliteral">&#39;id-ad&#39;</span>,</div>
<div class="line"><span class="lineno"> 1316</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.2.1&#39;</span> =&gt; <span class="stringliteral">&#39;id-qt-cps&#39;</span>,</div>
<div class="line"><span class="lineno"> 1317</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.2.2&#39;</span> =&gt; <span class="stringliteral">&#39;id-qt-unotice&#39;</span>,</div>
<div class="line"><span class="lineno"> 1318</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.48.1&#39;</span> =&gt;<span class="stringliteral">&#39;id-ad-ocsp&#39;</span>,</div>
<div class="line"><span class="lineno"> 1319</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.48.2&#39;</span> =&gt; <span class="stringliteral">&#39;id-ad-caIssuers&#39;</span>,</div>
<div class="line"><span class="lineno"> 1320</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.48.3&#39;</span> =&gt; <span class="stringliteral">&#39;id-ad-timeStamping&#39;</span>,</div>
<div class="line"><span class="lineno"> 1321</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.48.5&#39;</span> =&gt; <span class="stringliteral">&#39;id-ad-caRepository&#39;</span>,</div>
<div class="line"><span class="lineno"> 1322</span>            <span class="stringliteral">&#39;2.5.4&#39;</span> =&gt; <span class="stringliteral">&#39;id-at&#39;</span>,</div>
<div class="line"><span class="lineno"> 1323</span>            <span class="stringliteral">&#39;2.5.4.41&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-name&#39;</span>,</div>
<div class="line"><span class="lineno"> 1324</span>            <span class="stringliteral">&#39;2.5.4.4&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-surname&#39;</span>,</div>
<div class="line"><span class="lineno"> 1325</span>            <span class="stringliteral">&#39;2.5.4.42&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-givenName&#39;</span>,</div>
<div class="line"><span class="lineno"> 1326</span>            <span class="stringliteral">&#39;2.5.4.43&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-initials&#39;</span>,</div>
<div class="line"><span class="lineno"> 1327</span>            <span class="stringliteral">&#39;2.5.4.44&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-generationQualifier&#39;</span>,</div>
<div class="line"><span class="lineno"> 1328</span>            <span class="stringliteral">&#39;2.5.4.3&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-commonName&#39;</span>,</div>
<div class="line"><span class="lineno"> 1329</span>            <span class="stringliteral">&#39;2.5.4.7&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-localityName&#39;</span>,</div>
<div class="line"><span class="lineno"> 1330</span>            <span class="stringliteral">&#39;2.5.4.8&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-stateOrProvinceName&#39;</span>,</div>
<div class="line"><span class="lineno"> 1331</span>            <span class="stringliteral">&#39;2.5.4.10&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-organizationName&#39;</span>,</div>
<div class="line"><span class="lineno"> 1332</span>            <span class="stringliteral">&#39;2.5.4.11&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-organizationalUnitName&#39;</span>,</div>
<div class="line"><span class="lineno"> 1333</span>            <span class="stringliteral">&#39;2.5.4.12&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-title&#39;</span>,</div>
<div class="line"><span class="lineno"> 1334</span>            <span class="stringliteral">&#39;2.5.4.13&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-description&#39;</span>,</div>
<div class="line"><span class="lineno"> 1335</span>            <span class="stringliteral">&#39;2.5.4.46&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-dnQualifier&#39;</span>,</div>
<div class="line"><span class="lineno"> 1336</span>            <span class="stringliteral">&#39;2.5.4.6&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-countryName&#39;</span>,</div>
<div class="line"><span class="lineno"> 1337</span>            <span class="stringliteral">&#39;2.5.4.5&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-serialNumber&#39;</span>,</div>
<div class="line"><span class="lineno"> 1338</span>            <span class="stringliteral">&#39;2.5.4.65&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-pseudonym&#39;</span>,</div>
<div class="line"><span class="lineno"> 1339</span>            <span class="stringliteral">&#39;2.5.4.17&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-postalCode&#39;</span>,</div>
<div class="line"><span class="lineno"> 1340</span>            <span class="stringliteral">&#39;2.5.4.9&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-streetAddress&#39;</span>,</div>
<div class="line"><span class="lineno"> 1341</span>            <span class="stringliteral">&#39;2.5.4.45&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-uniqueIdentifier&#39;</span>,</div>
<div class="line"><span class="lineno"> 1342</span>            <span class="stringliteral">&#39;2.5.4.72&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-role&#39;</span>,</div>
<div class="line"><span class="lineno"> 1343</span>            <span class="stringliteral">&#39;2.5.4.16&#39;</span> =&gt; <span class="stringliteral">&#39;id-at-postalAddress&#39;</span>,</div>
<div class="line"><span class="lineno"> 1344</span> </div>
<div class="line"><span class="lineno"> 1345</span>            <span class="stringliteral">&#39;0.9.2342.19200300.100.1.25&#39;</span> =&gt; <span class="stringliteral">&#39;id-domainComponent&#39;</span>,</div>
<div class="line"><span class="lineno"> 1346</span>            <span class="stringliteral">&#39;1.2.840.113549.1.9&#39;</span> =&gt; <span class="stringliteral">&#39;pkcs-9&#39;</span>,</div>
<div class="line"><span class="lineno"> 1347</span>            <span class="stringliteral">&#39;1.2.840.113549.1.9.1&#39;</span> =&gt; <span class="stringliteral">&#39;pkcs-9-at-emailAddress&#39;</span>,</div>
<div class="line"><span class="lineno"> 1348</span>            <span class="stringliteral">&#39;2.5.29&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce&#39;</span>,</div>
<div class="line"><span class="lineno"> 1349</span>            <span class="stringliteral">&#39;2.5.29.35&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-authorityKeyIdentifier&#39;</span>,</div>
<div class="line"><span class="lineno"> 1350</span>            <span class="stringliteral">&#39;2.5.29.14&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-subjectKeyIdentifier&#39;</span>,</div>
<div class="line"><span class="lineno"> 1351</span>            <span class="stringliteral">&#39;2.5.29.15&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-keyUsage&#39;</span>,</div>
<div class="line"><span class="lineno"> 1352</span>            <span class="stringliteral">&#39;2.5.29.16&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-privateKeyUsagePeriod&#39;</span>,</div>
<div class="line"><span class="lineno"> 1353</span>            <span class="stringliteral">&#39;2.5.29.32&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-certificatePolicies&#39;</span>,</div>
<div class="line"><span class="lineno"> 1354</span>            <span class="stringliteral">&#39;2.5.29.32.0&#39;</span> =&gt; <span class="stringliteral">&#39;anyPolicy&#39;</span>,</div>
<div class="line"><span class="lineno"> 1355</span> </div>
<div class="line"><span class="lineno"> 1356</span>            <span class="stringliteral">&#39;2.5.29.33&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-policyMappings&#39;</span>,</div>
<div class="line"><span class="lineno"> 1357</span>            <span class="stringliteral">&#39;2.5.29.17&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-subjectAltName&#39;</span>,</div>
<div class="line"><span class="lineno"> 1358</span>            <span class="stringliteral">&#39;2.5.29.18&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-issuerAltName&#39;</span>,</div>
<div class="line"><span class="lineno"> 1359</span>            <span class="stringliteral">&#39;2.5.29.9&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-subjectDirectoryAttributes&#39;</span>,</div>
<div class="line"><span class="lineno"> 1360</span>            <span class="stringliteral">&#39;2.5.29.19&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-basicConstraints&#39;</span>,</div>
<div class="line"><span class="lineno"> 1361</span>            <span class="stringliteral">&#39;2.5.29.30&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-nameConstraints&#39;</span>,</div>
<div class="line"><span class="lineno"> 1362</span>            <span class="stringliteral">&#39;2.5.29.36&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-policyConstraints&#39;</span>,</div>
<div class="line"><span class="lineno"> 1363</span>            <span class="stringliteral">&#39;2.5.29.31&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-cRLDistributionPoints&#39;</span>,</div>
<div class="line"><span class="lineno"> 1364</span>            <span class="stringliteral">&#39;2.5.29.37&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-extKeyUsage&#39;</span>,</div>
<div class="line"><span class="lineno"> 1365</span>            <span class="stringliteral">&#39;2.5.29.37.0&#39;</span> =&gt; <span class="stringliteral">&#39;anyExtendedKeyUsage&#39;</span>,</div>
<div class="line"><span class="lineno"> 1366</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.3.1&#39;</span> =&gt; <span class="stringliteral">&#39;id-kp-serverAuth&#39;</span>,</div>
<div class="line"><span class="lineno"> 1367</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.3.2&#39;</span> =&gt; <span class="stringliteral">&#39;id-kp-clientAuth&#39;</span>,</div>
<div class="line"><span class="lineno"> 1368</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.3.3&#39;</span> =&gt; <span class="stringliteral">&#39;id-kp-codeSigning&#39;</span>,</div>
<div class="line"><span class="lineno"> 1369</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.3.4&#39;</span> =&gt; <span class="stringliteral">&#39;id-kp-emailProtection&#39;</span>,</div>
<div class="line"><span class="lineno"> 1370</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.3.8&#39;</span> =&gt; <span class="stringliteral">&#39;id-kp-timeStamping&#39;</span>,</div>
<div class="line"><span class="lineno"> 1371</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.3.9&#39;</span> =&gt; <span class="stringliteral">&#39;id-kp-OCSPSigning&#39;</span>,</div>
<div class="line"><span class="lineno"> 1372</span>            <span class="stringliteral">&#39;2.5.29.54&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-inhibitAnyPolicy&#39;</span>,</div>
<div class="line"><span class="lineno"> 1373</span>            <span class="stringliteral">&#39;2.5.29.46&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-freshestCRL&#39;</span>,</div>
<div class="line"><span class="lineno"> 1374</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.1.1&#39;</span> =&gt; <span class="stringliteral">&#39;id-pe-authorityInfoAccess&#39;</span>,</div>
<div class="line"><span class="lineno"> 1375</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.1.11&#39;</span> =&gt; <span class="stringliteral">&#39;id-pe-subjectInfoAccess&#39;</span>,</div>
<div class="line"><span class="lineno"> 1376</span>            <span class="stringliteral">&#39;2.5.29.20&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-cRLNumber&#39;</span>,</div>
<div class="line"><span class="lineno"> 1377</span>            <span class="stringliteral">&#39;2.5.29.28&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-issuingDistributionPoint&#39;</span>,</div>
<div class="line"><span class="lineno"> 1378</span>            <span class="stringliteral">&#39;2.5.29.27&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-deltaCRLIndicator&#39;</span>,</div>
<div class="line"><span class="lineno"> 1379</span>            <span class="stringliteral">&#39;2.5.29.21&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-cRLReasons&#39;</span>,</div>
<div class="line"><span class="lineno"> 1380</span>            <span class="stringliteral">&#39;2.5.29.29&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-certificateIssuer&#39;</span>,</div>
<div class="line"><span class="lineno"> 1381</span>            <span class="stringliteral">&#39;2.5.29.23&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-holdInstructionCode&#39;</span>,</div>
<div class="line"><span class="lineno"> 1382</span>            <span class="stringliteral">&#39;1.2.840.10040.2&#39;</span> =&gt; <span class="stringliteral">&#39;holdInstruction&#39;</span>,</div>
<div class="line"><span class="lineno"> 1383</span>            <span class="stringliteral">&#39;1.2.840.10040.2.1&#39;</span> =&gt; <span class="stringliteral">&#39;id-holdinstruction-none&#39;</span>,</div>
<div class="line"><span class="lineno"> 1384</span>            <span class="stringliteral">&#39;1.2.840.10040.2.2&#39;</span> =&gt; <span class="stringliteral">&#39;id-holdinstruction-callissuer&#39;</span>,</div>
<div class="line"><span class="lineno"> 1385</span>            <span class="stringliteral">&#39;1.2.840.10040.2.3&#39;</span> =&gt; <span class="stringliteral">&#39;id-holdinstruction-reject&#39;</span>,</div>
<div class="line"><span class="lineno"> 1386</span>            <span class="stringliteral">&#39;2.5.29.24&#39;</span> =&gt; <span class="stringliteral">&#39;id-ce-invalidityDate&#39;</span>,</div>
<div class="line"><span class="lineno"> 1387</span> </div>
<div class="line"><span class="lineno"> 1388</span>            <span class="stringliteral">&#39;1.2.840.113549.2.2&#39;</span> =&gt; <span class="stringliteral">&#39;md2&#39;</span>,</div>
<div class="line"><span class="lineno"> 1389</span>            <span class="stringliteral">&#39;1.2.840.113549.2.5&#39;</span> =&gt; <span class="stringliteral">&#39;md5&#39;</span>,</div>
<div class="line"><span class="lineno"> 1390</span>            <span class="stringliteral">&#39;1.3.14.3.2.26&#39;</span> =&gt; <span class="stringliteral">&#39;id-sha1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1391</span>            <span class="stringliteral">&#39;1.2.840.10040.4.1&#39;</span> =&gt; <span class="stringliteral">&#39;id-dsa&#39;</span>,</div>
<div class="line"><span class="lineno"> 1392</span>            <span class="stringliteral">&#39;1.2.840.10040.4.3&#39;</span> =&gt; <span class="stringliteral">&#39;id-dsa-with-sha1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1393</span>            <span class="stringliteral">&#39;1.2.840.113549.1.1&#39;</span> =&gt; <span class="stringliteral">&#39;pkcs-1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1394</span>            <span class="stringliteral">&#39;1.2.840.113549.1.1.1&#39;</span> =&gt; <span class="stringliteral">&#39;rsaEncryption&#39;</span>,</div>
<div class="line"><span class="lineno"> 1395</span>            <span class="stringliteral">&#39;1.2.840.113549.1.1.2&#39;</span> =&gt; <span class="stringliteral">&#39;md2WithRSAEncryption&#39;</span>,</div>
<div class="line"><span class="lineno"> 1396</span>            <span class="stringliteral">&#39;1.2.840.113549.1.1.4&#39;</span> =&gt; <span class="stringliteral">&#39;md5WithRSAEncryption&#39;</span>,</div>
<div class="line"><span class="lineno"> 1397</span>            <span class="stringliteral">&#39;1.2.840.113549.1.1.5&#39;</span> =&gt; <span class="stringliteral">&#39;sha1WithRSAEncryption&#39;</span>,</div>
<div class="line"><span class="lineno"> 1398</span>            <span class="stringliteral">&#39;1.2.840.10046.2.1&#39;</span> =&gt; <span class="stringliteral">&#39;dhpublicnumber&#39;</span>,</div>
<div class="line"><span class="lineno"> 1399</span>            <span class="stringliteral">&#39;2.16.840.1.101.2.1.1.22&#39;</span> =&gt; <span class="stringliteral">&#39;id-keyExchangeAlgorithm&#39;</span>,</div>
<div class="line"><span class="lineno"> 1400</span>            <span class="stringliteral">&#39;1.2.840.10045&#39;</span> =&gt; <span class="stringliteral">&#39;ansi-X9-62&#39;</span>,</div>
<div class="line"><span class="lineno"> 1401</span>            <span class="stringliteral">&#39;1.2.840.10045.4&#39;</span> =&gt; <span class="stringliteral">&#39;id-ecSigType&#39;</span>,</div>
<div class="line"><span class="lineno"> 1402</span>            <span class="stringliteral">&#39;1.2.840.10045.4.1&#39;</span> =&gt; <span class="stringliteral">&#39;ecdsa-with-SHA1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1403</span>            <span class="stringliteral">&#39;1.2.840.10045.1&#39;</span> =&gt; <span class="stringliteral">&#39;id-fieldType&#39;</span>,</div>
<div class="line"><span class="lineno"> 1404</span>            <span class="stringliteral">&#39;1.2.840.10045.1.1&#39;</span> =&gt; <span class="stringliteral">&#39;prime-field&#39;</span>,</div>
<div class="line"><span class="lineno"> 1405</span>            <span class="stringliteral">&#39;1.2.840.10045.1.2&#39;</span> =&gt; <span class="stringliteral">&#39;characteristic-two-field&#39;</span>,</div>
<div class="line"><span class="lineno"> 1406</span>            <span class="stringliteral">&#39;1.2.840.10045.1.2.3&#39;</span> =&gt; <span class="stringliteral">&#39;id-characteristic-two-basis&#39;</span>,</div>
<div class="line"><span class="lineno"> 1407</span>            <span class="stringliteral">&#39;1.2.840.10045.1.2.3.1&#39;</span> =&gt; <span class="stringliteral">&#39;gnBasis&#39;</span>,</div>
<div class="line"><span class="lineno"> 1408</span>            <span class="stringliteral">&#39;1.2.840.10045.1.2.3.2&#39;</span> =&gt; <span class="stringliteral">&#39;tpBasis&#39;</span>,</div>
<div class="line"><span class="lineno"> 1409</span>            <span class="stringliteral">&#39;1.2.840.10045.1.2.3.3&#39;</span> =&gt; <span class="stringliteral">&#39;ppBasis&#39;</span>,</div>
<div class="line"><span class="lineno"> 1410</span>            <span class="stringliteral">&#39;1.2.840.10045.2&#39;</span> =&gt; <span class="stringliteral">&#39;id-publicKeyType&#39;</span>,</div>
<div class="line"><span class="lineno"> 1411</span>            <span class="stringliteral">&#39;1.2.840.10045.2.1&#39;</span> =&gt; <span class="stringliteral">&#39;id-ecPublicKey&#39;</span>,</div>
<div class="line"><span class="lineno"> 1412</span>            <span class="stringliteral">&#39;1.2.840.10045.3&#39;</span> =&gt; <span class="stringliteral">&#39;ellipticCurve&#39;</span>,</div>
<div class="line"><span class="lineno"> 1413</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0&#39;</span> =&gt; <span class="stringliteral">&#39;c-TwoCurve&#39;</span>,</div>
<div class="line"><span class="lineno"> 1414</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.1&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb163v1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1415</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.2&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb163v2&#39;</span>,</div>
<div class="line"><span class="lineno"> 1416</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.3&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb163v3&#39;</span>,</div>
<div class="line"><span class="lineno"> 1417</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.4&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb176w1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1418</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.5&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb191v1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1419</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.6&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb191v2&#39;</span>,</div>
<div class="line"><span class="lineno"> 1420</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.7&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb191v3&#39;</span>,</div>
<div class="line"><span class="lineno"> 1421</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.8&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb191v4&#39;</span>,</div>
<div class="line"><span class="lineno"> 1422</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.9&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb191v5&#39;</span>,</div>
<div class="line"><span class="lineno"> 1423</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.10&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb208w1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1424</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.11&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb239v1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1425</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.12&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb239v2&#39;</span>,</div>
<div class="line"><span class="lineno"> 1426</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.13&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb239v3&#39;</span>,</div>
<div class="line"><span class="lineno"> 1427</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.14&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb239v4&#39;</span>,</div>
<div class="line"><span class="lineno"> 1428</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.15&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb239v5&#39;</span>,</div>
<div class="line"><span class="lineno"> 1429</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.16&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb272w1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1430</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.17&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb304w1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1431</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.18&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb359v1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1432</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.19&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb368w1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1433</span>            <span class="stringliteral">&#39;1.2.840.10045.3.0.20&#39;</span> =&gt; <span class="stringliteral">&#39;c2pnb431r1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1434</span>            <span class="stringliteral">&#39;1.2.840.10045.3.1&#39;</span> =&gt; <span class="stringliteral">&#39;primeCurve&#39;</span>,</div>
<div class="line"><span class="lineno"> 1435</span>            <span class="stringliteral">&#39;1.2.840.10045.3.1.1&#39;</span> =&gt; <span class="stringliteral">&#39;prime192v1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1436</span>            <span class="stringliteral">&#39;1.2.840.10045.3.1.2&#39;</span> =&gt; <span class="stringliteral">&#39;prime192v2&#39;</span>,</div>
<div class="line"><span class="lineno"> 1437</span>            <span class="stringliteral">&#39;1.2.840.10045.3.1.3&#39;</span> =&gt; <span class="stringliteral">&#39;prime192v3&#39;</span>,</div>
<div class="line"><span class="lineno"> 1438</span>            <span class="stringliteral">&#39;1.2.840.10045.3.1.4&#39;</span> =&gt; <span class="stringliteral">&#39;prime239v1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1439</span>            <span class="stringliteral">&#39;1.2.840.10045.3.1.5&#39;</span> =&gt; <span class="stringliteral">&#39;prime239v2&#39;</span>,</div>
<div class="line"><span class="lineno"> 1440</span>            <span class="stringliteral">&#39;1.2.840.10045.3.1.6&#39;</span> =&gt; <span class="stringliteral">&#39;prime239v3&#39;</span>,</div>
<div class="line"><span class="lineno"> 1441</span>            <span class="stringliteral">&#39;1.2.840.10045.3.1.7&#39;</span> =&gt; <span class="stringliteral">&#39;prime256v1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1442</span>            <span class="stringliteral">&#39;1.2.840.113549.1.1.7&#39;</span> =&gt; <span class="stringliteral">&#39;id-RSAES-OAEP&#39;</span>,</div>
<div class="line"><span class="lineno"> 1443</span>            <span class="stringliteral">&#39;1.2.840.113549.1.1.9&#39;</span> =&gt; <span class="stringliteral">&#39;id-pSpecified&#39;</span>,</div>
<div class="line"><span class="lineno"> 1444</span>            <span class="stringliteral">&#39;1.2.840.113549.1.1.10&#39;</span> =&gt; <span class="stringliteral">&#39;id-RSASSA-PSS&#39;</span>,</div>
<div class="line"><span class="lineno"> 1445</span>            <span class="stringliteral">&#39;1.2.840.113549.1.1.8&#39;</span> =&gt; <span class="stringliteral">&#39;id-mgf1&#39;</span>,</div>
<div class="line"><span class="lineno"> 1446</span>            <span class="stringliteral">&#39;1.2.840.113549.1.1.14&#39;</span> =&gt; <span class="stringliteral">&#39;sha224WithRSAEncryption&#39;</span>,</div>
<div class="line"><span class="lineno"> 1447</span>            <span class="stringliteral">&#39;1.2.840.113549.1.1.11&#39;</span> =&gt; <span class="stringliteral">&#39;sha256WithRSAEncryption&#39;</span>,</div>
<div class="line"><span class="lineno"> 1448</span>            <span class="stringliteral">&#39;1.2.840.113549.1.1.12&#39;</span> =&gt; <span class="stringliteral">&#39;sha384WithRSAEncryption&#39;</span>,</div>
<div class="line"><span class="lineno"> 1449</span>            <span class="stringliteral">&#39;1.2.840.113549.1.1.13&#39;</span> =&gt; <span class="stringliteral">&#39;sha512WithRSAEncryption&#39;</span>,</div>
<div class="line"><span class="lineno"> 1450</span>            <span class="stringliteral">&#39;2.16.840.1.101.3.4.2.4&#39;</span> =&gt; <span class="stringliteral">&#39;id-sha224&#39;</span>,</div>
<div class="line"><span class="lineno"> 1451</span>            <span class="stringliteral">&#39;2.16.840.1.101.3.4.2.1&#39;</span> =&gt; <span class="stringliteral">&#39;id-sha256&#39;</span>,</div>
<div class="line"><span class="lineno"> 1452</span>            <span class="stringliteral">&#39;2.16.840.1.101.3.4.2.2&#39;</span> =&gt; <span class="stringliteral">&#39;id-sha384&#39;</span>,</div>
<div class="line"><span class="lineno"> 1453</span>            <span class="stringliteral">&#39;2.16.840.1.101.3.4.2.3&#39;</span> =&gt; <span class="stringliteral">&#39;id-sha512&#39;</span>,</div>
<div class="line"><span class="lineno"> 1454</span>            <span class="stringliteral">&#39;1.2.643.2.2.4&#39;</span> =&gt; <span class="stringliteral">&#39;id-GostR3411-94-with-GostR3410-94&#39;</span>,</div>
<div class="line"><span class="lineno"> 1455</span>            <span class="stringliteral">&#39;1.2.643.2.2.3&#39;</span> =&gt; <span class="stringliteral">&#39;id-GostR3411-94-with-GostR3410-2001&#39;</span>,</div>
<div class="line"><span class="lineno"> 1456</span>            <span class="stringliteral">&#39;1.2.643.2.2.20&#39;</span> =&gt; <span class="stringliteral">&#39;id-GostR3410-2001&#39;</span>,</div>
<div class="line"><span class="lineno"> 1457</span>            <span class="stringliteral">&#39;1.2.643.2.2.19&#39;</span> =&gt; <span class="stringliteral">&#39;id-GostR3410-94&#39;</span>,</div>
<div class="line"><span class="lineno"> 1458</span>            <span class="comment">// Netscape Object Identifiers from &quot;Netscape Certificate Extensions&quot;</span></div>
<div class="line"><span class="lineno"> 1459</span>            <span class="stringliteral">&#39;2.16.840.1.113730&#39;</span> =&gt; <span class="stringliteral">&#39;netscape&#39;</span>,</div>
<div class="line"><span class="lineno"> 1460</span>            <span class="stringliteral">&#39;2.16.840.1.113730.1&#39;</span> =&gt; <span class="stringliteral">&#39;netscape-cert-extension&#39;</span>,</div>
<div class="line"><span class="lineno"> 1461</span>            <span class="stringliteral">&#39;2.16.840.1.113730.1.1&#39;</span> =&gt; <span class="stringliteral">&#39;netscape-cert-type&#39;</span>,</div>
<div class="line"><span class="lineno"> 1462</span>            <span class="stringliteral">&#39;2.16.840.1.113730.1.13&#39;</span> =&gt; <span class="stringliteral">&#39;netscape-comment&#39;</span>,</div>
<div class="line"><span class="lineno"> 1463</span>            <span class="stringliteral">&#39;2.16.840.1.113730.1.8&#39;</span> =&gt; <span class="stringliteral">&#39;netscape-ca-policy-url&#39;</span>,</div>
<div class="line"><span class="lineno"> 1464</span>            <span class="comment">// the following are X.509 extensions not supported by phpseclib</span></div>
<div class="line"><span class="lineno"> 1465</span>            <span class="stringliteral">&#39;1.3.6.1.5.5.7.1.12&#39;</span> =&gt; <span class="stringliteral">&#39;id-pe-logotype&#39;</span>,</div>
<div class="line"><span class="lineno"> 1466</span>            <span class="stringliteral">&#39;1.2.840.113533.7.65.0&#39;</span> =&gt; <span class="stringliteral">&#39;entrustVersInfo&#39;</span>,</div>
<div class="line"><span class="lineno"> 1467</span>            <span class="stringliteral">&#39;2.16.840.1.113733.1.6.9&#39;</span> =&gt; <span class="stringliteral">&#39;verisignPrivate&#39;</span>,</div>
<div class="line"><span class="lineno"> 1468</span>            <span class="comment">// for Certificate Signing Requests</span></div>
<div class="line"><span class="lineno"> 1469</span>            <span class="comment">// see http://tools.ietf.org/html/rfc2985</span></div>
<div class="line"><span class="lineno"> 1470</span>            <span class="stringliteral">&#39;1.2.840.113549.1.9.2&#39;</span> =&gt; <span class="stringliteral">&#39;pkcs-9-at-unstructuredName&#39;</span>, <span class="comment">// PKCS #9 unstructured name</span></div>
<div class="line"><span class="lineno"> 1471</span>            <span class="stringliteral">&#39;1.2.840.113549.1.9.7&#39;</span> =&gt; <span class="stringliteral">&#39;pkcs-9-at-challengePassword&#39;</span>, <span class="comment">// Challenge password for certificate revocations</span></div>
<div class="line"><span class="lineno"> 1472</span>            <span class="stringliteral">&#39;1.2.840.113549.1.9.14&#39;</span> =&gt; <span class="stringliteral">&#39;pkcs-9-at-extensionRequest&#39;</span> <span class="comment">// Certificate extension request</span></div>
<div class="line"><span class="lineno"> 1473</span>        );</div>
<div class="line"><span class="lineno"> 1474</span>    }</div>
<div class="ttc" id="aASN1_8php_html_a1e4134ec1b734779403a8550d41954a3"><div class="ttname"><a href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_BIT_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00062">ASN1.php:62</a></div></div>
<div class="ttc" id="aASN1_8php_html_a277c7aa24346ee34aa14506cc313afcb"><div class="ttname"><a href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_PRINTABLE_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00083">ASN1.php:83</a></div></div>
<div class="ttc" id="aASN1_8php_html_a477ddacad6f9ad4803fdbbc0d6c80be8"><div class="ttname"><a href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a></div><div class="ttdeci">const FILE_ASN1_TYPE_CHOICE</div><div class="ttdoc">#-</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00104">ASN1.php:104</a></div></div>
<div class="ttc" id="aASN1_8php_html_a5301a15003ac88ef62b1b097a8f99e8b"><div class="ttname"><a href="ASN1_8php.html#a5301a15003ac88ef62b1b097a8f99e8b">FILE_ASN1_TYPE_VISIBLE_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_VISIBLE_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00090">ASN1.php:90</a></div></div>
<div class="ttc" id="aASN1_8php_html_a5cbfd497aefacbfc5766e0b266022fc2"><div class="ttname"><a href="ASN1_8php.html#a5cbfd497aefacbfc5766e0b266022fc2">FILE_ASN1_TYPE_OCTET_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_OCTET_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00063">ASN1.php:63</a></div></div>
<div class="ttc" id="aASN1_8php_html_a5f903ee9a5fc70fcbff1af967c53083b"><div class="ttname"><a href="ASN1_8php.html#a5f903ee9a5fc70fcbff1af967c53083b">FILE_ASN1_TYPE_TELETEX_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_TELETEX_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00084">ASN1.php:84</a></div></div>
<div class="ttc" id="aASN1_8php_html_a7466606a3e1d863445b1be09b85f1148"><div class="ttname"><a href="ASN1_8php.html#a7466606a3e1d863445b1be09b85f1148">FILE_ASN1_TYPE_BOOLEAN</a></div><div class="ttdeci">const FILE_ASN1_TYPE_BOOLEAN</div><div class="ttdoc">#-</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00060">ASN1.php:60</a></div></div>
<div class="ttc" id="aASN1_8php_html_a77bc62de1f11def34ebec1b8ef064baf"><div class="ttname"><a href="ASN1_8php.html#a77bc62de1f11def34ebec1b8ef064baf">FILE_ASN1_CLASS_APPLICATION</a></div><div class="ttdeci">const FILE_ASN1_CLASS_APPLICATION</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00049">ASN1.php:49</a></div></div>
<div class="ttc" id="aASN1_8php_html_a842b61be906cf8882ae9b54a974231ba"><div class="ttname"><a href="ASN1_8php.html#a842b61be906cf8882ae9b54a974231ba">FILE_ASN1_TYPE_UTC_TIME</a></div><div class="ttdeci">const FILE_ASN1_TYPE_UTC_TIME</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00087">ASN1.php:87</a></div></div>
<div class="ttc" id="aASN1_8php_html_a8ad0c6d6389ce6c6fb2e633814cbfd42"><div class="ttname"><a href="ASN1_8php.html#a8ad0c6d6389ce6c6fb2e633814cbfd42">FILE_ASN1_TYPE_GENERALIZED_TIME</a></div><div class="ttdeci">const FILE_ASN1_TYPE_GENERALIZED_TIME</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00088">ASN1.php:88</a></div></div>
<div class="ttc" id="aASN1_8php_html_a8ed0e0a9293f9159b5de750e34b86652"><div class="ttname"><a href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a></div><div class="ttdeci">const FILE_ASN1_TYPE_OBJECT_IDENTIFIER</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00065">ASN1.php:65</a></div></div>
<div class="ttc" id="aASN1_8php_html_a96290e3bf3e87b630bc435b0beac8582"><div class="ttname"><a href="ASN1_8php.html#a96290e3bf3e87b630bc435b0beac8582">FILE_ASN1_TYPE_ANY</a></div><div class="ttdeci">const FILE_ASN1_TYPE_ANY</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00105">ASN1.php:105</a></div></div>
<div class="ttc" id="aASN1_8php_html_a96edb7b260fa5df901e8f458cb77064e"><div class="ttname"><a href="ASN1_8php.html#a96edb7b260fa5df901e8f458cb77064e">FILE_ASN1_TYPE_ENUMERATED</a></div><div class="ttdeci">const FILE_ASN1_TYPE_ENUMERATED</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00069">ASN1.php:69</a></div></div>
<div class="ttc" id="aASN1_8php_html_a9c3b70985b245c865ddf8874cc422ba6"><div class="ttname"><a href="ASN1_8php.html#a9c3b70985b245c865ddf8874cc422ba6">FILE_ASN1_TYPE_INTEGER</a></div><div class="ttdeci">const FILE_ASN1_TYPE_INTEGER</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00061">ASN1.php:61</a></div></div>
<div class="ttc" id="aASN1_8php_html_aa07c8f79dd12c23a3e688d9feba544ab"><div class="ttname"><a href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_UTF8_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00071">ASN1.php:71</a></div></div>
<div class="ttc" id="aASN1_8php_html_ab1428335844d52e212845bb286190cae"><div class="ttname"><a href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a></div><div class="ttdeci">const FILE_ASN1_TYPE_SEQUENCE</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00073">ASN1.php:73</a></div></div>
<div class="ttc" id="aASN1_8php_html_ac823a955a2086f2f57d56ce1de9eab01"><div class="ttname"><a href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_IA5_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00086">ASN1.php:86</a></div></div>
<div class="ttc" id="aASN1_8php_html_ade866784098f01a9cb1e6901dec0bfca"><div class="ttname"><a href="ASN1_8php.html#ade866784098f01a9cb1e6901dec0bfca">FILE_ASN1_TYPE_SET</a></div><div class="ttdeci">const FILE_ASN1_TYPE_SET</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00074">ASN1.php:74</a></div></div>
<div class="ttc" id="aASN1_8php_html_ae7f15dadff8bafe3f5268f472bd1253d"><div class="ttname"><a href="ASN1_8php.html#ae7f15dadff8bafe3f5268f472bd1253d">FILE_ASN1_TYPE_UNIVERSAL_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_UNIVERSAL_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00092">ASN1.php:92</a></div></div>
<div class="ttc" id="aASN1_8php_html_af269bb1254bc4f65a21327c39530c0eb"><div class="ttname"><a href="ASN1_8php.html#af269bb1254bc4f65a21327c39530c0eb">FILE_ASN1_TYPE_NUMERIC_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_NUMERIC_STRING</div><div class="ttdoc">#-</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00082">ASN1.php:82</a></div></div>
<div class="ttc" id="aASN1_8php_html_afae5a2a5df49e80953c2bb088f9ce8fb"><div class="ttname"><a href="ASN1_8php.html#afae5a2a5df49e80953c2bb088f9ce8fb">FILE_ASN1_TYPE_BMP_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_BMP_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00094">ASN1.php:94</a></div></div>
<div class="ttc" id="ainstall_8php_html_a1cf4c1ce4d54df11a660775bb7c5bbd8"><div class="ttname"><a href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a></div><div class="ttdeci">$VIEW_PATH</div><div class="ttdef"><b>Definition:</b> <a href="install_8php_source.html#l00039">install.php:39</a></div></div>
<div class="ttc" id="anamespaceMath__BigInteger_html"><div class="ttname"><a href="namespaceMath__BigInteger.html">Math_BigInteger</a></div><div class="ttdoc">Pure-PHP arbitrary precision integer arithmetic library.</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="install_8php_source.html#l00039">$VIEW_PATH</a>, <a class="el" href="ASN1_8php_source.html#l00049">FILE_ASN1_CLASS_APPLICATION</a>, <a class="el" href="ASN1_8php_source.html#l00105">FILE_ASN1_TYPE_ANY</a>, <a class="el" href="ASN1_8php_source.html#l00062">FILE_ASN1_TYPE_BIT_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00094">FILE_ASN1_TYPE_BMP_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00060">FILE_ASN1_TYPE_BOOLEAN</a>, <a class="el" href="ASN1_8php_source.html#l00104">FILE_ASN1_TYPE_CHOICE</a>, <a class="el" href="ASN1_8php_source.html#l00069">FILE_ASN1_TYPE_ENUMERATED</a>, <a class="el" href="ASN1_8php_source.html#l00088">FILE_ASN1_TYPE_GENERALIZED_TIME</a>, <a class="el" href="ASN1_8php_source.html#l00086">FILE_ASN1_TYPE_IA5_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00061">FILE_ASN1_TYPE_INTEGER</a>, <a class="el" href="ASN1_8php_source.html#l00082">FILE_ASN1_TYPE_NUMERIC_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00065">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>, <a class="el" href="ASN1_8php_source.html#l00063">FILE_ASN1_TYPE_OCTET_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00083">FILE_ASN1_TYPE_PRINTABLE_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00073">FILE_ASN1_TYPE_SEQUENCE</a>, <a class="el" href="ASN1_8php_source.html#l00074">FILE_ASN1_TYPE_SET</a>, <a class="el" href="ASN1_8php_source.html#l00084">FILE_ASN1_TYPE_TELETEX_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00092">FILE_ASN1_TYPE_UNIVERSAL_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00087">FILE_ASN1_TYPE_UTC_TIME</a>, <a class="el" href="ASN1_8php_source.html#l00071">FILE_ASN1_TYPE_UTF8_STRING</a>, and <a class="el" href="ASN1_8php_source.html#l00090">FILE_ASN1_TYPE_VISIBLE_STRING</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l01482">File_X509()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a095c5d389db211932136b53f25f39685_icgraph.png" border="0" usemap="#aclassFile__X509_a095c5d389db211932136b53f25f39685_icgraph" alt=""/></div>
<map name="aclassFile__X509_a095c5d389db211932136b53f25f39685_icgraph" id="aclassFile__X509_a095c5d389db211932136b53f25f39685_icgraph">
<area shape="rect" title="Default Constructor." alt="" coords="139,5,235,31"/>
<area shape="rect" href="classFile__X509.html#a0b796f253d10daa33c4efe72256cb623" title="PHP4 compatible Default Constructor." alt="" coords="5,5,91,31"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9faa954720f1e07428b6fdbb6224b715" name="a9faa954720f1e07428b6fdbb6224b715"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9faa954720f1e07428b6fdbb6224b715">&#9670;&#160;</a></span>_decodeIP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_decodeIP </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decodes an IP address. </p>
<p>Takes in a base64 encoded "blob" and returns a human readable IP address</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$ip</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02571">2571</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2572</span>    {</div>
<div class="line"><span class="lineno"> 2573</span>        $ip = base64_decode($ip);</div>
<div class="line"><span class="lineno"> 2574</span>        list(, $ip) = unpack(<span class="charliteral">&#39;N&#39;</span>, $ip);</div>
<div class="line"><span class="lineno"> 2575</span>        <span class="keywordflow">return</span> long2ip($ip);</div>
<div class="line"><span class="lineno"> 2576</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2dc40504ca91b6ec6dc2e674cc4bd867" name="a2dc40504ca91b6ec6dc2e674cc4bd867"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dc40504ca91b6ec6dc2e674cc4bd867">&#9670;&#160;</a></span>_decodeNameConstraintIP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_decodeNameConstraintIP </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decodes an IP address in a name constraints extension. </p>
<p>Takes in a base64 encoded "blob" and returns a human readable IP address / mask</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$ip</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02587">2587</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2588</span>    {</div>
<div class="line"><span class="lineno"> 2589</span>        $ip = base64_decode($ip);</div>
<div class="line"><span class="lineno"> 2590</span>        list(, $ip, $mask) = unpack(<span class="stringliteral">&#39;N2&#39;</span>, $ip);</div>
<div class="line"><span class="lineno"> 2591</span>        <span class="keywordflow">return</span> array(long2ip($ip), long2ip($mask));</div>
<div class="line"><span class="lineno"> 2592</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa392681095261b3594bb8b92462f3e86" name="aa392681095261b3594bb8b92462f3e86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa392681095261b3594bb8b92462f3e86">&#9670;&#160;</a></span>_dnsName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_dnsName </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$domain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper function to build domain array. </p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$domain</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04905">4905</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4906</span>    {</div>
<div class="line"><span class="lineno"> 4907</span>        <span class="keywordflow">return</span> array(<span class="stringliteral">&#39;dNSName&#39;</span> =&gt; $domain);</div>
<div class="line"><span class="lineno"> 4908</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae20088641fbf9d929ca9239ad6fb9738" name="ae20088641fbf9d929ca9239ad6fb9738"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae20088641fbf9d929ca9239ad6fb9738">&#9670;&#160;</a></span>_encodeIP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_encodeIP </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encodes an IP address. </p>
<p>Takes a human readable IP address into a base64-encoded "blob"</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string&#160;|&#160;array</td><td class="paramname">$ip</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02603">2603</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2604</span>    {</div>
<div class="line"><span class="lineno"> 2605</span>        <span class="keywordflow">return</span> is_string($ip) ?</div>
<div class="line"><span class="lineno"> 2606</span>            base64_encode(pack(<span class="charliteral">&#39;N&#39;</span>, ip2long($ip))) :</div>
<div class="line"><span class="lineno"> 2607</span>            base64_encode(pack(<span class="stringliteral">&#39;NN&#39;</span>, ip2long($ip[0]), ip2long($ip[1])));</div>
<div class="line"><span class="lineno"> 2608</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8524c1f84d3dc74f7dd247fd12a122e6" name="a8524c1f84d3dc74f7dd247fd12a122e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8524c1f84d3dc74f7dd247fd12a122e6">&#9670;&#160;</a></span>_extensions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">&amp; _extensions </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$path</em> = <code>null</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$create</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a reference to an extension subarray. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$root</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td>optional absolute path with / as component separator </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$create</td><td>optional @access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array|false </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04341">4341</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4342</span>    {</div>
<div class="line"><span class="lineno"> 4343</span>        <span class="keywordflow">if</span> (!isset($root)) {</div>
<div class="line"><span class="lineno"> 4344</span>            $root = $this-&gt;currentCert;</div>
<div class="line"><span class="lineno"> 4345</span>        }</div>
<div class="line"><span class="lineno"> 4346</span> </div>
<div class="line"><span class="lineno"> 4347</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 4348</span>            <span class="keywordflow">case</span> !empty($path):</div>
<div class="line"><span class="lineno"> 4349</span>            case !is_array($root):</div>
<div class="line"><span class="lineno"> 4350</span>                break;</div>
<div class="line"><span class="lineno"> 4351</span>            <span class="keywordflow">case</span> isset($root[<span class="stringliteral">&#39;tbsCertificate&#39;</span>]):</div>
<div class="line"><span class="lineno"> 4352</span>                $path = <span class="stringliteral">&#39;tbsCertificate/extensions&#39;</span>;</div>
<div class="line"><span class="lineno"> 4353</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4354</span>            <span class="keywordflow">case</span> isset($root[<span class="stringliteral">&#39;tbsCertList&#39;</span>]):</div>
<div class="line"><span class="lineno"> 4355</span>                $path = <span class="stringliteral">&#39;tbsCertList/crlExtensions&#39;</span>;</div>
<div class="line"><span class="lineno"> 4356</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4357</span>            <span class="keywordflow">case</span> isset($root[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>]):</div>
<div class="line"><span class="lineno"> 4358</span>                $pth = <span class="stringliteral">&#39;certificationRequestInfo/attributes&#39;</span>;</div>
<div class="line"><span class="lineno"> 4359</span>                $attributes = &amp;$this-&gt;_subArray($root, $pth, $create);</div>
<div class="line"><span class="lineno"> 4360</span> </div>
<div class="line"><span class="lineno"> 4361</span>                <span class="keywordflow">if</span> (is_array($attributes)) {</div>
<div class="line"><span class="lineno"> 4362</span>                    <span class="keywordflow">foreach</span> ($attributes as $key =&gt; $value) {</div>
<div class="line"><span class="lineno"> 4363</span>                        <span class="keywordflow">if</span> ($value[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;pkcs-9-at-extensionRequest&#39;</span>) {</div>
<div class="line"><span class="lineno"> 4364</span>                            $path = <span class="stringliteral">&quot;$pth/$key/value/0&quot;</span>;</div>
<div class="line"><span class="lineno"> 4365</span>                            <span class="keywordflow">break</span> 2;</div>
<div class="line"><span class="lineno"> 4366</span>                        }</div>
<div class="line"><span class="lineno"> 4367</span>                    }</div>
<div class="line"><span class="lineno"> 4368</span>                    <span class="keywordflow">if</span> ($create) {</div>
<div class="line"><span class="lineno"> 4369</span>                        $key = count($attributes);</div>
<div class="line"><span class="lineno"> 4370</span>                        $attributes[] = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <span class="stringliteral">&#39;pkcs-9-at-extensionRequest&#39;</span>, <span class="stringliteral">&#39;value&#39;</span> =&gt; array());</div>
<div class="line"><span class="lineno"> 4371</span>                        $path = <span class="stringliteral">&quot;$pth/$key/value/0&quot;</span>;</div>
<div class="line"><span class="lineno"> 4372</span>                    }</div>
<div class="line"><span class="lineno"> 4373</span>                }</div>
<div class="line"><span class="lineno"> 4374</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4375</span>        }</div>
<div class="line"><span class="lineno"> 4376</span> </div>
<div class="line"><span class="lineno"> 4377</span>        $extensions = &amp;$this-&gt;<a class="code hl_function" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471">_subArray</a>($root, $path, $create);</div>
<div class="line"><span class="lineno"> 4378</span> </div>
<div class="line"><span class="lineno"> 4379</span>        <span class="keywordflow">if</span> (!is_array($extensions)) {</div>
<div class="line"><span class="lineno"> 4380</span>            $false = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4381</span>            <span class="keywordflow">return</span> $false;</div>
<div class="line"><span class="lineno"> 4382</span>        }</div>
<div class="line"><span class="lineno"> 4383</span> </div>
<div class="line"><span class="lineno"> 4384</span>        <span class="keywordflow">return</span> $extensions;</div>
<div class="line"><span class="lineno"> 4385</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_aa200f8fe0af46a9daef5d95bfe2ce471"><div class="ttname"><a href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471">File_X509\_subArray</a></div><div class="ttdeci">&amp; _subArray(&amp;$root, $path, $create=false)</div><div class="ttdoc">Get a reference to a subarray.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l04305">X509.php:4305</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l04430">_getExtension()</a>, <a class="el" href="X509_8php_source.html#l04455">_getExtensions()</a>, <a class="el" href="X509_8php_source.html#l04395">_removeExtension()</a>, and <a class="el" href="X509_8php_source.html#l04480">_setExtension()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a8524c1f84d3dc74f7dd247fd12a122e6_cgraph.png" border="0" usemap="#aclassFile__X509_a8524c1f84d3dc74f7dd247fd12a122e6_cgraph" alt=""/></div>
<map name="aclassFile__X509_a8524c1f84d3dc74f7dd247fd12a122e6_cgraph" id="aclassFile__X509_a8524c1f84d3dc74f7dd247fd12a122e6_cgraph">
<area shape="rect" title="Get a reference to an extension subarray." alt="" coords="5,5,105,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="153,5,240,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a8524c1f84d3dc74f7dd247fd12a122e6_icgraph.png" border="0" usemap="#aclassFile__X509_a8524c1f84d3dc74f7dd247fd12a122e6_icgraph" alt=""/></div>
<map name="aclassFile__X509_a8524c1f84d3dc74f7dd247fd12a122e6_icgraph" id="aclassFile__X509_a8524c1f84d3dc74f7dd247fd12a122e6_icgraph">
<area shape="rect" title="Get a reference to an extension subarray." alt="" coords="1132,326,1232,351"/>
<area shape="rect" href="classFile__X509.html#a51d0ffadbcbf965b23238b89fef03484" title="Get an Extension." alt="" coords="955,186,1070,211"/>
<area shape="rect" href="classFile__X509.html#a7dfd9393f164e45947bac81e5bc97d7f" title="Returns a list of all extensions in use." alt="" coords="952,448,1073,474"/>
<area shape="rect" href="classFile__X509.html#ac16dd74cbc682e06b2f35875d04582d1" title="Remove an Extension." alt="" coords="941,300,1084,326"/>
<area shape="rect" href="classFile__X509.html#a28a18c05603a638bcb114897dffeee6d" title="Set an Extension." alt="" coords="956,350,1069,375"/>
<area shape="rect" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb" title="Get a certificate, CSR or CRL Extension." alt="" coords="721,136,828,162"/>
<area shape="rect" href="classFile__X509.html#a402e41419a2999b330874e39d0dd2a34" title="Get a Revoked Certificate Extension." alt="" coords="659,186,890,211"/>
<area shape="rect" href="classFile__X509.html#acc2e876f81f33f786d44175e43f96727" title="Validates an intermediate cert as identified via authority info access extension." alt="" coords="449,38,608,63"/>
<area shape="rect" href="classFile__X509.html#a96ee8b07aceb37a5d949447f7349bf12" title="Validate a signature." alt="" coords="191,12,401,38"/>
<area shape="rect" href="classFile__X509.html#a72aefa3de97ff30a83063abc3b8ce568" title="Get the certificate chain for the current cert." alt="" coords="489,186,569,211"/>
<area shape="rect" href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376" title="Load X.509 certificate." alt="" coords="487,136,570,162"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="271,287,321,312"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="491,287,566,312"/>
<area shape="rect" href="classFile__X509.html#afad375b8ebfbf0ed26dc7f1bb74e9ad3" title="Validate an X.509 certificate against a URL." alt="" coords="478,87,579,112"/>
<area shape="rect" href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa" title="Validate a signature." alt="" coords="5,12,143,38"/>
<area shape="rect" href="classFile__X509.html#a89783012156bb16439adcba84bca93d8" title="Load an X.509 certificate as a certificate authority." alt="" coords="262,136,330,162"/>
<area shape="rect" href="classFile__X509.html#a67b2aa40ccd2623250367494b69280c4" title="Returns a list of all extensions in use in certificate, CSR or CRL." alt="" coords="717,448,832,474"/>
<area shape="rect" href="classFile__X509.html#a2b45d9da1caa86e25f79910036ad8eee" title="Returns a list of all extensions in use for a given revoked certificate." alt="" coords="656,498,893,523"/>
<area shape="rect" href="classFile__X509.html#aa75a9d891292eeddcbf00060e36c0695" title="Remove a certificate, CSR or CRL Extension." alt="" coords="707,300,843,326"/>
<area shape="rect" href="classFile__X509.html#a436596da8ebdb29da908604cc2c0b1b5" title="Remove a Revoked Certificate Extension." alt="" coords="677,236,872,276"/>
<area shape="rect" href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f" title="Set a certificate, CSR or CRL Extension." alt="" coords="721,350,828,375"/>
<area shape="rect" href="classFile__X509.html#a28ba1f404bda71c06dc86b209616f53d" title="Set a Revoked Certificate Extension." alt="" coords="660,399,889,424"/>
</map>
</div>

</div>
</div>
<a id="a009e0a2396931d62c87d27f4e2372024" name="a009e0a2396931d62c87d27f4e2372024"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a009e0a2396931d62c87d27f4e2372024">&#9670;&#160;</a></span>_extractBER()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_extractBER </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract raw BER from Base64 encoding. </p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$str</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l05152">5152</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5153</span>    {</div>
<div class="line"><span class="lineno"> 5154</span>        <span class="comment">/* X.509 certs are assumed to be base64 encoded but sometimes they&#39;ll have additional things in them</span></div>
<div class="line"><span class="lineno"> 5155</span><span class="comment">         * above and beyond the ceritificate.</span></div>
<div class="line"><span class="lineno"> 5156</span><span class="comment">         * ie. some may have the following preceding the -----BEGIN CERTIFICATE----- line:</span></div>
<div class="line"><span class="lineno"> 5157</span><span class="comment">         *</span></div>
<div class="line"><span class="lineno"> 5158</span><span class="comment">         * Bag Attributes</span></div>
<div class="line"><span class="lineno"> 5159</span><span class="comment">         *     localKeyID: 01 00 00 00</span></div>
<div class="line"><span class="lineno"> 5160</span><span class="comment">         * subject=/O=organization/OU=org unit/CN=common name</span></div>
<div class="line"><span class="lineno"> 5161</span><span class="comment">         * issuer=/O=organization/CN=common name</span></div>
<div class="line"><span class="lineno"> 5162</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 5163</span>        <span class="keywordflow">if</span> (strlen($str) &gt; ini_get(<span class="stringliteral">&#39;pcre.backtrack_limit&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 5164</span>            $temp = $str;</div>
<div class="line"><span class="lineno"> 5165</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5166</span>            $temp = preg_replace(<span class="stringliteral">&#39;#.*?^-+[^-]+-+[\r\n ]*$#ms&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $str, 1);</div>
<div class="line"><span class="lineno"> 5167</span>            $temp = preg_replace(<span class="stringliteral">&#39;#-+END.*[\r\n ]*.*#ms&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $temp, 1);</div>
<div class="line"><span class="lineno"> 5168</span>        }</div>
<div class="line"><span class="lineno"> 5169</span>        <span class="comment">// remove new lines</span></div>
<div class="line"><span class="lineno"> 5170</span>        $temp = str_replace(array(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot;\n&quot;</span>, <span class="charliteral">&#39; &#39;</span>), <span class="stringliteral">&#39;&#39;</span>, $temp);</div>
<div class="line"><span class="lineno"> 5171</span>        <span class="comment">// remove the -----BEGIN CERTIFICATE----- and -----END CERTIFICATE----- stuff</span></div>
<div class="line"><span class="lineno"> 5172</span>        $temp = preg_replace(<span class="stringliteral">&#39;#^-+[^-]+-+|-+[^-]+-+$#&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $temp);</div>
<div class="line"><span class="lineno"> 5173</span>        $temp = preg_match(<span class="stringliteral">&#39;#^[a-zA-Z\d/+]*={0,2}$#&#39;</span>, $temp) ? base64_decode($temp) : false;</div>
<div class="line"><span class="lineno"> 5174</span>        <span class="keywordflow">return</span> $temp != <span class="keyword">false</span> ? $temp : $str;</div>
<div class="line"><span class="lineno"> 5175</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l04767">computeKeyIdentifier()</a>, <a class="el" href="X509_8php_source.html#l03521">loadCRL()</a>, <a class="el" href="X509_8php_source.html#l03259">loadCSR()</a>, and <a class="el" href="X509_8php_source.html#l01497">loadX509()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a009e0a2396931d62c87d27f4e2372024_icgraph.png" border="0" usemap="#aclassFile__X509_a009e0a2396931d62c87d27f4e2372024_icgraph" alt=""/></div>
<map name="aclassFile__X509_a009e0a2396931d62c87d27f4e2372024_icgraph" id="aclassFile__X509_a009e0a2396931d62c87d27f4e2372024_icgraph">
<area shape="rect" title="Extract raw BER from Base64 encoding." alt="" coords="337,104,439,129"/>
<area shape="rect" href="classFile__X509.html#ae4e1b70f7a5845e4777064b242a35d56" title="Compute a public key identifier." alt="" coords="128,79,289,104"/>
<area shape="rect" href="classFile__X509.html#a0379465670a36ea3a1d2e9a34ea21405" title="Load a Certificate Revocation List." alt="" coords="171,5,246,31"/>
<area shape="rect" href="classFile__X509.html#aa71d96486f43146d0ff5fa6e46167853" title="Load a Certificate Signing Request." alt="" coords="171,177,247,203"/>
<area shape="rect" href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376" title="Load X.509 certificate." alt="" coords="167,128,250,153"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="18,79,67,104"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="5,5,80,31"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="5,177,80,203"/>
<area shape="rect" href="classFile__X509.html#a89783012156bb16439adcba84bca93d8" title="Load an X.509 certificate as a certificate authority." alt="" coords="9,128,77,153"/>
</map>
</div>

</div>
</div>
<a id="a84e2629a56c47e5e90ab3a2a0aaf1bda" name="a84e2629a56c47e5e90ab3a2a0aaf1bda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84e2629a56c47e5e90ab3a2a0aaf1bda">&#9670;&#160;</a></span>_fetchURL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_fetchURL </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$url</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fetches a URL. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$url</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool|string </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02193">2193</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2194</span>    {</div>
<div class="line"><span class="lineno"> 2195</span>        <span class="keywordflow">if</span> ($this-&gt;disable_url_fetch) {</div>
<div class="line"><span class="lineno"> 2196</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2197</span>        }</div>
<div class="line"><span class="lineno"> 2198</span> </div>
<div class="line"><span class="lineno"> 2199</span>        $parts = parse_url($url);</div>
<div class="line"><span class="lineno"> 2200</span>        $data = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 2201</span>        <span class="keywordflow">switch</span> ($parts[<span class="stringliteral">&#39;scheme&#39;</span>]) {</div>
<div class="line"><span class="lineno"> 2202</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;http&#39;</span>:</div>
<div class="line"><span class="lineno"> 2203</span>                $fsock = @fsockopen($parts[<span class="stringliteral">&#39;host&#39;</span>], isset($parts[<span class="stringliteral">&#39;port&#39;</span>]) ? $parts[<span class="stringliteral">&#39;port&#39;</span>] : 80);</div>
<div class="line"><span class="lineno"> 2204</span>                <span class="keywordflow">if</span> (!$fsock) {</div>
<div class="line"><span class="lineno"> 2205</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2206</span>                }</div>
<div class="line"><span class="lineno"> 2207</span>                fputs($fsock, <span class="stringliteral">&quot;GET $parts[path] HTTP/1.0\r\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2208</span>                fputs($fsock, <span class="stringliteral">&quot;Host: $parts[host]\r\n\r\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2209</span>                $line = fgets($fsock, 1024);</div>
<div class="line"><span class="lineno"> 2210</span>                <span class="keywordflow">if</span> (strlen($line) &lt; 3) {</div>
<div class="line"><span class="lineno"> 2211</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2212</span>                }</div>
<div class="line"><span class="lineno"> 2213</span>                preg_match(<span class="stringliteral">&#39;#HTTP/1.\d (\d{3})#&#39;</span>, $line, $temp);</div>
<div class="line"><span class="lineno"> 2214</span>                <span class="keywordflow">if</span> ($temp[1] != <span class="stringliteral">&#39;200&#39;</span>) {</div>
<div class="line"><span class="lineno"> 2215</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2216</span>                }</div>
<div class="line"><span class="lineno"> 2217</span> </div>
<div class="line"><span class="lineno"> 2218</span>                <span class="comment">// skip the rest of the headers in the http response</span></div>
<div class="line"><span class="lineno"> 2219</span>                <span class="keywordflow">while</span> (!feof($fsock) &amp;&amp; fgets($fsock, 1024) != <span class="stringliteral">&quot;\r\n&quot;</span>) {</div>
<div class="line"><span class="lineno"> 2220</span>                }</div>
<div class="line"><span class="lineno"> 2221</span> </div>
<div class="line"><span class="lineno"> 2222</span>                <span class="keywordflow">while</span> (!feof($fsock)) {</div>
<div class="line"><span class="lineno"> 2223</span>                    $temp = fread($fsock, 1024);</div>
<div class="line"><span class="lineno"> 2224</span>                    <span class="keywordflow">if</span> ($temp === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2225</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2226</span>                    }</div>
<div class="line"><span class="lineno"> 2227</span>                    $data.= $temp;</div>
<div class="line"><span class="lineno"> 2228</span>                }</div>
<div class="line"><span class="lineno"> 2229</span> </div>
<div class="line"><span class="lineno"> 2230</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2231</span>            <span class="comment">//case &#39;ftp&#39;:</span></div>
<div class="line"><span class="lineno"> 2232</span>            <span class="comment">//case &#39;ldap&#39;:</span></div>
<div class="line"><span class="lineno"> 2233</span>            <span class="comment">//default:</span></div>
<div class="line"><span class="lineno"> 2234</span>        }</div>
<div class="line"><span class="lineno"> 2235</span> </div>
<div class="line"><span class="lineno"> 2236</span>        <span class="keywordflow">return</span> $data;</div>
<div class="line"><span class="lineno"> 2237</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l02249">_testForIntermediate()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a84e2629a56c47e5e90ab3a2a0aaf1bda_icgraph.png" border="0" usemap="#aclassFile__X509_a84e2629a56c47e5e90ab3a2a0aaf1bda_icgraph" alt=""/></div>
<map name="aclassFile__X509_a84e2629a56c47e5e90ab3a2a0aaf1bda_icgraph" id="aclassFile__X509_a84e2629a56c47e5e90ab3a2a0aaf1bda_icgraph">
<area shape="rect" title="Fetches a URL." alt="" coords="656,5,744,31"/>
<area shape="rect" href="classFile__X509.html#acc2e876f81f33f786d44175e43f96727" title="Validates an intermediate cert as identified via authority info access extension." alt="" coords="449,5,608,31"/>
<area shape="rect" href="classFile__X509.html#a96ee8b07aceb37a5d949447f7349bf12" title="Validate a signature." alt="" coords="191,5,401,31"/>
<area shape="rect" href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa" title="Validate a signature." alt="" coords="5,5,143,31"/>
</map>
</div>

</div>
</div>
<a id="abd3e81dc470c99af40c0aee99fcdab75" name="abd3e81dc470c99af40c0aee99fcdab75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd3e81dc470c99af40c0aee99fcdab75">&#9670;&#160;</a></span>_formatSubjectPublicKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_formatSubjectPublicKey </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Format a public key as appropriate. </p>
<p>@access private </p><dl class="section return"><dt>Returns</dt><dd>array </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04849">4849</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4850</span>    {</div>
<div class="line"><span class="lineno"> 4851</span>        <span class="keywordflow">if</span> (!isset($this-&gt;publicKey) || !is_object($this-&gt;publicKey)) {</div>
<div class="line"><span class="lineno"> 4852</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4853</span>        }</div>
<div class="line"><span class="lineno"> 4854</span> </div>
<div class="line"><span class="lineno"> 4855</span>        <span class="keywordflow">switch</span> (strtolower(get_class($this-&gt;publicKey))) {</div>
<div class="line"><span class="lineno"> 4856</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;crypt_rsa&#39;</span>:</div>
<div class="line"><span class="lineno"> 4857</span>                <span class="comment">// the following two return statements do the same thing. i dunno.. i just prefer the later for some reason.</span></div>
<div class="line"><span class="lineno"> 4858</span>                <span class="comment">// the former is a good example of how to do fuzzing on the public key</span></div>
<div class="line"><span class="lineno"> 4859</span>                <span class="comment">//return new File_ASN1_Element(base64_decode(preg_replace(&#39;#-.+-|[\r\n]#&#39;, &#39;&#39;, $this-&gt;publicKey-&gt;getPublicKey())));</span></div>
<div class="line"><span class="lineno"> 4860</span>                <span class="keywordflow">return</span> array(</div>
<div class="line"><span class="lineno"> 4861</span>                    <span class="stringliteral">&#39;algorithm&#39;</span> =&gt; array(<span class="stringliteral">&#39;algorithm&#39;</span> =&gt; <span class="stringliteral">&#39;rsaEncryption&#39;</span>),</div>
<div class="line"><span class="lineno"> 4862</span>                    <span class="stringliteral">&#39;subjectPublicKey&#39;</span> =&gt; $this-&gt;publicKey-&gt;getPublicKey(<a class="code hl_variable" href="RSA_8php.html#a15eeb8d9dc1af1411f1549d4702c8a00">CRYPT_RSA_PUBLIC_FORMAT_PKCS1</a>)</div>
<div class="line"><span class="lineno"> 4863</span>                );</div>
<div class="line"><span class="lineno"> 4864</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 4865</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4866</span>        }</div>
<div class="line"><span class="lineno"> 4867</span>    }</div>
<div class="ttc" id="aRSA_8php_html_a15eeb8d9dc1af1411f1549d4702c8a00"><div class="ttname"><a href="RSA_8php.html#a15eeb8d9dc1af1411f1549d4702c8a00">CRYPT_RSA_PUBLIC_FORMAT_PKCS1</a></div><div class="ttdeci">const CRYPT_RSA_PUBLIC_FORMAT_PKCS1</div><div class="ttdoc">PKCS#1 formatted public key (raw)</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00249">RSA.php:249</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l00249">CRYPT_RSA_PUBLIC_FORMAT_PKCS1</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l03876">signCSR()</a>, and <a class="el" href="X509_8php_source.html#l03934">signSPKAC()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_abd3e81dc470c99af40c0aee99fcdab75_icgraph.png" border="0" usemap="#aclassFile__X509_abd3e81dc470c99af40c0aee99fcdab75_icgraph" alt=""/></div>
<map name="aclassFile__X509_abd3e81dc470c99af40c0aee99fcdab75_icgraph" id="aclassFile__X509_abd3e81dc470c99af40c0aee99fcdab75_icgraph">
<area shape="rect" title="Format a public key as appropriate." alt="" coords="145,31,329,56"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="14,5,89,31"/>
<area shape="rect" href="classFile__X509.html#a7579e46dcabbf3bff17d8e31f1b2cb25" title="Sign a SPKAC." alt="" coords="5,55,97,80"/>
</map>
</div>

</div>
</div>
<a id="a51d0ffadbcbf965b23238b89fef03484" name="a51d0ffadbcbf965b23238b89fef03484"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51d0ffadbcbf965b23238b89fef03484">&#9670;&#160;</a></span>_getExtension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getExtension </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$cert</em> = <code>null</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$path</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get an Extension. </p>
<p>Returns the extension if it exists and false if not</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$id</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$cert</td><td>optional </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td>optional @access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04430">4430</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4431</span>    {</div>
<div class="line"><span class="lineno"> 4432</span>        $extensions = $this-&gt;_extensions($cert, $path);</div>
<div class="line"><span class="lineno"> 4433</span> </div>
<div class="line"><span class="lineno"> 4434</span>        <span class="keywordflow">if</span> (!is_array($extensions)) {</div>
<div class="line"><span class="lineno"> 4435</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4436</span>        }</div>
<div class="line"><span class="lineno"> 4437</span> </div>
<div class="line"><span class="lineno"> 4438</span>        <span class="keywordflow">foreach</span> ($extensions as $key =&gt; $value) {</div>
<div class="line"><span class="lineno"> 4439</span>            <span class="keywordflow">if</span> ($value[<span class="stringliteral">&#39;extnId&#39;</span>] == $id) {</div>
<div class="line"><span class="lineno"> 4440</span>                <span class="keywordflow">return</span> $value[<span class="stringliteral">&#39;extnValue&#39;</span>];</div>
<div class="line"><span class="lineno"> 4441</span>            }</div>
<div class="line"><span class="lineno"> 4442</span>        }</div>
<div class="line"><span class="lineno"> 4443</span> </div>
<div class="line"><span class="lineno"> 4444</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4445</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04341">_extensions()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l04527">getExtension()</a>, and <a class="el" href="X509_8php_source.html#l05083">getRevokedCertificateExtension()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a51d0ffadbcbf965b23238b89fef03484_cgraph.png" border="0" usemap="#aclassFile__X509_a51d0ffadbcbf965b23238b89fef03484_cgraph" alt=""/></div>
<map name="aclassFile__X509_a51d0ffadbcbf965b23238b89fef03484_cgraph" id="aclassFile__X509_a51d0ffadbcbf965b23238b89fef03484_cgraph">
<area shape="rect" title="Get an Extension." alt="" coords="5,5,120,31"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="168,5,268,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="316,5,403,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a51d0ffadbcbf965b23238b89fef03484_icgraph.png" border="0" usemap="#aclassFile__X509_a51d0ffadbcbf965b23238b89fef03484_icgraph" alt=""/></div>
<map name="aclassFile__X509_a51d0ffadbcbf965b23238b89fef03484_icgraph" id="aclassFile__X509_a51d0ffadbcbf965b23238b89fef03484_icgraph">
<area shape="rect" title="Get an Extension." alt="" coords="935,181,1049,207"/>
<area shape="rect" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb" title="Get a certificate, CSR or CRL Extension." alt="" coords="718,156,825,181"/>
<area shape="rect" href="classFile__X509.html#a402e41419a2999b330874e39d0dd2a34" title="Get a Revoked Certificate Extension." alt="" coords="656,205,887,231"/>
<area shape="rect" href="classFile__X509.html#acc2e876f81f33f786d44175e43f96727" title="Validates an intermediate cert as identified via authority info access extension." alt="" coords="449,5,608,31"/>
<area shape="rect" href="classFile__X509.html#a96ee8b07aceb37a5d949447f7349bf12" title="Validate a signature." alt="" coords="191,31,401,56"/>
<area shape="rect" href="classFile__X509.html#a72aefa3de97ff30a83063abc3b8ce568" title="Get the certificate chain for the current cert." alt="" coords="489,107,569,132"/>
<area shape="rect" href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376" title="Load X.509 certificate." alt="" coords="487,156,570,181"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="271,205,321,231"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="491,257,566,283"/>
<area shape="rect" href="classFile__X509.html#afad375b8ebfbf0ed26dc7f1bb74e9ad3" title="Validate an X.509 certificate against a URL." alt="" coords="478,307,579,332"/>
<area shape="rect" href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa" title="Validate a signature." alt="" coords="5,31,143,56"/>
<area shape="rect" href="classFile__X509.html#a89783012156bb16439adcba84bca93d8" title="Load an X.509 certificate as a certificate authority." alt="" coords="262,156,330,181"/>
</map>
</div>

</div>
</div>
<a id="a7dfd9393f164e45947bac81e5bc97d7f" name="a7dfd9393f164e45947bac81e5bc97d7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dfd9393f164e45947bac81e5bc97d7f">&#9670;&#160;</a></span>_getExtensions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getExtensions </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$cert</em> = <code>null</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$path</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a list of all extensions in use. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$cert</td><td>optional </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td>optional @access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04455">4455</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4456</span>    {</div>
<div class="line"><span class="lineno"> 4457</span>        $exts = $this-&gt;_extensions($cert, $path);</div>
<div class="line"><span class="lineno"> 4458</span>        $extensions = array();</div>
<div class="line"><span class="lineno"> 4459</span> </div>
<div class="line"><span class="lineno"> 4460</span>        <span class="keywordflow">if</span> (is_array($exts)) {</div>
<div class="line"><span class="lineno"> 4461</span>            <span class="keywordflow">foreach</span> ($exts as $extension) {</div>
<div class="line"><span class="lineno"> 4462</span>                $extensions[] = $extension[<span class="stringliteral">&#39;extnId&#39;</span>];</div>
<div class="line"><span class="lineno"> 4463</span>            }</div>
<div class="line"><span class="lineno"> 4464</span>        }</div>
<div class="line"><span class="lineno"> 4465</span> </div>
<div class="line"><span class="lineno"> 4466</span>        <span class="keywordflow">return</span> $extensions;</div>
<div class="line"><span class="lineno"> 4467</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04341">_extensions()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l04539">getExtensions()</a>, and <a class="el" href="X509_8php_source.html#l05106">getRevokedCertificateExtensions()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a7dfd9393f164e45947bac81e5bc97d7f_cgraph.png" border="0" usemap="#aclassFile__X509_a7dfd9393f164e45947bac81e5bc97d7f_cgraph" alt=""/></div>
<map name="aclassFile__X509_a7dfd9393f164e45947bac81e5bc97d7f_cgraph" id="aclassFile__X509_a7dfd9393f164e45947bac81e5bc97d7f_cgraph">
<area shape="rect" title="Returns a list of all extensions in use." alt="" coords="5,5,127,31"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="175,5,275,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="323,5,409,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a7dfd9393f164e45947bac81e5bc97d7f_icgraph.png" border="0" usemap="#aclassFile__X509_a7dfd9393f164e45947bac81e5bc97d7f_icgraph" alt=""/></div>
<map name="aclassFile__X509_a7dfd9393f164e45947bac81e5bc97d7f_icgraph" id="aclassFile__X509_a7dfd9393f164e45947bac81e5bc97d7f_icgraph">
<area shape="rect" title="Returns a list of all extensions in use." alt="" coords="291,31,412,56"/>
<area shape="rect" href="classFile__X509.html#a67b2aa40ccd2623250367494b69280c4" title="Returns a list of all extensions in use in certificate, CSR or CRL." alt="" coords="67,5,181,31"/>
<area shape="rect" href="classFile__X509.html#a2b45d9da1caa86e25f79910036ad8eee" title="Returns a list of all extensions in use for a given revoked certificate." alt="" coords="5,55,243,80"/>
</map>
</div>

</div>
</div>
<a id="ab691691d441dc6983a12a28ab3e0db1f" name="ab691691d441dc6983a12a28ab3e0db1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab691691d441dc6983a12a28ab3e0db1f">&#9670;&#160;</a></span>_getMapping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_getMapping </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$extnId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Associate an extension ID to an extension mapping. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$extnId</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l01911">1911</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1912</span>    {</div>
<div class="line"><span class="lineno"> 1913</span>        <span class="keywordflow">if</span> (!is_string($extnId)) { <span class="comment">// eg. if it&#39;s a File_ASN1_Element object</span></div>
<div class="line"><span class="lineno"> 1914</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1915</span>        }</div>
<div class="line"><span class="lineno"> 1916</span> </div>
<div class="line"><span class="lineno"> 1917</span>        <span class="keywordflow">switch</span> ($extnId) {</div>
<div class="line"><span class="lineno"> 1918</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-keyUsage&#39;</span>:</div>
<div class="line"><span class="lineno"> 1919</span>                <span class="keywordflow">return</span> $this-&gt;KeyUsage;</div>
<div class="line"><span class="lineno"> 1920</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-basicConstraints&#39;</span>:</div>
<div class="line"><span class="lineno"> 1921</span>                <span class="keywordflow">return</span> $this-&gt;BasicConstraints;</div>
<div class="line"><span class="lineno"> 1922</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-subjectKeyIdentifier&#39;</span>:</div>
<div class="line"><span class="lineno"> 1923</span>                <span class="keywordflow">return</span> $this-&gt;KeyIdentifier;</div>
<div class="line"><span class="lineno"> 1924</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-cRLDistributionPoints&#39;</span>:</div>
<div class="line"><span class="lineno"> 1925</span>                <span class="keywordflow">return</span> $this-&gt;CRLDistributionPoints;</div>
<div class="line"><span class="lineno"> 1926</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-authorityKeyIdentifier&#39;</span>:</div>
<div class="line"><span class="lineno"> 1927</span>                <span class="keywordflow">return</span> $this-&gt;AuthorityKeyIdentifier;</div>
<div class="line"><span class="lineno"> 1928</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-certificatePolicies&#39;</span>:</div>
<div class="line"><span class="lineno"> 1929</span>                <span class="keywordflow">return</span> $this-&gt;CertificatePolicies;</div>
<div class="line"><span class="lineno"> 1930</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-extKeyUsage&#39;</span>:</div>
<div class="line"><span class="lineno"> 1931</span>                <span class="keywordflow">return</span> $this-&gt;ExtKeyUsageSyntax;</div>
<div class="line"><span class="lineno"> 1932</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-pe-authorityInfoAccess&#39;</span>:</div>
<div class="line"><span class="lineno"> 1933</span>                <span class="keywordflow">return</span> $this-&gt;AuthorityInfoAccessSyntax;</div>
<div class="line"><span class="lineno"> 1934</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-pe-subjectInfoAccess&#39;</span>:</div>
<div class="line"><span class="lineno"> 1935</span>                <span class="keywordflow">return</span> $this-&gt;SubjectInfoAccessSyntax;</div>
<div class="line"><span class="lineno"> 1936</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-subjectAltName&#39;</span>:</div>
<div class="line"><span class="lineno"> 1937</span>                <span class="keywordflow">return</span> $this-&gt;SubjectAltName;</div>
<div class="line"><span class="lineno"> 1938</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-subjectDirectoryAttributes&#39;</span>:</div>
<div class="line"><span class="lineno"> 1939</span>                <span class="keywordflow">return</span> $this-&gt;SubjectDirectoryAttributes;</div>
<div class="line"><span class="lineno"> 1940</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-privateKeyUsagePeriod&#39;</span>:</div>
<div class="line"><span class="lineno"> 1941</span>                <span class="keywordflow">return</span> $this-&gt;PrivateKeyUsagePeriod;</div>
<div class="line"><span class="lineno"> 1942</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-issuerAltName&#39;</span>:</div>
<div class="line"><span class="lineno"> 1943</span>                <span class="keywordflow">return</span> $this-&gt;IssuerAltName;</div>
<div class="line"><span class="lineno"> 1944</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-policyMappings&#39;</span>:</div>
<div class="line"><span class="lineno"> 1945</span>                <span class="keywordflow">return</span> $this-&gt;PolicyMappings;</div>
<div class="line"><span class="lineno"> 1946</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-nameConstraints&#39;</span>:</div>
<div class="line"><span class="lineno"> 1947</span>                <span class="keywordflow">return</span> $this-&gt;NameConstraints;</div>
<div class="line"><span class="lineno"> 1948</span> </div>
<div class="line"><span class="lineno"> 1949</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;netscape-cert-type&#39;</span>:</div>
<div class="line"><span class="lineno"> 1950</span>                <span class="keywordflow">return</span> $this-&gt;netscape_cert_type;</div>
<div class="line"><span class="lineno"> 1951</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;netscape-comment&#39;</span>:</div>
<div class="line"><span class="lineno"> 1952</span>                <span class="keywordflow">return</span> $this-&gt;netscape_comment;</div>
<div class="line"><span class="lineno"> 1953</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;netscape-ca-policy-url&#39;</span>:</div>
<div class="line"><span class="lineno"> 1954</span>                <span class="keywordflow">return</span> $this-&gt;netscape_ca_policy_url;</div>
<div class="line"><span class="lineno"> 1955</span> </div>
<div class="line"><span class="lineno"> 1956</span>            <span class="comment">// since id-qt-cps isn&#39;t a constructed type it will have already been decoded as a string by the time it gets</span></div>
<div class="line"><span class="lineno"> 1957</span>            <span class="comment">// back around to asn1map() and we don&#39;t want it decoded again.</span></div>
<div class="line"><span class="lineno"> 1958</span>            <span class="comment">//case &#39;id-qt-cps&#39;:</span></div>
<div class="line"><span class="lineno"> 1959</span>            <span class="comment">//    return $this-&gt;CPSuri;</span></div>
<div class="line"><span class="lineno"> 1960</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-qt-unotice&#39;</span>:</div>
<div class="line"><span class="lineno"> 1961</span>                <span class="keywordflow">return</span> $this-&gt;UserNotice;</div>
<div class="line"><span class="lineno"> 1962</span> </div>
<div class="line"><span class="lineno"> 1963</span>            <span class="comment">// the following OIDs are unsupported but we don&#39;t want them to give notices when calling saveX509().</span></div>
<div class="line"><span class="lineno"> 1964</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-pe-logotype&#39;</span>: <span class="comment">// http://www.ietf.org/rfc/rfc3709.txt</span></div>
<div class="line"><span class="lineno"> 1965</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;entrustVersInfo&#39;</span>:</div>
<div class="line"><span class="lineno"> 1966</span>            <span class="comment">// http://support.microsoft.com/kb/287547</span></div>
<div class="line"><span class="lineno"> 1967</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;1.3.6.1.4.1.311.20.2&#39;</span>: <span class="comment">// szOID_ENROLL_CERTTYPE_EXTENSION</span></div>
<div class="line"><span class="lineno"> 1968</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;1.3.6.1.4.1.311.21.1&#39;</span>: <span class="comment">// szOID_CERTSRV_CA_VERSION</span></div>
<div class="line"><span class="lineno"> 1969</span>            <span class="comment">// &quot;SET Secure Electronic Transaction Specification&quot;</span></div>
<div class="line"><span class="lineno"> 1970</span>            <span class="comment">// http://www.maithean.com/docs/set_bk3.pdf</span></div>
<div class="line"><span class="lineno"> 1971</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;2.23.42.7.0&#39;</span>: <span class="comment">// id-set-hashedRootKey</span></div>
<div class="line"><span class="lineno"> 1972</span>            <span class="comment">// &quot;Certificate Transparency&quot;</span></div>
<div class="line"><span class="lineno"> 1973</span>            <span class="comment">// https://tools.ietf.org/html/rfc6962</span></div>
<div class="line"><span class="lineno"> 1974</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;1.3.6.1.4.1.11129.2.4.2&#39;</span>:</div>
<div class="line"><span class="lineno"> 1975</span>            <span class="comment">// &quot;Qualified Certificate statements&quot;</span></div>
<div class="line"><span class="lineno"> 1976</span>            <span class="comment">// https://tools.ietf.org/html/rfc3739#section-3.2.6</span></div>
<div class="line"><span class="lineno"> 1977</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;1.3.6.1.5.5.7.1.3&#39;</span>:</div>
<div class="line"><span class="lineno"> 1978</span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1979</span> </div>
<div class="line"><span class="lineno"> 1980</span>            <span class="comment">// CSR attributes</span></div>
<div class="line"><span class="lineno"> 1981</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;pkcs-9-at-unstructuredName&#39;</span>:</div>
<div class="line"><span class="lineno"> 1982</span>                <span class="keywordflow">return</span> $this-&gt;PKCS9String;</div>
<div class="line"><span class="lineno"> 1983</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;pkcs-9-at-challengePassword&#39;</span>:</div>
<div class="line"><span class="lineno"> 1984</span>                <span class="keywordflow">return</span> $this-&gt;DirectoryString;</div>
<div class="line"><span class="lineno"> 1985</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;pkcs-9-at-extensionRequest&#39;</span>:</div>
<div class="line"><span class="lineno"> 1986</span>                <span class="keywordflow">return</span> $this-&gt;Extensions;</div>
<div class="line"><span class="lineno"> 1987</span> </div>
<div class="line"><span class="lineno"> 1988</span>            <span class="comment">// CRL extensions.</span></div>
<div class="line"><span class="lineno"> 1989</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-cRLNumber&#39;</span>:</div>
<div class="line"><span class="lineno"> 1990</span>                <span class="keywordflow">return</span> $this-&gt;CRLNumber;</div>
<div class="line"><span class="lineno"> 1991</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-deltaCRLIndicator&#39;</span>:</div>
<div class="line"><span class="lineno"> 1992</span>                <span class="keywordflow">return</span> $this-&gt;CRLNumber;</div>
<div class="line"><span class="lineno"> 1993</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-issuingDistributionPoint&#39;</span>:</div>
<div class="line"><span class="lineno"> 1994</span>                <span class="keywordflow">return</span> $this-&gt;IssuingDistributionPoint;</div>
<div class="line"><span class="lineno"> 1995</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-freshestCRL&#39;</span>:</div>
<div class="line"><span class="lineno"> 1996</span>                <span class="keywordflow">return</span> $this-&gt;CRLDistributionPoints;</div>
<div class="line"><span class="lineno"> 1997</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-cRLReasons&#39;</span>:</div>
<div class="line"><span class="lineno"> 1998</span>                <span class="keywordflow">return</span> $this-&gt;CRLReason;</div>
<div class="line"><span class="lineno"> 1999</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-invalidityDate&#39;</span>:</div>
<div class="line"><span class="lineno"> 2000</span>                <span class="keywordflow">return</span> $this-&gt;InvalidityDate;</div>
<div class="line"><span class="lineno"> 2001</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-certificateIssuer&#39;</span>:</div>
<div class="line"><span class="lineno"> 2002</span>                <span class="keywordflow">return</span> $this-&gt;CertificateIssuer;</div>
<div class="line"><span class="lineno"> 2003</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-holdInstructionCode&#39;</span>:</div>
<div class="line"><span class="lineno"> 2004</span>                <span class="keywordflow">return</span> $this-&gt;HoldInstructionCode;</div>
<div class="line"><span class="lineno"> 2005</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-postalAddress&#39;</span>:</div>
<div class="line"><span class="lineno"> 2006</span>                <span class="keywordflow">return</span> $this-&gt;PostalAddress;</div>
<div class="line"><span class="lineno"> 2007</span>        }</div>
<div class="line"><span class="lineno"> 2008</span> </div>
<div class="line"><span class="lineno"> 2009</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2010</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l01767">_mapInAttributes()</a>, <a class="el" href="X509_8php_source.html#l01851">_mapInDNs()</a>, <a class="el" href="X509_8php_source.html#l01648">_mapInExtensions()</a>, <a class="el" href="X509_8php_source.html#l01808">_mapOutAttributes()</a>, <a class="el" href="X509_8php_source.html#l01881">_mapOutDNs()</a>, <a class="el" href="X509_8php_source.html#l01701">_mapOutExtensions()</a>, and <a class="el" href="X509_8php_source.html#l02776">getDNProp()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ab691691d441dc6983a12a28ab3e0db1f_icgraph.png" border="0" usemap="#aclassFile__X509_ab691691d441dc6983a12a28ab3e0db1f_icgraph" alt=""/></div>
<map name="aclassFile__X509_ab691691d441dc6983a12a28ab3e0db1f_icgraph" id="aclassFile__X509_ab691691d441dc6983a12a28ab3e0db1f_icgraph">
<area shape="rect" title="Associate an extension ID to an extension mapping." alt="" coords="1031,205,1137,231"/>
<area shape="rect" href="classFile__X509.html#acab7579764a0d5973b94cd8bf1c64092" title="Map attribute values from ANY type to attribute&#45;specific internal format." alt="" coords="643,5,777,31"/>
<area shape="rect" href="classFile__X509.html#a016c0c81b4115631a081d91036c8839f" title="Map DN values from ANY type to DN&#45;specific internal format." alt="" coords="858,155,955,180"/>
<area shape="rect" href="classFile__X509.html#a0c34c28604781bdc296e7ade6951a734" title="Map extension values from octet string to extension&#45;specific internal format." alt="" coords="836,105,977,131"/>
<area shape="rect" href="classFile__X509.html#acb6786d74bfd53b1a57ea5f72de69ab5" title="Map attribute values from attribute&#45;specific internal format to ANY type." alt="" coords="637,205,783,231"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="853,329,961,355"/>
<area shape="rect" href="classFile__X509.html#aa5e331e0ded7b3d7a76452ba6ff70194" title="Get Distinguished Name properties." alt="" coords="664,480,756,505"/>
<area shape="rect" href="classFile__X509.html#afc612875837ae70595137c6166f90106" title="Map extension values from extension&#45;specific internal format to octet string." alt="" coords="831,256,983,281"/>
<area shape="rect" href="classFile__X509.html#aa71d96486f43146d0ff5fa6e46167853" title="Load a Certificate Signing Request." alt="" coords="481,56,557,81"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="259,156,333,181"/>
<area shape="rect" href="classFile__X509.html#a0379465670a36ea3a1d2e9a34ea21405" title="Load a Certificate Revocation List." alt="" coords="673,156,747,181"/>
<area shape="rect" href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376" title="Load X.509 certificate." alt="" coords="669,107,751,132"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="482,205,557,231"/>
<area shape="rect" href="classFile__X509.html#a89783012156bb16439adcba84bca93d8" title="Load an X.509 certificate as a certificate authority." alt="" coords="485,107,553,132"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="495,156,544,181"/>
<area shape="rect" href="classFile__X509.html#a9c1ab61eb1f01e39614b1fb1a99bd202" title="Save CSR request." alt="" coords="480,255,559,280"/>
<area shape="rect" href="classFile__X509.html#a97392a261d56bd64002da7d1e76e8195" title="Get the Distinguished Name for a certificates subject." alt="" coords="679,429,741,455"/>
<area shape="rect" href="classFile__X509.html#a9ea29c41d328dc397c2f1de19a178696" title="Save Certificate Revocation List." alt="" coords="671,304,749,329"/>
<area shape="rect" href="classFile__X509.html#af8e8019a921e4c0651e807c7c1644fcc" title="Save X.509 certificate." alt="" coords="667,255,753,280"/>
<area shape="rect" href="classFile__X509.html#a96ee8b07aceb37a5d949447f7349bf12" title="Validate a signature." alt="" coords="191,379,401,404"/>
<area shape="rect" href="classFile__X509.html#a1d9888293c71b3fe2d087776ca31c0eb" title="Get the Distinguished Name for a certificate/crl issuer." alt="" coords="468,329,571,355"/>
<area shape="rect" href="classFile__X509.html#ae5fb776b269eef60c472521c6b4dc219" title="Get the Distinguished Name for a certificate/csr subject Alias of getDN()" alt="" coords="464,379,575,404"/>
<area shape="rect" href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa" title="Validate a signature." alt="" coords="5,379,143,404"/>
<area shape="rect" href="classFile__X509.html#ad0f40f609ab964e6a8ddf2439fe98e5d" title="Get an individual Distinguished Name property for a certificate/crl issuer." alt="" coords="454,579,585,604"/>
<area shape="rect" href="classFile__X509.html#a7ef1db256262071ba886eb5335084ecf" title="Get an individual Distinguished Name property for a certificate/csr subject." alt="" coords="449,480,589,505"/>
<area shape="rect" href="classFile__X509.html#afad375b8ebfbf0ed26dc7f1bb74e9ad3" title="Validate an X.509 certificate against a URL." alt="" coords="469,529,570,555"/>
</map>
</div>

</div>
</div>
<a id="a2fa6ee0a38e86ffc0448d5f820fee30d" name="a2fa6ee0a38e86ffc0448d5f820fee30d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fa6ee0a38e86ffc0448d5f820fee30d">&#9670;&#160;</a></span>_iPAddress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_iPAddress </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$address</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper function to build IP Address array. </p>
<p>(IPv6 is not currently supported)</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$address</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04919">4919</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4920</span>    {</div>
<div class="line"><span class="lineno"> 4921</span>        <span class="keywordflow">return</span> array(<span class="stringliteral">&#39;iPAddress&#39;</span> =&gt; $address);</div>
<div class="line"><span class="lineno"> 4922</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad60bc52a972cab9df3fc002a25de16dc" name="ad60bc52a972cab9df3fc002a25de16dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60bc52a972cab9df3fc002a25de16dc">&#9670;&#160;</a></span>_isSubArrayValid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_isSubArrayValid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check for validity of subarray. </p>
<p>This is intended for use in conjunction with _subArrayUnchecked(), implementing the checks included in _subArray() but without copying a potentially large array by passing its reference by-value to is_array().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$root</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean @access private </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04240">4240</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4241</span>    {</div>
<div class="line"><span class="lineno"> 4242</span>        <span class="keywordflow">if</span> (!is_array($root)) {</div>
<div class="line"><span class="lineno"> 4243</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4244</span>        }</div>
<div class="line"><span class="lineno"> 4245</span> </div>
<div class="line"><span class="lineno"> 4246</span>        <span class="keywordflow">foreach</span> (explode(<span class="charliteral">&#39;/&#39;</span>, $path) as $i) {</div>
<div class="line"><span class="lineno"> 4247</span>            <span class="keywordflow">if</span> (!is_array($root)) {</div>
<div class="line"><span class="lineno"> 4248</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4249</span>            }</div>
<div class="line"><span class="lineno"> 4250</span> </div>
<div class="line"><span class="lineno"> 4251</span>            <span class="keywordflow">if</span> (!isset($root[$i])) {</div>
<div class="line"><span class="lineno"> 4252</span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4253</span>            }</div>
<div class="line"><span class="lineno"> 4254</span> </div>
<div class="line"><span class="lineno"> 4255</span>            $root = $root[$i];</div>
<div class="line"><span class="lineno"> 4256</span>        }</div>
<div class="line"><span class="lineno"> 4257</span> </div>
<div class="line"><span class="lineno"> 4258</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4259</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l01767">_mapInAttributes()</a>, <a class="el" href="X509_8php_source.html#l03521">loadCRL()</a>, and <a class="el" href="X509_8php_source.html#l01497">loadX509()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ad60bc52a972cab9df3fc002a25de16dc_icgraph.png" border="0" usemap="#aclassFile__X509_ad60bc52a972cab9df3fc002a25de16dc_icgraph" alt=""/></div>
<map name="aclassFile__X509_ad60bc52a972cab9df3fc002a25de16dc_icgraph" id="aclassFile__X509_ad60bc52a972cab9df3fc002a25de16dc_icgraph">
<area shape="rect" title="Check for validity of subarray." alt="" coords="435,55,565,80"/>
<area shape="rect" href="classFile__X509.html#acab7579764a0d5973b94cd8bf1c64092" title="Map attribute values from ANY type to attribute&#45;specific internal format." alt="" coords="252,5,387,31"/>
<area shape="rect" href="classFile__X509.html#a0379465670a36ea3a1d2e9a34ea21405" title="Load a Certificate Revocation List." alt="" coords="282,55,357,80"/>
<area shape="rect" href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376" title="Load X.509 certificate." alt="" coords="278,104,361,129"/>
<area shape="rect" href="classFile__X509.html#aa71d96486f43146d0ff5fa6e46167853" title="Load a Certificate Signing Request." alt="" coords="128,5,204,31"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="5,5,80,31"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="129,55,203,80"/>
<area shape="rect" href="classFile__X509.html#a89783012156bb16439adcba84bca93d8" title="Load an X.509 certificate as a certificate authority." alt="" coords="132,104,200,129"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="141,153,191,179"/>
</map>
</div>

</div>
</div>
<a id="acab7579764a0d5973b94cd8bf1c64092" name="acab7579764a0d5973b94cd8bf1c64092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acab7579764a0d5973b94cd8bf1c64092">&#9670;&#160;</a></span>_mapInAttributes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_mapInAttributes </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$asn1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map attribute values from ANY type to attribute-specific internal format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$root</td><td>(by reference) </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td></td></tr>
    <tr><td class="paramtype">object</td><td class="paramname">$asn1</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l01767">1767</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1768</span>    {</div>
<div class="line"><span class="lineno"> 1769</span>        $attributes = &amp;$this-&gt;_subArray($root, $path);</div>
<div class="line"><span class="lineno"> 1770</span> </div>
<div class="line"><span class="lineno"> 1771</span>        <span class="keywordflow">if</span> (is_array($attributes)) {</div>
<div class="line"><span class="lineno"> 1772</span>            <span class="keywordflow">for</span> ($i = 0; $i &lt; count($attributes); $i++) {</div>
<div class="line"><span class="lineno"> 1773</span>                $id = $attributes[$i][<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><span class="lineno"> 1774</span>                <span class="comment">/* $value contains the DER encoding of an ASN.1 value</span></div>
<div class="line"><span class="lineno"> 1775</span><span class="comment">                   corresponding to the attribute type identified by type */</span></div>
<div class="line"><span class="lineno"> 1776</span>                $map = $this-&gt;_getMapping($id);</div>
<div class="line"><span class="lineno"> 1777</span>                <span class="keywordflow">if</span> (is_array($attributes[$i][<span class="stringliteral">&#39;value&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1778</span>                    $values = &amp;$attributes[$i][<span class="stringliteral">&#39;value&#39;</span>];</div>
<div class="line"><span class="lineno"> 1779</span>                    <span class="keywordflow">for</span> ($j = 0; $j &lt; count($values); $j++) {</div>
<div class="line"><span class="lineno"> 1780</span>                        $value = $asn1-&gt;encodeDER($values[$j], $this-&gt;AttributeValue);</div>
<div class="line"><span class="lineno"> 1781</span>                        $decoded = $asn1-&gt;decodeBER($value);</div>
<div class="line"><span class="lineno"> 1782</span>                        <span class="keywordflow">if</span> (!is_bool($map)) {</div>
<div class="line"><span class="lineno"> 1783</span>                            $mapped = $asn1-&gt;asn1map($decoded[0], $map);</div>
<div class="line"><span class="lineno"> 1784</span>                            <span class="keywordflow">if</span> ($mapped !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1785</span>                                $values[$j] = $mapped;</div>
<div class="line"><span class="lineno"> 1786</span>                            }</div>
<div class="line"><span class="lineno"> 1787</span>                            <span class="keywordflow">if</span> ($id == <span class="stringliteral">&#39;pkcs-9-at-extensionRequest&#39;</span> &amp;&amp; $this-&gt;_isSubArrayValid($values, $j)) {</div>
<div class="line"><span class="lineno"> 1788</span>                                $this-&gt;_mapInExtensions($values, $j, $asn1);</div>
<div class="line"><span class="lineno"> 1789</span>                            }</div>
<div class="line"><span class="lineno"> 1790</span>                        } elseif ($map) {</div>
<div class="line"><span class="lineno"> 1791</span>                            $values[$j] = base64_encode($value);</div>
<div class="line"><span class="lineno"> 1792</span>                        }</div>
<div class="line"><span class="lineno"> 1793</span>                    }</div>
<div class="line"><span class="lineno"> 1794</span>                }</div>
<div class="line"><span class="lineno"> 1795</span>            }</div>
<div class="line"><span class="lineno"> 1796</span>        }</div>
<div class="line"><span class="lineno"> 1797</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l01911">_getMapping()</a>, <a class="el" href="X509_8php_source.html#l04240">_isSubArrayValid()</a>, <a class="el" href="X509_8php_source.html#l01648">_mapInExtensions()</a>, and <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l03259">loadCSR()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_acab7579764a0d5973b94cd8bf1c64092_cgraph.png" border="0" usemap="#aclassFile__X509_acab7579764a0d5973b94cd8bf1c64092_cgraph" alt=""/></div>
<map name="aclassFile__X509_acab7579764a0d5973b94cd8bf1c64092_cgraph" id="aclassFile__X509_acab7579764a0d5973b94cd8bf1c64092_cgraph">
<area shape="rect" title="Map attribute values from ANY type to attribute&#45;specific internal format." alt="" coords="5,56,140,81"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="403,5,510,31"/>
<area shape="rect" href="classFile__X509.html#ad60bc52a972cab9df3fc002a25de16dc" title="Check for validity of subarray." alt="" coords="193,31,324,56"/>
<area shape="rect" href="classFile__X509.html#a0c34c28604781bdc296e7ade6951a734" title="Map extension values from octet string to extension&#45;specific internal format." alt="" coords="188,80,329,105"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="215,129,302,155"/>
<area shape="rect" href="classFile__X509.html#a50d402cfb4c93492899c7a222ddb6803" title="Get a reference to a subarray." alt="" coords="377,80,536,105"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_acab7579764a0d5973b94cd8bf1c64092_icgraph.png" border="0" usemap="#aclassFile__X509_acab7579764a0d5973b94cd8bf1c64092_icgraph" alt=""/></div>
<map name="aclassFile__X509_acab7579764a0d5973b94cd8bf1c64092_icgraph" id="aclassFile__X509_acab7579764a0d5973b94cd8bf1c64092_icgraph">
<area shape="rect" title="Map attribute values from ANY type to attribute&#45;specific internal format." alt="" coords="252,5,387,31"/>
<area shape="rect" href="classFile__X509.html#aa71d96486f43146d0ff5fa6e46167853" title="Load a Certificate Signing Request." alt="" coords="128,5,204,31"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="5,5,80,31"/>
</map>
</div>

</div>
</div>
<a id="a016c0c81b4115631a081d91036c8839f" name="a016c0c81b4115631a081d91036c8839f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a016c0c81b4115631a081d91036c8839f">&#9670;&#160;</a></span>_mapInDNs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_mapInDNs </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$asn1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map DN values from ANY type to DN-specific internal format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$root</td><td>(by reference) </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td></td></tr>
    <tr><td class="paramtype">object</td><td class="paramname">$asn1</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l01851">1851</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1852</span>    {</div>
<div class="line"><span class="lineno"> 1853</span>        $dns = &amp;$this-&gt;_subArray($root, $path);</div>
<div class="line"><span class="lineno"> 1854</span> </div>
<div class="line"><span class="lineno"> 1855</span>        <span class="keywordflow">if</span> (is_array($dns)) {</div>
<div class="line"><span class="lineno"> 1856</span>            <span class="keywordflow">for</span> ($i = 0; $i &lt; count($dns); $i++) {</div>
<div class="line"><span class="lineno"> 1857</span>                <span class="keywordflow">for</span> ($j = 0; $j &lt; count($dns[$i]); $j++) {</div>
<div class="line"><span class="lineno"> 1858</span>                    $type = $dns[$i][$j][<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><span class="lineno"> 1859</span>                    $value = &amp;$dns[$i][$j][<span class="stringliteral">&#39;value&#39;</span>];</div>
<div class="line"><span class="lineno"> 1860</span>                    <span class="keywordflow">if</span> (is_object($value) &amp;&amp; strtolower(get_class($value)) == <span class="stringliteral">&#39;file_asn1_element&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1861</span>                        $map = $this-&gt;_getMapping($type);</div>
<div class="line"><span class="lineno"> 1862</span>                        <span class="keywordflow">if</span> (!is_bool($map)) {</div>
<div class="line"><span class="lineno"> 1863</span>                            $decoded = $asn1-&gt;decodeBER($value);</div>
<div class="line"><span class="lineno"> 1864</span>                            $value = $asn1-&gt;asn1map($decoded[0], $map);</div>
<div class="line"><span class="lineno"> 1865</span>                        }</div>
<div class="line"><span class="lineno"> 1866</span>                    }</div>
<div class="line"><span class="lineno"> 1867</span>                }</div>
<div class="line"><span class="lineno"> 1868</span>            }</div>
<div class="line"><span class="lineno"> 1869</span>        }</div>
<div class="line"><span class="lineno"> 1870</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l01911">_getMapping()</a>, and <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l03521">loadCRL()</a>, <a class="el" href="X509_8php_source.html#l03259">loadCSR()</a>, and <a class="el" href="X509_8php_source.html#l01497">loadX509()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a016c0c81b4115631a081d91036c8839f_cgraph.png" border="0" usemap="#aclassFile__X509_a016c0c81b4115631a081d91036c8839f_cgraph" alt=""/></div>
<map name="aclassFile__X509_a016c0c81b4115631a081d91036c8839f_cgraph" id="aclassFile__X509_a016c0c81b4115631a081d91036c8839f_cgraph">
<area shape="rect" title="Map DN values from ANY type to DN&#45;specific internal format." alt="" coords="5,31,103,56"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="151,5,257,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="161,55,247,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a016c0c81b4115631a081d91036c8839f_icgraph.png" border="0" usemap="#aclassFile__X509_a016c0c81b4115631a081d91036c8839f_icgraph" alt=""/></div>
<map name="aclassFile__X509_a016c0c81b4115631a081d91036c8839f_icgraph" id="aclassFile__X509_a016c0c81b4115631a081d91036c8839f_icgraph">
<area shape="rect" title="Map DN values from ANY type to DN&#45;specific internal format." alt="" coords="259,55,356,80"/>
<area shape="rect" href="classFile__X509.html#a0379465670a36ea3a1d2e9a34ea21405" title="Load a Certificate Revocation List." alt="" coords="132,5,207,31"/>
<area shape="rect" href="classFile__X509.html#aa71d96486f43146d0ff5fa6e46167853" title="Load a Certificate Signing Request." alt="" coords="131,55,207,80"/>
<area shape="rect" href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376" title="Load X.509 certificate." alt="" coords="128,104,211,129"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="5,5,80,31"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="5,55,80,80"/>
<area shape="rect" href="classFile__X509.html#a89783012156bb16439adcba84bca93d8" title="Load an X.509 certificate as a certificate authority." alt="" coords="9,104,77,129"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="18,153,67,179"/>
</map>
</div>

</div>
</div>
<a id="a0c34c28604781bdc296e7ade6951a734" name="a0c34c28604781bdc296e7ade6951a734"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c34c28604781bdc296e7ade6951a734">&#9670;&#160;</a></span>_mapInExtensions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_mapInExtensions </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$asn1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map extension values from octet string to extension-specific internal format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$root</td><td>(by reference) </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td></td></tr>
    <tr><td class="paramtype">object</td><td class="paramname">$asn1</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l01648">1648</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1649</span>    {</div>
<div class="line"><span class="lineno"> 1650</span>        $extensions = &amp;$this-&gt;_subArrayUnchecked($root, $path);</div>
<div class="line"><span class="lineno"> 1651</span> </div>
<div class="line"><span class="lineno"> 1652</span>        <span class="keywordflow">if</span> ($extensions) {</div>
<div class="line"><span class="lineno"> 1653</span>            <span class="keywordflow">for</span> ($i = 0; $i &lt; count($extensions); $i++) {</div>
<div class="line"><span class="lineno"> 1654</span>                $id = $extensions[$i][<span class="stringliteral">&#39;extnId&#39;</span>];</div>
<div class="line"><span class="lineno"> 1655</span>                $value = &amp;$extensions[$i][<span class="stringliteral">&#39;extnValue&#39;</span>];</div>
<div class="line"><span class="lineno"> 1656</span>                $value = base64_decode($value);</div>
<div class="line"><span class="lineno"> 1657</span>                <span class="comment">/* [extnValue] contains the DER encoding of an ASN.1 value</span></div>
<div class="line"><span class="lineno"> 1658</span><span class="comment">                   corresponding to the extension type identified by extnID */</span></div>
<div class="line"><span class="lineno"> 1659</span>                $map = $this-&gt;_getMapping($id);</div>
<div class="line"><span class="lineno"> 1660</span>                <span class="keywordflow">if</span> (!is_bool($map)) {</div>
<div class="line"><span class="lineno"> 1661</span>                    $decoder = $id == <span class="stringliteral">&#39;id-ce-nameConstraints&#39;</span> ?</div>
<div class="line"><span class="lineno"> 1662</span>                        array($this, <span class="stringliteral">&#39;_decodeNameConstraintIP&#39;</span>) :</div>
<div class="line"><span class="lineno"> 1663</span>                        array($this, <span class="stringliteral">&#39;_decodeIP&#39;</span>);</div>
<div class="line"><span class="lineno"> 1664</span>                    $decoded = $asn1-&gt;decodeBER($value);</div>
<div class="line"><span class="lineno"> 1665</span>                    $mapped = $asn1-&gt;asn1map($decoded[0], $map, array(<span class="stringliteral">&#39;iPAddress&#39;</span> =&gt; $decoder));</div>
<div class="line"><span class="lineno"> 1666</span>                    $value = $mapped === <span class="keyword">false</span> ? $decoded[0] : $mapped;</div>
<div class="line"><span class="lineno"> 1667</span> </div>
<div class="line"><span class="lineno"> 1668</span>                    <span class="keywordflow">if</span> ($id == <span class="stringliteral">&#39;id-ce-certificatePolicies&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1669</span>                        <span class="keywordflow">for</span> ($j = 0; $j &lt; count($value); $j++) {</div>
<div class="line"><span class="lineno"> 1670</span>                            <span class="keywordflow">if</span> (!isset($value[$j][<span class="stringliteral">&#39;policyQualifiers&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1671</span>                                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1672</span>                            }</div>
<div class="line"><span class="lineno"> 1673</span>                            <span class="keywordflow">for</span> ($k = 0; $k &lt; count($value[$j][<span class="stringliteral">&#39;policyQualifiers&#39;</span>]); $k++) {</div>
<div class="line"><span class="lineno"> 1674</span>                                $subid = $value[$j][<span class="stringliteral">&#39;policyQualifiers&#39;</span>][$k][<span class="stringliteral">&#39;policyQualifierId&#39;</span>];</div>
<div class="line"><span class="lineno"> 1675</span>                                $map = $this-&gt;_getMapping($subid);</div>
<div class="line"><span class="lineno"> 1676</span>                                $subvalue = &amp;$value[$j][<span class="stringliteral">&#39;policyQualifiers&#39;</span>][$k][<span class="stringliteral">&#39;qualifier&#39;</span>];</div>
<div class="line"><span class="lineno"> 1677</span>                                <span class="keywordflow">if</span> ($map !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1678</span>                                    $decoded = $asn1-&gt;decodeBER($subvalue);</div>
<div class="line"><span class="lineno"> 1679</span>                                    $mapped = $asn1-&gt;asn1map($decoded[0], $map);</div>
<div class="line"><span class="lineno"> 1680</span>                                    $subvalue = $mapped === <span class="keyword">false</span> ? $decoded[0] : $mapped;</div>
<div class="line"><span class="lineno"> 1681</span>                                }</div>
<div class="line"><span class="lineno"> 1682</span>                            }</div>
<div class="line"><span class="lineno"> 1683</span>                        }</div>
<div class="line"><span class="lineno"> 1684</span>                    }</div>
<div class="line"><span class="lineno"> 1685</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1686</span>                    $value = base64_encode($value);</div>
<div class="line"><span class="lineno"> 1687</span>                }</div>
<div class="line"><span class="lineno"> 1688</span>            }</div>
<div class="line"><span class="lineno"> 1689</span>        }</div>
<div class="line"><span class="lineno"> 1690</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l01911">_getMapping()</a>, and <a class="el" href="X509_8php_source.html#l04277">_subArrayUnchecked()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l01767">_mapInAttributes()</a>, <a class="el" href="X509_8php_source.html#l03521">loadCRL()</a>, and <a class="el" href="X509_8php_source.html#l01497">loadX509()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a0c34c28604781bdc296e7ade6951a734_cgraph.png" border="0" usemap="#aclassFile__X509_a0c34c28604781bdc296e7ade6951a734_cgraph" alt=""/></div>
<map name="aclassFile__X509_a0c34c28604781bdc296e7ade6951a734_cgraph" id="aclassFile__X509_a0c34c28604781bdc296e7ade6951a734_cgraph">
<area shape="rect" title="Map extension values from octet string to extension&#45;specific internal format." alt="" coords="5,31,147,56"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="221,5,327,31"/>
<area shape="rect" href="classFile__X509.html#a50d402cfb4c93492899c7a222ddb6803" title="Get a reference to a subarray." alt="" coords="195,55,353,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a0c34c28604781bdc296e7ade6951a734_icgraph.png" border="0" usemap="#aclassFile__X509_a0c34c28604781bdc296e7ade6951a734_icgraph" alt=""/></div>
<map name="aclassFile__X509_a0c34c28604781bdc296e7ade6951a734_icgraph" id="aclassFile__X509_a0c34c28604781bdc296e7ade6951a734_icgraph">
<area shape="rect" title="Map extension values from octet string to extension&#45;specific internal format." alt="" coords="435,55,576,80"/>
<area shape="rect" href="classFile__X509.html#acab7579764a0d5973b94cd8bf1c64092" title="Map attribute values from ANY type to attribute&#45;specific internal format." alt="" coords="252,5,387,31"/>
<area shape="rect" href="classFile__X509.html#a0379465670a36ea3a1d2e9a34ea21405" title="Load a Certificate Revocation List." alt="" coords="282,55,357,80"/>
<area shape="rect" href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376" title="Load X.509 certificate." alt="" coords="278,104,361,129"/>
<area shape="rect" href="classFile__X509.html#aa71d96486f43146d0ff5fa6e46167853" title="Load a Certificate Signing Request." alt="" coords="128,5,204,31"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="5,5,80,31"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="129,55,203,80"/>
<area shape="rect" href="classFile__X509.html#a89783012156bb16439adcba84bca93d8" title="Load an X.509 certificate as a certificate authority." alt="" coords="132,104,200,129"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="141,153,191,179"/>
</map>
</div>

</div>
</div>
<a id="acb6786d74bfd53b1a57ea5f72de69ab5" name="acb6786d74bfd53b1a57ea5f72de69ab5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb6786d74bfd53b1a57ea5f72de69ab5">&#9670;&#160;</a></span>_mapOutAttributes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_mapOutAttributes </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$asn1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map attribute values from attribute-specific internal format to ANY type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$root</td><td>(by reference) </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td></td></tr>
    <tr><td class="paramtype">object</td><td class="paramname">$asn1</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l01808">1808</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1809</span>    {</div>
<div class="line"><span class="lineno"> 1810</span>        $attributes = &amp;$this-&gt;_subArray($root, $path);</div>
<div class="line"><span class="lineno"> 1811</span> </div>
<div class="line"><span class="lineno"> 1812</span>        <span class="keywordflow">if</span> (is_array($attributes)) {</div>
<div class="line"><span class="lineno"> 1813</span>            $size = count($attributes);</div>
<div class="line"><span class="lineno"> 1814</span>            <span class="keywordflow">for</span> ($i = 0; $i &lt; $size; $i++) {</div>
<div class="line"><span class="lineno"> 1815</span>                <span class="comment">/* [value] contains the DER encoding of an ASN.1 value</span></div>
<div class="line"><span class="lineno"> 1816</span><span class="comment">                   corresponding to the attribute type identified by type */</span></div>
<div class="line"><span class="lineno"> 1817</span>                $id = $attributes[$i][<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><span class="lineno"> 1818</span>                $map = $this-&gt;_getMapping($id);</div>
<div class="line"><span class="lineno"> 1819</span>                <span class="keywordflow">if</span> ($map === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1820</span>                    user_error($id . <span class="stringliteral">&#39; is not a currently supported attribute&#39;</span>, E_USER_NOTICE);</div>
<div class="line"><span class="lineno"> 1821</span>                    unset($attributes[$i]);</div>
<div class="line"><span class="lineno"> 1822</span>                } elseif (is_array($attributes[$i][<span class="stringliteral">&#39;value&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1823</span>                    $values = &amp;$attributes[$i][<span class="stringliteral">&#39;value&#39;</span>];</div>
<div class="line"><span class="lineno"> 1824</span>                    <span class="keywordflow">for</span> ($j = 0; $j &lt; count($values); $j++) {</div>
<div class="line"><span class="lineno"> 1825</span>                        <span class="keywordflow">switch</span> ($id) {</div>
<div class="line"><span class="lineno"> 1826</span>                            <span class="keywordflow">case</span> <span class="stringliteral">&#39;pkcs-9-at-extensionRequest&#39;</span>:</div>
<div class="line"><span class="lineno"> 1827</span>                                $this-&gt;_mapOutExtensions($values, $j, $asn1);</div>
<div class="line"><span class="lineno"> 1828</span>                                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1829</span>                        }</div>
<div class="line"><span class="lineno"> 1830</span> </div>
<div class="line"><span class="lineno"> 1831</span>                        <span class="keywordflow">if</span> (!is_bool($map)) {</div>
<div class="line"><span class="lineno"> 1832</span>                            $temp = $asn1-&gt;encodeDER($values[$j], $map);</div>
<div class="line"><span class="lineno"> 1833</span>                            $decoded = $asn1-&gt;decodeBER($temp);</div>
<div class="line"><span class="lineno"> 1834</span>                            $values[$j] = $asn1-&gt;asn1map($decoded[0], $this-&gt;AttributeValue);</div>
<div class="line"><span class="lineno"> 1835</span>                        }</div>
<div class="line"><span class="lineno"> 1836</span>                    }</div>
<div class="line"><span class="lineno"> 1837</span>                }</div>
<div class="line"><span class="lineno"> 1838</span>            }</div>
<div class="line"><span class="lineno"> 1839</span>        }</div>
<div class="line"><span class="lineno"> 1840</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l01911">_getMapping()</a>, <a class="el" href="X509_8php_source.html#l01701">_mapOutExtensions()</a>, and <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l03346">saveCSR()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_acb6786d74bfd53b1a57ea5f72de69ab5_cgraph.png" border="0" usemap="#aclassFile__X509_acb6786d74bfd53b1a57ea5f72de69ab5_cgraph" alt=""/></div>
<map name="aclassFile__X509_acb6786d74bfd53b1a57ea5f72de69ab5_cgraph" id="aclassFile__X509_acb6786d74bfd53b1a57ea5f72de69ab5_cgraph">
<area shape="rect" title="Map attribute values from attribute&#45;specific internal format to ANY type." alt="" coords="5,29,151,55"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="399,5,505,31"/>
<area shape="rect" href="classFile__X509.html#afc612875837ae70595137c6166f90106" title="Map extension values from extension&#45;specific internal format to octet string." alt="" coords="199,29,351,55"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="409,55,495,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_acb6786d74bfd53b1a57ea5f72de69ab5_icgraph.png" border="0" usemap="#aclassFile__X509_acb6786d74bfd53b1a57ea5f72de69ab5_icgraph" alt=""/></div>
<map name="aclassFile__X509_acb6786d74bfd53b1a57ea5f72de69ab5_icgraph" id="aclassFile__X509_acb6786d74bfd53b1a57ea5f72de69ab5_icgraph">
<area shape="rect" title="Map attribute values from attribute&#45;specific internal format to ANY type." alt="" coords="255,5,400,31"/>
<area shape="rect" href="classFile__X509.html#a9c1ab61eb1f01e39614b1fb1a99bd202" title="Save CSR request." alt="" coords="128,5,207,31"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="5,5,80,31"/>
</map>
</div>

</div>
</div>
<a id="add37e36fc7605e4b4d1d6f1dc061983c" name="add37e36fc7605e4b4d1d6f1dc061983c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add37e36fc7605e4b4d1d6f1dc061983c">&#9670;&#160;</a></span>_mapOutDNs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_mapOutDNs </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$asn1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map DN values from DN-specific internal format to ANY type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$root</td><td>(by reference) </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td></td></tr>
    <tr><td class="paramtype">object</td><td class="paramname">$asn1</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l01881">1881</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1882</span>    {</div>
<div class="line"><span class="lineno"> 1883</span>        $dns = &amp;$this-&gt;_subArray($root, $path);</div>
<div class="line"><span class="lineno"> 1884</span> </div>
<div class="line"><span class="lineno"> 1885</span>        <span class="keywordflow">if</span> (is_array($dns)) {</div>
<div class="line"><span class="lineno"> 1886</span>            $size = count($dns);</div>
<div class="line"><span class="lineno"> 1887</span>            <span class="keywordflow">for</span> ($i = 0; $i &lt; $size; $i++) {</div>
<div class="line"><span class="lineno"> 1888</span>                <span class="keywordflow">for</span> ($j = 0; $j &lt; count($dns[$i]); $j++) {</div>
<div class="line"><span class="lineno"> 1889</span>                    $type = $dns[$i][$j][<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><span class="lineno"> 1890</span>                    $value = &amp;$dns[$i][$j][<span class="stringliteral">&#39;value&#39;</span>];</div>
<div class="line"><span class="lineno"> 1891</span>                    <span class="keywordflow">if</span> (is_object($value) &amp;&amp; strtolower(get_class($value)) == <span class="stringliteral">&#39;file_asn1_element&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1892</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1893</span>                    }</div>
<div class="line"><span class="lineno"> 1894</span> </div>
<div class="line"><span class="lineno"> 1895</span>                    $map = $this-&gt;_getMapping($type);</div>
<div class="line"><span class="lineno"> 1896</span>                    <span class="keywordflow">if</span> (!is_bool($map)) {</div>
<div class="line"><span class="lineno"> 1897</span>                        $value = <span class="keyword">new</span> <a class="code hl_class" href="classFile__ASN1__Element.html">File_ASN1_Element</a>($asn1-&gt;encodeDER($value, $map));</div>
<div class="line"><span class="lineno"> 1898</span>                    }</div>
<div class="line"><span class="lineno"> 1899</span>                }</div>
<div class="line"><span class="lineno"> 1900</span>            }</div>
<div class="line"><span class="lineno"> 1901</span>        }</div>
<div class="line"><span class="lineno"> 1902</span>    }</div>
<div class="ttc" id="aclassFile__ASN1__Element_html"><div class="ttname"><a href="classFile__ASN1__Element.html">File_ASN1_Element</a></div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00117">ASN1.php:118</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l01911">_getMapping()</a>, and <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l02882">getDN()</a>, <a class="el" href="X509_8php_source.html#l02776">getDNProp()</a>, <a class="el" href="X509_8php_source.html#l03591">saveCRL()</a>, <a class="el" href="X509_8php_source.html#l03346">saveCSR()</a>, and <a class="el" href="X509_8php_source.html#l01570">saveX509()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_add37e36fc7605e4b4d1d6f1dc061983c_cgraph.png" border="0" usemap="#aclassFile__X509_add37e36fc7605e4b4d1d6f1dc061983c_cgraph" alt=""/></div>
<map name="aclassFile__X509_add37e36fc7605e4b4d1d6f1dc061983c_cgraph" id="aclassFile__X509_add37e36fc7605e4b4d1d6f1dc061983c_cgraph">
<area shape="rect" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="5,31,113,56"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="161,5,268,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="171,55,258,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_add37e36fc7605e4b4d1d6f1dc061983c_icgraph.png" border="0" usemap="#aclassFile__X509_add37e36fc7605e4b4d1d6f1dc061983c_icgraph" alt=""/></div>
<map name="aclassFile__X509_add37e36fc7605e4b4d1d6f1dc061983c_icgraph" id="aclassFile__X509_add37e36fc7605e4b4d1d6f1dc061983c_icgraph">
<area shape="rect" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="777,280,885,305"/>
<area shape="rect" href="classFile__X509.html#a97392a261d56bd64002da7d1e76e8195" title="Get the Distinguished Name for a certificates subject." alt="" coords="652,58,715,84"/>
<area shape="rect" href="classFile__X509.html#aa5e331e0ded7b3d7a76452ba6ff70194" title="Get Distinguished Name properties." alt="" coords="637,205,729,230"/>
<area shape="rect" href="classFile__X509.html#a9ea29c41d328dc397c2f1de19a178696" title="Save Certificate Revocation List." alt="" coords="644,280,723,305"/>
<area shape="rect" href="classFile__X509.html#a9c1ab61eb1f01e39614b1fb1a99bd202" title="Save CSR request." alt="" coords="644,329,723,354"/>
<area shape="rect" href="classFile__X509.html#af8e8019a921e4c0651e807c7c1644fcc" title="Save X.509 certificate." alt="" coords="640,378,727,404"/>
<area shape="rect" href="classFile__X509.html#a96ee8b07aceb37a5d949447f7349bf12" title="Validate a signature." alt="" coords="191,8,401,33"/>
<area shape="rect" href="classFile__X509.html#a1d9888293c71b3fe2d087776ca31c0eb" title="Get the Distinguished Name for a certificate/crl issuer." alt="" coords="468,33,571,58"/>
<area shape="rect" href="classFile__X509.html#ae5fb776b269eef60c472521c6b4dc219" title="Get the Distinguished Name for a certificate/csr subject Alias of getDN()" alt="" coords="464,82,575,108"/>
<area shape="rect" href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa" title="Validate a signature." alt="" coords="5,8,143,33"/>
<area shape="rect" href="classFile__X509.html#ad0f40f609ab964e6a8ddf2439fe98e5d" title="Get an individual Distinguished Name property for a certificate/crl issuer." alt="" coords="454,132,585,157"/>
<area shape="rect" href="classFile__X509.html#a7ef1db256262071ba886eb5335084ecf" title="Get an individual Distinguished Name property for a certificate/csr subject." alt="" coords="449,181,589,206"/>
<area shape="rect" href="classFile__X509.html#afad375b8ebfbf0ed26dc7f1bb74e9ad3" title="Validate an X.509 certificate against a URL." alt="" coords="469,230,570,256"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="482,280,557,305"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="482,329,557,354"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="495,378,544,404"/>
</map>
</div>

</div>
</div>
<a id="afc612875837ae70595137c6166f90106" name="afc612875837ae70595137c6166f90106"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc612875837ae70595137c6166f90106">&#9670;&#160;</a></span>_mapOutExtensions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_mapOutExtensions </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$asn1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map extension values from extension-specific internal format to octet string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$root</td><td>(by reference) </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td></td></tr>
    <tr><td class="paramtype">object</td><td class="paramname">$asn1</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l01701">1701</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1702</span>    {</div>
<div class="line"><span class="lineno"> 1703</span>        $extensions = &amp;$this-&gt;_subArray($root, $path);</div>
<div class="line"><span class="lineno"> 1704</span> </div>
<div class="line"><span class="lineno"> 1705</span>        <span class="keywordflow">if</span> (is_array($extensions)) {</div>
<div class="line"><span class="lineno"> 1706</span>            $size = count($extensions);</div>
<div class="line"><span class="lineno"> 1707</span>            <span class="keywordflow">for</span> ($i = 0; $i &lt; $size; $i++) {</div>
<div class="line"><span class="lineno"> 1708</span>                <span class="keywordflow">if</span> (is_object($extensions[$i]) &amp;&amp; strtolower(get_class($extensions[$i])) == <span class="stringliteral">&#39;file_asn1_element&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1709</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1710</span>                }</div>
<div class="line"><span class="lineno"> 1711</span> </div>
<div class="line"><span class="lineno"> 1712</span>                $id = $extensions[$i][<span class="stringliteral">&#39;extnId&#39;</span>];</div>
<div class="line"><span class="lineno"> 1713</span>                $value = &amp;$extensions[$i][<span class="stringliteral">&#39;extnValue&#39;</span>];</div>
<div class="line"><span class="lineno"> 1714</span> </div>
<div class="line"><span class="lineno"> 1715</span>                <span class="keywordflow">switch</span> ($id) {</div>
<div class="line"><span class="lineno"> 1716</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-certificatePolicies&#39;</span>:</div>
<div class="line"><span class="lineno"> 1717</span>                        <span class="keywordflow">for</span> ($j = 0; $j &lt; count($value); $j++) {</div>
<div class="line"><span class="lineno"> 1718</span>                            <span class="keywordflow">if</span> (!isset($value[$j][<span class="stringliteral">&#39;policyQualifiers&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1719</span>                                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1720</span>                            }</div>
<div class="line"><span class="lineno"> 1721</span>                            <span class="keywordflow">for</span> ($k = 0; $k &lt; count($value[$j][<span class="stringliteral">&#39;policyQualifiers&#39;</span>]); $k++) {</div>
<div class="line"><span class="lineno"> 1722</span>                                $subid = $value[$j][<span class="stringliteral">&#39;policyQualifiers&#39;</span>][$k][<span class="stringliteral">&#39;policyQualifierId&#39;</span>];</div>
<div class="line"><span class="lineno"> 1723</span>                                $map = $this-&gt;<a class="code hl_function" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f">_getMapping</a>($subid);</div>
<div class="line"><span class="lineno"> 1724</span>                                $subvalue = &amp;$value[$j][<span class="stringliteral">&#39;policyQualifiers&#39;</span>][$k][<span class="stringliteral">&#39;qualifier&#39;</span>];</div>
<div class="line"><span class="lineno"> 1725</span>                                <span class="keywordflow">if</span> ($map !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1726</span>                                    <span class="comment">// by default File_ASN1 will try to render qualifier as a FILE_ASN1_TYPE_IA5_STRING since it&#39;s</span></div>
<div class="line"><span class="lineno"> 1727</span>                                    <span class="comment">// actual type is FILE_ASN1_TYPE_ANY</span></div>
<div class="line"><span class="lineno"> 1728</span>                                    $subvalue = <span class="keyword">new</span> <a class="code hl_class" href="classFile__ASN1__Element.html">File_ASN1_Element</a>($asn1-&gt;encodeDER($subvalue, $map));</div>
<div class="line"><span class="lineno"> 1729</span>                                }</div>
<div class="line"><span class="lineno"> 1730</span>                            }</div>
<div class="line"><span class="lineno"> 1731</span>                        }</div>
<div class="line"><span class="lineno"> 1732</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1733</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-ce-authorityKeyIdentifier&#39;</span>: <span class="comment">// use 00 as the serial number instead of an empty string</span></div>
<div class="line"><span class="lineno"> 1734</span>                        <span class="keywordflow">if</span> (isset($value[<span class="stringliteral">&#39;authorityCertSerialNumber&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1735</span>                            <span class="keywordflow">if</span> ($value[<span class="stringliteral">&#39;authorityCertSerialNumber&#39;</span>]-&gt;toBytes() == <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1736</span>                                $temp = chr((<a class="code hl_variable" href="ASN1_8php.html#ac0ccdf6580b85de79b4a0dc084f285f0">FILE_ASN1_CLASS_CONTEXT_SPECIFIC</a> &lt;&lt; 6) | 2) . <span class="stringliteral">&quot;\1\0&quot;</span>;</div>
<div class="line"><span class="lineno"> 1737</span>                                $value[<span class="stringliteral">&#39;authorityCertSerialNumber&#39;</span>] = <span class="keyword">new</span> <a class="code hl_class" href="classFile__ASN1__Element.html">File_ASN1_Element</a>($temp);</div>
<div class="line"><span class="lineno"> 1738</span>                            }</div>
<div class="line"><span class="lineno"> 1739</span>                        }</div>
<div class="line"><span class="lineno"> 1740</span>                }</div>
<div class="line"><span class="lineno"> 1741</span> </div>
<div class="line"><span class="lineno"> 1742</span>                <span class="comment">/* [extnValue] contains the DER encoding of an ASN.1 value</span></div>
<div class="line"><span class="lineno"> 1743</span><span class="comment">                   corresponding to the extension type identified by extnID */</span></div>
<div class="line"><span class="lineno"> 1744</span>                $map = $this-&gt;<a class="code hl_function" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f">_getMapping</a>($id);</div>
<div class="line"><span class="lineno"> 1745</span>                <span class="keywordflow">if</span> (is_bool($map)) {</div>
<div class="line"><span class="lineno"> 1746</span>                    <span class="keywordflow">if</span> (!$map) {</div>
<div class="line"><span class="lineno"> 1747</span>                        user_error($id . <span class="stringliteral">&#39; is not a currently supported extension&#39;</span>);</div>
<div class="line"><span class="lineno"> 1748</span>                        unset($extensions[$i]);</div>
<div class="line"><span class="lineno"> 1749</span>                    }</div>
<div class="line"><span class="lineno"> 1750</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1751</span>                    $temp = $asn1-&gt;encodeDER($value, $map, array(<span class="stringliteral">&#39;iPAddress&#39;</span> =&gt; array($this, <span class="stringliteral">&#39;_encodeIP&#39;</span>)));</div>
<div class="line"><span class="lineno"> 1752</span>                    $value = base64_encode($temp);</div>
<div class="line"><span class="lineno"> 1753</span>                }</div>
<div class="line"><span class="lineno"> 1754</span>            }</div>
<div class="line"><span class="lineno"> 1755</span>        }</div>
<div class="line"><span class="lineno"> 1756</span>    }</div>
<div class="ttc" id="aASN1_8php_html_ac0ccdf6580b85de79b4a0dc084f285f0"><div class="ttname"><a href="ASN1_8php.html#ac0ccdf6580b85de79b4a0dc084f285f0">FILE_ASN1_CLASS_CONTEXT_SPECIFIC</a></div><div class="ttdeci">const FILE_ASN1_CLASS_CONTEXT_SPECIFIC</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00050">ASN1.php:50</a></div></div>
<div class="ttc" id="aclassFile__X509_html_ab691691d441dc6983a12a28ab3e0db1f"><div class="ttname"><a href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f">File_X509\_getMapping</a></div><div class="ttdeci">_getMapping($extnId)</div><div class="ttdoc">Associate an extension ID to an extension mapping.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l01911">X509.php:1911</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l01911">_getMapping()</a>, <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>, and <a class="el" href="ASN1_8php_source.html#l00050">FILE_ASN1_CLASS_CONTEXT_SPECIFIC</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l01808">_mapOutAttributes()</a>, <a class="el" href="X509_8php_source.html#l03591">saveCRL()</a>, and <a class="el" href="X509_8php_source.html#l01570">saveX509()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_afc612875837ae70595137c6166f90106_cgraph.png" border="0" usemap="#aclassFile__X509_afc612875837ae70595137c6166f90106_cgraph" alt=""/></div>
<map name="aclassFile__X509_afc612875837ae70595137c6166f90106_cgraph" id="aclassFile__X509_afc612875837ae70595137c6166f90106_cgraph">
<area shape="rect" title="Map extension values from extension&#45;specific internal format to octet string." alt="" coords="5,31,157,56"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="205,5,312,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="215,55,302,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_afc612875837ae70595137c6166f90106_icgraph.png" border="0" usemap="#aclassFile__X509_afc612875837ae70595137c6166f90106_icgraph" alt=""/></div>
<map name="aclassFile__X509_afc612875837ae70595137c6166f90106_icgraph" id="aclassFile__X509_afc612875837ae70595137c6166f90106_icgraph">
<area shape="rect" title="Map extension values from extension&#45;specific internal format to octet string." alt="" coords="448,55,600,80"/>
<area shape="rect" href="classFile__X509.html#acb6786d74bfd53b1a57ea5f72de69ab5" title="Map attribute values from attribute&#45;specific internal format to ANY type." alt="" coords="255,5,400,31"/>
<area shape="rect" href="classFile__X509.html#a9ea29c41d328dc397c2f1de19a178696" title="Save Certificate Revocation List." alt="" coords="288,55,367,80"/>
<area shape="rect" href="classFile__X509.html#af8e8019a921e4c0651e807c7c1644fcc" title="Save X.509 certificate." alt="" coords="284,104,371,129"/>
<area shape="rect" href="classFile__X509.html#a9c1ab61eb1f01e39614b1fb1a99bd202" title="Save CSR request." alt="" coords="128,5,207,31"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="5,5,80,31"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="130,55,205,80"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="143,104,192,129"/>
</map>
</div>

</div>
</div>
<a id="a195dac5d2b72ef86fe28250ea43343b8" name="a195dac5d2b72ef86fe28250ea43343b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a195dac5d2b72ef86fe28250ea43343b8">&#9670;&#160;</a></span>_reformatKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_reformatKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reformat public keys. </p>
<p>Reformats a public key to a format supported by phpseclib (if applicable)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$algorithm</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02546">2546</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2547</span>    {</div>
<div class="line"><span class="lineno"> 2548</span>        <span class="keywordflow">switch</span> ($algorithm) {</div>
<div class="line"><span class="lineno"> 2549</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;rsaEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 2550</span>                <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno"> 2551</span>                    <span class="stringliteral">&quot;-----BEGIN RSA PUBLIC KEY-----\r\n&quot;</span> .</div>
<div class="line"><span class="lineno"> 2552</span>                    <span class="comment">// subjectPublicKey is stored as a bit string in X.509 certs.  the first byte of a bit string represents how many bits</span></div>
<div class="line"><span class="lineno"> 2553</span>                    <span class="comment">// in the last byte should be ignored.  the following only supports non-zero stuff but as none of the X.509 certs Firefox</span></div>
<div class="line"><span class="lineno"> 2554</span>                    <span class="comment">// uses as a cert authority actually use a non-zero bit I think it&#39;s safe to assume that none do.</span></div>
<div class="line"><span class="lineno"> 2555</span>                    chunk_split(base64_encode(substr(base64_decode($key), 1)), 64) .</div>
<div class="line"><span class="lineno"> 2556</span>                    <span class="stringliteral">&#39;-----END RSA PUBLIC KEY-----&#39;</span>;</div>
<div class="line"><span class="lineno"> 2557</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2558</span>                <span class="keywordflow">return</span> $key;</div>
<div class="line"><span class="lineno"> 2559</span>        }</div>
<div class="line"><span class="lineno"> 2560</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l03259">loadCSR()</a>, <a class="el" href="X509_8php_source.html#l03401">loadSPKAC()</a>, and <a class="el" href="X509_8php_source.html#l01497">loadX509()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a195dac5d2b72ef86fe28250ea43343b8_icgraph.png" border="0" usemap="#aclassFile__X509_a195dac5d2b72ef86fe28250ea43343b8_icgraph" alt=""/></div>
<map name="aclassFile__X509_a195dac5d2b72ef86fe28250ea43343b8_icgraph" id="aclassFile__X509_a195dac5d2b72ef86fe28250ea43343b8_icgraph">
<area shape="rect" title="Reformat public keys." alt="" coords="287,55,397,80"/>
<area shape="rect" href="classFile__X509.html#aa71d96486f43146d0ff5fa6e46167853" title="Load a Certificate Signing Request." alt="" coords="154,5,230,31"/>
<area shape="rect" href="classFile__X509.html#ae796e46a18066a3b745a279fad143dbb" title="Load a SPKAC CSR." alt="" coords="145,55,239,80"/>
<area shape="rect" href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376" title="Load X.509 certificate." alt="" coords="151,104,233,129"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="14,5,89,31"/>
<area shape="rect" href="classFile__X509.html#a7579e46dcabbf3bff17d8e31f1b2cb25" title="Sign a SPKAC." alt="" coords="5,55,97,80"/>
<area shape="rect" href="classFile__X509.html#a89783012156bb16439adcba84bca93d8" title="Load an X.509 certificate as a certificate authority." alt="" coords="17,104,85,129"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="27,153,76,179"/>
</map>
</div>

</div>
</div>
<a id="ac16dd74cbc682e06b2f35875d04582d1" name="ac16dd74cbc682e06b2f35875d04582d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac16dd74cbc682e06b2f35875d04582d1">&#9670;&#160;</a></span>_removeExtension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_removeExtension </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$path</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove an Extension. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$id</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td>optional @access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04395">4395</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4396</span>    {</div>
<div class="line"><span class="lineno"> 4397</span>        $extensions = &amp;$this-&gt;_extensions($this-&gt;currentCert, $path);</div>
<div class="line"><span class="lineno"> 4398</span> </div>
<div class="line"><span class="lineno"> 4399</span>        <span class="keywordflow">if</span> (!is_array($extensions)) {</div>
<div class="line"><span class="lineno"> 4400</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4401</span>        }</div>
<div class="line"><span class="lineno"> 4402</span> </div>
<div class="line"><span class="lineno"> 4403</span>        $result = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4404</span>        <span class="keywordflow">foreach</span> ($extensions as $key =&gt; $value) {</div>
<div class="line"><span class="lineno"> 4405</span>            <span class="keywordflow">if</span> ($value[<span class="stringliteral">&#39;extnId&#39;</span>] == $id) {</div>
<div class="line"><span class="lineno"> 4406</span>                unset($extensions[$key]);</div>
<div class="line"><span class="lineno"> 4407</span>                $result = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4408</span>            }</div>
<div class="line"><span class="lineno"> 4409</span>        }</div>
<div class="line"><span class="lineno"> 4410</span> </div>
<div class="line"><span class="lineno"> 4411</span>        $extensions = array_values($extensions);</div>
<div class="line"><span class="lineno"> 4412</span>        <span class="comment">// fix for https://bugs.php.net/75433 affecting PHP 7.2</span></div>
<div class="line"><span class="lineno"> 4413</span>        <span class="keywordflow">if</span> (!isset($extensions[0])) {</div>
<div class="line"><span class="lineno"> 4414</span>            $extensions = array_splice($extensions, 0, 0);</div>
<div class="line"><span class="lineno"> 4415</span>        }</div>
<div class="line"><span class="lineno"> 4416</span>        <span class="keywordflow">return</span> $result;</div>
<div class="line"><span class="lineno"> 4417</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04341">_extensions()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l04512">removeExtension()</a>, and <a class="el" href="X509_8php_source.html#l05061">removeRevokedCertificateExtension()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ac16dd74cbc682e06b2f35875d04582d1_cgraph.png" border="0" usemap="#aclassFile__X509_ac16dd74cbc682e06b2f35875d04582d1_cgraph" alt=""/></div>
<map name="aclassFile__X509_ac16dd74cbc682e06b2f35875d04582d1_cgraph" id="aclassFile__X509_ac16dd74cbc682e06b2f35875d04582d1_cgraph">
<area shape="rect" title="Remove an Extension." alt="" coords="5,5,148,31"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="196,5,296,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="344,5,431,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ac16dd74cbc682e06b2f35875d04582d1_icgraph.png" border="0" usemap="#aclassFile__X509_ac16dd74cbc682e06b2f35875d04582d1_icgraph" alt=""/></div>
<map name="aclassFile__X509_ac16dd74cbc682e06b2f35875d04582d1_icgraph" id="aclassFile__X509_ac16dd74cbc682e06b2f35875d04582d1_icgraph">
<area shape="rect" title="Remove an Extension." alt="" coords="371,59,513,84"/>
<area shape="rect" href="classFile__X509.html#aa75a9d891292eeddcbf00060e36c0695" title="Remove a certificate, CSR or CRL Extension." alt="" coords="157,29,293,55"/>
<area shape="rect" href="classFile__X509.html#a436596da8ebdb29da908604cc2c0b1b5" title="Remove a Revoked Certificate Extension." alt="" coords="128,79,323,119"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="18,5,67,31"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="5,55,80,80"/>
</map>
</div>

</div>
</div>
<a id="a8fd951ac4d21092f644bd6528c171bcb" name="a8fd951ac4d21092f644bd6528c171bcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fd951ac4d21092f644bd6528c171bcb">&#9670;&#160;</a></span>_revokedCertificate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_revokedCertificate </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$rclist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$serial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$create</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the index of a revoked certificate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$rclist</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$serial</td><td></td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$create</td><td>optional @access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int|false </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04933">4933</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4934</span>    {</div>
<div class="line"><span class="lineno"> 4935</span>        $serial = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($serial);</div>
<div class="line"><span class="lineno"> 4936</span> </div>
<div class="line"><span class="lineno"> 4937</span>        <span class="keywordflow">foreach</span> ($rclist as $i =&gt; $rc) {</div>
<div class="line"><span class="lineno"> 4938</span>            <span class="keywordflow">if</span> (!($serial-&gt;compare($rc[<span class="stringliteral">&#39;userCertificate&#39;</span>]))) {</div>
<div class="line"><span class="lineno"> 4939</span>                <span class="keywordflow">return</span> $i;</div>
<div class="line"><span class="lineno"> 4940</span>            }</div>
<div class="line"><span class="lineno"> 4941</span>        }</div>
<div class="line"><span class="lineno"> 4942</span> </div>
<div class="line"><span class="lineno"> 4943</span>        <span class="keywordflow">if</span> (!$create) {</div>
<div class="line"><span class="lineno"> 4944</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4945</span>        }</div>
<div class="line"><span class="lineno"> 4946</span> </div>
<div class="line"><span class="lineno"> 4947</span>        <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;DateTime&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 4948</span>            $revocationDate = @date(<span class="stringliteral">&#39;D, d M Y H:i:s O&#39;</span>);</div>
<div class="line"><span class="lineno"> 4949</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4950</span>            $revocationDate = <span class="keyword">new</span> DateTime(<span class="stringliteral">&#39;now&#39;</span>, <span class="keyword">new</span> DateTimeZone(@date_default_timezone_get()));</div>
<div class="line"><span class="lineno"> 4951</span>            $revocationDate = $revocationDate-&gt;format(<span class="stringliteral">&#39;D, d M Y H:i:s O&#39;</span>);</div>
<div class="line"><span class="lineno"> 4952</span>        }</div>
<div class="line"><span class="lineno"> 4953</span> </div>
<div class="line"><span class="lineno"> 4954</span>        $i = count($rclist);</div>
<div class="line"><span class="lineno"> 4955</span>        $rclist[] = array(<span class="stringliteral">&#39;userCertificate&#39;</span> =&gt; $serial,</div>
<div class="line"><span class="lineno"> 4956</span>                          <span class="stringliteral">&#39;revocationDate&#39;</span>  =&gt; $this-&gt;<a class="code hl_function" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089">_timeField</a>($revocationDate));</div>
<div class="line"><span class="lineno"> 4957</span>        <span class="keywordflow">return</span> $i;</div>
<div class="line"><span class="lineno"> 4958</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_a8aecc48efc4e9677b47bd540fc26a089"><div class="ttname"><a href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089">File_X509\_timeField</a></div><div class="ttdeci">_timeField($date)</div><div class="ttdoc">Helper function to build a time field according to RFC 3280 section.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l03653">X509.php:3653</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l03653">_timeField()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l05014">getRevoked()</a>, <a class="el" href="X509_8php_source.html#l05083">getRevokedCertificateExtension()</a>, <a class="el" href="X509_8php_source.html#l05106">getRevokedCertificateExtensions()</a>, <a class="el" href="X509_8php_source.html#l05061">removeRevokedCertificateExtension()</a>, <a class="el" href="X509_8php_source.html#l04968">revoke()</a>, <a class="el" href="X509_8php_source.html#l05132">setRevokedCertificateExtension()</a>, and <a class="el" href="X509_8php_source.html#l04994">unrevoke()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a8fd951ac4d21092f644bd6528c171bcb_cgraph.png" border="0" usemap="#aclassFile__X509_a8fd951ac4d21092f644bd6528c171bcb_cgraph" alt=""/></div>
<map name="aclassFile__X509_a8fd951ac4d21092f644bd6528c171bcb_cgraph" id="aclassFile__X509_a8fd951ac4d21092f644bd6528c171bcb_cgraph">
<area shape="rect" title="Get the index of a revoked certificate." alt="" coords="5,5,153,31"/>
<area shape="rect" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089" title="Helper function to build a time field according to RFC 3280 section." alt="" coords="201,5,292,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a8fd951ac4d21092f644bd6528c171bcb_icgraph.png" border="0" usemap="#aclassFile__X509_a8fd951ac4d21092f644bd6528c171bcb_icgraph" alt=""/></div>
<map name="aclassFile__X509_a8fd951ac4d21092f644bd6528c171bcb_icgraph" id="aclassFile__X509_a8fd951ac4d21092f644bd6528c171bcb_icgraph">
<area shape="rect" title="Get the index of a revoked certificate." alt="" coords="291,161,439,187"/>
<area shape="rect" href="classFile__X509.html#aa1bb98de862919e64965b293697f3b8d" title="Get a revoked certificate." alt="" coords="75,5,173,31"/>
<area shape="rect" href="classFile__X509.html#a402e41419a2999b330874e39d0dd2a34" title="Get a Revoked Certificate Extension." alt="" coords="9,55,239,80"/>
<area shape="rect" href="classFile__X509.html#a2b45d9da1caa86e25f79910036ad8eee" title="Returns a list of all extensions in use for a given revoked certificate." alt="" coords="5,104,243,129"/>
<area shape="rect" href="classFile__X509.html#a436596da8ebdb29da908604cc2c0b1b5" title="Remove a Revoked Certificate Extension." alt="" coords="27,154,221,194"/>
<area shape="rect" href="classFile__X509.html#a9d0898bce518129997e439126cde0c96" title="Revoke a certificate." alt="" coords="91,219,157,244"/>
<area shape="rect" href="classFile__X509.html#a28ba1f404bda71c06dc86b209616f53d" title="Set a Revoked Certificate Extension." alt="" coords="9,268,239,293"/>
<area shape="rect" href="classFile__X509.html#a8ca4f043b6d009999c7b86d6f8b939cc" title="Unrevoke a certificate." alt="" coords="83,317,165,343"/>
</map>
</div>

</div>
</div>
<a id="a28a18c05603a638bcb114897dffeee6d" name="a28a18c05603a638bcb114897dffeee6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28a18c05603a638bcb114897dffeee6d">&#9670;&#160;</a></span>_setExtension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_setExtension </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$critical</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$replace</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$path</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set an Extension. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$id</td><td></td></tr>
    <tr><td class="paramtype">mixed</td><td class="paramname">$value</td><td></td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$critical</td><td>optional </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$replace</td><td>optional </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td>optional @access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04480">4480</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4481</span>    {</div>
<div class="line"><span class="lineno"> 4482</span>        $extensions = &amp;$this-&gt;_extensions($this-&gt;currentCert, $path, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 4483</span> </div>
<div class="line"><span class="lineno"> 4484</span>        <span class="keywordflow">if</span> (!is_array($extensions)) {</div>
<div class="line"><span class="lineno"> 4485</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4486</span>        }</div>
<div class="line"><span class="lineno"> 4487</span> </div>
<div class="line"><span class="lineno"> 4488</span>        $newext = array(<span class="stringliteral">&#39;extnId&#39;</span>  =&gt; $id, <span class="stringliteral">&#39;critical&#39;</span> =&gt; $critical, <span class="stringliteral">&#39;extnValue&#39;</span> =&gt; $value);</div>
<div class="line"><span class="lineno"> 4489</span> </div>
<div class="line"><span class="lineno"> 4490</span>        <span class="keywordflow">foreach</span> ($extensions as $key =&gt; $value) {</div>
<div class="line"><span class="lineno"> 4491</span>            <span class="keywordflow">if</span> ($value[<span class="stringliteral">&#39;extnId&#39;</span>] == $id) {</div>
<div class="line"><span class="lineno"> 4492</span>                <span class="keywordflow">if</span> (!$replace) {</div>
<div class="line"><span class="lineno"> 4493</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4494</span>                }</div>
<div class="line"><span class="lineno"> 4495</span> </div>
<div class="line"><span class="lineno"> 4496</span>                $extensions[$key] = $newext;</div>
<div class="line"><span class="lineno"> 4497</span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4498</span>            }</div>
<div class="line"><span class="lineno"> 4499</span>        }</div>
<div class="line"><span class="lineno"> 4500</span> </div>
<div class="line"><span class="lineno"> 4501</span>        $extensions[] = $newext;</div>
<div class="line"><span class="lineno"> 4502</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4503</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04341">_extensions()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l04554">setExtension()</a>, and <a class="el" href="X509_8php_source.html#l05132">setRevokedCertificateExtension()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a28a18c05603a638bcb114897dffeee6d_cgraph.png" border="0" usemap="#aclassFile__X509_a28a18c05603a638bcb114897dffeee6d_cgraph" alt=""/></div>
<map name="aclassFile__X509_a28a18c05603a638bcb114897dffeee6d_cgraph" id="aclassFile__X509_a28a18c05603a638bcb114897dffeee6d_cgraph">
<area shape="rect" title="Set an Extension." alt="" coords="5,5,119,31"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="167,5,267,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="315,5,401,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a28a18c05603a638bcb114897dffeee6d_icgraph.png" border="0" usemap="#aclassFile__X509_a28a18c05603a638bcb114897dffeee6d_icgraph" alt=""/></div>
<map name="aclassFile__X509_a28a18c05603a638bcb114897dffeee6d_icgraph" id="aclassFile__X509_a28a18c05603a638bcb114897dffeee6d_icgraph">
<area shape="rect" title="Set an Extension." alt="" coords="405,55,519,80"/>
<area shape="rect" href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f" title="Set a certificate, CSR or CRL Extension." alt="" coords="189,29,296,55"/>
<area shape="rect" href="classFile__X509.html#a28ba1f404bda71c06dc86b209616f53d" title="Set a Revoked Certificate Extension." alt="" coords="128,79,357,104"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="18,5,67,31"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="5,55,80,80"/>
</map>
</div>

</div>
</div>
<a id="a26cf1092c86fba52e8cc1bc078ab0b60" name="a26cf1092c86fba52e8cc1bc078ab0b60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26cf1092c86fba52e8cc1bc078ab0b60">&#9670;&#160;</a></span>_sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_sign </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$signatureAlgorithm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>X.509 certificate signing helper function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">object</td><td class="paramname">$key</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$signatureAlgorithm</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04137">4137</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4138</span>    {</div>
<div class="line"><span class="lineno"> 4139</span>        <span class="keywordflow">switch</span> (strtolower(get_class($key))) {</div>
<div class="line"><span class="lineno"> 4140</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;crypt_rsa&#39;</span>:</div>
<div class="line"><span class="lineno"> 4141</span>                <span class="keywordflow">switch</span> ($signatureAlgorithm) {</div>
<div class="line"><span class="lineno"> 4142</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;md2WithRSAEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 4143</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;md5WithRSAEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 4144</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha1WithRSAEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 4145</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha224WithRSAEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 4146</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha256WithRSAEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 4147</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha384WithRSAEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 4148</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha512WithRSAEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 4149</span>                        $key-&gt;setHash(preg_replace(<span class="stringliteral">&#39;#WithRSAEncryption$#&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $signatureAlgorithm));</div>
<div class="line"><span class="lineno"> 4150</span>                        $key-&gt;setSignatureMode(<a class="code hl_variable" href="RSA_8php.html#a8df70582b0c278da510047e13441d495">CRYPT_RSA_SIGNATURE_PKCS1</a>);</div>
<div class="line"><span class="lineno"> 4151</span> </div>
<div class="line"><span class="lineno"> 4152</span>                        $this-&gt;currentCert[<span class="stringliteral">&#39;signature&#39;</span>] = base64_encode(<span class="stringliteral">&quot;\0&quot;</span> . $key-&gt;sign($this-&gt;signatureSubject));</div>
<div class="line"><span class="lineno"> 4153</span>                        <span class="keywordflow">return</span> $this-&gt;currentCert;</div>
<div class="line"><span class="lineno"> 4154</span>                }</div>
<div class="line"><span class="lineno"> 4155</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 4156</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4157</span>        }</div>
<div class="line"><span class="lineno"> 4158</span>    }</div>
<div class="ttc" id="aRSA_8php_html_a8df70582b0c278da510047e13441d495"><div class="ttname"><a href="RSA_8php.html#a8df70582b0c278da510047e13441d495">CRYPT_RSA_SIGNATURE_PKCS1</a></div><div class="ttdeci">const CRYPT_RSA_SIGNATURE_PKCS1</div><div class="ttdoc">Use the PKCS#1 scheme by default.</div><div class="ttdef"><b>Definition:</b> <a href="RSA_8php_source.html#l00140">RSA.php:140</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RSA_8php_source.html#l00140">CRYPT_RSA_SIGNATURE_PKCS1</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l03684">sign()</a>, <a class="el" href="X509_8php_source.html#l04004">signCRL()</a>, <a class="el" href="X509_8php_source.html#l03876">signCSR()</a>, and <a class="el" href="X509_8php_source.html#l03934">signSPKAC()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a26cf1092c86fba52e8cc1bc078ab0b60_icgraph.png" border="0" usemap="#aclassFile__X509_a26cf1092c86fba52e8cc1bc078ab0b60_icgraph" alt=""/></div>
<map name="aclassFile__X509_a26cf1092c86fba52e8cc1bc078ab0b60_icgraph" id="aclassFile__X509_a26cf1092c86fba52e8cc1bc078ab0b60_icgraph">
<area shape="rect" title="X.509 certificate signing helper function." alt="" coords="145,80,201,105"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="27,5,76,31"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="14,55,89,80"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="14,104,89,129"/>
<area shape="rect" href="classFile__X509.html#a7579e46dcabbf3bff17d8e31f1b2cb25" title="Sign a SPKAC." alt="" coords="5,153,97,179"/>
</map>
</div>

</div>
</div>
<a id="aa200f8fe0af46a9daef5d95bfe2ce471" name="aa200f8fe0af46a9daef5d95bfe2ce471"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa200f8fe0af46a9daef5d95bfe2ce471">&#9670;&#160;</a></span>_subArray()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">&amp; _subArray </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$create</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a reference to a subarray. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$root</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td>absolute path with / as component separator </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$create</td><td>optional @access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array|false </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04305">4305</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4306</span>    {</div>
<div class="line"><span class="lineno"> 4307</span>        $false = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4308</span> </div>
<div class="line"><span class="lineno"> 4309</span>        <span class="keywordflow">if</span> (!is_array($root)) {</div>
<div class="line"><span class="lineno"> 4310</span>            <span class="keywordflow">return</span> $false;</div>
<div class="line"><span class="lineno"> 4311</span>        }</div>
<div class="line"><span class="lineno"> 4312</span> </div>
<div class="line"><span class="lineno"> 4313</span>        <span class="keywordflow">foreach</span> (explode(<span class="charliteral">&#39;/&#39;</span>, $path) as $i) {</div>
<div class="line"><span class="lineno"> 4314</span>            <span class="keywordflow">if</span> (!is_array($root)) {</div>
<div class="line"><span class="lineno"> 4315</span>                <span class="keywordflow">return</span> $false;</div>
<div class="line"><span class="lineno"> 4316</span>            }</div>
<div class="line"><span class="lineno"> 4317</span> </div>
<div class="line"><span class="lineno"> 4318</span>            <span class="keywordflow">if</span> (!isset($root[$i])) {</div>
<div class="line"><span class="lineno"> 4319</span>                <span class="keywordflow">if</span> (!$create) {</div>
<div class="line"><span class="lineno"> 4320</span>                    <span class="keywordflow">return</span> $false;</div>
<div class="line"><span class="lineno"> 4321</span>                }</div>
<div class="line"><span class="lineno"> 4322</span> </div>
<div class="line"><span class="lineno"> 4323</span>                $root[$i] = array();</div>
<div class="line"><span class="lineno"> 4324</span>            }</div>
<div class="line"><span class="lineno"> 4325</span> </div>
<div class="line"><span class="lineno"> 4326</span>            $root = &amp;$root[$i];</div>
<div class="line"><span class="lineno"> 4327</span>        }</div>
<div class="line"><span class="lineno"> 4328</span> </div>
<div class="line"><span class="lineno"> 4329</span>        <span class="keywordflow">return</span> $root;</div>
<div class="line"><span class="lineno"> 4330</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l04341">_extensions()</a>, <a class="el" href="X509_8php_source.html#l01767">_mapInAttributes()</a>, <a class="el" href="X509_8php_source.html#l01851">_mapInDNs()</a>, <a class="el" href="X509_8php_source.html#l01808">_mapOutAttributes()</a>, <a class="el" href="X509_8php_source.html#l01881">_mapOutDNs()</a>, <a class="el" href="X509_8php_source.html#l01701">_mapOutExtensions()</a>, <a class="el" href="X509_8php_source.html#l04618">getAttribute()</a>, <a class="el" href="X509_8php_source.html#l04658">getAttributes()</a>, <a class="el" href="X509_8php_source.html#l03213">getPublicKey()</a>, <a class="el" href="X509_8php_source.html#l05014">getRevoked()</a>, <a class="el" href="X509_8php_source.html#l05083">getRevokedCertificateExtension()</a>, <a class="el" href="X509_8php_source.html#l05106">getRevokedCertificateExtensions()</a>, <a class="el" href="X509_8php_source.html#l05032">listRevoked()</a>, <a class="el" href="X509_8php_source.html#l04567">removeAttribute()</a>, <a class="el" href="X509_8php_source.html#l05061">removeRevokedCertificateExtension()</a>, <a class="el" href="X509_8php_source.html#l04968">revoke()</a>, <a class="el" href="X509_8php_source.html#l03591">saveCRL()</a>, <a class="el" href="X509_8php_source.html#l03346">saveCSR()</a>, <a class="el" href="X509_8php_source.html#l03478">saveSPKAC()</a>, <a class="el" href="X509_8php_source.html#l01570">saveX509()</a>, <a class="el" href="X509_8php_source.html#l04685">setAttribute()</a>, <a class="el" href="X509_8php_source.html#l05132">setRevokedCertificateExtension()</a>, and <a class="el" href="X509_8php_source.html#l04994">unrevoke()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_aa200f8fe0af46a9daef5d95bfe2ce471_icgraph.png" border="0" usemap="#aclassFile__X509_aa200f8fe0af46a9daef5d95bfe2ce471_icgraph" alt=""/></div>
<map name="aclassFile__X509_aa200f8fe0af46a9daef5d95bfe2ce471_icgraph" id="aclassFile__X509_aa200f8fe0af46a9daef5d95bfe2ce471_icgraph">
<area shape="rect" title="Get a reference to a subarray." alt="" coords="1149,711,1236,736"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="975,660,1075,685"/>
<area shape="rect" href="classFile__X509.html#a402e41419a2999b330874e39d0dd2a34" title="Get a Revoked Certificate Extension." alt="" coords="474,892,705,917"/>
<area shape="rect" href="classFile__X509.html#a2b45d9da1caa86e25f79910036ad8eee" title="Returns a list of all extensions in use for a given revoked certificate." alt="" coords="471,793,708,819"/>
<area shape="rect" href="classFile__X509.html#a436596da8ebdb29da908604cc2c0b1b5" title="Remove a Revoked Certificate Extension." alt="" coords="492,531,687,571"/>
<area shape="rect" href="classFile__X509.html#a28ba1f404bda71c06dc86b209616f53d" title="Set a Revoked Certificate Extension." alt="" coords="475,596,704,621"/>
<area shape="rect" href="classFile__X509.html#acab7579764a0d5973b94cd8bf1c64092" title="Map attribute values from ANY type to attribute&#45;specific internal format." alt="" coords="958,37,1093,63"/>
<area shape="rect" href="classFile__X509.html#a016c0c81b4115631a081d91036c8839f" title="Map DN values from ANY type to DN&#45;specific internal format." alt="" coords="780,101,877,127"/>
<area shape="rect" href="classFile__X509.html#acb6786d74bfd53b1a57ea5f72de69ab5" title="Map attribute values from attribute&#45;specific internal format to ANY type." alt="" coords="756,229,901,255"/>
<area shape="rect" href="classFile__X509.html#a9c1ab61eb1f01e39614b1fb1a99bd202" title="Save CSR request." alt="" coords="550,156,629,181"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="971,405,1079,431"/>
<area shape="rect" href="classFile__X509.html#a9ea29c41d328dc397c2f1de19a178696" title="Save Certificate Revocation List." alt="" coords="789,481,868,507"/>
<area shape="rect" href="classFile__X509.html#af8e8019a921e4c0651e807c7c1644fcc" title="Save X.509 certificate." alt="" coords="785,279,872,304"/>
<area shape="rect" href="classFile__X509.html#afc612875837ae70595137c6166f90106" title="Map extension values from extension&#45;specific internal format to octet string." alt="" coords="949,352,1101,377"/>
<area shape="rect" href="classFile__X509.html#aa161754e2510ae51e94934eaf50ebb9d" title="Get a CSR attribute." alt="" coords="975,812,1075,837"/>
<area shape="rect" href="classFile__X509.html#a359f6dfafc17a1d4c9386f5539056825" title="Returns a list of all CSR attributes in use." alt="" coords="972,861,1079,887"/>
<area shape="rect" href="classFile__X509.html#afc841edb470c7b8c50e78daaf634228a" title="Gets the public key." alt="" coords="972,911,1079,936"/>
<area shape="rect" href="classFile__X509.html#aa1bb98de862919e64965b293697f3b8d" title="Get a revoked certificate." alt="" coords="976,960,1075,985"/>
<area shape="rect" href="classFile__X509.html#aa81e0f1f5f3b4d42074cb6cdc69f6434" title="List revoked certificates." alt="" coords="976,1009,1075,1035"/>
<area shape="rect" href="classFile__X509.html#acd0554eb35727bf8349119bc5a239059" title="Remove a CSR attribute." alt="" coords="961,1059,1090,1084"/>
<area shape="rect" href="classFile__X509.html#a4c4215dc2b69bac52080d9f174dbfcd6" title="Set a CSR attribute." alt="" coords="779,1084,878,1109"/>
<area shape="rect" href="classFile__X509.html#a9d0898bce518129997e439126cde0c96" title="Revoke a certificate." alt="" coords="992,1160,1059,1185"/>
<area shape="rect" href="classFile__X509.html#ac6079ff51d79eadb1bb21c2342f9d0d0" title="Save a SPKAC CSR request." alt="" coords="977,1209,1073,1235"/>
<area shape="rect" href="classFile__X509.html#a8ca4f043b6d009999c7b86d6f8b939cc" title="Unrevoke a certificate." alt="" coords="984,1259,1067,1284"/>
<area shape="rect" href="classFile__X509.html#a51d0ffadbcbf965b23238b89fef03484" title="Get an Extension." alt="" coords="771,836,886,861"/>
<area shape="rect" href="classFile__X509.html#a7dfd9393f164e45947bac81e5bc97d7f" title="Returns a list of all extensions in use." alt="" coords="768,735,889,760"/>
<area shape="rect" href="classFile__X509.html#ac16dd74cbc682e06b2f35875d04582d1" title="Remove an Extension." alt="" coords="757,685,900,711"/>
<area shape="rect" href="classFile__X509.html#a28a18c05603a638bcb114897dffeee6d" title="Set an Extension." alt="" coords="772,636,885,661"/>
<area shape="rect" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb" title="Get a certificate, CSR or CRL Extension." alt="" coords="536,843,643,868"/>
<area shape="rect" href="classFile__X509.html#acc2e876f81f33f786d44175e43f96727" title="Validates an intermediate cert as identified via authority info access extension." alt="" coords="264,843,423,868"/>
<area shape="rect" href="classFile__X509.html#a96ee8b07aceb37a5d949447f7349bf12" title="Validate a signature." alt="" coords="5,740,216,765"/>
<area shape="rect" href="classFile__X509.html#a72aefa3de97ff30a83063abc3b8ce568" title="Get the certificate chain for the current cert." alt="" coords="303,892,383,917"/>
<area shape="rect" href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376" title="Load X.509 certificate." alt="" coords="302,156,385,181"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="86,640,135,665"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="306,540,381,565"/>
<area shape="rect" href="classFile__X509.html#afad375b8ebfbf0ed26dc7f1bb74e9ad3" title="Validate an X.509 certificate against a URL." alt="" coords="293,589,394,615"/>
<area shape="rect" href="classFile__X509.html#a89783012156bb16439adcba84bca93d8" title="Load an X.509 certificate as a certificate authority." alt="" coords="77,156,145,181"/>
<area shape="rect" href="classFile__X509.html#a67b2aa40ccd2623250367494b69280c4" title="Returns a list of all extensions in use in certificate, CSR or CRL." alt="" coords="532,744,647,769"/>
<area shape="rect" href="classFile__X509.html#aa75a9d891292eeddcbf00060e36c0695" title="Remove a certificate, CSR or CRL Extension." alt="" coords="521,695,657,720"/>
<area shape="rect" href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f" title="Set a certificate, CSR or CRL Extension." alt="" coords="536,645,643,671"/>
<area shape="rect" href="classFile__X509.html#aa71d96486f43146d0ff5fa6e46167853" title="Load a Certificate Signing Request." alt="" coords="551,5,627,31"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="306,56,381,81"/>
<area shape="rect" href="classFile__X509.html#a0379465670a36ea3a1d2e9a34ea21405" title="Load a Certificate Revocation List." alt="" coords="552,107,627,132"/>
<area shape="rect" href="classFile__X509.html#a97392a261d56bd64002da7d1e76e8195" title="Get the Distinguished Name for a certificates subject." alt="" coords="558,380,621,405"/>
<area shape="rect" href="classFile__X509.html#aa5e331e0ded7b3d7a76452ba6ff70194" title="Get Distinguished Name properties." alt="" coords="783,380,875,405"/>
<area shape="rect" href="classFile__X509.html#a1d9888293c71b3fe2d087776ca31c0eb" title="Get the Distinguished Name for a certificate/crl issuer." alt="" coords="292,380,395,405"/>
<area shape="rect" href="classFile__X509.html#ae5fb776b269eef60c472521c6b4dc219" title="Get the Distinguished Name for a certificate/csr subject Alias of getDN()" alt="" coords="288,481,399,507"/>
<area shape="rect" href="classFile__X509.html#ad0f40f609ab964e6a8ddf2439fe98e5d" title="Get an individual Distinguished Name property for a certificate/crl issuer." alt="" coords="524,307,655,332"/>
<area shape="rect" href="classFile__X509.html#a7ef1db256262071ba886eb5335084ecf" title="Get an individual Distinguished Name property for a certificate/csr subject." alt="" coords="519,257,659,283"/>
<area shape="rect" href="classFile__X509.html#a7579e46dcabbf3bff17d8e31f1b2cb25" title="Sign a SPKAC." alt="" coords="783,1209,875,1235"/>
</map>
</div>

</div>
</div>
<a id="a50d402cfb4c93492899c7a222ddb6803" name="a50d402cfb4c93492899c7a222ddb6803"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50d402cfb4c93492899c7a222ddb6803">&#9670;&#160;</a></span>_subArrayUnchecked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">&amp; _subArrayUnchecked </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$create</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a reference to a subarray. </p>
<p>This variant of _subArray() does no is_array() checking, so $root should be checked with _isSubArrayValid() first.</p>
<p>This is here for performance reasons: Passing a reference (i.e. $root) by-value (i.e. to is_array()) creates a copy. If $root is an especially large array, this is expensive.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$root</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td>absolute path with / as component separator </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$create</td><td>optional @access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array|false </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04277">4277</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4278</span>    {</div>
<div class="line"><span class="lineno"> 4279</span>        $false = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4280</span> </div>
<div class="line"><span class="lineno"> 4281</span>        <span class="keywordflow">foreach</span> (explode(<span class="charliteral">&#39;/&#39;</span>, $path) as $i) {</div>
<div class="line"><span class="lineno"> 4282</span>            <span class="keywordflow">if</span> (!isset($root[$i])) {</div>
<div class="line"><span class="lineno"> 4283</span>                <span class="keywordflow">if</span> (!$create) {</div>
<div class="line"><span class="lineno"> 4284</span>                    <span class="keywordflow">return</span> $false;</div>
<div class="line"><span class="lineno"> 4285</span>                }</div>
<div class="line"><span class="lineno"> 4286</span> </div>
<div class="line"><span class="lineno"> 4287</span>                $root[$i] = array();</div>
<div class="line"><span class="lineno"> 4288</span>            }</div>
<div class="line"><span class="lineno"> 4289</span> </div>
<div class="line"><span class="lineno"> 4290</span>            $root = &amp;$root[$i];</div>
<div class="line"><span class="lineno"> 4291</span>        }</div>
<div class="line"><span class="lineno"> 4292</span> </div>
<div class="line"><span class="lineno"> 4293</span>        <span class="keywordflow">return</span> $root;</div>
<div class="line"><span class="lineno"> 4294</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l01648">_mapInExtensions()</a>, and <a class="el" href="X509_8php_source.html#l03521">loadCRL()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a50d402cfb4c93492899c7a222ddb6803_icgraph.png" border="0" usemap="#aclassFile__X509_a50d402cfb4c93492899c7a222ddb6803_icgraph" alt=""/></div>
<map name="aclassFile__X509_a50d402cfb4c93492899c7a222ddb6803_icgraph" id="aclassFile__X509_a50d402cfb4c93492899c7a222ddb6803_icgraph">
<area shape="rect" title="Get a reference to a subarray." alt="" coords="624,128,783,153"/>
<area shape="rect" href="classFile__X509.html#a0c34c28604781bdc296e7ade6951a734" title="Map extension values from octet string to extension&#45;specific internal format." alt="" coords="435,103,576,128"/>
<area shape="rect" href="classFile__X509.html#a0379465670a36ea3a1d2e9a34ea21405" title="Load a Certificate Revocation List." alt="" coords="282,153,357,179"/>
<area shape="rect" href="classFile__X509.html#acab7579764a0d5973b94cd8bf1c64092" title="Map attribute values from ANY type to attribute&#45;specific internal format." alt="" coords="252,104,387,129"/>
<area shape="rect" href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376" title="Load X.509 certificate." alt="" coords="278,55,361,80"/>
<area shape="rect" href="classFile__X509.html#aa71d96486f43146d0ff5fa6e46167853" title="Load a Certificate Signing Request." alt="" coords="128,104,204,129"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="5,104,80,129"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="129,153,203,179"/>
<area shape="rect" href="classFile__X509.html#a89783012156bb16439adcba84bca93d8" title="Load an X.509 certificate as a certificate authority." alt="" coords="132,5,200,31"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="141,55,191,80"/>
</map>
</div>

</div>
</div>
<a id="acc2e876f81f33f786d44175e43f96727" name="acc2e876f81f33f786d44175e43f96727"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc2e876f81f33f786d44175e43f96727">&#9670;&#160;</a></span>_testForIntermediate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_testForIntermediate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$caonly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validates an intermediate cert as identified via authority info access extension. </p>
<p>See <a href="https://tools.ietf.org/html/rfc4325">https://tools.ietf.org/html/rfc4325</a> for more info</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">bool</td><td class="paramname">$caonly</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$count</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02249">2249</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2250</span>    {</div>
<div class="line"><span class="lineno"> 2251</span>        $opts = $this-&gt;getExtension(<span class="stringliteral">&#39;id-pe-authorityInfoAccess&#39;</span>);</div>
<div class="line"><span class="lineno"> 2252</span>        <span class="keywordflow">if</span> (!is_array($opts)) {</div>
<div class="line"><span class="lineno"> 2253</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2254</span>        }</div>
<div class="line"><span class="lineno"> 2255</span>        <span class="keywordflow">foreach</span> ($opts as $opt) {</div>
<div class="line"><span class="lineno"> 2256</span>            <span class="keywordflow">if</span> ($opt[<span class="stringliteral">&#39;accessMethod&#39;</span>] == <span class="stringliteral">&#39;id-ad-caIssuers&#39;</span>) {</div>
<div class="line"><span class="lineno"> 2257</span>                <span class="comment">// accessLocation is a GeneralName. GeneralName fields support stuff like email addresses, IP addresses, LDAP,</span></div>
<div class="line"><span class="lineno"> 2258</span>                <span class="comment">// etc, but we&#39;re only supporting URI&#39;s. URI&#39;s and LDAP are the only thing https://tools.ietf.org/html/rfc4325</span></div>
<div class="line"><span class="lineno"> 2259</span>                <span class="comment">// discusses</span></div>
<div class="line"><span class="lineno"> 2260</span>                <span class="keywordflow">if</span> (isset($opt[<span class="stringliteral">&#39;accessLocation&#39;</span>][<span class="stringliteral">&#39;uniformResourceIdentifier&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2261</span>                    $url = $opt[<span class="stringliteral">&#39;accessLocation&#39;</span>][<span class="stringliteral">&#39;uniformResourceIdentifier&#39;</span>];</div>
<div class="line"><span class="lineno"> 2262</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2263</span>                }</div>
<div class="line"><span class="lineno"> 2264</span>            }</div>
<div class="line"><span class="lineno"> 2265</span>        }</div>
<div class="line"><span class="lineno"> 2266</span> </div>
<div class="line"><span class="lineno"> 2267</span>        <span class="keywordflow">if</span> (!isset($url)) {</div>
<div class="line"><span class="lineno"> 2268</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2269</span>        }</div>
<div class="line"><span class="lineno"> 2270</span> </div>
<div class="line"><span class="lineno"> 2271</span>        $cert = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a84e2629a56c47e5e90ab3a2a0aaf1bda">_fetchURL</a>($url);</div>
<div class="line"><span class="lineno"> 2272</span>        <span class="keywordflow">if</span> (!is_string($cert)) {</div>
<div class="line"><span class="lineno"> 2273</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2274</span>        }</div>
<div class="line"><span class="lineno"> 2275</span> </div>
<div class="line"><span class="lineno"> 2276</span>        $parent = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__X509.html">File_X509</a>();</div>
<div class="line"><span class="lineno"> 2277</span>        $parent-&gt;CAs = $this-&gt;CAs;</div>
<div class="line"><span class="lineno"> 2278</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2279</span><span class="comment">         &quot;Conforming applications that support HTTP or FTP for accessing</span></div>
<div class="line"><span class="lineno"> 2280</span><span class="comment">          certificates MUST be able to accept .cer files and SHOULD be able</span></div>
<div class="line"><span class="lineno"> 2281</span><span class="comment">          to accept .p7c files.&quot; -- https://tools.ietf.org/html/rfc4325</span></div>
<div class="line"><span class="lineno"> 2282</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 2283</span><span class="comment">         A .p7c file is &#39;a &quot;certs-only&quot; CMS message as specified in RFC 2797&quot;</span></div>
<div class="line"><span class="lineno"> 2284</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 2285</span><span class="comment">         These are currently unsupported</span></div>
<div class="line"><span class="lineno"> 2286</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 2287</span>        <span class="keywordflow">if</span> (!is_array($parent-&gt;loadX509($cert))) {</div>
<div class="line"><span class="lineno"> 2288</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2289</span>        }</div>
<div class="line"><span class="lineno"> 2290</span> </div>
<div class="line"><span class="lineno"> 2291</span>        <span class="keywordflow">if</span> (!$parent-&gt;_validateSignatureCountable($caonly, ++$count)) {</div>
<div class="line"><span class="lineno"> 2292</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2293</span>        }</div>
<div class="line"><span class="lineno"> 2294</span> </div>
<div class="line"><span class="lineno"> 2295</span>        $this-&gt;CAs[] = $parent-&gt;currentCert;</div>
<div class="line"><span class="lineno"> 2296</span>        <span class="comment">//$this-&gt;loadCA($cert);</span></div>
<div class="line"><span class="lineno"> 2297</span> </div>
<div class="line"><span class="lineno"> 2298</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2299</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_a84e2629a56c47e5e90ab3a2a0aaf1bda"><div class="ttname"><a href="classFile__X509.html#a84e2629a56c47e5e90ab3a2a0aaf1bda">File_X509\_fetchURL</a></div><div class="ttdeci">_fetchURL($url)</div><div class="ttdoc">Fetches a URL.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l02193">X509.php:2193</a></div></div>
<div class="ttc" id="anamespaceFile__X509_html"><div class="ttname"><a href="namespaceFile__X509.html">File_X509</a></div><div class="ttdoc">Pure-PHP X.509 Parser.</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l02193">_fetchURL()</a>, and <a class="el" href="X509_8php_source.html#l04527">getExtension()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l02331">_validateSignatureCountable()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_acc2e876f81f33f786d44175e43f96727_cgraph.png" border="0" usemap="#aclassFile__X509_acc2e876f81f33f786d44175e43f96727_cgraph" alt=""/></div>
<map name="aclassFile__X509_acc2e876f81f33f786d44175e43f96727_cgraph" id="aclassFile__X509_acc2e876f81f33f786d44175e43f96727_cgraph">
<area shape="rect" title="Validates an intermediate cert as identified via authority info access extension." alt="" coords="5,31,164,56"/>
<area shape="rect" href="classFile__X509.html#a84e2629a56c47e5e90ab3a2a0aaf1bda" title="Fetches a URL." alt="" coords="221,5,309,31"/>
<area shape="rect" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb" title="Get a certificate, CSR or CRL Extension." alt="" coords="212,55,319,80"/>
<area shape="rect" href="classFile__X509.html#a51d0ffadbcbf965b23238b89fef03484" title="Get an Extension." alt="" coords="367,55,481,80"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="529,55,629,80"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="677,55,764,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_acc2e876f81f33f786d44175e43f96727_icgraph.png" border="0" usemap="#aclassFile__X509_acc2e876f81f33f786d44175e43f96727_icgraph" alt=""/></div>
<map name="aclassFile__X509_acc2e876f81f33f786d44175e43f96727_icgraph" id="aclassFile__X509_acc2e876f81f33f786d44175e43f96727_icgraph">
<area shape="rect" title="Validates an intermediate cert as identified via authority info access extension." alt="" coords="449,5,608,31"/>
<area shape="rect" href="classFile__X509.html#a96ee8b07aceb37a5d949447f7349bf12" title="Validate a signature." alt="" coords="191,5,401,31"/>
<area shape="rect" href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa" title="Validate a signature." alt="" coords="5,5,143,31"/>
</map>
</div>

</div>
</div>
<a id="a8aecc48efc4e9677b47bd540fc26a089" name="a8aecc48efc4e9677b47bd540fc26a089"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8aecc48efc4e9677b47bd540fc26a089">&#9670;&#160;</a></span>_timeField()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_timeField </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$date</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper function to build a time field according to RFC 3280 section. </p>
<ul>
<li>4.1.2.5 Validity</li>
<li>5.1.2.4 This Update</li>
<li>5.1.2.5 Next Update</li>
<li>5.1.2.6 Revoked Certificates by choosing utcTime iff year of date given is before 2050 and generalTime else.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$date</td><td>in format date('D, d M Y H:i:s O') @access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03653">3653</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3654</span>    {</div>
<div class="line"><span class="lineno"> 3655</span>        <span class="keywordflow">if</span> (is_object($date) &amp;&amp; strtolower(get_class($date)) == <span class="stringliteral">&#39;file_asn1_element&#39;</span>) {</div>
<div class="line"><span class="lineno"> 3656</span>            <span class="keywordflow">return</span> $date;</div>
<div class="line"><span class="lineno"> 3657</span>        }</div>
<div class="line"><span class="lineno"> 3658</span>        <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;DateTime&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 3659</span>            $year = @gmdate(<span class="stringliteral">&quot;Y&quot;</span>, @strtotime($date)); <span class="comment">// the same way ASN1.php parses this</span></div>
<div class="line"><span class="lineno"> 3660</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3661</span>            $dateObj = <span class="keyword">new</span> DateTime($date, <span class="keyword">new</span> DateTimeZone(<span class="stringliteral">&#39;GMT&#39;</span>));</div>
<div class="line"><span class="lineno"> 3662</span>            $year = $dateObj-&gt;format(<span class="charliteral">&#39;Y&#39;</span>);</div>
<div class="line"><span class="lineno"> 3663</span>        }</div>
<div class="line"><span class="lineno"> 3664</span>        <span class="keywordflow">if</span> ($year &lt; 2050) {</div>
<div class="line"><span class="lineno"> 3665</span>            <span class="keywordflow">return</span> array(<span class="stringliteral">&#39;utcTime&#39;</span> =&gt; $date);</div>
<div class="line"><span class="lineno"> 3666</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3667</span>            <span class="keywordflow">return</span> array(<span class="stringliteral">&#39;generalTime&#39;</span> =&gt; $date);</div>
<div class="line"><span class="lineno"> 3668</span>        }</div>
<div class="line"><span class="lineno"> 3669</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l04933">_revokedCertificate()</a>, <a class="el" href="X509_8php_source.html#l04968">revoke()</a>, <a class="el" href="X509_8php_source.html#l03684">sign()</a>, and <a class="el" href="X509_8php_source.html#l04004">signCRL()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a8aecc48efc4e9677b47bd540fc26a089_icgraph.png" border="0" usemap="#aclassFile__X509_a8aecc48efc4e9677b47bd540fc26a089_icgraph" alt=""/></div>
<map name="aclassFile__X509_a8aecc48efc4e9677b47bd540fc26a089_icgraph" id="aclassFile__X509_a8aecc48efc4e9677b47bd540fc26a089_icgraph">
<area shape="rect" title="Helper function to build a time field according to RFC 3280 section." alt="" coords="487,319,577,344"/>
<area shape="rect" href="classFile__X509.html#a8fd951ac4d21092f644bd6528c171bcb" title="Get the index of a revoked certificate." alt="" coords="291,191,439,216"/>
<area shape="rect" href="classFile__X509.html#a9d0898bce518129997e439126cde0c96" title="Revoke a certificate." alt="" coords="91,317,157,343"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="340,344,389,369"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="327,393,402,419"/>
<area shape="rect" href="classFile__X509.html#aa1bb98de862919e64965b293697f3b8d" title="Get a revoked certificate." alt="" coords="75,5,173,31"/>
<area shape="rect" href="classFile__X509.html#a402e41419a2999b330874e39d0dd2a34" title="Get a Revoked Certificate Extension." alt="" coords="9,55,239,80"/>
<area shape="rect" href="classFile__X509.html#a2b45d9da1caa86e25f79910036ad8eee" title="Returns a list of all extensions in use for a given revoked certificate." alt="" coords="5,104,243,129"/>
<area shape="rect" href="classFile__X509.html#a436596da8ebdb29da908604cc2c0b1b5" title="Remove a Revoked Certificate Extension." alt="" coords="27,154,221,194"/>
<area shape="rect" href="classFile__X509.html#a28ba1f404bda71c06dc86b209616f53d" title="Set a Revoked Certificate Extension." alt="" coords="9,219,239,244"/>
<area shape="rect" href="classFile__X509.html#a8ca4f043b6d009999c7b86d6f8b939cc" title="Unrevoke a certificate." alt="" coords="83,268,165,293"/>
</map>
</div>

</div>
</div>
<a id="ad4e0267f8e236f9707325bce89ce2b0a" name="ad4e0267f8e236f9707325bce89ce2b0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4e0267f8e236f9707325bce89ce2b0a">&#9670;&#160;</a></span>_translateDNProp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_translateDNProp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$propName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>"Normalizes" a Distinguished Name property </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$propName</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02617">2617</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2618</span>    {</div>
<div class="line"><span class="lineno"> 2619</span>        <span class="keywordflow">switch</span> (strtolower($propName)) {</div>
<div class="line"><span class="lineno"> 2620</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-countryname&#39;</span>:</div>
<div class="line"><span class="lineno"> 2621</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;countryname&#39;</span>:</div>
<div class="line"><span class="lineno"> 2622</span>            <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div>
<div class="line"><span class="lineno"> 2623</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-countryName&#39;</span>;</div>
<div class="line"><span class="lineno"> 2624</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-organizationname&#39;</span>:</div>
<div class="line"><span class="lineno"> 2625</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;organizationname&#39;</span>:</div>
<div class="line"><span class="lineno"> 2626</span>            <span class="keywordflow">case</span> <span class="charliteral">&#39;o&#39;</span>:</div>
<div class="line"><span class="lineno"> 2627</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-organizationName&#39;</span>;</div>
<div class="line"><span class="lineno"> 2628</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-dnqualifier&#39;</span>:</div>
<div class="line"><span class="lineno"> 2629</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;dnqualifier&#39;</span>:</div>
<div class="line"><span class="lineno"> 2630</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-dnQualifier&#39;</span>;</div>
<div class="line"><span class="lineno"> 2631</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-commonname&#39;</span>:</div>
<div class="line"><span class="lineno"> 2632</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;commonname&#39;</span>:</div>
<div class="line"><span class="lineno"> 2633</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;cn&#39;</span>:</div>
<div class="line"><span class="lineno"> 2634</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-commonName&#39;</span>;</div>
<div class="line"><span class="lineno"> 2635</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-stateorprovincename&#39;</span>:</div>
<div class="line"><span class="lineno"> 2636</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;stateorprovincename&#39;</span>:</div>
<div class="line"><span class="lineno"> 2637</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;state&#39;</span>:</div>
<div class="line"><span class="lineno"> 2638</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;province&#39;</span>:</div>
<div class="line"><span class="lineno"> 2639</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;provincename&#39;</span>:</div>
<div class="line"><span class="lineno"> 2640</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;st&#39;</span>:</div>
<div class="line"><span class="lineno"> 2641</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-stateOrProvinceName&#39;</span>;</div>
<div class="line"><span class="lineno"> 2642</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-localityname&#39;</span>:</div>
<div class="line"><span class="lineno"> 2643</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;localityname&#39;</span>:</div>
<div class="line"><span class="lineno"> 2644</span>            <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>:</div>
<div class="line"><span class="lineno"> 2645</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-localityName&#39;</span>;</div>
<div class="line"><span class="lineno"> 2646</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-emailaddress&#39;</span>:</div>
<div class="line"><span class="lineno"> 2647</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;emailaddress&#39;</span>:</div>
<div class="line"><span class="lineno"> 2648</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;pkcs-9-at-emailAddress&#39;</span>;</div>
<div class="line"><span class="lineno"> 2649</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-serialnumber&#39;</span>:</div>
<div class="line"><span class="lineno"> 2650</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;serialnumber&#39;</span>:</div>
<div class="line"><span class="lineno"> 2651</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-serialNumber&#39;</span>;</div>
<div class="line"><span class="lineno"> 2652</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-postalcode&#39;</span>:</div>
<div class="line"><span class="lineno"> 2653</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;postalcode&#39;</span>:</div>
<div class="line"><span class="lineno"> 2654</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-postalCode&#39;</span>;</div>
<div class="line"><span class="lineno"> 2655</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-streetaddress&#39;</span>:</div>
<div class="line"><span class="lineno"> 2656</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;streetaddress&#39;</span>:</div>
<div class="line"><span class="lineno"> 2657</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-streetAddress&#39;</span>;</div>
<div class="line"><span class="lineno"> 2658</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-name&#39;</span>:</div>
<div class="line"><span class="lineno"> 2659</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;name&#39;</span>:</div>
<div class="line"><span class="lineno"> 2660</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-name&#39;</span>;</div>
<div class="line"><span class="lineno"> 2661</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-givenname&#39;</span>:</div>
<div class="line"><span class="lineno"> 2662</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;givenname&#39;</span>:</div>
<div class="line"><span class="lineno"> 2663</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-givenName&#39;</span>;</div>
<div class="line"><span class="lineno"> 2664</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-surname&#39;</span>:</div>
<div class="line"><span class="lineno"> 2665</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;surname&#39;</span>:</div>
<div class="line"><span class="lineno"> 2666</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sn&#39;</span>:</div>
<div class="line"><span class="lineno"> 2667</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-surname&#39;</span>;</div>
<div class="line"><span class="lineno"> 2668</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-initials&#39;</span>:</div>
<div class="line"><span class="lineno"> 2669</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;initials&#39;</span>:</div>
<div class="line"><span class="lineno"> 2670</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-initials&#39;</span>;</div>
<div class="line"><span class="lineno"> 2671</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-generationqualifier&#39;</span>:</div>
<div class="line"><span class="lineno"> 2672</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;generationqualifier&#39;</span>:</div>
<div class="line"><span class="lineno"> 2673</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-generationQualifier&#39;</span>;</div>
<div class="line"><span class="lineno"> 2674</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-organizationalunitname&#39;</span>:</div>
<div class="line"><span class="lineno"> 2675</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;organizationalunitname&#39;</span>:</div>
<div class="line"><span class="lineno"> 2676</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;ou&#39;</span>:</div>
<div class="line"><span class="lineno"> 2677</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-organizationalUnitName&#39;</span>;</div>
<div class="line"><span class="lineno"> 2678</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-pseudonym&#39;</span>:</div>
<div class="line"><span class="lineno"> 2679</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;pseudonym&#39;</span>:</div>
<div class="line"><span class="lineno"> 2680</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-pseudonym&#39;</span>;</div>
<div class="line"><span class="lineno"> 2681</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-title&#39;</span>:</div>
<div class="line"><span class="lineno"> 2682</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;title&#39;</span>:</div>
<div class="line"><span class="lineno"> 2683</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-title&#39;</span>;</div>
<div class="line"><span class="lineno"> 2684</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-description&#39;</span>:</div>
<div class="line"><span class="lineno"> 2685</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;description&#39;</span>:</div>
<div class="line"><span class="lineno"> 2686</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-description&#39;</span>;</div>
<div class="line"><span class="lineno"> 2687</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-role&#39;</span>:</div>
<div class="line"><span class="lineno"> 2688</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;role&#39;</span>:</div>
<div class="line"><span class="lineno"> 2689</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-role&#39;</span>;</div>
<div class="line"><span class="lineno"> 2690</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-uniqueidentifier&#39;</span>:</div>
<div class="line"><span class="lineno"> 2691</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;uniqueidentifier&#39;</span>:</div>
<div class="line"><span class="lineno"> 2692</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;x500uniqueidentifier&#39;</span>:</div>
<div class="line"><span class="lineno"> 2693</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-uniqueIdentifier&#39;</span>;</div>
<div class="line"><span class="lineno"> 2694</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;postaladdress&#39;</span>:</div>
<div class="line"><span class="lineno"> 2695</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-postaladdress&#39;</span>:</div>
<div class="line"><span class="lineno"> 2696</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;id-at-postalAddress&#39;</span>;</div>
<div class="line"><span class="lineno"> 2697</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2698</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2699</span>        }</div>
<div class="line"><span class="lineno"> 2700</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l02776">getDNProp()</a>, <a class="el" href="X509_8php_source.html#l02742">removeDNProp()</a>, and <a class="el" href="X509_8php_source.html#l02711">setDNProp()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ad4e0267f8e236f9707325bce89ce2b0a_icgraph.png" border="0" usemap="#aclassFile__X509_ad4e0267f8e236f9707325bce89ce2b0a_icgraph" alt=""/></div>
<map name="aclassFile__X509_ad4e0267f8e236f9707325bce89ce2b0a_icgraph" id="aclassFile__X509_ad4e0267f8e236f9707325bce89ce2b0a_icgraph">
<area shape="rect" title="&quot;Normalizes&quot; a Distinguished Name property" alt="" coords="363,153,499,179"/>
<area shape="rect" href="classFile__X509.html#aa5e331e0ded7b3d7a76452ba6ff70194" title="Get Distinguished Name properties." alt="" coords="208,80,300,105"/>
<area shape="rect" href="classFile__X509.html#a65782113764c16cb36982e9b29b24fbd" title="Remove Distinguished Name properties." alt="" coords="193,153,315,179"/>
<area shape="rect" href="classFile__X509.html#a6d9811e02579bdb0c26bb527232e79b0" title="Set a Distinguished Name property." alt="" coords="209,203,299,228"/>
<area shape="rect" href="classFile__X509.html#ad0f40f609ab964e6a8ddf2439fe98e5d" title="Get an individual Distinguished Name property for a certificate/crl issuer." alt="" coords="10,5,141,31"/>
<area shape="rect" href="classFile__X509.html#a7ef1db256262071ba886eb5335084ecf" title="Get an individual Distinguished Name property for a certificate/csr subject." alt="" coords="5,55,145,80"/>
<area shape="rect" href="classFile__X509.html#afad375b8ebfbf0ed26dc7f1bb74e9ad3" title="Validate an X.509 certificate against a URL." alt="" coords="25,104,126,129"/>
<area shape="rect" href="classFile__X509.html#ab2400a644664fad908c8bd05995f6c8c" title="Set the domain name&#39;s which the cert is to be valid for." alt="" coords="29,153,122,179"/>
<area shape="rect" href="classFile__X509.html#ab442ee31015d58a277f52d5293a00106" title="Set a Distinguished Name." alt="" coords="44,203,107,228"/>
</map>
</div>

</div>
</div>
<a id="ab87ce13c549a27cee379b3634e7c02f1" name="ab87ce13c549a27cee379b3634e7c02f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab87ce13c549a27cee379b3634e7c02f1">&#9670;&#160;</a></span>_validateSignature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_validateSignature </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$publicKeyAlgorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$publicKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$signatureAlgorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$signatureSubject</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validates a signature. </p>
<p>Returns true if the signature is verified, false if it is not correct or null on error</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$publicKeyAlgorithm</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$publicKey</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$signatureAlgorithm</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$signature</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$signatureSubject</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02464">2464</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2465</span>    {</div>
<div class="line"><span class="lineno"> 2466</span>        global <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>;</div>
<div class="line"><span class="lineno"> 2467</span> </div>
<div class="line"><span class="lineno"> 2468</span>        <span class="keywordflow">switch</span> ($publicKeyAlgorithm) {</div>
<div class="line"><span class="lineno"> 2469</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;rsaEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 2470</span>                <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_RSA&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 2471</span>                    include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/RSA.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 2472</span>                }</div>
<div class="line"><span class="lineno"> 2473</span>                $rsa = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__RSA.html">Crypt_RSA</a>();</div>
<div class="line"><span class="lineno"> 2474</span>                $rsa-&gt;loadKey($publicKey);</div>
<div class="line"><span class="lineno"> 2475</span> </div>
<div class="line"><span class="lineno"> 2476</span>                <span class="keywordflow">switch</span> ($signatureAlgorithm) {</div>
<div class="line"><span class="lineno"> 2477</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;md2WithRSAEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 2478</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;md5WithRSAEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 2479</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha1WithRSAEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 2480</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha224WithRSAEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 2481</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha256WithRSAEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 2482</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha384WithRSAEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 2483</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;sha512WithRSAEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 2484</span>                        $rsa-&gt;setHash(preg_replace(<span class="stringliteral">&#39;#WithRSAEncryption$#&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $signatureAlgorithm));</div>
<div class="line"><span class="lineno"> 2485</span>                        $rsa-&gt;setSignatureMode(<a class="code hl_variable" href="RSA_8php.html#a8df70582b0c278da510047e13441d495">CRYPT_RSA_SIGNATURE_PKCS1</a>);</div>
<div class="line"><span class="lineno"> 2486</span>                        <span class="keywordflow">if</span> (!@$rsa-&gt;verify($signatureSubject, $signature)) {</div>
<div class="line"><span class="lineno"> 2487</span>                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2488</span>                        }</div>
<div class="line"><span class="lineno"> 2489</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2490</span>                    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2491</span>                        <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 2492</span>                }</div>
<div class="line"><span class="lineno"> 2493</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2494</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2495</span>                <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 2496</span>        }</div>
<div class="line"><span class="lineno"> 2497</span> </div>
<div class="line"><span class="lineno"> 2498</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2499</span>    }</div>
<div class="ttc" id="anamespaceCrypt__RSA_html"><div class="ttname"><a href="namespaceCrypt__RSA.html">Crypt_RSA</a></div><div class="ttdoc">#-</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="install_8php_source.html#l00039">$VIEW_PATH</a>, and <a class="el" href="RSA_8php_source.html#l00140">CRYPT_RSA_SIGNATURE_PKCS1</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l02331">_validateSignatureCountable()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ab87ce13c549a27cee379b3634e7c02f1_icgraph.png" border="0" usemap="#aclassFile__X509_ab87ce13c549a27cee379b3634e7c02f1_icgraph" alt=""/></div>
<map name="aclassFile__X509_ab87ce13c549a27cee379b3634e7c02f1_icgraph" id="aclassFile__X509_ab87ce13c549a27cee379b3634e7c02f1_icgraph">
<area shape="rect" title="Validates a signature." alt="" coords="449,5,593,31"/>
<area shape="rect" href="classFile__X509.html#a96ee8b07aceb37a5d949447f7349bf12" title="Validate a signature." alt="" coords="191,5,401,31"/>
<area shape="rect" href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa" title="Validate a signature." alt="" coords="5,5,143,31"/>
</map>
</div>

</div>
</div>
<a id="a96ee8b07aceb37a5d949447f7349bf12" name="a96ee8b07aceb37a5d949447f7349bf12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96ee8b07aceb37a5d949447f7349bf12">&#9670;&#160;</a></span>_validateSignatureCountable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_validateSignatureCountable </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$caonly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validate a signature. </p>
<p>Performs said validation whilst keeping track of how many times validation method is called</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">bool</td><td class="paramname">$caonly</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$count</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02331">2331</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2332</span>    {</div>
<div class="line"><span class="lineno"> 2333</span>        <span class="keywordflow">if</span> (!is_array($this-&gt;currentCert) || !isset($this-&gt;signatureSubject)) {</div>
<div class="line"><span class="lineno"> 2334</span>            <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 2335</span>        }</div>
<div class="line"><span class="lineno"> 2336</span> </div>
<div class="line"><span class="lineno"> 2337</span>        <span class="keywordflow">if</span> ($count == $this-&gt;recur_limit) {</div>
<div class="line"><span class="lineno"> 2338</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2339</span>        }</div>
<div class="line"><span class="lineno"> 2340</span> </div>
<div class="line"><span class="lineno"> 2341</span>        <span class="comment">/* TODO:</span></div>
<div class="line"><span class="lineno"> 2342</span><span class="comment">           &quot;emailAddress attribute values are not case-sensitive (e.g., &quot;subscriber@example.com&quot; is the same as &quot;SUBSCRIBER@EXAMPLE.COM&quot;).&quot;</span></div>
<div class="line"><span class="lineno"> 2343</span><span class="comment">            -- http://tools.ietf.org/html/rfc5280#section-4.1.2.6</span></div>
<div class="line"><span class="lineno"> 2344</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 2345</span><span class="comment">           implement pathLenConstraint in the id-ce-basicConstraints extension */</span></div>
<div class="line"><span class="lineno"> 2346</span> </div>
<div class="line"><span class="lineno"> 2347</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2348</span>            <span class="keywordflow">case</span> isset($this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>]):</div>
<div class="line"><span class="lineno"> 2349</span>                <span class="comment">// self-signed cert</span></div>
<div class="line"><span class="lineno"> 2350</span>                <a class="code hl_variable" href="pf_2graphs_8php.html#a6c8b8ae7544496320b28f1a16b930191">switch</a> (true) {</div>
<div class="line"><span class="lineno"> 2351</span>                    <span class="keywordflow">case</span> !defined(<span class="stringliteral">&#39;FILE_X509_IGNORE_TYPE&#39;</span>) &amp;&amp; $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;issuer&#39;</span>] === $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>]:</div>
<div class="line"><span class="lineno"> 2352</span>                    <span class="keywordflow">case</span> defined(<span class="stringliteral">&#39;FILE_X509_IGNORE_TYPE&#39;</span>) &amp;&amp; $this-&gt;<a class="code hl_function" href="classFile__X509.html#a1d9888293c71b3fe2d087776ca31c0eb">getIssuerDN</a>(<a class="code hl_variable" href="X509_8php.html#ac5b3e418d7326945b8611285cf663589">FILE_X509_DN_STRING</a>) === $this-&gt;<a class="code hl_function" href="classFile__X509.html#a97392a261d56bd64002da7d1e76e8195">getDN</a>(<a class="code hl_variable" href="X509_8php.html#ac5b3e418d7326945b8611285cf663589">FILE_X509_DN_STRING</a>):</div>
<div class="line"><span class="lineno"> 2353</span>                        $authorityKey = $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">getExtension</a>(<span class="stringliteral">&#39;id-ce-authorityKeyIdentifier&#39;</span>);</div>
<div class="line"><span class="lineno"> 2354</span>                        $subjectKeyID = $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">getExtension</a>(<span class="stringliteral">&#39;id-ce-subjectKeyIdentifier&#39;</span>);</div>
<div class="line"><span class="lineno"> 2355</span>                        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2356</span>                            <span class="keywordflow">case</span> !is_array($authorityKey):</div>
<div class="line"><span class="lineno"> 2357</span>                            case !$subjectKeyID:</div>
<div class="line"><span class="lineno"> 2358</span>                            case isset($authorityKey[<span class="stringliteral">&#39;keyIdentifier&#39;</span>]) &amp;&amp; $authorityKey[<span class="stringliteral">&#39;keyIdentifier&#39;</span>] === $subjectKeyID:</div>
<div class="line"><span class="lineno"> 2359</span>                                $signingCert = $this-&gt;currentCert; <span class="comment">// working cert</span></div>
<div class="line"><span class="lineno"> 2360</span>                        }</div>
<div class="line"><span class="lineno"> 2361</span>                }</div>
<div class="line"><span class="lineno"> 2362</span> </div>
<div class="line"><span class="lineno"> 2363</span>                <span class="keywordflow">if</span> (!empty($this-&gt;CAs)) {</div>
<div class="line"><span class="lineno"> 2364</span>                    <span class="keywordflow">for</span> ($i = 0; $i &lt; count($this-&gt;CAs); $i++) {</div>
<div class="line"><span class="lineno"> 2365</span>                        <span class="comment">// even if the cert is a self-signed one we still want to see if it&#39;s a CA;</span></div>
<div class="line"><span class="lineno"> 2366</span>                        <span class="comment">// if not, we&#39;ll conditionally return an error</span></div>
<div class="line"><span class="lineno"> 2367</span>                        $ca = $this-&gt;CAs[$i];</div>
<div class="line"><span class="lineno"> 2368</span>                        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2369</span>                            <span class="keywordflow">case</span> !defined(<span class="stringliteral">&#39;FILE_X509_IGNORE_TYPE&#39;</span>) &amp;&amp; $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;issuer&#39;</span>] === $ca[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>]:</div>
<div class="line"><span class="lineno"> 2370</span>                            <span class="keywordflow">case</span> defined(<span class="stringliteral">&#39;FILE_X509_IGNORE_TYPE&#39;</span>) &amp;&amp; $this-&gt;<a class="code hl_function" href="classFile__X509.html#a97392a261d56bd64002da7d1e76e8195">getDN</a>(<a class="code hl_variable" href="X509_8php.html#ac5b3e418d7326945b8611285cf663589">FILE_X509_DN_STRING</a>, $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;issuer&#39;</span>]) === $this-&gt;<a class="code hl_function" href="classFile__X509.html#a97392a261d56bd64002da7d1e76e8195">getDN</a>(<a class="code hl_variable" href="X509_8php.html#ac5b3e418d7326945b8611285cf663589">FILE_X509_DN_STRING</a>, $ca[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>]):</div>
<div class="line"><span class="lineno"> 2371</span>                                $authorityKey = $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">getExtension</a>(<span class="stringliteral">&#39;id-ce-authorityKeyIdentifier&#39;</span>);</div>
<div class="line"><span class="lineno"> 2372</span>                                $subjectKeyID = $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">getExtension</a>(<span class="stringliteral">&#39;id-ce-subjectKeyIdentifier&#39;</span>, $ca);</div>
<div class="line"><span class="lineno"> 2373</span>                                <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2374</span>                                    <span class="keywordflow">case</span> !is_array($authorityKey):</div>
<div class="line"><span class="lineno"> 2375</span>                                    case !$subjectKeyID:</div>
<div class="line"><span class="lineno"> 2376</span>                                    case isset($authorityKey[<span class="stringliteral">&#39;keyIdentifier&#39;</span>]) &amp;&amp; $authorityKey[<span class="stringliteral">&#39;keyIdentifier&#39;</span>] === $subjectKeyID:</div>
<div class="line"><span class="lineno"> 2377</span>                                        <a class="code hl_variable" href="ctlr_8php.html#abc2baa6b327386720a46de43cf272921">if</a> (is_array($authorityKey) &amp;&amp; isset($authorityKey[<span class="stringliteral">&#39;authorityCertSerialNumber&#39;</span>]) &amp;&amp; !$authorityKey[<span class="stringliteral">&#39;authorityCertSerialNumber&#39;</span>]-&gt;equals($ca[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;serialNumber&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2378</span>                                            <span class="keywordflow">break</span> 2; <span class="comment">// serial mismatch - check other ca</span></div>
<div class="line"><span class="lineno"> 2379</span>                                        }</div>
<div class="line"><span class="lineno"> 2380</span>                                        $signingCert = $ca; <span class="comment">// working cert</span></div>
<div class="line"><span class="lineno"> 2381</span>                                        <span class="keywordflow">break</span> 3;</div>
<div class="line"><span class="lineno"> 2382</span>                                }</div>
<div class="line"><span class="lineno"> 2383</span>                        }</div>
<div class="line"><span class="lineno"> 2384</span>                    }</div>
<div class="line"><span class="lineno"> 2385</span>                    <span class="keywordflow">if</span> (count($this-&gt;CAs) == $i &amp;&amp; $caonly) {</div>
<div class="line"><span class="lineno"> 2386</span>                        <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classFile__X509.html#acc2e876f81f33f786d44175e43f96727">_testForIntermediate</a>($caonly, $count) &amp;&amp; $this-&gt;<a class="code hl_function" href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa">validateSignature</a>($caonly);</div>
<div class="line"><span class="lineno"> 2387</span>                    }</div>
<div class="line"><span class="lineno"> 2388</span>                } elseif (!isset($signingCert) || $caonly) {</div>
<div class="line"><span class="lineno"> 2389</span>                    <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classFile__X509.html#acc2e876f81f33f786d44175e43f96727">_testForIntermediate</a>($caonly, $count) &amp;&amp; $this-&gt;<a class="code hl_function" href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa">validateSignature</a>($caonly);</div>
<div class="line"><span class="lineno"> 2390</span>                }</div>
<div class="line"><span class="lineno"> 2391</span>                <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classFile__X509.html#ab87ce13c549a27cee379b3634e7c02f1">_validateSignature</a>(</div>
<div class="line"><span class="lineno"> 2392</span>                    $signingCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>],</div>
<div class="line"><span class="lineno"> 2393</span>                    $signingCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>],</div>
<div class="line"><span class="lineno"> 2394</span>                    $this-&gt;currentCert[<span class="stringliteral">&#39;signatureAlgorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>],</div>
<div class="line"><span class="lineno"> 2395</span>                    substr(base64_decode($this-&gt;currentCert[<span class="stringliteral">&#39;signature&#39;</span>]), 1),</div>
<div class="line"><span class="lineno"> 2396</span>                    $this-&gt;signatureSubject</div>
<div class="line"><span class="lineno"> 2397</span>                );</div>
<div class="line"><span class="lineno"> 2398</span>            <span class="keywordflow">case</span> isset($this-&gt;currentCert[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>]):</div>
<div class="line"><span class="lineno"> 2399</span>                return $this-&gt;<a class="code hl_function" href="classFile__X509.html#ab87ce13c549a27cee379b3634e7c02f1">_validateSignature</a>(</div>
<div class="line"><span class="lineno"> 2400</span>                    $this-&gt;currentCert[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subjectPKInfo&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>],</div>
<div class="line"><span class="lineno"> 2401</span>                    $this-&gt;currentCert[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subjectPKInfo&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>],</div>
<div class="line"><span class="lineno"> 2402</span>                    $this-&gt;currentCert[<span class="stringliteral">&#39;signatureAlgorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>],</div>
<div class="line"><span class="lineno"> 2403</span>                    substr(base64_decode($this-&gt;currentCert[<span class="stringliteral">&#39;signature&#39;</span>]), 1),</div>
<div class="line"><span class="lineno"> 2404</span>                    $this-&gt;signatureSubject</div>
<div class="line"><span class="lineno"> 2405</span>                );</div>
<div class="line"><span class="lineno"> 2406</span>            <span class="keywordflow">case</span> isset($this-&gt;currentCert[<span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span>]):</div>
<div class="line"><span class="lineno"> 2407</span>                return $this-&gt;<a class="code hl_function" href="classFile__X509.html#ab87ce13c549a27cee379b3634e7c02f1">_validateSignature</a>(</div>
<div class="line"><span class="lineno"> 2408</span>                    $this-&gt;currentCert[<span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span>][<span class="stringliteral">&#39;spki&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>],</div>
<div class="line"><span class="lineno"> 2409</span>                    $this-&gt;currentCert[<span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span>][<span class="stringliteral">&#39;spki&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>],</div>
<div class="line"><span class="lineno"> 2410</span>                    $this-&gt;currentCert[<span class="stringliteral">&#39;signatureAlgorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>],</div>
<div class="line"><span class="lineno"> 2411</span>                    substr(base64_decode($this-&gt;currentCert[<span class="stringliteral">&#39;signature&#39;</span>]), 1),</div>
<div class="line"><span class="lineno"> 2412</span>                    $this-&gt;signatureSubject</div>
<div class="line"><span class="lineno"> 2413</span>                );</div>
<div class="line"><span class="lineno"> 2414</span>            <span class="keywordflow">case</span> isset($this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>]):</div>
<div class="line"><span class="lineno"> 2415</span>                <a class="code hl_variable" href="ctlr_8php.html#abc2baa6b327386720a46de43cf272921">if</a> (!empty($this-&gt;CAs)) {</div>
<div class="line"><span class="lineno"> 2416</span>                    <span class="keywordflow">for</span> ($i = 0; $i &lt; count($this-&gt;CAs); $i++) {</div>
<div class="line"><span class="lineno"> 2417</span>                        $ca = $this-&gt;CAs[$i];</div>
<div class="line"><span class="lineno"> 2418</span>                        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2419</span>                            <span class="keywordflow">case</span> !defined(<span class="stringliteral">&#39;FILE_X509_IGNORE_TYPE&#39;</span>) &amp;&amp; $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>][<span class="stringliteral">&#39;issuer&#39;</span>] === $ca[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>]:</div>
<div class="line"><span class="lineno"> 2420</span>                            <span class="keywordflow">case</span> defined(<span class="stringliteral">&#39;FILE_X509_IGNORE_TYPE&#39;</span>) &amp;&amp; $this-&gt;<a class="code hl_function" href="classFile__X509.html#a97392a261d56bd64002da7d1e76e8195">getDN</a>(<a class="code hl_variable" href="X509_8php.html#ac5b3e418d7326945b8611285cf663589">FILE_X509_DN_STRING</a>, $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>][<span class="stringliteral">&#39;issuer&#39;</span>]) === $this-&gt;<a class="code hl_function" href="classFile__X509.html#a97392a261d56bd64002da7d1e76e8195">getDN</a>(<a class="code hl_variable" href="X509_8php.html#ac5b3e418d7326945b8611285cf663589">FILE_X509_DN_STRING</a>, $ca[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>]):</div>
<div class="line"><span class="lineno"> 2421</span>                                $authorityKey = $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">getExtension</a>(<span class="stringliteral">&#39;id-ce-authorityKeyIdentifier&#39;</span>);</div>
<div class="line"><span class="lineno"> 2422</span>                                $subjectKeyID = $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">getExtension</a>(<span class="stringliteral">&#39;id-ce-subjectKeyIdentifier&#39;</span>, $ca);</div>
<div class="line"><span class="lineno"> 2423</span>                                <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2424</span>                                    <span class="keywordflow">case</span> !is_array($authorityKey):</div>
<div class="line"><span class="lineno"> 2425</span>                                    case !$subjectKeyID:</div>
<div class="line"><span class="lineno"> 2426</span>                                    case isset($authorityKey[<span class="stringliteral">&#39;keyIdentifier&#39;</span>]) &amp;&amp; $authorityKey[<span class="stringliteral">&#39;keyIdentifier&#39;</span>] === $subjectKeyID:</div>
<div class="line"><span class="lineno"> 2427</span>                                        <a class="code hl_variable" href="ctlr_8php.html#abc2baa6b327386720a46de43cf272921">if</a> (is_array($authorityKey) &amp;&amp; isset($authorityKey[<span class="stringliteral">&#39;authorityCertSerialNumber&#39;</span>]) &amp;&amp; !$authorityKey[<span class="stringliteral">&#39;authorityCertSerialNumber&#39;</span>]-&gt;equals($ca[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;serialNumber&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2428</span>                                            <span class="keywordflow">break</span> 2; <span class="comment">// serial mismatch - check other ca</span></div>
<div class="line"><span class="lineno"> 2429</span>                                        }</div>
<div class="line"><span class="lineno"> 2430</span>                                        $signingCert = $ca; <span class="comment">// working cert</span></div>
<div class="line"><span class="lineno"> 2431</span>                                        <span class="keywordflow">break</span> 3;</div>
<div class="line"><span class="lineno"> 2432</span>                                }</div>
<div class="line"><span class="lineno"> 2433</span>                        }</div>
<div class="line"><span class="lineno"> 2434</span>                    }</div>
<div class="line"><span class="lineno"> 2435</span>                }</div>
<div class="line"><span class="lineno"> 2436</span>                <span class="keywordflow">if</span> (!isset($signingCert)) {</div>
<div class="line"><span class="lineno"> 2437</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2438</span>                }</div>
<div class="line"><span class="lineno"> 2439</span>                <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classFile__X509.html#ab87ce13c549a27cee379b3634e7c02f1">_validateSignature</a>(</div>
<div class="line"><span class="lineno"> 2440</span>                    $signingCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>],</div>
<div class="line"><span class="lineno"> 2441</span>                    $signingCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>],</div>
<div class="line"><span class="lineno"> 2442</span>                    $this-&gt;currentCert[<span class="stringliteral">&#39;signatureAlgorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>],</div>
<div class="line"><span class="lineno"> 2443</span>                    substr(base64_decode($this-&gt;currentCert[<span class="stringliteral">&#39;signature&#39;</span>]), 1),</div>
<div class="line"><span class="lineno"> 2444</span>                    $this-&gt;signatureSubject</div>
<div class="line"><span class="lineno"> 2445</span>                );</div>
<div class="line"><span class="lineno"> 2446</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2447</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2448</span>        }</div>
<div class="line"><span class="lineno"> 2449</span>    }</div>
<div class="ttc" id="aX509_8php_html_ac5b3e418d7326945b8611285cf663589"><div class="ttname"><a href="X509_8php.html#ac5b3e418d7326945b8611285cf663589">FILE_X509_DN_STRING</a></div><div class="ttdeci">const FILE_X509_DN_STRING</div><div class="ttdoc">Return string.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00072">X509.php:72</a></div></div>
<div class="ttc" id="aclassFile__X509_html_a1d9888293c71b3fe2d087776ca31c0eb"><div class="ttname"><a href="classFile__X509.html#a1d9888293c71b3fe2d087776ca31c0eb">File_X509\getIssuerDN</a></div><div class="ttdeci">getIssuerDN($format=FILE_X509_DN_ARRAY)</div><div class="ttdoc">Get the Distinguished Name for a certificate/crl issuer.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l03035">X509.php:3035</a></div></div>
<div class="ttc" id="aclassFile__X509_html_a63e18ebfa877fefabf86d16e0e2ceeaa"><div class="ttname"><a href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa">File_X509\validateSignature</a></div><div class="ttdeci">validateSignature($caonly=true)</div><div class="ttdoc">Validate a signature.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l02316">X509.php:2316</a></div></div>
<div class="ttc" id="aclassFile__X509_html_a97392a261d56bd64002da7d1e76e8195"><div class="ttname"><a href="classFile__X509.html#a97392a261d56bd64002da7d1e76e8195">File_X509\getDN</a></div><div class="ttdeci">getDN($format=FILE_X509_DN_ARRAY, $dn=null)</div><div class="ttdoc">Get the Distinguished Name for a certificates subject.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l02882">X509.php:2882</a></div></div>
<div class="ttc" id="aclassFile__X509_html_ab87ce13c549a27cee379b3634e7c02f1"><div class="ttname"><a href="classFile__X509.html#ab87ce13c549a27cee379b3634e7c02f1">File_X509\_validateSignature</a></div><div class="ttdeci">_validateSignature($publicKeyAlgorithm, $publicKey, $signatureAlgorithm, $signature, $signatureSubject)</div><div class="ttdoc">Validates a signature.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l02464">X509.php:2464</a></div></div>
<div class="ttc" id="aclassFile__X509_html_acc2e876f81f33f786d44175e43f96727"><div class="ttname"><a href="classFile__X509.html#acc2e876f81f33f786d44175e43f96727">File_X509\_testForIntermediate</a></div><div class="ttdeci">_testForIntermediate($caonly, $count)</div><div class="ttdoc">Validates an intermediate cert as identified via authority info access extension.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l02249">X509.php:2249</a></div></div>
<div class="ttc" id="aclassFile__X509_html_afc1207c2b7e8e70f61598815ee07fcdb"><div class="ttname"><a href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">File_X509\getExtension</a></div><div class="ttdeci">getExtension($id, $cert=null)</div><div class="ttdoc">Get a certificate, CSR or CRL Extension.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l04527">X509.php:4527</a></div></div>
<div class="ttc" id="actlr_8php_html_abc2baa6b327386720a46de43cf272921"><div class="ttname"><a href="ctlr_8php.html#abc2baa6b327386720a46de43cf272921">if</a></div><div class="ttdeci">if(!ExpandArgs( $ArgV, $Locale, $View, $Command)) if(!array_key_exists( $View, $ModelFiles))</div><div class="ttdef"><b>Definition:</b> <a href="ctlr_8php_source.html#l00079">ctlr.php:79</a></div></div>
<div class="ttc" id="apf_2graphs_8php_html_a6c8b8ae7544496320b28f1a16b930191"><div class="ttname"><a href="pf_2graphs_8php.html#a6c8b8ae7544496320b28f1a16b930191">switch</a></div><div class="ttdeci">switch( $Submenu)</div><div class="ttdef"><b>Definition:</b> <a href="pf_2graphs_8php_source.html#l00025">graphs.php:25</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l02249">_testForIntermediate()</a>, <a class="el" href="X509_8php_source.html#l02464">_validateSignature()</a>, <a class="el" href="X509_8php_source.html#l00072">FILE_X509_DN_STRING</a>, <a class="el" href="X509_8php_source.html#l02882">getDN()</a>, <a class="el" href="X509_8php_source.html#l04527">getExtension()</a>, <a class="el" href="X509_8php_source.html#l03035">getIssuerDN()</a>, and <a class="el" href="X509_8php_source.html#l02316">validateSignature()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l02316">validateSignature()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a96ee8b07aceb37a5d949447f7349bf12_cgraph.png" border="0" usemap="#aclassFile__X509_a96ee8b07aceb37a5d949447f7349bf12_cgraph" alt=""/></div>
<map name="aclassFile__X509_a96ee8b07aceb37a5d949447f7349bf12_cgraph" id="aclassFile__X509_a96ee8b07aceb37a5d949447f7349bf12_cgraph">
<area shape="rect" title="Validate a signature." alt="" coords="5,157,216,183"/>
<area shape="rect" href="classFile__X509.html#acc2e876f81f33f786d44175e43f96727" title="Validates an intermediate cert as identified via authority info access extension." alt="" coords="264,5,423,31"/>
<area shape="rect" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb" title="Get a certificate, CSR or CRL Extension." alt="" coords="471,56,577,81"/>
<area shape="rect" href="classFile__X509.html#ab87ce13c549a27cee379b3634e7c02f1" title="Validates a signature." alt="" coords="271,107,415,132"/>
<area shape="rect" href="classFile__X509.html#a97392a261d56bd64002da7d1e76e8195" title="Get the Distinguished Name for a certificates subject." alt="" coords="493,157,555,183"/>
<area shape="rect" href="classFile__X509.html#a1d9888293c71b3fe2d087776ca31c0eb" title="Get the Distinguished Name for a certificate/crl issuer." alt="" coords="292,208,395,233"/>
<area shape="rect" href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa" title="Validate a signature." alt="" coords="275,257,412,283"/>
<area shape="rect" href="classFile__X509.html#a84e2629a56c47e5e90ab3a2a0aaf1bda" title="Fetches a URL." alt="" coords="480,5,568,31"/>
<area shape="rect" href="classFile__X509.html#a51d0ffadbcbf965b23238b89fef03484" title="Get an Extension." alt="" coords="625,56,740,81"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="791,56,891,81"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="943,81,1029,107"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="629,157,737,183"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="788,157,895,183"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a96ee8b07aceb37a5d949447f7349bf12_icgraph.png" border="0" usemap="#aclassFile__X509_a96ee8b07aceb37a5d949447f7349bf12_icgraph" alt=""/></div>
<map name="aclassFile__X509_a96ee8b07aceb37a5d949447f7349bf12_icgraph" id="aclassFile__X509_a96ee8b07aceb37a5d949447f7349bf12_icgraph">
<area shape="rect" title="Validate a signature." alt="" coords="191,5,401,31"/>
<area shape="rect" href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa" title="Validate a signature." alt="" coords="5,5,143,31"/>
</map>
</div>

</div>
</div>
<a id="ae4e1b70f7a5845e4777064b242a35d56" name="ae4e1b70f7a5845e4777064b242a35d56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4e1b70f7a5845e4777064b242a35d56">&#9670;&#160;</a></span>computeKeyIdentifier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">computeKeyIdentifier </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em> = <code>null</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$method</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute a public key identifier. </p>
<p>Although key identifiers may be set to any unique value, this function computes key identifiers from public key according to the two recommended methods (4.2.1.2 RFC 3280). Highly polymorphic: try to accept all possible forms of key:</p><ul>
<li>Key object</li>
<li><a class="el" href="classFile__X509.html">File_X509</a> object with public or private key defined</li>
<li>Certificate or CSR array</li>
<li><a class="el" href="classFile__ASN1__Element.html">File_ASN1_Element</a> object</li>
<li>PEM or DER string</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">mixed</td><td class="paramname">$key</td><td>optional </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$method</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string binary key identifier </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04767">4767</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4768</span>    {</div>
<div class="line"><span class="lineno"> 4769</span>        global <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>;</div>
<div class="line"><span class="lineno"> 4770</span> </div>
<div class="line"><span class="lineno"> 4771</span>        <span class="keywordflow">if</span> (is_null($key)) {</div>
<div class="line"><span class="lineno"> 4772</span>            $key = $this;</div>
<div class="line"><span class="lineno"> 4773</span>        }</div>
<div class="line"><span class="lineno"> 4774</span> </div>
<div class="line"><span class="lineno"> 4775</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 4776</span>            <span class="keywordflow">case</span> is_string($key):</div>
<div class="line"><span class="lineno"> 4777</span>                break;</div>
<div class="line"><span class="lineno"> 4778</span>            <span class="keywordflow">case</span> is_array($key) &amp;&amp; isset($key[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>]):</div>
<div class="line"><span class="lineno"> 4779</span>                return $this-&gt;computeKeyIdentifier($key[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>], $method);</div>
<div class="line"><span class="lineno"> 4780</span>            <span class="keywordflow">case</span> is_array($key) &amp;&amp; isset($key[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subjectPKInfo&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>]):</div>
<div class="line"><span class="lineno"> 4781</span>                return $this-&gt;computeKeyIdentifier($key[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subjectPKInfo&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>], $method);</div>
<div class="line"><span class="lineno"> 4782</span>            <span class="keywordflow">case</span> !is_object($key):</div>
<div class="line"><span class="lineno"> 4783</span>                return false;</div>
<div class="line"><span class="lineno"> 4784</span>            <span class="keywordflow">case</span> strtolower(get_class($key)) == <span class="stringliteral">&#39;file_asn1_element&#39;</span>:</div>
<div class="line"><span class="lineno"> 4785</span>                <span class="comment">// Assume the element is a bitstring-packed key.</span></div>
<div class="line"><span class="lineno"> 4786</span>                $asn1 = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__ASN1.html">File_ASN1</a>();</div>
<div class="line"><span class="lineno"> 4787</span>                $decoded = $asn1-&gt;decodeBER($key-&gt;element);</div>
<div class="line"><span class="lineno"> 4788</span>                <span class="keywordflow">if</span> (empty($decoded)) {</div>
<div class="line"><span class="lineno"> 4789</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4790</span>                }</div>
<div class="line"><span class="lineno"> 4791</span>                $raw = $asn1-&gt;asn1map($decoded[0], array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>));</div>
<div class="line"><span class="lineno"> 4792</span>                <span class="keywordflow">if</span> (empty($raw)) {</div>
<div class="line"><span class="lineno"> 4793</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4794</span>                }</div>
<div class="line"><span class="lineno"> 4795</span>                $raw = base64_decode($raw);</div>
<div class="line"><span class="lineno"> 4796</span>                <span class="comment">// If the key is private, compute identifier from its corresponding public key.</span></div>
<div class="line"><span class="lineno"> 4797</span>                <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_RSA&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 4798</span>                    include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/RSA.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 4799</span>                }</div>
<div class="line"><span class="lineno"> 4800</span>                $key = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__RSA.html">Crypt_RSA</a>();</div>
<div class="line"><span class="lineno"> 4801</span>                <span class="keywordflow">if</span> (!$key-&gt;loadKey($raw)) {</div>
<div class="line"><span class="lineno"> 4802</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;   <span class="comment">// Not an unencrypted RSA key.</span></div>
<div class="line"><span class="lineno"> 4803</span>                }</div>
<div class="line"><span class="lineno"> 4804</span>                <span class="keywordflow">if</span> ($key-&gt;getPrivateKey() !== <span class="keyword">false</span>) {  <span class="comment">// If private.</span></div>
<div class="line"><span class="lineno"> 4805</span>                    <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classFile__X509.html#ae4e1b70f7a5845e4777064b242a35d56">computeKeyIdentifier</a>($key, $method);</div>
<div class="line"><span class="lineno"> 4806</span>                }</div>
<div class="line"><span class="lineno"> 4807</span>                $key = $raw;    <span class="comment">// Is a public key.</span></div>
<div class="line"><span class="lineno"> 4808</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4809</span>            <span class="keywordflow">case</span> strtolower(get_class($key)) == <span class="stringliteral">&#39;file_x509&#39;</span>:</div>
<div class="line"><span class="lineno"> 4810</span>                <span class="keywordflow">if</span> (isset($key-&gt;publicKey)) {</div>
<div class="line"><span class="lineno"> 4811</span>                    <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classFile__X509.html#ae4e1b70f7a5845e4777064b242a35d56">computeKeyIdentifier</a>($key-&gt;publicKey, $method);</div>
<div class="line"><span class="lineno"> 4812</span>                }</div>
<div class="line"><span class="lineno"> 4813</span>                <span class="keywordflow">if</span> (isset($key-&gt;privateKey)) {</div>
<div class="line"><span class="lineno"> 4814</span>                    <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classFile__X509.html#ae4e1b70f7a5845e4777064b242a35d56">computeKeyIdentifier</a>($key-&gt;privateKey, $method);</div>
<div class="line"><span class="lineno"> 4815</span>                }</div>
<div class="line"><span class="lineno"> 4816</span>                <span class="keywordflow">if</span> (isset($key-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>]) || isset($key-&gt;currentCert[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 4817</span>                    <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classFile__X509.html#ae4e1b70f7a5845e4777064b242a35d56">computeKeyIdentifier</a>($key-&gt;currentCert, $method);</div>
<div class="line"><span class="lineno"> 4818</span>                }</div>
<div class="line"><span class="lineno"> 4819</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4820</span>            <span class="keywordflow">default</span>: <span class="comment">// Should be a key object (i.e.: Crypt_RSA).</span></div>
<div class="line"><span class="lineno"> 4821</span>                $key = $key-&gt;getPublicKey(<a class="code hl_variable" href="RSA_8php.html#a15eeb8d9dc1af1411f1549d4702c8a00">CRYPT_RSA_PUBLIC_FORMAT_PKCS1</a>);</div>
<div class="line"><span class="lineno"> 4822</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4823</span>        }</div>
<div class="line"><span class="lineno"> 4824</span> </div>
<div class="line"><span class="lineno"> 4825</span>        <span class="comment">// If in PEM format, convert to binary.</span></div>
<div class="line"><span class="lineno"> 4826</span>        $key = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a009e0a2396931d62c87d27f4e2372024">_extractBER</a>($key);</div>
<div class="line"><span class="lineno"> 4827</span> </div>
<div class="line"><span class="lineno"> 4828</span>        <span class="comment">// Now we have the key string: compute its sha-1 sum.</span></div>
<div class="line"><span class="lineno"> 4829</span>        <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_Hash&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 4830</span>            include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/Hash.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 4831</span>        }</div>
<div class="line"><span class="lineno"> 4832</span>        $hash = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__Hash.html">Crypt_Hash</a>(<span class="stringliteral">&#39;sha1&#39;</span>);</div>
<div class="line"><span class="lineno"> 4833</span>        $hash = $hash-&gt;hash($key);</div>
<div class="line"><span class="lineno"> 4834</span> </div>
<div class="line"><span class="lineno"> 4835</span>        <span class="keywordflow">if</span> ($method == 2) {</div>
<div class="line"><span class="lineno"> 4836</span>            $hash = substr($hash, -8);</div>
<div class="line"><span class="lineno"> 4837</span>            $hash[0] = chr((ord($hash[0]) &amp; 0x0F) | 0x40);</div>
<div class="line"><span class="lineno"> 4838</span>        }</div>
<div class="line"><span class="lineno"> 4839</span> </div>
<div class="line"><span class="lineno"> 4840</span>        <span class="keywordflow">return</span> $hash;</div>
<div class="line"><span class="lineno"> 4841</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_a009e0a2396931d62c87d27f4e2372024"><div class="ttname"><a href="classFile__X509.html#a009e0a2396931d62c87d27f4e2372024">File_X509\_extractBER</a></div><div class="ttdeci">_extractBER($str)</div><div class="ttdoc">Extract raw BER from Base64 encoding.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l05152">X509.php:5152</a></div></div>
<div class="ttc" id="aclassFile__X509_html_ae4e1b70f7a5845e4777064b242a35d56"><div class="ttname"><a href="classFile__X509.html#ae4e1b70f7a5845e4777064b242a35d56">File_X509\computeKeyIdentifier</a></div><div class="ttdeci">computeKeyIdentifier($key=null, $method=1)</div><div class="ttdoc">Compute a public key identifier.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l04767">X509.php:4767</a></div></div>
<div class="ttc" id="anamespaceCrypt__Hash_html"><div class="ttname"><a href="namespaceCrypt__Hash.html">Crypt_Hash</a></div><div class="ttdoc">#-</div></div>
<div class="ttc" id="anamespaceFile__ASN1_html"><div class="ttname"><a href="namespaceFile__ASN1.html">File_ASN1</a></div><div class="ttdoc">#-</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="install_8php_source.html#l00039">$VIEW_PATH</a>, <a class="el" href="X509_8php_source.html#l05152">_extractBER()</a>, <a class="el" href="X509_8php_source.html#l04767">computeKeyIdentifier()</a>, <a class="el" href="RSA_8php_source.html#l00249">CRYPT_RSA_PUBLIC_FORMAT_PKCS1</a>, and <a class="el" href="ASN1_8php_source.html#l00062">FILE_ASN1_TYPE_BIT_STRING</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l04767">computeKeyIdentifier()</a>, and <a class="el" href="X509_8php_source.html#l03684">sign()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ae4e1b70f7a5845e4777064b242a35d56_cgraph.png" border="0" usemap="#aclassFile__X509_ae4e1b70f7a5845e4777064b242a35d56_cgraph" alt=""/></div>
<map name="aclassFile__X509_ae4e1b70f7a5845e4777064b242a35d56_cgraph" id="aclassFile__X509_ae4e1b70f7a5845e4777064b242a35d56_cgraph">
<area shape="rect" title="Compute a public key identifier." alt="" coords="5,29,167,55"/>
<area shape="rect" href="classFile__X509.html#a009e0a2396931d62c87d27f4e2372024" title="Extract raw BER from Base64 encoding." alt="" coords="215,29,316,55"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ae4e1b70f7a5845e4777064b242a35d56_icgraph.png" border="0" usemap="#aclassFile__X509_ae4e1b70f7a5845e4777064b242a35d56_icgraph" alt=""/></div>
<map name="aclassFile__X509_ae4e1b70f7a5845e4777064b242a35d56_icgraph" id="aclassFile__X509_ae4e1b70f7a5845e4777064b242a35d56_icgraph">
<area shape="rect" title="Compute a public key identifier." alt="" coords="103,29,264,55"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="5,29,55,55"/>
</map>
</div>

</div>
</div>
<a id="a2c7cbfe13e8f69d47e8f7c5642eca301" name="a2c7cbfe13e8f69d47e8f7c5642eca301"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c7cbfe13e8f69d47e8f7c5642eca301">&#9670;&#160;</a></span>disableURLFetch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">disableURLFetch </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prevents URIs from being automatically retrieved. </p>
<p>@access public </p>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02521">2521</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2522</span>    {</div>
<div class="line"><span class="lineno"> 2523</span>        $this-&gt;disable_url_fetch = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2524</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a23f9c4d9ce04bfcd790bec9d8dae86ed" name="a23f9c4d9ce04bfcd790bec9d8dae86ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23f9c4d9ce04bfcd790bec9d8dae86ed">&#9670;&#160;</a></span>enableURLFetch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enableURLFetch </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allows URIs to be automatically retrieved. </p>
<p>@access public </p>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02531">2531</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2532</span>    {</div>
<div class="line"><span class="lineno"> 2533</span>        $this-&gt;disable_url_fetch = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2534</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b796f253d10daa33c4efe72256cb623" name="a0b796f253d10daa33c4efe72256cb623"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b796f253d10daa33c4efe72256cb623">&#9670;&#160;</a></span>File_X509()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFile__X509.html">File_X509</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PHP4 compatible Default Constructor. </p>
<dl class="section see"><dt>See also</dt><dd>self::__construct() @access public </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l01482">1482</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1483</span>    {</div>
<div class="line"><span class="lineno"> 1484</span>        $this-&gt;__construct();</div>
<div class="line"><span class="lineno"> 1485</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l00345">__construct()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a0b796f253d10daa33c4efe72256cb623_cgraph.png" border="0" usemap="#aclassFile__X509_a0b796f253d10daa33c4efe72256cb623_cgraph" alt=""/></div>
<map name="aclassFile__X509_a0b796f253d10daa33c4efe72256cb623_cgraph" id="aclassFile__X509_a0b796f253d10daa33c4efe72256cb623_cgraph">
<area shape="rect" title="PHP4 compatible Default Constructor." alt="" coords="5,5,91,31"/>
<area shape="rect" href="classFile__X509.html#a095c5d389db211932136b53f25f39685" title="Default Constructor." alt="" coords="139,5,235,31"/>
</map>
</div>

</div>
</div>
<a id="aa161754e2510ae51e94934eaf50ebb9d" name="aa161754e2510ae51e94934eaf50ebb9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa161754e2510ae51e94934eaf50ebb9d">&#9670;&#160;</a></span>getAttribute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getAttribute </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$disposition</em> = <code><a class="el" href="X509_8php.html#a00c13d4a694558e4a9b24ed9e5462a8e">FILE_X509_ATTR_ALL</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$csr</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a CSR attribute. </p>
<p>Returns the attribute if it exists and false if not</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$id</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$disposition</td><td>optional </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$csr</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04618">4618</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4619</span>    {</div>
<div class="line"><span class="lineno"> 4620</span>        <span class="keywordflow">if</span> (empty($csr)) {</div>
<div class="line"><span class="lineno"> 4621</span>            $csr = $this-&gt;currentCert;</div>
<div class="line"><span class="lineno"> 4622</span>        }</div>
<div class="line"><span class="lineno"> 4623</span> </div>
<div class="line"><span class="lineno"> 4624</span>        $attributes = $this-&gt;_subArray($csr, <span class="stringliteral">&#39;certificationRequestInfo/attributes&#39;</span>);</div>
<div class="line"><span class="lineno"> 4625</span> </div>
<div class="line"><span class="lineno"> 4626</span>        <span class="keywordflow">if</span> (!is_array($attributes)) {</div>
<div class="line"><span class="lineno"> 4627</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4628</span>        }</div>
<div class="line"><span class="lineno"> 4629</span> </div>
<div class="line"><span class="lineno"> 4630</span>        <span class="keywordflow">foreach</span> ($attributes as $key =&gt; $attribute) {</div>
<div class="line"><span class="lineno"> 4631</span>            <span class="keywordflow">if</span> ($attribute[<span class="stringliteral">&#39;type&#39;</span>] == $id) {</div>
<div class="line"><span class="lineno"> 4632</span>                $n = count($attribute[<span class="stringliteral">&#39;value&#39;</span>]);</div>
<div class="line"><span class="lineno"> 4633</span>                <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 4634</span>                    <span class="keywordflow">case</span> $disposition == <a class="code hl_variable" href="X509_8php.html#a2680c288fb1c165acb2843b0ad8b3395">FILE_X509_ATTR_APPEND</a>:</div>
<div class="line"><span class="lineno"> 4635</span>                    <span class="keywordflow">case</span> $disposition == <a class="code hl_variable" href="X509_8php.html#ad766ad0de320dd5b44de47ef51cb773e">FILE_X509_ATTR_REPLACE</a>:</div>
<div class="line"><span class="lineno"> 4636</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4637</span>                    <span class="keywordflow">case</span> $disposition == <a class="code hl_variable" href="X509_8php.html#a00c13d4a694558e4a9b24ed9e5462a8e">FILE_X509_ATTR_ALL</a>:</div>
<div class="line"><span class="lineno"> 4638</span>                        <span class="keywordflow">return</span> $attribute[<span class="stringliteral">&#39;value&#39;</span>];</div>
<div class="line"><span class="lineno"> 4639</span>                    <span class="keywordflow">case</span> $disposition &gt;= $n:</div>
<div class="line"><span class="lineno"> 4640</span>                        $disposition -= $n;</div>
<div class="line"><span class="lineno"> 4641</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4642</span>                    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 4643</span>                        <span class="keywordflow">return</span> $attribute[<span class="stringliteral">&#39;value&#39;</span>][$disposition];</div>
<div class="line"><span class="lineno"> 4644</span>                }</div>
<div class="line"><span class="lineno"> 4645</span>            }</div>
<div class="line"><span class="lineno"> 4646</span>        }</div>
<div class="line"><span class="lineno"> 4647</span> </div>
<div class="line"><span class="lineno"> 4648</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4649</span>    }</div>
<div class="ttc" id="aX509_8php_html_a00c13d4a694558e4a9b24ed9e5462a8e"><div class="ttname"><a href="X509_8php.html#a00c13d4a694558e4a9b24ed9e5462a8e">FILE_X509_ATTR_ALL</a></div><div class="ttdeci">const FILE_X509_ATTR_ALL</div><div class="ttdoc">#-</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00125">X509.php:125</a></div></div>
<div class="ttc" id="aX509_8php_html_a2680c288fb1c165acb2843b0ad8b3395"><div class="ttname"><a href="X509_8php.html#a2680c288fb1c165acb2843b0ad8b3395">FILE_X509_ATTR_APPEND</a></div><div class="ttdeci">const FILE_X509_ATTR_APPEND</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00126">X509.php:126</a></div></div>
<div class="ttc" id="aX509_8php_html_ad766ad0de320dd5b44de47ef51cb773e"><div class="ttname"><a href="X509_8php.html#ad766ad0de320dd5b44de47ef51cb773e">FILE_X509_ATTR_REPLACE</a></div><div class="ttdeci">const FILE_X509_ATTR_REPLACE</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00127">X509.php:127</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>, <a class="el" href="X509_8php_source.html#l00125">FILE_X509_ATTR_ALL</a>, <a class="el" href="X509_8php_source.html#l00126">FILE_X509_ATTR_APPEND</a>, and <a class="el" href="X509_8php_source.html#l00127">FILE_X509_ATTR_REPLACE</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_aa161754e2510ae51e94934eaf50ebb9d_cgraph.png" border="0" usemap="#aclassFile__X509_aa161754e2510ae51e94934eaf50ebb9d_cgraph" alt=""/></div>
<map name="aclassFile__X509_aa161754e2510ae51e94934eaf50ebb9d_cgraph" id="aclassFile__X509_aa161754e2510ae51e94934eaf50ebb9d_cgraph">
<area shape="rect" title="Get a CSR attribute." alt="" coords="5,5,105,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="153,5,240,31"/>
</map>
</div>

</div>
</div>
<a id="a359f6dfafc17a1d4c9386f5539056825" name="a359f6dfafc17a1d4c9386f5539056825"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a359f6dfafc17a1d4c9386f5539056825">&#9670;&#160;</a></span>getAttributes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getAttributes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$csr</em> = <code>null</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a list of all CSR attributes in use. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$csr</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04658">4658</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4659</span>    {</div>
<div class="line"><span class="lineno"> 4660</span>        <span class="keywordflow">if</span> (empty($csr)) {</div>
<div class="line"><span class="lineno"> 4661</span>            $csr = $this-&gt;currentCert;</div>
<div class="line"><span class="lineno"> 4662</span>        }</div>
<div class="line"><span class="lineno"> 4663</span> </div>
<div class="line"><span class="lineno"> 4664</span>        $attributes = $this-&gt;_subArray($csr, <span class="stringliteral">&#39;certificationRequestInfo/attributes&#39;</span>);</div>
<div class="line"><span class="lineno"> 4665</span>        $attrs = array();</div>
<div class="line"><span class="lineno"> 4666</span> </div>
<div class="line"><span class="lineno"> 4667</span>        <span class="keywordflow">if</span> (is_array($attributes)) {</div>
<div class="line"><span class="lineno"> 4668</span>            <span class="keywordflow">foreach</span> ($attributes as $attribute) {</div>
<div class="line"><span class="lineno"> 4669</span>                $attrs[] = $attribute[<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><span class="lineno"> 4670</span>            }</div>
<div class="line"><span class="lineno"> 4671</span>        }</div>
<div class="line"><span class="lineno"> 4672</span> </div>
<div class="line"><span class="lineno"> 4673</span>        <span class="keywordflow">return</span> $attrs;</div>
<div class="line"><span class="lineno"> 4674</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a359f6dfafc17a1d4c9386f5539056825_cgraph.png" border="0" usemap="#aclassFile__X509_a359f6dfafc17a1d4c9386f5539056825_cgraph" alt=""/></div>
<map name="aclassFile__X509_a359f6dfafc17a1d4c9386f5539056825_cgraph" id="aclassFile__X509_a359f6dfafc17a1d4c9386f5539056825_cgraph">
<area shape="rect" title="Returns a list of all CSR attributes in use." alt="" coords="5,5,112,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="160,5,247,31"/>
</map>
</div>

</div>
</div>
<a id="a72aefa3de97ff30a83063abc3b8ce568" name="a72aefa3de97ff30a83063abc3b8ce568"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72aefa3de97ff30a83063abc3b8ce568">&#9670;&#160;</a></span>getChain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getChain </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the certificate chain for the current cert. </p>
<p>@access public </p><dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03125">3125</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3126</span>    {</div>
<div class="line"><span class="lineno"> 3127</span>        $chain = array($this-&gt;currentCert);</div>
<div class="line"><span class="lineno"> 3128</span> </div>
<div class="line"><span class="lineno"> 3129</span>        <span class="keywordflow">if</span> (!is_array($this-&gt;currentCert) || !isset($this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 3130</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3131</span>        }</div>
<div class="line"><span class="lineno"> 3132</span>        <span class="keywordflow">if</span> (empty($this-&gt;CAs)) {</div>
<div class="line"><span class="lineno"> 3133</span>            <span class="keywordflow">return</span> $chain;</div>
<div class="line"><span class="lineno"> 3134</span>        }</div>
<div class="line"><span class="lineno"> 3135</span>        <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 3136</span>            <a class="code hl_variable" href="classFile__X509.html#a13ce82673cd9b9e0aebbd6c10010a686">$currentCert</a> = $chain[count($chain) - 1];</div>
<div class="line"><span class="lineno"> 3137</span>            <span class="keywordflow">for</span> ($i = 0; $i &lt; count($this-&gt;CAs); $i++) {</div>
<div class="line"><span class="lineno"> 3138</span>                $ca = $this-&gt;CAs[$i];</div>
<div class="line"><span class="lineno"> 3139</span>                <span class="keywordflow">if</span> ($currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;issuer&#39;</span>] === $ca[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>]) {</div>
<div class="line"><span class="lineno"> 3140</span>                    $authorityKey = $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">getExtension</a>(<span class="stringliteral">&#39;id-ce-authorityKeyIdentifier&#39;</span>, $currentCert);</div>
<div class="line"><span class="lineno"> 3141</span>                    $subjectKeyID = $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">getExtension</a>(<span class="stringliteral">&#39;id-ce-subjectKeyIdentifier&#39;</span>, $ca);</div>
<div class="line"><span class="lineno"> 3142</span>                    <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 3143</span>                        <span class="keywordflow">case</span> !is_array($authorityKey):</div>
<div class="line"><span class="lineno"> 3144</span>                        case is_array($authorityKey) &amp;&amp; isset($authorityKey[<span class="stringliteral">&#39;keyIdentifier&#39;</span>]) &amp;&amp; $authorityKey[<span class="stringliteral">&#39;keyIdentifier&#39;</span>] === $subjectKeyID:</div>
<div class="line"><span class="lineno"> 3145</span>                            <a class="code hl_variable" href="ctlr_8php.html#abc2baa6b327386720a46de43cf272921">if</a> (<a class="code hl_variable" href="classFile__X509.html#a13ce82673cd9b9e0aebbd6c10010a686">$currentCert</a> === $ca) {</div>
<div class="line"><span class="lineno"> 3146</span>                                <span class="keywordflow">break</span> 3;</div>
<div class="line"><span class="lineno"> 3147</span>                            }</div>
<div class="line"><span class="lineno"> 3148</span>                            $chain[] = $ca;</div>
<div class="line"><span class="lineno"> 3149</span>                            <span class="keywordflow">break</span> 2;</div>
<div class="line"><span class="lineno"> 3150</span>                    }</div>
<div class="line"><span class="lineno"> 3151</span>                }</div>
<div class="line"><span class="lineno"> 3152</span>            }</div>
<div class="line"><span class="lineno"> 3153</span>            <span class="keywordflow">if</span> ($i == count($this-&gt;CAs)) {</div>
<div class="line"><span class="lineno"> 3154</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3155</span>            }</div>
<div class="line"><span class="lineno"> 3156</span>        }</div>
<div class="line"><span class="lineno"> 3157</span>        <span class="keywordflow">foreach</span> ($chain as $key =&gt; $value) {</div>
<div class="line"><span class="lineno"> 3158</span>            $chain[$key] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__X509.html">File_X509</a>();</div>
<div class="line"><span class="lineno"> 3159</span>            $chain[$key]-&gt;loadX509($value);</div>
<div class="line"><span class="lineno"> 3160</span>        }</div>
<div class="line"><span class="lineno"> 3161</span>        <span class="keywordflow">return</span> $chain;</div>
<div class="line"><span class="lineno"> 3162</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_a13ce82673cd9b9e0aebbd6c10010a686"><div class="ttname"><a href="classFile__X509.html#a13ce82673cd9b9e0aebbd6c10010a686">File_X509\$currentCert</a></div><div class="ttdeci">$currentCert</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00259">X509.php:259</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04527">getExtension()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a72aefa3de97ff30a83063abc3b8ce568_cgraph.png" border="0" usemap="#aclassFile__X509_a72aefa3de97ff30a83063abc3b8ce568_cgraph" alt=""/></div>
<map name="aclassFile__X509_a72aefa3de97ff30a83063abc3b8ce568_cgraph" id="aclassFile__X509_a72aefa3de97ff30a83063abc3b8ce568_cgraph">
<area shape="rect" title="Get the certificate chain for the current cert." alt="" coords="5,5,85,31"/>
<area shape="rect" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb" title="Get a certificate, CSR or CRL Extension." alt="" coords="133,5,240,31"/>
<area shape="rect" href="classFile__X509.html#a51d0ffadbcbf965b23238b89fef03484" title="Get an Extension." alt="" coords="288,5,403,31"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="451,5,551,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="599,5,685,31"/>
</map>
</div>

</div>
</div>
<a id="a97392a261d56bd64002da7d1e76e8195" name="a97392a261d56bd64002da7d1e76e8195"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97392a261d56bd64002da7d1e76e8195">&#9670;&#160;</a></span>getDN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getDN </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$format</em> = <code><a class="el" href="X509_8php.html#a03ccdbecf418c2c8f31dff69c7192b6e">FILE_X509_DN_ARRAY</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$dn</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the Distinguished Name for a certificates subject. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">mixed</td><td class="paramname">$format</td><td>optional </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$dn</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02882">2882</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2883</span>    {</div>
<div class="line"><span class="lineno"> 2884</span>        global <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>;</div>
<div class="line"><span class="lineno"> 2885</span> </div>
<div class="line"><span class="lineno"> 2886</span>        <span class="keywordflow">if</span> (!isset($dn)) {</div>
<div class="line"><span class="lineno"> 2887</span>            $dn = isset($this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>]) ? $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>][<span class="stringliteral">&#39;issuer&#39;</span>] : $this-&gt;dn;</div>
<div class="line"><span class="lineno"> 2888</span>        }</div>
<div class="line"><span class="lineno"> 2889</span> </div>
<div class="line"><span class="lineno"> 2890</span>        <span class="keywordflow">switch</span> ((<span class="keywordtype">int</span>) $format) {</div>
<div class="line"><span class="lineno"> 2891</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="X509_8php.html#a03ccdbecf418c2c8f31dff69c7192b6e">FILE_X509_DN_ARRAY</a>:</div>
<div class="line"><span class="lineno"> 2892</span>                <span class="keywordflow">return</span> $dn;</div>
<div class="line"><span class="lineno"> 2893</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="X509_8php.html#a3cd3b42bdcdd97120e975ca39f45a214">FILE_X509_DN_ASN1</a>:</div>
<div class="line"><span class="lineno"> 2894</span>                $asn1 = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__ASN1.html">File_ASN1</a>();</div>
<div class="line"><span class="lineno"> 2895</span>                $asn1-&gt;loadOIDs($this-&gt;oids);</div>
<div class="line"><span class="lineno"> 2896</span>                $filters = array();</div>
<div class="line"><span class="lineno"> 2897</span>                $filters[<span class="stringliteral">&#39;rdnSequence&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>] = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>);</div>
<div class="line"><span class="lineno"> 2898</span>                $asn1-&gt;loadFilters($filters);</div>
<div class="line"><span class="lineno"> 2899</span>                $this-&gt;_mapOutDNs($dn, <span class="stringliteral">&#39;rdnSequence&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 2900</span>                <span class="keywordflow">return</span> $asn1-&gt;encodeDER($dn, $this-&gt;Name);</div>
<div class="line"><span class="lineno"> 2901</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="X509_8php.html#a47be31f439f293cd7ae7d87a2498dc20">FILE_X509_DN_CANON</a>:</div>
<div class="line"><span class="lineno"> 2902</span>                <span class="comment">//  No SEQUENCE around RDNs and all string values normalized as</span></div>
<div class="line"><span class="lineno"> 2903</span>                <span class="comment">// trimmed lowercase UTF-8 with all spacing as one blank.</span></div>
<div class="line"><span class="lineno"> 2904</span>                <span class="comment">// constructed RDNs will not be canonicalized</span></div>
<div class="line"><span class="lineno"> 2905</span>                $asn1 = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__ASN1.html">File_ASN1</a>();</div>
<div class="line"><span class="lineno"> 2906</span>                $asn1-&gt;loadOIDs($this-&gt;oids);</div>
<div class="line"><span class="lineno"> 2907</span>                $filters = array();</div>
<div class="line"><span class="lineno"> 2908</span>                $filters[<span class="stringliteral">&#39;value&#39;</span>] = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>);</div>
<div class="line"><span class="lineno"> 2909</span>                $asn1-&gt;loadFilters($filters);</div>
<div class="line"><span class="lineno"> 2910</span>                $result = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 2911</span>                $this-&gt;_mapOutDNs($dn, <span class="stringliteral">&#39;rdnSequence&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 2912</span>                <span class="keywordflow">foreach</span> ($dn[<span class="stringliteral">&#39;rdnSequence&#39;</span>] as $rdn) {</div>
<div class="line"><span class="lineno"> 2913</span>                    <span class="keywordflow">foreach</span> ($rdn as $i =&gt; $attr) {</div>
<div class="line"><span class="lineno"> 2914</span>                        $attr = &amp;$rdn[$i];</div>
<div class="line"><span class="lineno"> 2915</span>                        <span class="keywordflow">if</span> (is_array($attr[<span class="stringliteral">&#39;value&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2916</span>                            <span class="keywordflow">foreach</span> ($attr[<span class="stringliteral">&#39;value&#39;</span>] as $type =&gt; $v) {</div>
<div class="line"><span class="lineno"> 2917</span>                                $type = array_search($type, $asn1-&gt;ANYmap, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2918</span>                                <span class="keywordflow">if</span> ($type !== <span class="keyword">false</span> &amp;&amp; isset($asn1-&gt;stringTypeSize[$type])) {</div>
<div class="line"><span class="lineno"> 2919</span>                                    $v = $asn1-&gt;convert($v, $type);</div>
<div class="line"><span class="lineno"> 2920</span>                                    <span class="keywordflow">if</span> ($v !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2921</span>                                        $v = preg_replace(<span class="stringliteral">&#39;/\s+/&#39;</span>, <span class="charliteral">&#39; &#39;</span>, $v);</div>
<div class="line"><span class="lineno"> 2922</span>                                        $attr[<span class="stringliteral">&#39;value&#39;</span>] = strtolower(trim($v));</div>
<div class="line"><span class="lineno"> 2923</span>                                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2924</span>                                    }</div>
<div class="line"><span class="lineno"> 2925</span>                                }</div>
<div class="line"><span class="lineno"> 2926</span>                            }</div>
<div class="line"><span class="lineno"> 2927</span>                        }</div>
<div class="line"><span class="lineno"> 2928</span>                    }</div>
<div class="line"><span class="lineno"> 2929</span>                    $result .= $asn1-&gt;encodeDER($rdn, $this-&gt;RelativeDistinguishedName);</div>
<div class="line"><span class="lineno"> 2930</span>                }</div>
<div class="line"><span class="lineno"> 2931</span>                <span class="keywordflow">return</span> $result;</div>
<div class="line"><span class="lineno"> 2932</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="X509_8php.html#aa2753bd9fa8b9daaaba2f9db9741ff25">FILE_X509_DN_HASH</a>:</div>
<div class="line"><span class="lineno"> 2933</span>                <a class="code hl_variable" href="classFile__X509.html#aec1788b361bcb8be2632e5a0e3b8097b">$dn</a> = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a97392a261d56bd64002da7d1e76e8195">getDN</a>(<a class="code hl_variable" href="X509_8php.html#a47be31f439f293cd7ae7d87a2498dc20">FILE_X509_DN_CANON</a>, $dn);</div>
<div class="line"><span class="lineno"> 2934</span>                <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_Hash&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 2935</span>                    include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/Hash.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 2936</span>                }</div>
<div class="line"><span class="lineno"> 2937</span>                $hash = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__Hash.html">Crypt_Hash</a>(<span class="stringliteral">&#39;sha1&#39;</span>);</div>
<div class="line"><span class="lineno"> 2938</span>                $hash = $hash-&gt;hash($dn);</div>
<div class="line"><span class="lineno"> 2939</span>                extract(unpack(<span class="stringliteral">&#39;Vhash&#39;</span>, $hash));</div>
<div class="line"><span class="lineno"> 2940</span>                <span class="keywordflow">return</span> strtolower(bin2hex(pack(<span class="charliteral">&#39;N&#39;</span>, $hash)));</div>
<div class="line"><span class="lineno"> 2941</span>        }</div>
<div class="line"><span class="lineno"> 2942</span> </div>
<div class="line"><span class="lineno"> 2943</span>        <span class="comment">// Default is to return a string.</span></div>
<div class="line"><span class="lineno"> 2944</span>        $start = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2945</span>        $output = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 2946</span>        $result = array();</div>
<div class="line"><span class="lineno"> 2947</span>        $asn1 = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__ASN1.html">File_ASN1</a>();</div>
<div class="line"><span class="lineno"> 2948</span>        $asn1-&gt;loadOIDs($this-&gt;oids);</div>
<div class="line"><span class="lineno"> 2949</span>        $filters = array();</div>
<div class="line"><span class="lineno"> 2950</span>        $filters[<span class="stringliteral">&#39;rdnSequence&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>] = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>);</div>
<div class="line"><span class="lineno"> 2951</span>        $asn1-&gt;loadFilters($filters);</div>
<div class="line"><span class="lineno"> 2952</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c">_mapOutDNs</a>($dn, <span class="stringliteral">&#39;rdnSequence&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 2953</span>        <span class="keywordflow">foreach</span> ($dn[<span class="stringliteral">&#39;rdnSequence&#39;</span>] as $field) {</div>
<div class="line"><span class="lineno"> 2954</span>            $prop = $field[0][<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><span class="lineno"> 2955</span>            $value = $field[0][<span class="stringliteral">&#39;value&#39;</span>];</div>
<div class="line"><span class="lineno"> 2956</span> </div>
<div class="line"><span class="lineno"> 2957</span>            $delim = <span class="stringliteral">&#39;, &#39;</span>;</div>
<div class="line"><span class="lineno"> 2958</span>            <span class="keywordflow">switch</span> ($prop) {</div>
<div class="line"><span class="lineno"> 2959</span>                <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-countryName&#39;</span>:</div>
<div class="line"><span class="lineno"> 2960</span>                    $desc = <span class="charliteral">&#39;C&#39;</span>;</div>
<div class="line"><span class="lineno"> 2961</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2962</span>                <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-stateOrProvinceName&#39;</span>:</div>
<div class="line"><span class="lineno"> 2963</span>                    $desc = <span class="stringliteral">&#39;ST&#39;</span>;</div>
<div class="line"><span class="lineno"> 2964</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2965</span>                <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-organizationName&#39;</span>:</div>
<div class="line"><span class="lineno"> 2966</span>                    $desc = <span class="charliteral">&#39;O&#39;</span>;</div>
<div class="line"><span class="lineno"> 2967</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2968</span>                <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-organizationalUnitName&#39;</span>:</div>
<div class="line"><span class="lineno"> 2969</span>                    $desc = <span class="stringliteral">&#39;OU&#39;</span>;</div>
<div class="line"><span class="lineno"> 2970</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2971</span>                <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-commonName&#39;</span>:</div>
<div class="line"><span class="lineno"> 2972</span>                    $desc = <span class="stringliteral">&#39;CN&#39;</span>;</div>
<div class="line"><span class="lineno"> 2973</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2974</span>                <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-localityName&#39;</span>:</div>
<div class="line"><span class="lineno"> 2975</span>                    $desc = <span class="charliteral">&#39;L&#39;</span>;</div>
<div class="line"><span class="lineno"> 2976</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2977</span>                <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-surname&#39;</span>:</div>
<div class="line"><span class="lineno"> 2978</span>                    $desc = <span class="stringliteral">&#39;SN&#39;</span>;</div>
<div class="line"><span class="lineno"> 2979</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2980</span>                <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-uniqueIdentifier&#39;</span>:</div>
<div class="line"><span class="lineno"> 2981</span>                    $delim = <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><span class="lineno"> 2982</span>                    $desc = <span class="stringliteral">&#39;x500UniqueIdentifier&#39;</span>;</div>
<div class="line"><span class="lineno"> 2983</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2984</span>                <span class="keywordflow">case</span> <span class="stringliteral">&#39;id-at-postalAddress&#39;</span>:</div>
<div class="line"><span class="lineno"> 2985</span>                    $delim = <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><span class="lineno"> 2986</span>                    $desc = <span class="stringliteral">&#39;postalAddress&#39;</span>;</div>
<div class="line"><span class="lineno"> 2987</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2988</span>                <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2989</span>                    $delim = <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><span class="lineno"> 2990</span>                    $desc = preg_replace(<span class="stringliteral">&#39;#.+-([^-]+)$#&#39;</span>, <span class="stringliteral">&#39;$1&#39;</span>, $prop);</div>
<div class="line"><span class="lineno"> 2991</span>            }</div>
<div class="line"><span class="lineno"> 2992</span> </div>
<div class="line"><span class="lineno"> 2993</span>            <span class="keywordflow">if</span> (!$start) {</div>
<div class="line"><span class="lineno"> 2994</span>                $output.= $delim;</div>
<div class="line"><span class="lineno"> 2995</span>            }</div>
<div class="line"><span class="lineno"> 2996</span>            <span class="keywordflow">if</span> (is_array($value)) {</div>
<div class="line"><span class="lineno"> 2997</span>                <span class="keywordflow">foreach</span> ($value as $type =&gt; $v) {</div>
<div class="line"><span class="lineno"> 2998</span>                    $type = array_search($type, $asn1-&gt;ANYmap, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2999</span>                    <span class="keywordflow">if</span> ($type !== <span class="keyword">false</span> &amp;&amp; isset($asn1-&gt;stringTypeSize[$type])) {</div>
<div class="line"><span class="lineno"> 3000</span>                        $v = $asn1-&gt;convert($v, $type);</div>
<div class="line"><span class="lineno"> 3001</span>                        <span class="keywordflow">if</span> ($v !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3002</span>                            $value = $v;</div>
<div class="line"><span class="lineno"> 3003</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3004</span>                        }</div>
<div class="line"><span class="lineno"> 3005</span>                    }</div>
<div class="line"><span class="lineno"> 3006</span>                }</div>
<div class="line"><span class="lineno"> 3007</span>                <span class="keywordflow">if</span> (is_array($value)) {</div>
<div class="line"><span class="lineno"> 3008</span>                    $value = array_pop($value); <span class="comment">// Always strip data type.</span></div>
<div class="line"><span class="lineno"> 3009</span>                }</div>
<div class="line"><span class="lineno"> 3010</span>            } elseif (is_object($value) &amp;&amp; strtolower(get_class($value)) == <span class="stringliteral">&#39;file_asn1_element&#39;</span>) {</div>
<div class="line"><span class="lineno"> 3011</span>                <span class="comment">// @codingStandardsIgnoreStart</span></div>
<div class="line"><span class="lineno"> 3012</span>                $callback = version_compare(<a class="code hl_variable" href="configtest_8php.html#a3c1ade165b70ecbf36a71bc64671334a">PHP_VERSION</a>, <span class="stringliteral">&#39;5.3.0&#39;</span>) &gt;= 0 ?</div>
<div class="line"><span class="lineno"> 3013</span>                    eval(<span class="stringliteral">&#39;return function ($x) { return &quot;\x&quot; . bin2hex($x[0]); };&#39;</span>) :</div>
<div class="line"><span class="lineno"> 3014</span>                    create_function(<span class="stringliteral">&#39;$x&#39;</span>, <span class="stringliteral">&#39;return &quot;\x&quot; . bin2hex($x[0]);&#39;</span>);</div>
<div class="line"><span class="lineno"> 3015</span>                <span class="comment">// @codingStandardsIgnoreEnd</span></div>
<div class="line"><span class="lineno"> 3016</span>                $value = strtoupper(preg_replace_callback(<span class="stringliteral">&#39;#[^\x20-\x7E]#&#39;</span>, $callback, $value-&gt;element));</div>
<div class="line"><span class="lineno"> 3017</span>            }</div>
<div class="line"><span class="lineno"> 3018</span>            $output.= $desc . <span class="charliteral">&#39;=&#39;</span> . $value;</div>
<div class="line"><span class="lineno"> 3019</span>            $result[$desc] = isset($result[$desc]) ?</div>
<div class="line"><span class="lineno"> 3020</span>                array_merge((array) $result[$desc], array($value)) :</div>
<div class="line"><span class="lineno"> 3021</span>                $value;</div>
<div class="line"><span class="lineno"> 3022</span>            $start = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3023</span>        }</div>
<div class="line"><span class="lineno"> 3024</span> </div>
<div class="line"><span class="lineno"> 3025</span>        <span class="keywordflow">return</span> $format == <a class="code hl_variable" href="X509_8php.html#aefd8b730dec95320da1fca8e0ebd3990">FILE_X509_DN_OPENSSL</a> ? $result : $output;</div>
<div class="line"><span class="lineno"> 3026</span>    }</div>
<div class="ttc" id="aX509_8php_html_a03ccdbecf418c2c8f31dff69c7192b6e"><div class="ttname"><a href="X509_8php.html#a03ccdbecf418c2c8f31dff69c7192b6e">FILE_X509_DN_ARRAY</a></div><div class="ttdeci">const FILE_X509_DN_ARRAY</div><div class="ttdoc">#+ @access public</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00068">X509.php:68</a></div></div>
<div class="ttc" id="aX509_8php_html_a3cd3b42bdcdd97120e975ca39f45a214"><div class="ttname"><a href="X509_8php.html#a3cd3b42bdcdd97120e975ca39f45a214">FILE_X509_DN_ASN1</a></div><div class="ttdeci">const FILE_X509_DN_ASN1</div><div class="ttdoc">Return ASN.1 name string.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00076">X509.php:76</a></div></div>
<div class="ttc" id="aX509_8php_html_a47be31f439f293cd7ae7d87a2498dc20"><div class="ttname"><a href="X509_8php.html#a47be31f439f293cd7ae7d87a2498dc20">FILE_X509_DN_CANON</a></div><div class="ttdeci">const FILE_X509_DN_CANON</div><div class="ttdoc">Return canonical ASN.1 RDNs string.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00084">X509.php:84</a></div></div>
<div class="ttc" id="aX509_8php_html_aa2753bd9fa8b9daaaba2f9db9741ff25"><div class="ttname"><a href="X509_8php.html#aa2753bd9fa8b9daaaba2f9db9741ff25">FILE_X509_DN_HASH</a></div><div class="ttdeci">const FILE_X509_DN_HASH</div><div class="ttdoc">Return name hash for file indexing.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00088">X509.php:88</a></div></div>
<div class="ttc" id="aX509_8php_html_aefd8b730dec95320da1fca8e0ebd3990"><div class="ttname"><a href="X509_8php.html#aefd8b730dec95320da1fca8e0ebd3990">FILE_X509_DN_OPENSSL</a></div><div class="ttdeci">const FILE_X509_DN_OPENSSL</div><div class="ttdoc">Return OpenSSL compatible array.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00080">X509.php:80</a></div></div>
<div class="ttc" id="aclassFile__X509_html_add37e36fc7605e4b4d1d6f1dc061983c"><div class="ttname"><a href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c">File_X509\_mapOutDNs</a></div><div class="ttdeci">_mapOutDNs(&amp;$root, $path, $asn1)</div><div class="ttdoc">Map DN values from DN-specific internal format to ANY type.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l01881">X509.php:1881</a></div></div>
<div class="ttc" id="aclassFile__X509_html_aec1788b361bcb8be2632e5a0e3b8097b"><div class="ttname"><a href="classFile__X509.html#aec1788b361bcb8be2632e5a0e3b8097b">File_X509\$dn</a></div><div class="ttdeci">$dn</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00218">X509.php:218</a></div></div>
<div class="ttc" id="aconfigtest_8php_html_a3c1ade165b70ecbf36a71bc64671334a"><div class="ttname"><a href="configtest_8php.html#a3c1ade165b70ecbf36a71bc64671334a">PHP_VERSION</a></div><div class="ttdeci">print PHP_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="configtest_8php_source.html#l00041">configtest.php:41</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="install_8php_source.html#l00039">$VIEW_PATH</a>, <a class="el" href="X509_8php_source.html#l01881">_mapOutDNs()</a>, <a class="el" href="ASN1_8php_source.html#l00071">FILE_ASN1_TYPE_UTF8_STRING</a>, <a class="el" href="X509_8php_source.html#l00068">FILE_X509_DN_ARRAY</a>, <a class="el" href="X509_8php_source.html#l00076">FILE_X509_DN_ASN1</a>, <a class="el" href="X509_8php_source.html#l00084">FILE_X509_DN_CANON</a>, <a class="el" href="X509_8php_source.html#l00088">FILE_X509_DN_HASH</a>, <a class="el" href="X509_8php_source.html#l00080">FILE_X509_DN_OPENSSL</a>, <a class="el" href="X509_8php_source.html#l02882">getDN()</a>, and <a class="el" href="configtest_8php_source.html#l00041">PHP_VERSION</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l02331">_validateSignatureCountable()</a>, <a class="el" href="X509_8php_source.html#l02882">getDN()</a>, <a class="el" href="X509_8php_source.html#l03035">getIssuerDN()</a>, and <a class="el" href="X509_8php_source.html#l03057">getSubjectDN()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a97392a261d56bd64002da7d1e76e8195_cgraph.png" border="0" usemap="#aclassFile__X509_a97392a261d56bd64002da7d1e76e8195_cgraph" alt=""/></div>
<map name="aclassFile__X509_a97392a261d56bd64002da7d1e76e8195_cgraph" id="aclassFile__X509_a97392a261d56bd64002da7d1e76e8195_cgraph">
<area shape="rect" title="Get the Distinguished Name for a certificates subject." alt="" coords="5,31,68,56"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="116,31,224,56"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="272,5,379,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="282,55,369,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a97392a261d56bd64002da7d1e76e8195_icgraph.png" border="0" usemap="#aclassFile__X509_a97392a261d56bd64002da7d1e76e8195_icgraph" alt=""/></div>
<map name="aclassFile__X509_a97392a261d56bd64002da7d1e76e8195_icgraph" id="aclassFile__X509_a97392a261d56bd64002da7d1e76e8195_icgraph">
<area shape="rect" title="Get the Distinguished Name for a certificates subject." alt="" coords="608,31,671,56"/>
<area shape="rect" href="classFile__X509.html#a96ee8b07aceb37a5d949447f7349bf12" title="Validate a signature." alt="" coords="191,5,401,31"/>
<area shape="rect" href="classFile__X509.html#a1d9888293c71b3fe2d087776ca31c0eb" title="Get the Distinguished Name for a certificate/crl issuer." alt="" coords="453,31,556,56"/>
<area shape="rect" href="classFile__X509.html#ae5fb776b269eef60c472521c6b4dc219" title="Get the Distinguished Name for a certificate/csr subject Alias of getDN()" alt="" coords="449,80,560,105"/>
<area shape="rect" href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa" title="Validate a signature." alt="" coords="5,5,143,31"/>
</map>
</div>

</div>
</div>
<a id="aa5e331e0ded7b3d7a76452ba6ff70194" name="aa5e331e0ded7b3d7a76452ba6ff70194"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5e331e0ded7b3d7a76452ba6ff70194">&#9670;&#160;</a></span>getDNProp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getDNProp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$propName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$dn</em> = <code>null</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$withType</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get Distinguished Name properties. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$propName</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$dn</td><td>optional </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$withType</td><td>optional </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed @access public </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02776">2776</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2777</span>    {</div>
<div class="line"><span class="lineno"> 2778</span>        <span class="keywordflow">if</span> (!isset($dn)) {</div>
<div class="line"><span class="lineno"> 2779</span>            $dn = $this-&gt;dn;</div>
<div class="line"><span class="lineno"> 2780</span>        }</div>
<div class="line"><span class="lineno"> 2781</span> </div>
<div class="line"><span class="lineno"> 2782</span>        <span class="keywordflow">if</span> (empty($dn)) {</div>
<div class="line"><span class="lineno"> 2783</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2784</span>        }</div>
<div class="line"><span class="lineno"> 2785</span> </div>
<div class="line"><span class="lineno"> 2786</span>        <span class="keywordflow">if</span> (($propName = $this-&gt;<a class="code hl_function" href="classFile__X509.html#ad4e0267f8e236f9707325bce89ce2b0a">_translateDNProp</a>($propName)) === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2787</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2788</span>        }</div>
<div class="line"><span class="lineno"> 2789</span> </div>
<div class="line"><span class="lineno"> 2790</span>        $asn1 = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__ASN1.html">File_ASN1</a>();</div>
<div class="line"><span class="lineno"> 2791</span>        $asn1-&gt;loadOIDs($this-&gt;oids);</div>
<div class="line"><span class="lineno"> 2792</span>        $filters = array();</div>
<div class="line"><span class="lineno"> 2793</span>        $filters[<span class="stringliteral">&#39;value&#39;</span>] = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>);</div>
<div class="line"><span class="lineno"> 2794</span>        $asn1-&gt;loadFilters($filters);</div>
<div class="line"><span class="lineno"> 2795</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c">_mapOutDNs</a>($dn, <span class="stringliteral">&#39;rdnSequence&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 2796</span>        <a class="code hl_variable" href="classFile__X509.html#aec1788b361bcb8be2632e5a0e3b8097b">$dn</a> = <a class="code hl_variable" href="classFile__X509.html#aec1788b361bcb8be2632e5a0e3b8097b">$dn</a>[<span class="stringliteral">&#39;rdnSequence&#39;</span>];</div>
<div class="line"><span class="lineno"> 2797</span>        $result = array();</div>
<div class="line"><span class="lineno"> 2798</span>        <span class="keywordflow">for</span> ($i = 0; $i &lt; count($dn); $i++) {</div>
<div class="line"><span class="lineno"> 2799</span>            <span class="keywordflow">if</span> ($dn[$i][0][<span class="stringliteral">&#39;type&#39;</span>] == $propName) {</div>
<div class="line"><span class="lineno"> 2800</span>                $v = <a class="code hl_variable" href="classFile__X509.html#aec1788b361bcb8be2632e5a0e3b8097b">$dn</a>[$i][0][<span class="stringliteral">&#39;value&#39;</span>];</div>
<div class="line"><span class="lineno"> 2801</span>                <span class="keywordflow">if</span> (!$withType) {</div>
<div class="line"><span class="lineno"> 2802</span>                    <span class="keywordflow">if</span> (is_array($v)) {</div>
<div class="line"><span class="lineno"> 2803</span>                        <span class="keywordflow">foreach</span> ($v as $type =&gt; $s) {</div>
<div class="line"><span class="lineno"> 2804</span>                            $type = array_search($type, $asn1-&gt;ANYmap, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2805</span>                            <span class="keywordflow">if</span> ($type !== <span class="keyword">false</span> &amp;&amp; isset($asn1-&gt;stringTypeSize[$type])) {</div>
<div class="line"><span class="lineno"> 2806</span>                                $s = $asn1-&gt;convert($s, $type);</div>
<div class="line"><span class="lineno"> 2807</span>                                <span class="keywordflow">if</span> ($s !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2808</span>                                    $v = $s;</div>
<div class="line"><span class="lineno"> 2809</span>                                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2810</span>                                }</div>
<div class="line"><span class="lineno"> 2811</span>                            }</div>
<div class="line"><span class="lineno"> 2812</span>                        }</div>
<div class="line"><span class="lineno"> 2813</span>                        <span class="keywordflow">if</span> (is_array($v)) {</div>
<div class="line"><span class="lineno"> 2814</span>                            $v = array_pop($v); <span class="comment">// Always strip data type.</span></div>
<div class="line"><span class="lineno"> 2815</span>                        }</div>
<div class="line"><span class="lineno"> 2816</span>                    } elseif (is_object($v) &amp;&amp; strtolower(get_class($v)) == <span class="stringliteral">&#39;file_asn1_element&#39;</span>) {</div>
<div class="line"><span class="lineno"> 2817</span>                        $map = $this-&gt;<a class="code hl_function" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f">_getMapping</a>($propName);</div>
<div class="line"><span class="lineno"> 2818</span>                        <span class="keywordflow">if</span> (!is_bool($map)) {</div>
<div class="line"><span class="lineno"> 2819</span>                            $decoded = $asn1-&gt;decodeBER($v);</div>
<div class="line"><span class="lineno"> 2820</span>                            $v = $asn1-&gt;asn1map($decoded[0], $map);</div>
<div class="line"><span class="lineno"> 2821</span>                        }</div>
<div class="line"><span class="lineno"> 2822</span>                    }</div>
<div class="line"><span class="lineno"> 2823</span>                }</div>
<div class="line"><span class="lineno"> 2824</span>                $result[] = $v;</div>
<div class="line"><span class="lineno"> 2825</span>            }</div>
<div class="line"><span class="lineno"> 2826</span>        }</div>
<div class="line"><span class="lineno"> 2827</span> </div>
<div class="line"><span class="lineno"> 2828</span>        <span class="keywordflow">return</span> $result;</div>
<div class="line"><span class="lineno"> 2829</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_ad4e0267f8e236f9707325bce89ce2b0a"><div class="ttname"><a href="classFile__X509.html#ad4e0267f8e236f9707325bce89ce2b0a">File_X509\_translateDNProp</a></div><div class="ttdeci">_translateDNProp($propName)</div><div class="ttdoc">&quot;Normalizes&quot; a Distinguished Name property</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l02617">X509.php:2617</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l01911">_getMapping()</a>, <a class="el" href="X509_8php_source.html#l01881">_mapOutDNs()</a>, <a class="el" href="X509_8php_source.html#l02617">_translateDNProp()</a>, and <a class="el" href="ASN1_8php_source.html#l00071">FILE_ASN1_TYPE_UTF8_STRING</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l03081">getIssuerDNProp()</a>, <a class="el" href="X509_8php_source.html#l03103">getSubjectDNProp()</a>, and <a class="el" href="X509_8php_source.html#l02086">validateURL()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_aa5e331e0ded7b3d7a76452ba6ff70194_cgraph.png" border="0" usemap="#aclassFile__X509_aa5e331e0ded7b3d7a76452ba6ff70194_cgraph" alt=""/></div>
<map name="aclassFile__X509_aa5e331e0ded7b3d7a76452ba6ff70194_cgraph" id="aclassFile__X509_aa5e331e0ded7b3d7a76452ba6ff70194_cgraph">
<area shape="rect" title="Get Distinguished Name properties." alt="" coords="5,55,97,80"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="329,5,436,31"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="159,55,267,80"/>
<area shape="rect" href="classFile__X509.html#ad4e0267f8e236f9707325bce89ce2b0a" title="&quot;Normalizes&quot; a Distinguished Name property" alt="" coords="145,104,281,129"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="339,55,426,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_aa5e331e0ded7b3d7a76452ba6ff70194_icgraph.png" border="0" usemap="#aclassFile__X509_aa5e331e0ded7b3d7a76452ba6ff70194_icgraph" alt=""/></div>
<map name="aclassFile__X509_aa5e331e0ded7b3d7a76452ba6ff70194_icgraph" id="aclassFile__X509_aa5e331e0ded7b3d7a76452ba6ff70194_icgraph">
<area shape="rect" title="Get Distinguished Name properties." alt="" coords="193,55,285,80"/>
<area shape="rect" href="classFile__X509.html#ad0f40f609ab964e6a8ddf2439fe98e5d" title="Get an individual Distinguished Name property for a certificate/crl issuer." alt="" coords="10,5,141,31"/>
<area shape="rect" href="classFile__X509.html#a7ef1db256262071ba886eb5335084ecf" title="Get an individual Distinguished Name property for a certificate/csr subject." alt="" coords="5,55,145,80"/>
<area shape="rect" href="classFile__X509.html#afad375b8ebfbf0ed26dc7f1bb74e9ad3" title="Validate an X.509 certificate against a URL." alt="" coords="25,104,126,129"/>
</map>
</div>

</div>
</div>
<a id="afc1207c2b7e8e70f61598815ee07fcdb" name="afc1207c2b7e8e70f61598815ee07fcdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc1207c2b7e8e70f61598815ee07fcdb">&#9670;&#160;</a></span>getExtension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getExtension </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$cert</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a certificate, CSR or CRL Extension. </p>
<p>Returns the extension if it exists and false if not</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$id</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$cert</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04527">4527</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4528</span>    {</div>
<div class="line"><span class="lineno"> 4529</span>        <span class="keywordflow">return</span> $this-&gt;_getExtension($id, $cert);</div>
<div class="line"><span class="lineno"> 4530</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04430">_getExtension()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l02249">_testForIntermediate()</a>, <a class="el" href="X509_8php_source.html#l02331">_validateSignatureCountable()</a>, <a class="el" href="X509_8php_source.html#l03125">getChain()</a>, <a class="el" href="X509_8php_source.html#l01497">loadX509()</a>, <a class="el" href="X509_8php_source.html#l03684">sign()</a>, <a class="el" href="X509_8php_source.html#l04004">signCRL()</a>, and <a class="el" href="X509_8php_source.html#l02086">validateURL()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_afc1207c2b7e8e70f61598815ee07fcdb_cgraph.png" border="0" usemap="#aclassFile__X509_afc1207c2b7e8e70f61598815ee07fcdb_cgraph" alt=""/></div>
<map name="aclassFile__X509_afc1207c2b7e8e70f61598815ee07fcdb_cgraph" id="aclassFile__X509_afc1207c2b7e8e70f61598815ee07fcdb_cgraph">
<area shape="rect" title="Get a certificate, CSR or CRL Extension." alt="" coords="5,5,112,31"/>
<area shape="rect" href="classFile__X509.html#a51d0ffadbcbf965b23238b89fef03484" title="Get an Extension." alt="" coords="160,5,275,31"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="323,5,423,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="471,5,557,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_afc1207c2b7e8e70f61598815ee07fcdb_icgraph.png" border="0" usemap="#aclassFile__X509_afc1207c2b7e8e70f61598815ee07fcdb_icgraph" alt=""/></div>
<map name="aclassFile__X509_afc1207c2b7e8e70f61598815ee07fcdb_icgraph" id="aclassFile__X509_afc1207c2b7e8e70f61598815ee07fcdb_icgraph">
<area shape="rect" title="Get a certificate, CSR or CRL Extension." alt="" coords="656,156,763,181"/>
<area shape="rect" href="classFile__X509.html#acc2e876f81f33f786d44175e43f96727" title="Validates an intermediate cert as identified via authority info access extension." alt="" coords="449,5,608,31"/>
<area shape="rect" href="classFile__X509.html#a96ee8b07aceb37a5d949447f7349bf12" title="Validate a signature." alt="" coords="191,31,401,56"/>
<area shape="rect" href="classFile__X509.html#a72aefa3de97ff30a83063abc3b8ce568" title="Get the certificate chain for the current cert." alt="" coords="489,107,569,132"/>
<area shape="rect" href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376" title="Load X.509 certificate." alt="" coords="487,156,570,181"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="271,205,321,231"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="491,257,566,283"/>
<area shape="rect" href="classFile__X509.html#afad375b8ebfbf0ed26dc7f1bb74e9ad3" title="Validate an X.509 certificate against a URL." alt="" coords="478,307,579,332"/>
<area shape="rect" href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa" title="Validate a signature." alt="" coords="5,31,143,56"/>
<area shape="rect" href="classFile__X509.html#a89783012156bb16439adcba84bca93d8" title="Load an X.509 certificate as a certificate authority." alt="" coords="262,156,330,181"/>
</map>
</div>

</div>
</div>
<a id="a67b2aa40ccd2623250367494b69280c4" name="a67b2aa40ccd2623250367494b69280c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67b2aa40ccd2623250367494b69280c4">&#9670;&#160;</a></span>getExtensions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getExtensions </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$cert</em> = <code>null</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a list of all extensions in use in certificate, CSR or CRL. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$cert</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04539">4539</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4540</span>    {</div>
<div class="line"><span class="lineno"> 4541</span>        <span class="keywordflow">return</span> $this-&gt;_getExtensions($cert);</div>
<div class="line"><span class="lineno"> 4542</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04455">_getExtensions()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a67b2aa40ccd2623250367494b69280c4_cgraph.png" border="0" usemap="#aclassFile__X509_a67b2aa40ccd2623250367494b69280c4_cgraph" alt=""/></div>
<map name="aclassFile__X509_a67b2aa40ccd2623250367494b69280c4_cgraph" id="aclassFile__X509_a67b2aa40ccd2623250367494b69280c4_cgraph">
<area shape="rect" title="Returns a list of all extensions in use in certificate, CSR or CRL." alt="" coords="5,5,120,31"/>
<area shape="rect" href="classFile__X509.html#a7dfd9393f164e45947bac81e5bc97d7f" title="Returns a list of all extensions in use." alt="" coords="168,5,289,31"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="337,5,437,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="485,5,572,31"/>
</map>
</div>

</div>
</div>
<a id="a1d9888293c71b3fe2d087776ca31c0eb" name="a1d9888293c71b3fe2d087776ca31c0eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d9888293c71b3fe2d087776ca31c0eb">&#9670;&#160;</a></span>getIssuerDN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getIssuerDN </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$format</em> = <code><a class="el" href="X509_8php.html#a03ccdbecf418c2c8f31dff69c7192b6e">FILE_X509_DN_ARRAY</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the Distinguished Name for a certificate/crl issuer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$format</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03035">3035</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3036</span>    {</div>
<div class="line"><span class="lineno"> 3037</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 3038</span>            <span class="keywordflow">case</span> !isset($this-&gt;currentCert) || !is_array($this-&gt;currentCert):</div>
<div class="line"><span class="lineno"> 3039</span>                break;</div>
<div class="line"><span class="lineno"> 3040</span>            <span class="keywordflow">case</span> isset($this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>]):</div>
<div class="line"><span class="lineno"> 3041</span>                return $this-&gt;getDN($format, $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;issuer&#39;</span>]);</div>
<div class="line"><span class="lineno"> 3042</span>            <span class="keywordflow">case</span> isset($this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>]):</div>
<div class="line"><span class="lineno"> 3043</span>                return $this-&gt;getDN($format, $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>][<span class="stringliteral">&#39;issuer&#39;</span>]);</div>
<div class="line"><span class="lineno"> 3044</span>        }</div>
<div class="line"><span class="lineno"> 3045</span> </div>
<div class="line"><span class="lineno"> 3046</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3047</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l02882">getDN()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l02331">_validateSignatureCountable()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a1d9888293c71b3fe2d087776ca31c0eb_cgraph.png" border="0" usemap="#aclassFile__X509_a1d9888293c71b3fe2d087776ca31c0eb_cgraph" alt=""/></div>
<map name="aclassFile__X509_a1d9888293c71b3fe2d087776ca31c0eb_cgraph" id="aclassFile__X509_a1d9888293c71b3fe2d087776ca31c0eb_cgraph">
<area shape="rect" title="Get the Distinguished Name for a certificate/crl issuer." alt="" coords="5,31,108,56"/>
<area shape="rect" href="classFile__X509.html#a97392a261d56bd64002da7d1e76e8195" title="Get the Distinguished Name for a certificates subject." alt="" coords="156,31,219,56"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="267,31,375,56"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="423,5,529,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="433,55,519,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a1d9888293c71b3fe2d087776ca31c0eb_icgraph.png" border="0" usemap="#aclassFile__X509_a1d9888293c71b3fe2d087776ca31c0eb_icgraph" alt=""/></div>
<map name="aclassFile__X509_a1d9888293c71b3fe2d087776ca31c0eb_icgraph" id="aclassFile__X509_a1d9888293c71b3fe2d087776ca31c0eb_icgraph">
<area shape="rect" title="Get the Distinguished Name for a certificate/crl issuer." alt="" coords="449,5,552,31"/>
<area shape="rect" href="classFile__X509.html#a96ee8b07aceb37a5d949447f7349bf12" title="Validate a signature." alt="" coords="191,5,401,31"/>
<area shape="rect" href="classFile__X509.html#a63e18ebfa877fefabf86d16e0e2ceeaa" title="Validate a signature." alt="" coords="5,5,143,31"/>
</map>
</div>

</div>
</div>
<a id="ad0f40f609ab964e6a8ddf2439fe98e5d" name="ad0f40f609ab964e6a8ddf2439fe98e5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0f40f609ab964e6a8ddf2439fe98e5d">&#9670;&#160;</a></span>getIssuerDNProp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getIssuerDNProp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$propName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$withType</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get an individual Distinguished Name property for a certificate/crl issuer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$propName</td><td></td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$withType</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03081">3081</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3082</span>    {</div>
<div class="line"><span class="lineno"> 3083</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 3084</span>            <span class="keywordflow">case</span> !isset($this-&gt;currentCert) || !is_array($this-&gt;currentCert):</div>
<div class="line"><span class="lineno"> 3085</span>                break;</div>
<div class="line"><span class="lineno"> 3086</span>            <span class="keywordflow">case</span> isset($this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>]):</div>
<div class="line"><span class="lineno"> 3087</span>                return $this-&gt;getDNProp($propName, $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;issuer&#39;</span>], $withType);</div>
<div class="line"><span class="lineno"> 3088</span>            <span class="keywordflow">case</span> isset($this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>]):</div>
<div class="line"><span class="lineno"> 3089</span>                return $this-&gt;getDNProp($propName, $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>][<span class="stringliteral">&#39;issuer&#39;</span>], $withType);</div>
<div class="line"><span class="lineno"> 3090</span>        }</div>
<div class="line"><span class="lineno"> 3091</span> </div>
<div class="line"><span class="lineno"> 3092</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3093</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l02776">getDNProp()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ad0f40f609ab964e6a8ddf2439fe98e5d_cgraph.png" border="0" usemap="#aclassFile__X509_ad0f40f609ab964e6a8ddf2439fe98e5d_cgraph" alt=""/></div>
<map name="aclassFile__X509_ad0f40f609ab964e6a8ddf2439fe98e5d_cgraph" id="aclassFile__X509_ad0f40f609ab964e6a8ddf2439fe98e5d_cgraph">
<area shape="rect" title="Get an individual Distinguished Name property for a certificate/crl issuer." alt="" coords="5,55,136,80"/>
<area shape="rect" href="classFile__X509.html#aa5e331e0ded7b3d7a76452ba6ff70194" title="Get Distinguished Name properties." alt="" coords="184,55,276,80"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="508,5,615,31"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="338,55,446,80"/>
<area shape="rect" href="classFile__X509.html#ad4e0267f8e236f9707325bce89ce2b0a" title="&quot;Normalizes&quot; a Distinguished Name property" alt="" coords="324,104,460,129"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="518,55,605,80"/>
</map>
</div>

</div>
</div>
<a id="a92cea46b70ba6a1c077f7e7e68ec9aa0" name="a92cea46b70ba6a1c077f7e7e68ec9aa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92cea46b70ba6a1c077f7e7e68ec9aa0">&#9670;&#160;</a></span>getOID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getOID </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the OID corresponding to a name. </p>
<p>What's returned in the associative array returned by loadX509() (or load*()) is either a name or an OID if no OID to name mapping is available. The problem with this is that what may be an unmapped OID in one version of phpseclib may not be unmapped in the next version, so apps that are looking at this OID may not be able to work from version to version.</p>
<p>This method will return the OID if a name is passed to it and if no mapping is avialable it'll assume that what's being passed to it already is an OID and return that instead. A few examples.</p>
<p>getOID('2.16.840.1.101.3.4.2.1') == '2.16.840.1.101.3.4.2.1' getOID('id-sha256') == '2.16.840.1.101.3.4.2.1' getOID('zzz') == 'zzz'</p>
<p>@access public </p><dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l05195">5195</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5196</span>    {</div>
<div class="line"><span class="lineno"> 5197</span>        <span class="keyword">static</span> $reverseMap;</div>
<div class="line"><span class="lineno"> 5198</span>        <span class="keywordflow">if</span> (!isset($reverseMap)) {</div>
<div class="line"><span class="lineno"> 5199</span>            $reverseMap = array_flip($this-&gt;oids);</div>
<div class="line"><span class="lineno"> 5200</span>        }</div>
<div class="line"><span class="lineno"> 5201</span>        <span class="keywordflow">return</span> isset($reverseMap[$name]) ? $reverseMap[$name] : $name;</div>
<div class="line"><span class="lineno"> 5202</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afc841edb470c7b8c50e78daaf634228a" name="afc841edb470c7b8c50e78daaf634228a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc841edb470c7b8c50e78daaf634228a">&#9670;&#160;</a></span>getPublicKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getPublicKey </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the public key. </p>
<p>Returns a <a class="el" href="classCrypt__RSA.html">Crypt_RSA</a> object or a false.</p>
<p>@access public </p><dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03213">3213</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3214</span>    {</div>
<div class="line"><span class="lineno"> 3215</span>        global <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>;</div>
<div class="line"><span class="lineno"> 3216</span> </div>
<div class="line"><span class="lineno"> 3217</span>        <span class="keywordflow">if</span> (isset($this-&gt;publicKey)) {</div>
<div class="line"><span class="lineno"> 3218</span>            <span class="keywordflow">return</span> $this-&gt;publicKey;</div>
<div class="line"><span class="lineno"> 3219</span>        }</div>
<div class="line"><span class="lineno"> 3220</span> </div>
<div class="line"><span class="lineno"> 3221</span>        <span class="keywordflow">if</span> (isset($this-&gt;currentCert) &amp;&amp; is_array($this-&gt;currentCert)) {</div>
<div class="line"><span class="lineno"> 3222</span>            <span class="keywordflow">foreach</span> (array(<span class="stringliteral">&#39;tbsCertificate/subjectPublicKeyInfo&#39;</span>, <span class="stringliteral">&#39;certificationRequestInfo/subjectPKInfo&#39;</span>) as $path) {</div>
<div class="line"><span class="lineno"> 3223</span>                $keyinfo = $this-&gt;_subArray($this-&gt;currentCert, $path);</div>
<div class="line"><span class="lineno"> 3224</span>                <span class="keywordflow">if</span> (!empty($keyinfo)) {</div>
<div class="line"><span class="lineno"> 3225</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3226</span>                }</div>
<div class="line"><span class="lineno"> 3227</span>            }</div>
<div class="line"><span class="lineno"> 3228</span>        }</div>
<div class="line"><span class="lineno"> 3229</span>        <span class="keywordflow">if</span> (empty($keyinfo)) {</div>
<div class="line"><span class="lineno"> 3230</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3231</span>        }</div>
<div class="line"><span class="lineno"> 3232</span> </div>
<div class="line"><span class="lineno"> 3233</span>        $key = $keyinfo[<span class="stringliteral">&#39;subjectPublicKey&#39;</span>];</div>
<div class="line"><span class="lineno"> 3234</span> </div>
<div class="line"><span class="lineno"> 3235</span>        <span class="keywordflow">switch</span> ($keyinfo[<span class="stringliteral">&#39;algorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>]) {</div>
<div class="line"><span class="lineno"> 3236</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;rsaEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 3237</span>                <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_RSA&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 3238</span>                    include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/RSA.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 3239</span>                }</div>
<div class="line"><span class="lineno"> 3240</span>                <a class="code hl_variable" href="classFile__X509.html#a8d1062abadc25a988fb1aa01bfea74fe">$publicKey</a> = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__RSA.html">Crypt_RSA</a>();</div>
<div class="line"><span class="lineno"> 3241</span>                <a class="code hl_variable" href="classFile__X509.html#a8d1062abadc25a988fb1aa01bfea74fe">$publicKey</a>-&gt;loadKey($key);</div>
<div class="line"><span class="lineno"> 3242</span>                <a class="code hl_variable" href="classFile__X509.html#a8d1062abadc25a988fb1aa01bfea74fe">$publicKey</a>-&gt;setPublicKey();</div>
<div class="line"><span class="lineno"> 3243</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3244</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3245</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3246</span>        }</div>
<div class="line"><span class="lineno"> 3247</span> </div>
<div class="line"><span class="lineno"> 3248</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classFile__X509.html#a8d1062abadc25a988fb1aa01bfea74fe">$publicKey</a>;</div>
<div class="line"><span class="lineno"> 3249</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_a8d1062abadc25a988fb1aa01bfea74fe"><div class="ttname"><a href="classFile__X509.html#a8d1062abadc25a988fb1aa01bfea74fe">File_X509\$publicKey</a></div><div class="ttdeci">$publicKey</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00226">X509.php:226</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="install_8php_source.html#l00039">$VIEW_PATH</a>, and <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_afc841edb470c7b8c50e78daaf634228a_cgraph.png" border="0" usemap="#aclassFile__X509_afc841edb470c7b8c50e78daaf634228a_cgraph" alt=""/></div>
<map name="aclassFile__X509_afc841edb470c7b8c50e78daaf634228a_cgraph" id="aclassFile__X509_afc841edb470c7b8c50e78daaf634228a_cgraph">
<area shape="rect" title="Gets the public key." alt="" coords="5,5,112,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="160,5,247,31"/>
</map>
</div>

</div>
</div>
<a id="aa1bb98de862919e64965b293697f3b8d" name="aa1bb98de862919e64965b293697f3b8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1bb98de862919e64965b293697f3b8d">&#9670;&#160;</a></span>getRevoked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getRevoked </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$serial</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a revoked certificate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$serial</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l05014">5014</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5015</span>    {</div>
<div class="line"><span class="lineno"> 5016</span>        <span class="keywordflow">if</span> (is_array($rclist = $this-&gt;_subArray($this-&gt;currentCert, <span class="stringliteral">&#39;tbsCertList/revokedCertificates&#39;</span>))) {</div>
<div class="line"><span class="lineno"> 5017</span>            <span class="keywordflow">if</span> (($i = $this-&gt;_revokedCertificate($rclist, $serial)) !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 5018</span>                <span class="keywordflow">return</span> $rclist[$i];</div>
<div class="line"><span class="lineno"> 5019</span>            }</div>
<div class="line"><span class="lineno"> 5020</span>        }</div>
<div class="line"><span class="lineno"> 5021</span> </div>
<div class="line"><span class="lineno"> 5022</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 5023</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04933">_revokedCertificate()</a>, and <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_aa1bb98de862919e64965b293697f3b8d_cgraph.png" border="0" usemap="#aclassFile__X509_aa1bb98de862919e64965b293697f3b8d_cgraph" alt=""/></div>
<map name="aclassFile__X509_aa1bb98de862919e64965b293697f3b8d_cgraph" id="aclassFile__X509_aa1bb98de862919e64965b293697f3b8d_cgraph">
<area shape="rect" title="Get a revoked certificate." alt="" coords="5,31,104,56"/>
<area shape="rect" href="classFile__X509.html#a8fd951ac4d21092f644bd6528c171bcb" title="Get the index of a revoked certificate." alt="" coords="152,5,300,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="183,55,269,80"/>
<area shape="rect" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089" title="Helper function to build a time field according to RFC 3280 section." alt="" coords="348,5,439,31"/>
</map>
</div>

</div>
</div>
<a id="a402e41419a2999b330874e39d0dd2a34" name="a402e41419a2999b330874e39d0dd2a34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a402e41419a2999b330874e39d0dd2a34">&#9670;&#160;</a></span>getRevokedCertificateExtension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getRevokedCertificateExtension </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$serial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$crl</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a Revoked Certificate Extension. </p>
<p>Returns the extension if it exists and false if not</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$serial</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$id</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$crl</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l05083">5083</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5084</span>    {</div>
<div class="line"><span class="lineno"> 5085</span>        <span class="keywordflow">if</span> (!isset($crl)) {</div>
<div class="line"><span class="lineno"> 5086</span>            $crl = $this-&gt;currentCert;</div>
<div class="line"><span class="lineno"> 5087</span>        }</div>
<div class="line"><span class="lineno"> 5088</span> </div>
<div class="line"><span class="lineno"> 5089</span>        <span class="keywordflow">if</span> (is_array($rclist = $this-&gt;_subArray($crl, <span class="stringliteral">&#39;tbsCertList/revokedCertificates&#39;</span>))) {</div>
<div class="line"><span class="lineno"> 5090</span>            <span class="keywordflow">if</span> (($i = $this-&gt;_revokedCertificate($rclist, $serial)) !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 5091</span>                <span class="keywordflow">return</span> $this-&gt;_getExtension($id, $crl, <span class="stringliteral">&quot;tbsCertList/revokedCertificates/$i/crlEntryExtensions&quot;</span>);</div>
<div class="line"><span class="lineno"> 5092</span>            }</div>
<div class="line"><span class="lineno"> 5093</span>        }</div>
<div class="line"><span class="lineno"> 5094</span> </div>
<div class="line"><span class="lineno"> 5095</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 5096</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04430">_getExtension()</a>, <a class="el" href="X509_8php_source.html#l04933">_revokedCertificate()</a>, and <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a402e41419a2999b330874e39d0dd2a34_cgraph.png" border="0" usemap="#aclassFile__X509_a402e41419a2999b330874e39d0dd2a34_cgraph" alt=""/></div>
<map name="aclassFile__X509_a402e41419a2999b330874e39d0dd2a34_cgraph" id="aclassFile__X509_a402e41419a2999b330874e39d0dd2a34_cgraph">
<area shape="rect" title="Get a Revoked Certificate Extension." alt="" coords="5,56,236,81"/>
<area shape="rect" href="classFile__X509.html#a51d0ffadbcbf965b23238b89fef03484" title="Get an Extension." alt="" coords="301,5,415,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="628,31,715,56"/>
<area shape="rect" href="classFile__X509.html#a8fd951ac4d21092f644bd6528c171bcb" title="Get the index of a revoked certificate." alt="" coords="284,107,432,132"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="480,5,580,31"/>
<area shape="rect" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089" title="Helper function to build a time field according to RFC 3280 section." alt="" coords="485,107,575,132"/>
</map>
</div>

</div>
</div>
<a id="a2b45d9da1caa86e25f79910036ad8eee" name="a2b45d9da1caa86e25f79910036ad8eee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b45d9da1caa86e25f79910036ad8eee">&#9670;&#160;</a></span>getRevokedCertificateExtensions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getRevokedCertificateExtensions </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$serial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$crl</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a list of all extensions in use for a given revoked certificate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$serial</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$crl</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l05106">5106</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5107</span>    {</div>
<div class="line"><span class="lineno"> 5108</span>        <span class="keywordflow">if</span> (!isset($crl)) {</div>
<div class="line"><span class="lineno"> 5109</span>            $crl = $this-&gt;currentCert;</div>
<div class="line"><span class="lineno"> 5110</span>        }</div>
<div class="line"><span class="lineno"> 5111</span> </div>
<div class="line"><span class="lineno"> 5112</span>        <span class="keywordflow">if</span> (is_array($rclist = $this-&gt;_subArray($crl, <span class="stringliteral">&#39;tbsCertList/revokedCertificates&#39;</span>))) {</div>
<div class="line"><span class="lineno"> 5113</span>            <span class="keywordflow">if</span> (($i = $this-&gt;_revokedCertificate($rclist, $serial)) !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 5114</span>                <span class="keywordflow">return</span> $this-&gt;_getExtensions($crl, <span class="stringliteral">&quot;tbsCertList/revokedCertificates/$i/crlEntryExtensions&quot;</span>);</div>
<div class="line"><span class="lineno"> 5115</span>            }</div>
<div class="line"><span class="lineno"> 5116</span>        }</div>
<div class="line"><span class="lineno"> 5117</span> </div>
<div class="line"><span class="lineno"> 5118</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 5119</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04455">_getExtensions()</a>, <a class="el" href="X509_8php_source.html#l04933">_revokedCertificate()</a>, and <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a2b45d9da1caa86e25f79910036ad8eee_cgraph.png" border="0" usemap="#aclassFile__X509_a2b45d9da1caa86e25f79910036ad8eee_cgraph" alt=""/></div>
<map name="aclassFile__X509_a2b45d9da1caa86e25f79910036ad8eee_cgraph" id="aclassFile__X509_a2b45d9da1caa86e25f79910036ad8eee_cgraph">
<area shape="rect" title="Returns a list of all extensions in use for a given revoked certificate." alt="" coords="5,56,243,81"/>
<area shape="rect" href="classFile__X509.html#a7dfd9393f164e45947bac81e5bc97d7f" title="Returns a list of all extensions in use." alt="" coords="304,5,425,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="635,31,721,56"/>
<area shape="rect" href="classFile__X509.html#a8fd951ac4d21092f644bd6528c171bcb" title="Get the index of a revoked certificate." alt="" coords="291,107,439,132"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="487,5,587,31"/>
<area shape="rect" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089" title="Helper function to build a time field according to RFC 3280 section." alt="" coords="491,107,582,132"/>
</map>
</div>

</div>
</div>
<a id="ae5fb776b269eef60c472521c6b4dc219" name="ae5fb776b269eef60c472521c6b4dc219"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5fb776b269eef60c472521c6b4dc219">&#9670;&#160;</a></span>getSubjectDN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getSubjectDN </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$format</em> = <code><a class="el" href="X509_8php.html#a03ccdbecf418c2c8f31dff69c7192b6e">FILE_X509_DN_ARRAY</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the Distinguished Name for a certificate/csr subject Alias of getDN() </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$format</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03057">3057</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3058</span>    {</div>
<div class="line"><span class="lineno"> 3059</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 3060</span>            <span class="keywordflow">case</span> !empty($this-&gt;dn):</div>
<div class="line"><span class="lineno"> 3061</span>                return $this-&gt;getDN($format);</div>
<div class="line"><span class="lineno"> 3062</span>            <span class="keywordflow">case</span> !isset($this-&gt;currentCert) || !is_array($this-&gt;currentCert):</div>
<div class="line"><span class="lineno"> 3063</span>                break;</div>
<div class="line"><span class="lineno"> 3064</span>            <span class="keywordflow">case</span> isset($this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>]):</div>
<div class="line"><span class="lineno"> 3065</span>                return $this-&gt;getDN($format, $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>]);</div>
<div class="line"><span class="lineno"> 3066</span>            <span class="keywordflow">case</span> isset($this-&gt;currentCert[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>]):</div>
<div class="line"><span class="lineno"> 3067</span>                return $this-&gt;getDN($format, $this-&gt;currentCert[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>]);</div>
<div class="line"><span class="lineno"> 3068</span>        }</div>
<div class="line"><span class="lineno"> 3069</span> </div>
<div class="line"><span class="lineno"> 3070</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3071</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l02882">getDN()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ae5fb776b269eef60c472521c6b4dc219_cgraph.png" border="0" usemap="#aclassFile__X509_ae5fb776b269eef60c472521c6b4dc219_cgraph" alt=""/></div>
<map name="aclassFile__X509_ae5fb776b269eef60c472521c6b4dc219_cgraph" id="aclassFile__X509_ae5fb776b269eef60c472521c6b4dc219_cgraph">
<area shape="rect" title="Get the Distinguished Name for a certificate/csr subject Alias of getDN()" alt="" coords="5,31,116,56"/>
<area shape="rect" href="classFile__X509.html#a97392a261d56bd64002da7d1e76e8195" title="Get the Distinguished Name for a certificates subject." alt="" coords="164,31,227,56"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="275,31,383,56"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="431,5,537,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="441,55,527,80"/>
</map>
</div>

</div>
</div>
<a id="a7ef1db256262071ba886eb5335084ecf" name="a7ef1db256262071ba886eb5335084ecf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ef1db256262071ba886eb5335084ecf">&#9670;&#160;</a></span>getSubjectDNProp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getSubjectDNProp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$propName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$withType</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get an individual Distinguished Name property for a certificate/csr subject. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$propName</td><td></td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$withType</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03103">3103</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3104</span>    {</div>
<div class="line"><span class="lineno"> 3105</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 3106</span>            <span class="keywordflow">case</span> !empty($this-&gt;dn):</div>
<div class="line"><span class="lineno"> 3107</span>                return $this-&gt;getDNProp($propName, null, $withType);</div>
<div class="line"><span class="lineno"> 3108</span>            <span class="keywordflow">case</span> !isset($this-&gt;currentCert) || !is_array($this-&gt;currentCert):</div>
<div class="line"><span class="lineno"> 3109</span>                break;</div>
<div class="line"><span class="lineno"> 3110</span>            <span class="keywordflow">case</span> isset($this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>]):</div>
<div class="line"><span class="lineno"> 3111</span>                return $this-&gt;getDNProp($propName, $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>], $withType);</div>
<div class="line"><span class="lineno"> 3112</span>            <span class="keywordflow">case</span> isset($this-&gt;currentCert[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>]):</div>
<div class="line"><span class="lineno"> 3113</span>                return $this-&gt;getDNProp($propName, $this-&gt;currentCert[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>], $withType);</div>
<div class="line"><span class="lineno"> 3114</span>        }</div>
<div class="line"><span class="lineno"> 3115</span> </div>
<div class="line"><span class="lineno"> 3116</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3117</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l02776">getDNProp()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a7ef1db256262071ba886eb5335084ecf_cgraph.png" border="0" usemap="#aclassFile__X509_a7ef1db256262071ba886eb5335084ecf_cgraph" alt=""/></div>
<map name="aclassFile__X509_a7ef1db256262071ba886eb5335084ecf_cgraph" id="aclassFile__X509_a7ef1db256262071ba886eb5335084ecf_cgraph">
<area shape="rect" title="Get an individual Distinguished Name property for a certificate/csr subject." alt="" coords="5,55,145,80"/>
<area shape="rect" href="classFile__X509.html#aa5e331e0ded7b3d7a76452ba6ff70194" title="Get Distinguished Name properties." alt="" coords="193,55,285,80"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="517,5,624,31"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="347,55,455,80"/>
<area shape="rect" href="classFile__X509.html#ad4e0267f8e236f9707325bce89ce2b0a" title="&quot;Normalizes&quot; a Distinguished Name property" alt="" coords="333,104,469,129"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="527,55,614,80"/>
</map>
</div>

</div>
</div>
<a id="aa81e0f1f5f3b4d42074cb6cdc69f6434" name="aa81e0f1f5f3b4d42074cb6cdc69f6434"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa81e0f1f5f3b4d42074cb6cdc69f6434">&#9670;&#160;</a></span>listRevoked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">listRevoked </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$crl</em> = <code>null</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>List revoked certificates. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$crl</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l05032">5032</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5033</span>    {</div>
<div class="line"><span class="lineno"> 5034</span>        <span class="keywordflow">if</span> (!isset($crl)) {</div>
<div class="line"><span class="lineno"> 5035</span>            $crl = $this-&gt;currentCert;</div>
<div class="line"><span class="lineno"> 5036</span>        }</div>
<div class="line"><span class="lineno"> 5037</span> </div>
<div class="line"><span class="lineno"> 5038</span>        <span class="keywordflow">if</span> (!isset($crl[<span class="stringliteral">&#39;tbsCertList&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 5039</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 5040</span>        }</div>
<div class="line"><span class="lineno"> 5041</span> </div>
<div class="line"><span class="lineno"> 5042</span>        $result = array();</div>
<div class="line"><span class="lineno"> 5043</span> </div>
<div class="line"><span class="lineno"> 5044</span>        <span class="keywordflow">if</span> (is_array($rclist = $this-&gt;<a class="code hl_function" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471">_subArray</a>($crl, <span class="stringliteral">&#39;tbsCertList/revokedCertificates&#39;</span>))) {</div>
<div class="line"><span class="lineno"> 5045</span>            <span class="keywordflow">foreach</span> ($rclist as $rc) {</div>
<div class="line"><span class="lineno"> 5046</span>                $result[] = $rc[<span class="stringliteral">&#39;userCertificate&#39;</span>]-&gt;toString();</div>
<div class="line"><span class="lineno"> 5047</span>            }</div>
<div class="line"><span class="lineno"> 5048</span>        }</div>
<div class="line"><span class="lineno"> 5049</span> </div>
<div class="line"><span class="lineno"> 5050</span>        <span class="keywordflow">return</span> $result;</div>
<div class="line"><span class="lineno"> 5051</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_aa81e0f1f5f3b4d42074cb6cdc69f6434_cgraph.png" border="0" usemap="#aclassFile__X509_aa81e0f1f5f3b4d42074cb6cdc69f6434_cgraph" alt=""/></div>
<map name="aclassFile__X509_aa81e0f1f5f3b4d42074cb6cdc69f6434_cgraph" id="aclassFile__X509_aa81e0f1f5f3b4d42074cb6cdc69f6434_cgraph">
<area shape="rect" title="List revoked certificates." alt="" coords="5,5,104,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="152,5,239,31"/>
</map>
</div>

</div>
</div>
<a id="a89783012156bb16439adcba84bca93d8" name="a89783012156bb16439adcba84bca93d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89783012156bb16439adcba84bca93d8">&#9670;&#160;</a></span>loadCA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">loadCA </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$cert</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load an X.509 certificate as a certificate authority. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$cert</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02019">2019</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2020</span>    {</div>
<div class="line"><span class="lineno"> 2021</span>        $olddn = $this-&gt;dn;</div>
<div class="line"><span class="lineno"> 2022</span>        $oldcert = $this-&gt;currentCert;</div>
<div class="line"><span class="lineno"> 2023</span>        $oldsigsubj = $this-&gt;signatureSubject;</div>
<div class="line"><span class="lineno"> 2024</span>        $oldkeyid = $this-&gt;currentKeyIdentifier;</div>
<div class="line"><span class="lineno"> 2025</span> </div>
<div class="line"><span class="lineno"> 2026</span>        $cert = $this-&gt;loadX509($cert);</div>
<div class="line"><span class="lineno"> 2027</span>        <span class="keywordflow">if</span> (!$cert) {</div>
<div class="line"><span class="lineno"> 2028</span>            $this-&gt;dn = $olddn;</div>
<div class="line"><span class="lineno"> 2029</span>            $this-&gt;currentCert = $oldcert;</div>
<div class="line"><span class="lineno"> 2030</span>            $this-&gt;signatureSubject = $oldsigsubj;</div>
<div class="line"><span class="lineno"> 2031</span>            $this-&gt;currentKeyIdentifier = $oldkeyid;</div>
<div class="line"><span class="lineno"> 2032</span> </div>
<div class="line"><span class="lineno"> 2033</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2034</span>        }</div>
<div class="line"><span class="lineno"> 2035</span> </div>
<div class="line"><span class="lineno"> 2036</span>        <span class="comment">/* From RFC5280 &quot;PKIX Certificate and CRL Profile&quot;:</span></div>
<div class="line"><span class="lineno"> 2037</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 2038</span><span class="comment">           If the keyUsage extension is present, then the subject public key</span></div>
<div class="line"><span class="lineno"> 2039</span><span class="comment">           MUST NOT be used to verify signatures on certificates or CRLs unless</span></div>
<div class="line"><span class="lineno"> 2040</span><span class="comment">           the corresponding keyCertSign or cRLSign bit is set. */</span></div>
<div class="line"><span class="lineno"> 2041</span>        <span class="comment">//$keyUsage = $this-&gt;getExtension(&#39;id-ce-keyUsage&#39;);</span></div>
<div class="line"><span class="lineno"> 2042</span>        <span class="comment">//if ($keyUsage &amp;&amp; !in_array(&#39;keyCertSign&#39;, $keyUsage)) {</span></div>
<div class="line"><span class="lineno"> 2043</span>        <span class="comment">//    return false;</span></div>
<div class="line"><span class="lineno"> 2044</span>        <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 2045</span> </div>
<div class="line"><span class="lineno"> 2046</span>        <span class="comment">/* From RFC5280 &quot;PKIX Certificate and CRL Profile&quot;:</span></div>
<div class="line"><span class="lineno"> 2047</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 2048</span><span class="comment">           The cA boolean indicates whether the certified public key may be used</span></div>
<div class="line"><span class="lineno"> 2049</span><span class="comment">           to verify certificate signatures.  If the cA boolean is not asserted,</span></div>
<div class="line"><span class="lineno"> 2050</span><span class="comment">           then the keyCertSign bit in the key usage extension MUST NOT be</span></div>
<div class="line"><span class="lineno"> 2051</span><span class="comment">           asserted.  If the basic constraints extension is not present in a</span></div>
<div class="line"><span class="lineno"> 2052</span><span class="comment">           version 3 certificate, or the extension is present but the cA boolean</span></div>
<div class="line"><span class="lineno"> 2053</span><span class="comment">           is not asserted, then the certified public key MUST NOT be used to</span></div>
<div class="line"><span class="lineno"> 2054</span><span class="comment">           verify certificate signatures. */</span></div>
<div class="line"><span class="lineno"> 2055</span>        <span class="comment">//$basicConstraints = $this-&gt;getExtension(&#39;id-ce-basicConstraints&#39;);</span></div>
<div class="line"><span class="lineno"> 2056</span>        <span class="comment">//if (!$basicConstraints || !$basicConstraints[&#39;cA&#39;]) {</span></div>
<div class="line"><span class="lineno"> 2057</span>        <span class="comment">//    return false;</span></div>
<div class="line"><span class="lineno"> 2058</span>        <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 2059</span> </div>
<div class="line"><span class="lineno"> 2060</span>        $this-&gt;CAs[] = $cert;</div>
<div class="line"><span class="lineno"> 2061</span> </div>
<div class="line"><span class="lineno"> 2062</span>        $this-&gt;dn = $olddn;</div>
<div class="line"><span class="lineno"> 2063</span>        $this-&gt;currentCert = $oldcert;</div>
<div class="line"><span class="lineno"> 2064</span>        $this-&gt;signatureSubject = $oldsigsubj;</div>
<div class="line"><span class="lineno"> 2065</span> </div>
<div class="line"><span class="lineno"> 2066</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2067</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l01497">loadX509()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a89783012156bb16439adcba84bca93d8_cgraph.png" border="0" usemap="#aclassFile__X509_a89783012156bb16439adcba84bca93d8_cgraph" alt=""/></div>
<map name="aclassFile__X509_a89783012156bb16439adcba84bca93d8_cgraph" id="aclassFile__X509_a89783012156bb16439adcba84bca93d8_cgraph">
<area shape="rect" title="Load an X.509 certificate as a certificate authority." alt="" coords="5,129,73,155"/>
<area shape="rect" href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376" title="Load X.509 certificate." alt="" coords="121,129,204,155"/>
<area shape="rect" href="classFile__X509.html#a009e0a2396931d62c87d27f4e2372024" title="Extract raw BER from Base64 encoding." alt="" coords="272,5,373,31"/>
<area shape="rect" href="classFile__X509.html#ad60bc52a972cab9df3fc002a25de16dc" title="Check for validity of subarray." alt="" coords="257,55,388,80"/>
<area shape="rect" href="classFile__X509.html#a016c0c81b4115631a081d91036c8839f" title="Map DN values from ANY type to DN&#45;specific internal format." alt="" coords="274,104,371,129"/>
<area shape="rect" href="classFile__X509.html#a0c34c28604781bdc296e7ade6951a734" title="Map extension values from octet string to extension&#45;specific internal format." alt="" coords="252,153,393,179"/>
<area shape="rect" href="classFile__X509.html#a195dac5d2b72ef86fe28250ea43343b8" title="Reformat public keys." alt="" coords="267,203,378,228"/>
<area shape="rect" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb" title="Get a certificate, CSR or CRL Extension." alt="" coords="269,252,376,277"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="467,153,574,179"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="796,177,883,203"/>
<area shape="rect" href="classFile__X509.html#a50d402cfb4c93492899c7a222ddb6803" title="Get a reference to a subarray." alt="" coords="441,203,600,228"/>
<area shape="rect" href="classFile__X509.html#a51d0ffadbcbf965b23238b89fef03484" title="Get an Extension." alt="" coords="463,252,578,277"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="648,203,748,228"/>
</map>
</div>

</div>
</div>
<a id="a0379465670a36ea3a1d2e9a34ea21405" name="a0379465670a36ea3a1d2e9a34ea21405"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0379465670a36ea3a1d2e9a34ea21405">&#9670;&#160;</a></span>loadCRL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">loadCRL </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$crl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mode</em> = <code><a class="el" href="X509_8php.html#a9159740da3aaa292ada5509eed1f0a5c">FILE_X509_FORMAT_AUTO_DETECT</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a Certificate Revocation List. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$crl</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$mode</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03521">3521</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3522</span>    {</div>
<div class="line"><span class="lineno"> 3523</span>        <span class="keywordflow">if</span> (is_array($crl) &amp;&amp; isset($crl[<span class="stringliteral">&#39;tbsCertList&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 3524</span>            $this-&gt;currentCert = $crl;</div>
<div class="line"><span class="lineno"> 3525</span>            unset($this-&gt;signatureSubject);</div>
<div class="line"><span class="lineno"> 3526</span>            <span class="keywordflow">return</span> $crl;</div>
<div class="line"><span class="lineno"> 3527</span>        }</div>
<div class="line"><span class="lineno"> 3528</span> </div>
<div class="line"><span class="lineno"> 3529</span>        $asn1 = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__ASN1.html">File_ASN1</a>();</div>
<div class="line"><span class="lineno"> 3530</span> </div>
<div class="line"><span class="lineno"> 3531</span>        <span class="keywordflow">if</span> ($mode != <a class="code hl_variable" href="X509_8php.html#a2418178d5c6bdae785f3e9f3583ba354">FILE_X509_FORMAT_DER</a>) {</div>
<div class="line"><span class="lineno"> 3532</span>            $newcrl = $this-&gt;_extractBER($crl);</div>
<div class="line"><span class="lineno"> 3533</span>            <span class="keywordflow">if</span> ($mode == <a class="code hl_variable" href="X509_8php.html#a036042d3a607d01afacc62e969dae3b7">FILE_X509_FORMAT_PEM</a> &amp;&amp; $crl == $newcrl) {</div>
<div class="line"><span class="lineno"> 3534</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3535</span>            }</div>
<div class="line"><span class="lineno"> 3536</span>            $crl = $newcrl;</div>
<div class="line"><span class="lineno"> 3537</span>        }</div>
<div class="line"><span class="lineno"> 3538</span>        $orig = $crl;</div>
<div class="line"><span class="lineno"> 3539</span> </div>
<div class="line"><span class="lineno"> 3540</span>        <span class="keywordflow">if</span> ($crl === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3541</span>            $this-&gt;currentCert = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3542</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3543</span>        }</div>
<div class="line"><span class="lineno"> 3544</span> </div>
<div class="line"><span class="lineno"> 3545</span>        $asn1-&gt;loadOIDs($this-&gt;oids);</div>
<div class="line"><span class="lineno"> 3546</span>        $decoded = $asn1-&gt;decodeBER($crl);</div>
<div class="line"><span class="lineno"> 3547</span> </div>
<div class="line"><span class="lineno"> 3548</span>        <span class="keywordflow">if</span> (empty($decoded)) {</div>
<div class="line"><span class="lineno"> 3549</span>            $this-&gt;currentCert = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3550</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3551</span>        }</div>
<div class="line"><span class="lineno"> 3552</span> </div>
<div class="line"><span class="lineno"> 3553</span>        $crl = $asn1-&gt;asn1map($decoded[0], $this-&gt;CertificateList);</div>
<div class="line"><span class="lineno"> 3554</span>        <span class="keywordflow">if</span> (!isset($crl) || $crl === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3555</span>            $this-&gt;currentCert = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3556</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3557</span>        }</div>
<div class="line"><span class="lineno"> 3558</span> </div>
<div class="line"><span class="lineno"> 3559</span>        $this-&gt;signatureSubject = substr($orig, $decoded[0][<span class="stringliteral">&#39;content&#39;</span>][0][<span class="stringliteral">&#39;start&#39;</span>], $decoded[0][<span class="stringliteral">&#39;content&#39;</span>][0][<span class="stringliteral">&#39;length&#39;</span>]);</div>
<div class="line"><span class="lineno"> 3560</span> </div>
<div class="line"><span class="lineno"> 3561</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#a016c0c81b4115631a081d91036c8839f">_mapInDNs</a>($crl, <span class="stringliteral">&#39;tbsCertList/issuer/rdnSequence&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 3562</span>        <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classFile__X509.html#ad60bc52a972cab9df3fc002a25de16dc">_isSubArrayValid</a>($crl, <span class="stringliteral">&#39;tbsCertList/crlExtensions&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 3563</span>            $this-&gt;<a class="code hl_function" href="classFile__X509.html#a0c34c28604781bdc296e7ade6951a734">_mapInExtensions</a>($crl, <span class="stringliteral">&#39;tbsCertList/crlExtensions&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 3564</span>        }</div>
<div class="line"><span class="lineno"> 3565</span>        <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classFile__X509.html#ad60bc52a972cab9df3fc002a25de16dc">_isSubArrayValid</a>($crl, <span class="stringliteral">&#39;tbsCertList/revokedCertificates&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 3566</span>            $rclist_ref = &amp;$this-&gt;<a class="code hl_function" href="classFile__X509.html#a50d402cfb4c93492899c7a222ddb6803">_subArrayUnchecked</a>($crl, <span class="stringliteral">&#39;tbsCertList/revokedCertificates&#39;</span>);</div>
<div class="line"><span class="lineno"> 3567</span>            <span class="keywordflow">if</span> ($rclist_ref) {</div>
<div class="line"><span class="lineno"> 3568</span>                $rclist = $crl[<span class="stringliteral">&#39;tbsCertList&#39;</span>][<span class="stringliteral">&#39;revokedCertificates&#39;</span>];</div>
<div class="line"><span class="lineno"> 3569</span>                <span class="keywordflow">foreach</span> ($rclist as $i =&gt; $extension) {</div>
<div class="line"><span class="lineno"> 3570</span>                    <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classFile__X509.html#ad60bc52a972cab9df3fc002a25de16dc">_isSubArrayValid</a>($rclist, <span class="stringliteral">&quot;$i/crlEntryExtensions&quot;</span>, $asn1)) {</div>
<div class="line"><span class="lineno"> 3571</span>                        $this-&gt;<a class="code hl_function" href="classFile__X509.html#a0c34c28604781bdc296e7ade6951a734">_mapInExtensions</a>($rclist_ref, <span class="stringliteral">&quot;$i/crlEntryExtensions&quot;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 3572</span>                    }</div>
<div class="line"><span class="lineno"> 3573</span>                }</div>
<div class="line"><span class="lineno"> 3574</span>            }</div>
<div class="line"><span class="lineno"> 3575</span>        }</div>
<div class="line"><span class="lineno"> 3576</span> </div>
<div class="line"><span class="lineno"> 3577</span>        $this-&gt;currentKeyIdentifier = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 3578</span>        $this-&gt;currentCert = $crl;</div>
<div class="line"><span class="lineno"> 3579</span> </div>
<div class="line"><span class="lineno"> 3580</span>        <span class="keywordflow">return</span> $crl;</div>
<div class="line"><span class="lineno"> 3581</span>    }</div>
<div class="ttc" id="aX509_8php_html_a036042d3a607d01afacc62e969dae3b7"><div class="ttname"><a href="X509_8php.html#a036042d3a607d01afacc62e969dae3b7">FILE_X509_FORMAT_PEM</a></div><div class="ttdeci">const FILE_X509_FORMAT_PEM</div><div class="ttdoc">#-</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00102">X509.php:102</a></div></div>
<div class="ttc" id="aX509_8php_html_a2418178d5c6bdae785f3e9f3583ba354"><div class="ttname"><a href="X509_8php.html#a2418178d5c6bdae785f3e9f3583ba354">FILE_X509_FORMAT_DER</a></div><div class="ttdeci">const FILE_X509_FORMAT_DER</div><div class="ttdoc">Save as DER.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00106">X509.php:106</a></div></div>
<div class="ttc" id="aclassFile__X509_html_a016c0c81b4115631a081d91036c8839f"><div class="ttname"><a href="classFile__X509.html#a016c0c81b4115631a081d91036c8839f">File_X509\_mapInDNs</a></div><div class="ttdeci">_mapInDNs(&amp;$root, $path, $asn1)</div><div class="ttdoc">Map DN values from ANY type to DN-specific internal format.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l01851">X509.php:1851</a></div></div>
<div class="ttc" id="aclassFile__X509_html_a0c34c28604781bdc296e7ade6951a734"><div class="ttname"><a href="classFile__X509.html#a0c34c28604781bdc296e7ade6951a734">File_X509\_mapInExtensions</a></div><div class="ttdeci">_mapInExtensions(&amp;$root, $path, $asn1)</div><div class="ttdoc">Map extension values from octet string to extension-specific internal format.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l01648">X509.php:1648</a></div></div>
<div class="ttc" id="aclassFile__X509_html_a50d402cfb4c93492899c7a222ddb6803"><div class="ttname"><a href="classFile__X509.html#a50d402cfb4c93492899c7a222ddb6803">File_X509\_subArrayUnchecked</a></div><div class="ttdeci">&amp; _subArrayUnchecked(&amp;$root, $path, $create=false)</div><div class="ttdoc">Get a reference to a subarray.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l04277">X509.php:4277</a></div></div>
<div class="ttc" id="aclassFile__X509_html_ad60bc52a972cab9df3fc002a25de16dc"><div class="ttname"><a href="classFile__X509.html#ad60bc52a972cab9df3fc002a25de16dc">File_X509\_isSubArrayValid</a></div><div class="ttdeci">_isSubArrayValid($root, $path)</div><div class="ttdoc">Check for validity of subarray.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l04240">X509.php:4240</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l05152">_extractBER()</a>, <a class="el" href="X509_8php_source.html#l04240">_isSubArrayValid()</a>, <a class="el" href="X509_8php_source.html#l01851">_mapInDNs()</a>, <a class="el" href="X509_8php_source.html#l01648">_mapInExtensions()</a>, <a class="el" href="X509_8php_source.html#l04277">_subArrayUnchecked()</a>, <a class="el" href="X509_8php_source.html#l00106">FILE_X509_FORMAT_DER</a>, and <a class="el" href="X509_8php_source.html#l00102">FILE_X509_FORMAT_PEM</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l04004">signCRL()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a0379465670a36ea3a1d2e9a34ea21405_cgraph.png" border="0" usemap="#aclassFile__X509_a0379465670a36ea3a1d2e9a34ea21405_cgraph" alt=""/></div>
<map name="aclassFile__X509_a0379465670a36ea3a1d2e9a34ea21405_cgraph" id="aclassFile__X509_a0379465670a36ea3a1d2e9a34ea21405_cgraph">
<area shape="rect" title="Load a Certificate Revocation List." alt="" coords="5,104,80,129"/>
<area shape="rect" href="classFile__X509.html#a009e0a2396931d62c87d27f4e2372024" title="Extract raw BER from Base64 encoding." alt="" coords="148,5,249,31"/>
<area shape="rect" href="classFile__X509.html#ad60bc52a972cab9df3fc002a25de16dc" title="Check for validity of subarray." alt="" coords="133,55,264,80"/>
<area shape="rect" href="classFile__X509.html#a016c0c81b4115631a081d91036c8839f" title="Map DN values from ANY type to DN&#45;specific internal format." alt="" coords="150,104,247,129"/>
<area shape="rect" href="classFile__X509.html#a0c34c28604781bdc296e7ade6951a734" title="Map extension values from octet string to extension&#45;specific internal format." alt="" coords="128,153,269,179"/>
<area shape="rect" href="classFile__X509.html#a50d402cfb4c93492899c7a222ddb6803" title="Get a reference to a subarray." alt="" coords="317,203,476,228"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="343,153,450,179"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="353,104,440,129"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a0379465670a36ea3a1d2e9a34ea21405_icgraph.png" border="0" usemap="#aclassFile__X509_a0379465670a36ea3a1d2e9a34ea21405_icgraph" alt=""/></div>
<map name="aclassFile__X509_a0379465670a36ea3a1d2e9a34ea21405_icgraph" id="aclassFile__X509_a0379465670a36ea3a1d2e9a34ea21405_icgraph">
<area shape="rect" title="Load a Certificate Revocation List." alt="" coords="128,5,203,31"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="5,5,80,31"/>
</map>
</div>

</div>
</div>
<a id="aa71d96486f43146d0ff5fa6e46167853" name="aa71d96486f43146d0ff5fa6e46167853"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa71d96486f43146d0ff5fa6e46167853">&#9670;&#160;</a></span>loadCSR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">loadCSR </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$csr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mode</em> = <code><a class="el" href="X509_8php.html#a9159740da3aaa292ada5509eed1f0a5c">FILE_X509_FORMAT_AUTO_DETECT</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a Certificate Signing Request. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string&#160;|&#160;array</td><td class="paramname">$csr</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$mode</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03259">3259</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3260</span>    {</div>
<div class="line"><span class="lineno"> 3261</span>        global <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>;</div>
<div class="line"><span class="lineno"> 3262</span> </div>
<div class="line"><span class="lineno"> 3263</span>        <span class="keywordflow">if</span> (is_array($csr) &amp;&amp; isset($csr[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 3264</span>            unset($this-&gt;currentCert);</div>
<div class="line"><span class="lineno"> 3265</span>            unset($this-&gt;currentKeyIdentifier);</div>
<div class="line"><span class="lineno"> 3266</span>            unset($this-&gt;signatureSubject);</div>
<div class="line"><span class="lineno"> 3267</span>            $this-&gt;dn = $csr[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>];</div>
<div class="line"><span class="lineno"> 3268</span>            <span class="keywordflow">if</span> (!isset($this-&gt;dn)) {</div>
<div class="line"><span class="lineno"> 3269</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3270</span>            }</div>
<div class="line"><span class="lineno"> 3271</span> </div>
<div class="line"><span class="lineno"> 3272</span>            $this-&gt;currentCert = $csr;</div>
<div class="line"><span class="lineno"> 3273</span>            <span class="keywordflow">return</span> $csr;</div>
<div class="line"><span class="lineno"> 3274</span>        }</div>
<div class="line"><span class="lineno"> 3275</span> </div>
<div class="line"><span class="lineno"> 3276</span>        <span class="comment">// see http://tools.ietf.org/html/rfc2986</span></div>
<div class="line"><span class="lineno"> 3277</span> </div>
<div class="line"><span class="lineno"> 3278</span>        $asn1 = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__ASN1.html">File_ASN1</a>();</div>
<div class="line"><span class="lineno"> 3279</span> </div>
<div class="line"><span class="lineno"> 3280</span>        <span class="keywordflow">if</span> ($mode != <a class="code hl_variable" href="X509_8php.html#a2418178d5c6bdae785f3e9f3583ba354">FILE_X509_FORMAT_DER</a>) {</div>
<div class="line"><span class="lineno"> 3281</span>            $newcsr = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a009e0a2396931d62c87d27f4e2372024">_extractBER</a>($csr);</div>
<div class="line"><span class="lineno"> 3282</span>            <span class="keywordflow">if</span> ($mode == <a class="code hl_variable" href="X509_8php.html#a036042d3a607d01afacc62e969dae3b7">FILE_X509_FORMAT_PEM</a> &amp;&amp; $csr == $newcsr) {</div>
<div class="line"><span class="lineno"> 3283</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3284</span>            }</div>
<div class="line"><span class="lineno"> 3285</span>            $csr = $newcsr;</div>
<div class="line"><span class="lineno"> 3286</span>        }</div>
<div class="line"><span class="lineno"> 3287</span>        $orig = $csr;</div>
<div class="line"><span class="lineno"> 3288</span> </div>
<div class="line"><span class="lineno"> 3289</span>        <span class="keywordflow">if</span> ($csr === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3290</span>            $this-&gt;currentCert = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3291</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3292</span>        }</div>
<div class="line"><span class="lineno"> 3293</span> </div>
<div class="line"><span class="lineno"> 3294</span>        $asn1-&gt;loadOIDs($this-&gt;oids);</div>
<div class="line"><span class="lineno"> 3295</span>        $decoded = $asn1-&gt;decodeBER($csr);</div>
<div class="line"><span class="lineno"> 3296</span> </div>
<div class="line"><span class="lineno"> 3297</span>        <span class="keywordflow">if</span> (empty($decoded)) {</div>
<div class="line"><span class="lineno"> 3298</span>            $this-&gt;currentCert = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3299</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3300</span>        }</div>
<div class="line"><span class="lineno"> 3301</span> </div>
<div class="line"><span class="lineno"> 3302</span>        $csr = $asn1-&gt;asn1map($decoded[0], $this-&gt;CertificationRequest);</div>
<div class="line"><span class="lineno"> 3303</span>        <span class="keywordflow">if</span> (!isset($csr) || $csr === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3304</span>            $this-&gt;currentCert = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3305</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3306</span>        }</div>
<div class="line"><span class="lineno"> 3307</span> </div>
<div class="line"><span class="lineno"> 3308</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#acab7579764a0d5973b94cd8bf1c64092">_mapInAttributes</a>($csr, <span class="stringliteral">&#39;certificationRequestInfo/attributes&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 3309</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#a016c0c81b4115631a081d91036c8839f">_mapInDNs</a>($csr, <span class="stringliteral">&#39;certificationRequestInfo/subject/rdnSequence&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 3310</span> </div>
<div class="line"><span class="lineno"> 3311</span>        $this-&gt;dn = $csr[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>];</div>
<div class="line"><span class="lineno"> 3312</span> </div>
<div class="line"><span class="lineno"> 3313</span>        $this-&gt;signatureSubject = substr($orig, $decoded[0][<span class="stringliteral">&#39;content&#39;</span>][0][<span class="stringliteral">&#39;start&#39;</span>], $decoded[0][<span class="stringliteral">&#39;content&#39;</span>][0][<span class="stringliteral">&#39;length&#39;</span>]);</div>
<div class="line"><span class="lineno"> 3314</span> </div>
<div class="line"><span class="lineno"> 3315</span>        $algorithm = &amp;$csr[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subjectPKInfo&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>];</div>
<div class="line"><span class="lineno"> 3316</span>        $key = &amp;$csr[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subjectPKInfo&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>];</div>
<div class="line"><span class="lineno"> 3317</span>        $key = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a195dac5d2b72ef86fe28250ea43343b8">_reformatKey</a>($algorithm, $key);</div>
<div class="line"><span class="lineno"> 3318</span> </div>
<div class="line"><span class="lineno"> 3319</span>        <span class="keywordflow">switch</span> ($algorithm) {</div>
<div class="line"><span class="lineno"> 3320</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;rsaEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 3321</span>                <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_RSA&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 3322</span>                    include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/RSA.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 3323</span>                }</div>
<div class="line"><span class="lineno"> 3324</span>                $this-&gt;publicKey = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__RSA.html">Crypt_RSA</a>();</div>
<div class="line"><span class="lineno"> 3325</span>                $this-&gt;publicKey-&gt;loadKey($key);</div>
<div class="line"><span class="lineno"> 3326</span>                $this-&gt;publicKey-&gt;setPublicKey();</div>
<div class="line"><span class="lineno"> 3327</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3328</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3329</span>                $this-&gt;publicKey = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 3330</span>        }</div>
<div class="line"><span class="lineno"> 3331</span> </div>
<div class="line"><span class="lineno"> 3332</span>        $this-&gt;currentKeyIdentifier = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 3333</span>        $this-&gt;currentCert = $csr;</div>
<div class="line"><span class="lineno"> 3334</span> </div>
<div class="line"><span class="lineno"> 3335</span>        <span class="keywordflow">return</span> $csr;</div>
<div class="line"><span class="lineno"> 3336</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_a195dac5d2b72ef86fe28250ea43343b8"><div class="ttname"><a href="classFile__X509.html#a195dac5d2b72ef86fe28250ea43343b8">File_X509\_reformatKey</a></div><div class="ttdeci">_reformatKey($algorithm, $key)</div><div class="ttdoc">Reformat public keys.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l02546">X509.php:2546</a></div></div>
<div class="ttc" id="aclassFile__X509_html_acab7579764a0d5973b94cd8bf1c64092"><div class="ttname"><a href="classFile__X509.html#acab7579764a0d5973b94cd8bf1c64092">File_X509\_mapInAttributes</a></div><div class="ttdeci">_mapInAttributes(&amp;$root, $path, $asn1)</div><div class="ttdoc">Map attribute values from ANY type to attribute-specific internal format.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l01767">X509.php:1767</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="install_8php_source.html#l00039">$VIEW_PATH</a>, <a class="el" href="X509_8php_source.html#l05152">_extractBER()</a>, <a class="el" href="X509_8php_source.html#l01767">_mapInAttributes()</a>, <a class="el" href="X509_8php_source.html#l01851">_mapInDNs()</a>, <a class="el" href="X509_8php_source.html#l02546">_reformatKey()</a>, <a class="el" href="X509_8php_source.html#l00106">FILE_X509_FORMAT_DER</a>, and <a class="el" href="X509_8php_source.html#l00102">FILE_X509_FORMAT_PEM</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l03876">signCSR()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_aa71d96486f43146d0ff5fa6e46167853_cgraph.png" border="0" usemap="#aclassFile__X509_aa71d96486f43146d0ff5fa6e46167853_cgraph" alt=""/></div>
<map name="aclassFile__X509_aa71d96486f43146d0ff5fa6e46167853_cgraph" id="aclassFile__X509_aa71d96486f43146d0ff5fa6e46167853_cgraph">
<area shape="rect" title="Load a Certificate Signing Request." alt="" coords="5,132,81,157"/>
<area shape="rect" href="classFile__X509.html#a009e0a2396931d62c87d27f4e2372024" title="Extract raw BER from Base64 encoding." alt="" coords="146,57,247,83"/>
<area shape="rect" href="classFile__X509.html#acab7579764a0d5973b94cd8bf1c64092" title="Map attribute values from ANY type to attribute&#45;specific internal format." alt="" coords="129,107,264,132"/>
<area shape="rect" href="classFile__X509.html#a016c0c81b4115631a081d91036c8839f" title="Map DN values from ANY type to DN&#45;specific internal format." alt="" coords="148,156,245,181"/>
<area shape="rect" href="classFile__X509.html#a195dac5d2b72ef86fe28250ea43343b8" title="Reformat public keys." alt="" coords="141,205,252,231"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="527,105,634,131"/>
<area shape="rect" href="classFile__X509.html#ad60bc52a972cab9df3fc002a25de16dc" title="Check for validity of subarray." alt="" coords="317,5,448,31"/>
<area shape="rect" href="classFile__X509.html#a0c34c28604781bdc296e7ade6951a734" title="Map extension values from octet string to extension&#45;specific internal format." alt="" coords="312,55,453,80"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="339,156,426,181"/>
<area shape="rect" href="classFile__X509.html#a50d402cfb4c93492899c7a222ddb6803" title="Get a reference to a subarray." alt="" coords="501,55,660,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_aa71d96486f43146d0ff5fa6e46167853_icgraph.png" border="0" usemap="#aclassFile__X509_aa71d96486f43146d0ff5fa6e46167853_icgraph" alt=""/></div>
<map name="aclassFile__X509_aa71d96486f43146d0ff5fa6e46167853_icgraph" id="aclassFile__X509_aa71d96486f43146d0ff5fa6e46167853_icgraph">
<area shape="rect" title="Load a Certificate Signing Request." alt="" coords="128,5,204,31"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="5,5,80,31"/>
</map>
</div>

</div>
</div>
<a id="ae796e46a18066a3b745a279fad143dbb" name="ae796e46a18066a3b745a279fad143dbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae796e46a18066a3b745a279fad143dbb">&#9670;&#160;</a></span>loadSPKAC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">loadSPKAC </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$spkac</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a SPKAC CSR. </p>
<p>SPKAC's are produced by the HTML5 keygen element:</p>
<p><a href="https://developer.mozilla.org/en-US/docs/HTML/Element/keygen">https://developer.mozilla.org/en-US/docs/HTML/Element/keygen</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string&#160;|&#160;array</td><td class="paramname">$spkac</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03401">3401</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3402</span>    {</div>
<div class="line"><span class="lineno"> 3403</span>        global <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>;</div>
<div class="line"><span class="lineno"> 3404</span> </div>
<div class="line"><span class="lineno"> 3405</span>        <span class="keywordflow">if</span> (is_array($spkac) &amp;&amp; isset($spkac[<span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 3406</span>            unset($this-&gt;currentCert);</div>
<div class="line"><span class="lineno"> 3407</span>            unset($this-&gt;currentKeyIdentifier);</div>
<div class="line"><span class="lineno"> 3408</span>            unset($this-&gt;signatureSubject);</div>
<div class="line"><span class="lineno"> 3409</span>            $this-&gt;currentCert = $spkac;</div>
<div class="line"><span class="lineno"> 3410</span>            <span class="keywordflow">return</span> $spkac;</div>
<div class="line"><span class="lineno"> 3411</span>        }</div>
<div class="line"><span class="lineno"> 3412</span> </div>
<div class="line"><span class="lineno"> 3413</span>        <span class="comment">// see http://www.w3.org/html/wg/drafts/html/master/forms.html#signedpublickeyandchallenge</span></div>
<div class="line"><span class="lineno"> 3414</span> </div>
<div class="line"><span class="lineno"> 3415</span>        $asn1 = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__ASN1.html">File_ASN1</a>();</div>
<div class="line"><span class="lineno"> 3416</span> </div>
<div class="line"><span class="lineno"> 3417</span>        <span class="comment">// OpenSSL produces SPKAC&#39;s that are preceded by the string SPKAC=</span></div>
<div class="line"><span class="lineno"> 3418</span>        $temp = preg_replace(<span class="stringliteral">&#39;#(?:SPKAC=)|[ \r\n\\\]#&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $spkac);</div>
<div class="line"><span class="lineno"> 3419</span>        $temp = preg_match(<span class="stringliteral">&#39;#^[a-zA-Z\d/+]*={0,2}$#&#39;</span>, $temp) ? base64_decode($temp) : false;</div>
<div class="line"><span class="lineno"> 3420</span>        <span class="keywordflow">if</span> ($temp != <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3421</span>            $spkac = $temp;</div>
<div class="line"><span class="lineno"> 3422</span>        }</div>
<div class="line"><span class="lineno"> 3423</span>        $orig = $spkac;</div>
<div class="line"><span class="lineno"> 3424</span> </div>
<div class="line"><span class="lineno"> 3425</span>        <span class="keywordflow">if</span> ($spkac === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3426</span>            $this-&gt;currentCert = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3427</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3428</span>        }</div>
<div class="line"><span class="lineno"> 3429</span> </div>
<div class="line"><span class="lineno"> 3430</span>        $asn1-&gt;loadOIDs($this-&gt;oids);</div>
<div class="line"><span class="lineno"> 3431</span>        $decoded = $asn1-&gt;decodeBER($spkac);</div>
<div class="line"><span class="lineno"> 3432</span> </div>
<div class="line"><span class="lineno"> 3433</span>        <span class="keywordflow">if</span> (empty($decoded)) {</div>
<div class="line"><span class="lineno"> 3434</span>            $this-&gt;currentCert = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3435</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3436</span>        }</div>
<div class="line"><span class="lineno"> 3437</span> </div>
<div class="line"><span class="lineno"> 3438</span>        $spkac = $asn1-&gt;asn1map($decoded[0], $this-&gt;SignedPublicKeyAndChallenge);</div>
<div class="line"><span class="lineno"> 3439</span> </div>
<div class="line"><span class="lineno"> 3440</span>        <span class="keywordflow">if</span> (!isset($spkac) || $spkac === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3441</span>            $this-&gt;currentCert = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3442</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3443</span>        }</div>
<div class="line"><span class="lineno"> 3444</span> </div>
<div class="line"><span class="lineno"> 3445</span>        $this-&gt;signatureSubject = substr($orig, $decoded[0][<span class="stringliteral">&#39;content&#39;</span>][0][<span class="stringliteral">&#39;start&#39;</span>], $decoded[0][<span class="stringliteral">&#39;content&#39;</span>][0][<span class="stringliteral">&#39;length&#39;</span>]);</div>
<div class="line"><span class="lineno"> 3446</span> </div>
<div class="line"><span class="lineno"> 3447</span>        $algorithm = &amp;$spkac[<span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span>][<span class="stringliteral">&#39;spki&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>];</div>
<div class="line"><span class="lineno"> 3448</span>        $key = &amp;$spkac[<span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span>][<span class="stringliteral">&#39;spki&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>];</div>
<div class="line"><span class="lineno"> 3449</span>        $key = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a195dac5d2b72ef86fe28250ea43343b8">_reformatKey</a>($algorithm, $key);</div>
<div class="line"><span class="lineno"> 3450</span> </div>
<div class="line"><span class="lineno"> 3451</span>        <span class="keywordflow">switch</span> ($algorithm) {</div>
<div class="line"><span class="lineno"> 3452</span>            <span class="keywordflow">case</span> <span class="stringliteral">&#39;rsaEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 3453</span>                <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_RSA&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 3454</span>                    include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/RSA.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 3455</span>                }</div>
<div class="line"><span class="lineno"> 3456</span>                $this-&gt;publicKey = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__RSA.html">Crypt_RSA</a>();</div>
<div class="line"><span class="lineno"> 3457</span>                $this-&gt;publicKey-&gt;loadKey($key);</div>
<div class="line"><span class="lineno"> 3458</span>                $this-&gt;publicKey-&gt;setPublicKey();</div>
<div class="line"><span class="lineno"> 3459</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3460</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3461</span>                $this-&gt;publicKey = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 3462</span>        }</div>
<div class="line"><span class="lineno"> 3463</span> </div>
<div class="line"><span class="lineno"> 3464</span>        $this-&gt;currentKeyIdentifier = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 3465</span>        $this-&gt;currentCert = $spkac;</div>
<div class="line"><span class="lineno"> 3466</span> </div>
<div class="line"><span class="lineno"> 3467</span>        <span class="keywordflow">return</span> $spkac;</div>
<div class="line"><span class="lineno"> 3468</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="install_8php_source.html#l00039">$VIEW_PATH</a>, and <a class="el" href="X509_8php_source.html#l02546">_reformatKey()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l03934">signSPKAC()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ae796e46a18066a3b745a279fad143dbb_cgraph.png" border="0" usemap="#aclassFile__X509_ae796e46a18066a3b745a279fad143dbb_cgraph" alt=""/></div>
<map name="aclassFile__X509_ae796e46a18066a3b745a279fad143dbb_cgraph" id="aclassFile__X509_ae796e46a18066a3b745a279fad143dbb_cgraph">
<area shape="rect" title="Load a SPKAC CSR." alt="" coords="5,5,99,31"/>
<area shape="rect" href="classFile__X509.html#a195dac5d2b72ef86fe28250ea43343b8" title="Reformat public keys." alt="" coords="147,5,257,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ae796e46a18066a3b745a279fad143dbb_icgraph.png" border="0" usemap="#aclassFile__X509_ae796e46a18066a3b745a279fad143dbb_icgraph" alt=""/></div>
<map name="aclassFile__X509_ae796e46a18066a3b745a279fad143dbb_icgraph" id="aclassFile__X509_ae796e46a18066a3b745a279fad143dbb_icgraph">
<area shape="rect" title="Load a SPKAC CSR." alt="" coords="145,5,239,31"/>
<area shape="rect" href="classFile__X509.html#a7579e46dcabbf3bff17d8e31f1b2cb25" title="Sign a SPKAC." alt="" coords="5,5,97,31"/>
</map>
</div>

</div>
</div>
<a id="a6b1d3038d8f6448b8f7d25f324833376" name="a6b1d3038d8f6448b8f7d25f324833376"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b1d3038d8f6448b8f7d25f324833376">&#9670;&#160;</a></span>loadX509()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">loadX509 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mode</em> = <code><a class="el" href="X509_8php.html#a9159740da3aaa292ada5509eed1f0a5c">FILE_X509_FORMAT_AUTO_DETECT</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load X.509 certificate. </p>
<p>Returns an associative array describing the X.509 cert or a false if the cert failed to load</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$cert</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$mode</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l01497">1497</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1498</span>    {</div>
<div class="line"><span class="lineno"> 1499</span>        <span class="keywordflow">if</span> (is_array($cert) &amp;&amp; isset($cert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1500</span>            unset($this-&gt;currentCert);</div>
<div class="line"><span class="lineno"> 1501</span>            unset($this-&gt;currentKeyIdentifier);</div>
<div class="line"><span class="lineno"> 1502</span>            $this-&gt;dn = $cert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>];</div>
<div class="line"><span class="lineno"> 1503</span>            <span class="keywordflow">if</span> (!isset($this-&gt;dn)) {</div>
<div class="line"><span class="lineno"> 1504</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1505</span>            }</div>
<div class="line"><span class="lineno"> 1506</span>            $this-&gt;currentCert = $cert;</div>
<div class="line"><span class="lineno"> 1507</span> </div>
<div class="line"><span class="lineno"> 1508</span>            $currentKeyIdentifier = $this-&gt;getExtension(<span class="stringliteral">&#39;id-ce-subjectKeyIdentifier&#39;</span>);</div>
<div class="line"><span class="lineno"> 1509</span>            $this-&gt;currentKeyIdentifier = is_string($currentKeyIdentifier) ? $currentKeyIdentifier : <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1510</span> </div>
<div class="line"><span class="lineno"> 1511</span>            unset($this-&gt;signatureSubject);</div>
<div class="line"><span class="lineno"> 1512</span> </div>
<div class="line"><span class="lineno"> 1513</span>            <span class="keywordflow">return</span> $cert;</div>
<div class="line"><span class="lineno"> 1514</span>        }</div>
<div class="line"><span class="lineno"> 1515</span> </div>
<div class="line"><span class="lineno"> 1516</span>        $asn1 = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__ASN1.html">File_ASN1</a>();</div>
<div class="line"><span class="lineno"> 1517</span> </div>
<div class="line"><span class="lineno"> 1518</span>        <span class="keywordflow">if</span> ($mode != <a class="code hl_variable" href="X509_8php.html#a2418178d5c6bdae785f3e9f3583ba354">FILE_X509_FORMAT_DER</a>) {</div>
<div class="line"><span class="lineno"> 1519</span>            $newcert = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a009e0a2396931d62c87d27f4e2372024">_extractBER</a>($cert);</div>
<div class="line"><span class="lineno"> 1520</span>            <span class="keywordflow">if</span> ($mode == <a class="code hl_variable" href="X509_8php.html#a036042d3a607d01afacc62e969dae3b7">FILE_X509_FORMAT_PEM</a> &amp;&amp; $cert == $newcert) {</div>
<div class="line"><span class="lineno"> 1521</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1522</span>            }</div>
<div class="line"><span class="lineno"> 1523</span>            $cert = $newcert;</div>
<div class="line"><span class="lineno"> 1524</span>        }</div>
<div class="line"><span class="lineno"> 1525</span> </div>
<div class="line"><span class="lineno"> 1526</span>        <span class="keywordflow">if</span> ($cert === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1527</span>            $this-&gt;currentCert = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1528</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1529</span>        }</div>
<div class="line"><span class="lineno"> 1530</span> </div>
<div class="line"><span class="lineno"> 1531</span>        $asn1-&gt;loadOIDs($this-&gt;oids);</div>
<div class="line"><span class="lineno"> 1532</span>        $decoded = $asn1-&gt;decodeBER($cert);</div>
<div class="line"><span class="lineno"> 1533</span> </div>
<div class="line"><span class="lineno"> 1534</span>        <span class="keywordflow">if</span> (!empty($decoded)) {</div>
<div class="line"><span class="lineno"> 1535</span>            $x509 = $asn1-&gt;asn1map($decoded[0], $this-&gt;Certificate);</div>
<div class="line"><span class="lineno"> 1536</span>        }</div>
<div class="line"><span class="lineno"> 1537</span>        <span class="keywordflow">if</span> (!isset($x509) || $x509 === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1538</span>            $this-&gt;currentCert = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1539</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1540</span>        }</div>
<div class="line"><span class="lineno"> 1541</span> </div>
<div class="line"><span class="lineno"> 1542</span>        $this-&gt;signatureSubject = substr($cert, $decoded[0][<span class="stringliteral">&#39;content&#39;</span>][0][<span class="stringliteral">&#39;start&#39;</span>], $decoded[0][<span class="stringliteral">&#39;content&#39;</span>][0][<span class="stringliteral">&#39;length&#39;</span>]);</div>
<div class="line"><span class="lineno"> 1543</span> </div>
<div class="line"><span class="lineno"> 1544</span>        <span class="keywordflow">if</span> ($this-&gt;<a class="code hl_function" href="classFile__X509.html#ad60bc52a972cab9df3fc002a25de16dc">_isSubArrayValid</a>($x509, <span class="stringliteral">&#39;tbsCertificate/extensions&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 1545</span>            $this-&gt;<a class="code hl_function" href="classFile__X509.html#a0c34c28604781bdc296e7ade6951a734">_mapInExtensions</a>($x509, <span class="stringliteral">&#39;tbsCertificate/extensions&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 1546</span>        }</div>
<div class="line"><span class="lineno"> 1547</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#a016c0c81b4115631a081d91036c8839f">_mapInDNs</a>($x509, <span class="stringliteral">&#39;tbsCertificate/issuer/rdnSequence&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 1548</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#a016c0c81b4115631a081d91036c8839f">_mapInDNs</a>($x509, <span class="stringliteral">&#39;tbsCertificate/subject/rdnSequence&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 1549</span> </div>
<div class="line"><span class="lineno"> 1550</span>        $key = &amp;$x509[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>];</div>
<div class="line"><span class="lineno"> 1551</span>        $key = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a195dac5d2b72ef86fe28250ea43343b8">_reformatKey</a>($x509[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>], $key);</div>
<div class="line"><span class="lineno"> 1552</span> </div>
<div class="line"><span class="lineno"> 1553</span>        $this-&gt;currentCert = $x509;</div>
<div class="line"><span class="lineno"> 1554</span>        $this-&gt;dn = $x509[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>];</div>
<div class="line"><span class="lineno"> 1555</span> </div>
<div class="line"><span class="lineno"> 1556</span>        <a class="code hl_variable" href="classFile__X509.html#afe105562ae62a8d6ed648ead14d2677c">$currentKeyIdentifier</a> = $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">getExtension</a>(<span class="stringliteral">&#39;id-ce-subjectKeyIdentifier&#39;</span>);</div>
<div class="line"><span class="lineno"> 1557</span>        $this-&gt;currentKeyIdentifier = is_string($currentKeyIdentifier) ? <a class="code hl_variable" href="classFile__X509.html#afe105562ae62a8d6ed648ead14d2677c">$currentKeyIdentifier</a> : <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1558</span> </div>
<div class="line"><span class="lineno"> 1559</span>        <span class="keywordflow">return</span> $x509;</div>
<div class="line"><span class="lineno"> 1560</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_afe105562ae62a8d6ed648ead14d2677c"><div class="ttname"><a href="classFile__X509.html#afe105562ae62a8d6ed648ead14d2677c">File_X509\$currentKeyIdentifier</a></div><div class="ttdeci">$currentKeyIdentifier</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00305">X509.php:305</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l05152">_extractBER()</a>, <a class="el" href="X509_8php_source.html#l04240">_isSubArrayValid()</a>, <a class="el" href="X509_8php_source.html#l01851">_mapInDNs()</a>, <a class="el" href="X509_8php_source.html#l01648">_mapInExtensions()</a>, <a class="el" href="X509_8php_source.html#l02546">_reformatKey()</a>, <a class="el" href="X509_8php_source.html#l00106">FILE_X509_FORMAT_DER</a>, <a class="el" href="X509_8php_source.html#l00102">FILE_X509_FORMAT_PEM</a>, and <a class="el" href="X509_8php_source.html#l04527">getExtension()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l02019">loadCA()</a>, and <a class="el" href="X509_8php_source.html#l03684">sign()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a6b1d3038d8f6448b8f7d25f324833376_cgraph.png" border="0" usemap="#aclassFile__X509_a6b1d3038d8f6448b8f7d25f324833376_cgraph" alt=""/></div>
<map name="aclassFile__X509_a6b1d3038d8f6448b8f7d25f324833376_cgraph" id="aclassFile__X509_a6b1d3038d8f6448b8f7d25f324833376_cgraph">
<area shape="rect" title="Load X.509 certificate." alt="" coords="5,129,88,155"/>
<area shape="rect" href="classFile__X509.html#a009e0a2396931d62c87d27f4e2372024" title="Extract raw BER from Base64 encoding." alt="" coords="156,5,257,31"/>
<area shape="rect" href="classFile__X509.html#ad60bc52a972cab9df3fc002a25de16dc" title="Check for validity of subarray." alt="" coords="141,55,272,80"/>
<area shape="rect" href="classFile__X509.html#a016c0c81b4115631a081d91036c8839f" title="Map DN values from ANY type to DN&#45;specific internal format." alt="" coords="158,104,255,129"/>
<area shape="rect" href="classFile__X509.html#a0c34c28604781bdc296e7ade6951a734" title="Map extension values from octet string to extension&#45;specific internal format." alt="" coords="136,153,277,179"/>
<area shape="rect" href="classFile__X509.html#a195dac5d2b72ef86fe28250ea43343b8" title="Reformat public keys." alt="" coords="151,203,262,228"/>
<area shape="rect" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb" title="Get a certificate, CSR or CRL Extension." alt="" coords="153,252,260,277"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="351,153,458,179"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="680,177,767,203"/>
<area shape="rect" href="classFile__X509.html#a50d402cfb4c93492899c7a222ddb6803" title="Get a reference to a subarray." alt="" coords="325,203,484,228"/>
<area shape="rect" href="classFile__X509.html#a51d0ffadbcbf965b23238b89fef03484" title="Get an Extension." alt="" coords="347,252,462,277"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="532,203,632,228"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a6b1d3038d8f6448b8f7d25f324833376_icgraph.png" border="0" usemap="#aclassFile__X509_a6b1d3038d8f6448b8f7d25f324833376_icgraph" alt=""/></div>
<map name="aclassFile__X509_a6b1d3038d8f6448b8f7d25f324833376_icgraph" id="aclassFile__X509_a6b1d3038d8f6448b8f7d25f324833376_icgraph">
<area shape="rect" title="Load X.509 certificate." alt="" coords="121,31,204,56"/>
<area shape="rect" href="classFile__X509.html#a89783012156bb16439adcba84bca93d8" title="Load an X.509 certificate as a certificate authority." alt="" coords="5,5,73,31"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="15,55,64,80"/>
</map>
</div>

</div>
</div>
<a id="aa42928e53345a0bc23e9c6288e9f38a7" name="aa42928e53345a0bc23e9c6288e9f38a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa42928e53345a0bc23e9c6288e9f38a7">&#9670;&#160;</a></span>makeCA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">makeCA </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Turns the certificate into a certificate authority. </p>
<p>@access public </p>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04223">4223</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4224</span>    {</div>
<div class="line"><span class="lineno"> 4225</span>        $this-&gt;caFlag = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4226</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="acd0554eb35727bf8349119bc5a239059" name="acd0554eb35727bf8349119bc5a239059"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd0554eb35727bf8349119bc5a239059">&#9670;&#160;</a></span>removeAttribute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">removeAttribute </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$disposition</em> = <code><a class="el" href="X509_8php.html#a00c13d4a694558e4a9b24ed9e5462a8e">FILE_X509_ATTR_ALL</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a CSR attribute. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$id</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$disposition</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04567">4567</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4568</span>    {</div>
<div class="line"><span class="lineno"> 4569</span>        $attributes = &amp;$this-&gt;_subArray($this-&gt;currentCert, <span class="stringliteral">&#39;certificationRequestInfo/attributes&#39;</span>);</div>
<div class="line"><span class="lineno"> 4570</span> </div>
<div class="line"><span class="lineno"> 4571</span>        <span class="keywordflow">if</span> (!is_array($attributes)) {</div>
<div class="line"><span class="lineno"> 4572</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4573</span>        }</div>
<div class="line"><span class="lineno"> 4574</span> </div>
<div class="line"><span class="lineno"> 4575</span>        $result = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4576</span>        <span class="keywordflow">foreach</span> ($attributes as $key =&gt; $attribute) {</div>
<div class="line"><span class="lineno"> 4577</span>            <span class="keywordflow">if</span> ($attribute[<span class="stringliteral">&#39;type&#39;</span>] == $id) {</div>
<div class="line"><span class="lineno"> 4578</span>                $n = count($attribute[<span class="stringliteral">&#39;value&#39;</span>]);</div>
<div class="line"><span class="lineno"> 4579</span>                <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 4580</span>                    <span class="keywordflow">case</span> $disposition == <a class="code hl_variable" href="X509_8php.html#a2680c288fb1c165acb2843b0ad8b3395">FILE_X509_ATTR_APPEND</a>:</div>
<div class="line"><span class="lineno"> 4581</span>                    <span class="keywordflow">case</span> $disposition == <a class="code hl_variable" href="X509_8php.html#ad766ad0de320dd5b44de47ef51cb773e">FILE_X509_ATTR_REPLACE</a>:</div>
<div class="line"><span class="lineno"> 4582</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4583</span>                    <span class="keywordflow">case</span> $disposition &gt;= $n:</div>
<div class="line"><span class="lineno"> 4584</span>                        $disposition -= $n;</div>
<div class="line"><span class="lineno"> 4585</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4586</span>                    <span class="keywordflow">case</span> $disposition == <a class="code hl_variable" href="X509_8php.html#a00c13d4a694558e4a9b24ed9e5462a8e">FILE_X509_ATTR_ALL</a>:</div>
<div class="line"><span class="lineno"> 4587</span>                    <span class="keywordflow">case</span> $n == 1:</div>
<div class="line"><span class="lineno"> 4588</span>                        unset($attributes[$key]);</div>
<div class="line"><span class="lineno"> 4589</span>                        $result = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4590</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4591</span>                    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 4592</span>                        unset($attributes[$key][<span class="stringliteral">&#39;value&#39;</span>][$disposition]);</div>
<div class="line"><span class="lineno"> 4593</span>                        $attributes[$key][<span class="stringliteral">&#39;value&#39;</span>] = array_values($attributes[$key][<span class="stringliteral">&#39;value&#39;</span>]);</div>
<div class="line"><span class="lineno"> 4594</span>                        $result = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4595</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4596</span>                }</div>
<div class="line"><span class="lineno"> 4597</span>                <span class="keywordflow">if</span> ($result &amp;&amp; $disposition != <a class="code hl_variable" href="X509_8php.html#a00c13d4a694558e4a9b24ed9e5462a8e">FILE_X509_ATTR_ALL</a>) {</div>
<div class="line"><span class="lineno"> 4598</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4599</span>                }</div>
<div class="line"><span class="lineno"> 4600</span>            }</div>
<div class="line"><span class="lineno"> 4601</span>        }</div>
<div class="line"><span class="lineno"> 4602</span> </div>
<div class="line"><span class="lineno"> 4603</span>        $attributes = array_values($attributes);</div>
<div class="line"><span class="lineno"> 4604</span>        <span class="keywordflow">return</span> $result;</div>
<div class="line"><span class="lineno"> 4605</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>, <a class="el" href="X509_8php_source.html#l00125">FILE_X509_ATTR_ALL</a>, <a class="el" href="X509_8php_source.html#l00126">FILE_X509_ATTR_APPEND</a>, and <a class="el" href="X509_8php_source.html#l00127">FILE_X509_ATTR_REPLACE</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l04685">setAttribute()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_acd0554eb35727bf8349119bc5a239059_cgraph.png" border="0" usemap="#aclassFile__X509_acd0554eb35727bf8349119bc5a239059_cgraph" alt=""/></div>
<map name="aclassFile__X509_acd0554eb35727bf8349119bc5a239059_cgraph" id="aclassFile__X509_acd0554eb35727bf8349119bc5a239059_cgraph">
<area shape="rect" title="Remove a CSR attribute." alt="" coords="5,5,135,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="183,5,269,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_acd0554eb35727bf8349119bc5a239059_icgraph.png" border="0" usemap="#aclassFile__X509_acd0554eb35727bf8349119bc5a239059_icgraph" alt=""/></div>
<map name="aclassFile__X509_acd0554eb35727bf8349119bc5a239059_icgraph" id="aclassFile__X509_acd0554eb35727bf8349119bc5a239059_icgraph">
<area shape="rect" title="Remove a CSR attribute." alt="" coords="152,5,281,31"/>
<area shape="rect" href="classFile__X509.html#a4c4215dc2b69bac52080d9f174dbfcd6" title="Set a CSR attribute." alt="" coords="5,5,104,31"/>
</map>
</div>

</div>
</div>
<a id="a65782113764c16cb36982e9b29b24fbd" name="a65782113764c16cb36982e9b29b24fbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65782113764c16cb36982e9b29b24fbd">&#9670;&#160;</a></span>removeDNProp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">removeDNProp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$propName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove Distinguished Name properties. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$propName</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02742">2742</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2743</span>    {</div>
<div class="line"><span class="lineno"> 2744</span>        <span class="keywordflow">if</span> (empty($this-&gt;dn)) {</div>
<div class="line"><span class="lineno"> 2745</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2746</span>        }</div>
<div class="line"><span class="lineno"> 2747</span> </div>
<div class="line"><span class="lineno"> 2748</span>        <span class="keywordflow">if</span> (($propName = $this-&gt;_translateDNProp($propName)) === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2749</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2750</span>        }</div>
<div class="line"><span class="lineno"> 2751</span> </div>
<div class="line"><span class="lineno"> 2752</span>        <a class="code hl_variable" href="classFile__X509.html#aec1788b361bcb8be2632e5a0e3b8097b">$dn</a> = &amp;$this-&gt;dn[<span class="stringliteral">&#39;rdnSequence&#39;</span>];</div>
<div class="line"><span class="lineno"> 2753</span>        $size = count($dn);</div>
<div class="line"><span class="lineno"> 2754</span>        <span class="keywordflow">for</span> ($i = 0; $i &lt; $size; $i++) {</div>
<div class="line"><span class="lineno"> 2755</span>            <span class="keywordflow">if</span> ($dn[$i][0][<span class="stringliteral">&#39;type&#39;</span>] == $propName) {</div>
<div class="line"><span class="lineno"> 2756</span>                unset($dn[$i]);</div>
<div class="line"><span class="lineno"> 2757</span>            }</div>
<div class="line"><span class="lineno"> 2758</span>        }</div>
<div class="line"><span class="lineno"> 2759</span> </div>
<div class="line"><span class="lineno"> 2760</span>        <a class="code hl_variable" href="classFile__X509.html#aec1788b361bcb8be2632e5a0e3b8097b">$dn</a> = array_values($dn);</div>
<div class="line"><span class="lineno"> 2761</span>        <span class="comment">// fix for https://bugs.php.net/75433 affecting PHP 7.2</span></div>
<div class="line"><span class="lineno"> 2762</span>        <span class="keywordflow">if</span> (!isset($dn[0])) {</div>
<div class="line"><span class="lineno"> 2763</span>            <a class="code hl_variable" href="classFile__X509.html#aec1788b361bcb8be2632e5a0e3b8097b">$dn</a> = array_splice($dn, 0, 0);</div>
<div class="line"><span class="lineno"> 2764</span>        }</div>
<div class="line"><span class="lineno"> 2765</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l02617">_translateDNProp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l04875">setDomain()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a65782113764c16cb36982e9b29b24fbd_cgraph.png" border="0" usemap="#aclassFile__X509_a65782113764c16cb36982e9b29b24fbd_cgraph" alt=""/></div>
<map name="aclassFile__X509_a65782113764c16cb36982e9b29b24fbd_cgraph" id="aclassFile__X509_a65782113764c16cb36982e9b29b24fbd_cgraph">
<area shape="rect" title="Remove Distinguished Name properties." alt="" coords="5,5,127,31"/>
<area shape="rect" href="classFile__X509.html#ad4e0267f8e236f9707325bce89ce2b0a" title="&quot;Normalizes&quot; a Distinguished Name property" alt="" coords="175,5,311,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a65782113764c16cb36982e9b29b24fbd_icgraph.png" border="0" usemap="#aclassFile__X509_a65782113764c16cb36982e9b29b24fbd_icgraph" alt=""/></div>
<map name="aclassFile__X509_a65782113764c16cb36982e9b29b24fbd_icgraph" id="aclassFile__X509_a65782113764c16cb36982e9b29b24fbd_icgraph">
<area shape="rect" title="Remove Distinguished Name properties." alt="" coords="147,5,268,31"/>
<area shape="rect" href="classFile__X509.html#ab2400a644664fad908c8bd05995f6c8c" title="Set the domain name&#39;s which the cert is to be valid for." alt="" coords="5,5,99,31"/>
</map>
</div>

</div>
</div>
<a id="aa75a9d891292eeddcbf00060e36c0695" name="aa75a9d891292eeddcbf00060e36c0695"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa75a9d891292eeddcbf00060e36c0695">&#9670;&#160;</a></span>removeExtension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">removeExtension </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a certificate, CSR or CRL Extension. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$id</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04512">4512</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4513</span>    {</div>
<div class="line"><span class="lineno"> 4514</span>        <span class="keywordflow">return</span> $this-&gt;_removeExtension($id);</div>
<div class="line"><span class="lineno"> 4515</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04395">_removeExtension()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l03684">sign()</a>, and <a class="el" href="X509_8php_source.html#l04004">signCRL()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_aa75a9d891292eeddcbf00060e36c0695_cgraph.png" border="0" usemap="#aclassFile__X509_aa75a9d891292eeddcbf00060e36c0695_cgraph" alt=""/></div>
<map name="aclassFile__X509_aa75a9d891292eeddcbf00060e36c0695_cgraph" id="aclassFile__X509_aa75a9d891292eeddcbf00060e36c0695_cgraph">
<area shape="rect" title="Remove a certificate, CSR or CRL Extension." alt="" coords="5,5,141,31"/>
<area shape="rect" href="classFile__X509.html#ac16dd74cbc682e06b2f35875d04582d1" title="Remove an Extension." alt="" coords="189,5,332,31"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="380,5,480,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="528,5,615,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_aa75a9d891292eeddcbf00060e36c0695_icgraph.png" border="0" usemap="#aclassFile__X509_aa75a9d891292eeddcbf00060e36c0695_icgraph" alt=""/></div>
<map name="aclassFile__X509_aa75a9d891292eeddcbf00060e36c0695_icgraph" id="aclassFile__X509_aa75a9d891292eeddcbf00060e36c0695_icgraph">
<area shape="rect" title="Remove a certificate, CSR or CRL Extension." alt="" coords="128,31,264,56"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="18,5,67,31"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="5,55,80,80"/>
</map>
</div>

</div>
</div>
<a id="a436596da8ebdb29da908604cc2c0b1b5" name="a436596da8ebdb29da908604cc2c0b1b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a436596da8ebdb29da908604cc2c0b1b5">&#9670;&#160;</a></span>removeRevokedCertificateExtension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">removeRevokedCertificateExtension </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$serial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a Revoked Certificate Extension. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$serial</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$id</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l05061">5061</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5062</span>    {</div>
<div class="line"><span class="lineno"> 5063</span>        <span class="keywordflow">if</span> (is_array($rclist = &amp;$this-&gt;_subArray($this-&gt;currentCert, <span class="stringliteral">&#39;tbsCertList/revokedCertificates&#39;</span>))) {</div>
<div class="line"><span class="lineno"> 5064</span>            <span class="keywordflow">if</span> (($i = $this-&gt;_revokedCertificate($rclist, $serial)) !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 5065</span>                <span class="keywordflow">return</span> $this-&gt;_removeExtension($id, <span class="stringliteral">&quot;tbsCertList/revokedCertificates/$i/crlEntryExtensions&quot;</span>);</div>
<div class="line"><span class="lineno"> 5066</span>            }</div>
<div class="line"><span class="lineno"> 5067</span>        }</div>
<div class="line"><span class="lineno"> 5068</span> </div>
<div class="line"><span class="lineno"> 5069</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 5070</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04395">_removeExtension()</a>, <a class="el" href="X509_8php_source.html#l04933">_revokedCertificate()</a>, and <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a436596da8ebdb29da908604cc2c0b1b5_cgraph.png" border="0" usemap="#aclassFile__X509_a436596da8ebdb29da908604cc2c0b1b5_cgraph" alt=""/></div>
<map name="aclassFile__X509_a436596da8ebdb29da908604cc2c0b1b5_cgraph" id="aclassFile__X509_a436596da8ebdb29da908604cc2c0b1b5_cgraph">
<area shape="rect" title="Remove a Revoked Certificate Extension." alt="" coords="5,49,200,89"/>
<area shape="rect" href="classFile__X509.html#ac16dd74cbc682e06b2f35875d04582d1" title="Remove an Extension." alt="" coords="251,5,393,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="592,31,679,56"/>
<area shape="rect" href="classFile__X509.html#a8fd951ac4d21092f644bd6528c171bcb" title="Get the index of a revoked certificate." alt="" coords="248,107,396,132"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="444,5,544,31"/>
<area shape="rect" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089" title="Helper function to build a time field according to RFC 3280 section." alt="" coords="449,107,539,132"/>
</map>
</div>

</div>
</div>
<a id="a9d0898bce518129997e439126cde0c96" name="a9d0898bce518129997e439126cde0c96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d0898bce518129997e439126cde0c96">&#9670;&#160;</a></span>revoke()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">revoke </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$serial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$date</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Revoke a certificate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$serial</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$date</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04968">4968</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4969</span>    {</div>
<div class="line"><span class="lineno"> 4970</span>        <span class="keywordflow">if</span> (isset($this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 4971</span>            <span class="keywordflow">if</span> (is_array($rclist = &amp;$this-&gt;_subArray($this-&gt;currentCert, <span class="stringliteral">&#39;tbsCertList/revokedCertificates&#39;</span>, <span class="keyword">true</span>))) {</div>
<div class="line"><span class="lineno"> 4972</span>                <span class="keywordflow">if</span> ($this-&gt;_revokedCertificate($rclist, $serial) === <span class="keyword">false</span>) { <span class="comment">// If not yet revoked</span></div>
<div class="line"><span class="lineno"> 4973</span>                    <span class="keywordflow">if</span> (($i = $this-&gt;_revokedCertificate($rclist, $serial, <span class="keyword">true</span>)) !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 4974</span>                        <span class="keywordflow">if</span> (!empty($date)) {</div>
<div class="line"><span class="lineno"> 4975</span>                            $rclist[$i][<span class="stringliteral">&#39;revocationDate&#39;</span>] = $this-&gt;_timeField($date);</div>
<div class="line"><span class="lineno"> 4976</span>                        }</div>
<div class="line"><span class="lineno"> 4977</span> </div>
<div class="line"><span class="lineno"> 4978</span>                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4979</span>                    }</div>
<div class="line"><span class="lineno"> 4980</span>                }</div>
<div class="line"><span class="lineno"> 4981</span>            }</div>
<div class="line"><span class="lineno"> 4982</span>        }</div>
<div class="line"><span class="lineno"> 4983</span> </div>
<div class="line"><span class="lineno"> 4984</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4985</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04933">_revokedCertificate()</a>, <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>, and <a class="el" href="X509_8php_source.html#l03653">_timeField()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a9d0898bce518129997e439126cde0c96_cgraph.png" border="0" usemap="#aclassFile__X509_a9d0898bce518129997e439126cde0c96_cgraph" alt=""/></div>
<map name="aclassFile__X509_a9d0898bce518129997e439126cde0c96_cgraph" id="aclassFile__X509_a9d0898bce518129997e439126cde0c96_cgraph">
<area shape="rect" title="Revoke a certificate." alt="" coords="5,56,72,81"/>
<area shape="rect" href="classFile__X509.html#a8fd951ac4d21092f644bd6528c171bcb" title="Get the index of a revoked certificate." alt="" coords="120,5,268,31"/>
<area shape="rect" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089" title="Helper function to build a time field according to RFC 3280 section." alt="" coords="316,31,407,56"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="151,107,237,132"/>
</map>
</div>

</div>
</div>
<a id="a9ea29c41d328dc397c2f1de19a178696" name="a9ea29c41d328dc397c2f1de19a178696"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ea29c41d328dc397c2f1de19a178696">&#9670;&#160;</a></span>saveCRL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">saveCRL </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$crl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$format</em> = <code><a class="el" href="X509_8php.html#a036042d3a607d01afacc62e969dae3b7">FILE_X509_FORMAT_PEM</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save Certificate Revocation List. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$crl</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$format</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03591">3591</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3592</span>    {</div>
<div class="line"><span class="lineno"> 3593</span>        <span class="keywordflow">if</span> (!is_array($crl) || !isset($crl[<span class="stringliteral">&#39;tbsCertList&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 3594</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3595</span>        }</div>
<div class="line"><span class="lineno"> 3596</span> </div>
<div class="line"><span class="lineno"> 3597</span>        $asn1 = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__ASN1.html">File_ASN1</a>();</div>
<div class="line"><span class="lineno"> 3598</span> </div>
<div class="line"><span class="lineno"> 3599</span>        $asn1-&gt;loadOIDs($this-&gt;oids);</div>
<div class="line"><span class="lineno"> 3600</span> </div>
<div class="line"><span class="lineno"> 3601</span>        $filters = array();</div>
<div class="line"><span class="lineno"> 3602</span>        $filters[<span class="stringliteral">&#39;tbsCertList&#39;</span>][<span class="stringliteral">&#39;issuer&#39;</span>][<span class="stringliteral">&#39;rdnSequence&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>]</div>
<div class="line"><span class="lineno"> 3603</span>            = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>);</div>
<div class="line"><span class="lineno"> 3604</span>        $filters[<span class="stringliteral">&#39;tbsCertList&#39;</span>][<span class="stringliteral">&#39;signature&#39;</span>][<span class="stringliteral">&#39;parameters&#39;</span>]</div>
<div class="line"><span class="lineno"> 3605</span>            = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>);</div>
<div class="line"><span class="lineno"> 3606</span>        $filters[<span class="stringliteral">&#39;signatureAlgorithm&#39;</span>][<span class="stringliteral">&#39;parameters&#39;</span>]</div>
<div class="line"><span class="lineno"> 3607</span>            = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>);</div>
<div class="line"><span class="lineno"> 3608</span> </div>
<div class="line"><span class="lineno"> 3609</span>        <span class="keywordflow">if</span> (empty($crl[<span class="stringliteral">&#39;tbsCertList&#39;</span>][<span class="stringliteral">&#39;signature&#39;</span>][<span class="stringliteral">&#39;parameters&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 3610</span>            $filters[<span class="stringliteral">&#39;tbsCertList&#39;</span>][<span class="stringliteral">&#39;signature&#39;</span>][<span class="stringliteral">&#39;parameters&#39;</span>]</div>
<div class="line"><span class="lineno"> 3611</span>                = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a178f5750294c65763f2b1b2d1a4acb0d">FILE_ASN1_TYPE_NULL</a>);</div>
<div class="line"><span class="lineno"> 3612</span>        }</div>
<div class="line"><span class="lineno"> 3613</span> </div>
<div class="line"><span class="lineno"> 3614</span>        <span class="keywordflow">if</span> (empty($crl[<span class="stringliteral">&#39;signatureAlgorithm&#39;</span>][<span class="stringliteral">&#39;parameters&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 3615</span>            $filters[<span class="stringliteral">&#39;signatureAlgorithm&#39;</span>][<span class="stringliteral">&#39;parameters&#39;</span>]</div>
<div class="line"><span class="lineno"> 3616</span>                = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a178f5750294c65763f2b1b2d1a4acb0d">FILE_ASN1_TYPE_NULL</a>);</div>
<div class="line"><span class="lineno"> 3617</span>        }</div>
<div class="line"><span class="lineno"> 3618</span> </div>
<div class="line"><span class="lineno"> 3619</span>        $asn1-&gt;loadFilters($filters);</div>
<div class="line"><span class="lineno"> 3620</span> </div>
<div class="line"><span class="lineno"> 3621</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c">_mapOutDNs</a>($crl, <span class="stringliteral">&#39;tbsCertList/issuer/rdnSequence&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 3622</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc612875837ae70595137c6166f90106">_mapOutExtensions</a>($crl, <span class="stringliteral">&#39;tbsCertList/crlExtensions&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 3623</span>        $rclist = &amp;$this-&gt;<a class="code hl_function" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471">_subArray</a>($crl, <span class="stringliteral">&#39;tbsCertList/revokedCertificates&#39;</span>);</div>
<div class="line"><span class="lineno"> 3624</span>        <span class="keywordflow">if</span> (is_array($rclist)) {</div>
<div class="line"><span class="lineno"> 3625</span>            <span class="keywordflow">foreach</span> ($rclist as $i =&gt; $extension) {</div>
<div class="line"><span class="lineno"> 3626</span>                $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc612875837ae70595137c6166f90106">_mapOutExtensions</a>($rclist, <span class="stringliteral">&quot;$i/crlEntryExtensions&quot;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 3627</span>            }</div>
<div class="line"><span class="lineno"> 3628</span>        }</div>
<div class="line"><span class="lineno"> 3629</span> </div>
<div class="line"><span class="lineno"> 3630</span>        $crl = $asn1-&gt;encodeDER($crl, $this-&gt;CertificateList);</div>
<div class="line"><span class="lineno"> 3631</span> </div>
<div class="line"><span class="lineno"> 3632</span>        <span class="keywordflow">switch</span> ($format) {</div>
<div class="line"><span class="lineno"> 3633</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="X509_8php.html#a2418178d5c6bdae785f3e9f3583ba354">FILE_X509_FORMAT_DER</a>:</div>
<div class="line"><span class="lineno"> 3634</span>                <span class="keywordflow">return</span> $crl;</div>
<div class="line"><span class="lineno"> 3635</span>            <span class="comment">// case FILE_X509_FORMAT_PEM:</span></div>
<div class="line"><span class="lineno"> 3636</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3637</span>                <span class="keywordflow">return</span> <span class="stringliteral">&quot;-----BEGIN X509 CRL-----\r\n&quot;</span> . chunk_split(base64_encode($crl), 64) . <span class="stringliteral">&#39;-----END X509 CRL-----&#39;</span>;</div>
<div class="line"><span class="lineno"> 3638</span>        }</div>
<div class="line"><span class="lineno"> 3639</span>    }</div>
<div class="ttc" id="aASN1_8php_html_a178f5750294c65763f2b1b2d1a4acb0d"><div class="ttname"><a href="ASN1_8php.html#a178f5750294c65763f2b1b2d1a4acb0d">FILE_ASN1_TYPE_NULL</a></div><div class="ttdeci">const FILE_ASN1_TYPE_NULL</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00064">ASN1.php:64</a></div></div>
<div class="ttc" id="aclassFile__X509_html_afc612875837ae70595137c6166f90106"><div class="ttname"><a href="classFile__X509.html#afc612875837ae70595137c6166f90106">File_X509\_mapOutExtensions</a></div><div class="ttdeci">_mapOutExtensions(&amp;$root, $path, $asn1)</div><div class="ttdoc">Map extension values from extension-specific internal format to octet string.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l01701">X509.php:1701</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l01881">_mapOutDNs()</a>, <a class="el" href="X509_8php_source.html#l01701">_mapOutExtensions()</a>, <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>, <a class="el" href="ASN1_8php_source.html#l00064">FILE_ASN1_TYPE_NULL</a>, <a class="el" href="ASN1_8php_source.html#l00071">FILE_ASN1_TYPE_UTF8_STRING</a>, and <a class="el" href="X509_8php_source.html#l00106">FILE_X509_FORMAT_DER</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l04004">signCRL()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a9ea29c41d328dc397c2f1de19a178696_cgraph.png" border="0" usemap="#aclassFile__X509_a9ea29c41d328dc397c2f1de19a178696_cgraph" alt=""/></div>
<map name="aclassFile__X509_a9ea29c41d328dc397c2f1de19a178696_cgraph" id="aclassFile__X509_a9ea29c41d328dc397c2f1de19a178696_cgraph">
<area shape="rect" title="Save Certificate Revocation List." alt="" coords="5,55,84,80"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="154,55,262,80"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="342,55,429,80"/>
<area shape="rect" href="classFile__X509.html#afc612875837ae70595137c6166f90106" title="Map extension values from extension&#45;specific internal format to octet string." alt="" coords="132,5,284,31"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="332,5,439,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a9ea29c41d328dc397c2f1de19a178696_icgraph.png" border="0" usemap="#aclassFile__X509_a9ea29c41d328dc397c2f1de19a178696_icgraph" alt=""/></div>
<map name="aclassFile__X509_a9ea29c41d328dc397c2f1de19a178696_icgraph" id="aclassFile__X509_a9ea29c41d328dc397c2f1de19a178696_icgraph">
<area shape="rect" title="Save Certificate Revocation List." alt="" coords="128,5,207,31"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="5,5,80,31"/>
</map>
</div>

</div>
</div>
<a id="a9c1ab61eb1f01e39614b1fb1a99bd202" name="a9c1ab61eb1f01e39614b1fb1a99bd202"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c1ab61eb1f01e39614b1fb1a99bd202">&#9670;&#160;</a></span>saveCSR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">saveCSR </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$csr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$format</em> = <code><a class="el" href="X509_8php.html#a036042d3a607d01afacc62e969dae3b7">FILE_X509_FORMAT_PEM</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save CSR request. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$csr</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$format</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03346">3346</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3347</span>    {</div>
<div class="line"><span class="lineno"> 3348</span>        <span class="keywordflow">if</span> (!is_array($csr) || !isset($csr[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 3349</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3350</span>        }</div>
<div class="line"><span class="lineno"> 3351</span> </div>
<div class="line"><span class="lineno"> 3352</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 3353</span>            <span class="keywordflow">case</span> !($algorithm = $this-&gt;_subArray($csr, <span class="stringliteral">&#39;certificationRequestInfo/subjectPKInfo/algorithm/algorithm&#39;</span>)):</div>
<div class="line"><span class="lineno"> 3354</span>            <span class="keywordflow">case</span> is_object($csr[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subjectPKInfo&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>]):</div>
<div class="line"><span class="lineno"> 3355</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3356</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3357</span>                <span class="keywordflow">switch</span> ($algorithm) {</div>
<div class="line"><span class="lineno"> 3358</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;rsaEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 3359</span>                        $csr[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subjectPKInfo&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>]</div>
<div class="line"><span class="lineno"> 3360</span>                            = base64_encode(<span class="stringliteral">&quot;\0&quot;</span> . base64_decode(preg_replace(<span class="stringliteral">&#39;#-.+-|[\r\n]#&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $csr[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subjectPKInfo&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>])));</div>
<div class="line"><span class="lineno"> 3361</span>                        $csr[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subjectPKInfo&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>][<span class="stringliteral">&#39;parameters&#39;</span>] = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 3362</span>                        $csr[<span class="stringliteral">&#39;signatureAlgorithm&#39;</span>][<span class="stringliteral">&#39;parameters&#39;</span>] = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 3363</span>                        $csr[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;signature&#39;</span>][<span class="stringliteral">&#39;parameters&#39;</span>] = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 3364</span>                }</div>
<div class="line"><span class="lineno"> 3365</span>        }</div>
<div class="line"><span class="lineno"> 3366</span> </div>
<div class="line"><span class="lineno"> 3367</span>        $asn1 = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__ASN1.html">File_ASN1</a>();</div>
<div class="line"><span class="lineno"> 3368</span> </div>
<div class="line"><span class="lineno"> 3369</span>        $asn1-&gt;loadOIDs($this-&gt;oids);</div>
<div class="line"><span class="lineno"> 3370</span> </div>
<div class="line"><span class="lineno"> 3371</span>        $filters = array();</div>
<div class="line"><span class="lineno"> 3372</span>        $filters[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>][<span class="stringliteral">&#39;rdnSequence&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>]</div>
<div class="line"><span class="lineno"> 3373</span>            = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>);</div>
<div class="line"><span class="lineno"> 3374</span> </div>
<div class="line"><span class="lineno"> 3375</span>        $asn1-&gt;loadFilters($filters);</div>
<div class="line"><span class="lineno"> 3376</span> </div>
<div class="line"><span class="lineno"> 3377</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c">_mapOutDNs</a>($csr, <span class="stringliteral">&#39;certificationRequestInfo/subject/rdnSequence&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 3378</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#acb6786d74bfd53b1a57ea5f72de69ab5">_mapOutAttributes</a>($csr, <span class="stringliteral">&#39;certificationRequestInfo/attributes&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 3379</span>        $csr = $asn1-&gt;encodeDER($csr, $this-&gt;CertificationRequest);</div>
<div class="line"><span class="lineno"> 3380</span> </div>
<div class="line"><span class="lineno"> 3381</span>        <span class="keywordflow">switch</span> ($format) {</div>
<div class="line"><span class="lineno"> 3382</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="X509_8php.html#a2418178d5c6bdae785f3e9f3583ba354">FILE_X509_FORMAT_DER</a>:</div>
<div class="line"><span class="lineno"> 3383</span>                <span class="keywordflow">return</span> $csr;</div>
<div class="line"><span class="lineno"> 3384</span>            <span class="comment">// case FILE_X509_FORMAT_PEM:</span></div>
<div class="line"><span class="lineno"> 3385</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3386</span>                <span class="keywordflow">return</span> <span class="stringliteral">&quot;-----BEGIN CERTIFICATE REQUEST-----\r\n&quot;</span> . chunk_split(base64_encode($csr), 64) . <span class="stringliteral">&#39;-----END CERTIFICATE REQUEST-----&#39;</span>;</div>
<div class="line"><span class="lineno"> 3387</span>        }</div>
<div class="line"><span class="lineno"> 3388</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_acb6786d74bfd53b1a57ea5f72de69ab5"><div class="ttname"><a href="classFile__X509.html#acb6786d74bfd53b1a57ea5f72de69ab5">File_X509\_mapOutAttributes</a></div><div class="ttdeci">_mapOutAttributes(&amp;$root, $path, $asn1)</div><div class="ttdoc">Map attribute values from attribute-specific internal format to ANY type.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l01808">X509.php:1808</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l01808">_mapOutAttributes()</a>, <a class="el" href="X509_8php_source.html#l01881">_mapOutDNs()</a>, <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>, <a class="el" href="ASN1_8php_source.html#l00071">FILE_ASN1_TYPE_UTF8_STRING</a>, and <a class="el" href="X509_8php_source.html#l00106">FILE_X509_FORMAT_DER</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l03876">signCSR()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a9c1ab61eb1f01e39614b1fb1a99bd202_cgraph.png" border="0" usemap="#aclassFile__X509_a9c1ab61eb1f01e39614b1fb1a99bd202_cgraph" alt=""/></div>
<map name="aclassFile__X509_a9c1ab61eb1f01e39614b1fb1a99bd202_cgraph" id="aclassFile__X509_a9c1ab61eb1f01e39614b1fb1a99bd202_cgraph">
<area shape="rect" title="Save CSR request." alt="" coords="5,107,84,132"/>
<area shape="rect" href="classFile__X509.html#acb6786d74bfd53b1a57ea5f72de69ab5" title="Map attribute values from attribute&#45;specific internal format to ANY type." alt="" coords="132,107,277,132"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="535,132,622,157"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="347,5,455,31"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="525,56,632,81"/>
<area shape="rect" href="classFile__X509.html#afc612875837ae70595137c6166f90106" title="Map extension values from extension&#45;specific internal format to octet string." alt="" coords="325,107,477,132"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a9c1ab61eb1f01e39614b1fb1a99bd202_icgraph.png" border="0" usemap="#aclassFile__X509_a9c1ab61eb1f01e39614b1fb1a99bd202_icgraph" alt=""/></div>
<map name="aclassFile__X509_a9c1ab61eb1f01e39614b1fb1a99bd202_icgraph" id="aclassFile__X509_a9c1ab61eb1f01e39614b1fb1a99bd202_icgraph">
<area shape="rect" title="Save CSR request." alt="" coords="128,5,207,31"/>
<area shape="rect" href="classFile__X509.html#ac3826badcacf04dae2371185f6feddde" title="Sign a CSR." alt="" coords="5,5,80,31"/>
</map>
</div>

</div>
</div>
<a id="ac6079ff51d79eadb1bb21c2342f9d0d0" name="ac6079ff51d79eadb1bb21c2342f9d0d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6079ff51d79eadb1bb21c2342f9d0d0">&#9670;&#160;</a></span>saveSPKAC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">saveSPKAC </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$spkac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$format</em> = <code><a class="el" href="X509_8php.html#a036042d3a607d01afacc62e969dae3b7">FILE_X509_FORMAT_PEM</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save a SPKAC CSR request. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string&#160;|&#160;array</td><td class="paramname">$spkac</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$format</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03478">3478</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3479</span>    {</div>
<div class="line"><span class="lineno"> 3480</span>        <span class="keywordflow">if</span> (!is_array($spkac) || !isset($spkac[<span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 3481</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3482</span>        }</div>
<div class="line"><span class="lineno"> 3483</span> </div>
<div class="line"><span class="lineno"> 3484</span>        $algorithm = $this-&gt;_subArray($spkac, <span class="stringliteral">&#39;publicKeyAndChallenge/spki/algorithm/algorithm&#39;</span>);</div>
<div class="line"><span class="lineno"> 3485</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 3486</span>            <span class="keywordflow">case</span> !$algorithm:</div>
<div class="line"><span class="lineno"> 3487</span>            <span class="keywordflow">case</span> is_object($spkac[<span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span>][<span class="stringliteral">&#39;spki&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>]):</div>
<div class="line"><span class="lineno"> 3488</span>                break;</div>
<div class="line"><span class="lineno"> 3489</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3490</span>                <span class="keywordflow">switch</span> ($algorithm) {</div>
<div class="line"><span class="lineno"> 3491</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;rsaEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 3492</span>                        $spkac[<span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span>][<span class="stringliteral">&#39;spki&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>]</div>
<div class="line"><span class="lineno"> 3493</span>                            = base64_encode(<span class="stringliteral">&quot;\0&quot;</span> . base64_decode(preg_replace(<span class="stringliteral">&#39;#-.+-|[\r\n]#&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $spkac[<span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span>][<span class="stringliteral">&#39;spki&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>])));</div>
<div class="line"><span class="lineno"> 3494</span>                }</div>
<div class="line"><span class="lineno"> 3495</span>        }</div>
<div class="line"><span class="lineno"> 3496</span> </div>
<div class="line"><span class="lineno"> 3497</span>        $asn1 = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__ASN1.html">File_ASN1</a>();</div>
<div class="line"><span class="lineno"> 3498</span> </div>
<div class="line"><span class="lineno"> 3499</span>        $asn1-&gt;loadOIDs($this-&gt;oids);</div>
<div class="line"><span class="lineno"> 3500</span>        $spkac = $asn1-&gt;encodeDER($spkac, $this-&gt;SignedPublicKeyAndChallenge);</div>
<div class="line"><span class="lineno"> 3501</span> </div>
<div class="line"><span class="lineno"> 3502</span>        <span class="keywordflow">switch</span> ($format) {</div>
<div class="line"><span class="lineno"> 3503</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="X509_8php.html#a2418178d5c6bdae785f3e9f3583ba354">FILE_X509_FORMAT_DER</a>:</div>
<div class="line"><span class="lineno"> 3504</span>                <span class="keywordflow">return</span> $spkac;</div>
<div class="line"><span class="lineno"> 3505</span>            <span class="comment">// case FILE_X509_FORMAT_PEM:</span></div>
<div class="line"><span class="lineno"> 3506</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 3507</span>                <span class="comment">// OpenSSL&#39;s implementation of SPKAC requires the SPKAC be preceded by SPKAC= and since there are pretty much</span></div>
<div class="line"><span class="lineno"> 3508</span>                <span class="comment">// no other SPKAC decoders phpseclib will use that same format</span></div>
<div class="line"><span class="lineno"> 3509</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;SPKAC=&#39;</span> . base64_encode($spkac);</div>
<div class="line"><span class="lineno"> 3510</span>        }</div>
<div class="line"><span class="lineno"> 3511</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>, and <a class="el" href="X509_8php_source.html#l00106">FILE_X509_FORMAT_DER</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l03934">signSPKAC()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ac6079ff51d79eadb1bb21c2342f9d0d0_cgraph.png" border="0" usemap="#aclassFile__X509_ac6079ff51d79eadb1bb21c2342f9d0d0_cgraph" alt=""/></div>
<map name="aclassFile__X509_ac6079ff51d79eadb1bb21c2342f9d0d0_cgraph" id="aclassFile__X509_ac6079ff51d79eadb1bb21c2342f9d0d0_cgraph">
<area shape="rect" title="Save a SPKAC CSR request." alt="" coords="5,5,101,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="149,5,236,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ac6079ff51d79eadb1bb21c2342f9d0d0_icgraph.png" border="0" usemap="#aclassFile__X509_ac6079ff51d79eadb1bb21c2342f9d0d0_icgraph" alt=""/></div>
<map name="aclassFile__X509_ac6079ff51d79eadb1bb21c2342f9d0d0_icgraph" id="aclassFile__X509_ac6079ff51d79eadb1bb21c2342f9d0d0_icgraph">
<area shape="rect" title="Save a SPKAC CSR request." alt="" coords="145,5,241,31"/>
<area shape="rect" href="classFile__X509.html#a7579e46dcabbf3bff17d8e31f1b2cb25" title="Sign a SPKAC." alt="" coords="5,5,97,31"/>
</map>
</div>

</div>
</div>
<a id="af8e8019a921e4c0651e807c7c1644fcc" name="af8e8019a921e4c0651e807c7c1644fcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8e8019a921e4c0651e807c7c1644fcc">&#9670;&#160;</a></span>saveX509()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">saveX509 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$format</em> = <code><a class="el" href="X509_8php.html#a036042d3a607d01afacc62e969dae3b7">FILE_X509_FORMAT_PEM</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save X.509 certificate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$cert</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$format</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l01570">1570</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1571</span>    {</div>
<div class="line"><span class="lineno"> 1572</span>        <span class="keywordflow">if</span> (!is_array($cert) || !isset($cert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1573</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1574</span>        }</div>
<div class="line"><span class="lineno"> 1575</span> </div>
<div class="line"><span class="lineno"> 1576</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 1577</span>            <span class="comment">// &quot;case !$a: case !$b: break; default: whatever();&quot; is the same thing as &quot;if ($a &amp;&amp; $b) whatever()&quot;</span></div>
<div class="line"><span class="lineno"> 1578</span>            <span class="keywordflow">case</span> !($algorithm = $this-&gt;_subArray($cert, <span class="stringliteral">&#39;tbsCertificate/subjectPublicKeyInfo/algorithm/algorithm&#39;</span>)):</div>
<div class="line"><span class="lineno"> 1579</span>            <span class="keywordflow">case</span> is_object($cert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>]):</div>
<div class="line"><span class="lineno"> 1580</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1581</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1582</span>                <span class="keywordflow">switch</span> ($algorithm) {</div>
<div class="line"><span class="lineno"> 1583</span>                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;rsaEncryption&#39;</span>:</div>
<div class="line"><span class="lineno"> 1584</span>                        $cert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>]</div>
<div class="line"><span class="lineno"> 1585</span>                            = base64_encode(<span class="stringliteral">&quot;\0&quot;</span> . base64_decode(preg_replace(<span class="stringliteral">&#39;#-.+-|[\r\n]#&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $cert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span>][<span class="stringliteral">&#39;subjectPublicKey&#39;</span>])));</div>
<div class="line"><span class="lineno"> 1586</span>                        <span class="comment">/* &quot;[For RSA keys] the parameters field MUST have ASN.1 type NULL for this algorithm identifier.&quot;</span></div>
<div class="line"><span class="lineno"> 1587</span><span class="comment">                           -- https://tools.ietf.org/html/rfc3279#section-2.3.1</span></div>
<div class="line"><span class="lineno"> 1588</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1589</span><span class="comment">                           given that and the fact that RSA keys appear ot be the only key type for which the parameters field can be blank,</span></div>
<div class="line"><span class="lineno"> 1590</span><span class="comment">                           it seems like perhaps the ASN.1 description ought not say the parameters field is OPTIONAL, but whatever.</span></div>
<div class="line"><span class="lineno"> 1591</span><span class="comment">                         */</span></div>
<div class="line"><span class="lineno"> 1592</span>                        $cert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>][<span class="stringliteral">&#39;parameters&#39;</span>] = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1593</span>                        <span class="comment">// https://tools.ietf.org/html/rfc3279#section-2.2.1</span></div>
<div class="line"><span class="lineno"> 1594</span>                        $cert[<span class="stringliteral">&#39;signatureAlgorithm&#39;</span>][<span class="stringliteral">&#39;parameters&#39;</span>] = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1595</span>                        $cert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;signature&#39;</span>][<span class="stringliteral">&#39;parameters&#39;</span>] = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1596</span>                }</div>
<div class="line"><span class="lineno"> 1597</span>        }</div>
<div class="line"><span class="lineno"> 1598</span> </div>
<div class="line"><span class="lineno"> 1599</span>        $asn1 = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__ASN1.html">File_ASN1</a>();</div>
<div class="line"><span class="lineno"> 1600</span>        $asn1-&gt;loadOIDs($this-&gt;oids);</div>
<div class="line"><span class="lineno"> 1601</span> </div>
<div class="line"><span class="lineno"> 1602</span>        $filters = array();</div>
<div class="line"><span class="lineno"> 1603</span>        $type_utf8_string = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>);</div>
<div class="line"><span class="lineno"> 1604</span>        $filters[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;signature&#39;</span>][<span class="stringliteral">&#39;parameters&#39;</span>] = $type_utf8_string;</div>
<div class="line"><span class="lineno"> 1605</span>        $filters[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;signature&#39;</span>][<span class="stringliteral">&#39;issuer&#39;</span>][<span class="stringliteral">&#39;rdnSequence&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>] = $type_utf8_string;</div>
<div class="line"><span class="lineno"> 1606</span>        $filters[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;issuer&#39;</span>][<span class="stringliteral">&#39;rdnSequence&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>] = $type_utf8_string;</div>
<div class="line"><span class="lineno"> 1607</span>        $filters[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>][<span class="stringliteral">&#39;rdnSequence&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>] = $type_utf8_string;</div>
<div class="line"><span class="lineno"> 1608</span>        $filters[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>][<span class="stringliteral">&#39;parameters&#39;</span>] = $type_utf8_string;</div>
<div class="line"><span class="lineno"> 1609</span>        $filters[<span class="stringliteral">&#39;signatureAlgorithm&#39;</span>][<span class="stringliteral">&#39;parameters&#39;</span>] = $type_utf8_string;</div>
<div class="line"><span class="lineno"> 1610</span>        $filters[<span class="stringliteral">&#39;authorityCertIssuer&#39;</span>][<span class="stringliteral">&#39;directoryName&#39;</span>][<span class="stringliteral">&#39;rdnSequence&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>] = $type_utf8_string;</div>
<div class="line"><span class="lineno"> 1611</span>        <span class="comment">//$filters[&#39;policyQualifiers&#39;][&#39;qualifier&#39;] = $type_utf8_string;</span></div>
<div class="line"><span class="lineno"> 1612</span>        $filters[<span class="stringliteral">&#39;distributionPoint&#39;</span>][<span class="stringliteral">&#39;fullName&#39;</span>][<span class="stringliteral">&#39;directoryName&#39;</span>][<span class="stringliteral">&#39;rdnSequence&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>] = $type_utf8_string;</div>
<div class="line"><span class="lineno"> 1613</span>        $filters[<span class="stringliteral">&#39;directoryName&#39;</span>][<span class="stringliteral">&#39;rdnSequence&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>] = $type_utf8_string;</div>
<div class="line"><span class="lineno"> 1614</span> </div>
<div class="line"><span class="lineno"> 1615</span>        <span class="comment">/* in the case of policyQualifiers/qualifier, the type has to be FILE_ASN1_TYPE_IA5_STRING.</span></div>
<div class="line"><span class="lineno"> 1616</span><span class="comment">           FILE_ASN1_TYPE_PRINTABLE_STRING will cause OpenSSL&#39;s X.509 parser to spit out random</span></div>
<div class="line"><span class="lineno"> 1617</span><span class="comment">           characters.</span></div>
<div class="line"><span class="lineno"> 1618</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 1619</span>        $filters[<span class="stringliteral">&#39;policyQualifiers&#39;</span>][<span class="stringliteral">&#39;qualifier&#39;</span>]</div>
<div class="line"><span class="lineno"> 1620</span>            = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a>);</div>
<div class="line"><span class="lineno"> 1621</span> </div>
<div class="line"><span class="lineno"> 1622</span>        $asn1-&gt;loadFilters($filters);</div>
<div class="line"><span class="lineno"> 1623</span> </div>
<div class="line"><span class="lineno"> 1624</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc612875837ae70595137c6166f90106">_mapOutExtensions</a>($cert, <span class="stringliteral">&#39;tbsCertificate/extensions&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 1625</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c">_mapOutDNs</a>($cert, <span class="stringliteral">&#39;tbsCertificate/issuer/rdnSequence&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 1626</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c">_mapOutDNs</a>($cert, <span class="stringliteral">&#39;tbsCertificate/subject/rdnSequence&#39;</span>, $asn1);</div>
<div class="line"><span class="lineno"> 1627</span> </div>
<div class="line"><span class="lineno"> 1628</span>        $cert = $asn1-&gt;encodeDER($cert, $this-&gt;Certificate);</div>
<div class="line"><span class="lineno"> 1629</span> </div>
<div class="line"><span class="lineno"> 1630</span>        <span class="keywordflow">switch</span> ($format) {</div>
<div class="line"><span class="lineno"> 1631</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="X509_8php.html#a2418178d5c6bdae785f3e9f3583ba354">FILE_X509_FORMAT_DER</a>:</div>
<div class="line"><span class="lineno"> 1632</span>                <span class="keywordflow">return</span> $cert;</div>
<div class="line"><span class="lineno"> 1633</span>            <span class="comment">// case FILE_X509_FORMAT_PEM:</span></div>
<div class="line"><span class="lineno"> 1634</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1635</span>                <span class="keywordflow">return</span> <span class="stringliteral">&quot;-----BEGIN CERTIFICATE-----\r\n&quot;</span> . chunk_split(base64_encode($cert), 64) . <span class="stringliteral">&#39;-----END CERTIFICATE-----&#39;</span>;</div>
<div class="line"><span class="lineno"> 1636</span>        }</div>
<div class="line"><span class="lineno"> 1637</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l01881">_mapOutDNs()</a>, <a class="el" href="X509_8php_source.html#l01701">_mapOutExtensions()</a>, <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>, <a class="el" href="ASN1_8php_source.html#l00086">FILE_ASN1_TYPE_IA5_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00071">FILE_ASN1_TYPE_UTF8_STRING</a>, and <a class="el" href="X509_8php_source.html#l00106">FILE_X509_FORMAT_DER</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l03684">sign()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_af8e8019a921e4c0651e807c7c1644fcc_cgraph.png" border="0" usemap="#aclassFile__X509_af8e8019a921e4c0651e807c7c1644fcc_cgraph" alt=""/></div>
<map name="aclassFile__X509_af8e8019a921e4c0651e807c7c1644fcc_cgraph" id="aclassFile__X509_af8e8019a921e4c0651e807c7c1644fcc_cgraph">
<area shape="rect" title="Save X.509 certificate." alt="" coords="5,55,92,80"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="162,55,270,80"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="350,55,437,80"/>
<area shape="rect" href="classFile__X509.html#afc612875837ae70595137c6166f90106" title="Map extension values from extension&#45;specific internal format to octet string." alt="" coords="140,5,292,31"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="340,5,447,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_af8e8019a921e4c0651e807c7c1644fcc_icgraph.png" border="0" usemap="#aclassFile__X509_af8e8019a921e4c0651e807c7c1644fcc_icgraph" alt=""/></div>
<map name="aclassFile__X509_af8e8019a921e4c0651e807c7c1644fcc_icgraph" id="aclassFile__X509_af8e8019a921e4c0651e807c7c1644fcc_icgraph">
<area shape="rect" title="Save X.509 certificate." alt="" coords="103,5,189,31"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="5,5,55,31"/>
</map>
</div>

</div>
</div>
<a id="a4c4215dc2b69bac52080d9f174dbfcd6" name="a4c4215dc2b69bac52080d9f174dbfcd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c4215dc2b69bac52080d9f174dbfcd6">&#9670;&#160;</a></span>setAttribute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setAttribute </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$disposition</em> = <code><a class="el" href="X509_8php.html#a00c13d4a694558e4a9b24ed9e5462a8e">FILE_X509_ATTR_ALL</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a CSR attribute. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$id</td><td></td></tr>
    <tr><td class="paramtype">mixed</td><td class="paramname">$value</td><td></td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$disposition</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04685">4685</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4686</span>    {</div>
<div class="line"><span class="lineno"> 4687</span>        $attributes = &amp;$this-&gt;_subArray($this-&gt;currentCert, <span class="stringliteral">&#39;certificationRequestInfo/attributes&#39;</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 4688</span> </div>
<div class="line"><span class="lineno"> 4689</span>        <span class="keywordflow">if</span> (!is_array($attributes)) {</div>
<div class="line"><span class="lineno"> 4690</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4691</span>        }</div>
<div class="line"><span class="lineno"> 4692</span> </div>
<div class="line"><span class="lineno"> 4693</span>        <span class="keywordflow">switch</span> ($disposition) {</div>
<div class="line"><span class="lineno"> 4694</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="X509_8php.html#ad766ad0de320dd5b44de47ef51cb773e">FILE_X509_ATTR_REPLACE</a>:</div>
<div class="line"><span class="lineno"> 4695</span>                $disposition = <a class="code hl_variable" href="X509_8php.html#a2680c288fb1c165acb2843b0ad8b3395">FILE_X509_ATTR_APPEND</a>;</div>
<div class="line"><span class="lineno"> 4696</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="X509_8php.html#a00c13d4a694558e4a9b24ed9e5462a8e">FILE_X509_ATTR_ALL</a>:</div>
<div class="line"><span class="lineno"> 4697</span>                $this-&gt;removeAttribute($id);</div>
<div class="line"><span class="lineno"> 4698</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4699</span>        }</div>
<div class="line"><span class="lineno"> 4700</span> </div>
<div class="line"><span class="lineno"> 4701</span>        <span class="keywordflow">foreach</span> ($attributes as $key =&gt; $attribute) {</div>
<div class="line"><span class="lineno"> 4702</span>            <span class="keywordflow">if</span> ($attribute[<span class="stringliteral">&#39;type&#39;</span>] == $id) {</div>
<div class="line"><span class="lineno"> 4703</span>                $n = count($attribute[<span class="stringliteral">&#39;value&#39;</span>]);</div>
<div class="line"><span class="lineno"> 4704</span>                <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 4705</span>                    <span class="keywordflow">case</span> $disposition == <a class="code hl_variable" href="X509_8php.html#a2680c288fb1c165acb2843b0ad8b3395">FILE_X509_ATTR_APPEND</a>:</div>
<div class="line"><span class="lineno"> 4706</span>                        $last = $key;</div>
<div class="line"><span class="lineno"> 4707</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4708</span>                    <span class="keywordflow">case</span> $disposition &gt;= $n:</div>
<div class="line"><span class="lineno"> 4709</span>                        $disposition -= $n;</div>
<div class="line"><span class="lineno"> 4710</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4711</span>                    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 4712</span>                        $attributes[$key][<span class="stringliteral">&#39;value&#39;</span>][$disposition] = $value;</div>
<div class="line"><span class="lineno"> 4713</span>                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4714</span>                }</div>
<div class="line"><span class="lineno"> 4715</span>            }</div>
<div class="line"><span class="lineno"> 4716</span>        }</div>
<div class="line"><span class="lineno"> 4717</span> </div>
<div class="line"><span class="lineno"> 4718</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 4719</span>            <span class="keywordflow">case</span> $disposition &gt;= 0:</div>
<div class="line"><span class="lineno"> 4720</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4721</span>            <span class="keywordflow">case</span> isset($last):</div>
<div class="line"><span class="lineno"> 4722</span>                $attributes[$last][<span class="stringliteral">&#39;value&#39;</span>][] = $value;</div>
<div class="line"><span class="lineno"> 4723</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4724</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 4725</span>                $attributes[] = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; $id, <span class="stringliteral">&#39;value&#39;</span> =&gt; $disposition == <a class="code hl_variable" href="X509_8php.html#a00c13d4a694558e4a9b24ed9e5462a8e">FILE_X509_ATTR_ALL</a> ? $value: array($value));</div>
<div class="line"><span class="lineno"> 4726</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4727</span>        }</div>
<div class="line"><span class="lineno"> 4728</span> </div>
<div class="line"><span class="lineno"> 4729</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4730</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>, <a class="el" href="X509_8php_source.html#l00125">FILE_X509_ATTR_ALL</a>, <a class="el" href="X509_8php_source.html#l00126">FILE_X509_ATTR_APPEND</a>, <a class="el" href="X509_8php_source.html#l00127">FILE_X509_ATTR_REPLACE</a>, and <a class="el" href="X509_8php_source.html#l04567">removeAttribute()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a4c4215dc2b69bac52080d9f174dbfcd6_cgraph.png" border="0" usemap="#aclassFile__X509_a4c4215dc2b69bac52080d9f174dbfcd6_cgraph" alt=""/></div>
<map name="aclassFile__X509_a4c4215dc2b69bac52080d9f174dbfcd6_cgraph" id="aclassFile__X509_a4c4215dc2b69bac52080d9f174dbfcd6_cgraph">
<area shape="rect" title="Set a CSR attribute." alt="" coords="5,5,104,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="329,5,416,31"/>
<area shape="rect" href="classFile__X509.html#acd0554eb35727bf8349119bc5a239059" title="Remove a CSR attribute." alt="" coords="152,31,281,56"/>
</map>
</div>

</div>
</div>
<a id="a76217009a68266241eea571101a61d8a" name="a76217009a68266241eea571101a61d8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76217009a68266241eea571101a61d8a">&#9670;&#160;</a></span>setChallenge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setChallenge </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$challenge</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set challenge. </p>
<p>Used for SPKAC CSR's</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$challenge</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03200">3200</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3201</span>    {</div>
<div class="line"><span class="lineno"> 3202</span>        $this-&gt;challenge = $challenge;</div>
<div class="line"><span class="lineno"> 3203</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab442ee31015d58a277f52d5293a00106" name="ab442ee31015d58a277f52d5293a00106"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab442ee31015d58a277f52d5293a00106">&#9670;&#160;</a></span>setDN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setDN </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$dn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$merge</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$type</em> = <code>'utf8String'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a Distinguished Name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">mixed</td><td class="paramname">$dn</td><td></td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$merge</td><td>optional </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$type</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02840">2840</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2841</span>    {</div>
<div class="line"><span class="lineno"> 2842</span>        <span class="keywordflow">if</span> (!$merge) {</div>
<div class="line"><span class="lineno"> 2843</span>            $this-&gt;dn = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 2844</span>        }</div>
<div class="line"><span class="lineno"> 2845</span> </div>
<div class="line"><span class="lineno"> 2846</span>        <span class="keywordflow">if</span> (is_array($dn)) {</div>
<div class="line"><span class="lineno"> 2847</span>            <span class="keywordflow">if</span> (isset($dn[<span class="stringliteral">&#39;rdnSequence&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2848</span>                $this-&gt;dn = $dn; <span class="comment">// No merge here.</span></div>
<div class="line"><span class="lineno"> 2849</span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2850</span>            }</div>
<div class="line"><span class="lineno"> 2851</span> </div>
<div class="line"><span class="lineno"> 2852</span>            <span class="comment">// handles stuff generated by openssl_x509_parse()</span></div>
<div class="line"><span class="lineno"> 2853</span>            <span class="keywordflow">foreach</span> ($dn as $prop =&gt; $value) {</div>
<div class="line"><span class="lineno"> 2854</span>                <span class="keywordflow">if</span> (!$this-&gt;<a class="code hl_function" href="classFile__X509.html#a6d9811e02579bdb0c26bb527232e79b0">setDNProp</a>($prop, $value, $type)) {</div>
<div class="line"><span class="lineno"> 2855</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2856</span>                }</div>
<div class="line"><span class="lineno"> 2857</span>            }</div>
<div class="line"><span class="lineno"> 2858</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2859</span>        }</div>
<div class="line"><span class="lineno"> 2860</span> </div>
<div class="line"><span class="lineno"> 2861</span>        <span class="comment">// handles everything else</span></div>
<div class="line"><span class="lineno"> 2862</span>        $results = preg_split(<span class="stringliteral">&#39;#((?:^|, *|/)(?:C=|O=|OU=|CN=|L=|ST=|SN=|postalCode=|streetAddress=|emailAddress=|serialNumber=|organizationalUnitName=|title=|description=|role=|x500UniqueIdentifier=|postalAddress=))#&#39;</span>, $dn, -1, PREG_SPLIT_DELIM_CAPTURE);</div>
<div class="line"><span class="lineno"> 2863</span>        <span class="keywordflow">for</span> ($i = 1; $i &lt; count($results); $i+=2) {</div>
<div class="line"><span class="lineno"> 2864</span>            $prop = trim($results[$i], <span class="stringliteral">&#39;, =/&#39;</span>);</div>
<div class="line"><span class="lineno"> 2865</span>            $value = $results[$i + 1];</div>
<div class="line"><span class="lineno"> 2866</span>            <span class="keywordflow">if</span> (!$this-&gt;<a class="code hl_function" href="classFile__X509.html#a6d9811e02579bdb0c26bb527232e79b0">setDNProp</a>($prop, $value, $type)) {</div>
<div class="line"><span class="lineno"> 2867</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2868</span>            }</div>
<div class="line"><span class="lineno"> 2869</span>        }</div>
<div class="line"><span class="lineno"> 2870</span> </div>
<div class="line"><span class="lineno"> 2871</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2872</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_a6d9811e02579bdb0c26bb527232e79b0"><div class="ttname"><a href="classFile__X509.html#a6d9811e02579bdb0c26bb527232e79b0">File_X509\setDNProp</a></div><div class="ttdeci">setDNProp($propName, $propValue, $type='utf8String')</div><div class="ttdoc">Set a Distinguished Name property.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l02711">X509.php:2711</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l02711">setDNProp()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ab442ee31015d58a277f52d5293a00106_cgraph.png" border="0" usemap="#aclassFile__X509_ab442ee31015d58a277f52d5293a00106_cgraph" alt=""/></div>
<map name="aclassFile__X509_ab442ee31015d58a277f52d5293a00106_cgraph" id="aclassFile__X509_ab442ee31015d58a277f52d5293a00106_cgraph">
<area shape="rect" title="Set a Distinguished Name." alt="" coords="5,5,68,31"/>
<area shape="rect" href="classFile__X509.html#a6d9811e02579bdb0c26bb527232e79b0" title="Set a Distinguished Name property." alt="" coords="116,5,207,31"/>
<area shape="rect" href="classFile__X509.html#ad4e0267f8e236f9707325bce89ce2b0a" title="&quot;Normalizes&quot; a Distinguished Name property" alt="" coords="255,5,391,31"/>
</map>
</div>

</div>
</div>
<a id="a6d9811e02579bdb0c26bb527232e79b0" name="a6d9811e02579bdb0c26bb527232e79b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d9811e02579bdb0c26bb527232e79b0">&#9670;&#160;</a></span>setDNProp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setDNProp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$propName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$propValue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$type</em> = <code>'utf8String'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a Distinguished Name property. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$propName</td><td></td></tr>
    <tr><td class="paramtype">mixed</td><td class="paramname">$propValue</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$type</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02711">2711</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2712</span>    {</div>
<div class="line"><span class="lineno"> 2713</span>        <span class="keywordflow">if</span> (empty($this-&gt;dn)) {</div>
<div class="line"><span class="lineno"> 2714</span>            $this-&gt;dn = array(<span class="stringliteral">&#39;rdnSequence&#39;</span> =&gt; array());</div>
<div class="line"><span class="lineno"> 2715</span>        }</div>
<div class="line"><span class="lineno"> 2716</span> </div>
<div class="line"><span class="lineno"> 2717</span>        <span class="keywordflow">if</span> (($propName = $this-&gt;_translateDNProp($propName)) === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2718</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2719</span>        }</div>
<div class="line"><span class="lineno"> 2720</span> </div>
<div class="line"><span class="lineno"> 2721</span>        <span class="keywordflow">foreach</span> ((array) $propValue as $v) {</div>
<div class="line"><span class="lineno"> 2722</span>            <span class="keywordflow">if</span> (!is_array($v) &amp;&amp; isset($type)) {</div>
<div class="line"><span class="lineno"> 2723</span>                $v = array($type =&gt; $v);</div>
<div class="line"><span class="lineno"> 2724</span>            }</div>
<div class="line"><span class="lineno"> 2725</span>            $this-&gt;dn[<span class="stringliteral">&#39;rdnSequence&#39;</span>][] = array(</div>
<div class="line"><span class="lineno"> 2726</span>                array(</div>
<div class="line"><span class="lineno"> 2727</span>                    <span class="stringliteral">&#39;type&#39;</span> =&gt; $propName,</div>
<div class="line"><span class="lineno"> 2728</span>                    <span class="stringliteral">&#39;value&#39;</span>=&gt; $v</div>
<div class="line"><span class="lineno"> 2729</span>                )</div>
<div class="line"><span class="lineno"> 2730</span>            );</div>
<div class="line"><span class="lineno"> 2731</span>        }</div>
<div class="line"><span class="lineno"> 2732</span> </div>
<div class="line"><span class="lineno"> 2733</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2734</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l02617">_translateDNProp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l02840">setDN()</a>, and <a class="el" href="X509_8php_source.html#l04875">setDomain()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a6d9811e02579bdb0c26bb527232e79b0_cgraph.png" border="0" usemap="#aclassFile__X509_a6d9811e02579bdb0c26bb527232e79b0_cgraph" alt=""/></div>
<map name="aclassFile__X509_a6d9811e02579bdb0c26bb527232e79b0_cgraph" id="aclassFile__X509_a6d9811e02579bdb0c26bb527232e79b0_cgraph">
<area shape="rect" title="Set a Distinguished Name property." alt="" coords="5,5,96,31"/>
<area shape="rect" href="classFile__X509.html#ad4e0267f8e236f9707325bce89ce2b0a" title="&quot;Normalizes&quot; a Distinguished Name property" alt="" coords="144,5,280,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a6d9811e02579bdb0c26bb527232e79b0_icgraph.png" border="0" usemap="#aclassFile__X509_a6d9811e02579bdb0c26bb527232e79b0_icgraph" alt=""/></div>
<map name="aclassFile__X509_a6d9811e02579bdb0c26bb527232e79b0_icgraph" id="aclassFile__X509_a6d9811e02579bdb0c26bb527232e79b0_icgraph">
<area shape="rect" title="Set a Distinguished Name property." alt="" coords="147,31,237,56"/>
<area shape="rect" href="classFile__X509.html#ab442ee31015d58a277f52d5293a00106" title="Set a Distinguished Name." alt="" coords="21,5,83,31"/>
<area shape="rect" href="classFile__X509.html#ab2400a644664fad908c8bd05995f6c8c" title="Set the domain name&#39;s which the cert is to be valid for." alt="" coords="5,55,99,80"/>
</map>
</div>

</div>
</div>
<a id="ab2400a644664fad908c8bd05995f6c8c" name="ab2400a644664fad908c8bd05995f6c8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2400a644664fad908c8bd05995f6c8c">&#9670;&#160;</a></span>setDomain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setDomain </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the domain name's which the cert is to be valid for. </p>
<p>@access public </p><dl class="section return"><dt>Returns</dt><dd>array </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04875">4875</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4876</span>    {</div>
<div class="line"><span class="lineno"> 4877</span>        $this-&gt;domains = func_get_args();</div>
<div class="line"><span class="lineno"> 4878</span>        $this-&gt;removeDNProp(<span class="stringliteral">&#39;id-at-commonName&#39;</span>);</div>
<div class="line"><span class="lineno"> 4879</span>        $this-&gt;setDNProp(<span class="stringliteral">&#39;id-at-commonName&#39;</span>, $this-&gt;domains[0]);</div>
<div class="line"><span class="lineno"> 4880</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l02742">removeDNProp()</a>, and <a class="el" href="X509_8php_source.html#l02711">setDNProp()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ab2400a644664fad908c8bd05995f6c8c_cgraph.png" border="0" usemap="#aclassFile__X509_ab2400a644664fad908c8bd05995f6c8c_cgraph" alt=""/></div>
<map name="aclassFile__X509_ab2400a644664fad908c8bd05995f6c8c_cgraph" id="aclassFile__X509_ab2400a644664fad908c8bd05995f6c8c_cgraph">
<area shape="rect" title="Set the domain name&#39;s which the cert is to be valid for." alt="" coords="5,31,99,56"/>
<area shape="rect" href="classFile__X509.html#a65782113764c16cb36982e9b29b24fbd" title="Remove Distinguished Name properties." alt="" coords="147,5,268,31"/>
<area shape="rect" href="classFile__X509.html#a6d9811e02579bdb0c26bb527232e79b0" title="Set a Distinguished Name property." alt="" coords="162,55,253,80"/>
<area shape="rect" href="classFile__X509.html#ad4e0267f8e236f9707325bce89ce2b0a" title="&quot;Normalizes&quot; a Distinguished Name property" alt="" coords="316,31,452,56"/>
</map>
</div>

</div>
</div>
<a id="a74ed2723b9e17798ebd125edcd14cabe" name="a74ed2723b9e17798ebd125edcd14cabe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74ed2723b9e17798ebd125edcd14cabe">&#9670;&#160;</a></span>setEndDate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setEndDate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$date</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set certificate end date. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$date</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04182">4182</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4183</span>    {</div>
<div class="line"><span class="lineno"> 4184</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 4185</span><span class="comment">          To indicate that a certificate has no well-defined expiration date,</span></div>
<div class="line"><span class="lineno"> 4186</span><span class="comment">          the notAfter SHOULD be assigned the GeneralizedTime value of</span></div>
<div class="line"><span class="lineno"> 4187</span><span class="comment">          99991231235959Z.</span></div>
<div class="line"><span class="lineno"> 4188</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 4189</span><span class="comment">          -- http://tools.ietf.org/html/rfc5280#section-4.1.2.5</span></div>
<div class="line"><span class="lineno"> 4190</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 4191</span>        <span class="keywordflow">if</span> (strtolower($date) == <span class="stringliteral">&#39;lifetime&#39;</span>) {</div>
<div class="line"><span class="lineno"> 4192</span>            $temp = <span class="stringliteral">&#39;99991231235959Z&#39;</span>;</div>
<div class="line"><span class="lineno"> 4193</span>            $asn1 = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceFile__ASN1.html">File_ASN1</a>();</div>
<div class="line"><span class="lineno"> 4194</span>            $temp = chr(<a class="code hl_variable" href="ASN1_8php.html#a8ad0c6d6389ce6c6fb2e633814cbfd42">FILE_ASN1_TYPE_GENERALIZED_TIME</a>) . $asn1-&gt;_encodeLength(strlen($temp)) . $temp;</div>
<div class="line"><span class="lineno"> 4195</span>            $this-&gt;endDate = <span class="keyword">new</span> <a class="code hl_class" href="classFile__ASN1__Element.html">File_ASN1_Element</a>($temp);</div>
<div class="line"><span class="lineno"> 4196</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4197</span>            <span class="keywordflow">if</span> (class_exists(<span class="stringliteral">&#39;DateTime&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 4198</span>                $date = <span class="keyword">new</span> DateTime($date, <span class="keyword">new</span> DateTimeZone(@date_default_timezone_get()));</div>
<div class="line"><span class="lineno"> 4199</span>                $this-&gt;endDate = $date-&gt;format(<span class="stringliteral">&#39;D, d M Y H:i:s O&#39;</span>);</div>
<div class="line"><span class="lineno"> 4200</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4201</span>                $this-&gt;endDate = @date(<span class="stringliteral">&#39;D, d M Y H:i:s O&#39;</span>, @strtotime($date));</div>
<div class="line"><span class="lineno"> 4202</span>            }</div>
<div class="line"><span class="lineno"> 4203</span>        }</div>
<div class="line"><span class="lineno"> 4204</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ASN1_8php_source.html#l00088">FILE_ASN1_TYPE_GENERALIZED_TIME</a>.</p>

</div>
</div>
<a id="aec94c39b26c9f4af4efe2ebf74cd914f" name="aec94c39b26c9f4af4efe2ebf74cd914f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec94c39b26c9f4af4efe2ebf74cd914f">&#9670;&#160;</a></span>setExtension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setExtension </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$critical</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$replace</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a certificate, CSR or CRL Extension. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$id</td><td></td></tr>
    <tr><td class="paramtype">mixed</td><td class="paramname">$value</td><td></td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$critical</td><td>optional </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$replace</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04554">4554</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4555</span>    {</div>
<div class="line"><span class="lineno"> 4556</span>        <span class="keywordflow">return</span> $this-&gt;_setExtension($id, $value, $critical, $replace);</div>
<div class="line"><span class="lineno"> 4557</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04480">_setExtension()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l03684">sign()</a>, and <a class="el" href="X509_8php_source.html#l04004">signCRL()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_aec94c39b26c9f4af4efe2ebf74cd914f_cgraph.png" border="0" usemap="#aclassFile__X509_aec94c39b26c9f4af4efe2ebf74cd914f_cgraph" alt=""/></div>
<map name="aclassFile__X509_aec94c39b26c9f4af4efe2ebf74cd914f_cgraph" id="aclassFile__X509_aec94c39b26c9f4af4efe2ebf74cd914f_cgraph">
<area shape="rect" title="Set a certificate, CSR or CRL Extension." alt="" coords="5,5,112,31"/>
<area shape="rect" href="classFile__X509.html#a28a18c05603a638bcb114897dffeee6d" title="Set an Extension." alt="" coords="160,5,273,31"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="321,5,421,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="469,5,556,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_aec94c39b26c9f4af4efe2ebf74cd914f_icgraph.png" border="0" usemap="#aclassFile__X509_aec94c39b26c9f4af4efe2ebf74cd914f_icgraph" alt=""/></div>
<map name="aclassFile__X509_aec94c39b26c9f4af4efe2ebf74cd914f_icgraph" id="aclassFile__X509_aec94c39b26c9f4af4efe2ebf74cd914f_icgraph">
<area shape="rect" title="Set a certificate, CSR or CRL Extension." alt="" coords="128,31,235,56"/>
<area shape="rect" href="classFile__X509.html#a86265f41fc9ab04b810aa1a14a613477" title="Sign an X.509 certificate." alt="" coords="18,5,67,31"/>
<area shape="rect" href="classFile__X509.html#a2b25616309652968bc8a61f44415c14d" title="Sign a CRL." alt="" coords="5,55,80,80"/>
</map>
</div>

</div>
</div>
<a id="a9a1b0df6932e2aa9ee3bc0d0d5828a0d" name="a9a1b0df6932e2aa9ee3bc0d0d5828a0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a1b0df6932e2aa9ee3bc0d0d5828a0d">&#9670;&#160;</a></span>setIPAddress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setIPAddress </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the IP Addresses's which the cert is to be valid for. </p>
<p>@access public </p>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04887">4887</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4888</span>    {</div>
<div class="line"><span class="lineno"> 4889</span>        $this-&gt;ipAddresses = func_get_args();</div>
<div class="line"><span class="lineno"> 4890</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 4891</span><span class="comment">        if (!isset($this-&gt;domains)) {</span></div>
<div class="line"><span class="lineno"> 4892</span><span class="comment">            $this-&gt;removeDNProp(&#39;id-at-commonName&#39;);</span></div>
<div class="line"><span class="lineno"> 4893</span><span class="comment">            $this-&gt;setDNProp(&#39;id-at-commonName&#39;, $this-&gt;ipAddresses[0]);</span></div>
<div class="line"><span class="lineno"> 4894</span><span class="comment">        }</span></div>
<div class="line"><span class="lineno"> 4895</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 4896</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aac63bb2f2c855dd8f07d45bc07c864ba" name="aac63bb2f2c855dd8f07d45bc07c864ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac63bb2f2c855dd8f07d45bc07c864ba">&#9670;&#160;</a></span>setKeyIdentifier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setKeyIdentifier </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the subject key identifier. </p>
<p>This is used by the id-ce-authorityKeyIdentifier and the id-ce-subjectKeyIdentifier extensions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$value</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04740">4740</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4741</span>    {</div>
<div class="line"><span class="lineno"> 4742</span>        <span class="keywordflow">if</span> (empty($value)) {</div>
<div class="line"><span class="lineno"> 4743</span>            unset($this-&gt;currentKeyIdentifier);</div>
<div class="line"><span class="lineno"> 4744</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4745</span>            $this-&gt;currentKeyIdentifier = base64_encode($value);</div>
<div class="line"><span class="lineno"> 4746</span>        }</div>
<div class="line"><span class="lineno"> 4747</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4be1e2a17c9561456b1cf97f4b757578" name="a4be1e2a17c9561456b1cf97f4b757578"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4be1e2a17c9561456b1cf97f4b757578">&#9670;&#160;</a></span>setPrivateKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setPrivateKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set private key. </p>
<p>Key needs to be a <a class="el" href="classCrypt__RSA.html">Crypt_RSA</a> object</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">object</td><td class="paramname">$key</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03187">3187</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3188</span>    {</div>
<div class="line"><span class="lineno"> 3189</span>        $this-&gt;privateKey = $key;</div>
<div class="line"><span class="lineno"> 3190</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaef39adc2ced44086c735a1591449397" name="aaef39adc2ced44086c735a1591449397"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaef39adc2ced44086c735a1591449397">&#9670;&#160;</a></span>setPublicKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setPublicKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set public key. </p>
<p>Key needs to be a <a class="el" href="classCrypt__RSA.html">Crypt_RSA</a> object</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">object</td><td class="paramname">$key</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03173">3173</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3174</span>    {</div>
<div class="line"><span class="lineno"> 3175</span>        $key-&gt;setPublicKey();</div>
<div class="line"><span class="lineno"> 3176</span>        $this-&gt;publicKey = $key;</div>
<div class="line"><span class="lineno"> 3177</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3618fd30b8ecd74fba181990eafbf593" name="a3618fd30b8ecd74fba181990eafbf593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3618fd30b8ecd74fba181990eafbf593">&#9670;&#160;</a></span>setRecurLimit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setRecurLimit </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$count</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the recursion limit. </p>
<p>When validating a signature it may be necessary to download intermediate certs from URI's. An intermediate cert that linked to itself would result in an infinite loop so to prevent that we set a recursion limit. A negative number means that there is no recursion limit.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$count</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02511">2511</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2512</span>    {</div>
<div class="line"><span class="lineno"> 2513</span>        $this-&gt;recur_limit = $count;</div>
<div class="line"><span class="lineno"> 2514</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a28ba1f404bda71c06dc86b209616f53d" name="a28ba1f404bda71c06dc86b209616f53d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28ba1f404bda71c06dc86b209616f53d">&#9670;&#160;</a></span>setRevokedCertificateExtension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setRevokedCertificateExtension </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$serial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$critical</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$replace</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a Revoked Certificate Extension. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$serial</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$id</td><td></td></tr>
    <tr><td class="paramtype">mixed</td><td class="paramname">$value</td><td></td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$critical</td><td>optional </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$replace</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l05132">5132</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5133</span>    {</div>
<div class="line"><span class="lineno"> 5134</span>        <span class="keywordflow">if</span> (isset($this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 5135</span>            <span class="keywordflow">if</span> (is_array($rclist = &amp;$this-&gt;_subArray($this-&gt;currentCert, <span class="stringliteral">&#39;tbsCertList/revokedCertificates&#39;</span>, <span class="keyword">true</span>))) {</div>
<div class="line"><span class="lineno"> 5136</span>                <span class="keywordflow">if</span> (($i = $this-&gt;_revokedCertificate($rclist, $serial, <span class="keyword">true</span>)) !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 5137</span>                    <span class="keywordflow">return</span> $this-&gt;_setExtension($id, $value, $critical, $replace, <span class="stringliteral">&quot;tbsCertList/revokedCertificates/$i/crlEntryExtensions&quot;</span>);</div>
<div class="line"><span class="lineno"> 5138</span>                }</div>
<div class="line"><span class="lineno"> 5139</span>            }</div>
<div class="line"><span class="lineno"> 5140</span>        }</div>
<div class="line"><span class="lineno"> 5141</span> </div>
<div class="line"><span class="lineno"> 5142</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 5143</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04933">_revokedCertificate()</a>, <a class="el" href="X509_8php_source.html#l04480">_setExtension()</a>, and <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a28ba1f404bda71c06dc86b209616f53d_cgraph.png" border="0" usemap="#aclassFile__X509_a28ba1f404bda71c06dc86b209616f53d_cgraph" alt=""/></div>
<map name="aclassFile__X509_a28ba1f404bda71c06dc86b209616f53d_cgraph" id="aclassFile__X509_a28ba1f404bda71c06dc86b209616f53d_cgraph">
<area shape="rect" title="Set a Revoked Certificate Extension." alt="" coords="5,55,235,80"/>
<area shape="rect" href="classFile__X509.html#a8fd951ac4d21092f644bd6528c171bcb" title="Get the index of a revoked certificate." alt="" coords="283,5,431,31"/>
<area shape="rect" href="classFile__X509.html#a28a18c05603a638bcb114897dffeee6d" title="Set an Extension." alt="" coords="300,55,413,80"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="627,80,713,105"/>
<area shape="rect" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089" title="Helper function to build a time field according to RFC 3280 section." alt="" coords="483,5,574,31"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="479,55,579,80"/>
</map>
</div>

</div>
</div>
<a id="a023813c1e45a58d395510f3f4364c63a" name="a023813c1e45a58d395510f3f4364c63a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a023813c1e45a58d395510f3f4364c63a">&#9670;&#160;</a></span>setSerialNumber()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setSerialNumber </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$serial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$base</em> = <code>-256</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set Serial Number. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$serial</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$base</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04213">4213</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4214</span>    {</div>
<div class="line"><span class="lineno"> 4215</span>        $this-&gt;serialNumber = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($serial, $base);</div>
<div class="line"><span class="lineno"> 4216</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a16ffe0459baa9ea1ddb9e1e8491a10a6" name="a16ffe0459baa9ea1ddb9e1e8491a10a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16ffe0459baa9ea1ddb9e1e8491a10a6">&#9670;&#160;</a></span>setStartDate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setStartDate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$date</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set certificate start date. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$date</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04166">4166</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4167</span>    {</div>
<div class="line"><span class="lineno"> 4168</span>        <span class="keywordflow">if</span> (class_exists(<span class="stringliteral">&#39;DateTime&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 4169</span>            $date = <span class="keyword">new</span> DateTime($date, <span class="keyword">new</span> DateTimeZone(@date_default_timezone_get()));</div>
<div class="line"><span class="lineno"> 4170</span>            $this-&gt;startDate = $date-&gt;format(<span class="stringliteral">&#39;D, d M Y H:i:s O&#39;</span>);</div>
<div class="line"><span class="lineno"> 4171</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4172</span>            $this-&gt;startDate = @date(<span class="stringliteral">&#39;D, d M Y H:i:s O&#39;</span>, @strtotime($date));</div>
<div class="line"><span class="lineno"> 4173</span>        }</div>
<div class="line"><span class="lineno"> 4174</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a86265f41fc9ab04b810aa1a14a613477" name="a86265f41fc9ab04b810aa1a14a613477"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86265f41fc9ab04b810aa1a14a613477">&#9670;&#160;</a></span>sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sign </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$issuer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$subject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$signatureAlgorithm</em> = <code>'sha1WithRSAEncryption'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sign an X.509 certificate. </p>
<p>$issuer's private key needs to be loaded. $subject can be either an existing X.509 cert (if you want to resign it), a CSR or something with the DN and public key explicitly set.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="classFile__X509.html">File_X509</a></td><td class="paramname">$issuer</td><td></td></tr>
    <tr><td class="paramtype"><a class="el" href="classFile__X509.html">File_X509</a></td><td class="paramname">$subject</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$signatureAlgorithm</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03684">3684</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3685</span>    {</div>
<div class="line"><span class="lineno"> 3686</span>        global <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>;</div>
<div class="line"><span class="lineno"> 3687</span> </div>
<div class="line"><span class="lineno"> 3688</span>        <span class="keywordflow">if</span> (!is_object($issuer-&gt;privateKey) || empty($issuer-&gt;dn)) {</div>
<div class="line"><span class="lineno"> 3689</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3690</span>        }</div>
<div class="line"><span class="lineno"> 3691</span> </div>
<div class="line"><span class="lineno"> 3692</span>        <span class="keywordflow">if</span> (isset($subject-&gt;publicKey) &amp;&amp; !($subjectPublicKey = $subject-&gt;_formatSubjectPublicKey())) {</div>
<div class="line"><span class="lineno"> 3693</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3694</span>        }</div>
<div class="line"><span class="lineno"> 3695</span> </div>
<div class="line"><span class="lineno"> 3696</span>        <a class="code hl_variable" href="classFile__X509.html#a13ce82673cd9b9e0aebbd6c10010a686">$currentCert</a> = isset($this-&gt;currentCert) ? $this-&gt;currentCert : <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 3697</span>        <a class="code hl_variable" href="classFile__X509.html#abc5038cc6c10571997d5cef6f7c85782">$signatureSubject</a> = isset($this-&gt;signatureSubject) ? $this-&gt;signatureSubject: <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 3698</span> </div>
<div class="line"><span class="lineno"> 3699</span>        <span class="keywordflow">if</span> (isset($subject-&gt;currentCert) &amp;&amp; is_array($subject-&gt;currentCert) &amp;&amp; isset($subject-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 3700</span>            $this-&gt;currentCert = $subject-&gt;currentCert;</div>
<div class="line"><span class="lineno"> 3701</span>            $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;signature&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>] = $signatureAlgorithm;</div>
<div class="line"><span class="lineno"> 3702</span>            $this-&gt;currentCert[<span class="stringliteral">&#39;signatureAlgorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>] = $signatureAlgorithm;</div>
<div class="line"><span class="lineno"> 3703</span> </div>
<div class="line"><span class="lineno"> 3704</span>            <span class="keywordflow">if</span> (!empty($this-&gt;startDate)) {</div>
<div class="line"><span class="lineno"> 3705</span>                $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;validity&#39;</span>][<span class="stringliteral">&#39;notBefore&#39;</span>] = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089">_timeField</a>($this-&gt;startDate);</div>
<div class="line"><span class="lineno"> 3706</span>            }</div>
<div class="line"><span class="lineno"> 3707</span>            <span class="keywordflow">if</span> (!empty($this-&gt;endDate)) {</div>
<div class="line"><span class="lineno"> 3708</span>                $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;validity&#39;</span>][<span class="stringliteral">&#39;notAfter&#39;</span>] = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089">_timeField</a>($this-&gt;endDate);</div>
<div class="line"><span class="lineno"> 3709</span>            }</div>
<div class="line"><span class="lineno"> 3710</span>            <span class="keywordflow">if</span> (!empty($this-&gt;serialNumber)) {</div>
<div class="line"><span class="lineno"> 3711</span>                $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;serialNumber&#39;</span>] = $this-&gt;serialNumber;</div>
<div class="line"><span class="lineno"> 3712</span>            }</div>
<div class="line"><span class="lineno"> 3713</span>            <span class="keywordflow">if</span> (!empty($subject-&gt;dn)) {</div>
<div class="line"><span class="lineno"> 3714</span>                $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>] = $subject-&gt;dn;</div>
<div class="line"><span class="lineno"> 3715</span>            }</div>
<div class="line"><span class="lineno"> 3716</span>            <span class="keywordflow">if</span> (!empty($subject-&gt;publicKey)) {</div>
<div class="line"><span class="lineno"> 3717</span>                $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span>] = $subjectPublicKey;</div>
<div class="line"><span class="lineno"> 3718</span>            }</div>
<div class="line"><span class="lineno"> 3719</span>            $this-&gt;<a class="code hl_function" href="classFile__X509.html#aa75a9d891292eeddcbf00060e36c0695">removeExtension</a>(<span class="stringliteral">&#39;id-ce-authorityKeyIdentifier&#39;</span>);</div>
<div class="line"><span class="lineno"> 3720</span>            <span class="keywordflow">if</span> (isset($subject-&gt;domains)) {</div>
<div class="line"><span class="lineno"> 3721</span>                $this-&gt;<a class="code hl_function" href="classFile__X509.html#aa75a9d891292eeddcbf00060e36c0695">removeExtension</a>(<span class="stringliteral">&#39;id-ce-subjectAltName&#39;</span>);</div>
<div class="line"><span class="lineno"> 3722</span>            }</div>
<div class="line"><span class="lineno"> 3723</span>        } elseif (isset($subject-&gt;currentCert) &amp;&amp; is_array($subject-&gt;currentCert) &amp;&amp; isset($subject-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 3724</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3725</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3726</span>            <span class="keywordflow">if</span> (!isset($subject-&gt;publicKey)) {</div>
<div class="line"><span class="lineno"> 3727</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3728</span>            }</div>
<div class="line"><span class="lineno"> 3729</span> </div>
<div class="line"><span class="lineno"> 3730</span>            <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;DateTime&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 3731</span>                <a class="code hl_variable" href="classFile__X509.html#a288a4b22573d5731fe3f52c55263c5f3">$startDate</a> = !empty($this-&gt;startDate) ? $this-&gt;startDate : @date(<span class="stringliteral">&#39;D, d M Y H:i:s O&#39;</span>);</div>
<div class="line"><span class="lineno"> 3732</span>                <a class="code hl_variable" href="classFile__X509.html#a398d961fce9d555095d8e8251c060465">$endDate</a> = !empty($this-&gt;endDate) ? $this-&gt;endDate : @date(<span class="stringliteral">&#39;D, d M Y H:i:s O&#39;</span>, strtotime(<span class="stringliteral">&#39;+1 year&#39;</span>));</div>
<div class="line"><span class="lineno"> 3733</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3734</span>                <a class="code hl_variable" href="classFile__X509.html#a288a4b22573d5731fe3f52c55263c5f3">$startDate</a> = <span class="keyword">new</span> DateTime(<span class="stringliteral">&#39;now&#39;</span>, <span class="keyword">new</span> DateTimeZone(@date_default_timezone_get()));</div>
<div class="line"><span class="lineno"> 3735</span>                <a class="code hl_variable" href="classFile__X509.html#a288a4b22573d5731fe3f52c55263c5f3">$startDate</a> = !empty($this-&gt;startDate) ? $this-&gt;startDate : <a class="code hl_variable" href="classFile__X509.html#a288a4b22573d5731fe3f52c55263c5f3">$startDate</a>-&gt;format(<span class="stringliteral">&#39;D, d M Y H:i:s O&#39;</span>);</div>
<div class="line"><span class="lineno"> 3736</span> </div>
<div class="line"><span class="lineno"> 3737</span>                <a class="code hl_variable" href="classFile__X509.html#a398d961fce9d555095d8e8251c060465">$endDate</a> = <span class="keyword">new</span> DateTime(<span class="stringliteral">&#39;+1 year&#39;</span>, <span class="keyword">new</span> DateTimeZone(@date_default_timezone_get()));</div>
<div class="line"><span class="lineno"> 3738</span>                <a class="code hl_variable" href="classFile__X509.html#a398d961fce9d555095d8e8251c060465">$endDate</a> = !empty($this-&gt;endDate) ? $this-&gt;endDate : <a class="code hl_variable" href="classFile__X509.html#a398d961fce9d555095d8e8251c060465">$endDate</a>-&gt;format(<span class="stringliteral">&#39;D, d M Y H:i:s O&#39;</span>);</div>
<div class="line"><span class="lineno"> 3739</span>            }</div>
<div class="line"><span class="lineno"> 3740</span>            <span class="keywordflow">if</span> (!empty($this-&gt;serialNumber)) {</div>
<div class="line"><span class="lineno"> 3741</span>                <a class="code hl_variable" href="classFile__X509.html#a679efcb06902f4395826045f1b6346ab">$serialNumber</a> = $this-&gt;serialNumber;</div>
<div class="line"><span class="lineno"> 3742</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3743</span>                <span class="keywordflow">if</span> (!function_exists(<span class="stringliteral">&#39;crypt_random_string&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 3744</span>                    include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/Random.php&#39;</span>;</div>
<div class="line"><span class="lineno"> 3745</span>                }</div>
<div class="line"><span class="lineno"> 3746</span>                <span class="comment">/* &quot;The serial number MUST be a positive integer&quot;</span></div>
<div class="line"><span class="lineno"> 3747</span><span class="comment">                   &quot;Conforming CAs MUST NOT use serialNumber values longer than 20 octets.&quot;</span></div>
<div class="line"><span class="lineno"> 3748</span><span class="comment">                    -- https://tools.ietf.org/html/rfc5280#section-4.1.2.2</span></div>
<div class="line"><span class="lineno"> 3749</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 3750</span><span class="comment">                   for the integer to be positive the leading bit needs to be 0 hence the</span></div>
<div class="line"><span class="lineno"> 3751</span><span class="comment">                   application of a bitmap</span></div>
<div class="line"><span class="lineno"> 3752</span><span class="comment">                */</span></div>
<div class="line"><span class="lineno"> 3753</span>                <a class="code hl_variable" href="classFile__X509.html#a679efcb06902f4395826045f1b6346ab">$serialNumber</a> = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>(crypt_random_string(20) &amp; (<span class="stringliteral">&quot;\x7F&quot;</span> . str_repeat(<span class="stringliteral">&quot;\xFF&quot;</span>, 19)), 256);</div>
<div class="line"><span class="lineno"> 3754</span>            }</div>
<div class="line"><span class="lineno"> 3755</span> </div>
<div class="line"><span class="lineno"> 3756</span>            $this-&gt;currentCert = array(</div>
<div class="line"><span class="lineno"> 3757</span>                <span class="stringliteral">&#39;tbsCertificate&#39;</span> =&gt;</div>
<div class="line"><span class="lineno"> 3758</span>                    array(</div>
<div class="line"><span class="lineno"> 3759</span>                        <span class="stringliteral">&#39;version&#39;</span> =&gt; <span class="stringliteral">&#39;v3&#39;</span>,</div>
<div class="line"><span class="lineno"> 3760</span>                        <span class="stringliteral">&#39;serialNumber&#39;</span> =&gt; $serialNumber, <span class="comment">// $this-&gt;setSerialNumber()</span></div>
<div class="line"><span class="lineno"> 3761</span>                        <span class="stringliteral">&#39;signature&#39;</span> =&gt; array(<span class="stringliteral">&#39;algorithm&#39;</span> =&gt; $signatureAlgorithm),</div>
<div class="line"><span class="lineno"> 3762</span>                        <span class="stringliteral">&#39;issuer&#39;</span> =&gt; <span class="keyword">false</span>, <span class="comment">// this is going to be overwritten later</span></div>
<div class="line"><span class="lineno"> 3763</span>                        <span class="stringliteral">&#39;validity&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno"> 3764</span>                            <span class="stringliteral">&#39;notBefore&#39;</span> =&gt; $this-&gt;<a class="code hl_function" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089">_timeField</a>($startDate), <span class="comment">// $this-&gt;setStartDate()</span></div>
<div class="line"><span class="lineno"> 3765</span>                            <span class="stringliteral">&#39;notAfter&#39;</span> =&gt; $this-&gt;<a class="code hl_function" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089">_timeField</a>($endDate)   <span class="comment">// $this-&gt;setEndDate()</span></div>
<div class="line"><span class="lineno"> 3766</span>                        ),</div>
<div class="line"><span class="lineno"> 3767</span>                        <span class="stringliteral">&#39;subject&#39;</span> =&gt; $subject-&gt;dn,</div>
<div class="line"><span class="lineno"> 3768</span>                        <span class="stringliteral">&#39;subjectPublicKeyInfo&#39;</span> =&gt; $subjectPublicKey</div>
<div class="line"><span class="lineno"> 3769</span>                    ),</div>
<div class="line"><span class="lineno"> 3770</span>                    <span class="stringliteral">&#39;signatureAlgorithm&#39;</span> =&gt; array(<span class="stringliteral">&#39;algorithm&#39;</span> =&gt; $signatureAlgorithm),</div>
<div class="line"><span class="lineno"> 3771</span>                    <span class="stringliteral">&#39;signature&#39;</span>          =&gt; <span class="keyword">false</span> <span class="comment">// this is going to be overwritten later</span></div>
<div class="line"><span class="lineno"> 3772</span>            );</div>
<div class="line"><span class="lineno"> 3773</span> </div>
<div class="line"><span class="lineno"> 3774</span>            <span class="comment">// Copy extensions from CSR.</span></div>
<div class="line"><span class="lineno"> 3775</span>            $csrexts = $subject-&gt;getAttribute(<span class="stringliteral">&#39;pkcs-9-at-extensionRequest&#39;</span>, 0);</div>
<div class="line"><span class="lineno"> 3776</span> </div>
<div class="line"><span class="lineno"> 3777</span>            <span class="keywordflow">if</span> (!empty($csrexts)) {</div>
<div class="line"><span class="lineno"> 3778</span>                $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;extensions&#39;</span>] = $csrexts;</div>
<div class="line"><span class="lineno"> 3779</span>            }</div>
<div class="line"><span class="lineno"> 3780</span>        }</div>
<div class="line"><span class="lineno"> 3781</span> </div>
<div class="line"><span class="lineno"> 3782</span>        $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;issuer&#39;</span>] = $issuer-&gt;dn;</div>
<div class="line"><span class="lineno"> 3783</span> </div>
<div class="line"><span class="lineno"> 3784</span>        <span class="keywordflow">if</span> (isset($issuer-&gt;currentKeyIdentifier)) {</div>
<div class="line"><span class="lineno"> 3785</span>            $this-&gt;<a class="code hl_function" href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f">setExtension</a>(<span class="stringliteral">&#39;id-ce-authorityKeyIdentifier&#39;</span>, array(</div>
<div class="line"><span class="lineno"> 3786</span>                    <span class="comment">//&#39;authorityCertIssuer&#39; =&gt; array(</span></div>
<div class="line"><span class="lineno"> 3787</span>                    <span class="comment">//    array(</span></div>
<div class="line"><span class="lineno"> 3788</span>                    <span class="comment">//        &#39;directoryName&#39; =&gt; $issuer-&gt;dn</span></div>
<div class="line"><span class="lineno"> 3789</span>                    <span class="comment">//    )</span></div>
<div class="line"><span class="lineno"> 3790</span>                    <span class="comment">//),</span></div>
<div class="line"><span class="lineno"> 3791</span>                    <span class="stringliteral">&#39;keyIdentifier&#39;</span> =&gt; $issuer-&gt;currentKeyIdentifier</div>
<div class="line"><span class="lineno"> 3792</span>                ));</div>
<div class="line"><span class="lineno"> 3793</span>            <span class="comment">//$extensions = &amp;$this-&gt;currentCert[&#39;tbsCertificate&#39;][&#39;extensions&#39;];</span></div>
<div class="line"><span class="lineno"> 3794</span>            <span class="comment">//if (isset($issuer-&gt;serialNumber)) {</span></div>
<div class="line"><span class="lineno"> 3795</span>            <span class="comment">//    $extensions[count($extensions) - 1][&#39;authorityCertSerialNumber&#39;] = $issuer-&gt;serialNumber;</span></div>
<div class="line"><span class="lineno"> 3796</span>            <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 3797</span>            <span class="comment">//unset($extensions);</span></div>
<div class="line"><span class="lineno"> 3798</span>        }</div>
<div class="line"><span class="lineno"> 3799</span> </div>
<div class="line"><span class="lineno"> 3800</span>        <span class="keywordflow">if</span> (isset($subject-&gt;currentKeyIdentifier)) {</div>
<div class="line"><span class="lineno"> 3801</span>            $this-&gt;<a class="code hl_function" href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f">setExtension</a>(<span class="stringliteral">&#39;id-ce-subjectKeyIdentifier&#39;</span>, $subject-&gt;currentKeyIdentifier);</div>
<div class="line"><span class="lineno"> 3802</span>        }</div>
<div class="line"><span class="lineno"> 3803</span> </div>
<div class="line"><span class="lineno"> 3804</span>        $altName = array();</div>
<div class="line"><span class="lineno"> 3805</span> </div>
<div class="line"><span class="lineno"> 3806</span>        <span class="keywordflow">if</span> (isset($subject-&gt;domains) &amp;&amp; count($subject-&gt;domains)) {</div>
<div class="line"><span class="lineno"> 3807</span>            $altName = array_map(array(<span class="stringliteral">&#39;File_X509&#39;</span>, <span class="stringliteral">&#39;_dnsName&#39;</span>), $subject-&gt;domains);</div>
<div class="line"><span class="lineno"> 3808</span>        }</div>
<div class="line"><span class="lineno"> 3809</span> </div>
<div class="line"><span class="lineno"> 3810</span>        <span class="keywordflow">if</span> (isset($subject-&gt;ipAddresses) &amp;&amp; count($subject-&gt;ipAddresses)) {</div>
<div class="line"><span class="lineno"> 3811</span>            <span class="comment">// should an IP address appear as the CN if no domain name is specified? idk</span></div>
<div class="line"><span class="lineno"> 3812</span>            <span class="comment">//$ips = count($subject-&gt;domains) ? $subject-&gt;ipAddresses : array_slice($subject-&gt;ipAddresses, 1);</span></div>
<div class="line"><span class="lineno"> 3813</span>            $ipAddresses = array();</div>
<div class="line"><span class="lineno"> 3814</span>            <span class="keywordflow">foreach</span> ($subject-&gt;ipAddresses as $ipAddress) {</div>
<div class="line"><span class="lineno"> 3815</span>                <a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a> = $subject-&gt;_ipAddress($ipAddress);</div>
<div class="line"><span class="lineno"> 3816</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a> !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3817</span>                    $ipAddresses[] = <a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>;</div>
<div class="line"><span class="lineno"> 3818</span>                }</div>
<div class="line"><span class="lineno"> 3819</span>            }</div>
<div class="line"><span class="lineno"> 3820</span>            <span class="keywordflow">if</span> (count($ipAddresses)) {</div>
<div class="line"><span class="lineno"> 3821</span>                $altName = array_merge($altName, $ipAddresses);</div>
<div class="line"><span class="lineno"> 3822</span>            }</div>
<div class="line"><span class="lineno"> 3823</span>        }</div>
<div class="line"><span class="lineno"> 3824</span> </div>
<div class="line"><span class="lineno"> 3825</span>        <span class="keywordflow">if</span> (!empty($altName)) {</div>
<div class="line"><span class="lineno"> 3826</span>            $this-&gt;<a class="code hl_function" href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f">setExtension</a>(<span class="stringliteral">&#39;id-ce-subjectAltName&#39;</span>, $altName);</div>
<div class="line"><span class="lineno"> 3827</span>        }</div>
<div class="line"><span class="lineno"> 3828</span> </div>
<div class="line"><span class="lineno"> 3829</span>        <span class="keywordflow">if</span> ($this-&gt;caFlag) {</div>
<div class="line"><span class="lineno"> 3830</span>            $keyUsage = $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">getExtension</a>(<span class="stringliteral">&#39;id-ce-keyUsage&#39;</span>);</div>
<div class="line"><span class="lineno"> 3831</span>            <span class="keywordflow">if</span> (!$keyUsage) {</div>
<div class="line"><span class="lineno"> 3832</span>                $keyUsage = array();</div>
<div class="line"><span class="lineno"> 3833</span>            }</div>
<div class="line"><span class="lineno"> 3834</span> </div>
<div class="line"><span class="lineno"> 3835</span>            $this-&gt;<a class="code hl_function" href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f">setExtension</a>(</div>
<div class="line"><span class="lineno"> 3836</span>                <span class="stringliteral">&#39;id-ce-keyUsage&#39;</span>,</div>
<div class="line"><span class="lineno"> 3837</span>                array_values(array_unique(array_merge($keyUsage, array(<span class="stringliteral">&#39;cRLSign&#39;</span>, <span class="stringliteral">&#39;keyCertSign&#39;</span>))))</div>
<div class="line"><span class="lineno"> 3838</span>            );</div>
<div class="line"><span class="lineno"> 3839</span> </div>
<div class="line"><span class="lineno"> 3840</span>            $basicConstraints = $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">getExtension</a>(<span class="stringliteral">&#39;id-ce-basicConstraints&#39;</span>);</div>
<div class="line"><span class="lineno"> 3841</span>            <span class="keywordflow">if</span> (!$basicConstraints) {</div>
<div class="line"><span class="lineno"> 3842</span>                $basicConstraints = array();</div>
<div class="line"><span class="lineno"> 3843</span>            }</div>
<div class="line"><span class="lineno"> 3844</span> </div>
<div class="line"><span class="lineno"> 3845</span>            $this-&gt;<a class="code hl_function" href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f">setExtension</a>(</div>
<div class="line"><span class="lineno"> 3846</span>                <span class="stringliteral">&#39;id-ce-basicConstraints&#39;</span>,</div>
<div class="line"><span class="lineno"> 3847</span>                array_unique(array_merge(array(<span class="stringliteral">&#39;cA&#39;</span> =&gt; <span class="keyword">true</span>), $basicConstraints)),</div>
<div class="line"><span class="lineno"> 3848</span>                <span class="keyword">true</span></div>
<div class="line"><span class="lineno"> 3849</span>            );</div>
<div class="line"><span class="lineno"> 3850</span> </div>
<div class="line"><span class="lineno"> 3851</span>            <span class="keywordflow">if</span> (!isset($subject-&gt;currentKeyIdentifier)) {</div>
<div class="line"><span class="lineno"> 3852</span>                $this-&gt;<a class="code hl_function" href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f">setExtension</a>(<span class="stringliteral">&#39;id-ce-subjectKeyIdentifier&#39;</span>, base64_encode($this-&gt;<a class="code hl_function" href="classFile__X509.html#ae4e1b70f7a5845e4777064b242a35d56">computeKeyIdentifier</a>($this-&gt;currentCert)), <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3853</span>            }</div>
<div class="line"><span class="lineno"> 3854</span>        }</div>
<div class="line"><span class="lineno"> 3855</span> </div>
<div class="line"><span class="lineno"> 3856</span>        <span class="comment">// resync $this-&gt;signatureSubject</span></div>
<div class="line"><span class="lineno"> 3857</span>        <span class="comment">// save $tbsCertificate in case there are any File_ASN1_Element objects in it</span></div>
<div class="line"><span class="lineno"> 3858</span>        $tbsCertificate = $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>];</div>
<div class="line"><span class="lineno"> 3859</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376">loadX509</a>($this-&gt;<a class="code hl_function" href="classFile__X509.html#af8e8019a921e4c0651e807c7c1644fcc">saveX509</a>($this-&gt;currentCert));</div>
<div class="line"><span class="lineno"> 3860</span> </div>
<div class="line"><span class="lineno"> 3861</span>        $result = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a26cf1092c86fba52e8cc1bc078ab0b60">_sign</a>($issuer-&gt;privateKey, $signatureAlgorithm);</div>
<div class="line"><span class="lineno"> 3862</span>        $result[<span class="stringliteral">&#39;tbsCertificate&#39;</span>] = $tbsCertificate;</div>
<div class="line"><span class="lineno"> 3863</span> </div>
<div class="line"><span class="lineno"> 3864</span>        $this-&gt;currentCert = <a class="code hl_variable" href="classFile__X509.html#a13ce82673cd9b9e0aebbd6c10010a686">$currentCert</a>;</div>
<div class="line"><span class="lineno"> 3865</span>        $this-&gt;signatureSubject = <a class="code hl_variable" href="classFile__X509.html#abc5038cc6c10571997d5cef6f7c85782">$signatureSubject</a>;</div>
<div class="line"><span class="lineno"> 3866</span> </div>
<div class="line"><span class="lineno"> 3867</span>        <span class="keywordflow">return</span> $result;</div>
<div class="line"><span class="lineno"> 3868</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_a26cf1092c86fba52e8cc1bc078ab0b60"><div class="ttname"><a href="classFile__X509.html#a26cf1092c86fba52e8cc1bc078ab0b60">File_X509\_sign</a></div><div class="ttdeci">_sign($key, $signatureAlgorithm)</div><div class="ttdoc">X.509 certificate signing helper function.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l04137">X509.php:4137</a></div></div>
<div class="ttc" id="aclassFile__X509_html_a288a4b22573d5731fe3f52c55263c5f3"><div class="ttname"><a href="classFile__X509.html#a288a4b22573d5731fe3f52c55263c5f3">File_X509\$startDate</a></div><div class="ttdeci">$startDate</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00278">X509.php:278</a></div></div>
<div class="ttc" id="aclassFile__X509_html_a398d961fce9d555095d8e8251c060465"><div class="ttname"><a href="classFile__X509.html#a398d961fce9d555095d8e8251c060465">File_X509\$endDate</a></div><div class="ttdeci">$endDate</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00286">X509.php:286</a></div></div>
<div class="ttc" id="aclassFile__X509_html_a679efcb06902f4395826045f1b6346ab"><div class="ttname"><a href="classFile__X509.html#a679efcb06902f4395826045f1b6346ab">File_X509\$serialNumber</a></div><div class="ttdeci">$serialNumber</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00294">X509.php:294</a></div></div>
<div class="ttc" id="aclassFile__X509_html_a6b1d3038d8f6448b8f7d25f324833376"><div class="ttname"><a href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376">File_X509\loadX509</a></div><div class="ttdeci">loadX509($cert, $mode=FILE_X509_FORMAT_AUTO_DETECT)</div><div class="ttdoc">Load X.509 certificate.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l01497">X509.php:1497</a></div></div>
<div class="ttc" id="aclassFile__X509_html_aa75a9d891292eeddcbf00060e36c0695"><div class="ttname"><a href="classFile__X509.html#aa75a9d891292eeddcbf00060e36c0695">File_X509\removeExtension</a></div><div class="ttdeci">removeExtension($id)</div><div class="ttdoc">Remove a certificate, CSR or CRL Extension.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l04512">X509.php:4512</a></div></div>
<div class="ttc" id="aclassFile__X509_html_abc5038cc6c10571997d5cef6f7c85782"><div class="ttname"><a href="classFile__X509.html#abc5038cc6c10571997d5cef6f7c85782">File_X509\$signatureSubject</a></div><div class="ttdeci">$signatureSubject</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l00270">X509.php:270</a></div></div>
<div class="ttc" id="aclassFile__X509_html_aec94c39b26c9f4af4efe2ebf74cd914f"><div class="ttname"><a href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f">File_X509\setExtension</a></div><div class="ttdeci">setExtension($id, $value, $critical=false, $replace=true)</div><div class="ttdoc">Set a certificate, CSR or CRL Extension.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l04554">X509.php:4554</a></div></div>
<div class="ttc" id="aclassFile__X509_html_af8e8019a921e4c0651e807c7c1644fcc"><div class="ttname"><a href="classFile__X509.html#af8e8019a921e4c0651e807c7c1644fcc">File_X509\saveX509</a></div><div class="ttdeci">saveX509($cert, $format=FILE_X509_FORMAT_PEM)</div><div class="ttdoc">Save X.509 certificate.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l01570">X509.php:1570</a></div></div>
<div class="ttc" id="actlr_8php_html_af709b460501204e2ec7e34e96e7de576"><div class="ttname"><a href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a></div><div class="ttdeci">$encoded</div><div class="ttdef"><b>Definition:</b> <a href="ctlr_8php_source.html#l00107">ctlr.php:107</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00107">$encoded</a>, <a class="el" href="install_8php_source.html#l00039">$VIEW_PATH</a>, <a class="el" href="X509_8php_source.html#l04137">_sign()</a>, <a class="el" href="X509_8php_source.html#l03653">_timeField()</a>, <a class="el" href="X509_8php_source.html#l04767">computeKeyIdentifier()</a>, <a class="el" href="X509_8php_source.html#l04527">getExtension()</a>, <a class="el" href="X509_8php_source.html#l01497">loadX509()</a>, <a class="el" href="X509_8php_source.html#l04512">removeExtension()</a>, <a class="el" href="X509_8php_source.html#l01570">saveX509()</a>, and <a class="el" href="X509_8php_source.html#l04554">setExtension()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a86265f41fc9ab04b810aa1a14a613477_cgraph.png" border="0" usemap="#aclassFile__X509_a86265f41fc9ab04b810aa1a14a613477_cgraph" alt=""/></div>
<map name="aclassFile__X509_a86265f41fc9ab04b810aa1a14a613477_cgraph" id="aclassFile__X509_a86265f41fc9ab04b810aa1a14a613477_cgraph">
<area shape="rect" title="Sign an X.509 certificate." alt="" coords="5,231,55,256"/>
<area shape="rect" href="classFile__X509.html#a26cf1092c86fba52e8cc1bc078ab0b60" title="X.509 certificate signing helper function." alt="" coords="155,33,211,59"/>
<area shape="rect" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089" title="Helper function to build a time field according to RFC 3280 section." alt="" coords="138,83,229,108"/>
<area shape="rect" href="classFile__X509.html#ae4e1b70f7a5845e4777064b242a35d56" title="Compute a public key identifier." alt="" coords="103,156,264,181"/>
<area shape="rect" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb" title="Get a certificate, CSR or CRL Extension." alt="" coords="324,307,431,332"/>
<area shape="rect" href="classFile__X509.html#a6b1d3038d8f6448b8f7d25f324833376" title="Load X.509 certificate." alt="" coords="142,205,225,231"/>
<area shape="rect" href="classFile__X509.html#aa75a9d891292eeddcbf00060e36c0695" title="Remove a certificate, CSR or CRL Extension." alt="" coords="115,357,251,383"/>
<area shape="rect" href="classFile__X509.html#af8e8019a921e4c0651e807c7c1644fcc" title="Save X.509 certificate." alt="" coords="519,256,605,281"/>
<area shape="rect" href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f" title="Set a certificate, CSR or CRL Extension." alt="" coords="130,407,237,432"/>
<area shape="rect" href="classFile__X509.html#a009e0a2396931d62c87d27f4e2372024" title="Extract raw BER from Base64 encoding." alt="" coords="327,5,428,31"/>
<area shape="rect" href="classFile__X509.html#a51d0ffadbcbf965b23238b89fef03484" title="Get an Extension." alt="" coords="505,307,619,332"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="707,381,807,407"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="917,280,1004,305"/>
<area shape="rect" href="classFile__X509.html#ad60bc52a972cab9df3fc002a25de16dc" title="Check for validity of subarray." alt="" coords="312,104,443,129"/>
<area shape="rect" href="classFile__X509.html#a016c0c81b4115631a081d91036c8839f" title="Map DN values from ANY type to DN&#45;specific internal format." alt="" coords="709,181,806,207"/>
<area shape="rect" href="classFile__X509.html#a0c34c28604781bdc296e7ade6951a734" title="Map extension values from octet string to extension&#45;specific internal format." alt="" coords="687,132,828,157"/>
<area shape="rect" href="classFile__X509.html#a195dac5d2b72ef86fe28250ea43343b8" title="Reformat public keys." alt="" coords="322,55,433,80"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="907,207,1014,232"/>
<area shape="rect" href="classFile__X509.html#a50d402cfb4c93492899c7a222ddb6803" title="Get a reference to a subarray." alt="" coords="881,132,1040,157"/>
<area shape="rect" href="classFile__X509.html#ac16dd74cbc682e06b2f35875d04582d1" title="Remove an Extension." alt="" coords="491,357,633,383"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="703,280,811,305"/>
<area shape="rect" href="classFile__X509.html#afc612875837ae70595137c6166f90106" title="Map extension values from extension&#45;specific internal format to octet string." alt="" coords="681,231,833,256"/>
<area shape="rect" href="classFile__X509.html#a28a18c05603a638bcb114897dffeee6d" title="Set an Extension." alt="" coords="505,407,619,432"/>
</map>
</div>

</div>
</div>
<a id="a2b25616309652968bc8a61f44415c14d" name="a2b25616309652968bc8a61f44415c14d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b25616309652968bc8a61f44415c14d">&#9670;&#160;</a></span>signCRL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signCRL </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$issuer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$crl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$signatureAlgorithm</em> = <code>'sha1WithRSAEncryption'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sign a CRL. </p>
<p>$issuer's private key needs to be loaded.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="classFile__X509.html">File_X509</a></td><td class="paramname">$issuer</td><td></td></tr>
    <tr><td class="paramtype"><a class="el" href="classFile__X509.html">File_X509</a></td><td class="paramname">$crl</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$signatureAlgorithm</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04004">4004</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4005</span>    {</div>
<div class="line"><span class="lineno"> 4006</span>        <span class="keywordflow">if</span> (!is_object($issuer-&gt;privateKey) || empty($issuer-&gt;dn)) {</div>
<div class="line"><span class="lineno"> 4007</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4008</span>        }</div>
<div class="line"><span class="lineno"> 4009</span> </div>
<div class="line"><span class="lineno"> 4010</span>        $currentCert = isset($this-&gt;currentCert) ? $this-&gt;currentCert : <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 4011</span>        $signatureSubject = isset($this-&gt;signatureSubject) ? $this-&gt;signatureSubject : <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 4012</span>        <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;DateTime&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 4013</span>            $thisUpdate = !empty($this-&gt;startDate) ? $this-&gt;startDate : @date(<span class="stringliteral">&#39;D, d M Y H:i:s O&#39;</span>);</div>
<div class="line"><span class="lineno"> 4014</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4015</span>            $thisUpdate = <span class="keyword">new</span> DateTime(<span class="stringliteral">&#39;now&#39;</span>, <span class="keyword">new</span> DateTimeZone(@date_default_timezone_get()));</div>
<div class="line"><span class="lineno"> 4016</span>            $thisUpdate = !empty($this-&gt;startDate) ? $this-&gt;startDate : $thisUpdate-&gt;format(<span class="stringliteral">&#39;D, d M Y H:i:s O&#39;</span>);</div>
<div class="line"><span class="lineno"> 4017</span>        }</div>
<div class="line"><span class="lineno"> 4018</span> </div>
<div class="line"><span class="lineno"> 4019</span>        <span class="keywordflow">if</span> (isset($crl-&gt;currentCert) &amp;&amp; is_array($crl-&gt;currentCert) &amp;&amp; isset($crl-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 4020</span>            $this-&gt;currentCert = $crl-&gt;currentCert;</div>
<div class="line"><span class="lineno"> 4021</span>            $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>][<span class="stringliteral">&#39;signature&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>] = $signatureAlgorithm;</div>
<div class="line"><span class="lineno"> 4022</span>            $this-&gt;currentCert[<span class="stringliteral">&#39;signatureAlgorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>] = $signatureAlgorithm;</div>
<div class="line"><span class="lineno"> 4023</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4024</span>            $this-&gt;currentCert = array(</div>
<div class="line"><span class="lineno"> 4025</span>                <span class="stringliteral">&#39;tbsCertList&#39;</span> =&gt;</div>
<div class="line"><span class="lineno"> 4026</span>                    array(</div>
<div class="line"><span class="lineno"> 4027</span>                        <span class="stringliteral">&#39;version&#39;</span> =&gt; <span class="stringliteral">&#39;v2&#39;</span>,</div>
<div class="line"><span class="lineno"> 4028</span>                        <span class="stringliteral">&#39;signature&#39;</span> =&gt; array(<span class="stringliteral">&#39;algorithm&#39;</span> =&gt; $signatureAlgorithm),</div>
<div class="line"><span class="lineno"> 4029</span>                        <span class="stringliteral">&#39;issuer&#39;</span> =&gt; <span class="keyword">false</span>, <span class="comment">// this is going to be overwritten later</span></div>
<div class="line"><span class="lineno"> 4030</span>                        <span class="stringliteral">&#39;thisUpdate&#39;</span> =&gt; $this-&gt;<a class="code hl_function" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089">_timeField</a>($thisUpdate) <span class="comment">// $this-&gt;setStartDate()</span></div>
<div class="line"><span class="lineno"> 4031</span>                    ),</div>
<div class="line"><span class="lineno"> 4032</span>                    <span class="stringliteral">&#39;signatureAlgorithm&#39;</span> =&gt; array(<span class="stringliteral">&#39;algorithm&#39;</span> =&gt; $signatureAlgorithm),</div>
<div class="line"><span class="lineno"> 4033</span>                    <span class="stringliteral">&#39;signature&#39;</span>          =&gt; <span class="keyword">false</span> <span class="comment">// this is going to be overwritten later</span></div>
<div class="line"><span class="lineno"> 4034</span>            );</div>
<div class="line"><span class="lineno"> 4035</span>        }</div>
<div class="line"><span class="lineno"> 4036</span> </div>
<div class="line"><span class="lineno"> 4037</span>        $tbsCertList = &amp;$this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>];</div>
<div class="line"><span class="lineno"> 4038</span>        $tbsCertList[<span class="stringliteral">&#39;issuer&#39;</span>] = $issuer-&gt;dn;</div>
<div class="line"><span class="lineno"> 4039</span>        $tbsCertList[<span class="stringliteral">&#39;thisUpdate&#39;</span>] = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089">_timeField</a>($thisUpdate);</div>
<div class="line"><span class="lineno"> 4040</span> </div>
<div class="line"><span class="lineno"> 4041</span>        <span class="keywordflow">if</span> (!empty($this-&gt;endDate)) {</div>
<div class="line"><span class="lineno"> 4042</span>            $tbsCertList[<span class="stringliteral">&#39;nextUpdate&#39;</span>] = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089">_timeField</a>($this-&gt;endDate); <span class="comment">// $this-&gt;setEndDate()</span></div>
<div class="line"><span class="lineno"> 4043</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4044</span>            unset($tbsCertList[<span class="stringliteral">&#39;nextUpdate&#39;</span>]);</div>
<div class="line"><span class="lineno"> 4045</span>        }</div>
<div class="line"><span class="lineno"> 4046</span> </div>
<div class="line"><span class="lineno"> 4047</span>        <span class="keywordflow">if</span> (!empty($this-&gt;serialNumber)) {</div>
<div class="line"><span class="lineno"> 4048</span>            $crlNumber = $this-&gt;serialNumber;</div>
<div class="line"><span class="lineno"> 4049</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4050</span>            $crlNumber = $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">getExtension</a>(<span class="stringliteral">&#39;id-ce-cRLNumber&#39;</span>);</div>
<div class="line"><span class="lineno"> 4051</span>            <span class="comment">// &quot;The CRL number is a non-critical CRL extension that conveys a</span></div>
<div class="line"><span class="lineno"> 4052</span>            <span class="comment">//  monotonically increasing sequence number for a given CRL scope and</span></div>
<div class="line"><span class="lineno"> 4053</span>            <span class="comment">//  CRL issuer.  This extension allows users to easily determine when a</span></div>
<div class="line"><span class="lineno"> 4054</span>            <span class="comment">//  particular CRL supersedes another CRL.&quot;</span></div>
<div class="line"><span class="lineno"> 4055</span>            <span class="comment">// -- https://tools.ietf.org/html/rfc5280#section-5.2.3</span></div>
<div class="line"><span class="lineno"> 4056</span>            $crlNumber = $crlNumber !== <span class="keyword">false</span> ? $crlNumber-&gt;add(<span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>(1)) : <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 4057</span>        }</div>
<div class="line"><span class="lineno"> 4058</span> </div>
<div class="line"><span class="lineno"> 4059</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#aa75a9d891292eeddcbf00060e36c0695">removeExtension</a>(<span class="stringliteral">&#39;id-ce-authorityKeyIdentifier&#39;</span>);</div>
<div class="line"><span class="lineno"> 4060</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#aa75a9d891292eeddcbf00060e36c0695">removeExtension</a>(<span class="stringliteral">&#39;id-ce-issuerAltName&#39;</span>);</div>
<div class="line"><span class="lineno"> 4061</span> </div>
<div class="line"><span class="lineno"> 4062</span>        <span class="comment">// Be sure version &gt;= v2 if some extension found.</span></div>
<div class="line"><span class="lineno"> 4063</span>        $version = isset($tbsCertList[<span class="stringliteral">&#39;version&#39;</span>]) ? $tbsCertList[<span class="stringliteral">&#39;version&#39;</span>] : 0;</div>
<div class="line"><span class="lineno"> 4064</span>        <span class="keywordflow">if</span> (!$version) {</div>
<div class="line"><span class="lineno"> 4065</span>            <span class="keywordflow">if</span> (!empty($tbsCertList[<span class="stringliteral">&#39;crlExtensions&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 4066</span>                $version = 1; <span class="comment">// v2.</span></div>
<div class="line"><span class="lineno"> 4067</span>            } elseif (!empty($tbsCertList[<span class="stringliteral">&#39;revokedCertificates&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 4068</span>                <span class="keywordflow">foreach</span> ($tbsCertList[<span class="stringliteral">&#39;revokedCertificates&#39;</span>] as $cert) {</div>
<div class="line"><span class="lineno"> 4069</span>                    <span class="keywordflow">if</span> (!empty($cert[<span class="stringliteral">&#39;crlEntryExtensions&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 4070</span>                        $version = 1; <span class="comment">// v2.</span></div>
<div class="line"><span class="lineno"> 4071</span>                    }</div>
<div class="line"><span class="lineno"> 4072</span>                }</div>
<div class="line"><span class="lineno"> 4073</span>            }</div>
<div class="line"><span class="lineno"> 4074</span> </div>
<div class="line"><span class="lineno"> 4075</span>            <span class="keywordflow">if</span> ($version) {</div>
<div class="line"><span class="lineno"> 4076</span>                $tbsCertList[<span class="stringliteral">&#39;version&#39;</span>] = $version;</div>
<div class="line"><span class="lineno"> 4077</span>            }</div>
<div class="line"><span class="lineno"> 4078</span>        }</div>
<div class="line"><span class="lineno"> 4079</span> </div>
<div class="line"><span class="lineno"> 4080</span>        <span class="comment">// Store additional extensions.</span></div>
<div class="line"><span class="lineno"> 4081</span>        <span class="keywordflow">if</span> (!empty($tbsCertList[<span class="stringliteral">&#39;version&#39;</span>])) { <span class="comment">// At least v2.</span></div>
<div class="line"><span class="lineno"> 4082</span>            <span class="keywordflow">if</span> (!empty($crlNumber)) {</div>
<div class="line"><span class="lineno"> 4083</span>                $this-&gt;<a class="code hl_function" href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f">setExtension</a>(<span class="stringliteral">&#39;id-ce-cRLNumber&#39;</span>, $crlNumber);</div>
<div class="line"><span class="lineno"> 4084</span>            }</div>
<div class="line"><span class="lineno"> 4085</span> </div>
<div class="line"><span class="lineno"> 4086</span>            <span class="keywordflow">if</span> (isset($issuer-&gt;currentKeyIdentifier)) {</div>
<div class="line"><span class="lineno"> 4087</span>                $this-&gt;<a class="code hl_function" href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f">setExtension</a>(<span class="stringliteral">&#39;id-ce-authorityKeyIdentifier&#39;</span>, array(</div>
<div class="line"><span class="lineno"> 4088</span>                        <span class="comment">//&#39;authorityCertIssuer&#39; =&gt; array(</span></div>
<div class="line"><span class="lineno"> 4089</span>                        <span class="comment">//    array(</span></div>
<div class="line"><span class="lineno"> 4090</span>                        <span class="comment">//        &#39;directoryName&#39; =&gt; $issuer-&gt;dn</span></div>
<div class="line"><span class="lineno"> 4091</span>                        <span class="comment">//    )</span></div>
<div class="line"><span class="lineno"> 4092</span>                        <span class="comment">//),</span></div>
<div class="line"><span class="lineno"> 4093</span>                        <span class="stringliteral">&#39;keyIdentifier&#39;</span> =&gt; $issuer-&gt;currentKeyIdentifier</div>
<div class="line"><span class="lineno"> 4094</span>                    ));</div>
<div class="line"><span class="lineno"> 4095</span>                <span class="comment">//$extensions = &amp;$tbsCertList[&#39;crlExtensions&#39;];</span></div>
<div class="line"><span class="lineno"> 4096</span>                <span class="comment">//if (isset($issuer-&gt;serialNumber)) {</span></div>
<div class="line"><span class="lineno"> 4097</span>                <span class="comment">//    $extensions[count($extensions) - 1][&#39;authorityCertSerialNumber&#39;] = $issuer-&gt;serialNumber;</span></div>
<div class="line"><span class="lineno"> 4098</span>                <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 4099</span>                <span class="comment">//unset($extensions);</span></div>
<div class="line"><span class="lineno"> 4100</span>            }</div>
<div class="line"><span class="lineno"> 4101</span> </div>
<div class="line"><span class="lineno"> 4102</span>            $issuerAltName = $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">getExtension</a>(<span class="stringliteral">&#39;id-ce-subjectAltName&#39;</span>, $issuer-&gt;currentCert);</div>
<div class="line"><span class="lineno"> 4103</span> </div>
<div class="line"><span class="lineno"> 4104</span>            <span class="keywordflow">if</span> ($issuerAltName !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 4105</span>                $this-&gt;<a class="code hl_function" href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f">setExtension</a>(<span class="stringliteral">&#39;id-ce-issuerAltName&#39;</span>, $issuerAltName);</div>
<div class="line"><span class="lineno"> 4106</span>            }</div>
<div class="line"><span class="lineno"> 4107</span>        }</div>
<div class="line"><span class="lineno"> 4108</span> </div>
<div class="line"><span class="lineno"> 4109</span>        <span class="keywordflow">if</span> (empty($tbsCertList[<span class="stringliteral">&#39;revokedCertificates&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 4110</span>            unset($tbsCertList[<span class="stringliteral">&#39;revokedCertificates&#39;</span>]);</div>
<div class="line"><span class="lineno"> 4111</span>        }</div>
<div class="line"><span class="lineno"> 4112</span> </div>
<div class="line"><span class="lineno"> 4113</span>        unset($tbsCertList);</div>
<div class="line"><span class="lineno"> 4114</span> </div>
<div class="line"><span class="lineno"> 4115</span>        <span class="comment">// resync $this-&gt;signatureSubject</span></div>
<div class="line"><span class="lineno"> 4116</span>        <span class="comment">// save $tbsCertList in case there are any File_ASN1_Element objects in it</span></div>
<div class="line"><span class="lineno"> 4117</span>        $tbsCertList = $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertList&#39;</span>];</div>
<div class="line"><span class="lineno"> 4118</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#a0379465670a36ea3a1d2e9a34ea21405">loadCRL</a>($this-&gt;<a class="code hl_function" href="classFile__X509.html#a9ea29c41d328dc397c2f1de19a178696">saveCRL</a>($this-&gt;currentCert));</div>
<div class="line"><span class="lineno"> 4119</span> </div>
<div class="line"><span class="lineno"> 4120</span>        $result = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a26cf1092c86fba52e8cc1bc078ab0b60">_sign</a>($issuer-&gt;privateKey, $signatureAlgorithm);</div>
<div class="line"><span class="lineno"> 4121</span>        $result[<span class="stringliteral">&#39;tbsCertList&#39;</span>] = $tbsCertList;</div>
<div class="line"><span class="lineno"> 4122</span> </div>
<div class="line"><span class="lineno"> 4123</span>        $this-&gt;currentCert = <a class="code hl_variable" href="classFile__X509.html#a13ce82673cd9b9e0aebbd6c10010a686">$currentCert</a>;</div>
<div class="line"><span class="lineno"> 4124</span>        $this-&gt;signatureSubject = <a class="code hl_variable" href="classFile__X509.html#abc5038cc6c10571997d5cef6f7c85782">$signatureSubject</a>;</div>
<div class="line"><span class="lineno"> 4125</span> </div>
<div class="line"><span class="lineno"> 4126</span>        <span class="keywordflow">return</span> $result;</div>
<div class="line"><span class="lineno"> 4127</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_a0379465670a36ea3a1d2e9a34ea21405"><div class="ttname"><a href="classFile__X509.html#a0379465670a36ea3a1d2e9a34ea21405">File_X509\loadCRL</a></div><div class="ttdeci">loadCRL($crl, $mode=FILE_X509_FORMAT_AUTO_DETECT)</div><div class="ttdoc">Load a Certificate Revocation List.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l03521">X509.php:3521</a></div></div>
<div class="ttc" id="aclassFile__X509_html_a9ea29c41d328dc397c2f1de19a178696"><div class="ttname"><a href="classFile__X509.html#a9ea29c41d328dc397c2f1de19a178696">File_X509\saveCRL</a></div><div class="ttdeci">saveCRL($crl, $format=FILE_X509_FORMAT_PEM)</div><div class="ttdoc">Save Certificate Revocation List.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l03591">X509.php:3591</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04137">_sign()</a>, <a class="el" href="X509_8php_source.html#l03653">_timeField()</a>, <a class="el" href="X509_8php_source.html#l04527">getExtension()</a>, <a class="el" href="X509_8php_source.html#l03521">loadCRL()</a>, <a class="el" href="X509_8php_source.html#l04512">removeExtension()</a>, <a class="el" href="X509_8php_source.html#l03591">saveCRL()</a>, and <a class="el" href="X509_8php_source.html#l04554">setExtension()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a2b25616309652968bc8a61f44415c14d_cgraph.png" border="0" usemap="#aclassFile__X509_a2b25616309652968bc8a61f44415c14d_cgraph" alt=""/></div>
<map name="aclassFile__X509_a2b25616309652968bc8a61f44415c14d_cgraph" id="aclassFile__X509_a2b25616309652968bc8a61f44415c14d_cgraph">
<area shape="rect" title="Sign a CRL." alt="" coords="5,153,80,179"/>
<area shape="rect" href="classFile__X509.html#a26cf1092c86fba52e8cc1bc078ab0b60" title="X.509 certificate signing helper function." alt="" coords="168,5,224,31"/>
<area shape="rect" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089" title="Helper function to build a time field according to RFC 3280 section." alt="" coords="151,55,241,80"/>
<area shape="rect" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb" title="Get a certificate, CSR or CRL Extension." alt="" coords="143,104,249,129"/>
<area shape="rect" href="classFile__X509.html#a0379465670a36ea3a1d2e9a34ea21405" title="Load a Certificate Revocation List." alt="" coords="346,427,421,452"/>
<area shape="rect" href="classFile__X509.html#aa75a9d891292eeddcbf00060e36c0695" title="Remove a certificate, CSR or CRL Extension." alt="" coords="128,153,264,179"/>
<area shape="rect" href="classFile__X509.html#a9ea29c41d328dc397c2f1de19a178696" title="Save Certificate Revocation List." alt="" coords="344,253,423,279"/>
<area shape="rect" href="classFile__X509.html#aec94c39b26c9f4af4efe2ebf74cd914f" title="Set a certificate, CSR or CRL Extension." alt="" coords="143,203,249,228"/>
<area shape="rect" href="classFile__X509.html#a51d0ffadbcbf965b23238b89fef03484" title="Get an Extension." alt="" coords="326,104,441,129"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="529,152,629,177"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="739,253,825,279"/>
<area shape="rect" href="classFile__X509.html#a009e0a2396931d62c87d27f4e2372024" title="Extract raw BER from Base64 encoding." alt="" coords="528,352,629,377"/>
<area shape="rect" href="classFile__X509.html#ad60bc52a972cab9df3fc002a25de16dc" title="Check for validity of subarray." alt="" coords="513,401,644,427"/>
<area shape="rect" href="classFile__X509.html#a016c0c81b4115631a081d91036c8839f" title="Map DN values from ANY type to DN&#45;specific internal format." alt="" coords="530,451,627,476"/>
<area shape="rect" href="classFile__X509.html#a0c34c28604781bdc296e7ade6951a734" title="Map extension values from octet string to extension&#45;specific internal format." alt="" coords="508,500,649,525"/>
<area shape="rect" href="classFile__X509.html#a50d402cfb4c93492899c7a222ddb6803" title="Get a reference to a subarray." alt="" coords="703,525,861,551"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="729,377,835,403"/>
<area shape="rect" href="classFile__X509.html#ac16dd74cbc682e06b2f35875d04582d1" title="Remove an Extension." alt="" coords="312,153,455,179"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="525,253,633,279"/>
<area shape="rect" href="classFile__X509.html#afc612875837ae70595137c6166f90106" title="Map extension values from extension&#45;specific internal format to octet string." alt="" coords="503,303,655,328"/>
<area shape="rect" href="classFile__X509.html#a28a18c05603a638bcb114897dffeee6d" title="Set an Extension." alt="" coords="327,203,440,228"/>
</map>
</div>

</div>
</div>
<a id="ac3826badcacf04dae2371185f6feddde" name="ac3826badcacf04dae2371185f6feddde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3826badcacf04dae2371185f6feddde">&#9670;&#160;</a></span>signCSR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signCSR </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$signatureAlgorithm</em> = <code>'sha1WithRSAEncryption'</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sign a CSR. </p>
<p>@access public </p><dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03876">3876</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3877</span>    {</div>
<div class="line"><span class="lineno"> 3878</span>        <span class="keywordflow">if</span> (!is_object($this-&gt;privateKey) || empty($this-&gt;dn)) {</div>
<div class="line"><span class="lineno"> 3879</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3880</span>        }</div>
<div class="line"><span class="lineno"> 3881</span> </div>
<div class="line"><span class="lineno"> 3882</span>        $origPublicKey = $this-&gt;publicKey;</div>
<div class="line"><span class="lineno"> 3883</span>        $class = get_class($this-&gt;privateKey);</div>
<div class="line"><span class="lineno"> 3884</span>        $this-&gt;publicKey = <span class="keyword">new</span> $class();</div>
<div class="line"><span class="lineno"> 3885</span>        $this-&gt;publicKey-&gt;loadKey($this-&gt;privateKey-&gt;getPublicKey());</div>
<div class="line"><span class="lineno"> 3886</span>        $this-&gt;publicKey-&gt;setPublicKey();</div>
<div class="line"><span class="lineno"> 3887</span>        <span class="keywordflow">if</span> (!($publicKey = $this-&gt;_formatSubjectPublicKey())) {</div>
<div class="line"><span class="lineno"> 3888</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3889</span>        }</div>
<div class="line"><span class="lineno"> 3890</span>        $this-&gt;publicKey = $origPublicKey;</div>
<div class="line"><span class="lineno"> 3891</span> </div>
<div class="line"><span class="lineno"> 3892</span>        <a class="code hl_variable" href="classFile__X509.html#a13ce82673cd9b9e0aebbd6c10010a686">$currentCert</a> = isset($this-&gt;currentCert) ? $this-&gt;currentCert : <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 3893</span>        <a class="code hl_variable" href="classFile__X509.html#abc5038cc6c10571997d5cef6f7c85782">$signatureSubject</a> = isset($this-&gt;signatureSubject) ? $this-&gt;signatureSubject: <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 3894</span> </div>
<div class="line"><span class="lineno"> 3895</span>        <span class="keywordflow">if</span> (isset($this-&gt;currentCert) &amp;&amp; is_array($this-&gt;currentCert) &amp;&amp; isset($this-&gt;currentCert[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 3896</span>            $this-&gt;currentCert[<span class="stringliteral">&#39;signatureAlgorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>] = $signatureAlgorithm;</div>
<div class="line"><span class="lineno"> 3897</span>            <span class="keywordflow">if</span> (!empty($this-&gt;dn)) {</div>
<div class="line"><span class="lineno"> 3898</span>                $this-&gt;currentCert[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subject&#39;</span>] = $this-&gt;dn;</div>
<div class="line"><span class="lineno"> 3899</span>            }</div>
<div class="line"><span class="lineno"> 3900</span>            $this-&gt;currentCert[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>][<span class="stringliteral">&#39;subjectPKInfo&#39;</span>] = <a class="code hl_variable" href="classFile__X509.html#a8d1062abadc25a988fb1aa01bfea74fe">$publicKey</a>;</div>
<div class="line"><span class="lineno"> 3901</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3902</span>            $this-&gt;currentCert = array(</div>
<div class="line"><span class="lineno"> 3903</span>                <span class="stringliteral">&#39;certificationRequestInfo&#39;</span> =&gt;</div>
<div class="line"><span class="lineno"> 3904</span>                    array(</div>
<div class="line"><span class="lineno"> 3905</span>                        <span class="stringliteral">&#39;version&#39;</span> =&gt; <span class="stringliteral">&#39;v1&#39;</span>,</div>
<div class="line"><span class="lineno"> 3906</span>                        <span class="stringliteral">&#39;subject&#39;</span> =&gt; $this-&gt;dn,</div>
<div class="line"><span class="lineno"> 3907</span>                        <span class="stringliteral">&#39;subjectPKInfo&#39;</span> =&gt; $publicKey</div>
<div class="line"><span class="lineno"> 3908</span>                    ),</div>
<div class="line"><span class="lineno"> 3909</span>                    <span class="stringliteral">&#39;signatureAlgorithm&#39;</span> =&gt; array(<span class="stringliteral">&#39;algorithm&#39;</span> =&gt; $signatureAlgorithm),</div>
<div class="line"><span class="lineno"> 3910</span>                    <span class="stringliteral">&#39;signature&#39;</span>          =&gt; <span class="keyword">false</span> <span class="comment">// this is going to be overwritten later</span></div>
<div class="line"><span class="lineno"> 3911</span>            );</div>
<div class="line"><span class="lineno"> 3912</span>        }</div>
<div class="line"><span class="lineno"> 3913</span> </div>
<div class="line"><span class="lineno"> 3914</span>        <span class="comment">// resync $this-&gt;signatureSubject</span></div>
<div class="line"><span class="lineno"> 3915</span>        <span class="comment">// save $certificationRequestInfo in case there are any File_ASN1_Element objects in it</span></div>
<div class="line"><span class="lineno"> 3916</span>        $certificationRequestInfo = $this-&gt;currentCert[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>];</div>
<div class="line"><span class="lineno"> 3917</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#aa71d96486f43146d0ff5fa6e46167853">loadCSR</a>($this-&gt;<a class="code hl_function" href="classFile__X509.html#a9c1ab61eb1f01e39614b1fb1a99bd202">saveCSR</a>($this-&gt;currentCert));</div>
<div class="line"><span class="lineno"> 3918</span> </div>
<div class="line"><span class="lineno"> 3919</span>        $result = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a26cf1092c86fba52e8cc1bc078ab0b60">_sign</a>($this-&gt;privateKey, $signatureAlgorithm);</div>
<div class="line"><span class="lineno"> 3920</span>        $result[<span class="stringliteral">&#39;certificationRequestInfo&#39;</span>] = $certificationRequestInfo;</div>
<div class="line"><span class="lineno"> 3921</span> </div>
<div class="line"><span class="lineno"> 3922</span>        $this-&gt;currentCert = <a class="code hl_variable" href="classFile__X509.html#a13ce82673cd9b9e0aebbd6c10010a686">$currentCert</a>;</div>
<div class="line"><span class="lineno"> 3923</span>        $this-&gt;signatureSubject = <a class="code hl_variable" href="classFile__X509.html#abc5038cc6c10571997d5cef6f7c85782">$signatureSubject</a>;</div>
<div class="line"><span class="lineno"> 3924</span> </div>
<div class="line"><span class="lineno"> 3925</span>        <span class="keywordflow">return</span> $result;</div>
<div class="line"><span class="lineno"> 3926</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_a9c1ab61eb1f01e39614b1fb1a99bd202"><div class="ttname"><a href="classFile__X509.html#a9c1ab61eb1f01e39614b1fb1a99bd202">File_X509\saveCSR</a></div><div class="ttdeci">saveCSR($csr, $format=FILE_X509_FORMAT_PEM)</div><div class="ttdoc">Save CSR request.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l03346">X509.php:3346</a></div></div>
<div class="ttc" id="aclassFile__X509_html_aa71d96486f43146d0ff5fa6e46167853"><div class="ttname"><a href="classFile__X509.html#aa71d96486f43146d0ff5fa6e46167853">File_X509\loadCSR</a></div><div class="ttdeci">loadCSR($csr, $mode=FILE_X509_FORMAT_AUTO_DETECT)</div><div class="ttdoc">Load a Certificate Signing Request.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l03259">X509.php:3259</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04849">_formatSubjectPublicKey()</a>, <a class="el" href="X509_8php_source.html#l04137">_sign()</a>, <a class="el" href="X509_8php_source.html#l03259">loadCSR()</a>, and <a class="el" href="X509_8php_source.html#l03346">saveCSR()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_ac3826badcacf04dae2371185f6feddde_cgraph.png" border="0" usemap="#aclassFile__X509_ac3826badcacf04dae2371185f6feddde_cgraph" alt=""/></div>
<map name="aclassFile__X509_ac3826badcacf04dae2371185f6feddde_cgraph" id="aclassFile__X509_ac3826badcacf04dae2371185f6feddde_cgraph">
<area shape="rect" title="Sign a CSR." alt="" coords="5,108,80,133"/>
<area shape="rect" href="classFile__X509.html#abd3e81dc470c99af40c0aee99fcdab75" title="Format a public key as appropriate." alt="" coords="128,33,312,59"/>
<area shape="rect" href="classFile__X509.html#a26cf1092c86fba52e8cc1bc078ab0b60" title="X.509 certificate signing helper function." alt="" coords="192,83,248,108"/>
<area shape="rect" href="classFile__X509.html#aa71d96486f43146d0ff5fa6e46167853" title="Load a Certificate Signing Request." alt="" coords="182,132,258,157"/>
<area shape="rect" href="classFile__X509.html#a9c1ab61eb1f01e39614b1fb1a99bd202" title="Save CSR request." alt="" coords="181,333,259,359"/>
<area shape="rect" href="classFile__X509.html#a009e0a2396931d62c87d27f4e2372024" title="Extract raw BER from Base64 encoding." alt="" coords="382,83,483,108"/>
<area shape="rect" href="classFile__X509.html#acab7579764a0d5973b94cd8bf1c64092" title="Map attribute values from ANY type to attribute&#45;specific internal format." alt="" coords="365,132,500,157"/>
<area shape="rect" href="classFile__X509.html#a016c0c81b4115631a081d91036c8839f" title="Map DN values from ANY type to DN&#45;specific internal format." alt="" coords="581,259,678,284"/>
<area shape="rect" href="classFile__X509.html#a195dac5d2b72ef86fe28250ea43343b8" title="Reformat public keys." alt="" coords="377,33,488,59"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="779,233,886,259"/>
<area shape="rect" href="classFile__X509.html#ad60bc52a972cab9df3fc002a25de16dc" title="Check for validity of subarray." alt="" coords="564,107,695,132"/>
<area shape="rect" href="classFile__X509.html#a0c34c28604781bdc296e7ade6951a734" title="Map extension values from octet string to extension&#45;specific internal format." alt="" coords="559,5,700,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="789,332,876,357"/>
<area shape="rect" href="classFile__X509.html#a50d402cfb4c93492899c7a222ddb6803" title="Get a reference to a subarray." alt="" coords="753,5,912,31"/>
<area shape="rect" href="classFile__X509.html#acb6786d74bfd53b1a57ea5f72de69ab5" title="Map attribute values from attribute&#45;specific internal format to ANY type." alt="" coords="360,308,505,333"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="575,357,683,383"/>
<area shape="rect" href="classFile__X509.html#afc612875837ae70595137c6166f90106" title="Map extension values from extension&#45;specific internal format to octet string." alt="" coords="553,308,705,333"/>
</map>
</div>

</div>
</div>
<a id="a7579e46dcabbf3bff17d8e31f1b2cb25" name="a7579e46dcabbf3bff17d8e31f1b2cb25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7579e46dcabbf3bff17d8e31f1b2cb25">&#9670;&#160;</a></span>signSPKAC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signSPKAC </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$signatureAlgorithm</em> = <code>'sha1WithRSAEncryption'</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sign a SPKAC. </p>
<p>@access public </p><dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l03934">3934</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3935</span>    {</div>
<div class="line"><span class="lineno"> 3936</span>        <span class="keywordflow">if</span> (!is_object($this-&gt;privateKey)) {</div>
<div class="line"><span class="lineno"> 3937</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3938</span>        }</div>
<div class="line"><span class="lineno"> 3939</span> </div>
<div class="line"><span class="lineno"> 3940</span>        $origPublicKey = $this-&gt;publicKey;</div>
<div class="line"><span class="lineno"> 3941</span>        $class = get_class($this-&gt;privateKey);</div>
<div class="line"><span class="lineno"> 3942</span>        $this-&gt;publicKey = <span class="keyword">new</span> $class();</div>
<div class="line"><span class="lineno"> 3943</span>        $this-&gt;publicKey-&gt;loadKey($this-&gt;privateKey-&gt;getPublicKey());</div>
<div class="line"><span class="lineno"> 3944</span>        $this-&gt;publicKey-&gt;setPublicKey();</div>
<div class="line"><span class="lineno"> 3945</span>        $publicKey = $this-&gt;_formatSubjectPublicKey();</div>
<div class="line"><span class="lineno"> 3946</span>        <span class="keywordflow">if</span> (!$publicKey) {</div>
<div class="line"><span class="lineno"> 3947</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3948</span>        }</div>
<div class="line"><span class="lineno"> 3949</span>        $this-&gt;publicKey = $origPublicKey;</div>
<div class="line"><span class="lineno"> 3950</span> </div>
<div class="line"><span class="lineno"> 3951</span>        <a class="code hl_variable" href="classFile__X509.html#a13ce82673cd9b9e0aebbd6c10010a686">$currentCert</a> = isset($this-&gt;currentCert) ? $this-&gt;currentCert : <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 3952</span>        <a class="code hl_variable" href="classFile__X509.html#abc5038cc6c10571997d5cef6f7c85782">$signatureSubject</a> = isset($this-&gt;signatureSubject) ? $this-&gt;signatureSubject: <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 3953</span> </div>
<div class="line"><span class="lineno"> 3954</span>        <span class="comment">// re-signing a SPKAC seems silly but since everything else supports re-signing why not?</span></div>
<div class="line"><span class="lineno"> 3955</span>        <span class="keywordflow">if</span> (isset($this-&gt;currentCert) &amp;&amp; is_array($this-&gt;currentCert) &amp;&amp; isset($this-&gt;currentCert[<span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 3956</span>            $this-&gt;currentCert[<span class="stringliteral">&#39;signatureAlgorithm&#39;</span>][<span class="stringliteral">&#39;algorithm&#39;</span>] = $signatureAlgorithm;</div>
<div class="line"><span class="lineno"> 3957</span>            $this-&gt;currentCert[<span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span>][<span class="stringliteral">&#39;spki&#39;</span>] = <a class="code hl_variable" href="classFile__X509.html#a8d1062abadc25a988fb1aa01bfea74fe">$publicKey</a>;</div>
<div class="line"><span class="lineno"> 3958</span>            <span class="keywordflow">if</span> (!empty($this-&gt;challenge)) {</div>
<div class="line"><span class="lineno"> 3959</span>                <span class="comment">// the bitwise AND ensures that the output is a valid IA5String</span></div>
<div class="line"><span class="lineno"> 3960</span>                $this-&gt;currentCert[<span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span>][<span class="stringliteral">&#39;challenge&#39;</span>] = $this-&gt;challenge &amp; str_repeat(<span class="stringliteral">&quot;\x7F&quot;</span>, strlen($this-&gt;challenge));</div>
<div class="line"><span class="lineno"> 3961</span>            }</div>
<div class="line"><span class="lineno"> 3962</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3963</span>            $this-&gt;currentCert = array(</div>
<div class="line"><span class="lineno"> 3964</span>                <span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span> =&gt;</div>
<div class="line"><span class="lineno"> 3965</span>                    array(</div>
<div class="line"><span class="lineno"> 3966</span>                        <span class="stringliteral">&#39;spki&#39;</span> =&gt; $publicKey,</div>
<div class="line"><span class="lineno"> 3967</span>                        <span class="comment">// quoting &lt;https://developer.mozilla.org/en-US/docs/Web/HTML/Element/keygen&gt;,</span></div>
<div class="line"><span class="lineno"> 3968</span>                        <span class="comment">// &quot;A challenge string that is submitted along with the public key. Defaults to an empty string if not specified.&quot;</span></div>
<div class="line"><span class="lineno"> 3969</span>                        <span class="comment">// both Firefox and OpenSSL (&quot;openssl spkac -key private.key&quot;) behave this way</span></div>
<div class="line"><span class="lineno"> 3970</span>                        <span class="comment">// we could alternatively do this instead if we ignored the specs:</span></div>
<div class="line"><span class="lineno"> 3971</span>                        <span class="comment">// crypt_random_string(8) &amp; str_repeat(&quot;\x7F&quot;, 8)</span></div>
<div class="line"><span class="lineno"> 3972</span>                        <span class="stringliteral">&#39;challenge&#39;</span> =&gt; !empty($this-&gt;challenge) ? $this-&gt;challenge : <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 3973</span>                    ),</div>
<div class="line"><span class="lineno"> 3974</span>                    <span class="stringliteral">&#39;signatureAlgorithm&#39;</span> =&gt; array(<span class="stringliteral">&#39;algorithm&#39;</span> =&gt; $signatureAlgorithm),</div>
<div class="line"><span class="lineno"> 3975</span>                    <span class="stringliteral">&#39;signature&#39;</span>          =&gt; <span class="keyword">false</span> <span class="comment">// this is going to be overwritten later</span></div>
<div class="line"><span class="lineno"> 3976</span>            );</div>
<div class="line"><span class="lineno"> 3977</span>        }</div>
<div class="line"><span class="lineno"> 3978</span> </div>
<div class="line"><span class="lineno"> 3979</span>        <span class="comment">// resync $this-&gt;signatureSubject</span></div>
<div class="line"><span class="lineno"> 3980</span>        <span class="comment">// save $publicKeyAndChallenge in case there are any File_ASN1_Element objects in it</span></div>
<div class="line"><span class="lineno"> 3981</span>        $publicKeyAndChallenge = $this-&gt;currentCert[<span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span>];</div>
<div class="line"><span class="lineno"> 3982</span>        $this-&gt;<a class="code hl_function" href="classFile__X509.html#ae796e46a18066a3b745a279fad143dbb">loadSPKAC</a>($this-&gt;<a class="code hl_function" href="classFile__X509.html#ac6079ff51d79eadb1bb21c2342f9d0d0">saveSPKAC</a>($this-&gt;currentCert));</div>
<div class="line"><span class="lineno"> 3983</span> </div>
<div class="line"><span class="lineno"> 3984</span>        $result = $this-&gt;<a class="code hl_function" href="classFile__X509.html#a26cf1092c86fba52e8cc1bc078ab0b60">_sign</a>($this-&gt;privateKey, $signatureAlgorithm);</div>
<div class="line"><span class="lineno"> 3985</span>        $result[<span class="stringliteral">&#39;publicKeyAndChallenge&#39;</span>] = $publicKeyAndChallenge;</div>
<div class="line"><span class="lineno"> 3986</span> </div>
<div class="line"><span class="lineno"> 3987</span>        $this-&gt;currentCert = <a class="code hl_variable" href="classFile__X509.html#a13ce82673cd9b9e0aebbd6c10010a686">$currentCert</a>;</div>
<div class="line"><span class="lineno"> 3988</span>        $this-&gt;signatureSubject = <a class="code hl_variable" href="classFile__X509.html#abc5038cc6c10571997d5cef6f7c85782">$signatureSubject</a>;</div>
<div class="line"><span class="lineno"> 3989</span> </div>
<div class="line"><span class="lineno"> 3990</span>        <span class="keywordflow">return</span> $result;</div>
<div class="line"><span class="lineno"> 3991</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_ac6079ff51d79eadb1bb21c2342f9d0d0"><div class="ttname"><a href="classFile__X509.html#ac6079ff51d79eadb1bb21c2342f9d0d0">File_X509\saveSPKAC</a></div><div class="ttdeci">saveSPKAC($spkac, $format=FILE_X509_FORMAT_PEM)</div><div class="ttdoc">Save a SPKAC CSR request.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l03478">X509.php:3478</a></div></div>
<div class="ttc" id="aclassFile__X509_html_ae796e46a18066a3b745a279fad143dbb"><div class="ttname"><a href="classFile__X509.html#ae796e46a18066a3b745a279fad143dbb">File_X509\loadSPKAC</a></div><div class="ttdeci">loadSPKAC($spkac)</div><div class="ttdoc">Load a SPKAC CSR.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l03401">X509.php:3401</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04849">_formatSubjectPublicKey()</a>, <a class="el" href="X509_8php_source.html#l04137">_sign()</a>, <a class="el" href="X509_8php_source.html#l03401">loadSPKAC()</a>, and <a class="el" href="X509_8php_source.html#l03478">saveSPKAC()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a7579e46dcabbf3bff17d8e31f1b2cb25_cgraph.png" border="0" usemap="#aclassFile__X509_a7579e46dcabbf3bff17d8e31f1b2cb25_cgraph" alt=""/></div>
<map name="aclassFile__X509_a7579e46dcabbf3bff17d8e31f1b2cb25_cgraph" id="aclassFile__X509_a7579e46dcabbf3bff17d8e31f1b2cb25_cgraph">
<area shape="rect" title="Sign a SPKAC." alt="" coords="5,80,97,105"/>
<area shape="rect" href="classFile__X509.html#abd3e81dc470c99af40c0aee99fcdab75" title="Format a public key as appropriate." alt="" coords="145,5,329,31"/>
<area shape="rect" href="classFile__X509.html#a26cf1092c86fba52e8cc1bc078ab0b60" title="X.509 certificate signing helper function." alt="" coords="209,55,265,80"/>
<area shape="rect" href="classFile__X509.html#ae796e46a18066a3b745a279fad143dbb" title="Load a SPKAC CSR." alt="" coords="191,104,284,129"/>
<area shape="rect" href="classFile__X509.html#ac6079ff51d79eadb1bb21c2342f9d0d0" title="Save a SPKAC CSR request." alt="" coords="189,153,285,179"/>
<area shape="rect" href="classFile__X509.html#a195dac5d2b72ef86fe28250ea43343b8" title="Reformat public keys." alt="" coords="377,104,488,129"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="389,153,476,179"/>
</map>
</div>

</div>
</div>
<a id="a8ca4f043b6d009999c7b86d6f8b939cc" name="a8ca4f043b6d009999c7b86d6f8b939cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ca4f043b6d009999c7b86d6f8b939cc">&#9670;&#160;</a></span>unrevoke()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unrevoke </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$serial</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unrevoke a certificate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$serial</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l04994">4994</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4995</span>    {</div>
<div class="line"><span class="lineno"> 4996</span>        <span class="keywordflow">if</span> (is_array($rclist = &amp;$this-&gt;_subArray($this-&gt;currentCert, <span class="stringliteral">&#39;tbsCertList/revokedCertificates&#39;</span>))) {</div>
<div class="line"><span class="lineno"> 4997</span>            <span class="keywordflow">if</span> (($i = $this-&gt;_revokedCertificate($rclist, $serial)) !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 4998</span>                unset($rclist[$i]);</div>
<div class="line"><span class="lineno"> 4999</span>                $rclist = array_values($rclist);</div>
<div class="line"><span class="lineno"> 5000</span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 5001</span>            }</div>
<div class="line"><span class="lineno"> 5002</span>        }</div>
<div class="line"><span class="lineno"> 5003</span> </div>
<div class="line"><span class="lineno"> 5004</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 5005</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l04933">_revokedCertificate()</a>, and <a class="el" href="X509_8php_source.html#l04305">_subArray()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a8ca4f043b6d009999c7b86d6f8b939cc_cgraph.png" border="0" usemap="#aclassFile__X509_a8ca4f043b6d009999c7b86d6f8b939cc_cgraph" alt=""/></div>
<map name="aclassFile__X509_a8ca4f043b6d009999c7b86d6f8b939cc_cgraph" id="aclassFile__X509_a8ca4f043b6d009999c7b86d6f8b939cc_cgraph">
<area shape="rect" title="Unrevoke a certificate." alt="" coords="5,31,88,56"/>
<area shape="rect" href="classFile__X509.html#a8fd951ac4d21092f644bd6528c171bcb" title="Get the index of a revoked certificate." alt="" coords="136,5,284,31"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="167,55,253,80"/>
<area shape="rect" href="classFile__X509.html#a8aecc48efc4e9677b47bd540fc26a089" title="Helper function to build a time field according to RFC 3280 section." alt="" coords="332,5,423,31"/>
</map>
</div>

</div>
</div>
<a id="a22e26094b927b4a84167ccc395d92571" name="a22e26094b927b4a84167ccc395d92571"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22e26094b927b4a84167ccc395d92571">&#9670;&#160;</a></span>validateDate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">validateDate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$date</em> = <code>null</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validate a date. </p>
<p>If $date isn't defined it is assumed to be the current date.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\DateTime&#160;|&#160;int&#160;|&#160;string</td><td class="paramname">$date</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02145">2145</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2146</span>    {</div>
<div class="line"><span class="lineno"> 2147</span>        <span class="keywordflow">if</span> (!is_array($this-&gt;currentCert) || !isset($this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2148</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2149</span>        }</div>
<div class="line"><span class="lineno"> 2150</span> </div>
<div class="line"><span class="lineno"> 2151</span>        <span class="keywordflow">if</span> (!isset($date)) {</div>
<div class="line"><span class="lineno"> 2152</span>            $date = class_exists(<span class="stringliteral">&#39;DateTime&#39;</span>) ?</div>
<div class="line"><span class="lineno"> 2153</span>                <span class="keyword">new</span> DateTime(<span class="keyword">null</span>, <span class="keyword">new</span> DateTimeZone(@date_default_timezone_get())) :</div>
<div class="line"><span class="lineno"> 2154</span>                time();</div>
<div class="line"><span class="lineno"> 2155</span>        }</div>
<div class="line"><span class="lineno"> 2156</span> </div>
<div class="line"><span class="lineno"> 2157</span>        $notBefore = $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;validity&#39;</span>][<span class="stringliteral">&#39;notBefore&#39;</span>];</div>
<div class="line"><span class="lineno"> 2158</span>        $notBefore = isset($notBefore[<span class="stringliteral">&#39;generalTime&#39;</span>]) ? $notBefore[<span class="stringliteral">&#39;generalTime&#39;</span>] : $notBefore[<span class="stringliteral">&#39;utcTime&#39;</span>];</div>
<div class="line"><span class="lineno"> 2159</span> </div>
<div class="line"><span class="lineno"> 2160</span>        $notAfter = $this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>][<span class="stringliteral">&#39;validity&#39;</span>][<span class="stringliteral">&#39;notAfter&#39;</span>];</div>
<div class="line"><span class="lineno"> 2161</span>        $notAfter = isset($notAfter[<span class="stringliteral">&#39;generalTime&#39;</span>]) ? $notAfter[<span class="stringliteral">&#39;generalTime&#39;</span>] : $notAfter[<span class="stringliteral">&#39;utcTime&#39;</span>];</div>
<div class="line"><span class="lineno"> 2162</span> </div>
<div class="line"><span class="lineno"> 2163</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2164</span>            <span class="keywordflow">case</span> is_string($date) &amp;&amp; class_exists(<span class="stringliteral">&#39;DateTime&#39;</span>):</div>
<div class="line"><span class="lineno"> 2165</span>                $date = new DateTime($date, new DateTimeZone(@date_default_timezone_get()));</div>
<div class="line"><span class="lineno"> 2166</span>            <span class="keywordflow">case</span> is_object($date) &amp;&amp; strtolower(get_class($date)) == <span class="stringliteral">&#39;datetime&#39;</span>:</div>
<div class="line"><span class="lineno"> 2167</span>                $notBefore = <span class="keyword">new</span> DateTime($notBefore, <span class="keyword">new</span> DateTimeZone(@date_default_timezone_get()));</div>
<div class="line"><span class="lineno"> 2168</span>                $notAfter = <span class="keyword">new</span> DateTime($notAfter, <span class="keyword">new</span> DateTimeZone(@date_default_timezone_get()));</div>
<div class="line"><span class="lineno"> 2169</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2170</span>            <span class="keywordflow">case</span> is_string($date):</div>
<div class="line"><span class="lineno"> 2171</span>                $date = @strtotime($date);</div>
<div class="line"><span class="lineno"> 2172</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2173</span>                $notBefore = @strtotime($notBefore);</div>
<div class="line"><span class="lineno"> 2174</span>                $notAfter = @strtotime($notAfter);</div>
<div class="line"><span class="lineno"> 2175</span>        }</div>
<div class="line"><span class="lineno"> 2176</span> </div>
<div class="line"><span class="lineno"> 2177</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2178</span>            <span class="keywordflow">case</span> $date &lt; $notBefore:</div>
<div class="line"><span class="lineno"> 2179</span>            <span class="keywordflow">case</span> $date &gt; $notAfter:</div>
<div class="line"><span class="lineno"> 2180</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2181</span>        }</div>
<div class="line"><span class="lineno"> 2182</span> </div>
<div class="line"><span class="lineno"> 2183</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2184</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a63e18ebfa877fefabf86d16e0e2ceeaa" name="a63e18ebfa877fefabf86d16e0e2ceeaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63e18ebfa877fefabf86d16e0e2ceeaa">&#9670;&#160;</a></span>validateSignature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">validateSignature </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$caonly</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validate a signature. </p>
<p>Works on X.509 certs, CSR's and CRL's. Returns true if the signature is verified, false if it is not correct or null on error</p>
<p>By default returns false for self-signed certs. Call validateSignature(false) to make this support self-signed.</p>
<p>The behavior of this function is inspired by <code><a class="el" href="">openssl_verify</a></code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">bool</td><td class="paramname">$caonly</td><td>optional @access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixed </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02316">2316</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2317</span>    {</div>
<div class="line"><span class="lineno"> 2318</span>        <span class="keywordflow">return</span> $this-&gt;_validateSignatureCountable($caonly, 0);</div>
<div class="line"><span class="lineno"> 2319</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l02331">_validateSignatureCountable()</a>.</p>

<p class="reference">Referenced by <a class="el" href="X509_8php_source.html#l02331">_validateSignatureCountable()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a63e18ebfa877fefabf86d16e0e2ceeaa_cgraph.png" border="0" usemap="#aclassFile__X509_a63e18ebfa877fefabf86d16e0e2ceeaa_cgraph" alt=""/></div>
<map name="aclassFile__X509_a63e18ebfa877fefabf86d16e0e2ceeaa_cgraph" id="aclassFile__X509_a63e18ebfa877fefabf86d16e0e2ceeaa_cgraph">
<area shape="rect" title="Validate a signature." alt="" coords="5,107,143,132"/>
<area shape="rect" href="classFile__X509.html#a96ee8b07aceb37a5d949447f7349bf12" title="Validate a signature." alt="" coords="191,107,401,132"/>
<area shape="rect" href="classFile__X509.html#acc2e876f81f33f786d44175e43f96727" title="Validates an intermediate cert as identified via authority info access extension." alt="" coords="449,5,608,31"/>
<area shape="rect" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb" title="Get a certificate, CSR or CRL Extension." alt="" coords="656,56,763,81"/>
<area shape="rect" href="classFile__X509.html#ab87ce13c549a27cee379b3634e7c02f1" title="Validates a signature." alt="" coords="457,107,601,132"/>
<area shape="rect" href="classFile__X509.html#a97392a261d56bd64002da7d1e76e8195" title="Get the Distinguished Name for a certificates subject." alt="" coords="678,157,741,183"/>
<area shape="rect" href="classFile__X509.html#a1d9888293c71b3fe2d087776ca31c0eb" title="Get the Distinguished Name for a certificate/crl issuer." alt="" coords="477,208,580,233"/>
<area shape="rect" href="classFile__X509.html#a84e2629a56c47e5e90ab3a2a0aaf1bda" title="Fetches a URL." alt="" coords="665,5,753,31"/>
<area shape="rect" href="classFile__X509.html#a51d0ffadbcbf965b23238b89fef03484" title="Get an Extension." alt="" coords="811,56,925,81"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="977,56,1077,81"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="1128,81,1215,107"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="814,157,922,183"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="973,157,1080,183"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_a63e18ebfa877fefabf86d16e0e2ceeaa_icgraph.png" border="0" usemap="#aclassFile__X509_a63e18ebfa877fefabf86d16e0e2ceeaa_icgraph" alt=""/></div>
<map name="aclassFile__X509_a63e18ebfa877fefabf86d16e0e2ceeaa_icgraph" id="aclassFile__X509_a63e18ebfa877fefabf86d16e0e2ceeaa_icgraph">
<area shape="rect" title="Validate a signature." alt="" coords="264,5,401,31"/>
<area shape="rect" href="classFile__X509.html#a96ee8b07aceb37a5d949447f7349bf12" title="Validate a signature." alt="" coords="5,5,216,31"/>
</map>
</div>

</div>
</div>
<a id="afad375b8ebfbf0ed26dc7f1bb74e9ad3" name="afad375b8ebfbf0ed26dc7f1bb74e9ad3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afad375b8ebfbf0ed26dc7f1bb74e9ad3">&#9670;&#160;</a></span>validateURL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">validateURL </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$url</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validate an X.509 certificate against a URL. </p>
<p>From RFC2818 "HTTP over TLS":</p>
<p>Matching is performed using the matching rules specified by [RFC2459]. If more than one identity of a given type is present in the certificate (e.g., more than one dNSName name, a match in any one of the set is considered acceptable.) Names may contain the wildcard character * which is considered to match any single domain name component or component fragment. E.g., *.a.com matches foo.a.com but not bar.foo.a.com. f*.com matches foo.com but not bar.com.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$url</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l02086">2086</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2087</span>    {</div>
<div class="line"><span class="lineno"> 2088</span>        <span class="keywordflow">if</span> (!is_array($this-&gt;currentCert) || !isset($this-&gt;currentCert[<span class="stringliteral">&#39;tbsCertificate&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2089</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2090</span>        }</div>
<div class="line"><span class="lineno"> 2091</span> </div>
<div class="line"><span class="lineno"> 2092</span>        $components = parse_url($url);</div>
<div class="line"><span class="lineno"> 2093</span>        <span class="keywordflow">if</span> (!isset($components[<span class="stringliteral">&#39;host&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2094</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2095</span>        }</div>
<div class="line"><span class="lineno"> 2096</span> </div>
<div class="line"><span class="lineno"> 2097</span>        <span class="keywordflow">if</span> ($names = $this-&gt;<a class="code hl_function" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb">getExtension</a>(<span class="stringliteral">&#39;id-ce-subjectAltName&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 2098</span>            <span class="keywordflow">foreach</span> ($names as $name) {</div>
<div class="line"><span class="lineno"> 2099</span>                <span class="keywordflow">foreach</span> ($name as $key =&gt; $value) {</div>
<div class="line"><span class="lineno"> 2100</span>                    $value = str_replace(array(<span class="charliteral">&#39;.&#39;</span>, <span class="charliteral">&#39;*&#39;</span>), array(<span class="charliteral">&#39;\.&#39;</span>, <span class="stringliteral">&#39;[^.]*&#39;</span>), $value);</div>
<div class="line"><span class="lineno"> 2101</span>                    <span class="keywordflow">switch</span> ($key) {</div>
<div class="line"><span class="lineno"> 2102</span>                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;dNSName&#39;</span>:</div>
<div class="line"><span class="lineno"> 2103</span>                            <span class="comment">/* From RFC2818 &quot;HTTP over TLS&quot;:</span></div>
<div class="line"><span class="lineno"> 2104</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 2105</span><span class="comment">                               If a subjectAltName extension of type dNSName is present, that MUST</span></div>
<div class="line"><span class="lineno"> 2106</span><span class="comment">                               be used as the identity. Otherwise, the (most specific) Common Name</span></div>
<div class="line"><span class="lineno"> 2107</span><span class="comment">                               field in the Subject field of the certificate MUST be used. Although</span></div>
<div class="line"><span class="lineno"> 2108</span><span class="comment">                               the use of the Common Name is existing practice, it is deprecated and</span></div>
<div class="line"><span class="lineno"> 2109</span><span class="comment">                               Certification Authorities are encouraged to use the dNSName instead. */</span></div>
<div class="line"><span class="lineno"> 2110</span>                            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;#^&#39;</span> . $value . <span class="stringliteral">&#39;$#&#39;</span>, $components[<span class="stringliteral">&#39;host&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2111</span>                                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2112</span>                            }</div>
<div class="line"><span class="lineno"> 2113</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2114</span>                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;iPAddress&#39;</span>:</div>
<div class="line"><span class="lineno"> 2115</span>                            <span class="comment">/* From RFC2818 &quot;HTTP over TLS&quot;:</span></div>
<div class="line"><span class="lineno"> 2116</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 2117</span><span class="comment">                               In some cases, the URI is specified as an IP address rather than a</span></div>
<div class="line"><span class="lineno"> 2118</span><span class="comment">                               hostname. In this case, the iPAddress subjectAltName must be present</span></div>
<div class="line"><span class="lineno"> 2119</span><span class="comment">                               in the certificate and must exactly match the IP in the URI. */</span></div>
<div class="line"><span class="lineno"> 2120</span>                            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;#(?:\d{1-3}\.){4}#&#39;</span>, $components[<span class="stringliteral">&#39;host&#39;</span>] . <span class="charliteral">&#39;.&#39;</span>) &amp;&amp; preg_match(<span class="stringliteral">&#39;#^&#39;</span> . $value . <span class="stringliteral">&#39;$#&#39;</span>, $components[<span class="stringliteral">&#39;host&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 2121</span>                                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2122</span>                            }</div>
<div class="line"><span class="lineno"> 2123</span>                    }</div>
<div class="line"><span class="lineno"> 2124</span>                }</div>
<div class="line"><span class="lineno"> 2125</span>            }</div>
<div class="line"><span class="lineno"> 2126</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2127</span>        }</div>
<div class="line"><span class="lineno"> 2128</span> </div>
<div class="line"><span class="lineno"> 2129</span>        <span class="keywordflow">if</span> ($value = $this-&gt;<a class="code hl_function" href="classFile__X509.html#aa5e331e0ded7b3d7a76452ba6ff70194">getDNProp</a>(<span class="stringliteral">&#39;id-at-commonName&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 2130</span>            $value = str_replace(array(<span class="charliteral">&#39;.&#39;</span>, <span class="charliteral">&#39;*&#39;</span>), array(<span class="charliteral">&#39;\.&#39;</span>, <span class="stringliteral">&#39;[^.]*&#39;</span>), $value[0]);</div>
<div class="line"><span class="lineno"> 2131</span>            <span class="keywordflow">return</span> preg_match(<span class="stringliteral">&#39;#^&#39;</span> . $value . <span class="stringliteral">&#39;$#&#39;</span>, $components[<span class="stringliteral">&#39;host&#39;</span>]);</div>
<div class="line"><span class="lineno"> 2132</span>        }</div>
<div class="line"><span class="lineno"> 2133</span> </div>
<div class="line"><span class="lineno"> 2134</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2135</span>    }</div>
<div class="ttc" id="aclassFile__X509_html_aa5e331e0ded7b3d7a76452ba6ff70194"><div class="ttname"><a href="classFile__X509.html#aa5e331e0ded7b3d7a76452ba6ff70194">File_X509\getDNProp</a></div><div class="ttdeci">getDNProp($propName, $dn=null, $withType=false)</div><div class="ttdoc">Get Distinguished Name properties.</div><div class="ttdef"><b>Definition:</b> <a href="X509_8php_source.html#l02776">X509.php:2776</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="X509_8php_source.html#l02776">getDNProp()</a>, and <a class="el" href="X509_8php_source.html#l04527">getExtension()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__X509_afad375b8ebfbf0ed26dc7f1bb74e9ad3_cgraph.png" border="0" usemap="#aclassFile__X509_afad375b8ebfbf0ed26dc7f1bb74e9ad3_cgraph" alt=""/></div>
<map name="aclassFile__X509_afad375b8ebfbf0ed26dc7f1bb74e9ad3_cgraph" id="aclassFile__X509_afad375b8ebfbf0ed26dc7f1bb74e9ad3_cgraph">
<area shape="rect" title="Validate an X.509 certificate against a URL." alt="" coords="5,100,107,125"/>
<area shape="rect" href="classFile__X509.html#aa5e331e0ded7b3d7a76452ba6ff70194" title="Get Distinguished Name properties." alt="" coords="162,63,254,88"/>
<area shape="rect" href="classFile__X509.html#afc1207c2b7e8e70f61598815ee07fcdb" title="Get a certificate, CSR or CRL Extension." alt="" coords="155,124,261,149"/>
<area shape="rect" href="classFile__X509.html#ab691691d441dc6983a12a28ab3e0db1f" title="Associate an extension ID to an extension mapping." alt="" coords="493,5,600,31"/>
<area shape="rect" href="classFile__X509.html#add37e36fc7605e4b4d1d6f1dc061983c" title="Map DN values from DN&#45;specific internal format to ANY type." alt="" coords="323,49,431,75"/>
<area shape="rect" href="classFile__X509.html#ad4e0267f8e236f9707325bce89ce2b0a" title="&quot;Normalizes&quot; a Distinguished Name property" alt="" coords="309,99,445,124"/>
<area shape="rect" href="classFile__X509.html#aa200f8fe0af46a9daef5d95bfe2ce471" title="Get a reference to a subarray." alt="" coords="648,99,735,124"/>
<area shape="rect" href="classFile__X509.html#a51d0ffadbcbf965b23238b89fef03484" title="Get an Extension." alt="" coords="320,148,435,173"/>
<area shape="rect" href="classFile__X509.html#a8524c1f84d3dc74f7dd247fd12a122e6" title="Get a reference to an extension subarray." alt="" coords="497,124,597,149"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a id="a857632ef8e304de8304c04bd9d8b6ff3" name="a857632ef8e304de8304c04bd9d8b6ff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a857632ef8e304de8304c04bd9d8b6ff3">&#9670;&#160;</a></span>$AttributeValue</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$AttributeValue</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00153">153</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a2f1b3d83907dad45c90204f75ccca97a" name="a2f1b3d83907dad45c90204f75ccca97a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f1b3d83907dad45c90204f75ccca97a">&#9670;&#160;</a></span>$AuthorityInfoAccessSyntax</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$AuthorityInfoAccessSyntax</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00162">162</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="aa22f5ca854f976db49bd0e5a2a702d8b" name="aa22f5ca854f976db49bd0e5a2a702d8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa22f5ca854f976db49bd0e5a2a702d8b">&#9670;&#160;</a></span>$AuthorityKeyIdentifier</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$AuthorityKeyIdentifier</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00160">160</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="af6f7cd75bf049b48d346d94ec6cfce0b" name="af6f7cd75bf049b48d346d94ec6cfce0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6f7cd75bf049b48d346d94ec6cfce0b">&#9670;&#160;</a></span>$BasicConstraints</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$BasicConstraints</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00157">157</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="aae2ec3b0fb507ac82ccbfbbedfa9b864" name="aae2ec3b0fb507ac82ccbfbbedfa9b864"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae2ec3b0fb507ac82ccbfbbedfa9b864">&#9670;&#160;</a></span>$caFlag</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$caFlag = false</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00313">313</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="ae9842d7405c8068070534e0fb485abe0" name="ae9842d7405c8068070534e0fb485abe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9842d7405c8068070534e0fb485abe0">&#9670;&#160;</a></span>$CAs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$CAs</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00251">251</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a81539de76c2aedb72804271f0babf584" name="a81539de76c2aedb72804271f0babf584"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81539de76c2aedb72804271f0babf584">&#9670;&#160;</a></span>$Certificate</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$Certificate</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00144">144</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a95e381d17d40c84aad41995e0806edf6" name="a95e381d17d40c84aad41995e0806edf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95e381d17d40c84aad41995e0806edf6">&#9670;&#160;</a></span>$CertificateIssuer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$CertificateIssuer</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00183">183</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="ae7bc8a9e6dcb09461949fb23697f70fc" name="ae7bc8a9e6dcb09461949fb23697f70fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7bc8a9e6dcb09461949fb23697f70fc">&#9670;&#160;</a></span>$CertificateList</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$CertificateList</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00210">210</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a3993c66da20de874ad6e3d72fc94730d" name="a3993c66da20de874ad6e3d72fc94730d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3993c66da20de874ad6e3d72fc94730d">&#9670;&#160;</a></span>$CertificatePolicies</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$CertificatePolicies</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00161">161</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a4873356d11288f27532dfe1cb94725d3" name="a4873356d11288f27532dfe1cb94725d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4873356d11288f27532dfe1cb94725d3">&#9670;&#160;</a></span>$CertificationRequest</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$CertificationRequest</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00202">202</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a2eda9302616e36a3bbed9c5769b2fbdb" name="a2eda9302616e36a3bbed9c5769b2fbdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eda9302616e36a3bbed9c5769b2fbdb">&#9670;&#160;</a></span>$challenge</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$challenge</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00321">321</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a978b13df42e0d99d24b79e21763bb34f" name="a978b13df42e0d99d24b79e21763bb34f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a978b13df42e0d99d24b79e21763bb34f">&#9670;&#160;</a></span>$CPSuri</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$CPSuri</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00170">170</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a1c361644212b39f2db0dcd26d787028d" name="a1c361644212b39f2db0dcd26d787028d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c361644212b39f2db0dcd26d787028d">&#9670;&#160;</a></span>$CRLDistributionPoints</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$CRLDistributionPoints</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00159">159</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a2f8be9ea21954d157e3a2bb1647b6a16" name="a2f8be9ea21954d157e3a2bb1647b6a16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f8be9ea21954d157e3a2bb1647b6a16">&#9670;&#160;</a></span>$CRLNumber</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$CRLNumber</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00179">179</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a9771dd54b9a2c36930b559656b5263af" name="a9771dd54b9a2c36930b559656b5263af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9771dd54b9a2c36930b559656b5263af">&#9670;&#160;</a></span>$CRLReason</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$CRLReason</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00180">180</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a13ce82673cd9b9e0aebbd6c10010a686" name="a13ce82673cd9b9e0aebbd6c10010a686"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13ce82673cd9b9e0aebbd6c10010a686">&#9670;&#160;</a></span>$currentCert</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$currentCert</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00259">259</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="afe105562ae62a8d6ed648ead14d2677c" name="afe105562ae62a8d6ed648ead14d2677c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe105562ae62a8d6ed648ead14d2677c">&#9670;&#160;</a></span>$currentKeyIdentifier</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$currentKeyIdentifier</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00305">305</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="ac020f52153cf900b4280912dc6f7cfbc" name="ac020f52153cf900b4280912dc6f7cfbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac020f52153cf900b4280912dc6f7cfbc">&#9670;&#160;</a></span>$DirectoryString</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$DirectoryString</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>#+ ASN.1 syntax for various extensions </p>
<p>@access private </p>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00151">151</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="abce4a4282325e154bdedab72a1e3583f" name="abce4a4282325e154bdedab72a1e3583f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abce4a4282325e154bdedab72a1e3583f">&#9670;&#160;</a></span>$disable_url_fetch</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$disable_url_fetch = false</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00337">337</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="aec1788b361bcb8be2632e5a0e3b8097b" name="aec1788b361bcb8be2632e5a0e3b8097b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec1788b361bcb8be2632e5a0e3b8097b">&#9670;&#160;</a></span>$dn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$dn</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00218">218</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a398d961fce9d555095d8e8251c060465" name="a398d961fce9d555095d8e8251c060465"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a398d961fce9d555095d8e8251c060465">&#9670;&#160;</a></span>$endDate</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$endDate</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00286">286</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a90a669de695cf2714560d3d428a9bffe" name="a90a669de695cf2714560d3d428a9bffe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90a669de695cf2714560d3d428a9bffe">&#9670;&#160;</a></span>$Extensions</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$Extensions</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00154">154</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a2200284add3fc613e0d755f1c2dc19fe" name="a2200284add3fc613e0d755f1c2dc19fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2200284add3fc613e0d755f1c2dc19fe">&#9670;&#160;</a></span>$ExtKeyUsageSyntax</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$ExtKeyUsageSyntax</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00156">156</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a024c5aee022e4a581309c16810fce445" name="a024c5aee022e4a581309c16810fce445"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a024c5aee022e4a581309c16810fce445">&#9670;&#160;</a></span>$HoldInstructionCode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$HoldInstructionCode</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00184">184</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a41cc02dfc1778b249655503e29f4e91d" name="a41cc02dfc1778b249655503e29f4e91d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41cc02dfc1778b249655503e29f4e91d">&#9670;&#160;</a></span>$InvalidityDate</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$InvalidityDate</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00182">182</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a7b3921a26a9432b975886e9a3ac576ec" name="a7b3921a26a9432b975886e9a3ac576ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b3921a26a9432b975886e9a3ac576ec">&#9670;&#160;</a></span>$IssuerAltName</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$IssuerAltName</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00166">166</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a3c6ec66ab0f66ab7861a6816b14c5888" name="a3c6ec66ab0f66ab7861a6816b14c5888"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c6ec66ab0f66ab7861a6816b14c5888">&#9670;&#160;</a></span>$IssuingDistributionPoint</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$IssuingDistributionPoint</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00181">181</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a0ea7b21cd35eaad3ddba1f8591f0ba34" name="a0ea7b21cd35eaad3ddba1f8591f0ba34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ea7b21cd35eaad3ddba1f8591f0ba34">&#9670;&#160;</a></span>$KeyIdentifier</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$KeyIdentifier</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00158">158</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="ab083e36c90d152051210e0213ae63a9b" name="ab083e36c90d152051210e0213ae63a9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab083e36c90d152051210e0213ae63a9b">&#9670;&#160;</a></span>$KeyUsage</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$KeyUsage</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00155">155</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a90efb261c13e9a3e16ed2b0563dec08d" name="a90efb261c13e9a3e16ed2b0563dec08d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90efb261c13e9a3e16ed2b0563dec08d">&#9670;&#160;</a></span>$Name</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$Name</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00177">177</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a9ec0f5819f272583b4e81eb3b5ae71bf" name="a9ec0f5819f272583b4e81eb3b5ae71bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ec0f5819f272583b4e81eb3b5ae71bf">&#9670;&#160;</a></span>$NameConstraints</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$NameConstraints</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00168">168</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="aee1528a6ef26dfec58ee2049fa0d5eba" name="aee1528a6ef26dfec58ee2049fa0d5eba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee1528a6ef26dfec58ee2049fa0d5eba">&#9670;&#160;</a></span>$netscape_ca_policy_url</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$netscape_ca_policy_url</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00175">175</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="ac786c1b3b59019082fb437c5c731c08b" name="ac786c1b3b59019082fb437c5c731c08b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac786c1b3b59019082fb437c5c731c08b">&#9670;&#160;</a></span>$netscape_cert_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$netscape_cert_type</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00173">173</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a26151049490a35186d0aeee63c25b660" name="a26151049490a35186d0aeee63c25b660"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26151049490a35186d0aeee63c25b660">&#9670;&#160;</a></span>$netscape_comment</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$netscape_comment</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00174">174</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a9922171de7141e7f4f8ebd13acee549c" name="a9922171de7141e7f4f8ebd13acee549c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9922171de7141e7f4f8ebd13acee549c">&#9670;&#160;</a></span>$oids</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$oids</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00243">243</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a35a009c15525cb0fd7ea5fe1cdde6b93" name="a35a009c15525cb0fd7ea5fe1cdde6b93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35a009c15525cb0fd7ea5fe1cdde6b93">&#9670;&#160;</a></span>$PKCS9String</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$PKCS9String</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00152">152</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a0dd032993d6d65f5fd578e54b4172617" name="a0dd032993d6d65f5fd578e54b4172617"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dd032993d6d65f5fd578e54b4172617">&#9670;&#160;</a></span>$PolicyMappings</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$PolicyMappings</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00167">167</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a2ed248a6cad1d4f5dbfa3d5d4816ea74" name="a2ed248a6cad1d4f5dbfa3d5d4816ea74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ed248a6cad1d4f5dbfa3d5d4816ea74">&#9670;&#160;</a></span>$PostalAddress</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$PostalAddress</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>#- </p>
<p>#+ ASN.1 syntax for various DN attributes</p>
<p>@access private </p>

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00193">193</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a0efebc1f06535a262ea0c2d33d794502" name="a0efebc1f06535a262ea0c2d33d794502"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0efebc1f06535a262ea0c2d33d794502">&#9670;&#160;</a></span>$privateKey</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$privateKey</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00234">234</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a29027799ab4c4799c3641146daeabc75" name="a29027799ab4c4799c3641146daeabc75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29027799ab4c4799c3641146daeabc75">&#9670;&#160;</a></span>$PrivateKeyUsagePeriod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$PrivateKeyUsagePeriod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00165">165</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a8d1062abadc25a988fb1aa01bfea74fe" name="a8d1062abadc25a988fb1aa01bfea74fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d1062abadc25a988fb1aa01bfea74fe">&#9670;&#160;</a></span>$publicKey</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$publicKey</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00226">226</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a02205494b83b199ba35de7bf3c6db477" name="a02205494b83b199ba35de7bf3c6db477"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02205494b83b199ba35de7bf3c6db477">&#9670;&#160;</a></span>$recur_limit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$recur_limit = 5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00329">329</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="ab9c0f5b10e956d7137dc70546a9edabb" name="ab9c0f5b10e956d7137dc70546a9edabb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9c0f5b10e956d7137dc70546a9edabb">&#9670;&#160;</a></span>$RelativeDistinguishedName</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$RelativeDistinguishedName</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00178">178</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a679efcb06902f4395826045f1b6346ab" name="a679efcb06902f4395826045f1b6346ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a679efcb06902f4395826045f1b6346ab">&#9670;&#160;</a></span>$serialNumber</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$serialNumber</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00294">294</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="abc5038cc6c10571997d5cef6f7c85782" name="abc5038cc6c10571997d5cef6f7c85782"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc5038cc6c10571997d5cef6f7c85782">&#9670;&#160;</a></span>$signatureSubject</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$signatureSubject</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00270">270</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a44a1785358b5d0f315d0303bf24a79e2" name="a44a1785358b5d0f315d0303bf24a79e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44a1785358b5d0f315d0303bf24a79e2">&#9670;&#160;</a></span>$SignedPublicKeyAndChallenge</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$SignedPublicKeyAndChallenge</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00185">185</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a288a4b22573d5731fe3f52c55263c5f3" name="a288a4b22573d5731fe3f52c55263c5f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a288a4b22573d5731fe3f52c55263c5f3">&#9670;&#160;</a></span>$startDate</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$startDate</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00278">278</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a6713e20606d747e709f13d8a4456a1db" name="a6713e20606d747e709f13d8a4456a1db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6713e20606d747e709f13d8a4456a1db">&#9670;&#160;</a></span>$SubjectAltName</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$SubjectAltName</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00163">163</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="abb40429ebc6c8cdc3917065c59c3c46d" name="abb40429ebc6c8cdc3917065c59c3c46d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb40429ebc6c8cdc3917065c59c3c46d">&#9670;&#160;</a></span>$SubjectDirectoryAttributes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$SubjectDirectoryAttributes</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00164">164</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<a id="a0c742caf2fc5fd1463a4181b87b69288" name="a0c742caf2fc5fd1463a4181b87b69288"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c742caf2fc5fd1463a4181b87b69288">&#9670;&#160;</a></span>$UserNotice</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$UserNotice</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="X509_8php_source.html#l00171">171</a> of file <a class="el" href="X509_8php_source.html">X509.php</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/View/lib/phpseclib/File/<a class="el" href="X509_8php_source.html">X509.php</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classFile__X509.html">File_X509</a></li>
    <li class="footer">Generated on Sun Apr 30 2023 00:52:48 for PF Firewall by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
