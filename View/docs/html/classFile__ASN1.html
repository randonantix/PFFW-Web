<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PF Firewall: File_ASN1 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PF Firewall<span id="projectnumber">&#160;7.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classFile__ASN1.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle"><div class="title">File_ASN1 Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a095c5d389db211932136b53f25f39685"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#a095c5d389db211932136b53f25f39685">__construct</a> ()</td></tr>
<tr class="memdesc:a095c5d389db211932136b53f25f39685"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default Constructor.  <br /></td></tr>
<tr class="separator:a095c5d389db211932136b53f25f39685"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeda37eb7de48ddff92ea865b8ed54710"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#aeda37eb7de48ddff92ea865b8ed54710">File_ASN1</a> ()</td></tr>
<tr class="memdesc:aeda37eb7de48ddff92ea865b8ed54710"><td class="mdescLeft">&#160;</td><td class="mdescRight">PHP4 compatible Default Constructor.  <br /></td></tr>
<tr class="separator:aeda37eb7de48ddff92ea865b8ed54710"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab508b6e87220e34709b62205489c6e36"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#ab508b6e87220e34709b62205489c6e36">decodeBER</a> ($encoded)</td></tr>
<tr class="memdesc:ab508b6e87220e34709b62205489c6e36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse BER-encoding.  <br /></td></tr>
<tr class="separator:ab508b6e87220e34709b62205489c6e36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca372fbe28962a08b98355562dc666bf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#aca372fbe28962a08b98355562dc666bf">_decode_ber</a> ($encoded, $start=0, $encoded_pos=0)</td></tr>
<tr class="memdesc:aca372fbe28962a08b98355562dc666bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse BER-encoding (Helper function)  <br /></td></tr>
<tr class="separator:aca372fbe28962a08b98355562dc666bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f30a92054d93d8c5470681b1f0508dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#a1f30a92054d93d8c5470681b1f0508dc">asn1map</a> ($decoded, $mapping, $special=array())</td></tr>
<tr class="memdesc:a1f30a92054d93d8c5470681b1f0508dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">ASN.1 Map.  <br /></td></tr>
<tr class="separator:a1f30a92054d93d8c5470681b1f0508dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6668c7a50e7ff14459c10564b7cd90cb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#a6668c7a50e7ff14459c10564b7cd90cb">encodeDER</a> ($source, $mapping, $special=array())</td></tr>
<tr class="memdesc:a6668c7a50e7ff14459c10564b7cd90cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">ASN.1 Encode.  <br /></td></tr>
<tr class="separator:a6668c7a50e7ff14459c10564b7cd90cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6152ed3dc2806e3cf7821a7fbdc97f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#ab6152ed3dc2806e3cf7821a7fbdc97f3">_encode_der</a> ($source, $mapping, $idx=null, $special=array())</td></tr>
<tr class="memdesc:ab6152ed3dc2806e3cf7821a7fbdc97f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">ASN.1 Encode (Helper function)  <br /></td></tr>
<tr class="separator:ab6152ed3dc2806e3cf7821a7fbdc97f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9967d86f5c5bdf50e4bc80cf1a9c018"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a> ($length)</td></tr>
<tr class="memdesc:ab9967d86f5c5bdf50e4bc80cf1a9c018"><td class="mdescLeft">&#160;</td><td class="mdescRight">DER-encode the length.  <br /></td></tr>
<tr class="separator:ab9967d86f5c5bdf50e4bc80cf1a9c018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3c9042cbc9b53c7d39065e8ce11ddbd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#ac3c9042cbc9b53c7d39065e8ce11ddbd">_decodeOID</a> ($content)</td></tr>
<tr class="memdesc:ac3c9042cbc9b53c7d39065e8ce11ddbd"><td class="mdescLeft">&#160;</td><td class="mdescRight">BER-decode the OID.  <br /></td></tr>
<tr class="separator:ac3c9042cbc9b53c7d39065e8ce11ddbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4b37b96ed86815954b693c12f839775"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#ae4b37b96ed86815954b693c12f839775">_encodeOID</a> ($source)</td></tr>
<tr class="memdesc:ae4b37b96ed86815954b693c12f839775"><td class="mdescLeft">&#160;</td><td class="mdescRight">DER-encode the OID.  <br /></td></tr>
<tr class="separator:ae4b37b96ed86815954b693c12f839775"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f552e81456e1e55cd55bb4158adb82a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#a8f552e81456e1e55cd55bb4158adb82a">_decodeUnixTime</a> ($content, $tag)</td></tr>
<tr class="memdesc:a8f552e81456e1e55cd55bb4158adb82a"><td class="mdescLeft">&#160;</td><td class="mdescRight">BER-decode the time (using UNIX time)  <br /></td></tr>
<tr class="separator:a8f552e81456e1e55cd55bb4158adb82a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae93cbfbb826db862f63b3a54ff46df4e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#ae93cbfbb826db862f63b3a54ff46df4e">_decodeDateTime</a> ($content, $tag)</td></tr>
<tr class="memdesc:ae93cbfbb826db862f63b3a54ff46df4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">BER-decode the time (using DateTime)  <br /></td></tr>
<tr class="separator:ae93cbfbb826db862f63b3a54ff46df4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a207b8453e7d5ea3c2115856e115bcb76"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#a207b8453e7d5ea3c2115856e115bcb76">setTimeFormat</a> ($format)</td></tr>
<tr class="memdesc:a207b8453e7d5ea3c2115856e115bcb76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the time format.  <br /></td></tr>
<tr class="separator:a207b8453e7d5ea3c2115856e115bcb76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af36a1322397aa7a558b9b9cc7fe43184"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#af36a1322397aa7a558b9b9cc7fe43184">loadOIDs</a> ($oids)</td></tr>
<tr class="memdesc:af36a1322397aa7a558b9b9cc7fe43184"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load OIDs.  <br /></td></tr>
<tr class="separator:af36a1322397aa7a558b9b9cc7fe43184"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5adae64c81cc292218f8d800081c343c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#a5adae64c81cc292218f8d800081c343c">loadFilters</a> ($filters)</td></tr>
<tr class="memdesc:a5adae64c81cc292218f8d800081c343c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load filters.  <br /></td></tr>
<tr class="separator:a5adae64c81cc292218f8d800081c343c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab009fa6f4ba09daa679a30e9b5bcfe35"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a> (&amp;$string, $index=1)</td></tr>
<tr class="memdesc:ab009fa6f4ba09daa679a30e9b5bcfe35"><td class="mdescLeft">&#160;</td><td class="mdescRight">String Shift.  <br /></td></tr>
<tr class="separator:ab009fa6f4ba09daa679a30e9b5bcfe35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e585250c17e19d71c758777634b4e77"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#a0e585250c17e19d71c758777634b4e77">convert</a> ($in, $from=<a class="el" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>, $to=<a class="el" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>)</td></tr>
<tr class="memdesc:a0e585250c17e19d71c758777634b4e77"><td class="mdescLeft">&#160;</td><td class="mdescRight">String type conversion.  <br /></td></tr>
<tr class="separator:a0e585250c17e19d71c758777634b4e77"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a9922171de7141e7f4f8ebd13acee549c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#a9922171de7141e7f4f8ebd13acee549c">$oids</a> = array()</td></tr>
<tr class="separator:a9922171de7141e7f4f8ebd13acee549c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e6e4ea377a908a5407c435e9054e3a9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a> = 'D, d M Y H:i:s O'</td></tr>
<tr class="separator:a1e6e4ea377a908a5407c435e9054e3a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af709b460501204e2ec7e34e96e7de576"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#af709b460501204e2ec7e34e96e7de576">$encoded</a></td></tr>
<tr class="separator:af709b460501204e2ec7e34e96e7de576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae222f32233a38635bef58d24a13c9df5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#ae222f32233a38635bef58d24a13c9df5">$filters</a></td></tr>
<tr class="separator:ae222f32233a38635bef58d24a13c9df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa59066295d237c2d6ced701edbcf09a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#aa59066295d237c2d6ced701edbcf09a2">$ANYmap</a></td></tr>
<tr class="separator:aa59066295d237c2d6ced701edbcf09a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02d690b9a4a20b69d0a231e64655bce8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFile__ASN1.html#a02d690b9a4a20b69d0a231e64655bce8">$stringTypeSize</a></td></tr>
<tr class="separator:a02d690b9a4a20b69d0a231e64655bce8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l00159">159</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a095c5d389db211932136b53f25f39685" name="a095c5d389db211932136b53f25f39685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a095c5d389db211932136b53f25f39685">&#9670;&#160;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__construct </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default Constructor. </p>
<p>@access public </p>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l00260">260</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  261</span>    {</div>
<div class="line"><span class="lineno">  262</span>        global <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>;</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>        <span class="keyword">static</span> $static_init = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  265</span>        <span class="keywordflow">if</span> (!$static_init) {</div>
<div class="line"><span class="lineno">  266</span>            $static_init = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  267</span>            <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Math_BigInteger&#39;</span>)) {</div>
<div class="line"><span class="lineno">  268</span>                include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Math/BigInteger.php&#39;</span>;</div>
<div class="line"><span class="lineno">  269</span>            }</div>
<div class="line"><span class="lineno">  270</span>        }</div>
<div class="line"><span class="lineno">  271</span>    }</div>
<div class="ttc" id="ainstall_8php_html_a1cf4c1ce4d54df11a660775bb7c5bbd8"><div class="ttname"><a href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a></div><div class="ttdeci">$VIEW_PATH</div><div class="ttdef"><b>Definition:</b> <a href="install_8php_source.html#l00039">install.php:39</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="install_8php_source.html#l00039">$VIEW_PATH</a>.</p>

<p class="reference">Referenced by <a class="el" href="ASN1_8php_source.html#l00279">File_ASN1()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__ASN1_a095c5d389db211932136b53f25f39685_icgraph.png" border="0" usemap="#aclassFile__ASN1_a095c5d389db211932136b53f25f39685_icgraph" alt=""/></div>
<map name="aclassFile__ASN1_a095c5d389db211932136b53f25f39685_icgraph" id="aclassFile__ASN1_a095c5d389db211932136b53f25f39685_icgraph">
<area shape="rect" title="Default Constructor." alt="" coords="140,5,236,31"/>
<area shape="rect" href="classFile__ASN1.html#aeda37eb7de48ddff92ea865b8ed54710" title="PHP4 compatible Default Constructor." alt="" coords="5,5,92,31"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aca372fbe28962a08b98355562dc666bf" name="aca372fbe28962a08b98355562dc666bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca372fbe28962a08b98355562dc666bf">&#9670;&#160;</a></span>_decode_ber()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_decode_ber </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$encoded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$start</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$encoded_pos</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse BER-encoding (Helper function) </p>
<p>Sometimes we want to get the BER encoding of a particular tag. $start lets us do that without having to reencode. $encoded is passed by reference for the recursive calls done for FILE_ASN1_TYPE_BIT_STRING and FILE_ASN1_TYPE_OCTET_STRING. In those cases, the indefinite length is used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$encoded</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$start</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$encoded_pos</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array @access private </dd></dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l00317">317</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  318</span>    {</div>
<div class="line"><span class="lineno">  319</span>        $current = array(<span class="stringliteral">&#39;start&#39;</span> =&gt; $start);</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>        <span class="keywordflow">if</span> (!isset(<a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>[$encoded_pos])) {</div>
<div class="line"><span class="lineno">  322</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  323</span>        }</div>
<div class="line"><span class="lineno">  324</span>        $type = ord(<a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>[$encoded_pos++]);</div>
<div class="line"><span class="lineno">  325</span>        $startOffset = 1;</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>        $constructed = ($type &gt;&gt; 5) &amp; 1;</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>        $tag = $type &amp; 0x1F;</div>
<div class="line"><span class="lineno">  330</span>        <span class="keywordflow">if</span> ($tag == 0x1F) {</div>
<div class="line"><span class="lineno">  331</span>            $tag = 0;</div>
<div class="line"><span class="lineno">  332</span>            <span class="comment">// process septets (since the eighth bit is ignored, it&#39;s not an octet)</span></div>
<div class="line"><span class="lineno">  333</span>            <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno">  334</span>                <span class="keywordflow">if</span> (!isset(<a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>[$encoded_pos])) {</div>
<div class="line"><span class="lineno">  335</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  336</span>                }</div>
<div class="line"><span class="lineno">  337</span>                $temp = ord(<a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>[$encoded_pos++]);</div>
<div class="line"><span class="lineno">  338</span>                $startOffset++;</div>
<div class="line"><span class="lineno">  339</span>                $loop = $temp &gt;&gt; 7;</div>
<div class="line"><span class="lineno">  340</span>                $tag &lt;&lt;= 7;</div>
<div class="line"><span class="lineno">  341</span>                $temp &amp;= 0x7F;</div>
<div class="line"><span class="lineno">  342</span>                <span class="comment">// &quot;bits 7 to 1 of the first subsequent octet shall not all be zero&quot;</span></div>
<div class="line"><span class="lineno">  343</span>                <span class="keywordflow">if</span> ($startOffset == 2 &amp;&amp; $temp == 0) {</div>
<div class="line"><span class="lineno">  344</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  345</span>                }</div>
<div class="line"><span class="lineno">  346</span>                $tag |= $temp;</div>
<div class="line"><span class="lineno">  347</span>            } <span class="keywordflow">while</span> ($loop);</div>
<div class="line"><span class="lineno">  348</span>        }</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>        $start+= $startOffset;</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>        <span class="comment">// Length, as discussed in paragraph 8.1.3 of X.690-0207.pdf#page=13</span></div>
<div class="line"><span class="lineno">  353</span>        <span class="keywordflow">if</span> (!isset(<a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>[$encoded_pos])) {</div>
<div class="line"><span class="lineno">  354</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  355</span>        }</div>
<div class="line"><span class="lineno">  356</span>        $length = ord(<a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>[$encoded_pos++]);</div>
<div class="line"><span class="lineno">  357</span>        $start++;</div>
<div class="line"><span class="lineno">  358</span>        <span class="keywordflow">if</span> ($length == 0x80) { <span class="comment">// indefinite length</span></div>
<div class="line"><span class="lineno">  359</span>            <span class="comment">// &quot;[A sender shall] use the indefinite form (see 8.1.3.6) if the encoding is constructed and is not all</span></div>
<div class="line"><span class="lineno">  360</span>            <span class="comment">//  immediately available.&quot; -- paragraph 8.1.3.2.c</span></div>
<div class="line"><span class="lineno">  361</span>            $length = strlen(<a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>) - $encoded_pos;</div>
<div class="line"><span class="lineno">  362</span>        } elseif ($length &amp; 0x80) { <span class="comment">// definite length, long form</span></div>
<div class="line"><span class="lineno">  363</span>            <span class="comment">// technically, the long form of the length can be represented by up to 126 octets (bytes), but we&#39;ll only</span></div>
<div class="line"><span class="lineno">  364</span>            <span class="comment">// support it up to four.</span></div>
<div class="line"><span class="lineno">  365</span>            $length&amp;= 0x7F;</div>
<div class="line"><span class="lineno">  366</span>            $temp = substr(<a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>, $encoded_pos, $length);</div>
<div class="line"><span class="lineno">  367</span>            $encoded_pos += $length;</div>
<div class="line"><span class="lineno">  368</span>            <span class="comment">// tags of indefinte length don&#39;t really have a header length; this length includes the tag</span></div>
<div class="line"><span class="lineno">  369</span>            $current+= array(<span class="stringliteral">&#39;headerlength&#39;</span> =&gt; $length + 2);</div>
<div class="line"><span class="lineno">  370</span>            $start+= $length;</div>
<div class="line"><span class="lineno">  371</span>            extract(unpack(<span class="stringliteral">&#39;Nlength&#39;</span>, substr(str_pad($temp, 4, chr(0), STR_PAD_LEFT), -4)));</div>
<div class="line"><span class="lineno">  372</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  373</span>            $current+= array(<span class="stringliteral">&#39;headerlength&#39;</span> =&gt; 2);</div>
<div class="line"><span class="lineno">  374</span>        }</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>        <span class="keywordflow">if</span> ($length &gt; (strlen(<a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>) - $encoded_pos)) {</div>
<div class="line"><span class="lineno">  377</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  378</span>        }</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>        $content = substr(<a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>, $encoded_pos, $length);</div>
<div class="line"><span class="lineno">  381</span>        $content_pos = 0;</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>        <span class="comment">// at this point $length can be overwritten. it&#39;s only accurate for definite length things as is</span></div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>        <span class="comment">/* Class is UNIVERSAL, APPLICATION, PRIVATE, or CONTEXT-SPECIFIC. The UNIVERSAL class is restricted to the ASN.1</span></div>
<div class="line"><span class="lineno">  386</span><span class="comment">           built-in types. It defines an application-independent data type that must be distinguishable from all other</span></div>
<div class="line"><span class="lineno">  387</span><span class="comment">           data types. The other three classes are user defined. The APPLICATION class distinguishes data types that</span></div>
<div class="line"><span class="lineno">  388</span><span class="comment">           have a wide, scattered use within a particular presentation context. PRIVATE distinguishes data types within</span></div>
<div class="line"><span class="lineno">  389</span><span class="comment">           a particular organization or country. CONTEXT-SPECIFIC distinguishes members of a sequence or set, the</span></div>
<div class="line"><span class="lineno">  390</span><span class="comment">           alternatives of a CHOICE, or universally tagged set members. Only the class number appears in braces for this</span></div>
<div class="line"><span class="lineno">  391</span><span class="comment">           data type; the term CONTEXT-SPECIFIC does not appear.</span></div>
<div class="line"><span class="lineno">  392</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  393</span><span class="comment">             -- http://www.obj-sys.com/asn1tutorial/node12.html */</span></div>
<div class="line"><span class="lineno">  394</span>        $class = ($type &gt;&gt; 6) &amp; 3;</div>
<div class="line"><span class="lineno">  395</span>        <span class="keywordflow">switch</span> ($class) {</div>
<div class="line"><span class="lineno">  396</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a77bc62de1f11def34ebec1b8ef064baf">FILE_ASN1_CLASS_APPLICATION</a>:</div>
<div class="line"><span class="lineno">  397</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#ae7ec7ccc71e8bc4791dc45c2934d03c3">FILE_ASN1_CLASS_PRIVATE</a>:</div>
<div class="line"><span class="lineno">  398</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#ac0ccdf6580b85de79b4a0dc084f285f0">FILE_ASN1_CLASS_CONTEXT_SPECIFIC</a>:</div>
<div class="line"><span class="lineno">  399</span>                <span class="keywordflow">if</span> (!$constructed) {</div>
<div class="line"><span class="lineno">  400</span>                    <span class="keywordflow">return</span> array(</div>
<div class="line"><span class="lineno">  401</span>                        <span class="stringliteral">&#39;type&#39;</span>     =&gt; $class,</div>
<div class="line"><span class="lineno">  402</span>                        <span class="stringliteral">&#39;constant&#39;</span> =&gt; $tag,</div>
<div class="line"><span class="lineno">  403</span>                        <span class="stringliteral">&#39;content&#39;</span>  =&gt; $content,</div>
<div class="line"><span class="lineno">  404</span>                        <span class="stringliteral">&#39;length&#39;</span>   =&gt; $length + $start - $current[<span class="stringliteral">&#39;start&#39;</span>]</div>
<div class="line"><span class="lineno">  405</span>                    );</div>
<div class="line"><span class="lineno">  406</span>                }</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>                $newcontent = array();</div>
<div class="line"><span class="lineno">  409</span>                $remainingLength = $length;</div>
<div class="line"><span class="lineno">  410</span>                <span class="keywordflow">while</span> ($remainingLength &gt; 0) {</div>
<div class="line"><span class="lineno">  411</span>                    $temp = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#aca372fbe28962a08b98355562dc666bf">_decode_ber</a>($content, $start, $content_pos);</div>
<div class="line"><span class="lineno">  412</span>                    <span class="keywordflow">if</span> ($temp === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  413</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  414</span>                    }</div>
<div class="line"><span class="lineno">  415</span>                    $length = $temp[<span class="stringliteral">&#39;length&#39;</span>];</div>
<div class="line"><span class="lineno">  416</span>                    <span class="comment">// end-of-content octets - see paragraph 8.1.5</span></div>
<div class="line"><span class="lineno">  417</span>                    <span class="keywordflow">if</span> (substr($content, $content_pos + $length, 2) == <span class="stringliteral">&quot;\0\0&quot;</span>) {</div>
<div class="line"><span class="lineno">  418</span>                        $length+= 2;</div>
<div class="line"><span class="lineno">  419</span>                        $start+= $length;</div>
<div class="line"><span class="lineno">  420</span>                        $newcontent[] = $temp;</div>
<div class="line"><span class="lineno">  421</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  422</span>                    }</div>
<div class="line"><span class="lineno">  423</span>                    $start+= $length;</div>
<div class="line"><span class="lineno">  424</span>                    $remainingLength-= $length;</div>
<div class="line"><span class="lineno">  425</span>                    $newcontent[] = $temp;</div>
<div class="line"><span class="lineno">  426</span>                    $content_pos += $length;</div>
<div class="line"><span class="lineno">  427</span>                }</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>                <span class="keywordflow">return</span> array(</div>
<div class="line"><span class="lineno">  430</span>                    <span class="stringliteral">&#39;type&#39;</span>     =&gt; $class,</div>
<div class="line"><span class="lineno">  431</span>                    <span class="stringliteral">&#39;constant&#39;</span> =&gt; $tag,</div>
<div class="line"><span class="lineno">  432</span>                    <span class="comment">// the array encapsulation is for BC with the old format</span></div>
<div class="line"><span class="lineno">  433</span>                    <span class="stringliteral">&#39;content&#39;</span>  =&gt; $newcontent,</div>
<div class="line"><span class="lineno">  434</span>                    <span class="comment">// the only time when $content[&#39;headerlength&#39;] isn&#39;t defined is when the length is indefinite.</span></div>
<div class="line"><span class="lineno">  435</span>                    <span class="comment">// the absence of $content[&#39;headerlength&#39;] is how we know if something is indefinite or not.</span></div>
<div class="line"><span class="lineno">  436</span>                    <span class="comment">// technically, it could be defined to be 2 and then another indicator could be used but whatever.</span></div>
<div class="line"><span class="lineno">  437</span>                    <span class="stringliteral">&#39;length&#39;</span>   =&gt; $start - $current[<span class="stringliteral">&#39;start&#39;</span>]</div>
<div class="line"><span class="lineno">  438</span>                ) + $current;</div>
<div class="line"><span class="lineno">  439</span>        }</div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>        $current+= array(<span class="stringliteral">&#39;type&#39;</span> =&gt; $tag);</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>        <span class="comment">// decode UNIVERSAL tags</span></div>
<div class="line"><span class="lineno">  444</span>        <span class="keywordflow">switch</span> ($tag) {</div>
<div class="line"><span class="lineno">  445</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a7466606a3e1d863445b1be09b85f1148">FILE_ASN1_TYPE_BOOLEAN</a>:</div>
<div class="line"><span class="lineno">  446</span>                <span class="comment">// &quot;The contents octets shall consist of a single octet.&quot; -- paragraph 8.2.1</span></div>
<div class="line"><span class="lineno">  447</span>                <span class="keywordflow">if</span> ($constructed || strlen($content) != 1) {</div>
<div class="line"><span class="lineno">  448</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  449</span>                }</div>
<div class="line"><span class="lineno">  450</span>                $current[<span class="stringliteral">&#39;content&#39;</span>] = (bool) ord($content[$content_pos]);</div>
<div class="line"><span class="lineno">  451</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  452</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a9c3b70985b245c865ddf8874cc422ba6">FILE_ASN1_TYPE_INTEGER</a>:</div>
<div class="line"><span class="lineno">  453</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a96edb7b260fa5df901e8f458cb77064e">FILE_ASN1_TYPE_ENUMERATED</a>:</div>
<div class="line"><span class="lineno">  454</span>                <span class="keywordflow">if</span> ($constructed) {</div>
<div class="line"><span class="lineno">  455</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  456</span>                }</div>
<div class="line"><span class="lineno">  457</span>                $current[<span class="stringliteral">&#39;content&#39;</span>] = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>(substr($content, $content_pos), -256);</div>
<div class="line"><span class="lineno">  458</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  459</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#aafc4e432c511b12413cbb1dbd1a23191">FILE_ASN1_TYPE_REAL</a>: <span class="comment">// not currently supported</span></div>
<div class="line"><span class="lineno">  460</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  461</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>:</div>
<div class="line"><span class="lineno">  462</span>                <span class="comment">// The initial octet shall encode, as an unsigned binary integer with bit 1 as the least significant bit,</span></div>
<div class="line"><span class="lineno">  463</span>                <span class="comment">// the number of unused bits in the final subsequent octet. The number shall be in the range zero to</span></div>
<div class="line"><span class="lineno">  464</span>                <span class="comment">// seven.</span></div>
<div class="line"><span class="lineno">  465</span>                <span class="keywordflow">if</span> (!$constructed) {</div>
<div class="line"><span class="lineno">  466</span>                    $current[<span class="stringliteral">&#39;content&#39;</span>] = substr($content, $content_pos);</div>
<div class="line"><span class="lineno">  467</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  468</span>                    $temp = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#aca372fbe28962a08b98355562dc666bf">_decode_ber</a>($content, $start, $content_pos);</div>
<div class="line"><span class="lineno">  469</span>                    <span class="keywordflow">if</span> ($temp === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  470</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  471</span>                    }</div>
<div class="line"><span class="lineno">  472</span>                    $length-= (strlen($content) - $content_pos);</div>
<div class="line"><span class="lineno">  473</span>                    $last = count($temp) - 1;</div>
<div class="line"><span class="lineno">  474</span>                    <span class="keywordflow">for</span> ($i = 0; $i &lt; $last; $i++) {</div>
<div class="line"><span class="lineno">  475</span>                        <span class="comment">// all subtags should be bit strings</span></div>
<div class="line"><span class="lineno">  476</span>                        <span class="keywordflow">if</span> ($temp[$i][<span class="stringliteral">&#39;type&#39;</span>] != <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>) {</div>
<div class="line"><span class="lineno">  477</span>                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  478</span>                        }</div>
<div class="line"><span class="lineno">  479</span>                        $current[<span class="stringliteral">&#39;content&#39;</span>].= substr($temp[$i][<span class="stringliteral">&#39;content&#39;</span>], 1);</div>
<div class="line"><span class="lineno">  480</span>                    }</div>
<div class="line"><span class="lineno">  481</span>                    <span class="comment">// all subtags should be bit strings</span></div>
<div class="line"><span class="lineno">  482</span>                    <span class="keywordflow">if</span> ($temp[$last][<span class="stringliteral">&#39;type&#39;</span>] != <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>) {</div>
<div class="line"><span class="lineno">  483</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  484</span>                    }</div>
<div class="line"><span class="lineno">  485</span>                    $current[<span class="stringliteral">&#39;content&#39;</span>] = $temp[$last][<span class="stringliteral">&#39;content&#39;</span>][0] . $current[<span class="stringliteral">&#39;content&#39;</span>] . substr($temp[$i][<span class="stringliteral">&#39;content&#39;</span>], 1);</div>
<div class="line"><span class="lineno">  486</span>                }</div>
<div class="line"><span class="lineno">  487</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  488</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a5cbfd497aefacbfc5766e0b266022fc2">FILE_ASN1_TYPE_OCTET_STRING</a>:</div>
<div class="line"><span class="lineno">  489</span>                <span class="keywordflow">if</span> (!$constructed) {</div>
<div class="line"><span class="lineno">  490</span>                    $current[<span class="stringliteral">&#39;content&#39;</span>] = substr($content, $content_pos);</div>
<div class="line"><span class="lineno">  491</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  492</span>                    $current[<span class="stringliteral">&#39;content&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  493</span>                    $length = 0;</div>
<div class="line"><span class="lineno">  494</span>                    <span class="keywordflow">while</span> (substr($content, $content_pos, 2) != <span class="stringliteral">&quot;\0\0&quot;</span>) {</div>
<div class="line"><span class="lineno">  495</span>                        $temp = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#aca372fbe28962a08b98355562dc666bf">_decode_ber</a>($content, $length + $start, $content_pos);</div>
<div class="line"><span class="lineno">  496</span>                        <span class="keywordflow">if</span> ($temp === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  497</span>                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  498</span>                        }</div>
<div class="line"><span class="lineno">  499</span>                        $content_pos += $temp[<span class="stringliteral">&#39;length&#39;</span>];</div>
<div class="line"><span class="lineno">  500</span>                        <span class="comment">// all subtags should be octet strings</span></div>
<div class="line"><span class="lineno">  501</span>                        <span class="keywordflow">if</span> ($temp[<span class="stringliteral">&#39;type&#39;</span>] != <a class="code hl_variable" href="ASN1_8php.html#a5cbfd497aefacbfc5766e0b266022fc2">FILE_ASN1_TYPE_OCTET_STRING</a>) {</div>
<div class="line"><span class="lineno">  502</span>                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  503</span>                        }</div>
<div class="line"><span class="lineno">  504</span>                        $current[<span class="stringliteral">&#39;content&#39;</span>].= $temp[<span class="stringliteral">&#39;content&#39;</span>];</div>
<div class="line"><span class="lineno">  505</span>                        $length+= $temp[<span class="stringliteral">&#39;length&#39;</span>];</div>
<div class="line"><span class="lineno">  506</span>                    }</div>
<div class="line"><span class="lineno">  507</span>                    <span class="keywordflow">if</span> (substr($content, $content_pos, 2) == <span class="stringliteral">&quot;\0\0&quot;</span>) {</div>
<div class="line"><span class="lineno">  508</span>                        $length+= 2; <span class="comment">// +2 for the EOC</span></div>
<div class="line"><span class="lineno">  509</span>                    }</div>
<div class="line"><span class="lineno">  510</span>                }</div>
<div class="line"><span class="lineno">  511</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  512</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a178f5750294c65763f2b1b2d1a4acb0d">FILE_ASN1_TYPE_NULL</a>:</div>
<div class="line"><span class="lineno">  513</span>                <span class="comment">// &quot;The contents octets shall not contain any octets.&quot; -- paragraph 8.8.2</span></div>
<div class="line"><span class="lineno">  514</span>                <span class="keywordflow">if</span> ($constructed || strlen($content)) {</div>
<div class="line"><span class="lineno">  515</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  516</span>                }</div>
<div class="line"><span class="lineno">  517</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  518</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>:</div>
<div class="line"><span class="lineno">  519</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#ade866784098f01a9cb1e6901dec0bfca">FILE_ASN1_TYPE_SET</a>:</div>
<div class="line"><span class="lineno">  520</span>                <span class="keywordflow">if</span> (!$constructed) {</div>
<div class="line"><span class="lineno">  521</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  522</span>                }</div>
<div class="line"><span class="lineno">  523</span>                $offset = 0;</div>
<div class="line"><span class="lineno">  524</span>                $current[<span class="stringliteral">&#39;content&#39;</span>] = array();</div>
<div class="line"><span class="lineno">  525</span>                $content_len = strlen($content);</div>
<div class="line"><span class="lineno">  526</span>                <span class="keywordflow">while</span> ($content_pos &lt; $content_len) {</div>
<div class="line"><span class="lineno">  527</span>                    <span class="comment">// if indefinite length construction was used and we have an end-of-content string next</span></div>
<div class="line"><span class="lineno">  528</span>                    <span class="comment">// see paragraphs 8.1.1.3, 8.1.3.2, 8.1.3.6, 8.1.5, and (for an example) 8.6.4.2</span></div>
<div class="line"><span class="lineno">  529</span>                    <span class="keywordflow">if</span> (!isset($current[<span class="stringliteral">&#39;headerlength&#39;</span>]) &amp;&amp; substr($content, $content_pos, 2) == <span class="stringliteral">&quot;\0\0&quot;</span>) {</div>
<div class="line"><span class="lineno">  530</span>                        $length = $offset + 2; <span class="comment">// +2 for the EOC</span></div>
<div class="line"><span class="lineno">  531</span>                        <span class="keywordflow">break</span> 2;</div>
<div class="line"><span class="lineno">  532</span>                    }</div>
<div class="line"><span class="lineno">  533</span>                    $temp = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#aca372fbe28962a08b98355562dc666bf">_decode_ber</a>($content, $start + $offset, $content_pos);</div>
<div class="line"><span class="lineno">  534</span>                    <span class="keywordflow">if</span> ($temp === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  535</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  536</span>                    }</div>
<div class="line"><span class="lineno">  537</span>                    $content_pos += $temp[<span class="stringliteral">&#39;length&#39;</span>];</div>
<div class="line"><span class="lineno">  538</span>                    $current[<span class="stringliteral">&#39;content&#39;</span>][] = $temp;</div>
<div class="line"><span class="lineno">  539</span>                    $offset+= $temp[<span class="stringliteral">&#39;length&#39;</span>];</div>
<div class="line"><span class="lineno">  540</span>                }</div>
<div class="line"><span class="lineno">  541</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  542</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>:</div>
<div class="line"><span class="lineno">  543</span>                <span class="keywordflow">if</span> ($constructed) {</div>
<div class="line"><span class="lineno">  544</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  545</span>                }</div>
<div class="line"><span class="lineno">  546</span>                $current[<span class="stringliteral">&#39;content&#39;</span>] = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ac3c9042cbc9b53c7d39065e8ce11ddbd">_decodeOID</a>(substr($content, $content_pos));</div>
<div class="line"><span class="lineno">  547</span>                <span class="keywordflow">if</span> ($current[<span class="stringliteral">&#39;content&#39;</span>] === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  548</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  549</span>                }</div>
<div class="line"><span class="lineno">  550</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  551</span>            <span class="comment">/* Each character string type shall be encoded as if it had been declared:</span></div>
<div class="line"><span class="lineno">  552</span><span class="comment">               [UNIVERSAL x] IMPLICIT OCTET STRING</span></div>
<div class="line"><span class="lineno">  553</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  554</span><span class="comment">                 -- X.690-0207.pdf#page=23 (paragraph 8.21.3)</span></div>
<div class="line"><span class="lineno">  555</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  556</span><span class="comment">               Per that, we&#39;re not going to do any validation.  If there are any illegal characters in the string,</span></div>
<div class="line"><span class="lineno">  557</span><span class="comment">               we don&#39;t really care */</span></div>
<div class="line"><span class="lineno">  558</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#af269bb1254bc4f65a21327c39530c0eb">FILE_ASN1_TYPE_NUMERIC_STRING</a>:</div>
<div class="line"><span class="lineno">  559</span>                <span class="comment">// 0,1,2,3,4,5,6,7,8,9, and space</span></div>
<div class="line"><span class="lineno">  560</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>:</div>
<div class="line"><span class="lineno">  561</span>                <span class="comment">// Upper and lower case letters, digits, space, apostrophe, left/right parenthesis, plus sign, comma,</span></div>
<div class="line"><span class="lineno">  562</span>                <span class="comment">// hyphen, full stop, solidus, colon, equal sign, question mark</span></div>
<div class="line"><span class="lineno">  563</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a5f903ee9a5fc70fcbff1af967c53083b">FILE_ASN1_TYPE_TELETEX_STRING</a>:</div>
<div class="line"><span class="lineno">  564</span>                <span class="comment">// The Teletex character set in CCITT&#39;s T61, space, and delete</span></div>
<div class="line"><span class="lineno">  565</span>                <span class="comment">// see http://en.wikipedia.org/wiki/Teletex#Character_sets</span></div>
<div class="line"><span class="lineno">  566</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a840878e52522fbab4c1b402040bd3a11">FILE_ASN1_TYPE_VIDEOTEX_STRING</a>:</div>
<div class="line"><span class="lineno">  567</span>                <span class="comment">// The Videotex character set in CCITT&#39;s T.100 and T.101, space, and delete</span></div>
<div class="line"><span class="lineno">  568</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a5301a15003ac88ef62b1b097a8f99e8b">FILE_ASN1_TYPE_VISIBLE_STRING</a>:</div>
<div class="line"><span class="lineno">  569</span>                <span class="comment">// Printing character sets of international ASCII, and space</span></div>
<div class="line"><span class="lineno">  570</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a>:</div>
<div class="line"><span class="lineno">  571</span>                <span class="comment">// International Alphabet 5 (International ASCII)</span></div>
<div class="line"><span class="lineno">  572</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a079c98ace233ab025f8584ed810c466c">FILE_ASN1_TYPE_GRAPHIC_STRING</a>:</div>
<div class="line"><span class="lineno">  573</span>                <span class="comment">// All registered G sets, and space</span></div>
<div class="line"><span class="lineno">  574</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a844e30a2e0708f8b9ba4c09ec24894ff">FILE_ASN1_TYPE_GENERAL_STRING</a>:</div>
<div class="line"><span class="lineno">  575</span>                <span class="comment">// All registered C and G sets, space and delete</span></div>
<div class="line"><span class="lineno">  576</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>:</div>
<div class="line"><span class="lineno">  577</span>                <span class="comment">// ????</span></div>
<div class="line"><span class="lineno">  578</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#afae5a2a5df49e80953c2bb088f9ce8fb">FILE_ASN1_TYPE_BMP_STRING</a>:</div>
<div class="line"><span class="lineno">  579</span>                <span class="keywordflow">if</span> ($constructed) {</div>
<div class="line"><span class="lineno">  580</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  581</span>                }</div>
<div class="line"><span class="lineno">  582</span>                $current[<span class="stringliteral">&#39;content&#39;</span>] = substr($content, $content_pos);</div>
<div class="line"><span class="lineno">  583</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  584</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a842b61be906cf8882ae9b54a974231ba">FILE_ASN1_TYPE_UTC_TIME</a>:</div>
<div class="line"><span class="lineno">  585</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a8ad0c6d6389ce6c6fb2e633814cbfd42">FILE_ASN1_TYPE_GENERALIZED_TIME</a>:</div>
<div class="line"><span class="lineno">  586</span>                <span class="keywordflow">if</span> ($constructed) {</div>
<div class="line"><span class="lineno">  587</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  588</span>                }</div>
<div class="line"><span class="lineno">  589</span>                $current[<span class="stringliteral">&#39;content&#39;</span>] = class_exists(<span class="stringliteral">&#39;DateTime&#39;</span>) ?</div>
<div class="line"><span class="lineno">  590</span>                    $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ae93cbfbb826db862f63b3a54ff46df4e">_decodeDateTime</a>(substr($content, $content_pos), $tag) :</div>
<div class="line"><span class="lineno">  591</span>                    $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#a8f552e81456e1e55cd55bb4158adb82a">_decodeUnixTime</a>(substr($content, $content_pos), $tag);</div>
<div class="line"><span class="lineno">  592</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  593</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  594</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  595</span>        }</div>
<div class="line"><span class="lineno">  596</span> </div>
<div class="line"><span class="lineno">  597</span>        $start+= $length;</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>        <span class="comment">// ie. length is the length of the full TLV encoding - it&#39;s not just the length of the value</span></div>
<div class="line"><span class="lineno">  600</span>        <span class="keywordflow">return</span> $current + array(<span class="stringliteral">&#39;length&#39;</span> =&gt; $start - $current[<span class="stringliteral">&#39;start&#39;</span>]);</div>
<div class="line"><span class="lineno">  601</span>    }</div>
<div class="ttc" id="aASN1_8php_html_a079c98ace233ab025f8584ed810c466c"><div class="ttname"><a href="ASN1_8php.html#a079c98ace233ab025f8584ed810c466c">FILE_ASN1_TYPE_GRAPHIC_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_GRAPHIC_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00089">ASN1.php:89</a></div></div>
<div class="ttc" id="aASN1_8php_html_a178f5750294c65763f2b1b2d1a4acb0d"><div class="ttname"><a href="ASN1_8php.html#a178f5750294c65763f2b1b2d1a4acb0d">FILE_ASN1_TYPE_NULL</a></div><div class="ttdeci">const FILE_ASN1_TYPE_NULL</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00064">ASN1.php:64</a></div></div>
<div class="ttc" id="aASN1_8php_html_a1e4134ec1b734779403a8550d41954a3"><div class="ttname"><a href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_BIT_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00062">ASN1.php:62</a></div></div>
<div class="ttc" id="aASN1_8php_html_a277c7aa24346ee34aa14506cc313afcb"><div class="ttname"><a href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_PRINTABLE_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00083">ASN1.php:83</a></div></div>
<div class="ttc" id="aASN1_8php_html_a5301a15003ac88ef62b1b097a8f99e8b"><div class="ttname"><a href="ASN1_8php.html#a5301a15003ac88ef62b1b097a8f99e8b">FILE_ASN1_TYPE_VISIBLE_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_VISIBLE_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00090">ASN1.php:90</a></div></div>
<div class="ttc" id="aASN1_8php_html_a5cbfd497aefacbfc5766e0b266022fc2"><div class="ttname"><a href="ASN1_8php.html#a5cbfd497aefacbfc5766e0b266022fc2">FILE_ASN1_TYPE_OCTET_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_OCTET_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00063">ASN1.php:63</a></div></div>
<div class="ttc" id="aASN1_8php_html_a5f903ee9a5fc70fcbff1af967c53083b"><div class="ttname"><a href="ASN1_8php.html#a5f903ee9a5fc70fcbff1af967c53083b">FILE_ASN1_TYPE_TELETEX_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_TELETEX_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00084">ASN1.php:84</a></div></div>
<div class="ttc" id="aASN1_8php_html_a7466606a3e1d863445b1be09b85f1148"><div class="ttname"><a href="ASN1_8php.html#a7466606a3e1d863445b1be09b85f1148">FILE_ASN1_TYPE_BOOLEAN</a></div><div class="ttdeci">const FILE_ASN1_TYPE_BOOLEAN</div><div class="ttdoc">#-</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00060">ASN1.php:60</a></div></div>
<div class="ttc" id="aASN1_8php_html_a77bc62de1f11def34ebec1b8ef064baf"><div class="ttname"><a href="ASN1_8php.html#a77bc62de1f11def34ebec1b8ef064baf">FILE_ASN1_CLASS_APPLICATION</a></div><div class="ttdeci">const FILE_ASN1_CLASS_APPLICATION</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00049">ASN1.php:49</a></div></div>
<div class="ttc" id="aASN1_8php_html_a840878e52522fbab4c1b402040bd3a11"><div class="ttname"><a href="ASN1_8php.html#a840878e52522fbab4c1b402040bd3a11">FILE_ASN1_TYPE_VIDEOTEX_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_VIDEOTEX_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00085">ASN1.php:85</a></div></div>
<div class="ttc" id="aASN1_8php_html_a842b61be906cf8882ae9b54a974231ba"><div class="ttname"><a href="ASN1_8php.html#a842b61be906cf8882ae9b54a974231ba">FILE_ASN1_TYPE_UTC_TIME</a></div><div class="ttdeci">const FILE_ASN1_TYPE_UTC_TIME</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00087">ASN1.php:87</a></div></div>
<div class="ttc" id="aASN1_8php_html_a844e30a2e0708f8b9ba4c09ec24894ff"><div class="ttname"><a href="ASN1_8php.html#a844e30a2e0708f8b9ba4c09ec24894ff">FILE_ASN1_TYPE_GENERAL_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_GENERAL_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00091">ASN1.php:91</a></div></div>
<div class="ttc" id="aASN1_8php_html_a8ad0c6d6389ce6c6fb2e633814cbfd42"><div class="ttname"><a href="ASN1_8php.html#a8ad0c6d6389ce6c6fb2e633814cbfd42">FILE_ASN1_TYPE_GENERALIZED_TIME</a></div><div class="ttdeci">const FILE_ASN1_TYPE_GENERALIZED_TIME</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00088">ASN1.php:88</a></div></div>
<div class="ttc" id="aASN1_8php_html_a8ed0e0a9293f9159b5de750e34b86652"><div class="ttname"><a href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a></div><div class="ttdeci">const FILE_ASN1_TYPE_OBJECT_IDENTIFIER</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00065">ASN1.php:65</a></div></div>
<div class="ttc" id="aASN1_8php_html_a96edb7b260fa5df901e8f458cb77064e"><div class="ttname"><a href="ASN1_8php.html#a96edb7b260fa5df901e8f458cb77064e">FILE_ASN1_TYPE_ENUMERATED</a></div><div class="ttdeci">const FILE_ASN1_TYPE_ENUMERATED</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00069">ASN1.php:69</a></div></div>
<div class="ttc" id="aASN1_8php_html_a9c3b70985b245c865ddf8874cc422ba6"><div class="ttname"><a href="ASN1_8php.html#a9c3b70985b245c865ddf8874cc422ba6">FILE_ASN1_TYPE_INTEGER</a></div><div class="ttdeci">const FILE_ASN1_TYPE_INTEGER</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00061">ASN1.php:61</a></div></div>
<div class="ttc" id="aASN1_8php_html_aa07c8f79dd12c23a3e688d9feba544ab"><div class="ttname"><a href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_UTF8_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00071">ASN1.php:71</a></div></div>
<div class="ttc" id="aASN1_8php_html_aafc4e432c511b12413cbb1dbd1a23191"><div class="ttname"><a href="ASN1_8php.html#aafc4e432c511b12413cbb1dbd1a23191">FILE_ASN1_TYPE_REAL</a></div><div class="ttdeci">const FILE_ASN1_TYPE_REAL</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00068">ASN1.php:68</a></div></div>
<div class="ttc" id="aASN1_8php_html_ab1428335844d52e212845bb286190cae"><div class="ttname"><a href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a></div><div class="ttdeci">const FILE_ASN1_TYPE_SEQUENCE</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00073">ASN1.php:73</a></div></div>
<div class="ttc" id="aASN1_8php_html_ac0ccdf6580b85de79b4a0dc084f285f0"><div class="ttname"><a href="ASN1_8php.html#ac0ccdf6580b85de79b4a0dc084f285f0">FILE_ASN1_CLASS_CONTEXT_SPECIFIC</a></div><div class="ttdeci">const FILE_ASN1_CLASS_CONTEXT_SPECIFIC</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00050">ASN1.php:50</a></div></div>
<div class="ttc" id="aASN1_8php_html_ac823a955a2086f2f57d56ce1de9eab01"><div class="ttname"><a href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_IA5_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00086">ASN1.php:86</a></div></div>
<div class="ttc" id="aASN1_8php_html_ade866784098f01a9cb1e6901dec0bfca"><div class="ttname"><a href="ASN1_8php.html#ade866784098f01a9cb1e6901dec0bfca">FILE_ASN1_TYPE_SET</a></div><div class="ttdeci">const FILE_ASN1_TYPE_SET</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00074">ASN1.php:74</a></div></div>
<div class="ttc" id="aASN1_8php_html_ae7ec7ccc71e8bc4791dc45c2934d03c3"><div class="ttname"><a href="ASN1_8php.html#ae7ec7ccc71e8bc4791dc45c2934d03c3">FILE_ASN1_CLASS_PRIVATE</a></div><div class="ttdeci">const FILE_ASN1_CLASS_PRIVATE</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00051">ASN1.php:51</a></div></div>
<div class="ttc" id="aASN1_8php_html_af269bb1254bc4f65a21327c39530c0eb"><div class="ttname"><a href="ASN1_8php.html#af269bb1254bc4f65a21327c39530c0eb">FILE_ASN1_TYPE_NUMERIC_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_NUMERIC_STRING</div><div class="ttdoc">#-</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00082">ASN1.php:82</a></div></div>
<div class="ttc" id="aASN1_8php_html_afae5a2a5df49e80953c2bb088f9ce8fb"><div class="ttname"><a href="ASN1_8php.html#afae5a2a5df49e80953c2bb088f9ce8fb">FILE_ASN1_TYPE_BMP_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_BMP_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00094">ASN1.php:94</a></div></div>
<div class="ttc" id="aclassFile__ASN1_html_a8f552e81456e1e55cd55bb4158adb82a"><div class="ttname"><a href="classFile__ASN1.html#a8f552e81456e1e55cd55bb4158adb82a">File_ASN1\_decodeUnixTime</a></div><div class="ttdeci">_decodeUnixTime($content, $tag)</div><div class="ttdoc">BER-decode the time (using UNIX time)</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l01370">ASN1.php:1370</a></div></div>
<div class="ttc" id="aclassFile__ASN1_html_ac3c9042cbc9b53c7d39065e8ce11ddbd"><div class="ttname"><a href="classFile__ASN1.html#ac3c9042cbc9b53c7d39065e8ce11ddbd">File_ASN1\_decodeOID</a></div><div class="ttdeci">_decodeOID($content)</div><div class="ttdoc">BER-decode the OID.</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l01262">ASN1.php:1262</a></div></div>
<div class="ttc" id="aclassFile__ASN1_html_aca372fbe28962a08b98355562dc666bf"><div class="ttname"><a href="classFile__ASN1.html#aca372fbe28962a08b98355562dc666bf">File_ASN1\_decode_ber</a></div><div class="ttdeci">_decode_ber($encoded, $start=0, $encoded_pos=0)</div><div class="ttdoc">Parse BER-encoding (Helper function)</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00317">ASN1.php:317</a></div></div>
<div class="ttc" id="aclassFile__ASN1_html_ae93cbfbb826db862f63b3a54ff46df4e"><div class="ttname"><a href="classFile__ASN1.html#ae93cbfbb826db862f63b3a54ff46df4e">File_ASN1\_decodeDateTime</a></div><div class="ttdeci">_decodeDateTime($content, $tag)</div><div class="ttdoc">BER-decode the time (using DateTime)</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l01420">ASN1.php:1420</a></div></div>
<div class="ttc" id="actlr_8php_html_af709b460501204e2ec7e34e96e7de576"><div class="ttname"><a href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a></div><div class="ttdeci">$encoded</div><div class="ttdef"><b>Definition:</b> <a href="ctlr_8php_source.html#l00107">ctlr.php:107</a></div></div>
<div class="ttc" id="anamespaceMath__BigInteger_html"><div class="ttname"><a href="namespaceMath__BigInteger.html">Math_BigInteger</a></div><div class="ttdoc">Pure-PHP arbitrary precision integer arithmetic library.</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00107">$encoded</a>, <a class="el" href="ASN1_8php_source.html#l00317">_decode_ber()</a>, <a class="el" href="ASN1_8php_source.html#l01420">_decodeDateTime()</a>, <a class="el" href="ASN1_8php_source.html#l01262">_decodeOID()</a>, <a class="el" href="ASN1_8php_source.html#l01370">_decodeUnixTime()</a>, <a class="el" href="ASN1_8php_source.html#l00049">FILE_ASN1_CLASS_APPLICATION</a>, <a class="el" href="ASN1_8php_source.html#l00050">FILE_ASN1_CLASS_CONTEXT_SPECIFIC</a>, <a class="el" href="ASN1_8php_source.html#l00051">FILE_ASN1_CLASS_PRIVATE</a>, <a class="el" href="ASN1_8php_source.html#l00062">FILE_ASN1_TYPE_BIT_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00094">FILE_ASN1_TYPE_BMP_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00060">FILE_ASN1_TYPE_BOOLEAN</a>, <a class="el" href="ASN1_8php_source.html#l00069">FILE_ASN1_TYPE_ENUMERATED</a>, <a class="el" href="ASN1_8php_source.html#l00091">FILE_ASN1_TYPE_GENERAL_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00088">FILE_ASN1_TYPE_GENERALIZED_TIME</a>, <a class="el" href="ASN1_8php_source.html#l00089">FILE_ASN1_TYPE_GRAPHIC_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00086">FILE_ASN1_TYPE_IA5_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00061">FILE_ASN1_TYPE_INTEGER</a>, <a class="el" href="ASN1_8php_source.html#l00064">FILE_ASN1_TYPE_NULL</a>, <a class="el" href="ASN1_8php_source.html#l00082">FILE_ASN1_TYPE_NUMERIC_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00065">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>, <a class="el" href="ASN1_8php_source.html#l00063">FILE_ASN1_TYPE_OCTET_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00083">FILE_ASN1_TYPE_PRINTABLE_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00068">FILE_ASN1_TYPE_REAL</a>, <a class="el" href="ASN1_8php_source.html#l00073">FILE_ASN1_TYPE_SEQUENCE</a>, <a class="el" href="ASN1_8php_source.html#l00074">FILE_ASN1_TYPE_SET</a>, <a class="el" href="ASN1_8php_source.html#l00084">FILE_ASN1_TYPE_TELETEX_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00087">FILE_ASN1_TYPE_UTC_TIME</a>, <a class="el" href="ASN1_8php_source.html#l00071">FILE_ASN1_TYPE_UTF8_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00085">FILE_ASN1_TYPE_VIDEOTEX_STRING</a>, and <a class="el" href="ASN1_8php_source.html#l00090">FILE_ASN1_TYPE_VISIBLE_STRING</a>.</p>

<p class="reference">Referenced by <a class="el" href="ASN1_8php_source.html#l00317">_decode_ber()</a>, and <a class="el" href="ASN1_8php_source.html#l00293">decodeBER()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__ASN1_aca372fbe28962a08b98355562dc666bf_cgraph.png" border="0" usemap="#aclassFile__ASN1_aca372fbe28962a08b98355562dc666bf_cgraph" alt=""/></div>
<map name="aclassFile__ASN1_aca372fbe28962a08b98355562dc666bf_cgraph" id="aclassFile__ASN1_aca372fbe28962a08b98355562dc666bf_cgraph">
<area shape="rect" title="Parse BER&#45;encoding (Helper function)" alt="" coords="5,55,109,80"/>
<area shape="rect" href="classFile__ASN1.html#ae93cbfbb826db862f63b3a54ff46df4e" title="BER&#45;decode the time (using DateTime)" alt="" coords="157,5,297,31"/>
<area shape="rect" href="classFile__ASN1.html#ac3c9042cbc9b53c7d39065e8ce11ddbd" title="BER&#45;decode the OID." alt="" coords="177,55,277,80"/>
<area shape="rect" href="classFile__ASN1.html#a8f552e81456e1e55cd55bb4158adb82a" title="BER&#45;decode the time (using UNIX time)" alt="" coords="158,104,297,129"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__ASN1_aca372fbe28962a08b98355562dc666bf_icgraph.png" border="0" usemap="#aclassFile__ASN1_aca372fbe28962a08b98355562dc666bf_icgraph" alt=""/></div>
<map name="aclassFile__ASN1_aca372fbe28962a08b98355562dc666bf_icgraph" id="aclassFile__ASN1_aca372fbe28962a08b98355562dc666bf_icgraph">
<area shape="rect" title="Parse BER&#45;encoding (Helper function)" alt="" coords="148,29,252,55"/>
<area shape="rect" href="classFile__ASN1.html#ab508b6e87220e34709b62205489c6e36" title="Parse BER&#45;encoding." alt="" coords="5,29,100,55"/>
</map>
</div>

</div>
</div>
<a id="ae93cbfbb826db862f63b3a54ff46df4e" name="ae93cbfbb826db862f63b3a54ff46df4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae93cbfbb826db862f63b3a54ff46df4e">&#9670;&#160;</a></span>_decodeDateTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_decodeDateTime </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>BER-decode the time (using DateTime) </p>
<p>Called by _decode_ber() and in the case of implicit tags asn1map().</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$content</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$tag</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l01420">1420</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1421</span>    {</div>
<div class="line"><span class="lineno"> 1422</span>        <span class="comment">/* UTCTime:</span></div>
<div class="line"><span class="lineno"> 1423</span><span class="comment">           http://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span></div>
<div class="line"><span class="lineno"> 1424</span><span class="comment">           http://www.obj-sys.com/asn1tutorial/node15.html</span></div>
<div class="line"><span class="lineno"> 1425</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1426</span><span class="comment">           GeneralizedTime:</span></div>
<div class="line"><span class="lineno"> 1427</span><span class="comment">           http://tools.ietf.org/html/rfc5280#section-4.1.2.5.2</span></div>
<div class="line"><span class="lineno"> 1428</span><span class="comment">           http://www.obj-sys.com/asn1tutorial/node14.html */</span></div>
<div class="line"><span class="lineno"> 1429</span> </div>
<div class="line"><span class="lineno"> 1430</span>        $format = <span class="stringliteral">&#39;YmdHis&#39;</span>;</div>
<div class="line"><span class="lineno"> 1431</span> </div>
<div class="line"><span class="lineno"> 1432</span>        <span class="keywordflow">if</span> ($tag == <a class="code hl_variable" href="ASN1_8php.html#a842b61be906cf8882ae9b54a974231ba">FILE_ASN1_TYPE_UTC_TIME</a>) {</div>
<div class="line"><span class="lineno"> 1433</span>            <span class="comment">// https://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf#page=28 says &quot;the seconds</span></div>
<div class="line"><span class="lineno"> 1434</span>            <span class="comment">// element shall always be present&quot; but none-the-less I&#39;ve seen X509 certs where it isn&#39;t and if the</span></div>
<div class="line"><span class="lineno"> 1435</span>            <span class="comment">// browsers parse it phpseclib ought to too</span></div>
<div class="line"><span class="lineno"> 1436</span>            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;#^(\d{10})(Z|[+-]\d{4})$#&#39;</span>, $content, $matches)) {</div>
<div class="line"><span class="lineno"> 1437</span>                $content = $matches[1] . <span class="stringliteral">&#39;00&#39;</span> . $matches[2];</div>
<div class="line"><span class="lineno"> 1438</span>            }</div>
<div class="line"><span class="lineno"> 1439</span>            $prefix = substr($content, 0, 2) &gt;= 50 ? <span class="stringliteral">&#39;19&#39;</span> : <span class="stringliteral">&#39;20&#39;</span>;</div>
<div class="line"><span class="lineno"> 1440</span>            $content = $prefix . $content;</div>
<div class="line"><span class="lineno"> 1441</span>        } elseif (strpos($content, <span class="charliteral">&#39;.&#39;</span>) !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1442</span>            <a class="code hl_variable" href="classFile__ASN1.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>.= <span class="stringliteral">&#39;.u&#39;</span>;</div>
<div class="line"><span class="lineno"> 1443</span>        }</div>
<div class="line"><span class="lineno"> 1444</span> </div>
<div class="line"><span class="lineno"> 1445</span>        <span class="keywordflow">if</span> ($content[strlen($content) - 1] == <span class="charliteral">&#39;Z&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1446</span>            $content = substr($content, 0, -1) . <span class="stringliteral">&#39;+0000&#39;</span>;</div>
<div class="line"><span class="lineno"> 1447</span>        }</div>
<div class="line"><span class="lineno"> 1448</span> </div>
<div class="line"><span class="lineno"> 1449</span>        <span class="keywordflow">if</span> (strpos($content, <span class="charliteral">&#39;-&#39;</span>) !== <span class="keyword">false</span> || strpos($content, <span class="charliteral">&#39;+&#39;</span>) !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1450</span>            <a class="code hl_variable" href="classFile__ASN1.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>.= <span class="charliteral">&#39;O&#39;</span>;</div>
<div class="line"><span class="lineno"> 1451</span>        }</div>
<div class="line"><span class="lineno"> 1452</span> </div>
<div class="line"><span class="lineno"> 1453</span>        <span class="comment">// error supression isn&#39;t necessary as of PHP 7.0:</span></div>
<div class="line"><span class="lineno"> 1454</span>        <span class="comment">// http://php.net/manual/en/migration70.other-changes.php</span></div>
<div class="line"><span class="lineno"> 1455</span>        <span class="keywordflow">return</span> @DateTime::createFromFormat($format, $content);</div>
<div class="line"><span class="lineno"> 1456</span>    }</div>
<div class="ttc" id="aclassFile__ASN1_html_a1e6e4ea377a908a5407c435e9054e3a9"><div class="ttname"><a href="classFile__ASN1.html#a1e6e4ea377a908a5407c435e9054e3a9">File_ASN1\$format</a></div><div class="ttdeci">$format</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00177">ASN1.php:177</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ASN1_8php_source.html#l00087">FILE_ASN1_TYPE_UTC_TIME</a>.</p>

<p class="reference">Referenced by <a class="el" href="ASN1_8php_source.html#l00317">_decode_ber()</a>, and <a class="el" href="ASN1_8php_source.html#l00616">asn1map()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__ASN1_ae93cbfbb826db862f63b3a54ff46df4e_icgraph.png" border="0" usemap="#aclassFile__ASN1_ae93cbfbb826db862f63b3a54ff46df4e_icgraph" alt=""/></div>
<map name="aclassFile__ASN1_ae93cbfbb826db862f63b3a54ff46df4e_icgraph" id="aclassFile__ASN1_ae93cbfbb826db862f63b3a54ff46df4e_icgraph">
<area shape="rect" title="BER&#45;decode the time (using DateTime)" alt="" coords="300,67,440,92"/>
<area shape="rect" href="classFile__ASN1.html#aca372fbe28962a08b98355562dc666bf" title="Parse BER&#45;encoding (Helper function)" alt="" coords="148,29,252,55"/>
<area shape="rect" href="classFile__ASN1.html#a1f30a92054d93d8c5470681b1f0508dc" title="ASN.1 Map." alt="" coords="159,103,241,128"/>
<area shape="rect" href="classFile__ASN1.html#ab508b6e87220e34709b62205489c6e36" title="Parse BER&#45;encoding." alt="" coords="5,29,100,55"/>
</map>
</div>

</div>
</div>
<a id="ac3c9042cbc9b53c7d39065e8ce11ddbd" name="ac3c9042cbc9b53c7d39065e8ce11ddbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3c9042cbc9b53c7d39065e8ce11ddbd">&#9670;&#160;</a></span>_decodeOID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_decodeOID </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$content</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>BER-decode the OID. </p>
<p>Called by _decode_ber()</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$content</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l01262">1262</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1263</span>    {</div>
<div class="line"><span class="lineno"> 1264</span>        <span class="keyword">static</span> $eighty;</div>
<div class="line"><span class="lineno"> 1265</span>        <span class="keywordflow">if</span> (!$eighty) {</div>
<div class="line"><span class="lineno"> 1266</span>            $eighty = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>(80);</div>
<div class="line"><span class="lineno"> 1267</span>        }</div>
<div class="line"><span class="lineno"> 1268</span> </div>
<div class="line"><span class="lineno"> 1269</span>        $oid = array();</div>
<div class="line"><span class="lineno"> 1270</span>        $pos = 0;</div>
<div class="line"><span class="lineno"> 1271</span>        $len = strlen($content);</div>
<div class="line"><span class="lineno"> 1272</span> </div>
<div class="line"><span class="lineno"> 1273</span>        <span class="keywordflow">if</span> (ord($content[$len - 1]) &amp; 0x80) {</div>
<div class="line"><span class="lineno"> 1274</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1275</span>        }</div>
<div class="line"><span class="lineno"> 1276</span> </div>
<div class="line"><span class="lineno"> 1277</span>        $n = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>();</div>
<div class="line"><span class="lineno"> 1278</span>        <span class="keywordflow">while</span> ($pos &lt; $len) {</div>
<div class="line"><span class="lineno"> 1279</span>            $temp = ord($content[$pos++]);</div>
<div class="line"><span class="lineno"> 1280</span>            $n = $n-&gt;bitwise_leftShift(7);</div>
<div class="line"><span class="lineno"> 1281</span>            $n = $n-&gt;bitwise_or(<span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($temp &amp; 0x7F));</div>
<div class="line"><span class="lineno"> 1282</span>            <span class="keywordflow">if</span> (~$temp &amp; 0x80) {</div>
<div class="line"><span class="lineno"> 1283</span>                $oid[] = $n;</div>
<div class="line"><span class="lineno"> 1284</span>                $n = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>();</div>
<div class="line"><span class="lineno"> 1285</span>            }</div>
<div class="line"><span class="lineno"> 1286</span>        }</div>
<div class="line"><span class="lineno"> 1287</span>        $part1 = array_shift($oid);</div>
<div class="line"><span class="lineno"> 1288</span>        $first = floor(ord($content[0]) / 40);</div>
<div class="line"><span class="lineno"> 1289</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1290</span><span class="comment">          &quot;This packing of the first two object identifier components recognizes that only three values are allocated from the root</span></div>
<div class="line"><span class="lineno"> 1291</span><span class="comment">           node, and at most 39 subsequent values from nodes reached by X = 0 and X = 1.&quot;</span></div>
<div class="line"><span class="lineno"> 1292</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1293</span><span class="comment">          -- https://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf#page=22</span></div>
<div class="line"><span class="lineno"> 1294</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 1295</span>        <span class="keywordflow">if</span> ($first &lt;= 2) { <span class="comment">// ie. 0 &lt;= ord($content[0]) &lt; 120 (0x78)</span></div>
<div class="line"><span class="lineno"> 1296</span>            array_unshift($oid, ord($content[0]) % 40);</div>
<div class="line"><span class="lineno"> 1297</span>            array_unshift($oid, $first);</div>
<div class="line"><span class="lineno"> 1298</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1299</span>            array_unshift($oid, $part1-&gt;subtract($eighty));</div>
<div class="line"><span class="lineno"> 1300</span>            array_unshift($oid, 2);</div>
<div class="line"><span class="lineno"> 1301</span>        }</div>
<div class="line"><span class="lineno"> 1302</span> </div>
<div class="line"><span class="lineno"> 1303</span>        <span class="keywordflow">return</span> implode(<span class="charliteral">&#39;.&#39;</span>, $oid);</div>
<div class="line"><span class="lineno"> 1304</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ASN1_8php_source.html#l00317">_decode_ber()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__ASN1_ac3c9042cbc9b53c7d39065e8ce11ddbd_icgraph.png" border="0" usemap="#aclassFile__ASN1_ac3c9042cbc9b53c7d39065e8ce11ddbd_icgraph" alt=""/></div>
<map name="aclassFile__ASN1_ac3c9042cbc9b53c7d39065e8ce11ddbd_icgraph" id="aclassFile__ASN1_ac3c9042cbc9b53c7d39065e8ce11ddbd_icgraph">
<area shape="rect" title="BER&#45;decode the OID." alt="" coords="300,29,400,55"/>
<area shape="rect" href="classFile__ASN1.html#aca372fbe28962a08b98355562dc666bf" title="Parse BER&#45;encoding (Helper function)" alt="" coords="148,29,252,55"/>
<area shape="rect" href="classFile__ASN1.html#ab508b6e87220e34709b62205489c6e36" title="Parse BER&#45;encoding." alt="" coords="5,29,100,55"/>
</map>
</div>

</div>
</div>
<a id="a8f552e81456e1e55cd55bb4158adb82a" name="a8f552e81456e1e55cd55bb4158adb82a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f552e81456e1e55cd55bb4158adb82a">&#9670;&#160;</a></span>_decodeUnixTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_decodeUnixTime </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>BER-decode the time (using UNIX time) </p>
<p>Called by _decode_ber() and in the case of implicit tags asn1map().</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$content</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$tag</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l01370">1370</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1371</span>    {</div>
<div class="line"><span class="lineno"> 1372</span>        <span class="comment">/* UTCTime:</span></div>
<div class="line"><span class="lineno"> 1373</span><span class="comment">           http://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span></div>
<div class="line"><span class="lineno"> 1374</span><span class="comment">           http://www.obj-sys.com/asn1tutorial/node15.html</span></div>
<div class="line"><span class="lineno"> 1375</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1376</span><span class="comment">           GeneralizedTime:</span></div>
<div class="line"><span class="lineno"> 1377</span><span class="comment">           http://tools.ietf.org/html/rfc5280#section-4.1.2.5.2</span></div>
<div class="line"><span class="lineno"> 1378</span><span class="comment">           http://www.obj-sys.com/asn1tutorial/node14.html */</span></div>
<div class="line"><span class="lineno"> 1379</span> </div>
<div class="line"><span class="lineno"> 1380</span>        $pattern = $tag == <a class="code hl_variable" href="ASN1_8php.html#a842b61be906cf8882ae9b54a974231ba">FILE_ASN1_TYPE_UTC_TIME</a> ?</div>
<div class="line"><span class="lineno"> 1381</span>            <span class="stringliteral">&#39;#^(..)(..)(..)(..)(..)(..)?(.*)$#&#39;</span> :</div>
<div class="line"><span class="lineno"> 1382</span>            <span class="stringliteral">&#39;#(....)(..)(..)(..)(..)(..).*([Z+-].*)$#&#39;</span>;</div>
<div class="line"><span class="lineno"> 1383</span> </div>
<div class="line"><span class="lineno"> 1384</span>        preg_match($pattern, $content, $matches);</div>
<div class="line"><span class="lineno"> 1385</span> </div>
<div class="line"><span class="lineno"> 1386</span>        list(, $year, $month, $day, $hour, $minute, $second, $timezone) = $matches;</div>
<div class="line"><span class="lineno"> 1387</span> </div>
<div class="line"><span class="lineno"> 1388</span>        <span class="keywordflow">if</span> ($tag == <a class="code hl_variable" href="ASN1_8php.html#a842b61be906cf8882ae9b54a974231ba">FILE_ASN1_TYPE_UTC_TIME</a>) {</div>
<div class="line"><span class="lineno"> 1389</span>            $year = $year &gt;= 50 ? <span class="stringliteral">&quot;19$year&quot;</span> : <span class="stringliteral">&quot;20$year&quot;</span>;</div>
<div class="line"><span class="lineno"> 1390</span>        }</div>
<div class="line"><span class="lineno"> 1391</span> </div>
<div class="line"><span class="lineno"> 1392</span>        <span class="keywordflow">if</span> ($timezone == <span class="charliteral">&#39;Z&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1393</span>            $mktime = <span class="stringliteral">&#39;gmmktime&#39;</span>;</div>
<div class="line"><span class="lineno"> 1394</span>            $timezone = 0;</div>
<div class="line"><span class="lineno"> 1395</span>        } elseif (preg_match(<span class="stringliteral">&#39;#([+-])(\d\d)(\d\d)#&#39;</span>, $timezone, $matches)) {</div>
<div class="line"><span class="lineno"> 1396</span>            $mktime = <span class="stringliteral">&#39;gmmktime&#39;</span>;</div>
<div class="line"><span class="lineno"> 1397</span>            $timezone = 60 * $matches[3] + 3600 * $matches[2];</div>
<div class="line"><span class="lineno"> 1398</span>            <span class="keywordflow">if</span> ($matches[1] == <span class="charliteral">&#39;-&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1399</span>                $timezone = -$timezone;</div>
<div class="line"><span class="lineno"> 1400</span>            }</div>
<div class="line"><span class="lineno"> 1401</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1402</span>            $mktime = <span class="stringliteral">&#39;mktime&#39;</span>;</div>
<div class="line"><span class="lineno"> 1403</span>            $timezone = 0;</div>
<div class="line"><span class="lineno"> 1404</span>        }</div>
<div class="line"><span class="lineno"> 1405</span> </div>
<div class="line"><span class="lineno"> 1406</span>        <span class="keywordflow">return</span> @$mktime((<span class="keywordtype">int</span>)$hour, (<span class="keywordtype">int</span>)$minute, (<span class="keywordtype">int</span>)$second, (<span class="keywordtype">int</span>)$month, (<span class="keywordtype">int</span>)$day, (<span class="keywordtype">int</span>)$year) + $timezone;</div>
<div class="line"><span class="lineno"> 1407</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ASN1_8php_source.html#l00087">FILE_ASN1_TYPE_UTC_TIME</a>.</p>

<p class="reference">Referenced by <a class="el" href="ASN1_8php_source.html#l00317">_decode_ber()</a>, and <a class="el" href="ASN1_8php_source.html#l00616">asn1map()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__ASN1_a8f552e81456e1e55cd55bb4158adb82a_icgraph.png" border="0" usemap="#aclassFile__ASN1_a8f552e81456e1e55cd55bb4158adb82a_icgraph" alt=""/></div>
<map name="aclassFile__ASN1_a8f552e81456e1e55cd55bb4158adb82a_icgraph" id="aclassFile__ASN1_a8f552e81456e1e55cd55bb4158adb82a_icgraph">
<area shape="rect" title="BER&#45;decode the time (using UNIX time)" alt="" coords="300,67,439,92"/>
<area shape="rect" href="classFile__ASN1.html#aca372fbe28962a08b98355562dc666bf" title="Parse BER&#45;encoding (Helper function)" alt="" coords="148,29,252,55"/>
<area shape="rect" href="classFile__ASN1.html#a1f30a92054d93d8c5470681b1f0508dc" title="ASN.1 Map." alt="" coords="159,103,241,128"/>
<area shape="rect" href="classFile__ASN1.html#ab508b6e87220e34709b62205489c6e36" title="Parse BER&#45;encoding." alt="" coords="5,29,100,55"/>
</map>
</div>

</div>
</div>
<a id="ab6152ed3dc2806e3cf7821a7fbdc97f3" name="ab6152ed3dc2806e3cf7821a7fbdc97f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6152ed3dc2806e3cf7821a7fbdc97f3">&#9670;&#160;</a></span>_encode_der()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_encode_der </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mapping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$idx</em> = <code>null</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$special</em> = <code>array()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ASN.1 Encode (Helper function) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$source</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$mapping</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$idx</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$special</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string @access private </dd></dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l00948">948</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  949</span>    {</div>
<div class="line"><span class="lineno">  950</span>        <span class="keywordflow">if</span> (is_object($source) &amp;&amp; strtolower(get_class($source)) == <span class="stringliteral">&#39;file_asn1_element&#39;</span>) {</div>
<div class="line"><span class="lineno">  951</span>            <span class="keywordflow">return</span> $source-&gt;element;</div>
<div class="line"><span class="lineno">  952</span>        }</div>
<div class="line"><span class="lineno">  953</span> </div>
<div class="line"><span class="lineno">  954</span>        <span class="comment">// do not encode (implicitly optional) fields with value set to default</span></div>
<div class="line"><span class="lineno">  955</span>        <span class="keywordflow">if</span> (isset($mapping[<span class="stringliteral">&#39;default&#39;</span>]) &amp;&amp; $source === $mapping[<span class="stringliteral">&#39;default&#39;</span>]) {</div>
<div class="line"><span class="lineno">  956</span>            <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  957</span>        }</div>
<div class="line"><span class="lineno">  958</span> </div>
<div class="line"><span class="lineno">  959</span>        <span class="keywordflow">if</span> (isset($idx)) {</div>
<div class="line"><span class="lineno">  960</span>            <span class="keywordflow">if</span> (isset($special[$idx])) {</div>
<div class="line"><span class="lineno">  961</span>                $source = call_user_func($special[$idx], $source);</div>
<div class="line"><span class="lineno">  962</span>            }</div>
<div class="line"><span class="lineno">  963</span>            $this-&gt;location[] = $idx;</div>
<div class="line"><span class="lineno">  964</span>        }</div>
<div class="line"><span class="lineno">  965</span> </div>
<div class="line"><span class="lineno">  966</span>        $tag = $mapping[<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><span class="lineno">  967</span> </div>
<div class="line"><span class="lineno">  968</span>        <span class="keywordflow">switch</span> ($tag) {</div>
<div class="line"><span class="lineno">  969</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#ade866784098f01a9cb1e6901dec0bfca">FILE_ASN1_TYPE_SET</a>:    <span class="comment">// Children order is not important, thus process in sequence.</span></div>
<div class="line"><span class="lineno">  970</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>:</div>
<div class="line"><span class="lineno">  971</span>                $tag|= 0x20; <span class="comment">// set the constructed bit</span></div>
<div class="line"><span class="lineno">  972</span> </div>
<div class="line"><span class="lineno">  973</span>                <span class="comment">// ignore the min and max</span></div>
<div class="line"><span class="lineno">  974</span>                <span class="keywordflow">if</span> (isset($mapping[<span class="stringliteral">&#39;min&#39;</span>]) &amp;&amp; isset($mapping[<span class="stringliteral">&#39;max&#39;</span>])) {</div>
<div class="line"><span class="lineno">  975</span>                    $value = array();</div>
<div class="line"><span class="lineno">  976</span>                    $child = $mapping[<span class="stringliteral">&#39;children&#39;</span>];</div>
<div class="line"><span class="lineno">  977</span> </div>
<div class="line"><span class="lineno">  978</span>                    <span class="keywordflow">foreach</span> ($source as $content) {</div>
<div class="line"><span class="lineno">  979</span>                        $temp = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ab6152ed3dc2806e3cf7821a7fbdc97f3">_encode_der</a>($content, $child, <span class="keyword">null</span>, $special);</div>
<div class="line"><span class="lineno">  980</span>                        <span class="keywordflow">if</span> ($temp === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  981</span>                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  982</span>                        }</div>
<div class="line"><span class="lineno">  983</span>                        $value[]= $temp;</div>
<div class="line"><span class="lineno">  984</span>                    }</div>
<div class="line"><span class="lineno">  985</span>                    <span class="comment">/* &quot;The encodings of the component values of a set-of value shall appear in ascending order, the encodings being compared</span></div>
<div class="line"><span class="lineno">  986</span><span class="comment">                        as octet strings with the shorter components being padded at their trailing end with 0-octets.</span></div>
<div class="line"><span class="lineno">  987</span><span class="comment">                        NOTE - The padding octets are for comparison purposes only and do not appear in the encodings.&quot;</span></div>
<div class="line"><span class="lineno">  988</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  989</span><span class="comment">                       -- sec 11.6 of http://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf  */</span></div>
<div class="line"><span class="lineno">  990</span>                    <span class="keywordflow">if</span> ($mapping[<span class="stringliteral">&#39;type&#39;</span>] == <a class="code hl_variable" href="ASN1_8php.html#ade866784098f01a9cb1e6901dec0bfca">FILE_ASN1_TYPE_SET</a>) {</div>
<div class="line"><span class="lineno">  991</span>                        sort($value);</div>
<div class="line"><span class="lineno">  992</span>                    }</div>
<div class="line"><span class="lineno">  993</span>                    $value = implode(<span class="stringliteral">&#39;&#39;</span>, $value);</div>
<div class="line"><span class="lineno">  994</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  995</span>                }</div>
<div class="line"><span class="lineno">  996</span> </div>
<div class="line"><span class="lineno">  997</span>                $value = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  998</span>                <span class="keywordflow">foreach</span> ($mapping[<span class="stringliteral">&#39;children&#39;</span>] as $key =&gt; $child) {</div>
<div class="line"><span class="lineno">  999</span>                    <span class="keywordflow">if</span> (!array_key_exists($key, $source)) {</div>
<div class="line"><span class="lineno"> 1000</span>                        <span class="keywordflow">if</span> (!isset($child[<span class="stringliteral">&#39;optional&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1001</span>                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1002</span>                        }</div>
<div class="line"><span class="lineno"> 1003</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1004</span>                    }</div>
<div class="line"><span class="lineno"> 1005</span> </div>
<div class="line"><span class="lineno"> 1006</span>                    $temp = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ab6152ed3dc2806e3cf7821a7fbdc97f3">_encode_der</a>($source[$key], $child, $key, $special);</div>
<div class="line"><span class="lineno"> 1007</span>                    <span class="keywordflow">if</span> ($temp === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1008</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1009</span>                    }</div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span>                    <span class="comment">// An empty child encoding means it has been optimized out.</span></div>
<div class="line"><span class="lineno"> 1012</span>                    <span class="comment">// Else we should have at least one tag byte.</span></div>
<div class="line"><span class="lineno"> 1013</span>                    <span class="keywordflow">if</span> ($temp === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1014</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1015</span>                    }</div>
<div class="line"><span class="lineno"> 1016</span> </div>
<div class="line"><span class="lineno"> 1017</span>                    <span class="comment">// if isset($child[&#39;constant&#39;]) is true then isset($child[&#39;optional&#39;]) should be true as well</span></div>
<div class="line"><span class="lineno"> 1018</span>                    <span class="keywordflow">if</span> (isset($child[<span class="stringliteral">&#39;constant&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1019</span>                        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1020</span><span class="comment">                           From X.680-0207.pdf#page=58 (30.6):</span></div>
<div class="line"><span class="lineno"> 1021</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1022</span><span class="comment">                           &quot;The tagging construction specifies explicit tagging if any of the following holds:</span></div>
<div class="line"><span class="lineno"> 1023</span><span class="comment">                            ...</span></div>
<div class="line"><span class="lineno"> 1024</span><span class="comment">                            c) the &quot;Tag Type&quot; alternative is used and the value of &quot;TagDefault&quot; for the module is IMPLICIT TAGS or</span></div>
<div class="line"><span class="lineno"> 1025</span><span class="comment">                            AUTOMATIC TAGS, but the type defined by &quot;Type&quot; is an untagged choice type, an untagged open type, or</span></div>
<div class="line"><span class="lineno"> 1026</span><span class="comment">                            an untagged &quot;DummyReference&quot; (see ITU-T Rec. X.683 | ISO/IEC 8824-4, 8.3).&quot;</span></div>
<div class="line"><span class="lineno"> 1027</span><span class="comment">                         */</span></div>
<div class="line"><span class="lineno"> 1028</span>                        <span class="keywordflow">if</span> (isset($child[<span class="stringliteral">&#39;explicit&#39;</span>]) || $child[<span class="stringliteral">&#39;type&#39;</span>] == <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>) {</div>
<div class="line"><span class="lineno"> 1029</span>                            $subtag = chr((<a class="code hl_variable" href="ASN1_8php.html#ac0ccdf6580b85de79b4a0dc084f285f0">FILE_ASN1_CLASS_CONTEXT_SPECIFIC</a> &lt;&lt; 6) | 0x20 | $child[<span class="stringliteral">&#39;constant&#39;</span>]);</div>
<div class="line"><span class="lineno"> 1030</span>                            $temp = $subtag . $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($temp)) . $temp;</div>
<div class="line"><span class="lineno"> 1031</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1032</span>                            $subtag = chr((<a class="code hl_variable" href="ASN1_8php.html#ac0ccdf6580b85de79b4a0dc084f285f0">FILE_ASN1_CLASS_CONTEXT_SPECIFIC</a> &lt;&lt; 6) | (ord($temp[0]) &amp; 0x20) | $child[<span class="stringliteral">&#39;constant&#39;</span>]);</div>
<div class="line"><span class="lineno"> 1033</span>                            $temp = $subtag . substr($temp, 1);</div>
<div class="line"><span class="lineno"> 1034</span>                        }</div>
<div class="line"><span class="lineno"> 1035</span>                    }</div>
<div class="line"><span class="lineno"> 1036</span>                    $value.= $temp;</div>
<div class="line"><span class="lineno"> 1037</span>                }</div>
<div class="line"><span class="lineno"> 1038</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1039</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>:</div>
<div class="line"><span class="lineno"> 1040</span>                $temp = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1041</span> </div>
<div class="line"><span class="lineno"> 1042</span>                <span class="keywordflow">foreach</span> ($mapping[<span class="stringliteral">&#39;children&#39;</span>] as $key =&gt; $child) {</div>
<div class="line"><span class="lineno"> 1043</span>                    <span class="keywordflow">if</span> (!isset($source[$key])) {</div>
<div class="line"><span class="lineno"> 1044</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1045</span>                    }</div>
<div class="line"><span class="lineno"> 1046</span> </div>
<div class="line"><span class="lineno"> 1047</span>                    $temp = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ab6152ed3dc2806e3cf7821a7fbdc97f3">_encode_der</a>($source[$key], $child, $key, $special);</div>
<div class="line"><span class="lineno"> 1048</span>                    <span class="keywordflow">if</span> ($temp === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1049</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1050</span>                    }</div>
<div class="line"><span class="lineno"> 1051</span> </div>
<div class="line"><span class="lineno"> 1052</span>                    <span class="comment">// An empty child encoding means it has been optimized out.</span></div>
<div class="line"><span class="lineno"> 1053</span>                    <span class="comment">// Else we should have at least one tag byte.</span></div>
<div class="line"><span class="lineno"> 1054</span>                    <span class="keywordflow">if</span> ($temp === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1055</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1056</span>                    }</div>
<div class="line"><span class="lineno"> 1057</span> </div>
<div class="line"><span class="lineno"> 1058</span>                    $tag = ord($temp[0]);</div>
<div class="line"><span class="lineno"> 1059</span> </div>
<div class="line"><span class="lineno"> 1060</span>                    <span class="comment">// if isset($child[&#39;constant&#39;]) is true then isset($child[&#39;optional&#39;]) should be true as well</span></div>
<div class="line"><span class="lineno"> 1061</span>                    <span class="keywordflow">if</span> (isset($child[<span class="stringliteral">&#39;constant&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1062</span>                        <span class="keywordflow">if</span> (isset($child[<span class="stringliteral">&#39;explicit&#39;</span>]) || $child[<span class="stringliteral">&#39;type&#39;</span>] == <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>) {</div>
<div class="line"><span class="lineno"> 1063</span>                            $subtag = chr((<a class="code hl_variable" href="ASN1_8php.html#ac0ccdf6580b85de79b4a0dc084f285f0">FILE_ASN1_CLASS_CONTEXT_SPECIFIC</a> &lt;&lt; 6) | 0x20 | $child[<span class="stringliteral">&#39;constant&#39;</span>]);</div>
<div class="line"><span class="lineno"> 1064</span>                            $temp = $subtag . $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($temp)) . $temp;</div>
<div class="line"><span class="lineno"> 1065</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1066</span>                            $subtag = chr((<a class="code hl_variable" href="ASN1_8php.html#ac0ccdf6580b85de79b4a0dc084f285f0">FILE_ASN1_CLASS_CONTEXT_SPECIFIC</a> &lt;&lt; 6) | (ord($temp[0]) &amp; 0x20) | $child[<span class="stringliteral">&#39;constant&#39;</span>]);</div>
<div class="line"><span class="lineno"> 1067</span>                            $temp = $subtag . substr($temp, 1);</div>
<div class="line"><span class="lineno"> 1068</span>                        }</div>
<div class="line"><span class="lineno"> 1069</span>                    }</div>
<div class="line"><span class="lineno"> 1070</span>                }</div>
<div class="line"><span class="lineno"> 1071</span> </div>
<div class="line"><span class="lineno"> 1072</span>                <span class="keywordflow">if</span> (isset($idx)) {</div>
<div class="line"><span class="lineno"> 1073</span>                    array_pop($this-&gt;location);</div>
<div class="line"><span class="lineno"> 1074</span>                }</div>
<div class="line"><span class="lineno"> 1075</span> </div>
<div class="line"><span class="lineno"> 1076</span>                <span class="keywordflow">if</span> ($temp &amp;&amp; isset($mapping[<span class="stringliteral">&#39;cast&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1077</span>                    $temp[0] = chr(($mapping[<span class="stringliteral">&#39;class&#39;</span>] &lt;&lt; 6) | ($tag &amp; 0x20) | $mapping[<span class="stringliteral">&#39;cast&#39;</span>]);</div>
<div class="line"><span class="lineno"> 1078</span>                }</div>
<div class="line"><span class="lineno"> 1079</span> </div>
<div class="line"><span class="lineno"> 1080</span>                <span class="keywordflow">return</span> $temp;</div>
<div class="line"><span class="lineno"> 1081</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a9c3b70985b245c865ddf8874cc422ba6">FILE_ASN1_TYPE_INTEGER</a>:</div>
<div class="line"><span class="lineno"> 1082</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a96edb7b260fa5df901e8f458cb77064e">FILE_ASN1_TYPE_ENUMERATED</a>:</div>
<div class="line"><span class="lineno"> 1083</span>                <span class="keywordflow">if</span> (!isset($mapping[<span class="stringliteral">&#39;mapping&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1084</span>                    <span class="keywordflow">if</span> (is_numeric($source)) {</div>
<div class="line"><span class="lineno"> 1085</span>                        $source = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($source);</div>
<div class="line"><span class="lineno"> 1086</span>                    }</div>
<div class="line"><span class="lineno"> 1087</span>                    $value = $source-&gt;toBytes(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1088</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1089</span>                    $value = array_search($source, $mapping[<span class="stringliteral">&#39;mapping&#39;</span>]);</div>
<div class="line"><span class="lineno"> 1090</span>                    <span class="keywordflow">if</span> ($value === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1091</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1092</span>                    }</div>
<div class="line"><span class="lineno"> 1093</span>                    $value = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($value);</div>
<div class="line"><span class="lineno"> 1094</span>                    $value = $value-&gt;toBytes(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1095</span>                }</div>
<div class="line"><span class="lineno"> 1096</span>                <span class="keywordflow">if</span> (!strlen($value)) {</div>
<div class="line"><span class="lineno"> 1097</span>                    $value = chr(0);</div>
<div class="line"><span class="lineno"> 1098</span>                }</div>
<div class="line"><span class="lineno"> 1099</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1100</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a842b61be906cf8882ae9b54a974231ba">FILE_ASN1_TYPE_UTC_TIME</a>:</div>
<div class="line"><span class="lineno"> 1101</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a8ad0c6d6389ce6c6fb2e633814cbfd42">FILE_ASN1_TYPE_GENERALIZED_TIME</a>:</div>
<div class="line"><span class="lineno"> 1102</span>                <a class="code hl_variable" href="classFile__ASN1.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a> = $mapping[<span class="stringliteral">&#39;type&#39;</span>] == <a class="code hl_variable" href="ASN1_8php.html#a842b61be906cf8882ae9b54a974231ba">FILE_ASN1_TYPE_UTC_TIME</a> ? <span class="charliteral">&#39;y&#39;</span> : <span class="charliteral">&#39;Y&#39;</span>;</div>
<div class="line"><span class="lineno"> 1103</span>                <a class="code hl_variable" href="classFile__ASN1.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>.= <span class="stringliteral">&#39;mdHis&#39;</span>;</div>
<div class="line"><span class="lineno"> 1104</span>                <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;DateTime&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 1105</span>                    $value = @gmdate($format, strtotime($source)) . <span class="charliteral">&#39;Z&#39;</span>;</div>
<div class="line"><span class="lineno"> 1106</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1107</span>                    <span class="comment">// if $source does _not_ include timezone information within it then assume that the timezone is GMT</span></div>
<div class="line"><span class="lineno"> 1108</span>                    $date = <span class="keyword">new</span> DateTime($source, <span class="keyword">new</span> DateTimeZone(<span class="stringliteral">&#39;GMT&#39;</span>));</div>
<div class="line"><span class="lineno"> 1109</span>                    <span class="comment">// if $source _does_ include timezone information within it then convert the time to GMT</span></div>
<div class="line"><span class="lineno"> 1110</span>                    $date-&gt;setTimezone(<span class="keyword">new</span> DateTimeZone(<span class="stringliteral">&#39;GMT&#39;</span>));</div>
<div class="line"><span class="lineno"> 1111</span>                    $value = $date-&gt;format($format) . <span class="charliteral">&#39;Z&#39;</span>;</div>
<div class="line"><span class="lineno"> 1112</span>                }</div>
<div class="line"><span class="lineno"> 1113</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1114</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>:</div>
<div class="line"><span class="lineno"> 1115</span>                <span class="keywordflow">if</span> (isset($mapping[<span class="stringliteral">&#39;mapping&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1116</span>                    $bits = array_fill(0, count($mapping[<span class="stringliteral">&#39;mapping&#39;</span>]), 0);</div>
<div class="line"><span class="lineno"> 1117</span>                    $size = 0;</div>
<div class="line"><span class="lineno"> 1118</span>                    <span class="keywordflow">for</span> ($i = 0; $i &lt; count($mapping[<span class="stringliteral">&#39;mapping&#39;</span>]); $i++) {</div>
<div class="line"><span class="lineno"> 1119</span>                        <span class="keywordflow">if</span> (in_array($mapping[<span class="stringliteral">&#39;mapping&#39;</span>][$i], $source)) {</div>
<div class="line"><span class="lineno"> 1120</span>                            $bits[$i] = 1;</div>
<div class="line"><span class="lineno"> 1121</span>                            $size = $i;</div>
<div class="line"><span class="lineno"> 1122</span>                        }</div>
<div class="line"><span class="lineno"> 1123</span>                    }</div>
<div class="line"><span class="lineno"> 1124</span> </div>
<div class="line"><span class="lineno"> 1125</span>                    <span class="keywordflow">if</span> (isset($mapping[<span class="stringliteral">&#39;min&#39;</span>]) &amp;&amp; $mapping[<span class="stringliteral">&#39;min&#39;</span>] &gt;= 1 &amp;&amp; $size &lt; $mapping[<span class="stringliteral">&#39;min&#39;</span>]) {</div>
<div class="line"><span class="lineno"> 1126</span>                        $size = $mapping[<span class="stringliteral">&#39;min&#39;</span>] - 1;</div>
<div class="line"><span class="lineno"> 1127</span>                    }</div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>                    $offset = 8 - (($size + 1) &amp; 7);</div>
<div class="line"><span class="lineno"> 1130</span>                    $offset = $offset !== 8 ? $offset : 0;</div>
<div class="line"><span class="lineno"> 1131</span> </div>
<div class="line"><span class="lineno"> 1132</span>                    $value = chr($offset);</div>
<div class="line"><span class="lineno"> 1133</span> </div>
<div class="line"><span class="lineno"> 1134</span>                    <span class="keywordflow">for</span> ($i = $size + 1; $i &lt; count($mapping[<span class="stringliteral">&#39;mapping&#39;</span>]); $i++) {</div>
<div class="line"><span class="lineno"> 1135</span>                        unset($bits[$i]);</div>
<div class="line"><span class="lineno"> 1136</span>                    }</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span>                    $bits = implode(<span class="stringliteral">&#39;&#39;</span>, array_pad($bits, $size + $offset + 1, 0));</div>
<div class="line"><span class="lineno"> 1139</span>                    $bytes = explode(<span class="charliteral">&#39; &#39;</span>, rtrim(chunk_split($bits, 8, <span class="charliteral">&#39; &#39;</span>)));</div>
<div class="line"><span class="lineno"> 1140</span>                    <span class="keywordflow">foreach</span> ($bytes as $byte) {</div>
<div class="line"><span class="lineno"> 1141</span>                        $value.= chr(bindec($byte));</div>
<div class="line"><span class="lineno"> 1142</span>                    }</div>
<div class="line"><span class="lineno"> 1143</span> </div>
<div class="line"><span class="lineno"> 1144</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1145</span>                }</div>
<div class="line"><span class="lineno"> 1146</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a5cbfd497aefacbfc5766e0b266022fc2">FILE_ASN1_TYPE_OCTET_STRING</a>:</div>
<div class="line"><span class="lineno"> 1147</span>                <span class="comment">/* The initial octet shall encode, as an unsigned binary integer with bit 1 as the least significant bit,</span></div>
<div class="line"><span class="lineno"> 1148</span><span class="comment">                   the number of unused bits in the final subsequent octet. The number shall be in the range zero to seven.</span></div>
<div class="line"><span class="lineno"> 1149</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1150</span><span class="comment">                   -- http://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf#page=16 */</span></div>
<div class="line"><span class="lineno"> 1151</span>                $value = base64_decode($source);</div>
<div class="line"><span class="lineno"> 1152</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1153</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>:</div>
<div class="line"><span class="lineno"> 1154</span>                $value = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ae4b37b96ed86815954b693c12f839775">_encodeOID</a>($source);</div>
<div class="line"><span class="lineno"> 1155</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1156</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a96290e3bf3e87b630bc435b0beac8582">FILE_ASN1_TYPE_ANY</a>:</div>
<div class="line"><span class="lineno"> 1157</span>                $loc = $this-&gt;location;</div>
<div class="line"><span class="lineno"> 1158</span>                <span class="keywordflow">if</span> (isset($idx)) {</div>
<div class="line"><span class="lineno"> 1159</span>                    array_pop($this-&gt;location);</div>
<div class="line"><span class="lineno"> 1160</span>                }</div>
<div class="line"><span class="lineno"> 1161</span> </div>
<div class="line"><span class="lineno"> 1162</span>                <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 1163</span>                    <span class="keywordflow">case</span> !isset($source):</div>
<div class="line"><span class="lineno"> 1164</span>                        return $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ab6152ed3dc2806e3cf7821a7fbdc97f3">_encode_der</a>(null, array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a178f5750294c65763f2b1b2d1a4acb0d">FILE_ASN1_TYPE_NULL</a>) + $mapping, null, $special);</div>
<div class="line"><span class="lineno"> 1165</span>                    <span class="keywordflow">case</span> is_int($source):</div>
<div class="line"><span class="lineno"> 1166</span>                    case is_object($source) &amp;&amp; strtolower(get_class($source)) == <span class="stringliteral">&#39;math_biginteger&#39;</span>:</div>
<div class="line"><span class="lineno"> 1167</span>                        return $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ab6152ed3dc2806e3cf7821a7fbdc97f3">_encode_der</a>($source, array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a9c3b70985b245c865ddf8874cc422ba6">FILE_ASN1_TYPE_INTEGER</a>) + $mapping, null, $special);</div>
<div class="line"><span class="lineno"> 1168</span>                    <span class="keywordflow">case</span> is_float($source):</div>
<div class="line"><span class="lineno"> 1169</span>                        return $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ab6152ed3dc2806e3cf7821a7fbdc97f3">_encode_der</a>($source, array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#aafc4e432c511b12413cbb1dbd1a23191">FILE_ASN1_TYPE_REAL</a>) + $mapping, null, $special);</div>
<div class="line"><span class="lineno"> 1170</span>                    <span class="keywordflow">case</span> is_bool($source):</div>
<div class="line"><span class="lineno"> 1171</span>                        return $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ab6152ed3dc2806e3cf7821a7fbdc97f3">_encode_der</a>($source, array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code hl_variable" href="ASN1_8php.html#a7466606a3e1d863445b1be09b85f1148">FILE_ASN1_TYPE_BOOLEAN</a>) + $mapping, null, $special);</div>
<div class="line"><span class="lineno"> 1172</span>                    <span class="keywordflow">case</span> is_array($source) &amp;&amp; count($source) == 1:</div>
<div class="line"><span class="lineno"> 1173</span>                        $typename = implode(<span class="stringliteral">&#39;&#39;</span>, array_keys($source));</div>
<div class="line"><span class="lineno"> 1174</span>                        $outtype = array_search($typename, $this-&gt;ANYmap, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1175</span>                        <span class="keywordflow">if</span> ($outtype !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1176</span>                            <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ab6152ed3dc2806e3cf7821a7fbdc97f3">_encode_der</a>($source[$typename], array(<span class="stringliteral">&#39;type&#39;</span> =&gt; $outtype) + $mapping, <span class="keyword">null</span>, $special);</div>
<div class="line"><span class="lineno"> 1177</span>                        }</div>
<div class="line"><span class="lineno"> 1178</span>                }</div>
<div class="line"><span class="lineno"> 1179</span> </div>
<div class="line"><span class="lineno"> 1180</span>                <a class="code hl_variable" href="classFile__ASN1.html#ae222f32233a38635bef58d24a13c9df5">$filters</a> = $this-&gt;filters;</div>
<div class="line"><span class="lineno"> 1181</span>                <span class="keywordflow">foreach</span> ($loc as $part) {</div>
<div class="line"><span class="lineno"> 1182</span>                    <span class="keywordflow">if</span> (!isset($filters[$part])) {</div>
<div class="line"><span class="lineno"> 1183</span>                        <a class="code hl_variable" href="classFile__ASN1.html#ae222f32233a38635bef58d24a13c9df5">$filters</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1184</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1185</span>                    }</div>
<div class="line"><span class="lineno"> 1186</span>                    <a class="code hl_variable" href="classFile__ASN1.html#ae222f32233a38635bef58d24a13c9df5">$filters</a> = <a class="code hl_variable" href="classFile__ASN1.html#ae222f32233a38635bef58d24a13c9df5">$filters</a>[$part];</div>
<div class="line"><span class="lineno"> 1187</span>                }</div>
<div class="line"><span class="lineno"> 1188</span>                <span class="keywordflow">if</span> ($filters === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1189</span>                    user_error(<span class="stringliteral">&#39;No filters defined for &#39;</span> . implode(<span class="charliteral">&#39;/&#39;</span>, $loc));</div>
<div class="line"><span class="lineno"> 1190</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1191</span>                }</div>
<div class="line"><span class="lineno"> 1192</span>                <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ab6152ed3dc2806e3cf7821a7fbdc97f3">_encode_der</a>($source, $filters + $mapping, <span class="keyword">null</span>, $special);</div>
<div class="line"><span class="lineno"> 1193</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a178f5750294c65763f2b1b2d1a4acb0d">FILE_ASN1_TYPE_NULL</a>:</div>
<div class="line"><span class="lineno"> 1194</span>                $value = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1195</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1196</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#af269bb1254bc4f65a21327c39530c0eb">FILE_ASN1_TYPE_NUMERIC_STRING</a>:</div>
<div class="line"><span class="lineno"> 1197</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a5f903ee9a5fc70fcbff1af967c53083b">FILE_ASN1_TYPE_TELETEX_STRING</a>:</div>
<div class="line"><span class="lineno"> 1198</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>:</div>
<div class="line"><span class="lineno"> 1199</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#ae7f15dadff8bafe3f5268f472bd1253d">FILE_ASN1_TYPE_UNIVERSAL_STRING</a>:</div>
<div class="line"><span class="lineno"> 1200</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>:</div>
<div class="line"><span class="lineno"> 1201</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#afae5a2a5df49e80953c2bb088f9ce8fb">FILE_ASN1_TYPE_BMP_STRING</a>:</div>
<div class="line"><span class="lineno"> 1202</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a>:</div>
<div class="line"><span class="lineno"> 1203</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a5301a15003ac88ef62b1b097a8f99e8b">FILE_ASN1_TYPE_VISIBLE_STRING</a>:</div>
<div class="line"><span class="lineno"> 1204</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a840878e52522fbab4c1b402040bd3a11">FILE_ASN1_TYPE_VIDEOTEX_STRING</a>:</div>
<div class="line"><span class="lineno"> 1205</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a079c98ace233ab025f8584ed810c466c">FILE_ASN1_TYPE_GRAPHIC_STRING</a>:</div>
<div class="line"><span class="lineno"> 1206</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a844e30a2e0708f8b9ba4c09ec24894ff">FILE_ASN1_TYPE_GENERAL_STRING</a>:</div>
<div class="line"><span class="lineno"> 1207</span>                $value = $source;</div>
<div class="line"><span class="lineno"> 1208</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1209</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a7466606a3e1d863445b1be09b85f1148">FILE_ASN1_TYPE_BOOLEAN</a>:</div>
<div class="line"><span class="lineno"> 1210</span>                $value = $source ? <span class="stringliteral">&quot;\xFF&quot;</span> : <span class="stringliteral">&quot;\x00&quot;</span>;</div>
<div class="line"><span class="lineno"> 1211</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1212</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1213</span>                user_error(<span class="stringliteral">&#39;Mapping provides no type definition for &#39;</span> . implode(<span class="charliteral">&#39;/&#39;</span>, $this-&gt;location));</div>
<div class="line"><span class="lineno"> 1214</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1215</span>        }</div>
<div class="line"><span class="lineno"> 1216</span> </div>
<div class="line"><span class="lineno"> 1217</span>        <span class="keywordflow">if</span> (isset($idx)) {</div>
<div class="line"><span class="lineno"> 1218</span>            array_pop($this-&gt;location);</div>
<div class="line"><span class="lineno"> 1219</span>        }</div>
<div class="line"><span class="lineno"> 1220</span> </div>
<div class="line"><span class="lineno"> 1221</span>        <span class="keywordflow">if</span> (isset($mapping[<span class="stringliteral">&#39;cast&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1222</span>            <span class="keywordflow">if</span> (isset($mapping[<span class="stringliteral">&#39;explicit&#39;</span>]) || $mapping[<span class="stringliteral">&#39;type&#39;</span>] == <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>) {</div>
<div class="line"><span class="lineno"> 1223</span>                $value = chr($tag) . $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($value)) . $value;</div>
<div class="line"><span class="lineno"> 1224</span>                $tag = ($mapping[<span class="stringliteral">&#39;class&#39;</span>] &lt;&lt; 6) | 0x20 | $mapping[<span class="stringliteral">&#39;cast&#39;</span>];</div>
<div class="line"><span class="lineno"> 1225</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1226</span>                $tag = ($mapping[<span class="stringliteral">&#39;class&#39;</span>] &lt;&lt; 6) | (ord($temp[0]) &amp; 0x20) | $mapping[<span class="stringliteral">&#39;cast&#39;</span>];</div>
<div class="line"><span class="lineno"> 1227</span>            }</div>
<div class="line"><span class="lineno"> 1228</span>        }</div>
<div class="line"><span class="lineno"> 1229</span> </div>
<div class="line"><span class="lineno"> 1230</span>        <span class="keywordflow">return</span> chr($tag) . $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">_encodeLength</a>(strlen($value)) . $value;</div>
<div class="line"><span class="lineno"> 1231</span>    }</div>
<div class="ttc" id="aASN1_8php_html_a477ddacad6f9ad4803fdbbc0d6c80be8"><div class="ttname"><a href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a></div><div class="ttdeci">const FILE_ASN1_TYPE_CHOICE</div><div class="ttdoc">#-</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00104">ASN1.php:104</a></div></div>
<div class="ttc" id="aASN1_8php_html_a96290e3bf3e87b630bc435b0beac8582"><div class="ttname"><a href="ASN1_8php.html#a96290e3bf3e87b630bc435b0beac8582">FILE_ASN1_TYPE_ANY</a></div><div class="ttdeci">const FILE_ASN1_TYPE_ANY</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00105">ASN1.php:105</a></div></div>
<div class="ttc" id="aASN1_8php_html_ae7f15dadff8bafe3f5268f472bd1253d"><div class="ttname"><a href="ASN1_8php.html#ae7f15dadff8bafe3f5268f472bd1253d">FILE_ASN1_TYPE_UNIVERSAL_STRING</a></div><div class="ttdeci">const FILE_ASN1_TYPE_UNIVERSAL_STRING</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00092">ASN1.php:92</a></div></div>
<div class="ttc" id="aclassFile__ASN1_html_ab6152ed3dc2806e3cf7821a7fbdc97f3"><div class="ttname"><a href="classFile__ASN1.html#ab6152ed3dc2806e3cf7821a7fbdc97f3">File_ASN1\_encode_der</a></div><div class="ttdeci">_encode_der($source, $mapping, $idx=null, $special=array())</div><div class="ttdoc">ASN.1 Encode (Helper function)</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00948">ASN1.php:948</a></div></div>
<div class="ttc" id="aclassFile__ASN1_html_ab9967d86f5c5bdf50e4bc80cf1a9c018"><div class="ttname"><a href="classFile__ASN1.html#ab9967d86f5c5bdf50e4bc80cf1a9c018">File_ASN1\_encodeLength</a></div><div class="ttdeci">_encodeLength($length)</div><div class="ttdoc">DER-encode the length.</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l01243">ASN1.php:1243</a></div></div>
<div class="ttc" id="aclassFile__ASN1_html_ae222f32233a38635bef58d24a13c9df5"><div class="ttname"><a href="classFile__ASN1.html#ae222f32233a38635bef58d24a13c9df5">File_ASN1\$filters</a></div><div class="ttdeci">$filters</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00199">ASN1.php:199</a></div></div>
<div class="ttc" id="aclassFile__ASN1_html_ae4b37b96ed86815954b693c12f839775"><div class="ttname"><a href="classFile__ASN1.html#ae4b37b96ed86815954b693c12f839775">File_ASN1\_encodeOID</a></div><div class="ttdeci">_encodeOID($source)</div><div class="ttdoc">DER-encode the OID.</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l01315">ASN1.php:1315</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ASN1_8php_source.html#l00948">_encode_der()</a>, <a class="el" href="ASN1_8php_source.html#l01243">_encodeLength()</a>, <a class="el" href="ASN1_8php_source.html#l01315">_encodeOID()</a>, <a class="el" href="ASN1_8php_source.html#l00050">FILE_ASN1_CLASS_CONTEXT_SPECIFIC</a>, <a class="el" href="ASN1_8php_source.html#l00105">FILE_ASN1_TYPE_ANY</a>, <a class="el" href="ASN1_8php_source.html#l00062">FILE_ASN1_TYPE_BIT_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00094">FILE_ASN1_TYPE_BMP_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00060">FILE_ASN1_TYPE_BOOLEAN</a>, <a class="el" href="ASN1_8php_source.html#l00104">FILE_ASN1_TYPE_CHOICE</a>, <a class="el" href="ASN1_8php_source.html#l00069">FILE_ASN1_TYPE_ENUMERATED</a>, <a class="el" href="ASN1_8php_source.html#l00091">FILE_ASN1_TYPE_GENERAL_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00088">FILE_ASN1_TYPE_GENERALIZED_TIME</a>, <a class="el" href="ASN1_8php_source.html#l00089">FILE_ASN1_TYPE_GRAPHIC_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00086">FILE_ASN1_TYPE_IA5_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00061">FILE_ASN1_TYPE_INTEGER</a>, <a class="el" href="ASN1_8php_source.html#l00064">FILE_ASN1_TYPE_NULL</a>, <a class="el" href="ASN1_8php_source.html#l00082">FILE_ASN1_TYPE_NUMERIC_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00065">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>, <a class="el" href="ASN1_8php_source.html#l00063">FILE_ASN1_TYPE_OCTET_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00083">FILE_ASN1_TYPE_PRINTABLE_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00068">FILE_ASN1_TYPE_REAL</a>, <a class="el" href="ASN1_8php_source.html#l00073">FILE_ASN1_TYPE_SEQUENCE</a>, <a class="el" href="ASN1_8php_source.html#l00074">FILE_ASN1_TYPE_SET</a>, <a class="el" href="ASN1_8php_source.html#l00084">FILE_ASN1_TYPE_TELETEX_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00092">FILE_ASN1_TYPE_UNIVERSAL_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00087">FILE_ASN1_TYPE_UTC_TIME</a>, <a class="el" href="ASN1_8php_source.html#l00071">FILE_ASN1_TYPE_UTF8_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00085">FILE_ASN1_TYPE_VIDEOTEX_STRING</a>, and <a class="el" href="ASN1_8php_source.html#l00090">FILE_ASN1_TYPE_VISIBLE_STRING</a>.</p>

<p class="reference">Referenced by <a class="el" href="ASN1_8php_source.html#l00948">_encode_der()</a>, and <a class="el" href="ASN1_8php_source.html#l00932">encodeDER()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__ASN1_ab6152ed3dc2806e3cf7821a7fbdc97f3_cgraph.png" border="0" usemap="#aclassFile__ASN1_ab6152ed3dc2806e3cf7821a7fbdc97f3_cgraph" alt=""/></div>
<map name="aclassFile__ASN1_ab6152ed3dc2806e3cf7821a7fbdc97f3_cgraph" id="aclassFile__ASN1_ab6152ed3dc2806e3cf7821a7fbdc97f3_cgraph">
<area shape="rect" title="ASN.1 Encode (Helper function)" alt="" coords="5,31,109,56"/>
<area shape="rect" href="classFile__ASN1.html#ab9967d86f5c5bdf50e4bc80cf1a9c018" title="DER&#45;encode the length." alt="" coords="157,5,277,31"/>
<area shape="rect" href="classFile__ASN1.html#ae4b37b96ed86815954b693c12f839775" title="DER&#45;encode the OID." alt="" coords="167,55,267,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__ASN1_ab6152ed3dc2806e3cf7821a7fbdc97f3_icgraph.png" border="0" usemap="#aclassFile__ASN1_ab6152ed3dc2806e3cf7821a7fbdc97f3_icgraph" alt=""/></div>
<map name="aclassFile__ASN1_ab6152ed3dc2806e3cf7821a7fbdc97f3_icgraph" id="aclassFile__ASN1_ab6152ed3dc2806e3cf7821a7fbdc97f3_icgraph">
<area shape="rect" title="ASN.1 Encode (Helper function)" alt="" coords="149,29,253,55"/>
<area shape="rect" href="classFile__ASN1.html#a6668c7a50e7ff14459c10564b7cd90cb" title="ASN.1 Encode." alt="" coords="5,29,101,55"/>
</map>
</div>

</div>
</div>
<a id="ab9967d86f5c5bdf50e4bc80cf1a9c018" name="ab9967d86f5c5bdf50e4bc80cf1a9c018"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9967d86f5c5bdf50e4bc80cf1a9c018">&#9670;&#160;</a></span>_encodeLength()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_encodeLength </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$length</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>DER-encode the length. </p>
<p>DER supports lengths up to (2**8)**127, however, we'll only support lengths up to (2**8)**4. See <code><a class="el" href="">X.690 paragraph 8.1.3</a></code> for more information.</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$length</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l01243">1243</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1244</span>    {</div>
<div class="line"><span class="lineno"> 1245</span>        <span class="keywordflow">if</span> ($length &lt;= 0x7F) {</div>
<div class="line"><span class="lineno"> 1246</span>            <span class="keywordflow">return</span> chr($length);</div>
<div class="line"><span class="lineno"> 1247</span>        }</div>
<div class="line"><span class="lineno"> 1248</span> </div>
<div class="line"><span class="lineno"> 1249</span>        $temp = ltrim(pack(<span class="charliteral">&#39;N&#39;</span>, $length), chr(0));</div>
<div class="line"><span class="lineno"> 1250</span>        <span class="keywordflow">return</span> pack(<span class="stringliteral">&#39;Ca*&#39;</span>, 0x80 | strlen($temp), $temp);</div>
<div class="line"><span class="lineno"> 1251</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ASN1_8php_source.html#l00948">_encode_der()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__ASN1_ab9967d86f5c5bdf50e4bc80cf1a9c018_icgraph.png" border="0" usemap="#aclassFile__ASN1_ab9967d86f5c5bdf50e4bc80cf1a9c018_icgraph" alt=""/></div>
<map name="aclassFile__ASN1_ab9967d86f5c5bdf50e4bc80cf1a9c018_icgraph" id="aclassFile__ASN1_ab9967d86f5c5bdf50e4bc80cf1a9c018_icgraph">
<area shape="rect" title="DER&#45;encode the length." alt="" coords="301,29,421,55"/>
<area shape="rect" href="classFile__ASN1.html#ab6152ed3dc2806e3cf7821a7fbdc97f3" title="ASN.1 Encode (Helper function)" alt="" coords="149,29,253,55"/>
<area shape="rect" href="classFile__ASN1.html#a6668c7a50e7ff14459c10564b7cd90cb" title="ASN.1 Encode." alt="" coords="5,29,101,55"/>
</map>
</div>

</div>
</div>
<a id="ae4b37b96ed86815954b693c12f839775" name="ae4b37b96ed86815954b693c12f839775"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4b37b96ed86815954b693c12f839775">&#9670;&#160;</a></span>_encodeOID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_encodeOID </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$source</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>DER-encode the OID. </p>
<p>Called by _encode_der()</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$source</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l01315">1315</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1316</span>    {</div>
<div class="line"><span class="lineno"> 1317</span>        <span class="keyword">static</span> $mask, $zero, $forty;</div>
<div class="line"><span class="lineno"> 1318</span>        <span class="keywordflow">if</span> (!$mask) {</div>
<div class="line"><span class="lineno"> 1319</span>            $mask = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>(0x7F);</div>
<div class="line"><span class="lineno"> 1320</span>            $zero = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>();</div>
<div class="line"><span class="lineno"> 1321</span>            $forty = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>(40);</div>
<div class="line"><span class="lineno"> 1322</span>        }</div>
<div class="line"><span class="lineno"> 1323</span> </div>
<div class="line"><span class="lineno"> 1324</span>        $oid = preg_match(<span class="stringliteral">&#39;#(?:\d+\.)+#&#39;</span>, $source) ? $source : array_search($source, $this-&gt;oids);</div>
<div class="line"><span class="lineno"> 1325</span>        <span class="keywordflow">if</span> ($oid === <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1326</span>            user_error(<span class="stringliteral">&#39;Invalid OID&#39;</span>);</div>
<div class="line"><span class="lineno"> 1327</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1328</span>        }</div>
<div class="line"><span class="lineno"> 1329</span>        $parts = explode(<span class="charliteral">&#39;.&#39;</span>, $oid);</div>
<div class="line"><span class="lineno"> 1330</span>        $part1 = array_shift($parts);</div>
<div class="line"><span class="lineno"> 1331</span>        $part2 = array_shift($parts);</div>
<div class="line"><span class="lineno"> 1332</span> </div>
<div class="line"><span class="lineno"> 1333</span>        $first = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($part1);</div>
<div class="line"><span class="lineno"> 1334</span>        $first = $first-&gt;multiply($forty);</div>
<div class="line"><span class="lineno"> 1335</span>        $first = $first-&gt;add(<span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($part2));</div>
<div class="line"><span class="lineno"> 1336</span> </div>
<div class="line"><span class="lineno"> 1337</span>        array_unshift($parts, $first-&gt;toString());</div>
<div class="line"><span class="lineno"> 1338</span> </div>
<div class="line"><span class="lineno"> 1339</span>        $value = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1340</span>        <span class="keywordflow">foreach</span> ($parts as $part) {</div>
<div class="line"><span class="lineno"> 1341</span>            <span class="keywordflow">if</span> (!$part) {</div>
<div class="line"><span class="lineno"> 1342</span>                $temp = <span class="stringliteral">&quot;\0&quot;</span>;</div>
<div class="line"><span class="lineno"> 1343</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1344</span>                $temp = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1345</span>                $part = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($part);</div>
<div class="line"><span class="lineno"> 1346</span>                <span class="keywordflow">while</span> (!$part-&gt;equals($zero)) {</div>
<div class="line"><span class="lineno"> 1347</span>                    $submask = $part-&gt;bitwise_and($mask);</div>
<div class="line"><span class="lineno"> 1348</span>                    $submask-&gt;setPrecision(8);</div>
<div class="line"><span class="lineno"> 1349</span>                    $temp = (chr(0x80) | $submask-&gt;toBytes()) . $temp;</div>
<div class="line"><span class="lineno"> 1350</span>                    $part = $part-&gt;bitwise_rightShift(7);</div>
<div class="line"><span class="lineno"> 1351</span>                }</div>
<div class="line"><span class="lineno"> 1352</span>                $temp[strlen($temp) - 1] = $temp[strlen($temp) - 1] &amp; chr(0x7F);</div>
<div class="line"><span class="lineno"> 1353</span>            }</div>
<div class="line"><span class="lineno"> 1354</span>            $value.= $temp;</div>
<div class="line"><span class="lineno"> 1355</span>        }</div>
<div class="line"><span class="lineno"> 1356</span> </div>
<div class="line"><span class="lineno"> 1357</span>        <span class="keywordflow">return</span> $value;</div>
<div class="line"><span class="lineno"> 1358</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ASN1_8php_source.html#l00948">_encode_der()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__ASN1_ae4b37b96ed86815954b693c12f839775_icgraph.png" border="0" usemap="#aclassFile__ASN1_ae4b37b96ed86815954b693c12f839775_icgraph" alt=""/></div>
<map name="aclassFile__ASN1_ae4b37b96ed86815954b693c12f839775_icgraph" id="aclassFile__ASN1_ae4b37b96ed86815954b693c12f839775_icgraph">
<area shape="rect" title="DER&#45;encode the OID." alt="" coords="301,29,401,55"/>
<area shape="rect" href="classFile__ASN1.html#ab6152ed3dc2806e3cf7821a7fbdc97f3" title="ASN.1 Encode (Helper function)" alt="" coords="149,29,253,55"/>
<area shape="rect" href="classFile__ASN1.html#a6668c7a50e7ff14459c10564b7cd90cb" title="ASN.1 Encode." alt="" coords="5,29,101,55"/>
</map>
</div>

</div>
</div>
<a id="ab009fa6f4ba09daa679a30e9b5bcfe35" name="ab009fa6f4ba09daa679a30e9b5bcfe35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab009fa6f4ba09daa679a30e9b5bcfe35">&#9670;&#160;</a></span>_string_shift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_string_shift </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$index</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>String Shift. </p>
<p>Inspired by array_shift</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$string</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$index</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string @access private </dd></dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l01507">1507</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1508</span>    {</div>
<div class="line"><span class="lineno"> 1509</span>        $substr = substr($string, 0, $index);</div>
<div class="line"><span class="lineno"> 1510</span>        $string = substr($string, $index);</div>
<div class="line"><span class="lineno"> 1511</span>        <span class="keywordflow">return</span> $substr;</div>
<div class="line"><span class="lineno"> 1512</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1f30a92054d93d8c5470681b1f0508dc" name="a1f30a92054d93d8c5470681b1f0508dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f30a92054d93d8c5470681b1f0508dc">&#9670;&#160;</a></span>asn1map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">asn1map </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$decoded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mapping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$special</em> = <code>array()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ASN.1 Map. </p>
<p>Provides an ASN.1 semantic mapping ($mapping) from a parsed BER-encoding to a human readable format.</p>
<p>"Special" mappings may be applied on a per tag-name basis via $special.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$decoded</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$mapping</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$special</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array @access public </dd></dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l00616">616</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  617</span>    {</div>
<div class="line"><span class="lineno">  618</span>        <span class="keywordflow">if</span> (!is_array($decoded)) {</div>
<div class="line"><span class="lineno">  619</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  620</span>        }</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>        <span class="keywordflow">if</span> (isset($mapping[<span class="stringliteral">&#39;explicit&#39;</span>]) &amp;&amp; is_array($decoded[<span class="stringliteral">&#39;content&#39;</span>])) {</div>
<div class="line"><span class="lineno">  623</span>            $decoded = $decoded[<span class="stringliteral">&#39;content&#39;</span>][0];</div>
<div class="line"><span class="lineno">  624</span>        }</div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  627</span>            <span class="keywordflow">case</span> $mapping[<span class="stringliteral">&#39;type&#39;</span>] == <a class="code hl_variable" href="ASN1_8php.html#a96290e3bf3e87b630bc435b0beac8582">FILE_ASN1_TYPE_ANY</a>:</div>
<div class="line"><span class="lineno">  628</span>                $intype = $decoded[<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><span class="lineno">  629</span>                <span class="keywordflow">if</span> (isset($decoded[<span class="stringliteral">&#39;constant&#39;</span>]) || !isset($this-&gt;ANYmap[$intype]) || (ord($this-&gt;encoded[$decoded[<span class="stringliteral">&#39;start&#39;</span>]]) &amp; 0x20)) {</div>
<div class="line"><span class="lineno">  630</span>                    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_class" href="classFile__ASN1__Element.html">File_ASN1_Element</a>(substr($this-&gt;encoded, $decoded[<span class="stringliteral">&#39;start&#39;</span>], $decoded[<span class="stringliteral">&#39;length&#39;</span>]));</div>
<div class="line"><span class="lineno">  631</span>                }</div>
<div class="line"><span class="lineno">  632</span>                $inmap = $this-&gt;ANYmap[$intype];</div>
<div class="line"><span class="lineno">  633</span>                <span class="keywordflow">if</span> (is_string($inmap)) {</div>
<div class="line"><span class="lineno">  634</span>                    <span class="keywordflow">return</span> array($inmap =&gt; $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#a1f30a92054d93d8c5470681b1f0508dc">asn1map</a>($decoded, array(<span class="stringliteral">&#39;type&#39;</span> =&gt; $intype) + $mapping, $special));</div>
<div class="line"><span class="lineno">  635</span>                }</div>
<div class="line"><span class="lineno">  636</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  637</span>            <span class="keywordflow">case</span> $mapping[<span class="stringliteral">&#39;type&#39;</span>] == <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>:</div>
<div class="line"><span class="lineno">  638</span>                <span class="keywordflow">foreach</span> ($mapping[<span class="stringliteral">&#39;children&#39;</span>] as $key =&gt; $option) {</div>
<div class="line"><span class="lineno">  639</span>                    <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  640</span>                        <span class="keywordflow">case</span> isset($option[<span class="stringliteral">&#39;constant&#39;</span>]) &amp;&amp; $option[<span class="stringliteral">&#39;constant&#39;</span>] == $decoded[<span class="stringliteral">&#39;constant&#39;</span>]:</div>
<div class="line"><span class="lineno">  641</span>                        <span class="keywordflow">case</span> !isset($option[<span class="stringliteral">&#39;constant&#39;</span>]) &amp;&amp; $option[<span class="stringliteral">&#39;type&#39;</span>] == $decoded[<span class="stringliteral">&#39;type&#39;</span>]:</div>
<div class="line"><span class="lineno">  642</span>                            $value = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#a1f30a92054d93d8c5470681b1f0508dc">asn1map</a>($decoded, $option, $special);</div>
<div class="line"><span class="lineno">  643</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  644</span>                        <span class="keywordflow">case</span> !isset($option[<span class="stringliteral">&#39;constant&#39;</span>]) &amp;&amp; $option[<span class="stringliteral">&#39;type&#39;</span>] == <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>:</div>
<div class="line"><span class="lineno">  645</span>                            $v = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#a1f30a92054d93d8c5470681b1f0508dc">asn1map</a>($decoded, $option, $special);</div>
<div class="line"><span class="lineno">  646</span>                            <span class="keywordflow">if</span> (isset($v)) {</div>
<div class="line"><span class="lineno">  647</span>                                $value = $v;</div>
<div class="line"><span class="lineno">  648</span>                            }</div>
<div class="line"><span class="lineno">  649</span>                    }</div>
<div class="line"><span class="lineno">  650</span>                    <span class="keywordflow">if</span> (isset($value)) {</div>
<div class="line"><span class="lineno">  651</span>                        <span class="keywordflow">if</span> (isset($special[$key])) {</div>
<div class="line"><span class="lineno">  652</span>                            $value = call_user_func($special[$key], $value);</div>
<div class="line"><span class="lineno">  653</span>                        }</div>
<div class="line"><span class="lineno">  654</span>                        <span class="keywordflow">return</span> array($key =&gt; $value);</div>
<div class="line"><span class="lineno">  655</span>                    }</div>
<div class="line"><span class="lineno">  656</span>                }</div>
<div class="line"><span class="lineno">  657</span>                <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  658</span>            <span class="keywordflow">case</span> isset($mapping[<span class="stringliteral">&#39;implicit&#39;</span>]):</div>
<div class="line"><span class="lineno">  659</span>            case isset($mapping[<span class="stringliteral">&#39;explicit&#39;</span>]):</div>
<div class="line"><span class="lineno">  660</span>            case $decoded[<span class="stringliteral">&#39;type&#39;</span>] == $mapping[<span class="stringliteral">&#39;type&#39;</span>]:</div>
<div class="line"><span class="lineno">  661</span>                break;</div>
<div class="line"><span class="lineno">  662</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  663</span>                <span class="comment">// if $decoded[&#39;type&#39;] and $mapping[&#39;type&#39;] are both strings, but different types of strings,</span></div>
<div class="line"><span class="lineno">  664</span>                <span class="comment">// let it through</span></div>
<div class="line"><span class="lineno">  665</span>                <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  666</span>                    <span class="keywordflow">case</span> $decoded[<span class="stringliteral">&#39;type&#39;</span>] &lt; 18: <span class="comment">// FILE_ASN1_TYPE_NUMERIC_STRING == 18</span></div>
<div class="line"><span class="lineno">  667</span>                    <span class="keywordflow">case</span> $decoded[<span class="stringliteral">&#39;type&#39;</span>] &gt; 30: <span class="comment">// FILE_ASN1_TYPE_BMP_STRING == 30</span></div>
<div class="line"><span class="lineno">  668</span>                    <span class="keywordflow">case</span> $mapping[<span class="stringliteral">&#39;type&#39;</span>] &lt; 18:</div>
<div class="line"><span class="lineno">  669</span>                    <span class="keywordflow">case</span> $mapping[<span class="stringliteral">&#39;type&#39;</span>] &gt; 30:</div>
<div class="line"><span class="lineno">  670</span>                        <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  671</span>                }</div>
<div class="line"><span class="lineno">  672</span>        }</div>
<div class="line"><span class="lineno">  673</span> </div>
<div class="line"><span class="lineno">  674</span>        <span class="keywordflow">if</span> (isset($mapping[<span class="stringliteral">&#39;implicit&#39;</span>])) {</div>
<div class="line"><span class="lineno">  675</span>            $decoded[<span class="stringliteral">&#39;type&#39;</span>] = $mapping[<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><span class="lineno">  676</span>        }</div>
<div class="line"><span class="lineno">  677</span> </div>
<div class="line"><span class="lineno">  678</span>        <span class="keywordflow">switch</span> ($decoded[<span class="stringliteral">&#39;type&#39;</span>]) {</div>
<div class="line"><span class="lineno">  679</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#ab1428335844d52e212845bb286190cae">FILE_ASN1_TYPE_SEQUENCE</a>:</div>
<div class="line"><span class="lineno">  680</span>                $map = array();</div>
<div class="line"><span class="lineno">  681</span> </div>
<div class="line"><span class="lineno">  682</span>                <span class="comment">// ignore the min and max</span></div>
<div class="line"><span class="lineno">  683</span>                <span class="keywordflow">if</span> (isset($mapping[<span class="stringliteral">&#39;min&#39;</span>]) &amp;&amp; isset($mapping[<span class="stringliteral">&#39;max&#39;</span>])) {</div>
<div class="line"><span class="lineno">  684</span>                    $child = $mapping[<span class="stringliteral">&#39;children&#39;</span>];</div>
<div class="line"><span class="lineno">  685</span>                    <span class="keywordflow">foreach</span> ($decoded[<span class="stringliteral">&#39;content&#39;</span>] as $content) {</div>
<div class="line"><span class="lineno">  686</span>                        <span class="keywordflow">if</span> (($map[] = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#a1f30a92054d93d8c5470681b1f0508dc">asn1map</a>($content, $child, $special)) === <span class="keyword">null</span>) {</div>
<div class="line"><span class="lineno">  687</span>                            <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  688</span>                        }</div>
<div class="line"><span class="lineno">  689</span>                    }</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span>                    <span class="keywordflow">return</span> $map;</div>
<div class="line"><span class="lineno">  692</span>                }</div>
<div class="line"><span class="lineno">  693</span> </div>
<div class="line"><span class="lineno">  694</span>                $n = count($decoded[<span class="stringliteral">&#39;content&#39;</span>]);</div>
<div class="line"><span class="lineno">  695</span>                $i = 0;</div>
<div class="line"><span class="lineno">  696</span> </div>
<div class="line"><span class="lineno">  697</span>                <span class="keywordflow">foreach</span> ($mapping[<span class="stringliteral">&#39;children&#39;</span>] as $key =&gt; $child) {</div>
<div class="line"><span class="lineno">  698</span>                    $maymatch = $i &lt; $n; <span class="comment">// Match only existing input.</span></div>
<div class="line"><span class="lineno">  699</span>                    <span class="keywordflow">if</span> ($maymatch) {</div>
<div class="line"><span class="lineno">  700</span>                        $temp = $decoded[<span class="stringliteral">&#39;content&#39;</span>][$i];</div>
<div class="line"><span class="lineno">  701</span> </div>
<div class="line"><span class="lineno">  702</span>                        <span class="keywordflow">if</span> ($child[<span class="stringliteral">&#39;type&#39;</span>] != <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>) {</div>
<div class="line"><span class="lineno">  703</span>                            <span class="comment">// Get the mapping and input class &amp; constant.</span></div>
<div class="line"><span class="lineno">  704</span>                            $childClass = $tempClass = <a class="code hl_variable" href="ASN1_8php.html#ae29beb0be5cd6a79122fc312c32dcc50">FILE_ASN1_CLASS_UNIVERSAL</a>;</div>
<div class="line"><span class="lineno">  705</span>                            $constant = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  706</span>                            <span class="keywordflow">if</span> (isset($temp[<span class="stringliteral">&#39;constant&#39;</span>])) {</div>
<div class="line"><span class="lineno">  707</span>                                $tempClass = $temp[<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><span class="lineno">  708</span>                            }</div>
<div class="line"><span class="lineno">  709</span>                            <span class="keywordflow">if</span> (isset($child[<span class="stringliteral">&#39;class&#39;</span>])) {</div>
<div class="line"><span class="lineno">  710</span>                                $childClass = $child[<span class="stringliteral">&#39;class&#39;</span>];</div>
<div class="line"><span class="lineno">  711</span>                                $constant = $child[<span class="stringliteral">&#39;cast&#39;</span>];</div>
<div class="line"><span class="lineno">  712</span>                            } elseif (isset($child[<span class="stringliteral">&#39;constant&#39;</span>])) {</div>
<div class="line"><span class="lineno">  713</span>                                $childClass = <a class="code hl_variable" href="ASN1_8php.html#ac0ccdf6580b85de79b4a0dc084f285f0">FILE_ASN1_CLASS_CONTEXT_SPECIFIC</a>;</div>
<div class="line"><span class="lineno">  714</span>                                $constant = $child[<span class="stringliteral">&#39;constant&#39;</span>];</div>
<div class="line"><span class="lineno">  715</span>                            }</div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>                            <span class="keywordflow">if</span> (isset($constant) &amp;&amp; isset($temp[<span class="stringliteral">&#39;constant&#39;</span>])) {</div>
<div class="line"><span class="lineno">  718</span>                                <span class="comment">// Can only match if constants and class match.</span></div>
<div class="line"><span class="lineno">  719</span>                                $maymatch = $constant == $temp[<span class="stringliteral">&#39;constant&#39;</span>] &amp;&amp; $childClass == $tempClass;</div>
<div class="line"><span class="lineno">  720</span>                            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  721</span>                                <span class="comment">// Can only match if no constant expected and type matches or is generic.</span></div>
<div class="line"><span class="lineno">  722</span>                                $maymatch = !isset($child[<span class="stringliteral">&#39;constant&#39;</span>]) &amp;&amp; array_search($child[<span class="stringliteral">&#39;type&#39;</span>], array($temp[<span class="stringliteral">&#39;type&#39;</span>], <a class="code hl_variable" href="ASN1_8php.html#a96290e3bf3e87b630bc435b0beac8582">FILE_ASN1_TYPE_ANY</a>, <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>)) !== <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  723</span>                            }</div>
<div class="line"><span class="lineno">  724</span>                        }</div>
<div class="line"><span class="lineno">  725</span>                    }</div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>                    <span class="keywordflow">if</span> ($maymatch) {</div>
<div class="line"><span class="lineno">  728</span>                        <span class="comment">// Attempt submapping.</span></div>
<div class="line"><span class="lineno">  729</span>                        $candidate = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#a1f30a92054d93d8c5470681b1f0508dc">asn1map</a>($temp, $child, $special);</div>
<div class="line"><span class="lineno">  730</span>                        $maymatch = $candidate !== <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  731</span>                    }</div>
<div class="line"><span class="lineno">  732</span> </div>
<div class="line"><span class="lineno">  733</span>                    <span class="keywordflow">if</span> ($maymatch) {</div>
<div class="line"><span class="lineno">  734</span>                        <span class="comment">// Got the match: use it.</span></div>
<div class="line"><span class="lineno">  735</span>                        <span class="keywordflow">if</span> (isset($special[$key])) {</div>
<div class="line"><span class="lineno">  736</span>                            $candidate = call_user_func($special[$key], $candidate);</div>
<div class="line"><span class="lineno">  737</span>                        }</div>
<div class="line"><span class="lineno">  738</span>                        $map[$key] = $candidate;</div>
<div class="line"><span class="lineno">  739</span>                        $i++;</div>
<div class="line"><span class="lineno">  740</span>                    } elseif (isset($child[<span class="stringliteral">&#39;default&#39;</span>])) {</div>
<div class="line"><span class="lineno">  741</span>                        $map[$key] = $child[<span class="stringliteral">&#39;default&#39;</span>]; <span class="comment">// Use default.</span></div>
<div class="line"><span class="lineno">  742</span>                    } elseif (!isset($child[<span class="stringliteral">&#39;optional&#39;</span>])) {</div>
<div class="line"><span class="lineno">  743</span>                        <span class="keywordflow">return</span> <span class="keyword">null</span>; <span class="comment">// Syntax error.</span></div>
<div class="line"><span class="lineno">  744</span>                    }</div>
<div class="line"><span class="lineno">  745</span>                }</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>                <span class="comment">// Fail mapping if all input items have not been consumed.</span></div>
<div class="line"><span class="lineno">  748</span>                <span class="keywordflow">return</span> $i &lt; $n ? <span class="keyword">null</span>: $map;</div>
<div class="line"><span class="lineno">  749</span> </div>
<div class="line"><span class="lineno">  750</span>            <span class="comment">// the main diff between sets and sequences is the encapsulation of the foreach in another for loop</span></div>
<div class="line"><span class="lineno">  751</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#ade866784098f01a9cb1e6901dec0bfca">FILE_ASN1_TYPE_SET</a>:</div>
<div class="line"><span class="lineno">  752</span>                $map = array();</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>                <span class="comment">// ignore the min and max</span></div>
<div class="line"><span class="lineno">  755</span>                <span class="keywordflow">if</span> (isset($mapping[<span class="stringliteral">&#39;min&#39;</span>]) &amp;&amp; isset($mapping[<span class="stringliteral">&#39;max&#39;</span>])) {</div>
<div class="line"><span class="lineno">  756</span>                    $child = $mapping[<span class="stringliteral">&#39;children&#39;</span>];</div>
<div class="line"><span class="lineno">  757</span>                    <span class="keywordflow">foreach</span> ($decoded[<span class="stringliteral">&#39;content&#39;</span>] as $content) {</div>
<div class="line"><span class="lineno">  758</span>                        <span class="keywordflow">if</span> (($map[] = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#a1f30a92054d93d8c5470681b1f0508dc">asn1map</a>($content, $child, $special)) === <span class="keyword">null</span>) {</div>
<div class="line"><span class="lineno">  759</span>                            <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  760</span>                        }</div>
<div class="line"><span class="lineno">  761</span>                    }</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>                    <span class="keywordflow">return</span> $map;</div>
<div class="line"><span class="lineno">  764</span>                }</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>                <span class="keywordflow">for</span> ($i = 0; $i &lt; count($decoded[<span class="stringliteral">&#39;content&#39;</span>]); $i++) {</div>
<div class="line"><span class="lineno">  767</span>                    $temp = $decoded[<span class="stringliteral">&#39;content&#39;</span>][$i];</div>
<div class="line"><span class="lineno">  768</span>                    $tempClass = <a class="code hl_variable" href="ASN1_8php.html#ae29beb0be5cd6a79122fc312c32dcc50">FILE_ASN1_CLASS_UNIVERSAL</a>;</div>
<div class="line"><span class="lineno">  769</span>                    <span class="keywordflow">if</span> (isset($temp[<span class="stringliteral">&#39;constant&#39;</span>])) {</div>
<div class="line"><span class="lineno">  770</span>                        $tempClass = $temp[<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><span class="lineno">  771</span>                    }</div>
<div class="line"><span class="lineno">  772</span> </div>
<div class="line"><span class="lineno">  773</span>                    <span class="keywordflow">foreach</span> ($mapping[<span class="stringliteral">&#39;children&#39;</span>] as $key =&gt; $child) {</div>
<div class="line"><span class="lineno">  774</span>                        <span class="keywordflow">if</span> (isset($map[$key])) {</div>
<div class="line"><span class="lineno">  775</span>                            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  776</span>                        }</div>
<div class="line"><span class="lineno">  777</span>                        $maymatch = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  778</span>                        <span class="keywordflow">if</span> ($child[<span class="stringliteral">&#39;type&#39;</span>] != <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>) {</div>
<div class="line"><span class="lineno">  779</span>                            $childClass = <a class="code hl_variable" href="ASN1_8php.html#ae29beb0be5cd6a79122fc312c32dcc50">FILE_ASN1_CLASS_UNIVERSAL</a>;</div>
<div class="line"><span class="lineno">  780</span>                            $constant = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  781</span>                            <span class="keywordflow">if</span> (isset($child[<span class="stringliteral">&#39;class&#39;</span>])) {</div>
<div class="line"><span class="lineno">  782</span>                                $childClass = $child[<span class="stringliteral">&#39;class&#39;</span>];</div>
<div class="line"><span class="lineno">  783</span>                                $constant = $child[<span class="stringliteral">&#39;cast&#39;</span>];</div>
<div class="line"><span class="lineno">  784</span>                            } elseif (isset($child[<span class="stringliteral">&#39;constant&#39;</span>])) {</div>
<div class="line"><span class="lineno">  785</span>                                $childClass = <a class="code hl_variable" href="ASN1_8php.html#ac0ccdf6580b85de79b4a0dc084f285f0">FILE_ASN1_CLASS_CONTEXT_SPECIFIC</a>;</div>
<div class="line"><span class="lineno">  786</span>                                $constant = $child[<span class="stringliteral">&#39;constant&#39;</span>];</div>
<div class="line"><span class="lineno">  787</span>                            }</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span>                            <span class="keywordflow">if</span> (isset($constant) &amp;&amp; isset($temp[<span class="stringliteral">&#39;constant&#39;</span>])) {</div>
<div class="line"><span class="lineno">  790</span>                                <span class="comment">// Can only match if constants and class match.</span></div>
<div class="line"><span class="lineno">  791</span>                                $maymatch = $constant == $temp[<span class="stringliteral">&#39;constant&#39;</span>] &amp;&amp; $childClass == $tempClass;</div>
<div class="line"><span class="lineno">  792</span>                            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  793</span>                                <span class="comment">// Can only match if no constant expected and type matches or is generic.</span></div>
<div class="line"><span class="lineno">  794</span>                                $maymatch = !isset($child[<span class="stringliteral">&#39;constant&#39;</span>]) &amp;&amp; array_search($child[<span class="stringliteral">&#39;type&#39;</span>], array($temp[<span class="stringliteral">&#39;type&#39;</span>], <a class="code hl_variable" href="ASN1_8php.html#a96290e3bf3e87b630bc435b0beac8582">FILE_ASN1_TYPE_ANY</a>, <a class="code hl_variable" href="ASN1_8php.html#a477ddacad6f9ad4803fdbbc0d6c80be8">FILE_ASN1_TYPE_CHOICE</a>)) !== <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  795</span>                            }</div>
<div class="line"><span class="lineno">  796</span>                        }</div>
<div class="line"><span class="lineno">  797</span> </div>
<div class="line"><span class="lineno">  798</span>                        <span class="keywordflow">if</span> ($maymatch) {</div>
<div class="line"><span class="lineno">  799</span>                            <span class="comment">// Attempt submapping.</span></div>
<div class="line"><span class="lineno">  800</span>                            $candidate = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#a1f30a92054d93d8c5470681b1f0508dc">asn1map</a>($temp, $child, $special);</div>
<div class="line"><span class="lineno">  801</span>                            $maymatch = $candidate !== <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  802</span>                        }</div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span>                        <span class="keywordflow">if</span> (!$maymatch) {</div>
<div class="line"><span class="lineno">  805</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  806</span>                        }</div>
<div class="line"><span class="lineno">  807</span> </div>
<div class="line"><span class="lineno">  808</span>                        <span class="comment">// Got the match: use it.</span></div>
<div class="line"><span class="lineno">  809</span>                        <span class="keywordflow">if</span> (isset($special[$key])) {</div>
<div class="line"><span class="lineno">  810</span>                            $candidate = call_user_func($special[$key], $candidate);</div>
<div class="line"><span class="lineno">  811</span>                        }</div>
<div class="line"><span class="lineno">  812</span>                        $map[$key] = $candidate;</div>
<div class="line"><span class="lineno">  813</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  814</span>                    }</div>
<div class="line"><span class="lineno">  815</span>                }</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>                <span class="keywordflow">foreach</span> ($mapping[<span class="stringliteral">&#39;children&#39;</span>] as $key =&gt; $child) {</div>
<div class="line"><span class="lineno">  818</span>                    <span class="keywordflow">if</span> (!isset($map[$key])) {</div>
<div class="line"><span class="lineno">  819</span>                        <span class="keywordflow">if</span> (isset($child[<span class="stringliteral">&#39;default&#39;</span>])) {</div>
<div class="line"><span class="lineno">  820</span>                            $map[$key] = $child[<span class="stringliteral">&#39;default&#39;</span>];</div>
<div class="line"><span class="lineno">  821</span>                        } elseif (!isset($child[<span class="stringliteral">&#39;optional&#39;</span>])) {</div>
<div class="line"><span class="lineno">  822</span>                            <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  823</span>                        }</div>
<div class="line"><span class="lineno">  824</span>                    }</div>
<div class="line"><span class="lineno">  825</span>                }</div>
<div class="line"><span class="lineno">  826</span>                <span class="keywordflow">return</span> $map;</div>
<div class="line"><span class="lineno">  827</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>:</div>
<div class="line"><span class="lineno">  828</span>                <span class="keywordflow">return</span> isset($this-&gt;oids[$decoded[<span class="stringliteral">&#39;content&#39;</span>]]) ? $this-&gt;oids[$decoded[<span class="stringliteral">&#39;content&#39;</span>]] : $decoded[<span class="stringliteral">&#39;content&#39;</span>];</div>
<div class="line"><span class="lineno">  829</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a842b61be906cf8882ae9b54a974231ba">FILE_ASN1_TYPE_UTC_TIME</a>:</div>
<div class="line"><span class="lineno">  830</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a8ad0c6d6389ce6c6fb2e633814cbfd42">FILE_ASN1_TYPE_GENERALIZED_TIME</a>:</div>
<div class="line"><span class="lineno">  831</span>                <span class="keywordflow">if</span> (class_exists(<span class="stringliteral">&#39;DateTime&#39;</span>)) {</div>
<div class="line"><span class="lineno">  832</span>                    <span class="comment">// for explicitly tagged optional stuff</span></div>
<div class="line"><span class="lineno">  833</span>                    <span class="keywordflow">if</span> (is_array($decoded[<span class="stringliteral">&#39;content&#39;</span>])) {</div>
<div class="line"><span class="lineno">  834</span>                        $decoded[<span class="stringliteral">&#39;content&#39;</span>] = $decoded[<span class="stringliteral">&#39;content&#39;</span>][0][<span class="stringliteral">&#39;content&#39;</span>];</div>
<div class="line"><span class="lineno">  835</span>                    }</div>
<div class="line"><span class="lineno">  836</span>                    <span class="comment">// for implicitly tagged optional stuff</span></div>
<div class="line"><span class="lineno">  837</span>                    <span class="comment">// in theory, doing isset($mapping[&#39;implicit&#39;]) would work but malformed certs do exist</span></div>
<div class="line"><span class="lineno">  838</span>                    <span class="comment">// in the wild that OpenSSL decodes without issue so we&#39;ll support them as well</span></div>
<div class="line"><span class="lineno">  839</span>                    <span class="keywordflow">if</span> (!is_object($decoded[<span class="stringliteral">&#39;content&#39;</span>])) {</div>
<div class="line"><span class="lineno">  840</span>                        $decoded[<span class="stringliteral">&#39;content&#39;</span>] = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#ae93cbfbb826db862f63b3a54ff46df4e">_decodeDateTime</a>($decoded[<span class="stringliteral">&#39;content&#39;</span>], $decoded[<span class="stringliteral">&#39;type&#39;</span>]);</div>
<div class="line"><span class="lineno">  841</span>                    }</div>
<div class="line"><span class="lineno">  842</span>                    <span class="keywordflow">if</span> (!$decoded[<span class="stringliteral">&#39;content&#39;</span>]) {</div>
<div class="line"><span class="lineno">  843</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  844</span>                    }</div>
<div class="line"><span class="lineno">  845</span>                    <span class="keywordflow">return</span> $decoded[<span class="stringliteral">&#39;content&#39;</span>]-&gt;format($this-&gt;format);</div>
<div class="line"><span class="lineno">  846</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  847</span>                    <span class="keywordflow">if</span> (is_array($decoded[<span class="stringliteral">&#39;content&#39;</span>])) {</div>
<div class="line"><span class="lineno">  848</span>                        $decoded[<span class="stringliteral">&#39;content&#39;</span>] = $decoded[<span class="stringliteral">&#39;content&#39;</span>][0][<span class="stringliteral">&#39;content&#39;</span>];</div>
<div class="line"><span class="lineno">  849</span>                    }</div>
<div class="line"><span class="lineno">  850</span>                    <span class="keywordflow">if</span> (!is_int($decoded[<span class="stringliteral">&#39;content&#39;</span>])) {</div>
<div class="line"><span class="lineno">  851</span>                        $decoded[<span class="stringliteral">&#39;content&#39;</span>] = $this-&gt;<a class="code hl_function" href="classFile__ASN1.html#a8f552e81456e1e55cd55bb4158adb82a">_decodeUnixTime</a>($decoded[<span class="stringliteral">&#39;content&#39;</span>], $decoded[<span class="stringliteral">&#39;type&#39;</span>]);</div>
<div class="line"><span class="lineno">  852</span>                    }</div>
<div class="line"><span class="lineno">  853</span>                    <span class="keywordflow">return</span> @date($this-&gt;format, $decoded[<span class="stringliteral">&#39;content&#39;</span>]);</div>
<div class="line"><span class="lineno">  854</span>                }</div>
<div class="line"><span class="lineno">  855</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>:</div>
<div class="line"><span class="lineno">  856</span>                <span class="keywordflow">if</span> (isset($mapping[<span class="stringliteral">&#39;mapping&#39;</span>])) {</div>
<div class="line"><span class="lineno">  857</span>                    $offset = ord($decoded[<span class="stringliteral">&#39;content&#39;</span>][0]);</div>
<div class="line"><span class="lineno">  858</span>                    $size = (strlen($decoded[<span class="stringliteral">&#39;content&#39;</span>]) - 1) * 8 - $offset;</div>
<div class="line"><span class="lineno">  859</span>                    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  860</span><span class="comment">                       From X.680-0207.pdf#page=46 (21.7):</span></div>
<div class="line"><span class="lineno">  861</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  862</span><span class="comment">                       &quot;When a &quot;NamedBitList&quot; is used in defining a bitstring type ASN.1 encoding rules are free to add (or remove)</span></div>
<div class="line"><span class="lineno">  863</span><span class="comment">                        arbitrarily any trailing 0 bits to (or from) values that are being encoded or decoded. Application designers should</span></div>
<div class="line"><span class="lineno">  864</span><span class="comment">                        therefore ensure that different semantics are not associated with such values which differ only in the number of trailing</span></div>
<div class="line"><span class="lineno">  865</span><span class="comment">                        0 bits.&quot;</span></div>
<div class="line"><span class="lineno">  866</span><span class="comment">                    */</span></div>
<div class="line"><span class="lineno">  867</span>                    $bits = count($mapping[<span class="stringliteral">&#39;mapping&#39;</span>]) == $size ? array() : array_fill(0, count($mapping[<span class="stringliteral">&#39;mapping&#39;</span>]) - $size, false);</div>
<div class="line"><span class="lineno">  868</span>                    <span class="keywordflow">for</span> ($i = strlen($decoded[<span class="stringliteral">&#39;content&#39;</span>]) - 1; $i &gt; 0; $i--) {</div>
<div class="line"><span class="lineno">  869</span>                        $current = ord($decoded[<span class="stringliteral">&#39;content&#39;</span>][$i]);</div>
<div class="line"><span class="lineno">  870</span>                        <span class="keywordflow">for</span> ($j = $offset; $j &lt; 8; $j++) {</div>
<div class="line"><span class="lineno">  871</span>                            $bits[] = (bool) ($current &amp; (1 &lt;&lt; $j));</div>
<div class="line"><span class="lineno">  872</span>                        }</div>
<div class="line"><span class="lineno">  873</span>                        $offset = 0;</div>
<div class="line"><span class="lineno">  874</span>                    }</div>
<div class="line"><span class="lineno">  875</span>                    $values = array();</div>
<div class="line"><span class="lineno">  876</span>                    $map = array_reverse($mapping[<span class="stringliteral">&#39;mapping&#39;</span>]);</div>
<div class="line"><span class="lineno">  877</span>                    <span class="keywordflow">foreach</span> ($map as $i =&gt; $value) {</div>
<div class="line"><span class="lineno">  878</span>                        <span class="keywordflow">if</span> ($bits[$i]) {</div>
<div class="line"><span class="lineno">  879</span>                            $values[] = $value;</div>
<div class="line"><span class="lineno">  880</span>                        }</div>
<div class="line"><span class="lineno">  881</span>                    }</div>
<div class="line"><span class="lineno">  882</span>                    <span class="keywordflow">return</span> $values;</div>
<div class="line"><span class="lineno">  883</span>                }</div>
<div class="line"><span class="lineno">  884</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a5cbfd497aefacbfc5766e0b266022fc2">FILE_ASN1_TYPE_OCTET_STRING</a>:</div>
<div class="line"><span class="lineno">  885</span>                <span class="keywordflow">return</span> base64_encode($decoded[<span class="stringliteral">&#39;content&#39;</span>]);</div>
<div class="line"><span class="lineno">  886</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a178f5750294c65763f2b1b2d1a4acb0d">FILE_ASN1_TYPE_NULL</a>:</div>
<div class="line"><span class="lineno">  887</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  888</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a7466606a3e1d863445b1be09b85f1148">FILE_ASN1_TYPE_BOOLEAN</a>:</div>
<div class="line"><span class="lineno">  889</span>                <span class="keywordflow">return</span> $decoded[<span class="stringliteral">&#39;content&#39;</span>];</div>
<div class="line"><span class="lineno">  890</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#af269bb1254bc4f65a21327c39530c0eb">FILE_ASN1_TYPE_NUMERIC_STRING</a>:</div>
<div class="line"><span class="lineno">  891</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>:</div>
<div class="line"><span class="lineno">  892</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a5f903ee9a5fc70fcbff1af967c53083b">FILE_ASN1_TYPE_TELETEX_STRING</a>:</div>
<div class="line"><span class="lineno">  893</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a840878e52522fbab4c1b402040bd3a11">FILE_ASN1_TYPE_VIDEOTEX_STRING</a>:</div>
<div class="line"><span class="lineno">  894</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a>:</div>
<div class="line"><span class="lineno">  895</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a079c98ace233ab025f8584ed810c466c">FILE_ASN1_TYPE_GRAPHIC_STRING</a>:</div>
<div class="line"><span class="lineno">  896</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a5301a15003ac88ef62b1b097a8f99e8b">FILE_ASN1_TYPE_VISIBLE_STRING</a>:</div>
<div class="line"><span class="lineno">  897</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a844e30a2e0708f8b9ba4c09ec24894ff">FILE_ASN1_TYPE_GENERAL_STRING</a>:</div>
<div class="line"><span class="lineno">  898</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#ae7f15dadff8bafe3f5268f472bd1253d">FILE_ASN1_TYPE_UNIVERSAL_STRING</a>:</div>
<div class="line"><span class="lineno">  899</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>:</div>
<div class="line"><span class="lineno">  900</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#afae5a2a5df49e80953c2bb088f9ce8fb">FILE_ASN1_TYPE_BMP_STRING</a>:</div>
<div class="line"><span class="lineno">  901</span>                <span class="keywordflow">return</span> $decoded[<span class="stringliteral">&#39;content&#39;</span>];</div>
<div class="line"><span class="lineno">  902</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a9c3b70985b245c865ddf8874cc422ba6">FILE_ASN1_TYPE_INTEGER</a>:</div>
<div class="line"><span class="lineno">  903</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="ASN1_8php.html#a96edb7b260fa5df901e8f458cb77064e">FILE_ASN1_TYPE_ENUMERATED</a>:</div>
<div class="line"><span class="lineno">  904</span>                $temp = $decoded[<span class="stringliteral">&#39;content&#39;</span>];</div>
<div class="line"><span class="lineno">  905</span>                <span class="keywordflow">if</span> (isset($mapping[<span class="stringliteral">&#39;implicit&#39;</span>])) {</div>
<div class="line"><span class="lineno">  906</span>                    $temp = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceMath__BigInteger.html">Math_BigInteger</a>($decoded[<span class="stringliteral">&#39;content&#39;</span>], -256);</div>
<div class="line"><span class="lineno">  907</span>                }</div>
<div class="line"><span class="lineno">  908</span>                <span class="keywordflow">if</span> (isset($mapping[<span class="stringliteral">&#39;mapping&#39;</span>])) {</div>
<div class="line"><span class="lineno">  909</span>                    $temp = (int) $temp-&gt;toString();</div>
<div class="line"><span class="lineno">  910</span>                    <span class="keywordflow">return</span> isset($mapping[<span class="stringliteral">&#39;mapping&#39;</span>][$temp]) ?</div>
<div class="line"><span class="lineno">  911</span>                        $mapping[<span class="stringliteral">&#39;mapping&#39;</span>][$temp] :</div>
<div class="line"><span class="lineno">  912</span>                        <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  913</span>                }</div>
<div class="line"><span class="lineno">  914</span>                <span class="keywordflow">return</span> $temp;</div>
<div class="line"><span class="lineno">  915</span>        }</div>
<div class="line"><span class="lineno">  916</span>    }</div>
<div class="ttc" id="aASN1_8php_html_ae29beb0be5cd6a79122fc312c32dcc50"><div class="ttname"><a href="ASN1_8php.html#ae29beb0be5cd6a79122fc312c32dcc50">FILE_ASN1_CLASS_UNIVERSAL</a></div><div class="ttdeci">const FILE_ASN1_CLASS_UNIVERSAL</div><div class="ttdoc">#+ Tag Classes</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00048">ASN1.php:48</a></div></div>
<div class="ttc" id="aclassFile__ASN1__Element_html"><div class="ttname"><a href="classFile__ASN1__Element.html">File_ASN1_Element</a></div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00117">ASN1.php:118</a></div></div>
<div class="ttc" id="aclassFile__ASN1_html_a1f30a92054d93d8c5470681b1f0508dc"><div class="ttname"><a href="classFile__ASN1.html#a1f30a92054d93d8c5470681b1f0508dc">File_ASN1\asn1map</a></div><div class="ttdeci">asn1map($decoded, $mapping, $special=array())</div><div class="ttdoc">ASN.1 Map.</div><div class="ttdef"><b>Definition:</b> <a href="ASN1_8php_source.html#l00616">ASN1.php:616</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ASN1_8php_source.html#l01420">_decodeDateTime()</a>, <a class="el" href="ASN1_8php_source.html#l01370">_decodeUnixTime()</a>, <a class="el" href="ASN1_8php_source.html#l00616">asn1map()</a>, <a class="el" href="ASN1_8php_source.html#l00050">FILE_ASN1_CLASS_CONTEXT_SPECIFIC</a>, <a class="el" href="ASN1_8php_source.html#l00048">FILE_ASN1_CLASS_UNIVERSAL</a>, <a class="el" href="ASN1_8php_source.html#l00105">FILE_ASN1_TYPE_ANY</a>, <a class="el" href="ASN1_8php_source.html#l00062">FILE_ASN1_TYPE_BIT_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00094">FILE_ASN1_TYPE_BMP_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00060">FILE_ASN1_TYPE_BOOLEAN</a>, <a class="el" href="ASN1_8php_source.html#l00104">FILE_ASN1_TYPE_CHOICE</a>, <a class="el" href="ASN1_8php_source.html#l00069">FILE_ASN1_TYPE_ENUMERATED</a>, <a class="el" href="ASN1_8php_source.html#l00091">FILE_ASN1_TYPE_GENERAL_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00088">FILE_ASN1_TYPE_GENERALIZED_TIME</a>, <a class="el" href="ASN1_8php_source.html#l00089">FILE_ASN1_TYPE_GRAPHIC_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00086">FILE_ASN1_TYPE_IA5_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00061">FILE_ASN1_TYPE_INTEGER</a>, <a class="el" href="ASN1_8php_source.html#l00064">FILE_ASN1_TYPE_NULL</a>, <a class="el" href="ASN1_8php_source.html#l00082">FILE_ASN1_TYPE_NUMERIC_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00065">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>, <a class="el" href="ASN1_8php_source.html#l00063">FILE_ASN1_TYPE_OCTET_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00083">FILE_ASN1_TYPE_PRINTABLE_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00073">FILE_ASN1_TYPE_SEQUENCE</a>, <a class="el" href="ASN1_8php_source.html#l00074">FILE_ASN1_TYPE_SET</a>, <a class="el" href="ASN1_8php_source.html#l00084">FILE_ASN1_TYPE_TELETEX_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00092">FILE_ASN1_TYPE_UNIVERSAL_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00087">FILE_ASN1_TYPE_UTC_TIME</a>, <a class="el" href="ASN1_8php_source.html#l00071">FILE_ASN1_TYPE_UTF8_STRING</a>, <a class="el" href="ASN1_8php_source.html#l00085">FILE_ASN1_TYPE_VIDEOTEX_STRING</a>, and <a class="el" href="ASN1_8php_source.html#l00090">FILE_ASN1_TYPE_VISIBLE_STRING</a>.</p>

<p class="reference">Referenced by <a class="el" href="ASN1_8php_source.html#l00616">asn1map()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__ASN1_a1f30a92054d93d8c5470681b1f0508dc_cgraph.png" border="0" usemap="#aclassFile__ASN1_a1f30a92054d93d8c5470681b1f0508dc_cgraph" alt=""/></div>
<map name="aclassFile__ASN1_a1f30a92054d93d8c5470681b1f0508dc_cgraph" id="aclassFile__ASN1_a1f30a92054d93d8c5470681b1f0508dc_cgraph">
<area shape="rect" title="ASN.1 Map." alt="" coords="5,31,88,56"/>
<area shape="rect" href="classFile__ASN1.html#ae93cbfbb826db862f63b3a54ff46df4e" title="BER&#45;decode the time (using DateTime)" alt="" coords="136,5,276,31"/>
<area shape="rect" href="classFile__ASN1.html#a8f552e81456e1e55cd55bb4158adb82a" title="BER&#45;decode the time (using UNIX time)" alt="" coords="137,55,275,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__ASN1_a1f30a92054d93d8c5470681b1f0508dc_icgraph.png" border="0" usemap="#aclassFile__ASN1_a1f30a92054d93d8c5470681b1f0508dc_icgraph" alt=""/></div>
<map name="aclassFile__ASN1_a1f30a92054d93d8c5470681b1f0508dc_icgraph" id="aclassFile__ASN1_a1f30a92054d93d8c5470681b1f0508dc_icgraph">
<area shape="rect" title="ASN.1 Map." alt="" coords="5,29,88,55"/>
</map>
</div>

</div>
</div>
<a id="a0e585250c17e19d71c758777634b4e77" name="a0e585250c17e19d71c758777634b4e77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e585250c17e19d71c758777634b4e77">&#9670;&#160;</a></span>convert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">convert </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$from</em> = <code><a class="el" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$to</em> = <code><a class="el" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>String type conversion. </p>
<p>This is a lazy conversion, dealing only with character size. No real conversion table is used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$in</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$from</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$to</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string @access public </dd></dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l01526">1526</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1527</span>    {</div>
<div class="line"><span class="lineno"> 1528</span>        <span class="keywordflow">if</span> (!isset($this-&gt;stringTypeSize[$from]) || !isset($this-&gt;stringTypeSize[$to])) {</div>
<div class="line"><span class="lineno"> 1529</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1530</span>        }</div>
<div class="line"><span class="lineno"> 1531</span>        $insize = $this-&gt;stringTypeSize[$from];</div>
<div class="line"><span class="lineno"> 1532</span>        $outsize = $this-&gt;stringTypeSize[$to];</div>
<div class="line"><span class="lineno"> 1533</span>        $inlength = strlen($in);</div>
<div class="line"><span class="lineno"> 1534</span>        $out = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1535</span> </div>
<div class="line"><span class="lineno"> 1536</span>        <span class="keywordflow">for</span> ($i = 0; $i &lt; $inlength;) {</div>
<div class="line"><span class="lineno"> 1537</span>            <span class="keywordflow">if</span> ($inlength - $i &lt; $insize) {</div>
<div class="line"><span class="lineno"> 1538</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1539</span>            }</div>
<div class="line"><span class="lineno"> 1540</span> </div>
<div class="line"><span class="lineno"> 1541</span>            <span class="comment">// Get an input character as a 32-bit value.</span></div>
<div class="line"><span class="lineno"> 1542</span>            $c = ord($in[$i++]);</div>
<div class="line"><span class="lineno"> 1543</span>            <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 1544</span>                <span class="keywordflow">case</span> $insize == 4:</div>
<div class="line"><span class="lineno"> 1545</span>                    $c = ($c &lt;&lt; 8) | ord($in[$i++]);</div>
<div class="line"><span class="lineno"> 1546</span>                    $c = ($c &lt;&lt; 8) | ord($in[$i++]);</div>
<div class="line"><span class="lineno"> 1547</span>                <span class="keywordflow">case</span> $insize == 2:</div>
<div class="line"><span class="lineno"> 1548</span>                    $c = ($c &lt;&lt; 8) | ord($in[$i++]);</div>
<div class="line"><span class="lineno"> 1549</span>                <span class="keywordflow">case</span> $insize == 1:</div>
<div class="line"><span class="lineno"> 1550</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1551</span>                <span class="keywordflow">case</span> ($c &amp; 0x80) == 0x00:</div>
<div class="line"><span class="lineno"> 1552</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1553</span>                <span class="keywordflow">case</span> ($c &amp; 0x40) == 0x00:</div>
<div class="line"><span class="lineno"> 1554</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1555</span>                <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1556</span>                    $bit = 6;</div>
<div class="line"><span class="lineno"> 1557</span>                    <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno"> 1558</span>                        <span class="keywordflow">if</span> ($bit &gt; 25 || $i &gt;= $inlength || (ord($in[$i]) &amp; 0xC0) != 0x80) {</div>
<div class="line"><span class="lineno"> 1559</span>                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1560</span>                        }</div>
<div class="line"><span class="lineno"> 1561</span>                        $c = ($c &lt;&lt; 6) | (ord($in[$i++]) &amp; 0x3F);</div>
<div class="line"><span class="lineno"> 1562</span>                        $bit += 5;</div>
<div class="line"><span class="lineno"> 1563</span>                        $mask = 1 &lt;&lt; $bit;</div>
<div class="line"><span class="lineno"> 1564</span>                    } <span class="keywordflow">while</span> ($c &amp; $bit);</div>
<div class="line"><span class="lineno"> 1565</span>                    $c &amp;= $mask - 1;</div>
<div class="line"><span class="lineno"> 1566</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1567</span>            }</div>
<div class="line"><span class="lineno"> 1568</span> </div>
<div class="line"><span class="lineno"> 1569</span>            <span class="comment">// Convert and append the character to output string.</span></div>
<div class="line"><span class="lineno"> 1570</span>            $v = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1571</span>            <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 1572</span>                <span class="keywordflow">case</span> $outsize == 4:</div>
<div class="line"><span class="lineno"> 1573</span>                    $v .= chr($c &amp; 0xFF);</div>
<div class="line"><span class="lineno"> 1574</span>                    $c &gt;&gt;= 8;</div>
<div class="line"><span class="lineno"> 1575</span>                    $v .= chr($c &amp; 0xFF);</div>
<div class="line"><span class="lineno"> 1576</span>                    $c &gt;&gt;= 8;</div>
<div class="line"><span class="lineno"> 1577</span>                <span class="keywordflow">case</span> $outsize == 2:</div>
<div class="line"><span class="lineno"> 1578</span>                    $v .= chr($c &amp; 0xFF);</div>
<div class="line"><span class="lineno"> 1579</span>                    $c &gt;&gt;= 8;</div>
<div class="line"><span class="lineno"> 1580</span>                <span class="keywordflow">case</span> $outsize == 1:</div>
<div class="line"><span class="lineno"> 1581</span>                    $v .= chr($c &amp; 0xFF);</div>
<div class="line"><span class="lineno"> 1582</span>                    $c &gt;&gt;= 8;</div>
<div class="line"><span class="lineno"> 1583</span>                    <span class="keywordflow">if</span> ($c) {</div>
<div class="line"><span class="lineno"> 1584</span>                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1585</span>                    }</div>
<div class="line"><span class="lineno"> 1586</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1587</span>                <span class="keywordflow">case</span> ($c &amp; 0x80000000) != 0:</div>
<div class="line"><span class="lineno"> 1588</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1589</span>                <span class="keywordflow">case</span> $c &gt;= 0x04000000:</div>
<div class="line"><span class="lineno"> 1590</span>                    $v .= chr(0x80 | ($c &amp; 0x3F));</div>
<div class="line"><span class="lineno"> 1591</span>                    $c = ($c &gt;&gt; 6) | 0x04000000;</div>
<div class="line"><span class="lineno"> 1592</span>                <span class="keywordflow">case</span> $c &gt;= 0x00200000:</div>
<div class="line"><span class="lineno"> 1593</span>                    $v .= chr(0x80 | ($c &amp; 0x3F));</div>
<div class="line"><span class="lineno"> 1594</span>                    $c = ($c &gt;&gt; 6) | 0x00200000;</div>
<div class="line"><span class="lineno"> 1595</span>                <span class="keywordflow">case</span> $c &gt;= 0x00010000:</div>
<div class="line"><span class="lineno"> 1596</span>                    $v .= chr(0x80 | ($c &amp; 0x3F));</div>
<div class="line"><span class="lineno"> 1597</span>                    $c = ($c &gt;&gt; 6) | 0x00010000;</div>
<div class="line"><span class="lineno"> 1598</span>                <span class="keywordflow">case</span> $c &gt;= 0x00000800:</div>
<div class="line"><span class="lineno"> 1599</span>                    $v .= chr(0x80 | ($c &amp; 0x3F));</div>
<div class="line"><span class="lineno"> 1600</span>                    $c = ($c &gt;&gt; 6) | 0x00000800;</div>
<div class="line"><span class="lineno"> 1601</span>                <span class="keywordflow">case</span> $c &gt;= 0x00000080:</div>
<div class="line"><span class="lineno"> 1602</span>                    $v .= chr(0x80 | ($c &amp; 0x3F));</div>
<div class="line"><span class="lineno"> 1603</span>                    $c = ($c &gt;&gt; 6) | 0x000000C0;</div>
<div class="line"><span class="lineno"> 1604</span>                <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1605</span>                    $v .= chr($c);</div>
<div class="line"><span class="lineno"> 1606</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1607</span>            }</div>
<div class="line"><span class="lineno"> 1608</span>            $out .= strrev($v);</div>
<div class="line"><span class="lineno"> 1609</span>        }</div>
<div class="line"><span class="lineno"> 1610</span>        <span class="keywordflow">return</span> $out;</div>
<div class="line"><span class="lineno"> 1611</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab508b6e87220e34709b62205489c6e36" name="ab508b6e87220e34709b62205489c6e36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab508b6e87220e34709b62205489c6e36">&#9670;&#160;</a></span>decodeBER()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">decodeBER </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$encoded</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse BER-encoding. </p>
<p>Serves a similar purpose to openssl's asn1parse</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$encoded</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array @access public </dd></dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l00293">293</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  294</span>    {</div>
<div class="line"><span class="lineno">  295</span>        <span class="keywordflow">if</span> (is_object(<a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>) &amp;&amp; strtolower(get_class(<a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>)) == <span class="stringliteral">&#39;file_asn1_element&#39;</span>) {</div>
<div class="line"><span class="lineno">  296</span>            <a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a> = <a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>-&gt;element;</div>
<div class="line"><span class="lineno">  297</span>        }</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>        $this-&gt;encoded = <a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>;</div>
<div class="line"><span class="lineno">  300</span>        <span class="comment">// encapsulate in an array for BC with the old decodeBER</span></div>
<div class="line"><span class="lineno">  301</span>        <span class="keywordflow">return</span> array($this-&gt;_decode_ber(<a class="code hl_variable" href="ctlr_8php.html#af709b460501204e2ec7e34e96e7de576">$encoded</a>));</div>
<div class="line"><span class="lineno">  302</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ctlr_8php_source.html#l00107">$encoded</a>, and <a class="el" href="ASN1_8php_source.html#l00317">_decode_ber()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__ASN1_ab508b6e87220e34709b62205489c6e36_cgraph.png" border="0" usemap="#aclassFile__ASN1_ab508b6e87220e34709b62205489c6e36_cgraph" alt=""/></div>
<map name="aclassFile__ASN1_ab508b6e87220e34709b62205489c6e36_cgraph" id="aclassFile__ASN1_ab508b6e87220e34709b62205489c6e36_cgraph">
<area shape="rect" title="Parse BER&#45;encoding." alt="" coords="5,55,100,80"/>
<area shape="rect" href="classFile__ASN1.html#aca372fbe28962a08b98355562dc666bf" title="Parse BER&#45;encoding (Helper function)" alt="" coords="148,55,252,80"/>
<area shape="rect" href="classFile__ASN1.html#ae93cbfbb826db862f63b3a54ff46df4e" title="BER&#45;decode the time (using DateTime)" alt="" coords="300,5,440,31"/>
<area shape="rect" href="classFile__ASN1.html#ac3c9042cbc9b53c7d39065e8ce11ddbd" title="BER&#45;decode the OID." alt="" coords="320,55,420,80"/>
<area shape="rect" href="classFile__ASN1.html#a8f552e81456e1e55cd55bb4158adb82a" title="BER&#45;decode the time (using UNIX time)" alt="" coords="301,104,439,129"/>
</map>
</div>

</div>
</div>
<a id="a6668c7a50e7ff14459c10564b7cd90cb" name="a6668c7a50e7ff14459c10564b7cd90cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6668c7a50e7ff14459c10564b7cd90cb">&#9670;&#160;</a></span>encodeDER()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encodeDER </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mapping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$special</em> = <code>array()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ASN.1 Encode. </p>
<p>DER-encodes an ASN.1 semantic mapping ($mapping). Some libraries would probably call this function an ASN.1 compiler.</p>
<p>"Special" mappings can be applied via $special.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$source</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$mapping</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$special</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string @access public </dd></dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l00932">932</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  933</span>    {</div>
<div class="line"><span class="lineno">  934</span>        $this-&gt;location = array();</div>
<div class="line"><span class="lineno">  935</span>        <span class="keywordflow">return</span> $this-&gt;_encode_der($source, $mapping, <span class="keyword">null</span>, $special);</div>
<div class="line"><span class="lineno">  936</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ASN1_8php_source.html#l00948">_encode_der()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__ASN1_a6668c7a50e7ff14459c10564b7cd90cb_cgraph.png" border="0" usemap="#aclassFile__ASN1_a6668c7a50e7ff14459c10564b7cd90cb_cgraph" alt=""/></div>
<map name="aclassFile__ASN1_a6668c7a50e7ff14459c10564b7cd90cb_cgraph" id="aclassFile__ASN1_a6668c7a50e7ff14459c10564b7cd90cb_cgraph">
<area shape="rect" title="ASN.1 Encode." alt="" coords="5,31,101,56"/>
<area shape="rect" href="classFile__ASN1.html#ab6152ed3dc2806e3cf7821a7fbdc97f3" title="ASN.1 Encode (Helper function)" alt="" coords="149,31,253,56"/>
<area shape="rect" href="classFile__ASN1.html#ab9967d86f5c5bdf50e4bc80cf1a9c018" title="DER&#45;encode the length." alt="" coords="301,5,421,31"/>
<area shape="rect" href="classFile__ASN1.html#ae4b37b96ed86815954b693c12f839775" title="DER&#45;encode the OID." alt="" coords="311,55,411,80"/>
</map>
</div>

</div>
</div>
<a id="aeda37eb7de48ddff92ea865b8ed54710" name="aeda37eb7de48ddff92ea865b8ed54710"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeda37eb7de48ddff92ea865b8ed54710">&#9670;&#160;</a></span>File_ASN1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFile__ASN1.html">File_ASN1</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PHP4 compatible Default Constructor. </p>
<dl class="section see"><dt>See also</dt><dd>self::__construct() @access public </dd></dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l00279">279</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  280</span>    {</div>
<div class="line"><span class="lineno">  281</span>        $this-&gt;__construct($mode);</div>
<div class="line"><span class="lineno">  282</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ASN1_8php_source.html#l00260">__construct()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classFile__ASN1_aeda37eb7de48ddff92ea865b8ed54710_cgraph.png" border="0" usemap="#aclassFile__ASN1_aeda37eb7de48ddff92ea865b8ed54710_cgraph" alt=""/></div>
<map name="aclassFile__ASN1_aeda37eb7de48ddff92ea865b8ed54710_cgraph" id="aclassFile__ASN1_aeda37eb7de48ddff92ea865b8ed54710_cgraph">
<area shape="rect" title="PHP4 compatible Default Constructor." alt="" coords="5,5,92,31"/>
<area shape="rect" href="classFile__ASN1.html#a095c5d389db211932136b53f25f39685" title="Default Constructor." alt="" coords="140,5,236,31"/>
</map>
</div>

</div>
</div>
<a id="a5adae64c81cc292218f8d800081c343c" name="a5adae64c81cc292218f8d800081c343c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5adae64c81cc292218f8d800081c343c">&#9670;&#160;</a></span>loadFilters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">loadFilters </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$filters</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load filters. </p>
<p>See <a class="el" href="classFile__X509.html">File_X509</a>, etc, for an example.</p>
<p>@access public </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$filters</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l01492">1492</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1493</span>    {</div>
<div class="line"><span class="lineno"> 1494</span>        $this-&gt;filters = $filters;</div>
<div class="line"><span class="lineno"> 1495</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af36a1322397aa7a558b9b9cc7fe43184" name="af36a1322397aa7a558b9b9cc7fe43184"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af36a1322397aa7a558b9b9cc7fe43184">&#9670;&#160;</a></span>loadOIDs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">loadOIDs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$oids</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load OIDs. </p>
<p>Load the relevant OIDs for a particular ASN.1 semantic mapping.</p>
<p>@access public </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$oids</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l01479">1479</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1480</span>    {</div>
<div class="line"><span class="lineno"> 1481</span>        $this-&gt;oids = $oids;</div>
<div class="line"><span class="lineno"> 1482</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a207b8453e7d5ea3c2115856e115bcb76" name="a207b8453e7d5ea3c2115856e115bcb76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a207b8453e7d5ea3c2115856e115bcb76">&#9670;&#160;</a></span>setTimeFormat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setTimeFormat </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$format</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the time format. </p>
<p>Sets the time / date format for asn1map().</p>
<p>@access public </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$format</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l01466">1466</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1467</span>    {</div>
<div class="line"><span class="lineno"> 1468</span>        $this-&gt;format = $format;</div>
<div class="line"><span class="lineno"> 1469</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a id="aa59066295d237c2d6ced701edbcf09a2" name="aa59066295d237c2d6ced701edbcf09a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa59066295d237c2d6ced701edbcf09a2">&#9670;&#160;</a></span>$ANYmap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$ANYmap</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= array(</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a7466606a3e1d863445b1be09b85f1148">FILE_ASN1_TYPE_BOOLEAN</a>              =&gt; <span class="keyword">true</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a9c3b70985b245c865ddf8874cc422ba6">FILE_ASN1_TYPE_INTEGER</a>              =&gt; <span class="keyword">true</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a1e4134ec1b734779403a8550d41954a3">FILE_ASN1_TYPE_BIT_STRING</a>           =&gt; <span class="stringliteral">&#39;bitString&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a5cbfd497aefacbfc5766e0b266022fc2">FILE_ASN1_TYPE_OCTET_STRING</a>         =&gt; <span class="stringliteral">&#39;octetString&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a178f5750294c65763f2b1b2d1a4acb0d">FILE_ASN1_TYPE_NULL</a>                 =&gt; <span class="stringliteral">&#39;null&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a8ed0e0a9293f9159b5de750e34b86652">FILE_ASN1_TYPE_OBJECT_IDENTIFIER</a>    =&gt; <span class="stringliteral">&#39;objectIdentifier&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#aafc4e432c511b12413cbb1dbd1a23191">FILE_ASN1_TYPE_REAL</a>                 =&gt; <span class="keyword">true</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a96edb7b260fa5df901e8f458cb77064e">FILE_ASN1_TYPE_ENUMERATED</a>           =&gt; <span class="stringliteral">&#39;enumerated&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>          =&gt; <span class="stringliteral">&#39;utf8String&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#af269bb1254bc4f65a21327c39530c0eb">FILE_ASN1_TYPE_NUMERIC_STRING</a>       =&gt; <span class="stringliteral">&#39;numericString&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a>     =&gt; <span class="stringliteral">&#39;printableString&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a5f903ee9a5fc70fcbff1af967c53083b">FILE_ASN1_TYPE_TELETEX_STRING</a>       =&gt; <span class="stringliteral">&#39;teletexString&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a840878e52522fbab4c1b402040bd3a11">FILE_ASN1_TYPE_VIDEOTEX_STRING</a>      =&gt; <span class="stringliteral">&#39;videotexString&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a>           =&gt; <span class="stringliteral">&#39;ia5String&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a842b61be906cf8882ae9b54a974231ba">FILE_ASN1_TYPE_UTC_TIME</a>             =&gt; <span class="stringliteral">&#39;utcTime&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a8ad0c6d6389ce6c6fb2e633814cbfd42">FILE_ASN1_TYPE_GENERALIZED_TIME</a>     =&gt; <span class="stringliteral">&#39;generalTime&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a079c98ace233ab025f8584ed810c466c">FILE_ASN1_TYPE_GRAPHIC_STRING</a>       =&gt; <span class="stringliteral">&#39;graphicString&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a5301a15003ac88ef62b1b097a8f99e8b">FILE_ASN1_TYPE_VISIBLE_STRING</a>       =&gt; <span class="stringliteral">&#39;visibleString&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a844e30a2e0708f8b9ba4c09ec24894ff">FILE_ASN1_TYPE_GENERAL_STRING</a>       =&gt; <span class="stringliteral">&#39;generalString&#39;</span>,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#ae7f15dadff8bafe3f5268f472bd1253d">FILE_ASN1_TYPE_UNIVERSAL_STRING</a>     =&gt; <span class="stringliteral">&#39;universalString&#39;</span>,</div>
<div class="line">        </div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#afae5a2a5df49e80953c2bb088f9ce8fb">FILE_ASN1_TYPE_BMP_STRING</a>           =&gt; <span class="stringliteral">&#39;bmpString&#39;</span></div>
<div class="line">    )</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l00211">211</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>

</div>
</div>
<a id="af709b460501204e2ec7e34e96e7de576" name="af709b460501204e2ec7e34e96e7de576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af709b460501204e2ec7e34e96e7de576">&#9670;&#160;</a></span>$encoded</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$encoded</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l00188">188</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>

</div>
</div>
<a id="ae222f32233a38635bef58d24a13c9df5" name="ae222f32233a38635bef58d24a13c9df5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae222f32233a38635bef58d24a13c9df5">&#9670;&#160;</a></span>$filters</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$filters</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l00199">199</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>

</div>
</div>
<a id="a1e6e4ea377a908a5407c435e9054e3a9" name="a1e6e4ea377a908a5407c435e9054e3a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e6e4ea377a908a5407c435e9054e3a9">&#9670;&#160;</a></span>$format</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$format = 'D, d M Y H:i:s O'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l00177">177</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>

</div>
</div>
<a id="a9922171de7141e7f4f8ebd13acee549c" name="a9922171de7141e7f4f8ebd13acee549c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9922171de7141e7f4f8ebd13acee549c">&#9670;&#160;</a></span>$oids</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$oids = array()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l00168">168</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>

</div>
</div>
<a id="a02d690b9a4a20b69d0a231e64655bce8" name="a02d690b9a4a20b69d0a231e64655bce8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02d690b9a4a20b69d0a231e64655bce8">&#9670;&#160;</a></span>$stringTypeSize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$stringTypeSize</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= array(</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#aa07c8f79dd12c23a3e688d9feba544ab">FILE_ASN1_TYPE_UTF8_STRING</a>      =&gt; 0,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#afae5a2a5df49e80953c2bb088f9ce8fb">FILE_ASN1_TYPE_BMP_STRING</a>       =&gt; 2,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#ae7f15dadff8bafe3f5268f472bd1253d">FILE_ASN1_TYPE_UNIVERSAL_STRING</a> =&gt; 4,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a277c7aa24346ee34aa14506cc313afcb">FILE_ASN1_TYPE_PRINTABLE_STRING</a> =&gt; 1,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a5f903ee9a5fc70fcbff1af967c53083b">FILE_ASN1_TYPE_TELETEX_STRING</a>   =&gt; 1,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#ac823a955a2086f2f57d56ce1de9eab01">FILE_ASN1_TYPE_IA5_STRING</a>       =&gt; 1,</div>
<div class="line">        <a class="code hl_variable" href="ASN1_8php.html#a5301a15003ac88ef62b1b097a8f99e8b">FILE_ASN1_TYPE_VISIBLE_STRING</a>   =&gt; 1,</div>
<div class="line">    )</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="ASN1_8php_source.html#l00245">245</a> of file <a class="el" href="ASN1_8php_source.html">ASN1.php</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/View/lib/phpseclib/File/<a class="el" href="ASN1_8php_source.html">ASN1.php</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classFile__ASN1.html">File_ASN1</a></li>
    <li class="footer">Generated on Sun Apr 30 2023 00:52:48 for PF Firewall by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
