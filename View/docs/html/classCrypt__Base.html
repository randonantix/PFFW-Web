<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PF Firewall: Crypt_Base Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PF Firewall<span id="projectnumber">&#160;7.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classCrypt__Base.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle"><div class="title">Crypt_Base Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for Crypt_Base:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base__inherit__graph.png" border="0" usemap="#aCrypt__Base_inherit__map" alt="Inheritance graph"/></div>
<map name="aCrypt__Base_inherit__map" id="aCrypt__Base_inherit__map">
<area shape="rect" title=" " alt="" coords="318,5,414,31"/>
<area shape="rect" href="classCrypt__Blowfish.html" title=" " alt="" coords="5,79,124,104"/>
<area shape="rect" href="classCrypt__DES.html" title=" " alt="" coords="149,79,239,104"/>
<area shape="rect" href="classCrypt__RC2.html" title=" " alt="" coords="263,79,354,104"/>
<area shape="rect" href="classCrypt__RC4.html" title=" " alt="" coords="378,79,469,104"/>
<area shape="rect" href="classCrypt__Rijndael.html" title=" " alt="" coords="493,79,610,104"/>
<area shape="rect" href="classCrypt__Twofish.html" title=" " alt="" coords="634,79,746,104"/>
<area shape="rect" href="classCrypt__TripleDES.html" title=" " alt="" coords="131,152,257,177"/>
<area shape="rect" href="classCrypt__AES.html" title=" " alt="" coords="507,152,596,177"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7f343b63c2a2441c661bb6f07553643f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a7f343b63c2a2441c661bb6f07553643f">__construct</a> ($mode=<a class="el" href="Base_8php.html#a766af87a1190a65dd937ce94ef962400">CRYPT_MODE_CBC</a>)</td></tr>
<tr class="memdesc:a7f343b63c2a2441c661bb6f07553643f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default Constructor.  <br /></td></tr>
<tr class="separator:a7f343b63c2a2441c661bb6f07553643f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a80cab2d9e4f3091d06f0393cb3faf8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a6a80cab2d9e4f3091d06f0393cb3faf8">Crypt_Base</a> ($mode=<a class="el" href="Base_8php.html#a766af87a1190a65dd937ce94ef962400">CRYPT_MODE_CBC</a>)</td></tr>
<tr class="memdesc:a6a80cab2d9e4f3091d06f0393cb3faf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">PHP4 compatible Default Constructor.  <br /></td></tr>
<tr class="separator:a6a80cab2d9e4f3091d06f0393cb3faf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04b58c8316cfa43c8ac1bee9a05aa639"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a04b58c8316cfa43c8ac1bee9a05aa639">setIV</a> ($iv)</td></tr>
<tr class="memdesc:a04b58c8316cfa43c8ac1bee9a05aa639"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the initialization vector.  <br /></td></tr>
<tr class="separator:a04b58c8316cfa43c8ac1bee9a05aa639"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a213d72f64ec9f940548d56d3c9df7457"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a213d72f64ec9f940548d56d3c9df7457">setKeyLength</a> ($length)</td></tr>
<tr class="memdesc:a213d72f64ec9f940548d56d3c9df7457"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the key length.  <br /></td></tr>
<tr class="separator:a213d72f64ec9f940548d56d3c9df7457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a739a45ca8f3e8586eef3750ffd0e4a02"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a739a45ca8f3e8586eef3750ffd0e4a02">getKeyLength</a> ()</td></tr>
<tr class="memdesc:a739a45ca8f3e8586eef3750ffd0e4a02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the current key length in bits.  <br /></td></tr>
<tr class="separator:a739a45ca8f3e8586eef3750ffd0e4a02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab61643153ff62ef8ecad1f33bcdcc62"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#aab61643153ff62ef8ecad1f33bcdcc62">getBlockLength</a> ()</td></tr>
<tr class="memdesc:aab61643153ff62ef8ecad1f33bcdcc62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the current block length in bits.  <br /></td></tr>
<tr class="separator:aab61643153ff62ef8ecad1f33bcdcc62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9afc10d017d5c65d3e6a941f65cf1904"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a9afc10d017d5c65d3e6a941f65cf1904">setKey</a> ($key)</td></tr>
<tr class="memdesc:a9afc10d017d5c65d3e6a941f65cf1904"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the key.  <br /></td></tr>
<tr class="separator:a9afc10d017d5c65d3e6a941f65cf1904"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abee03ea49c9f963f2e40adf6f53a33fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#abee03ea49c9f963f2e40adf6f53a33fa">setPassword</a> ($password, $method='pbkdf2')</td></tr>
<tr class="memdesc:abee03ea49c9f963f2e40adf6f53a33fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the password.  <br /></td></tr>
<tr class="separator:abee03ea49c9f963f2e40adf6f53a33fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5ceadf7c30ea677b755c6085b23f2a5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#aa5ceadf7c30ea677b755c6085b23f2a5">encrypt</a> ($plaintext)</td></tr>
<tr class="memdesc:aa5ceadf7c30ea677b755c6085b23f2a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts a message.  <br /></td></tr>
<tr class="separator:aa5ceadf7c30ea677b755c6085b23f2a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7668d56408ddd5f0cd7e8e745afd9d9a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a7668d56408ddd5f0cd7e8e745afd9d9a">decrypt</a> ($ciphertext)</td></tr>
<tr class="memdesc:a7668d56408ddd5f0cd7e8e745afd9d9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts a message.  <br /></td></tr>
<tr class="separator:a7668d56408ddd5f0cd7e8e745afd9d9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aaf3600e103d90572ffd029d81707d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a7aaf3600e103d90572ffd029d81707d1">_openssl_ctr_process</a> ($plaintext, &amp;$encryptIV, &amp;$buffer)</td></tr>
<tr class="memdesc:a7aaf3600e103d90572ffd029d81707d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">OpenSSL CTR Processor.  <br /></td></tr>
<tr class="separator:a7aaf3600e103d90572ffd029d81707d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1b2f723636fe01c4aa90fb201384110"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#ac1b2f723636fe01c4aa90fb201384110">_openssl_ofb_process</a> ($plaintext, &amp;$encryptIV, &amp;$buffer)</td></tr>
<tr class="memdesc:ac1b2f723636fe01c4aa90fb201384110"><td class="mdescLeft">&#160;</td><td class="mdescRight">OpenSSL OFB Processor.  <br /></td></tr>
<tr class="separator:ac1b2f723636fe01c4aa90fb201384110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96914544ec7c29ea559ad31c12694edd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a96914544ec7c29ea559ad31c12694edd">_openssl_translate_mode</a> ()</td></tr>
<tr class="memdesc:a96914544ec7c29ea559ad31c12694edd"><td class="mdescLeft">&#160;</td><td class="mdescRight">phpseclib &lt;-&gt; OpenSSL Mode Mapper  <br /></td></tr>
<tr class="separator:a96914544ec7c29ea559ad31c12694edd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5d80da425e83888700a2bd9a4f19290"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#aa5d80da425e83888700a2bd9a4f19290">enablePadding</a> ()</td></tr>
<tr class="memdesc:aa5d80da425e83888700a2bd9a4f19290"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pad "packets".  <br /></td></tr>
<tr class="separator:aa5d80da425e83888700a2bd9a4f19290"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80e40051c6fe78e15a70e162dca32010"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a80e40051c6fe78e15a70e162dca32010">disablePadding</a> ()</td></tr>
<tr class="memdesc:a80e40051c6fe78e15a70e162dca32010"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do not pad packets.  <br /></td></tr>
<tr class="separator:a80e40051c6fe78e15a70e162dca32010"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8ff793379f109d2e0f62e942c1c5ba5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#ab8ff793379f109d2e0f62e942c1c5ba5">enableContinuousBuffer</a> ()</td></tr>
<tr class="memdesc:ab8ff793379f109d2e0f62e942c1c5ba5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Treat consecutive "packets" as if they are a continuous buffer.  <br /></td></tr>
<tr class="separator:ab8ff793379f109d2e0f62e942c1c5ba5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfa3ada55a183bec17f12b630f8cfac5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#abfa3ada55a183bec17f12b630f8cfac5">disableContinuousBuffer</a> ()</td></tr>
<tr class="memdesc:abfa3ada55a183bec17f12b630f8cfac5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Treat consecutive packets as if they are a discontinuous buffer.  <br /></td></tr>
<tr class="separator:abfa3ada55a183bec17f12b630f8cfac5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae62f456da9bef718ecc3e155d63f0dc8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#ae62f456da9bef718ecc3e155d63f0dc8">isValidEngine</a> ($engine)</td></tr>
<tr class="memdesc:ae62f456da9bef718ecc3e155d63f0dc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test for engine validity.  <br /></td></tr>
<tr class="separator:ae62f456da9bef718ecc3e155d63f0dc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1082dc0f46d62a6aaa2bf8088c521bfd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a1082dc0f46d62a6aaa2bf8088c521bfd">setPreferredEngine</a> ($engine)</td></tr>
<tr class="memdesc:a1082dc0f46d62a6aaa2bf8088c521bfd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the preferred crypt engine.  <br /></td></tr>
<tr class="separator:a1082dc0f46d62a6aaa2bf8088c521bfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb060f55c1b9b700005ae80d2d627654"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#aeb060f55c1b9b700005ae80d2d627654">getEngine</a> ()</td></tr>
<tr class="memdesc:aeb060f55c1b9b700005ae80d2d627654"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the engine currently being utilized.  <br /></td></tr>
<tr class="separator:aeb060f55c1b9b700005ae80d2d627654"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4e58314adec23125fc08ae86aa501e3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#ab4e58314adec23125fc08ae86aa501e3">_setEngine</a> ()</td></tr>
<tr class="memdesc:ab4e58314adec23125fc08ae86aa501e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the engine as appropriate.  <br /></td></tr>
<tr class="separator:ab4e58314adec23125fc08ae86aa501e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbb5f094cd3af568d05434b7a4b3e6e2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a> ($in)</td></tr>
<tr class="memdesc:adbb5f094cd3af568d05434b7a4b3e6e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts a block.  <br /></td></tr>
<tr class="separator:adbb5f094cd3af568d05434b7a4b3e6e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a08218631ae2281ca8cf6032c34a843"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a2a08218631ae2281ca8cf6032c34a843">_decryptBlock</a> ($in)</td></tr>
<tr class="memdesc:a2a08218631ae2281ca8cf6032c34a843"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts a block.  <br /></td></tr>
<tr class="separator:a2a08218631ae2281ca8cf6032c34a843"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad783e9c1c4fc5e3d8e312f08dd36f68"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#aad783e9c1c4fc5e3d8e312f08dd36f68">_setupKey</a> ()</td></tr>
<tr class="memdesc:aad783e9c1c4fc5e3d8e312f08dd36f68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the key (expansion)  <br /></td></tr>
<tr class="separator:aad783e9c1c4fc5e3d8e312f08dd36f68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a893edf931eab08c67a70d2e93bbf8c11"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a893edf931eab08c67a70d2e93bbf8c11">_setup</a> ()</td></tr>
<tr class="memdesc:a893edf931eab08c67a70d2e93bbf8c11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the CRYPT_ENGINE_INTERNAL $engine.  <br /></td></tr>
<tr class="separator:a893edf931eab08c67a70d2e93bbf8c11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af55698320880af8999c954bad4544a86"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#af55698320880af8999c954bad4544a86">_setupMcrypt</a> ()</td></tr>
<tr class="memdesc:af55698320880af8999c954bad4544a86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the CRYPT_ENGINE_MCRYPT $engine.  <br /></td></tr>
<tr class="separator:af55698320880af8999c954bad4544a86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dc8c16ec5951b4037a7b36a5a6c4bcd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a2dc8c16ec5951b4037a7b36a5a6c4bcd">_pad</a> ($text)</td></tr>
<tr class="memdesc:a2dc8c16ec5951b4037a7b36a5a6c4bcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pads a string.  <br /></td></tr>
<tr class="separator:a2dc8c16ec5951b4037a7b36a5a6c4bcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa01a443b76b909f941c3434a06e744ce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#aa01a443b76b909f941c3434a06e744ce">_unpad</a> ($text)</td></tr>
<tr class="memdesc:aa01a443b76b909f941c3434a06e744ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unpads a string.  <br /></td></tr>
<tr class="separator:aa01a443b76b909f941c3434a06e744ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a87457f321c145b43893358a820f55a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a1a87457f321c145b43893358a820f55a">_clearBuffers</a> ()</td></tr>
<tr class="memdesc:a1a87457f321c145b43893358a820f55a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears internal buffers.  <br /></td></tr>
<tr class="separator:a1a87457f321c145b43893358a820f55a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab009fa6f4ba09daa679a30e9b5bcfe35"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a> (&amp;$string, $index=1)</td></tr>
<tr class="memdesc:ab009fa6f4ba09daa679a30e9b5bcfe35"><td class="mdescLeft">&#160;</td><td class="mdescRight">String Shift.  <br /></td></tr>
<tr class="separator:ab009fa6f4ba09daa679a30e9b5bcfe35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cc0bf8f079a276e5d518ac53443fa31"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a1cc0bf8f079a276e5d518ac53443fa31">_string_pop</a> (&amp;$string, $index=1)</td></tr>
<tr class="memdesc:a1cc0bf8f079a276e5d518ac53443fa31"><td class="mdescLeft">&#160;</td><td class="mdescRight">String Pop.  <br /></td></tr>
<tr class="separator:a1cc0bf8f079a276e5d518ac53443fa31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a412f868848015dec037f640c385f37be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a412f868848015dec037f640c385f37be">_increment_str</a> (&amp;$var)</td></tr>
<tr class="memdesc:a412f868848015dec037f640c385f37be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increment the current string.  <br /></td></tr>
<tr class="separator:a412f868848015dec037f640c385f37be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08e325f5762546ed7646eb4e79835026"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a08e325f5762546ed7646eb4e79835026">_setupInlineCrypt</a> ()</td></tr>
<tr class="memdesc:a08e325f5762546ed7646eb4e79835026"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the performance-optimized function for de/encrypt()  <br /></td></tr>
<tr class="separator:a08e325f5762546ed7646eb4e79835026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f5b2f57acc58fa751fe7c826cd4ac6b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a9f5b2f57acc58fa751fe7c826cd4ac6b">_createInlineCryptFunction</a> ($cipher_code)</td></tr>
<tr class="memdesc:a9f5b2f57acc58fa751fe7c826cd4ac6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates the performance-optimized function for en/decrypt()  <br /></td></tr>
<tr class="separator:a9f5b2f57acc58fa751fe7c826cd4ac6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa21f06db50fa687c83e85cc6c5549719"><td class="memItemLeft" align="right" valign="top">&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#aa21f06db50fa687c83e85cc6c5549719">_getLambdaFunctions</a> ()</td></tr>
<tr class="memdesc:aa21f06db50fa687c83e85cc6c5549719"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the lambda_functions table (classwide)  <br /></td></tr>
<tr class="separator:aa21f06db50fa687c83e85cc6c5549719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa64482022632c990a010c0f8772d4fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#aaa64482022632c990a010c0f8772d4fe">_hashInlineCryptFunction</a> ($bytes)</td></tr>
<tr class="memdesc:aaa64482022632c990a010c0f8772d4fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a digest from $bytes.  <br /></td></tr>
<tr class="separator:aaa64482022632c990a010c0f8772d4fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a342b96bd7214a3cb2254af8bd1fe53f6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a342b96bd7214a3cb2254af8bd1fe53f6">safe_intval</a> ($x)</td></tr>
<tr class="memdesc:a342b96bd7214a3cb2254af8bd1fe53f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert float to int.  <br /></td></tr>
<tr class="separator:a342b96bd7214a3cb2254af8bd1fe53f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b20f898d429ad2fbd075f3aaf498dca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a9b20f898d429ad2fbd075f3aaf498dca">safe_intval_inline</a> ()</td></tr>
<tr class="memdesc:a9b20f898d429ad2fbd075f3aaf498dca"><td class="mdescLeft">&#160;</td><td class="mdescRight">eval()'able string for in-line float to int  <br /></td></tr>
<tr class="separator:a9b20f898d429ad2fbd075f3aaf498dca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff97cfdb1f997aedfc7a2093602e8409"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#aff97cfdb1f997aedfc7a2093602e8409">do_nothing</a> ()</td></tr>
<tr class="memdesc:aff97cfdb1f997aedfc7a2093602e8409"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dummy error handler to suppress mcrypt errors.  <br /></td></tr>
<tr class="separator:aff97cfdb1f997aedfc7a2093602e8409"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a3aaf40baac36e278c7d7c9139df1750c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a></td></tr>
<tr class="separator:a3aaf40baac36e278c7d7c9139df1750c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace0c858100bed2086051616b5c9f896e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a> = 16</td></tr>
<tr class="separator:ace0c858100bed2086051616b5c9f896e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa60b0284e0dfa2463495481cf11e3cf4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a> = &quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&quot;</td></tr>
<tr class="separator:aa60b0284e0dfa2463495481cf11e3cf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a147a28261cd10fb6dbdae31eb0a89c8d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a></td></tr>
<tr class="separator:a147a28261cd10fb6dbdae31eb0a89c8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a844b790c27e6ac5bed660f5f39b968a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a844b790c27e6ac5bed660f5f39b968a2">$encryptIV</a></td></tr>
<tr class="separator:a844b790c27e6ac5bed660f5f39b968a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a503b1f86cfb167f4d6a6dc64d1859c93"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a503b1f86cfb167f4d6a6dc64d1859c93">$decryptIV</a></td></tr>
<tr class="separator:a503b1f86cfb167f4d6a6dc64d1859c93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87a08812a447665deda8b4f637a3fd3c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a87a08812a447665deda8b4f637a3fd3c">$continuousBuffer</a> = false</td></tr>
<tr class="separator:a87a08812a447665deda8b4f637a3fd3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a046df06c5e603847c89a819ec0d72e61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a046df06c5e603847c89a819ec0d72e61">$enbuffer</a></td></tr>
<tr class="separator:a046df06c5e603847c89a819ec0d72e61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7b9d1db8026a18bac02db20236b3041"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#af7b9d1db8026a18bac02db20236b3041">$debuffer</a></td></tr>
<tr class="separator:af7b9d1db8026a18bac02db20236b3041"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1af90a6b87c48d4dd7737e8db69d58a7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a1af90a6b87c48d4dd7737e8db69d58a7">$enmcrypt</a></td></tr>
<tr class="separator:a1af90a6b87c48d4dd7737e8db69d58a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e9093ce4b7142ef92caef91f117dae4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a3e9093ce4b7142ef92caef91f117dae4">$demcrypt</a></td></tr>
<tr class="separator:a3e9093ce4b7142ef92caef91f117dae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9441e4025dc9752d42d5b9ccecb1e43f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a9441e4025dc9752d42d5b9ccecb1e43f">$enchanged</a> = true</td></tr>
<tr class="separator:a9441e4025dc9752d42d5b9ccecb1e43f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95a208baa79b17e35077ce93c3259de8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a95a208baa79b17e35077ce93c3259de8">$dechanged</a> = true</td></tr>
<tr class="separator:a95a208baa79b17e35077ce93c3259de8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7384c69661159001cb7940c65ad164b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#ab7384c69661159001cb7940c65ad164b">$ecb</a></td></tr>
<tr class="separator:ab7384c69661159001cb7940c65ad164b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20b2fd4815c854da73ea97eb0b80585d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a20b2fd4815c854da73ea97eb0b80585d">$cfb_init_len</a> = 600</td></tr>
<tr class="separator:a20b2fd4815c854da73ea97eb0b80585d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab060006d1221e5e476126476b921ad54"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#ab060006d1221e5e476126476b921ad54">$changed</a> = true</td></tr>
<tr class="separator:ab060006d1221e5e476126476b921ad54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8563f129efffd9bcc2e662e00c0ba29e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a8563f129efffd9bcc2e662e00c0ba29e">$padding</a> = true</td></tr>
<tr class="separator:a8563f129efffd9bcc2e662e00c0ba29e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcbc08bc1b750a9e99f89eadacb274f7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#adcbc08bc1b750a9e99f89eadacb274f7">$paddable</a> = false</td></tr>
<tr class="separator:adcbc08bc1b750a9e99f89eadacb274f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a3b012ad4844366d9207d8f0e174a00"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a8a3b012ad4844366d9207d8f0e174a00">$engine</a></td></tr>
<tr class="separator:a8a3b012ad4844366d9207d8f0e174a00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac1cfc082e560ddb261a1643ebb851a8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#aac1cfc082e560ddb261a1643ebb851a8">$preferredEngine</a></td></tr>
<tr class="separator:aac1cfc082e560ddb261a1643ebb851a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cd607a337f707065b91770b8f14ec6e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a8cd607a337f707065b91770b8f14ec6e">$cipher_name_mcrypt</a></td></tr>
<tr class="separator:a8cd607a337f707065b91770b8f14ec6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a662d78092265a47caff4e068e74bff67"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a662d78092265a47caff4e068e74bff67">$cipher_name_openssl</a></td></tr>
<tr class="separator:a662d78092265a47caff4e068e74bff67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bc82d506210132f76de65f15df6e175"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a4bc82d506210132f76de65f15df6e175">$cipher_name_openssl_ecb</a></td></tr>
<tr class="separator:a4bc82d506210132f76de65f15df6e175"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4713350dcea06d7ac52a49e65d9a089c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a4713350dcea06d7ac52a49e65d9a089c">$password_default_salt</a> = 'phpseclib/salt'</td></tr>
<tr class="separator:a4713350dcea06d7ac52a49e65d9a089c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae829ae62fafd5d12c345286a4f66d54f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#ae829ae62fafd5d12c345286a4f66d54f">$const_namespace</a></td></tr>
<tr class="separator:ae829ae62fafd5d12c345286a4f66d54f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e914e76d25e4f5a8af66643aab09fa9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a3e914e76d25e4f5a8af66643aab09fa9">$inline_crypt</a></td></tr>
<tr class="separator:a3e914e76d25e4f5a8af66643aab09fa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad463584f44c7740c6d0a5705c9e178cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#ad463584f44c7740c6d0a5705c9e178cc">$use_inline_crypt</a></td></tr>
<tr class="separator:ad463584f44c7740c6d0a5705c9e178cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51ca16e2b0fc5a63963d3b4348bb2b7c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a51ca16e2b0fc5a63963d3b4348bb2b7c">$openssl_emulate_ctr</a> = false</td></tr>
<tr class="separator:a51ca16e2b0fc5a63963d3b4348bb2b7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f79357a9e674ecfc6f5649bf8c3d923"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#a6f79357a9e674ecfc6f5649bf8c3d923">$openssl_options</a></td></tr>
<tr class="separator:a6f79357a9e674ecfc6f5649bf8c3d923"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab69ac592e5538135ff601ca4b8fa92c7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#ab69ac592e5538135ff601ca4b8fa92c7">$explicit_key_length</a> = false</td></tr>
<tr class="separator:ab69ac592e5538135ff601ca4b8fa92c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1a44dd580ee401d0d447cf6a8a2a7a9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCrypt__Base.html#aa1a44dd580ee401d0d447cf6a8a2a7a9">$skip_key_adjustment</a> = false</td></tr>
<tr class="separator:aa1a44dd580ee401d0d447cf6a8a2a7a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00125">125</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a7f343b63c2a2441c661bb6f07553643f" name="a7f343b63c2a2441c661bb6f07553643f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f343b63c2a2441c661bb6f07553643f">&#9670;&#160;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__construct </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mode</em> = <code><a class="el" href="Base_8php.html#a766af87a1190a65dd937ce94ef962400">CRYPT_MODE_CBC</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default Constructor. </p>
<p>Determines whether or not the mcrypt extension should be used.</p>
<p>$mode could be:</p>
<ul>
<li>CRYPT_MODE_ECB</li>
<li>CRYPT_MODE_CBC</li>
<li>CRYPT_MODE_CTR</li>
<li>CRYPT_MODE_CFB</li>
<li>CRYPT_MODE_OFB</li>
</ul>
<p>(or the alias constants of the chosen cipher, for example for AES: CRYPT_AES_MODE_ECB or CRYPT_AES_MODE_CBC ...)</p>
<p>If not explicitly set, CRYPT_MODE_CBC will be used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$mode</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classCrypt__TripleDES.html#a7f343b63c2a2441c661bb6f07553643f">Crypt_TripleDES</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00506">506</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  507</span>    {</div>
<div class="line"><span class="lineno">  508</span>        <span class="comment">// $mode dependent settings</span></div>
<div class="line"><span class="lineno">  509</span>        <span class="keywordflow">switch</span> ($mode) {</div>
<div class="line"><span class="lineno">  510</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#ace7687420bc69da6192bc40c8a061804">CRYPT_MODE_ECB</a>:</div>
<div class="line"><span class="lineno">  511</span>                $this-&gt;paddable = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  512</span>                $this-&gt;mode = <a class="code hl_variable" href="Base_8php.html#ace7687420bc69da6192bc40c8a061804">CRYPT_MODE_ECB</a>;</div>
<div class="line"><span class="lineno">  513</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  514</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a4204f1d2beaf41a2b97967cbea0ef666">CRYPT_MODE_CTR</a>:</div>
<div class="line"><span class="lineno">  515</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#aa1a1e45bef3380f6e5c0a1c8fa4dad46">CRYPT_MODE_CFB</a>:</div>
<div class="line"><span class="lineno">  516</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#af9423638549fc5c52db69b66560614ef">CRYPT_MODE_OFB</a>:</div>
<div class="line"><span class="lineno">  517</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#adaa3d4f69333325e047270ae0d58bcaa">CRYPT_MODE_STREAM</a>:</div>
<div class="line"><span class="lineno">  518</span>                $this-&gt;mode = $mode;</div>
<div class="line"><span class="lineno">  519</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  520</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a766af87a1190a65dd937ce94ef962400">CRYPT_MODE_CBC</a>:</div>
<div class="line"><span class="lineno">  521</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  522</span>                $this-&gt;paddable = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  523</span>                $this-&gt;mode = <a class="code hl_variable" href="Base_8php.html#a766af87a1190a65dd937ce94ef962400">CRYPT_MODE_CBC</a>;</div>
<div class="line"><span class="lineno">  524</span>        }</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span>        $this-&gt;_setEngine();</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>        <span class="comment">// Determining whether inline crypting can be used by the cipher</span></div>
<div class="line"><span class="lineno">  529</span>        <span class="keywordflow">if</span> ($this-&gt;use_inline_crypt !== <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  530</span>            $this-&gt;use_inline_crypt = version_compare(<a class="code hl_variable" href="configtest_8php.html#a3c1ade165b70ecbf36a71bc64671334a">PHP_VERSION</a>, <span class="stringliteral">&#39;5.3.0&#39;</span>) &gt;= 0 || function_exists(<span class="stringliteral">&#39;create_function&#39;</span>);</div>
<div class="line"><span class="lineno">  531</span>        }</div>
<div class="line"><span class="lineno">  532</span>    }</div>
<div class="ttc" id="aBase_8php_html_a4204f1d2beaf41a2b97967cbea0ef666"><div class="ttname"><a href="Base_8php.html#a4204f1d2beaf41a2b97967cbea0ef666">CRYPT_MODE_CTR</a></div><div class="ttdeci">const CRYPT_MODE_CTR</div><div class="ttdoc">#+ @access public</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00067">Base.php:67</a></div></div>
<div class="ttc" id="aBase_8php_html_a766af87a1190a65dd937ce94ef962400"><div class="ttname"><a href="Base_8php.html#a766af87a1190a65dd937ce94ef962400">CRYPT_MODE_CBC</a></div><div class="ttdeci">const CRYPT_MODE_CBC</div><div class="ttdoc">Encrypt / decrypt using the Code Book Chaining mode.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00079">Base.php:79</a></div></div>
<div class="ttc" id="aBase_8php_html_aa1a1e45bef3380f6e5c0a1c8fa4dad46"><div class="ttname"><a href="Base_8php.html#aa1a1e45bef3380f6e5c0a1c8fa4dad46">CRYPT_MODE_CFB</a></div><div class="ttdeci">const CRYPT_MODE_CFB</div><div class="ttdoc">Encrypt / decrypt using the Cipher Feedback mode.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00085">Base.php:85</a></div></div>
<div class="ttc" id="aBase_8php_html_ace7687420bc69da6192bc40c8a061804"><div class="ttname"><a href="Base_8php.html#ace7687420bc69da6192bc40c8a061804">CRYPT_MODE_ECB</a></div><div class="ttdeci">const CRYPT_MODE_ECB</div><div class="ttdoc">Encrypt / decrypt using the Electronic Code Book mode.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00073">Base.php:73</a></div></div>
<div class="ttc" id="aBase_8php_html_adaa3d4f69333325e047270ae0d58bcaa"><div class="ttname"><a href="Base_8php.html#adaa3d4f69333325e047270ae0d58bcaa">CRYPT_MODE_STREAM</a></div><div class="ttdeci">const CRYPT_MODE_STREAM</div><div class="ttdoc">Encrypt / decrypt using streaming mode.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00095">Base.php:95</a></div></div>
<div class="ttc" id="aBase_8php_html_af9423638549fc5c52db69b66560614ef"><div class="ttname"><a href="Base_8php.html#af9423638549fc5c52db69b66560614ef">CRYPT_MODE_OFB</a></div><div class="ttdeci">const CRYPT_MODE_OFB</div><div class="ttdoc">Encrypt / decrypt using the Output Feedback mode.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00091">Base.php:91</a></div></div>
<div class="ttc" id="aconfigtest_8php_html_a3c1ade165b70ecbf36a71bc64671334a"><div class="ttname"><a href="configtest_8php.html#a3c1ade165b70ecbf36a71bc64671334a">PHP_VERSION</a></div><div class="ttdeci">print PHP_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="configtest_8php_source.html#l00041">configtest.php:41</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l01720">_setEngine()</a>, <a class="el" href="Base_8php_source.html#l00079">CRYPT_MODE_CBC</a>, <a class="el" href="Base_8php_source.html#l00085">CRYPT_MODE_CFB</a>, <a class="el" href="Base_8php_source.html#l00067">CRYPT_MODE_CTR</a>, <a class="el" href="Base_8php_source.html#l00073">CRYPT_MODE_ECB</a>, <a class="el" href="Base_8php_source.html#l00091">CRYPT_MODE_OFB</a>, <a class="el" href="Base_8php_source.html#l00095">CRYPT_MODE_STREAM</a>, and <a class="el" href="configtest_8php_source.html#l00041">PHP_VERSION</a>.</p>

<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l00541">Crypt_Base()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a7f343b63c2a2441c661bb6f07553643f_cgraph.png" border="0" usemap="#aclassCrypt__Base_a7f343b63c2a2441c661bb6f07553643f_cgraph" alt=""/></div>
<map name="aclassCrypt__Base_a7f343b63c2a2441c661bb6f07553643f_cgraph" id="aclassCrypt__Base_a7f343b63c2a2441c661bb6f07553643f_cgraph">
<area shape="rect" title="Default Constructor." alt="" coords="5,5,101,31"/>
<area shape="rect" href="classCrypt__Base.html#ab4e58314adec23125fc08ae86aa501e3" title="Sets the engine as appropriate." alt="" coords="149,5,243,31"/>
<area shape="rect" href="classCrypt__Base.html#ae62f456da9bef718ecc3e155d63f0dc8" title="Test for engine validity." alt="" coords="291,5,400,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a7f343b63c2a2441c661bb6f07553643f_icgraph.png" border="0" usemap="#aclassCrypt__Base_a7f343b63c2a2441c661bb6f07553643f_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a7f343b63c2a2441c661bb6f07553643f_icgraph" id="aclassCrypt__Base_a7f343b63c2a2441c661bb6f07553643f_icgraph">
<area shape="rect" title="Default Constructor." alt="" coords="149,5,245,31"/>
<area shape="rect" href="classCrypt__Base.html#a6a80cab2d9e4f3091d06f0393cb3faf8" title="PHP4 compatible Default Constructor." alt="" coords="5,5,101,31"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a1a87457f321c145b43893358a820f55a" name="a1a87457f321c145b43893358a820f55a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a87457f321c145b43893358a820f55a">&#9670;&#160;</a></span>_clearBuffers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_clearBuffers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clears internal buffers. </p>
<p>Clearing/resetting the internal buffers is done everytime after disableContinuousBuffer() or on cipher $engine (re)init ie after setKey() or setIV()</p>
<p>@access public </p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01955">1955</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1956</span>    {</div>
<div class="line"><span class="lineno"> 1957</span>        $this-&gt;enbuffer = $this-&gt;debuffer = array(<span class="stringliteral">&#39;ciphertext&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;xor&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;pos&#39;</span> =&gt; 0, <span class="stringliteral">&#39;enmcrypt_init&#39;</span> =&gt; <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1958</span> </div>
<div class="line"><span class="lineno"> 1959</span>        <span class="comment">// mcrypt&#39;s handling of invalid&#39;s $iv:</span></div>
<div class="line"><span class="lineno"> 1960</span>        <span class="comment">// $this-&gt;encryptIV = $this-&gt;decryptIV = strlen($this-&gt;iv) == $this-&gt;block_size ? $this-&gt;iv : str_repeat(&quot;\0&quot;, $this-&gt;block_size);</span></div>
<div class="line"><span class="lineno"> 1961</span>        $this-&gt;encryptIV = $this-&gt;decryptIV = str_pad(substr($this-&gt;iv, 0, $this-&gt;block_size), $this-&gt;block_size, <span class="stringliteral">&quot;\0&quot;</span>);</div>
<div class="line"><span class="lineno"> 1962</span> </div>
<div class="line"><span class="lineno"> 1963</span>        <span class="keywordflow">if</span> (!$this-&gt;skip_key_adjustment) {</div>
<div class="line"><span class="lineno"> 1964</span>            $this-&gt;key = str_pad(substr($this-&gt;key, 0, $this-&gt;key_length), $this-&gt;key_length, <span class="stringliteral">&quot;\0&quot;</span>);</div>
<div class="line"><span class="lineno"> 1965</span>        }</div>
<div class="line"><span class="lineno"> 1966</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l01822">_setup()</a>, <a class="el" href="Base_8php_source.html#l01855">_setupMcrypt()</a>, <a class="el" href="Base_8php_source.html#l01050">decrypt()</a>, and <a class="el" href="Base_8php_source.html#l00744">encrypt()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a1a87457f321c145b43893358a820f55a_icgraph.png" border="0" usemap="#aclassCrypt__Base_a1a87457f321c145b43893358a820f55a_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a1a87457f321c145b43893358a820f55a_icgraph" id="aclassCrypt__Base_a1a87457f321c145b43893358a820f55a_icgraph">
<area shape="rect" title="Clears internal buffers." alt="" coords="537,50,644,75"/>
<area shape="rect" href="classCrypt__Base.html#a893edf931eab08c67a70d2e93bbf8c11" title="Setup the CRYPT_ENGINE_INTERNAL $engine." alt="" coords="401,74,467,99"/>
<area shape="rect" href="classCrypt__Base.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="228,25,299,50"/>
<area shape="rect" href="classCrypt__Base.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="228,74,299,99"/>
<area shape="rect" href="classCrypt__Base.html#af55698320880af8999c954bad4544a86" title="Setup the CRYPT_ENGINE_MCRYPT $engine." alt="" coords="379,25,489,50"/>
<area shape="rect" href="classCrypt__RC4.html#a4edc74894fc45ad50de5f65a2ce3c509" title="Encrypts or decrypts a message." alt="" coords="196,123,331,149"/>
<area shape="rect" href="classCrypt__RC4.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="5,98,148,123"/>
<area shape="rect" href="classCrypt__RC4.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="5,147,148,173"/>
</map>
</div>

</div>
</div>
<a id="a9f5b2f57acc58fa751fe7c826cd4ac6b" name="a9f5b2f57acc58fa751fe7c826cd4ac6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f5b2f57acc58fa751fe7c826cd4ac6b">&#9670;&#160;</a></span>_createInlineCryptFunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_createInlineCryptFunction </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$cipher_code</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates the performance-optimized function for en/decrypt() </p>
<p>Internally for phpseclib developers:</p>
<p>_createInlineCryptFunction():</p>
<ul>
<li>merge the $cipher_code [setup'ed by _setupInlineCrypt()] with the current [$this-&gt;]mode of operation code</li>
<li>create the $inline function, which called by encrypt() / decrypt() as its replacement to speed up the en/decryption operations.</li>
<li>return the name of the created $inline callback function</li>
<li>used to speed up en/decryption</li>
</ul>
<p>The main reason why can speed up things [up to 50%] this way are:</p>
<ul>
<li>using variables more effective then regular. (ie no use of expensive arrays but integers $k_0, $k_1 ... or even, for example, the pure $key[] values hardcoded)</li>
<li>avoiding 1000's of function calls of ie _encryptBlock() but inlining the crypt operations. in the mode of operation for() loop.</li>
<li>full loop unroll the (sometimes key-dependent) rounds avoiding this way ++$i counters and runtime-if's etc...</li>
</ul>
<p>The basic code architectur of the generated $inline en/decrypt() lambda function, in pseudo php, is:</p>
<p><code> +-------------------------------------------------------------------------------------------&mdash;+ | callback $inline = create_function: | | lambda_function_0001_crypt_ECB($action, $text) | | { | | INSERT PHP CODE OF: | | $cipher_code['init_crypt']; // general init code. | | // ie: $sbox'es declarations used for | </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">// encrypt and decrypt'ing.    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">switch ($action) {    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">case 'encrypt':    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">INSERT PHP CODE OF:    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">$cipher_code['init_encrypt']; // encrypt sepcific init code.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ie: specified $key or $box    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">declarations for encrypt'ing.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">foreach ($ciphertext) {    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$in = $block_size of $ciphertext;    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">INSERT PHP CODE OF:    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">$cipher_code['encrypt_block']; // encrypt's (string) $in, which is always:    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">// strlen($in) == $this-&gt;block_size    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">// here comes the cipher algorithm in action    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">// for encryption.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">// $cipher_code['encrypt_block'] has to    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">// encrypt the content of the $in variable    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$plaintext .= $in;    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">}    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">return $plaintext;    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">case 'decrypt':    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">INSERT PHP CODE OF:    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$cipher_code['init_decrypt']; // decrypt sepcific init code    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ie: specified $key or $box    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">declarations for decrypt'ing.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">foreach ($plaintext) {    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$in = $block_size of $plaintext;    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">INSERT PHP CODE OF:    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">$cipher_code['decrypt_block']; // decrypt's (string) $in, which is always    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">// strlen($in) == $this-&gt;block_size    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">// here comes the cipher algorithm in action    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">// for decryption.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">// $cipher_code['decrypt_block'] has to    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">// decrypt the content of the $in variable    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">$ciphertext .= $in;    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">}    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">return $ciphertext;    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">}    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">}   </td></tr>
</table>
<p>+-------------------------------------------------------------------------------------------&mdash;+ </code></p>
<p>See also the Crypt_*::_setupInlineCrypt()'s for productive inline $cipher_code's how they works.</p>
<p>Structure of: <code> $cipher_code = array( 'init_crypt' =&gt; (string) '', // optional 'init_encrypt' =&gt; (string) '', // optional 'init_decrypt' =&gt; (string) '', // optional 'encrypt_block' =&gt; (string) '', // required 'decrypt_block' =&gt; (string) '' // required ); </code></p>
<dl class="section see"><dt>See also</dt><dd>self::_setupInlineCrypt() </dd>
<dd>
self::encrypt() </dd>
<dd>
self::decrypt() </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$cipher_code</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string (the name of the created callback function) </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l02221">2221</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2222</span>    {</div>
<div class="line"><span class="lineno"> 2223</span>        $block_size = $this-&gt;block_size;</div>
<div class="line"><span class="lineno"> 2224</span> </div>
<div class="line"><span class="lineno"> 2225</span>        <span class="comment">// optional</span></div>
<div class="line"><span class="lineno"> 2226</span>        $init_crypt    = isset($cipher_code[<span class="stringliteral">&#39;init_crypt&#39;</span>])    ? $cipher_code[<span class="stringliteral">&#39;init_crypt&#39;</span>]    : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 2227</span>        $init_encrypt  = isset($cipher_code[<span class="stringliteral">&#39;init_encrypt&#39;</span>])  ? $cipher_code[<span class="stringliteral">&#39;init_encrypt&#39;</span>]  : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 2228</span>        $init_decrypt  = isset($cipher_code[<span class="stringliteral">&#39;init_decrypt&#39;</span>])  ? $cipher_code[<span class="stringliteral">&#39;init_decrypt&#39;</span>]  : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 2229</span>        <span class="comment">// required</span></div>
<div class="line"><span class="lineno"> 2230</span>        $encrypt_block = $cipher_code[<span class="stringliteral">&#39;encrypt_block&#39;</span>];</div>
<div class="line"><span class="lineno"> 2231</span>        $decrypt_block = $cipher_code[<span class="stringliteral">&#39;decrypt_block&#39;</span>];</div>
<div class="line"><span class="lineno"> 2232</span> </div>
<div class="line"><span class="lineno"> 2233</span>        <span class="comment">// Generating mode of operation inline code,</span></div>
<div class="line"><span class="lineno"> 2234</span>        <span class="comment">// merged with the $cipher_code algorithm</span></div>
<div class="line"><span class="lineno"> 2235</span>        <span class="comment">// for encrypt- and decryption.</span></div>
<div class="line"><span class="lineno"> 2236</span>        <span class="keywordflow">switch</span> ($this-&gt;mode) {</div>
<div class="line"><span class="lineno"> 2237</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#ace7687420bc69da6192bc40c8a061804">CRYPT_MODE_ECB</a>:</div>
<div class="line"><span class="lineno"> 2238</span>                $encrypt = $init_encrypt . <span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2239</span><span class="stringliteral">                    $_ciphertext = &quot;&quot;;</span></div>
<div class="line"><span class="lineno"> 2240</span><span class="stringliteral">                    $_plaintext_len = strlen($_text);</span></div>
<div class="line"><span class="lineno"> 2241</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2242</span><span class="stringliteral">                    for ($_i = 0; $_i &lt; $_plaintext_len; $_i+= &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2243</span><span class="stringliteral">                        $in = substr($_text, $_i, &#39;</span>.$block_size.<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="lineno"> 2244</span><span class="stringliteral">                        &#39;</span>.$encrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2245</span><span class="stringliteral">                        $_ciphertext.= $in;</span></div>
<div class="line"><span class="lineno"> 2246</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2247</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2248</span><span class="stringliteral">                    return $_ciphertext;</span></div>
<div class="line"><span class="lineno"> 2249</span><span class="stringliteral">                    &#39;</span>;</div>
<div class="line"><span class="lineno"> 2250</span> </div>
<div class="line"><span class="lineno"> 2251</span>                $decrypt = $init_decrypt . <span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2252</span><span class="stringliteral">                    $_plaintext = &quot;&quot;;</span></div>
<div class="line"><span class="lineno"> 2253</span><span class="stringliteral">                    $_text = str_pad($_text, strlen($_text) + (&#39;</span>.$block_size.<span class="stringliteral">&#39; - strlen($_text) % &#39;</span>.$block_size.<span class="stringliteral">&#39;) % &#39;</span>.$block_size.<span class="stringliteral">&#39;, chr(0));</span></div>
<div class="line"><span class="lineno"> 2254</span><span class="stringliteral">                    $_ciphertext_len = strlen($_text);</span></div>
<div class="line"><span class="lineno"> 2255</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2256</span><span class="stringliteral">                    for ($_i = 0; $_i &lt; $_ciphertext_len; $_i+= &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2257</span><span class="stringliteral">                        $in = substr($_text, $_i, &#39;</span>.$block_size.<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="lineno"> 2258</span><span class="stringliteral">                        &#39;</span>.$decrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2259</span><span class="stringliteral">                        $_plaintext.= $in;</span></div>
<div class="line"><span class="lineno"> 2260</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2261</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2262</span><span class="stringliteral">                    return $self-&gt;_unpad($_plaintext);</span></div>
<div class="line"><span class="lineno"> 2263</span><span class="stringliteral">                    &#39;</span>;</div>
<div class="line"><span class="lineno"> 2264</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2265</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a4204f1d2beaf41a2b97967cbea0ef666">CRYPT_MODE_CTR</a>:</div>
<div class="line"><span class="lineno"> 2266</span>                $encrypt = $init_encrypt . <span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2267</span><span class="stringliteral">                    $_ciphertext = &quot;&quot;;</span></div>
<div class="line"><span class="lineno"> 2268</span><span class="stringliteral">                    $_plaintext_len = strlen($_text);</span></div>
<div class="line"><span class="lineno"> 2269</span><span class="stringliteral">                    $_xor = $self-&gt;encryptIV;</span></div>
<div class="line"><span class="lineno"> 2270</span><span class="stringliteral">                    $_buffer = &amp;$self-&gt;enbuffer;</span></div>
<div class="line"><span class="lineno"> 2271</span><span class="stringliteral">                    if (strlen($_buffer[&quot;ciphertext&quot;])) {</span></div>
<div class="line"><span class="lineno"> 2272</span><span class="stringliteral">                        for ($_i = 0; $_i &lt; $_plaintext_len; $_i+= &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2273</span><span class="stringliteral">                            $_block = substr($_text, $_i, &#39;</span>.$block_size.<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="lineno"> 2274</span><span class="stringliteral">                            if (strlen($_block) &gt; strlen($_buffer[&quot;ciphertext&quot;])) {</span></div>
<div class="line"><span class="lineno"> 2275</span><span class="stringliteral">                                $in = $_xor;</span></div>
<div class="line"><span class="lineno"> 2276</span><span class="stringliteral">                                &#39;</span>.$encrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2277</span><span class="stringliteral">                                $self-&gt;_increment_str($_xor);</span></div>
<div class="line"><span class="lineno"> 2278</span><span class="stringliteral">                                $_buffer[&quot;ciphertext&quot;].= $in;</span></div>
<div class="line"><span class="lineno"> 2279</span><span class="stringliteral">                            }</span></div>
<div class="line"><span class="lineno"> 2280</span><span class="stringliteral">                            $_key = $self-&gt;_string_shift($_buffer[&quot;ciphertext&quot;], &#39;</span>.$block_size.<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="lineno"> 2281</span><span class="stringliteral">                            $_ciphertext.= $_block ^ $_key;</span></div>
<div class="line"><span class="lineno"> 2282</span><span class="stringliteral">                        }</span></div>
<div class="line"><span class="lineno"> 2283</span><span class="stringliteral">                    } else {</span></div>
<div class="line"><span class="lineno"> 2284</span><span class="stringliteral">                        for ($_i = 0; $_i &lt; $_plaintext_len; $_i+= &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2285</span><span class="stringliteral">                            $_block = substr($_text, $_i, &#39;</span>.$block_size.<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="lineno"> 2286</span><span class="stringliteral">                            $in = $_xor;</span></div>
<div class="line"><span class="lineno"> 2287</span><span class="stringliteral">                            &#39;</span>.$encrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2288</span><span class="stringliteral">                            $self-&gt;_increment_str($_xor);</span></div>
<div class="line"><span class="lineno"> 2289</span><span class="stringliteral">                            $_key = $in;</span></div>
<div class="line"><span class="lineno"> 2290</span><span class="stringliteral">                            $_ciphertext.= $_block ^ $_key;</span></div>
<div class="line"><span class="lineno"> 2291</span><span class="stringliteral">                        }</span></div>
<div class="line"><span class="lineno"> 2292</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2293</span><span class="stringliteral">                    if ($self-&gt;continuousBuffer) {</span></div>
<div class="line"><span class="lineno"> 2294</span><span class="stringliteral">                        $self-&gt;encryptIV = $_xor;</span></div>
<div class="line"><span class="lineno"> 2295</span><span class="stringliteral">                        if ($_start = $_plaintext_len % &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2296</span><span class="stringliteral">                            $_buffer[&quot;ciphertext&quot;] = substr($_key, $_start) . $_buffer[&quot;ciphertext&quot;];</span></div>
<div class="line"><span class="lineno"> 2297</span><span class="stringliteral">                        }</span></div>
<div class="line"><span class="lineno"> 2298</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2299</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2300</span><span class="stringliteral">                    return $_ciphertext;</span></div>
<div class="line"><span class="lineno"> 2301</span><span class="stringliteral">                &#39;</span>;</div>
<div class="line"><span class="lineno"> 2302</span> </div>
<div class="line"><span class="lineno"> 2303</span>                $decrypt = $init_encrypt . <span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2304</span><span class="stringliteral">                    $_plaintext = &quot;&quot;;</span></div>
<div class="line"><span class="lineno"> 2305</span><span class="stringliteral">                    $_ciphertext_len = strlen($_text);</span></div>
<div class="line"><span class="lineno"> 2306</span><span class="stringliteral">                    $_xor = $self-&gt;decryptIV;</span></div>
<div class="line"><span class="lineno"> 2307</span><span class="stringliteral">                    $_buffer = &amp;$self-&gt;debuffer;</span></div>
<div class="line"><span class="lineno"> 2308</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2309</span><span class="stringliteral">                    if (strlen($_buffer[&quot;ciphertext&quot;])) {</span></div>
<div class="line"><span class="lineno"> 2310</span><span class="stringliteral">                        for ($_i = 0; $_i &lt; $_ciphertext_len; $_i+= &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2311</span><span class="stringliteral">                            $_block = substr($_text, $_i, &#39;</span>.$block_size.<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="lineno"> 2312</span><span class="stringliteral">                            if (strlen($_block) &gt; strlen($_buffer[&quot;ciphertext&quot;])) {</span></div>
<div class="line"><span class="lineno"> 2313</span><span class="stringliteral">                                $in = $_xor;</span></div>
<div class="line"><span class="lineno"> 2314</span><span class="stringliteral">                                &#39;</span>.$encrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2315</span><span class="stringliteral">                                $self-&gt;_increment_str($_xor);</span></div>
<div class="line"><span class="lineno"> 2316</span><span class="stringliteral">                                $_buffer[&quot;ciphertext&quot;].= $in;</span></div>
<div class="line"><span class="lineno"> 2317</span><span class="stringliteral">                            }</span></div>
<div class="line"><span class="lineno"> 2318</span><span class="stringliteral">                            $_key = $self-&gt;_string_shift($_buffer[&quot;ciphertext&quot;], &#39;</span>.$block_size.<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="lineno"> 2319</span><span class="stringliteral">                            $_plaintext.= $_block ^ $_key;</span></div>
<div class="line"><span class="lineno"> 2320</span><span class="stringliteral">                        }</span></div>
<div class="line"><span class="lineno"> 2321</span><span class="stringliteral">                    } else {</span></div>
<div class="line"><span class="lineno"> 2322</span><span class="stringliteral">                        for ($_i = 0; $_i &lt; $_ciphertext_len; $_i+= &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2323</span><span class="stringliteral">                            $_block = substr($_text, $_i, &#39;</span>.$block_size.<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="lineno"> 2324</span><span class="stringliteral">                            $in = $_xor;</span></div>
<div class="line"><span class="lineno"> 2325</span><span class="stringliteral">                            &#39;</span>.$encrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2326</span><span class="stringliteral">                            $self-&gt;_increment_str($_xor);</span></div>
<div class="line"><span class="lineno"> 2327</span><span class="stringliteral">                            $_key = $in;</span></div>
<div class="line"><span class="lineno"> 2328</span><span class="stringliteral">                            $_plaintext.= $_block ^ $_key;</span></div>
<div class="line"><span class="lineno"> 2329</span><span class="stringliteral">                        }</span></div>
<div class="line"><span class="lineno"> 2330</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2331</span><span class="stringliteral">                    if ($self-&gt;continuousBuffer) {</span></div>
<div class="line"><span class="lineno"> 2332</span><span class="stringliteral">                        $self-&gt;decryptIV = $_xor;</span></div>
<div class="line"><span class="lineno"> 2333</span><span class="stringliteral">                        if ($_start = $_ciphertext_len % &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2334</span><span class="stringliteral">                            $_buffer[&quot;ciphertext&quot;] = substr($_key, $_start) . $_buffer[&quot;ciphertext&quot;];</span></div>
<div class="line"><span class="lineno"> 2335</span><span class="stringliteral">                        }</span></div>
<div class="line"><span class="lineno"> 2336</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2337</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2338</span><span class="stringliteral">                    return $_plaintext;</span></div>
<div class="line"><span class="lineno"> 2339</span><span class="stringliteral">                    &#39;</span>;</div>
<div class="line"><span class="lineno"> 2340</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2341</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#aa1a1e45bef3380f6e5c0a1c8fa4dad46">CRYPT_MODE_CFB</a>:</div>
<div class="line"><span class="lineno"> 2342</span>                $encrypt = $init_encrypt . <span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2343</span><span class="stringliteral">                    $_ciphertext = &quot;&quot;;</span></div>
<div class="line"><span class="lineno"> 2344</span><span class="stringliteral">                    $_buffer = &amp;$self-&gt;enbuffer;</span></div>
<div class="line"><span class="lineno"> 2345</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2346</span><span class="stringliteral">                    if ($self-&gt;continuousBuffer) {</span></div>
<div class="line"><span class="lineno"> 2347</span><span class="stringliteral">                        $_iv = &amp;$self-&gt;encryptIV;</span></div>
<div class="line"><span class="lineno"> 2348</span><span class="stringliteral">                        $_pos = &amp;$_buffer[&quot;pos&quot;];</span></div>
<div class="line"><span class="lineno"> 2349</span><span class="stringliteral">                    } else {</span></div>
<div class="line"><span class="lineno"> 2350</span><span class="stringliteral">                        $_iv = $self-&gt;encryptIV;</span></div>
<div class="line"><span class="lineno"> 2351</span><span class="stringliteral">                        $_pos = 0;</span></div>
<div class="line"><span class="lineno"> 2352</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2353</span><span class="stringliteral">                    $_len = strlen($_text);</span></div>
<div class="line"><span class="lineno"> 2354</span><span class="stringliteral">                    $_i = 0;</span></div>
<div class="line"><span class="lineno"> 2355</span><span class="stringliteral">                    if ($_pos) {</span></div>
<div class="line"><span class="lineno"> 2356</span><span class="stringliteral">                        $_orig_pos = $_pos;</span></div>
<div class="line"><span class="lineno"> 2357</span><span class="stringliteral">                        $_max = &#39;</span>.$block_size.<span class="stringliteral">&#39; - $_pos;</span></div>
<div class="line"><span class="lineno"> 2358</span><span class="stringliteral">                        if ($_len &gt;= $_max) {</span></div>
<div class="line"><span class="lineno"> 2359</span><span class="stringliteral">                            $_i = $_max;</span></div>
<div class="line"><span class="lineno"> 2360</span><span class="stringliteral">                            $_len-= $_max;</span></div>
<div class="line"><span class="lineno"> 2361</span><span class="stringliteral">                            $_pos = 0;</span></div>
<div class="line"><span class="lineno"> 2362</span><span class="stringliteral">                        } else {</span></div>
<div class="line"><span class="lineno"> 2363</span><span class="stringliteral">                            $_i = $_len;</span></div>
<div class="line"><span class="lineno"> 2364</span><span class="stringliteral">                            $_pos+= $_len;</span></div>
<div class="line"><span class="lineno"> 2365</span><span class="stringliteral">                            $_len = 0;</span></div>
<div class="line"><span class="lineno"> 2366</span><span class="stringliteral">                        }</span></div>
<div class="line"><span class="lineno"> 2367</span><span class="stringliteral">                        $_ciphertext = substr($_iv, $_orig_pos) ^ $_text;</span></div>
<div class="line"><span class="lineno"> 2368</span><span class="stringliteral">                        $_iv = substr_replace($_iv, $_ciphertext, $_orig_pos, $_i);</span></div>
<div class="line"><span class="lineno"> 2369</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2370</span><span class="stringliteral">                    while ($_len &gt;= &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2371</span><span class="stringliteral">                        $in = $_iv;</span></div>
<div class="line"><span class="lineno"> 2372</span><span class="stringliteral">                        &#39;</span>.$encrypt_block.<span class="stringliteral">&#39;;</span></div>
<div class="line"><span class="lineno"> 2373</span><span class="stringliteral">                        $_iv = $in ^ substr($_text, $_i, &#39;</span>.$block_size.<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="lineno"> 2374</span><span class="stringliteral">                        $_ciphertext.= $_iv;</span></div>
<div class="line"><span class="lineno"> 2375</span><span class="stringliteral">                        $_len-= &#39;</span>.$block_size.<span class="stringliteral">&#39;;</span></div>
<div class="line"><span class="lineno"> 2376</span><span class="stringliteral">                        $_i+= &#39;</span>.$block_size.<span class="stringliteral">&#39;;</span></div>
<div class="line"><span class="lineno"> 2377</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2378</span><span class="stringliteral">                    if ($_len) {</span></div>
<div class="line"><span class="lineno"> 2379</span><span class="stringliteral">                        $in = $_iv;</span></div>
<div class="line"><span class="lineno"> 2380</span><span class="stringliteral">                        &#39;</span>.$encrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2381</span><span class="stringliteral">                        $_iv = $in;</span></div>
<div class="line"><span class="lineno"> 2382</span><span class="stringliteral">                        $_block = $_iv ^ substr($_text, $_i);</span></div>
<div class="line"><span class="lineno"> 2383</span><span class="stringliteral">                        $_iv = substr_replace($_iv, $_block, 0, $_len);</span></div>
<div class="line"><span class="lineno"> 2384</span><span class="stringliteral">                        $_ciphertext.= $_block;</span></div>
<div class="line"><span class="lineno"> 2385</span><span class="stringliteral">                        $_pos = $_len;</span></div>
<div class="line"><span class="lineno"> 2386</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2387</span><span class="stringliteral">                    return $_ciphertext;</span></div>
<div class="line"><span class="lineno"> 2388</span><span class="stringliteral">                &#39;</span>;</div>
<div class="line"><span class="lineno"> 2389</span> </div>
<div class="line"><span class="lineno"> 2390</span>                $decrypt = $init_encrypt . <span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2391</span><span class="stringliteral">                    $_plaintext = &quot;&quot;;</span></div>
<div class="line"><span class="lineno"> 2392</span><span class="stringliteral">                    $_buffer = &amp;$self-&gt;debuffer;</span></div>
<div class="line"><span class="lineno"> 2393</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2394</span><span class="stringliteral">                    if ($self-&gt;continuousBuffer) {</span></div>
<div class="line"><span class="lineno"> 2395</span><span class="stringliteral">                        $_iv = &amp;$self-&gt;decryptIV;</span></div>
<div class="line"><span class="lineno"> 2396</span><span class="stringliteral">                        $_pos = &amp;$_buffer[&quot;pos&quot;];</span></div>
<div class="line"><span class="lineno"> 2397</span><span class="stringliteral">                    } else {</span></div>
<div class="line"><span class="lineno"> 2398</span><span class="stringliteral">                        $_iv = $self-&gt;decryptIV;</span></div>
<div class="line"><span class="lineno"> 2399</span><span class="stringliteral">                        $_pos = 0;</span></div>
<div class="line"><span class="lineno"> 2400</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2401</span><span class="stringliteral">                    $_len = strlen($_text);</span></div>
<div class="line"><span class="lineno"> 2402</span><span class="stringliteral">                    $_i = 0;</span></div>
<div class="line"><span class="lineno"> 2403</span><span class="stringliteral">                    if ($_pos) {</span></div>
<div class="line"><span class="lineno"> 2404</span><span class="stringliteral">                        $_orig_pos = $_pos;</span></div>
<div class="line"><span class="lineno"> 2405</span><span class="stringliteral">                        $_max = &#39;</span>.$block_size.<span class="stringliteral">&#39; - $_pos;</span></div>
<div class="line"><span class="lineno"> 2406</span><span class="stringliteral">                        if ($_len &gt;= $_max) {</span></div>
<div class="line"><span class="lineno"> 2407</span><span class="stringliteral">                            $_i = $_max;</span></div>
<div class="line"><span class="lineno"> 2408</span><span class="stringliteral">                            $_len-= $_max;</span></div>
<div class="line"><span class="lineno"> 2409</span><span class="stringliteral">                            $_pos = 0;</span></div>
<div class="line"><span class="lineno"> 2410</span><span class="stringliteral">                        } else {</span></div>
<div class="line"><span class="lineno"> 2411</span><span class="stringliteral">                            $_i = $_len;</span></div>
<div class="line"><span class="lineno"> 2412</span><span class="stringliteral">                            $_pos+= $_len;</span></div>
<div class="line"><span class="lineno"> 2413</span><span class="stringliteral">                            $_len = 0;</span></div>
<div class="line"><span class="lineno"> 2414</span><span class="stringliteral">                        }</span></div>
<div class="line"><span class="lineno"> 2415</span><span class="stringliteral">                        $_plaintext = substr($_iv, $_orig_pos) ^ $_text;</span></div>
<div class="line"><span class="lineno"> 2416</span><span class="stringliteral">                        $_iv = substr_replace($_iv, substr($_text, 0, $_i), $_orig_pos, $_i);</span></div>
<div class="line"><span class="lineno"> 2417</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2418</span><span class="stringliteral">                    while ($_len &gt;= &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2419</span><span class="stringliteral">                        $in = $_iv;</span></div>
<div class="line"><span class="lineno"> 2420</span><span class="stringliteral">                        &#39;</span>.$encrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2421</span><span class="stringliteral">                        $_iv = $in;</span></div>
<div class="line"><span class="lineno"> 2422</span><span class="stringliteral">                        $cb = substr($_text, $_i, &#39;</span>.$block_size.<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="lineno"> 2423</span><span class="stringliteral">                        $_plaintext.= $_iv ^ $cb;</span></div>
<div class="line"><span class="lineno"> 2424</span><span class="stringliteral">                        $_iv = $cb;</span></div>
<div class="line"><span class="lineno"> 2425</span><span class="stringliteral">                        $_len-= &#39;</span>.$block_size.<span class="stringliteral">&#39;;</span></div>
<div class="line"><span class="lineno"> 2426</span><span class="stringliteral">                        $_i+= &#39;</span>.$block_size.<span class="stringliteral">&#39;;</span></div>
<div class="line"><span class="lineno"> 2427</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2428</span><span class="stringliteral">                    if ($_len) {</span></div>
<div class="line"><span class="lineno"> 2429</span><span class="stringliteral">                        $in = $_iv;</span></div>
<div class="line"><span class="lineno"> 2430</span><span class="stringliteral">                        &#39;</span>.$encrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2431</span><span class="stringliteral">                        $_iv = $in;</span></div>
<div class="line"><span class="lineno"> 2432</span><span class="stringliteral">                        $_plaintext.= $_iv ^ substr($_text, $_i);</span></div>
<div class="line"><span class="lineno"> 2433</span><span class="stringliteral">                        $_iv = substr_replace($_iv, substr($_text, $_i), 0, $_len);</span></div>
<div class="line"><span class="lineno"> 2434</span><span class="stringliteral">                        $_pos = $_len;</span></div>
<div class="line"><span class="lineno"> 2435</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2436</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2437</span><span class="stringliteral">                    return $_plaintext;</span></div>
<div class="line"><span class="lineno"> 2438</span><span class="stringliteral">                    &#39;</span>;</div>
<div class="line"><span class="lineno"> 2439</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2440</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#af9423638549fc5c52db69b66560614ef">CRYPT_MODE_OFB</a>:</div>
<div class="line"><span class="lineno"> 2441</span>                $encrypt = $init_encrypt . <span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2442</span><span class="stringliteral">                    $_ciphertext = &quot;&quot;;</span></div>
<div class="line"><span class="lineno"> 2443</span><span class="stringliteral">                    $_plaintext_len = strlen($_text);</span></div>
<div class="line"><span class="lineno"> 2444</span><span class="stringliteral">                    $_xor = $self-&gt;encryptIV;</span></div>
<div class="line"><span class="lineno"> 2445</span><span class="stringliteral">                    $_buffer = &amp;$self-&gt;enbuffer;</span></div>
<div class="line"><span class="lineno"> 2446</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2447</span><span class="stringliteral">                    if (strlen($_buffer[&quot;xor&quot;])) {</span></div>
<div class="line"><span class="lineno"> 2448</span><span class="stringliteral">                        for ($_i = 0; $_i &lt; $_plaintext_len; $_i+= &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2449</span><span class="stringliteral">                            $_block = substr($_text, $_i, &#39;</span>.$block_size.<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="lineno"> 2450</span><span class="stringliteral">                            if (strlen($_block) &gt; strlen($_buffer[&quot;xor&quot;])) {</span></div>
<div class="line"><span class="lineno"> 2451</span><span class="stringliteral">                                $in = $_xor;</span></div>
<div class="line"><span class="lineno"> 2452</span><span class="stringliteral">                                &#39;</span>.$encrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2453</span><span class="stringliteral">                                $_xor = $in;</span></div>
<div class="line"><span class="lineno"> 2454</span><span class="stringliteral">                                $_buffer[&quot;xor&quot;].= $_xor;</span></div>
<div class="line"><span class="lineno"> 2455</span><span class="stringliteral">                            }</span></div>
<div class="line"><span class="lineno"> 2456</span><span class="stringliteral">                            $_key = $self-&gt;_string_shift($_buffer[&quot;xor&quot;], &#39;</span>.$block_size.<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="lineno"> 2457</span><span class="stringliteral">                            $_ciphertext.= $_block ^ $_key;</span></div>
<div class="line"><span class="lineno"> 2458</span><span class="stringliteral">                        }</span></div>
<div class="line"><span class="lineno"> 2459</span><span class="stringliteral">                    } else {</span></div>
<div class="line"><span class="lineno"> 2460</span><span class="stringliteral">                        for ($_i = 0; $_i &lt; $_plaintext_len; $_i+= &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2461</span><span class="stringliteral">                            $in = $_xor;</span></div>
<div class="line"><span class="lineno"> 2462</span><span class="stringliteral">                            &#39;</span>.$encrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2463</span><span class="stringliteral">                            $_xor = $in;</span></div>
<div class="line"><span class="lineno"> 2464</span><span class="stringliteral">                            $_ciphertext.= substr($_text, $_i, &#39;</span>.$block_size.<span class="stringliteral">&#39;) ^ $_xor;</span></div>
<div class="line"><span class="lineno"> 2465</span><span class="stringliteral">                        }</span></div>
<div class="line"><span class="lineno"> 2466</span><span class="stringliteral">                        $_key = $_xor;</span></div>
<div class="line"><span class="lineno"> 2467</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2468</span><span class="stringliteral">                    if ($self-&gt;continuousBuffer) {</span></div>
<div class="line"><span class="lineno"> 2469</span><span class="stringliteral">                        $self-&gt;encryptIV = $_xor;</span></div>
<div class="line"><span class="lineno"> 2470</span><span class="stringliteral">                        if ($_start = $_plaintext_len % &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2471</span><span class="stringliteral">                             $_buffer[&quot;xor&quot;] = substr($_key, $_start) . $_buffer[&quot;xor&quot;];</span></div>
<div class="line"><span class="lineno"> 2472</span><span class="stringliteral">                        }</span></div>
<div class="line"><span class="lineno"> 2473</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2474</span><span class="stringliteral">                    return $_ciphertext;</span></div>
<div class="line"><span class="lineno"> 2475</span><span class="stringliteral">                    &#39;</span>;</div>
<div class="line"><span class="lineno"> 2476</span> </div>
<div class="line"><span class="lineno"> 2477</span>                $decrypt = $init_encrypt . <span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2478</span><span class="stringliteral">                    $_plaintext = &quot;&quot;;</span></div>
<div class="line"><span class="lineno"> 2479</span><span class="stringliteral">                    $_ciphertext_len = strlen($_text);</span></div>
<div class="line"><span class="lineno"> 2480</span><span class="stringliteral">                    $_xor = $self-&gt;decryptIV;</span></div>
<div class="line"><span class="lineno"> 2481</span><span class="stringliteral">                    $_buffer = &amp;$self-&gt;debuffer;</span></div>
<div class="line"><span class="lineno"> 2482</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2483</span><span class="stringliteral">                    if (strlen($_buffer[&quot;xor&quot;])) {</span></div>
<div class="line"><span class="lineno"> 2484</span><span class="stringliteral">                        for ($_i = 0; $_i &lt; $_ciphertext_len; $_i+= &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2485</span><span class="stringliteral">                            $_block = substr($_text, $_i, &#39;</span>.$block_size.<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="lineno"> 2486</span><span class="stringliteral">                            if (strlen($_block) &gt; strlen($_buffer[&quot;xor&quot;])) {</span></div>
<div class="line"><span class="lineno"> 2487</span><span class="stringliteral">                                $in = $_xor;</span></div>
<div class="line"><span class="lineno"> 2488</span><span class="stringliteral">                                &#39;</span>.$encrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2489</span><span class="stringliteral">                                $_xor = $in;</span></div>
<div class="line"><span class="lineno"> 2490</span><span class="stringliteral">                                $_buffer[&quot;xor&quot;].= $_xor;</span></div>
<div class="line"><span class="lineno"> 2491</span><span class="stringliteral">                            }</span></div>
<div class="line"><span class="lineno"> 2492</span><span class="stringliteral">                            $_key = $self-&gt;_string_shift($_buffer[&quot;xor&quot;], &#39;</span>.$block_size.<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="lineno"> 2493</span><span class="stringliteral">                            $_plaintext.= $_block ^ $_key;</span></div>
<div class="line"><span class="lineno"> 2494</span><span class="stringliteral">                        }</span></div>
<div class="line"><span class="lineno"> 2495</span><span class="stringliteral">                    } else {</span></div>
<div class="line"><span class="lineno"> 2496</span><span class="stringliteral">                        for ($_i = 0; $_i &lt; $_ciphertext_len; $_i+= &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2497</span><span class="stringliteral">                            $in = $_xor;</span></div>
<div class="line"><span class="lineno"> 2498</span><span class="stringliteral">                            &#39;</span>.$encrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2499</span><span class="stringliteral">                            $_xor = $in;</span></div>
<div class="line"><span class="lineno"> 2500</span><span class="stringliteral">                            $_plaintext.= substr($_text, $_i, &#39;</span>.$block_size.<span class="stringliteral">&#39;) ^ $_xor;</span></div>
<div class="line"><span class="lineno"> 2501</span><span class="stringliteral">                        }</span></div>
<div class="line"><span class="lineno"> 2502</span><span class="stringliteral">                        $_key = $_xor;</span></div>
<div class="line"><span class="lineno"> 2503</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2504</span><span class="stringliteral">                    if ($self-&gt;continuousBuffer) {</span></div>
<div class="line"><span class="lineno"> 2505</span><span class="stringliteral">                        $self-&gt;decryptIV = $_xor;</span></div>
<div class="line"><span class="lineno"> 2506</span><span class="stringliteral">                        if ($_start = $_ciphertext_len % &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2507</span><span class="stringliteral">                             $_buffer[&quot;xor&quot;] = substr($_key, $_start) . $_buffer[&quot;xor&quot;];</span></div>
<div class="line"><span class="lineno"> 2508</span><span class="stringliteral">                        }</span></div>
<div class="line"><span class="lineno"> 2509</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2510</span><span class="stringliteral">                    return $_plaintext;</span></div>
<div class="line"><span class="lineno"> 2511</span><span class="stringliteral">                    &#39;</span>;</div>
<div class="line"><span class="lineno"> 2512</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2513</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#adaa3d4f69333325e047270ae0d58bcaa">CRYPT_MODE_STREAM</a>:</div>
<div class="line"><span class="lineno"> 2514</span>                $encrypt = $init_encrypt . <span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2515</span><span class="stringliteral">                    $_ciphertext = &quot;&quot;;</span></div>
<div class="line"><span class="lineno"> 2516</span><span class="stringliteral">                    &#39;</span>.$encrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2517</span><span class="stringliteral">                    return $_ciphertext;</span></div>
<div class="line"><span class="lineno"> 2518</span><span class="stringliteral">                    &#39;</span>;</div>
<div class="line"><span class="lineno"> 2519</span>                $decrypt = $init_decrypt . <span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2520</span><span class="stringliteral">                    $_plaintext = &quot;&quot;;</span></div>
<div class="line"><span class="lineno"> 2521</span><span class="stringliteral">                    &#39;</span>.$decrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2522</span><span class="stringliteral">                    return $_plaintext;</span></div>
<div class="line"><span class="lineno"> 2523</span><span class="stringliteral">                    &#39;</span>;</div>
<div class="line"><span class="lineno"> 2524</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2525</span>            <span class="comment">// case CRYPT_MODE_CBC:</span></div>
<div class="line"><span class="lineno"> 2526</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2527</span>                $encrypt = $init_encrypt . <span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2528</span><span class="stringliteral">                    $_ciphertext = &quot;&quot;;</span></div>
<div class="line"><span class="lineno"> 2529</span><span class="stringliteral">                    $_plaintext_len = strlen($_text);</span></div>
<div class="line"><span class="lineno"> 2530</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2531</span><span class="stringliteral">                    $in = $self-&gt;encryptIV;</span></div>
<div class="line"><span class="lineno"> 2532</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2533</span><span class="stringliteral">                    for ($_i = 0; $_i &lt; $_plaintext_len; $_i+= &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2534</span><span class="stringliteral">                        $in = substr($_text, $_i, &#39;</span>.$block_size.<span class="stringliteral">&#39;) ^ $in;</span></div>
<div class="line"><span class="lineno"> 2535</span><span class="stringliteral">                        &#39;</span>.$encrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2536</span><span class="stringliteral">                        $_ciphertext.= $in;</span></div>
<div class="line"><span class="lineno"> 2537</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2538</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2539</span><span class="stringliteral">                    if ($self-&gt;continuousBuffer) {</span></div>
<div class="line"><span class="lineno"> 2540</span><span class="stringliteral">                        $self-&gt;encryptIV = $in;</span></div>
<div class="line"><span class="lineno"> 2541</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2542</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2543</span><span class="stringliteral">                    return $_ciphertext;</span></div>
<div class="line"><span class="lineno"> 2544</span><span class="stringliteral">                    &#39;</span>;</div>
<div class="line"><span class="lineno"> 2545</span> </div>
<div class="line"><span class="lineno"> 2546</span>                $decrypt = $init_decrypt . <span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2547</span><span class="stringliteral">                    $_plaintext = &quot;&quot;;</span></div>
<div class="line"><span class="lineno"> 2548</span><span class="stringliteral">                    $_text = str_pad($_text, strlen($_text) + (&#39;</span>.$block_size.<span class="stringliteral">&#39; - strlen($_text) % &#39;</span>.$block_size.<span class="stringliteral">&#39;) % &#39;</span>.$block_size.<span class="stringliteral">&#39;, chr(0));</span></div>
<div class="line"><span class="lineno"> 2549</span><span class="stringliteral">                    $_ciphertext_len = strlen($_text);</span></div>
<div class="line"><span class="lineno"> 2550</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2551</span><span class="stringliteral">                    $_iv = $self-&gt;decryptIV;</span></div>
<div class="line"><span class="lineno"> 2552</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2553</span><span class="stringliteral">                    for ($_i = 0; $_i &lt; $_ciphertext_len; $_i+= &#39;</span>.$block_size.<span class="stringliteral">&#39;) {</span></div>
<div class="line"><span class="lineno"> 2554</span><span class="stringliteral">                        $in = $_block = substr($_text, $_i, &#39;</span>.$block_size.<span class="stringliteral">&#39;);</span></div>
<div class="line"><span class="lineno"> 2555</span><span class="stringliteral">                        &#39;</span>.$decrypt_block.<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="lineno"> 2556</span><span class="stringliteral">                        $_plaintext.= $in ^ $_iv;</span></div>
<div class="line"><span class="lineno"> 2557</span><span class="stringliteral">                        $_iv = $_block;</span></div>
<div class="line"><span class="lineno"> 2558</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2559</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2560</span><span class="stringliteral">                    if ($self-&gt;continuousBuffer) {</span></div>
<div class="line"><span class="lineno"> 2561</span><span class="stringliteral">                        $self-&gt;decryptIV = $_iv;</span></div>
<div class="line"><span class="lineno"> 2562</span><span class="stringliteral">                    }</span></div>
<div class="line"><span class="lineno"> 2563</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2564</span><span class="stringliteral">                    return $self-&gt;_unpad($_plaintext);</span></div>
<div class="line"><span class="lineno"> 2565</span><span class="stringliteral">                    &#39;</span>;</div>
<div class="line"><span class="lineno"> 2566</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2567</span>        }</div>
<div class="line"><span class="lineno"> 2568</span> </div>
<div class="line"><span class="lineno"> 2569</span>        <span class="comment">// Create the $inline function and return its name as string. Ready to run!</span></div>
<div class="line"><span class="lineno"> 2570</span>        <span class="keywordflow">if</span> (version_compare(<a class="code hl_variable" href="configtest_8php.html#a3c1ade165b70ecbf36a71bc64671334a">PHP_VERSION</a>, <span class="stringliteral">&#39;5.3.0&#39;</span>) &gt;= 0) {</div>
<div class="line"><span class="lineno"> 2571</span>            eval(<span class="stringliteral">&#39;$func = function ($_action, &amp;$self, $_text) { &#39;</span> . $init_crypt . <span class="stringliteral">&#39;if ($_action == &quot;encrypt&quot;) { &#39;</span> . $encrypt . <span class="stringliteral">&#39; } else { &#39;</span> . $decrypt . <span class="stringliteral">&#39; } };&#39;</span>);</div>
<div class="line"><span class="lineno"> 2572</span>            <span class="keywordflow">return</span> $func;</div>
<div class="line"><span class="lineno"> 2573</span>        }</div>
<div class="line"><span class="lineno"> 2574</span> </div>
<div class="line"><span class="lineno"> 2575</span>        <span class="keywordflow">return</span> create_function(<span class="stringliteral">&#39;$_action, &amp;$self, $_text&#39;</span>, $init_crypt . <span class="stringliteral">&#39;if ($_action == &quot;encrypt&quot;) { &#39;</span> . $encrypt . <span class="stringliteral">&#39; } else { &#39;</span> . $decrypt . <span class="stringliteral">&#39; }&#39;</span>);</div>
<div class="line"><span class="lineno"> 2576</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l00085">CRYPT_MODE_CFB</a>, <a class="el" href="Base_8php_source.html#l00067">CRYPT_MODE_CTR</a>, <a class="el" href="Base_8php_source.html#l00073">CRYPT_MODE_ECB</a>, <a class="el" href="Base_8php_source.html#l00091">CRYPT_MODE_OFB</a>, <a class="el" href="Base_8php_source.html#l00095">CRYPT_MODE_STREAM</a>, and <a class="el" href="configtest_8php_source.html#l00041">PHP_VERSION</a>.</p>

<p class="reference">Referenced by <a class="el" href="Blowfish_8php_source.html#l00535">Crypt_Blowfish\_setupInlineCrypt()</a>, <a class="el" href="DES_8php_source.html#l01363">Crypt_DES\_setupInlineCrypt()</a>, <a class="el" href="RC2_8php_source.html#l00631">Crypt_RC2\_setupInlineCrypt()</a>, <a class="el" href="Rijndael_8php_source.html#l00883">Crypt_Rijndael\_setupInlineCrypt()</a>, and <a class="el" href="Twofish_8php_source.html#l00747">Crypt_Twofish\_setupInlineCrypt()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a9f5b2f57acc58fa751fe7c826cd4ac6b_icgraph.png" border="0" usemap="#aclassCrypt__Base_a9f5b2f57acc58fa751fe7c826cd4ac6b_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a9f5b2f57acc58fa751fe7c826cd4ac6b_icgraph" id="aclassCrypt__Base_a9f5b2f57acc58fa751fe7c826cd4ac6b_icgraph">
<area shape="rect" title="Creates the performance&#45;optimized function for en/decrypt()" alt="" coords="261,119,457,145"/>
<area shape="rect" href="classCrypt__Blowfish.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="8,5,211,45"/>
<area shape="rect" href="classCrypt__DES.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="5,70,213,95"/>
<area shape="rect" href="classCrypt__RC2.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="5,119,213,145"/>
<area shape="rect" href="classCrypt__Rijndael.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="9,169,209,209"/>
<area shape="rect" href="classCrypt__Twofish.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="12,233,207,273"/>
</map>
</div>

</div>
</div>
<a id="a2a08218631ae2281ca8cf6032c34a843" name="a2a08218631ae2281ca8cf6032c34a843"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a08218631ae2281ca8cf6032c34a843">&#9670;&#160;</a></span>_decryptBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_decryptBlock </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts a block. </p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$in</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p>Reimplemented in <a class="el" href="classCrypt__Blowfish.html#a2a08218631ae2281ca8cf6032c34a843">Crypt_Blowfish</a>, <a class="el" href="classCrypt__DES.html#a2a08218631ae2281ca8cf6032c34a843">Crypt_DES</a>, <a class="el" href="classCrypt__RC2.html#a2a08218631ae2281ca8cf6032c34a843">Crypt_RC2</a>, <a class="el" href="classCrypt__Rijndael.html#a2a08218631ae2281ca8cf6032c34a843">Crypt_Rijndael</a>, and <a class="el" href="classCrypt__Twofish.html#a2a08218631ae2281ca8cf6032c34a843">Crypt_Twofish</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01779">1779</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1780</span>    {</div>
<div class="line"><span class="lineno"> 1781</span>        user_error((version_compare(<a class="code hl_variable" href="configtest_8php.html#a3c1ade165b70ecbf36a71bc64671334a">PHP_VERSION</a>, <span class="stringliteral">&#39;5.0.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>)  ? __METHOD__ : __FUNCTION__)  . <span class="stringliteral">&#39;() must extend by class &#39;</span> . get_class($this), E_USER_ERROR);</div>
<div class="line"><span class="lineno"> 1782</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="configtest_8php_source.html#l00041">PHP_VERSION</a>.</p>

<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l01050">decrypt()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a2a08218631ae2281ca8cf6032c34a843_icgraph.png" border="0" usemap="#aclassCrypt__Base_a2a08218631ae2281ca8cf6032c34a843_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a2a08218631ae2281ca8cf6032c34a843_icgraph" id="aclassCrypt__Base_a2a08218631ae2281ca8cf6032c34a843_icgraph">
<area shape="rect" title="Decrypts a block." alt="" coords="124,5,239,31"/>
<area shape="rect" href="classCrypt__Base.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="5,5,76,31"/>
</map>
</div>

</div>
</div>
<a id="adbb5f094cd3af568d05434b7a4b3e6e2" name="adbb5f094cd3af568d05434b7a4b3e6e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbb5f094cd3af568d05434b7a4b3e6e2">&#9670;&#160;</a></span>_encryptBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_encryptBlock </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts a block. </p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$in</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p>Reimplemented in <a class="el" href="classCrypt__Blowfish.html#adbb5f094cd3af568d05434b7a4b3e6e2">Crypt_Blowfish</a>, <a class="el" href="classCrypt__DES.html#adbb5f094cd3af568d05434b7a4b3e6e2">Crypt_DES</a>, <a class="el" href="classCrypt__RC2.html#adbb5f094cd3af568d05434b7a4b3e6e2">Crypt_RC2</a>, <a class="el" href="classCrypt__Rijndael.html#adbb5f094cd3af568d05434b7a4b3e6e2">Crypt_Rijndael</a>, and <a class="el" href="classCrypt__Twofish.html#adbb5f094cd3af568d05434b7a4b3e6e2">Crypt_Twofish</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01766">1766</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1767</span>    {</div>
<div class="line"><span class="lineno"> 1768</span>        user_error((version_compare(<a class="code hl_variable" href="configtest_8php.html#a3c1ade165b70ecbf36a71bc64671334a">PHP_VERSION</a>, <span class="stringliteral">&#39;5.0.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>)  ? __METHOD__ : __FUNCTION__)  . <span class="stringliteral">&#39;() must extend by class &#39;</span> . get_class($this), E_USER_ERROR);</div>
<div class="line"><span class="lineno"> 1769</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="configtest_8php_source.html#l00041">PHP_VERSION</a>.</p>

<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l01050">decrypt()</a>, and <a class="el" href="Base_8php_source.html#l00744">encrypt()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_adbb5f094cd3af568d05434b7a4b3e6e2_icgraph.png" border="0" usemap="#aclassCrypt__Base_adbb5f094cd3af568d05434b7a4b3e6e2_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_adbb5f094cd3af568d05434b7a4b3e6e2_icgraph" id="aclassCrypt__Base_adbb5f094cd3af568d05434b7a4b3e6e2_icgraph">
<area shape="rect" title="Encrypts a block." alt="" coords="124,31,239,56"/>
<area shape="rect" href="classCrypt__Base.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="5,5,76,31"/>
<area shape="rect" href="classCrypt__Base.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="5,55,76,80"/>
</map>
</div>

</div>
</div>
<a id="aa21f06db50fa687c83e85cc6c5549719" name="aa21f06db50fa687c83e85cc6c5549719"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa21f06db50fa687c83e85cc6c5549719">&#9670;&#160;</a></span>_getLambdaFunctions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">&amp; _getLambdaFunctions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Holds the lambda_functions table (classwide) </p>
<p>Each name of the lambda function, created from _setupInlineCrypt() &amp;&amp; _createInlineCryptFunction() is stored, classwide (!), here for reusing.</p>
<p>The string-based index of $function is a classwide unique value representing, at least, the $mode of operation (or more... depends of the optimizing level) for which $mode the lambda function was created.</p>
<p>@access private </p><dl class="section return"><dt>Returns</dt><dd>array &amp;$functions </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l02593">2593</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2594</span>    {</div>
<div class="line"><span class="lineno"> 2595</span>        <span class="keyword">static</span> $functions = array();</div>
<div class="line"><span class="lineno"> 2596</span>        <span class="keywordflow">return</span> $functions;</div>
<div class="line"><span class="lineno"> 2597</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Blowfish_8php_source.html#l00535">Crypt_Blowfish\_setupInlineCrypt()</a>, <a class="el" href="DES_8php_source.html#l01363">Crypt_DES\_setupInlineCrypt()</a>, <a class="el" href="RC2_8php_source.html#l00631">Crypt_RC2\_setupInlineCrypt()</a>, <a class="el" href="Rijndael_8php_source.html#l00883">Crypt_Rijndael\_setupInlineCrypt()</a>, and <a class="el" href="Twofish_8php_source.html#l00747">Crypt_Twofish\_setupInlineCrypt()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_aa21f06db50fa687c83e85cc6c5549719_icgraph.png" border="0" usemap="#aclassCrypt__Base_aa21f06db50fa687c83e85cc6c5549719_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_aa21f06db50fa687c83e85cc6c5549719_icgraph" id="aclassCrypt__Base_aa21f06db50fa687c83e85cc6c5549719_icgraph">
<area shape="rect" title="Holds the lambda_functions table (classwide)" alt="" coords="261,119,425,145"/>
<area shape="rect" href="classCrypt__Blowfish.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="8,5,211,45"/>
<area shape="rect" href="classCrypt__DES.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="5,70,213,95"/>
<area shape="rect" href="classCrypt__RC2.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="5,119,213,145"/>
<area shape="rect" href="classCrypt__Rijndael.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="9,169,209,209"/>
<area shape="rect" href="classCrypt__Twofish.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="12,233,207,273"/>
</map>
</div>

</div>
</div>
<a id="aaa64482022632c990a010c0f8772d4fe" name="aaa64482022632c990a010c0f8772d4fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa64482022632c990a010c0f8772d4fe">&#9670;&#160;</a></span>_hashInlineCryptFunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_hashInlineCryptFunction </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$bytes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a digest from $bytes. </p>
<dl class="section see"><dt>See also</dt><dd>self::_setupInlineCrypt() @access private </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$bytes</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l02607">2607</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2608</span>    {</div>
<div class="line"><span class="lineno"> 2609</span>        <span class="keywordflow">if</span> (!defined(<span class="stringliteral">&#39;CRYPT_BASE_WHIRLPOOL_AVAILABLE&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 2610</span>            define(<span class="stringliteral">&#39;CRYPT_BASE_WHIRLPOOL_AVAILABLE&#39;</span>, (<span class="keywordtype">bool</span>)(extension_loaded(<span class="stringliteral">&#39;hash&#39;</span>) &amp;&amp; in_array(<span class="stringliteral">&#39;whirlpool&#39;</span>, hash_algos())));</div>
<div class="line"><span class="lineno"> 2611</span>        }</div>
<div class="line"><span class="lineno"> 2612</span> </div>
<div class="line"><span class="lineno"> 2613</span>        $result = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 2614</span>        $hash = $bytes;</div>
<div class="line"><span class="lineno"> 2615</span> </div>
<div class="line"><span class="lineno"> 2616</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2617</span>            <span class="keywordflow">case</span> CRYPT_BASE_WHIRLPOOL_AVAILABLE:</div>
<div class="line"><span class="lineno"> 2618</span>                <span class="keywordflow">foreach</span> (str_split($bytes, 64) as $t) {</div>
<div class="line"><span class="lineno"> 2619</span>                    $hash = hash(<span class="stringliteral">&#39;whirlpool&#39;</span>, $hash, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2620</span>                    $result .= $t ^ $hash;</div>
<div class="line"><span class="lineno"> 2621</span>                }</div>
<div class="line"><span class="lineno"> 2622</span>                <span class="keywordflow">return</span> $result . hash(<span class="stringliteral">&#39;whirlpool&#39;</span>, $hash, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2623</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2624</span>                $len = strlen($bytes);</div>
<div class="line"><span class="lineno"> 2625</span>                <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; $i+=20) {</div>
<div class="line"><span class="lineno"> 2626</span>                    $t = substr($bytes, $i, 20);</div>
<div class="line"><span class="lineno"> 2627</span>                    $hash = pack(<span class="stringliteral">&#39;H*&#39;</span>, sha1($hash));</div>
<div class="line"><span class="lineno"> 2628</span>                    $result .= $t ^ $hash;</div>
<div class="line"><span class="lineno"> 2629</span>                }</div>
<div class="line"><span class="lineno"> 2630</span>                <span class="keywordflow">return</span> $result . pack(<span class="stringliteral">&#39;H*&#39;</span>, sha1($hash));</div>
<div class="line"><span class="lineno"> 2631</span>        }</div>
<div class="line"><span class="lineno"> 2632</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Blowfish_8php_source.html#l00535">Crypt_Blowfish\_setupInlineCrypt()</a>, <a class="el" href="DES_8php_source.html#l01363">Crypt_DES\_setupInlineCrypt()</a>, <a class="el" href="RC2_8php_source.html#l00631">Crypt_RC2\_setupInlineCrypt()</a>, <a class="el" href="Rijndael_8php_source.html#l00883">Crypt_Rijndael\_setupInlineCrypt()</a>, and <a class="el" href="Twofish_8php_source.html#l00747">Crypt_Twofish\_setupInlineCrypt()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_aaa64482022632c990a010c0f8772d4fe_icgraph.png" border="0" usemap="#aclassCrypt__Base_aaa64482022632c990a010c0f8772d4fe_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_aaa64482022632c990a010c0f8772d4fe_icgraph" id="aclassCrypt__Base_aaa64482022632c990a010c0f8772d4fe_icgraph">
<area shape="rect" title="Generates a digest from $bytes." alt="" coords="261,119,448,145"/>
<area shape="rect" href="classCrypt__Blowfish.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="8,5,211,45"/>
<area shape="rect" href="classCrypt__DES.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="5,70,213,95"/>
<area shape="rect" href="classCrypt__RC2.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="5,119,213,145"/>
<area shape="rect" href="classCrypt__Rijndael.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="9,169,209,209"/>
<area shape="rect" href="classCrypt__Twofish.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="12,233,207,273"/>
</map>
</div>

</div>
</div>
<a id="a412f868848015dec037f640c385f37be" name="a412f868848015dec037f640c385f37be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a412f868848015dec037f640c385f37be">&#9670;&#160;</a></span>_increment_str()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_increment_str </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$var</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Increment the current string. </p>
<dl class="section see"><dt>See also</dt><dd>self::decrypt() </dd>
<dd>
self::encrypt() </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$var</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l02010">2010</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2011</span>    {</div>
<div class="line"><span class="lineno"> 2012</span>        <span class="keywordflow">for</span> ($i = 4; $i &lt;= strlen($var); $i+= 4) {</div>
<div class="line"><span class="lineno"> 2013</span>            $temp = substr($var, -$i, 4);</div>
<div class="line"><span class="lineno"> 2014</span>            <span class="keywordflow">switch</span> ($temp) {</div>
<div class="line"><span class="lineno"> 2015</span>                <span class="keywordflow">case</span> <span class="stringliteral">&quot;\xFF\xFF\xFF\xFF&quot;</span>:</div>
<div class="line"><span class="lineno"> 2016</span>                    $var = substr_replace($var, <span class="stringliteral">&quot;\x00\x00\x00\x00&quot;</span>, -$i, 4);</div>
<div class="line"><span class="lineno"> 2017</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2018</span>                <span class="keywordflow">case</span> <span class="stringliteral">&quot;\x7F\xFF\xFF\xFF&quot;</span>:</div>
<div class="line"><span class="lineno"> 2019</span>                    $var = substr_replace($var, <span class="stringliteral">&quot;\x80\x00\x00\x00&quot;</span>, -$i, 4);</div>
<div class="line"><span class="lineno"> 2020</span>                    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2021</span>                <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2022</span>                    $temp = unpack(<span class="stringliteral">&#39;Nnum&#39;</span>, $temp);</div>
<div class="line"><span class="lineno"> 2023</span>                    $var = substr_replace($var, pack(<span class="charliteral">&#39;N&#39;</span>, $temp[<span class="stringliteral">&#39;num&#39;</span>] + 1), -$i, 4);</div>
<div class="line"><span class="lineno"> 2024</span>                    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2025</span>            }</div>
<div class="line"><span class="lineno"> 2026</span>        }</div>
<div class="line"><span class="lineno"> 2027</span> </div>
<div class="line"><span class="lineno"> 2028</span>        $remainder = strlen($var) % 4;</div>
<div class="line"><span class="lineno"> 2029</span> </div>
<div class="line"><span class="lineno"> 2030</span>        <span class="keywordflow">if</span> ($remainder == 0) {</div>
<div class="line"><span class="lineno"> 2031</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2032</span>        }</div>
<div class="line"><span class="lineno"> 2033</span> </div>
<div class="line"><span class="lineno"> 2034</span>        $temp = unpack(<span class="stringliteral">&#39;Nnum&#39;</span>, str_pad(substr($var, 0, $remainder), 4, <span class="stringliteral">&quot;\0&quot;</span>, STR_PAD_LEFT));</div>
<div class="line"><span class="lineno"> 2035</span>        $temp = substr(pack(<span class="charliteral">&#39;N&#39;</span>, $temp[<span class="stringliteral">&#39;num&#39;</span>] + 1), -$remainder);</div>
<div class="line"><span class="lineno"> 2036</span>        $var = substr_replace($var, $temp, 0, $remainder);</div>
<div class="line"><span class="lineno"> 2037</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l01351">_openssl_ctr_process()</a>, <a class="el" href="Base_8php_source.html#l01050">decrypt()</a>, and <a class="el" href="Base_8php_source.html#l00744">encrypt()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a412f868848015dec037f640c385f37be_icgraph.png" border="0" usemap="#aclassCrypt__Base_a412f868848015dec037f640c385f37be_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a412f868848015dec037f640c385f37be_icgraph" id="aclassCrypt__Base_a412f868848015dec037f640c385f37be_icgraph">
<area shape="rect" title="Increment the current string." alt="" coords="332,29,451,55"/>
<area shape="rect" href="classCrypt__Base.html#a7aaf3600e103d90572ffd029d81707d1" title="OpenSSL CTR Processor." alt="" coords="124,29,284,55"/>
<area shape="rect" href="classCrypt__Base.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="5,5,76,31"/>
<area shape="rect" href="classCrypt__Base.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="5,55,76,80"/>
</map>
</div>

</div>
</div>
<a id="a7aaf3600e103d90572ffd029d81707d1" name="a7aaf3600e103d90572ffd029d81707d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aaf3600e103d90572ffd029d81707d1">&#9670;&#160;</a></span>_openssl_ctr_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_openssl_ctr_process </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$plaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$encryptIV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>OpenSSL CTR Processor. </p>
<p>PHP's OpenSSL bindings do not operate in continuous mode so we'll wrap around it. Since the keystream for CTR is the same for both encrypting and decrypting this function is re-used by both Crypt_Base::encrypt() and Crypt_Base::decrypt(). Also, OpenSSL doesn't implement CTR for all of it's symmetric ciphers so this function will emulate CTR with ECB when necessary.</p>
<dl class="section see"><dt>See also</dt><dd>self::encrypt() </dd>
<dd>
self::decrypt() </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$plaintext</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$encryptIV</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$buffer</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string @access private </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01351">1351</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1352</span>    {</div>
<div class="line"><span class="lineno"> 1353</span>        $ciphertext = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1354</span> </div>
<div class="line"><span class="lineno"> 1355</span>        $block_size = $this-&gt;block_size;</div>
<div class="line"><span class="lineno"> 1356</span>        $key = $this-&gt;key;</div>
<div class="line"><span class="lineno"> 1357</span> </div>
<div class="line"><span class="lineno"> 1358</span>        <span class="keywordflow">if</span> ($this-&gt;openssl_emulate_ctr) {</div>
<div class="line"><span class="lineno"> 1359</span>            $xor = $encryptIV;</div>
<div class="line"><span class="lineno"> 1360</span>            <span class="keywordflow">if</span> (strlen($buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1361</span>                <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($plaintext); $i+=$block_size) {</div>
<div class="line"><span class="lineno"> 1362</span>                    $block = substr($plaintext, $i, $block_size);</div>
<div class="line"><span class="lineno"> 1363</span>                    <span class="keywordflow">if</span> (strlen($block) &gt; strlen($buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1364</span>                        $result = @openssl_encrypt($xor, $this-&gt;cipher_name_openssl_ecb, $key, $this-&gt;openssl_options);</div>
<div class="line"><span class="lineno"> 1365</span>                        $result = !defined(<span class="stringliteral">&#39;OPENSSL_RAW_DATA&#39;</span>) ? substr($result, 0, -$this-&gt;block_size) : $result;</div>
<div class="line"><span class="lineno"> 1366</span>                        $buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>].= $result;</div>
<div class="line"><span class="lineno"> 1367</span>                    }</div>
<div class="line"><span class="lineno"> 1368</span>                    $this-&gt;_increment_str($xor);</div>
<div class="line"><span class="lineno"> 1369</span>                    $otp = $this-&gt;_string_shift($buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>], $block_size);</div>
<div class="line"><span class="lineno"> 1370</span>                    $ciphertext.= $block ^ $otp;</div>
<div class="line"><span class="lineno"> 1371</span>                }</div>
<div class="line"><span class="lineno"> 1372</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1373</span>                <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($plaintext); $i+=<a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>) {</div>
<div class="line"><span class="lineno"> 1374</span>                    $block = substr($plaintext, $i, $block_size);</div>
<div class="line"><span class="lineno"> 1375</span>                    $otp = @openssl_encrypt($xor, $this-&gt;cipher_name_openssl_ecb, $key, $this-&gt;openssl_options);</div>
<div class="line"><span class="lineno"> 1376</span>                    $otp = !defined(<span class="stringliteral">&#39;OPENSSL_RAW_DATA&#39;</span>) ? substr($otp, 0, -$this-&gt;block_size) : $otp;</div>
<div class="line"><span class="lineno"> 1377</span>                    $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a412f868848015dec037f640c385f37be">_increment_str</a>($xor);</div>
<div class="line"><span class="lineno"> 1378</span>                    $ciphertext.= $block ^ $otp;</div>
<div class="line"><span class="lineno"> 1379</span>                }</div>
<div class="line"><span class="lineno"> 1380</span>            }</div>
<div class="line"><span class="lineno"> 1381</span>            <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1382</span>                <a class="code hl_variable" href="classCrypt__Base.html#a844b790c27e6ac5bed660f5f39b968a2">$encryptIV</a> = $xor;</div>
<div class="line"><span class="lineno"> 1383</span>                <span class="keywordflow">if</span> ($start = strlen($plaintext) % $block_size) {</div>
<div class="line"><span class="lineno"> 1384</span>                    $buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>] = substr($key, $start) . $buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>];</div>
<div class="line"><span class="lineno"> 1385</span>                }</div>
<div class="line"><span class="lineno"> 1386</span>            }</div>
<div class="line"><span class="lineno"> 1387</span> </div>
<div class="line"><span class="lineno"> 1388</span>            <span class="keywordflow">return</span> $ciphertext;</div>
<div class="line"><span class="lineno"> 1389</span>        }</div>
<div class="line"><span class="lineno"> 1390</span> </div>
<div class="line"><span class="lineno"> 1391</span>        <span class="keywordflow">if</span> (strlen($buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1392</span>            $ciphertext = $plaintext ^ $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>], strlen($plaintext));</div>
<div class="line"><span class="lineno"> 1393</span>            $plaintext = substr($plaintext, strlen($ciphertext));</div>
<div class="line"><span class="lineno"> 1394</span> </div>
<div class="line"><span class="lineno"> 1395</span>            <span class="keywordflow">if</span> (!strlen($plaintext)) {</div>
<div class="line"><span class="lineno"> 1396</span>                <span class="keywordflow">return</span> $ciphertext;</div>
<div class="line"><span class="lineno"> 1397</span>            }</div>
<div class="line"><span class="lineno"> 1398</span>        }</div>
<div class="line"><span class="lineno"> 1399</span> </div>
<div class="line"><span class="lineno"> 1400</span>        $overflow = strlen($plaintext) % <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>;</div>
<div class="line"><span class="lineno"> 1401</span>        <span class="keywordflow">if</span> ($overflow) {</div>
<div class="line"><span class="lineno"> 1402</span>            $plaintext2 = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a1cc0bf8f079a276e5d518ac53443fa31">_string_pop</a>($plaintext, $overflow); <span class="comment">// ie. trim $plaintext to a multiple of $block_size and put rest of $plaintext in $plaintext2</span></div>
<div class="line"><span class="lineno"> 1403</span>            $encrypted = openssl_encrypt($plaintext . str_repeat(<span class="stringliteral">&quot;\0&quot;</span>, $block_size), $this-&gt;cipher_name_openssl, $key, $this-&gt;openssl_options, $encryptIV);</div>
<div class="line"><span class="lineno"> 1404</span>            $temp = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a1cc0bf8f079a276e5d518ac53443fa31">_string_pop</a>($encrypted, $block_size);</div>
<div class="line"><span class="lineno"> 1405</span>            $ciphertext.= $encrypted . ($plaintext2 ^ $temp);</div>
<div class="line"><span class="lineno"> 1406</span>            <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1407</span>                $buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>] = substr($temp, $overflow);</div>
<div class="line"><span class="lineno"> 1408</span>                <a class="code hl_variable" href="classCrypt__Base.html#a844b790c27e6ac5bed660f5f39b968a2">$encryptIV</a> = $temp;</div>
<div class="line"><span class="lineno"> 1409</span>            }</div>
<div class="line"><span class="lineno"> 1410</span>        } elseif (!strlen($buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1411</span>            $ciphertext.= openssl_encrypt($plaintext . str_repeat(<span class="stringliteral">&quot;\0&quot;</span>, $block_size), $this-&gt;cipher_name_openssl, $key, $this-&gt;openssl_options, $encryptIV);</div>
<div class="line"><span class="lineno"> 1412</span>            $temp = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a1cc0bf8f079a276e5d518ac53443fa31">_string_pop</a>($ciphertext, $block_size);</div>
<div class="line"><span class="lineno"> 1413</span>            <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1414</span>                <a class="code hl_variable" href="classCrypt__Base.html#a844b790c27e6ac5bed660f5f39b968a2">$encryptIV</a> = $temp;</div>
<div class="line"><span class="lineno"> 1415</span>            }</div>
<div class="line"><span class="lineno"> 1416</span>        }</div>
<div class="line"><span class="lineno"> 1417</span>        <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1418</span>            <span class="keywordflow">if</span> (!defined(<span class="stringliteral">&#39;OPENSSL_RAW_DATA&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 1419</span>                <a class="code hl_variable" href="classCrypt__Base.html#a844b790c27e6ac5bed660f5f39b968a2">$encryptIV</a>.= @openssl_encrypt(<span class="stringliteral">&#39;&#39;</span>, $this-&gt;cipher_name_openssl_ecb, $key, $this-&gt;openssl_options);</div>
<div class="line"><span class="lineno"> 1420</span>            }</div>
<div class="line"><span class="lineno"> 1421</span>            <a class="code hl_variable" href="classCrypt__Base.html#a844b790c27e6ac5bed660f5f39b968a2">$encryptIV</a> = openssl_decrypt($encryptIV, $this-&gt;cipher_name_openssl_ecb, $key, $this-&gt;openssl_options);</div>
<div class="line"><span class="lineno"> 1422</span>            <span class="keywordflow">if</span> ($overflow) {</div>
<div class="line"><span class="lineno"> 1423</span>                $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a412f868848015dec037f640c385f37be">_increment_str</a>($encryptIV);</div>
<div class="line"><span class="lineno"> 1424</span>            }</div>
<div class="line"><span class="lineno"> 1425</span>        }</div>
<div class="line"><span class="lineno"> 1426</span> </div>
<div class="line"><span class="lineno"> 1427</span>        <span class="keywordflow">return</span> $ciphertext;</div>
<div class="line"><span class="lineno"> 1428</span>    }</div>
<div class="ttc" id="aclassCrypt__Base_html_a1cc0bf8f079a276e5d518ac53443fa31"><div class="ttname"><a href="classCrypt__Base.html#a1cc0bf8f079a276e5d518ac53443fa31">Crypt_Base\_string_pop</a></div><div class="ttdeci">_string_pop(&amp;$string, $index=1)</div><div class="ttdoc">String Pop.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l01995">Base.php:1995</a></div></div>
<div class="ttc" id="aclassCrypt__Base_html_a412f868848015dec037f640c385f37be"><div class="ttname"><a href="classCrypt__Base.html#a412f868848015dec037f640c385f37be">Crypt_Base\_increment_str</a></div><div class="ttdeci">_increment_str(&amp;$var)</div><div class="ttdoc">Increment the current string.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l02010">Base.php:2010</a></div></div>
<div class="ttc" id="aclassCrypt__Base_html_a844b790c27e6ac5bed660f5f39b968a2"><div class="ttname"><a href="classCrypt__Base.html#a844b790c27e6ac5bed660f5f39b968a2">Crypt_Base\$encryptIV</a></div><div class="ttdeci">$encryptIV</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00170">Base.php:170</a></div></div>
<div class="ttc" id="aclassCrypt__Base_html_ab009fa6f4ba09daa679a30e9b5bcfe35"><div class="ttname"><a href="classCrypt__Base.html#ab009fa6f4ba09daa679a30e9b5bcfe35">Crypt_Base\_string_shift</a></div><div class="ttdeci">_string_shift(&amp;$string, $index=1)</div><div class="ttdoc">String Shift.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l01978">Base.php:1978</a></div></div>
<div class="ttc" id="aclassCrypt__Base_html_ace0c858100bed2086051616b5c9f896e"><div class="ttname"><a href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">Crypt_Base\$block_size</a></div><div class="ttdeci">$block_size</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00142">Base.php:142</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l02010">_increment_str()</a>, <a class="el" href="Base_8php_source.html#l01995">_string_pop()</a>, and <a class="el" href="Base_8php_source.html#l01978">_string_shift()</a>.</p>

<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l01050">decrypt()</a>, and <a class="el" href="Base_8php_source.html#l00744">encrypt()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a7aaf3600e103d90572ffd029d81707d1_cgraph.png" border="0" usemap="#aclassCrypt__Base_a7aaf3600e103d90572ffd029d81707d1_cgraph" alt=""/></div>
<map name="aclassCrypt__Base_a7aaf3600e103d90572ffd029d81707d1_cgraph" id="aclassCrypt__Base_a7aaf3600e103d90572ffd029d81707d1_cgraph">
<area shape="rect" title="OpenSSL CTR Processor." alt="" coords="5,55,165,80"/>
<area shape="rect" href="classCrypt__Base.html#a412f868848015dec037f640c385f37be" title="Increment the current string." alt="" coords="213,5,332,31"/>
<area shape="rect" href="classCrypt__Base.html#a1cc0bf8f079a276e5d518ac53443fa31" title="String Pop." alt="" coords="224,55,321,80"/>
<area shape="rect" href="classCrypt__Base.html#ab009fa6f4ba09daa679a30e9b5bcfe35" title="String Shift." alt="" coords="222,104,323,129"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a7aaf3600e103d90572ffd029d81707d1_icgraph.png" border="0" usemap="#aclassCrypt__Base_a7aaf3600e103d90572ffd029d81707d1_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a7aaf3600e103d90572ffd029d81707d1_icgraph" id="aclassCrypt__Base_a7aaf3600e103d90572ffd029d81707d1_icgraph">
<area shape="rect" title="OpenSSL CTR Processor." alt="" coords="124,31,284,56"/>
<area shape="rect" href="classCrypt__Base.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="5,5,76,31"/>
<area shape="rect" href="classCrypt__Base.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="5,55,76,80"/>
</map>
</div>

</div>
</div>
<a id="ac1b2f723636fe01c4aa90fb201384110" name="ac1b2f723636fe01c4aa90fb201384110"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1b2f723636fe01c4aa90fb201384110">&#9670;&#160;</a></span>_openssl_ofb_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_openssl_ofb_process </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$plaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$encryptIV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>OpenSSL OFB Processor. </p>
<p>PHP's OpenSSL bindings do not operate in continuous mode so we'll wrap around it. Since the keystream for OFB is the same for both encrypting and decrypting this function is re-used by both Crypt_Base::encrypt() and Crypt_Base::decrypt().</p>
<dl class="section see"><dt>See also</dt><dd>self::encrypt() </dd>
<dd>
self::decrypt() </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$plaintext</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$encryptIV</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$buffer</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string @access private </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01445">1445</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1446</span>    {</div>
<div class="line"><span class="lineno"> 1447</span>        <span class="keywordflow">if</span> (strlen($buffer[<span class="stringliteral">&#39;xor&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1448</span>            $ciphertext = $plaintext ^ $buffer[<span class="stringliteral">&#39;xor&#39;</span>];</div>
<div class="line"><span class="lineno"> 1449</span>            $buffer[<span class="stringliteral">&#39;xor&#39;</span>] = substr($buffer[<span class="stringliteral">&#39;xor&#39;</span>], strlen($ciphertext));</div>
<div class="line"><span class="lineno"> 1450</span>            $plaintext = substr($plaintext, strlen($ciphertext));</div>
<div class="line"><span class="lineno"> 1451</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1452</span>            $ciphertext = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1453</span>        }</div>
<div class="line"><span class="lineno"> 1454</span> </div>
<div class="line"><span class="lineno"> 1455</span>        <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a> = $this-&gt;block_size;</div>
<div class="line"><span class="lineno"> 1456</span> </div>
<div class="line"><span class="lineno"> 1457</span>        $len = strlen($plaintext);</div>
<div class="line"><span class="lineno"> 1458</span>        <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a> = $this-&gt;key;</div>
<div class="line"><span class="lineno"> 1459</span>        $overflow = $len % <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>;</div>
<div class="line"><span class="lineno"> 1460</span> </div>
<div class="line"><span class="lineno"> 1461</span>        <span class="keywordflow">if</span> (strlen($plaintext)) {</div>
<div class="line"><span class="lineno"> 1462</span>            <span class="keywordflow">if</span> ($overflow) {</div>
<div class="line"><span class="lineno"> 1463</span>                $ciphertext.= openssl_encrypt(substr($plaintext, 0, -$overflow) . str_repeat(<span class="stringliteral">&quot;\0&quot;</span>, $block_size), $this-&gt;cipher_name_openssl, $key, $this-&gt;openssl_options, $encryptIV);</div>
<div class="line"><span class="lineno"> 1464</span>                $xor = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a1cc0bf8f079a276e5d518ac53443fa31">_string_pop</a>($ciphertext, $block_size);</div>
<div class="line"><span class="lineno"> 1465</span>                <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1466</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a844b790c27e6ac5bed660f5f39b968a2">$encryptIV</a> = $xor;</div>
<div class="line"><span class="lineno"> 1467</span>                }</div>
<div class="line"><span class="lineno"> 1468</span>                $ciphertext.= $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($xor, $overflow) ^ substr($plaintext, -$overflow);</div>
<div class="line"><span class="lineno"> 1469</span>                <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1470</span>                    $buffer[<span class="stringliteral">&#39;xor&#39;</span>] = $xor;</div>
<div class="line"><span class="lineno"> 1471</span>                }</div>
<div class="line"><span class="lineno"> 1472</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1473</span>                $ciphertext = openssl_encrypt($plaintext, $this-&gt;cipher_name_openssl, $key, $this-&gt;openssl_options, $encryptIV);</div>
<div class="line"><span class="lineno"> 1474</span>                <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1475</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a844b790c27e6ac5bed660f5f39b968a2">$encryptIV</a> = substr($ciphertext, -$block_size) ^ substr($plaintext, -$block_size);</div>
<div class="line"><span class="lineno"> 1476</span>                }</div>
<div class="line"><span class="lineno"> 1477</span>            }</div>
<div class="line"><span class="lineno"> 1478</span>        }</div>
<div class="line"><span class="lineno"> 1479</span> </div>
<div class="line"><span class="lineno"> 1480</span>        <span class="keywordflow">return</span> $ciphertext;</div>
<div class="line"><span class="lineno"> 1481</span>    }</div>
<div class="ttc" id="aclassCrypt__Base_html_aa60b0284e0dfa2463495481cf11e3cf4"><div class="ttname"><a href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">Crypt_Base\$key</a></div><div class="ttdeci">$key</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00151">Base.php:151</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l01995">_string_pop()</a>, and <a class="el" href="Base_8php_source.html#l01978">_string_shift()</a>.</p>

<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l01050">decrypt()</a>, and <a class="el" href="Base_8php_source.html#l00744">encrypt()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_ac1b2f723636fe01c4aa90fb201384110_cgraph.png" border="0" usemap="#aclassCrypt__Base_ac1b2f723636fe01c4aa90fb201384110_cgraph" alt=""/></div>
<map name="aclassCrypt__Base_ac1b2f723636fe01c4aa90fb201384110_cgraph" id="aclassCrypt__Base_ac1b2f723636fe01c4aa90fb201384110_cgraph">
<area shape="rect" title="OpenSSL OFB Processor." alt="" coords="5,31,169,56"/>
<area shape="rect" href="classCrypt__Base.html#a1cc0bf8f079a276e5d518ac53443fa31" title="String Pop." alt="" coords="219,5,317,31"/>
<area shape="rect" href="classCrypt__Base.html#ab009fa6f4ba09daa679a30e9b5bcfe35" title="String Shift." alt="" coords="217,55,319,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_ac1b2f723636fe01c4aa90fb201384110_icgraph.png" border="0" usemap="#aclassCrypt__Base_ac1b2f723636fe01c4aa90fb201384110_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_ac1b2f723636fe01c4aa90fb201384110_icgraph" id="aclassCrypt__Base_ac1b2f723636fe01c4aa90fb201384110_icgraph">
<area shape="rect" title="OpenSSL OFB Processor." alt="" coords="124,31,288,56"/>
<area shape="rect" href="classCrypt__Base.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="5,5,76,31"/>
<area shape="rect" href="classCrypt__Base.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="5,55,76,80"/>
</map>
</div>

</div>
</div>
<a id="a96914544ec7c29ea559ad31c12694edd" name="a96914544ec7c29ea559ad31c12694edd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96914544ec7c29ea559ad31c12694edd">&#9670;&#160;</a></span>_openssl_translate_mode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_openssl_translate_mode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>phpseclib &lt;-&gt; OpenSSL Mode Mapper </p>
<p>May need to be overwritten by classes extending this one in some cases</p>
<dl class="section return"><dt>Returns</dt><dd>int @access private </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01491">1491</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1492</span>    {</div>
<div class="line"><span class="lineno"> 1493</span>        <span class="keywordflow">switch</span> ($this-&gt;mode) {</div>
<div class="line"><span class="lineno"> 1494</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#ace7687420bc69da6192bc40c8a061804">CRYPT_MODE_ECB</a>:</div>
<div class="line"><span class="lineno"> 1495</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;ecb&#39;</span>;</div>
<div class="line"><span class="lineno"> 1496</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a766af87a1190a65dd937ce94ef962400">CRYPT_MODE_CBC</a>:</div>
<div class="line"><span class="lineno"> 1497</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;cbc&#39;</span>;</div>
<div class="line"><span class="lineno"> 1498</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a4204f1d2beaf41a2b97967cbea0ef666">CRYPT_MODE_CTR</a>:</div>
<div class="line"><span class="lineno"> 1499</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;ctr&#39;</span>;</div>
<div class="line"><span class="lineno"> 1500</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#aa1a1e45bef3380f6e5c0a1c8fa4dad46">CRYPT_MODE_CFB</a>:</div>
<div class="line"><span class="lineno"> 1501</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;cfb&#39;</span>;</div>
<div class="line"><span class="lineno"> 1502</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#af9423638549fc5c52db69b66560614ef">CRYPT_MODE_OFB</a>:</div>
<div class="line"><span class="lineno"> 1503</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;ofb&#39;</span>;</div>
<div class="line"><span class="lineno"> 1504</span>        }</div>
<div class="line"><span class="lineno"> 1505</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l00079">CRYPT_MODE_CBC</a>, <a class="el" href="Base_8php_source.html#l00085">CRYPT_MODE_CFB</a>, <a class="el" href="Base_8php_source.html#l00067">CRYPT_MODE_CTR</a>, <a class="el" href="Base_8php_source.html#l00073">CRYPT_MODE_ECB</a>, and <a class="el" href="Base_8php_source.html#l00091">CRYPT_MODE_OFB</a>.</p>

<p class="reference">Referenced by <a class="el" href="Blowfish_8php_source.html#l00390">Crypt_Blowfish\isValidEngine()</a>, <a class="el" href="DES_8php_source.html#l00664">Crypt_DES\isValidEngine()</a>, <a class="el" href="RC2_8php_source.html#l00345">Crypt_RC2\isValidEngine()</a>, <a class="el" href="Rijndael_8php_source.html#l00360">Crypt_Rijndael\isValidEngine()</a>, and <a class="el" href="TripleDES_8php_source.html#l00248">Crypt_TripleDES\isValidEngine()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a96914544ec7c29ea559ad31c12694edd_icgraph.png" border="0" usemap="#aclassCrypt__Base_a96914544ec7c29ea559ad31c12694edd_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a96914544ec7c29ea559ad31c12694edd_icgraph" id="aclassCrypt__Base_a96914544ec7c29ea559ad31c12694edd_icgraph">
<area shape="rect" title="phpseclib &lt;&#45;&gt; OpenSSL Mode Mapper" alt="" coords="269,104,457,129"/>
<area shape="rect" href="classCrypt__Blowfish.html#ae62f456da9bef718ecc3e155d63f0dc8" title="Test for engine validity." alt="" coords="8,5,219,31"/>
<area shape="rect" href="classCrypt__DES.html#ae62f456da9bef718ecc3e155d63f0dc8" title="Test for engine validity." alt="" coords="23,55,204,80"/>
<area shape="rect" href="classCrypt__RC2.html#ae62f456da9bef718ecc3e155d63f0dc8" title="Test for engine validity." alt="" coords="23,104,204,129"/>
<area shape="rect" href="classCrypt__Rijndael.html#ae62f456da9bef718ecc3e155d63f0dc8" title="Test for engine validity." alt="" coords="9,153,217,179"/>
<area shape="rect" href="classCrypt__TripleDES.html#ae62f456da9bef718ecc3e155d63f0dc8" title="Test for engine validity." alt="" coords="5,203,221,228"/>
</map>
</div>

</div>
</div>
<a id="a2dc8c16ec5951b4037a7b36a5a6c4bcd" name="a2dc8c16ec5951b4037a7b36a5a6c4bcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dc8c16ec5951b4037a7b36a5a6c4bcd">&#9670;&#160;</a></span>_pad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_pad </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$text</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pads a string. </p>
<p>Pads a string using the RSA PKCS padding standards so that its length is a multiple of the blocksize. $this-&gt;block_size - (strlen($text) % $this-&gt;block_size) bytes are added, each of which is equal to chr($this-&gt;block_size - (strlen($text) % $this-&gt;block_size)</p>
<p>If padding is disabled and $text is not a multiple of the blocksize, the string will be padded regardless and padding will, hence forth, be enabled.</p>
<dl class="section see"><dt>See also</dt><dd>self::_unpad() </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$text</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01901">1901</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1902</span>    {</div>
<div class="line"><span class="lineno"> 1903</span>        $length = strlen($text);</div>
<div class="line"><span class="lineno"> 1904</span> </div>
<div class="line"><span class="lineno"> 1905</span>        <span class="keywordflow">if</span> (!$this-&gt;padding) {</div>
<div class="line"><span class="lineno"> 1906</span>            <span class="keywordflow">if</span> ($length % $this-&gt;block_size == 0) {</div>
<div class="line"><span class="lineno"> 1907</span>                <span class="keywordflow">return</span> $text;</div>
<div class="line"><span class="lineno"> 1908</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1909</span>                user_error(<span class="stringliteral">&quot;The plaintext&#39;s length ($length) is not a multiple of the block size ({$this-&gt;block_size})&quot;</span>);</div>
<div class="line"><span class="lineno"> 1910</span>                $this-&gt;padding = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1911</span>            }</div>
<div class="line"><span class="lineno"> 1912</span>        }</div>
<div class="line"><span class="lineno"> 1913</span> </div>
<div class="line"><span class="lineno"> 1914</span>        $pad = $this-&gt;block_size - ($length % $this-&gt;block_size);</div>
<div class="line"><span class="lineno"> 1915</span> </div>
<div class="line"><span class="lineno"> 1916</span>        <span class="keywordflow">return</span> str_pad($text, $length + $pad, chr($pad));</div>
<div class="line"><span class="lineno"> 1917</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l00744">encrypt()</a>, and <a class="el" href="TripleDES_8php_source.html#l00352">Crypt_TripleDES\encrypt()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a2dc8c16ec5951b4037a7b36a5a6c4bcd_icgraph.png" border="0" usemap="#aclassCrypt__Base_a2dc8c16ec5951b4037a7b36a5a6c4bcd_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a2dc8c16ec5951b4037a7b36a5a6c4bcd_icgraph" id="aclassCrypt__Base_a2dc8c16ec5951b4037a7b36a5a6c4bcd_icgraph">
<area shape="rect" title="Pads a string." alt="" coords="459,43,512,68"/>
<area shape="rect" href="classCrypt__Base.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="286,5,357,31"/>
<area shape="rect" href="classCrypt__TripleDES.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="232,79,411,104"/>
<area shape="rect" href="classCrypt__TripleDES.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="5,79,184,104"/>
</map>
</div>

</div>
</div>
<a id="ab4e58314adec23125fc08ae86aa501e3" name="ab4e58314adec23125fc08ae86aa501e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4e58314adec23125fc08ae86aa501e3">&#9670;&#160;</a></span>_setEngine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_setEngine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the engine as appropriate. </p>
<dl class="section see"><dt>See also</dt><dd>self::Crypt_Base() @access private </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01720">1720</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1721</span>    {</div>
<div class="line"><span class="lineno"> 1722</span>        $this-&gt;engine = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1723</span> </div>
<div class="line"><span class="lineno"> 1724</span>        $candidateEngines = array(</div>
<div class="line"><span class="lineno"> 1725</span>            $this-&gt;preferredEngine,</div>
<div class="line"><span class="lineno"> 1726</span>            <a class="code hl_variable" href="Base_8php.html#a8f1200db8ddce5bab18ddeec03362215">CRYPT_ENGINE_OPENSSL</a>,</div>
<div class="line"><span class="lineno"> 1727</span>            <a class="code hl_variable" href="Base_8php.html#aec1c8f2a4ace0050f6457c9c61bf8310">CRYPT_ENGINE_MCRYPT</a></div>
<div class="line"><span class="lineno"> 1728</span>        );</div>
<div class="line"><span class="lineno"> 1729</span>        <span class="keywordflow">foreach</span> ($candidateEngines as $engine) {</div>
<div class="line"><span class="lineno"> 1730</span>            <span class="keywordflow">if</span> ($this-&gt;isValidEngine($engine)) {</div>
<div class="line"><span class="lineno"> 1731</span>                $this-&gt;engine = $engine;</div>
<div class="line"><span class="lineno"> 1732</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1733</span>            }</div>
<div class="line"><span class="lineno"> 1734</span>        }</div>
<div class="line"><span class="lineno"> 1735</span>        <span class="keywordflow">if</span> (!$this-&gt;engine) {</div>
<div class="line"><span class="lineno"> 1736</span>            $this-&gt;engine = <a class="code hl_variable" href="Base_8php.html#a02836fb7d55f32f31941fa9ecddbd8fc">CRYPT_ENGINE_INTERNAL</a>;</div>
<div class="line"><span class="lineno"> 1737</span>        }</div>
<div class="line"><span class="lineno"> 1738</span> </div>
<div class="line"><span class="lineno"> 1739</span>        <span class="keywordflow">if</span> ($this-&gt;engine != <a class="code hl_variable" href="Base_8php.html#aec1c8f2a4ace0050f6457c9c61bf8310">CRYPT_ENGINE_MCRYPT</a> &amp;&amp; $this-&gt;enmcrypt) {</div>
<div class="line"><span class="lineno"> 1740</span>            set_error_handler(array($this, <span class="stringliteral">&#39;do_nothing&#39;</span>));</div>
<div class="line"><span class="lineno"> 1741</span>            <span class="comment">// Closing the current mcrypt resource(s). _mcryptSetup() will, if needed,</span></div>
<div class="line"><span class="lineno"> 1742</span>            <span class="comment">// (re)open them with the module named in $this-&gt;cipher_name_mcrypt</span></div>
<div class="line"><span class="lineno"> 1743</span>            mcrypt_module_close($this-&gt;enmcrypt);</div>
<div class="line"><span class="lineno"> 1744</span>            mcrypt_module_close($this-&gt;demcrypt);</div>
<div class="line"><span class="lineno"> 1745</span>            $this-&gt;enmcrypt = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1746</span>            $this-&gt;demcrypt = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1747</span> </div>
<div class="line"><span class="lineno"> 1748</span>            <span class="keywordflow">if</span> ($this-&gt;ecb) {</div>
<div class="line"><span class="lineno"> 1749</span>                mcrypt_module_close($this-&gt;ecb);</div>
<div class="line"><span class="lineno"> 1750</span>                $this-&gt;ecb = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1751</span>            }</div>
<div class="line"><span class="lineno"> 1752</span>            restore_error_handler();</div>
<div class="line"><span class="lineno"> 1753</span>        }</div>
<div class="line"><span class="lineno"> 1754</span> </div>
<div class="line"><span class="lineno"> 1755</span>        $this-&gt;changed = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1756</span>    }</div>
<div class="ttc" id="aBase_8php_html_a02836fb7d55f32f31941fa9ecddbd8fc"><div class="ttname"><a href="Base_8php.html#a02836fb7d55f32f31941fa9ecddbd8fc">CRYPT_ENGINE_INTERNAL</a></div><div class="ttdeci">const CRYPT_ENGINE_INTERNAL</div><div class="ttdoc">#-</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00106">Base.php:106</a></div></div>
<div class="ttc" id="aBase_8php_html_a8f1200db8ddce5bab18ddeec03362215"><div class="ttname"><a href="Base_8php.html#a8f1200db8ddce5bab18ddeec03362215">CRYPT_ENGINE_OPENSSL</a></div><div class="ttdeci">const CRYPT_ENGINE_OPENSSL</div><div class="ttdoc">Base value for the OpenSSL implementation $engine switch.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00114">Base.php:114</a></div></div>
<div class="ttc" id="aBase_8php_html_aec1c8f2a4ace0050f6457c9c61bf8310"><div class="ttname"><a href="Base_8php.html#aec1c8f2a4ace0050f6457c9c61bf8310">CRYPT_ENGINE_MCRYPT</a></div><div class="ttdeci">const CRYPT_ENGINE_MCRYPT</div><div class="ttdoc">Base value for the mcrypt implementation $engine switch.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00110">Base.php:110</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l00106">CRYPT_ENGINE_INTERNAL</a>, <a class="el" href="Base_8php_source.html#l00110">CRYPT_ENGINE_MCRYPT</a>, <a class="el" href="Base_8php_source.html#l00114">CRYPT_ENGINE_OPENSSL</a>, and <a class="el" href="Base_8php_source.html#l01619">isValidEngine()</a>.</p>

<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l00506">__construct()</a>, <a class="el" href="Base_8php_source.html#l01596">disableContinuousBuffer()</a>, <a class="el" href="Base_8php_source.html#l01576">enableContinuousBuffer()</a>, <a class="el" href="Rijndael_8php_source.html#l00336">Crypt_Rijndael\setBlockLength()</a>, <a class="el" href="AES_8php_source.html#l00178">Crypt_AES\setKey()</a>, <a class="el" href="Base_8php_source.html#l00617">setKey()</a>, <a class="el" href="Base_8php_source.html#l00574">setKeyLength()</a>, and <a class="el" href="Base_8php_source.html#l01688">setPreferredEngine()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_ab4e58314adec23125fc08ae86aa501e3_cgraph.png" border="0" usemap="#aclassCrypt__Base_ab4e58314adec23125fc08ae86aa501e3_cgraph" alt=""/></div>
<map name="aclassCrypt__Base_ab4e58314adec23125fc08ae86aa501e3_cgraph" id="aclassCrypt__Base_ab4e58314adec23125fc08ae86aa501e3_cgraph">
<area shape="rect" title="Sets the engine as appropriate." alt="" coords="5,5,99,31"/>
<area shape="rect" href="classCrypt__Base.html#ae62f456da9bef718ecc3e155d63f0dc8" title="Test for engine validity." alt="" coords="147,5,256,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_ab4e58314adec23125fc08ae86aa501e3_icgraph.png" border="0" usemap="#aclassCrypt__Base_ab4e58314adec23125fc08ae86aa501e3_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_ab4e58314adec23125fc08ae86aa501e3_icgraph" id="aclassCrypt__Base_ab4e58314adec23125fc08ae86aa501e3_icgraph">
<area shape="rect" title="Sets the engine as appropriate." alt="" coords="569,179,663,204"/>
<area shape="rect" href="classCrypt__Base.html#a7f343b63c2a2441c661bb6f07553643f" title="Default Constructor." alt="" coords="363,5,459,31"/>
<area shape="rect" href="classCrypt__Base.html#abfa3ada55a183bec17f12b630f8cfac5" title="Treat consecutive packets as if they are a discontinuous buffer." alt="" coords="320,55,501,80"/>
<area shape="rect" href="classCrypt__Base.html#ab8ff793379f109d2e0f62e942c1c5ba5" title="Treat consecutive &quot;packets&quot; as if they are a continuous buffer." alt="" coords="321,104,500,129"/>
<area shape="rect" href="classCrypt__Rijndael.html#accc1879e7ebe30027584aaefa387461b" title="Sets the block length." alt="" coords="300,153,521,179"/>
<area shape="rect" href="classCrypt__AES.html#a9afc10d017d5c65d3e6a941f65cf1904" title="Sets the key." alt="" coords="342,203,479,228"/>
<area shape="rect" href="classCrypt__Base.html#a9afc10d017d5c65d3e6a941f65cf1904" title="Sets the key." alt="" coords="171,279,237,304"/>
<area shape="rect" href="classCrypt__Base.html#a213d72f64ec9f940548d56d3c9df7457" title="Sets the key length." alt="" coords="355,304,466,329"/>
<area shape="rect" href="classCrypt__Base.html#a1082dc0f46d62a6aaa2bf8088c521bfd" title="Sets the preferred crypt engine." alt="" coords="337,353,484,379"/>
<area shape="rect" href="classCrypt__Base.html#a6a80cab2d9e4f3091d06f0393cb3faf8" title="PHP4 compatible Default Constructor." alt="" coords="156,5,252,31"/>
<area shape="rect" href="classCrypt__Base.html#abee03ea49c9f963f2e40adf6f53a33fa" title="Sets the password." alt="" coords="5,279,108,304"/>
</map>
</div>

</div>
</div>
<a id="a893edf931eab08c67a70d2e93bbf8c11" name="a893edf931eab08c67a70d2e93bbf8c11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a893edf931eab08c67a70d2e93bbf8c11">&#9670;&#160;</a></span>_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup the CRYPT_ENGINE_INTERNAL $engine. </p>
<p>(re)init, if necessary, the internal cipher $engine and flush all $buffers Used (only) if $engine == CRYPT_ENGINE_INTERNAL</p>
<p>_setup() will be called each time if $changed === true typically this happens when using one or more of following public methods:</p>
<ul>
<li>setKey()</li>
<li>setIV()</li>
<li>disableContinuousBuffer()</li>
<li>First run of encrypt() / decrypt() with no init-settings</li>
</ul>
<dl class="section see"><dt>See also</dt><dd>self::setKey() </dd>
<dd>
self::setIV() </dd>
<dd>
self::disableContinuousBuffer() @access private </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01822">1822</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1823</span>    {</div>
<div class="line"><span class="lineno"> 1824</span>        $this-&gt;_clearBuffers();</div>
<div class="line"><span class="lineno"> 1825</span>        $this-&gt;_setupKey();</div>
<div class="line"><span class="lineno"> 1826</span> </div>
<div class="line"><span class="lineno"> 1827</span>        <span class="keywordflow">if</span> ($this-&gt;use_inline_crypt) {</div>
<div class="line"><span class="lineno"> 1828</span>            $this-&gt;_setupInlineCrypt();</div>
<div class="line"><span class="lineno"> 1829</span>        }</div>
<div class="line"><span class="lineno"> 1830</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l01955">_clearBuffers()</a>, <a class="el" href="Base_8php_source.html#l02099">_setupInlineCrypt()</a>, and <a class="el" href="Base_8php_source.html#l01793">_setupKey()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RC4_8php_source.html#l00334">Crypt_RC4\_crypt()</a>, <a class="el" href="Base_8php_source.html#l01050">decrypt()</a>, and <a class="el" href="Base_8php_source.html#l00744">encrypt()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a893edf931eab08c67a70d2e93bbf8c11_cgraph.png" border="0" usemap="#aclassCrypt__Base_a893edf931eab08c67a70d2e93bbf8c11_cgraph" alt=""/></div>
<map name="aclassCrypt__Base_a893edf931eab08c67a70d2e93bbf8c11_cgraph" id="aclassCrypt__Base_a893edf931eab08c67a70d2e93bbf8c11_cgraph">
<area shape="rect" title="Setup the CRYPT_ENGINE_INTERNAL $engine." alt="" coords="5,55,71,80"/>
<area shape="rect" href="classCrypt__Base.html#a1a87457f321c145b43893358a820f55a" title="Clears internal buffers." alt="" coords="133,5,240,31"/>
<area shape="rect" href="classCrypt__Base.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="119,55,255,80"/>
<area shape="rect" href="classCrypt__Base.html#aad783e9c1c4fc5e3d8e312f08dd36f68" title="Setup the key (expansion)" alt="" coords="142,104,231,129"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a893edf931eab08c67a70d2e93bbf8c11_icgraph.png" border="0" usemap="#aclassCrypt__Base_a893edf931eab08c67a70d2e93bbf8c11_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a893edf931eab08c67a70d2e93bbf8c11_icgraph" id="aclassCrypt__Base_a893edf931eab08c67a70d2e93bbf8c11_icgraph">
<area shape="rect" title="Setup the CRYPT_ENGINE_INTERNAL $engine." alt="" coords="379,79,444,104"/>
<area shape="rect" href="classCrypt__RC4.html#a4edc74894fc45ad50de5f65a2ce3c509" title="Encrypts or decrypts a message." alt="" coords="196,29,331,55"/>
<area shape="rect" href="classCrypt__Base.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="228,79,299,104"/>
<area shape="rect" href="classCrypt__Base.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="228,128,299,153"/>
<area shape="rect" href="classCrypt__RC4.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="5,5,148,31"/>
<area shape="rect" href="classCrypt__RC4.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="5,55,148,80"/>
</map>
</div>

</div>
</div>
<a id="a08e325f5762546ed7646eb4e79835026" name="a08e325f5762546ed7646eb4e79835026"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08e325f5762546ed7646eb4e79835026">&#9670;&#160;</a></span>_setupInlineCrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_setupInlineCrypt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup the performance-optimized function for de/encrypt() </p>
<p>Stores the created (or existing) callback function-name in $this-&gt;inline_crypt</p>
<p>Internally for phpseclib developers: </p><pre class="fragment">_setupInlineCrypt() would be called only if:

- $engine == CRYPT_ENGINE_INTERNAL and

- $use_inline_crypt === true

- each time on _setup(), after(!) _setupKey()


This ensures that _setupInlineCrypt() has always a
full ready2go initializated internal cipher $engine state
where, for example, the keys allready expanded,
keys/block_size calculated and such.

It is, each time if called, the responsibility of _setupInlineCrypt():

- to set $this-&gt;inline_crypt to a valid and fully working callback function
  as a (faster) replacement for encrypt() / decrypt()

- NOT to create unlimited callback functions (for memory reasons!)
  no matter how often _setupInlineCrypt() would be called. At some
  point of amount they must be generic re-useable.

- the code of _setupInlineCrypt() it self,
  and the generated callback code,
  must be, in following order:
  - 100% safe
  - 100% compatible to encrypt()/decrypt()
  - using only php5+ features/lang-constructs/php-extensions if
    compatibility (down to php4) or fallback is provided
  - readable/maintainable/understandable/commented and... not-cryptic-styled-code :-)
  - &gt;= 10% faster than encrypt()/decrypt() [which is, by the way,
    the reason for the existence of _setupInlineCrypt() :-)]
  - memory-nice
  - short (as good as possible)
</pre><p> Note: - <em>setupInlineCrypt() is using _createInlineCryptFunction() to create the full callback function code.</p><ul>
<li>In case of using inline crypting, _setupInlineCrypt() must extend by the child Crypt* class.</li>
<li>The following variable names are reserved:<ul>
<li>$_* (all variable names prefixed with an underscore)</li>
<li>$self (object reference to it self. Do not use $this, but $self instead)</li>
<li>$in (the content of $in has to en/decrypt by the generated code)</li>
</ul>
</li>
<li>The callback function should not use the 'return' statement, but en/decrypt'ing the content of $in only</li>
</ul>
<p></em></p>
<p><em></p><dl class="section see"><dt>See also</dt><dd>self::_setup() </dd>
<dd>
self::_createInlineCryptFunction() </dd>
<dd>
self::encrypt() </dd>
<dd>
self::decrypt() @access private </dd></dl>
<p></em></p>

<p>Reimplemented in <a class="el" href="classCrypt__Blowfish.html#a08e325f5762546ed7646eb4e79835026">Crypt_Blowfish</a>, <a class="el" href="classCrypt__DES.html#a08e325f5762546ed7646eb4e79835026">Crypt_DES</a>, <a class="el" href="classCrypt__RC2.html#a08e325f5762546ed7646eb4e79835026">Crypt_RC2</a>, <a class="el" href="classCrypt__Rijndael.html#a08e325f5762546ed7646eb4e79835026">Crypt_Rijndael</a>, and <a class="el" href="classCrypt__Twofish.html#a08e325f5762546ed7646eb4e79835026">Crypt_Twofish</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l02099">2099</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2100</span>    {</div>
<div class="line"><span class="lineno"> 2101</span>        <span class="comment">// If, for any reason, an extending Crypt_Base() Crypt_* class</span></div>
<div class="line"><span class="lineno"> 2102</span>        <span class="comment">// not using inline crypting then it must be ensured that: $this-&gt;use_inline_crypt = false</span></div>
<div class="line"><span class="lineno"> 2103</span>        <span class="comment">// ie in the class var declaration of $use_inline_crypt in general for the Crypt_* class,</span></div>
<div class="line"><span class="lineno"> 2104</span>        <span class="comment">// in the constructor at object instance-time</span></div>
<div class="line"><span class="lineno"> 2105</span>        <span class="comment">// or, if it&#39;s runtime-specific, at runtime</span></div>
<div class="line"><span class="lineno"> 2106</span> </div>
<div class="line"><span class="lineno"> 2107</span>        $this-&gt;use_inline_crypt = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2108</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l01822">_setup()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a08e325f5762546ed7646eb4e79835026_icgraph.png" border="0" usemap="#aclassCrypt__Base_a08e325f5762546ed7646eb4e79835026_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a08e325f5762546ed7646eb4e79835026_icgraph" id="aclassCrypt__Base_a08e325f5762546ed7646eb4e79835026_icgraph">
<area shape="rect" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="492,79,628,104"/>
<area shape="rect" href="classCrypt__Base.html#a893edf931eab08c67a70d2e93bbf8c11" title="Setup the CRYPT_ENGINE_INTERNAL $engine." alt="" coords="379,79,444,104"/>
<area shape="rect" href="classCrypt__RC4.html#a4edc74894fc45ad50de5f65a2ce3c509" title="Encrypts or decrypts a message." alt="" coords="196,29,331,55"/>
<area shape="rect" href="classCrypt__Base.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="228,79,299,104"/>
<area shape="rect" href="classCrypt__Base.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="228,128,299,153"/>
<area shape="rect" href="classCrypt__RC4.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="5,5,148,31"/>
<area shape="rect" href="classCrypt__RC4.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="5,55,148,80"/>
</map>
</div>

</div>
</div>
<a id="aad783e9c1c4fc5e3d8e312f08dd36f68" name="aad783e9c1c4fc5e3d8e312f08dd36f68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad783e9c1c4fc5e3d8e312f08dd36f68">&#9670;&#160;</a></span>_setupKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_setupKey </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup the key (expansion) </p>
<p>Only used if $engine == CRYPT_ENGINE_INTERNAL</p>
<dl class="section see"><dt>See also</dt><dd>self::_setup() @access private </dd></dl>

<p>Reimplemented in <a class="el" href="classCrypt__Blowfish.html#aad783e9c1c4fc5e3d8e312f08dd36f68">Crypt_Blowfish</a>, <a class="el" href="classCrypt__DES.html#aad783e9c1c4fc5e3d8e312f08dd36f68">Crypt_DES</a>, <a class="el" href="classCrypt__RC2.html#aad783e9c1c4fc5e3d8e312f08dd36f68">Crypt_RC2</a>, <a class="el" href="classCrypt__RC4.html#aad783e9c1c4fc5e3d8e312f08dd36f68">Crypt_RC4</a>, <a class="el" href="classCrypt__Rijndael.html#aad783e9c1c4fc5e3d8e312f08dd36f68">Crypt_Rijndael</a>, <a class="el" href="classCrypt__TripleDES.html#aad783e9c1c4fc5e3d8e312f08dd36f68">Crypt_TripleDES</a>, and <a class="el" href="classCrypt__Twofish.html#aad783e9c1c4fc5e3d8e312f08dd36f68">Crypt_Twofish</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01793">1793</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1794</span>    {</div>
<div class="line"><span class="lineno"> 1795</span>        user_error((version_compare(<a class="code hl_variable" href="configtest_8php.html#a3c1ade165b70ecbf36a71bc64671334a">PHP_VERSION</a>, <span class="stringliteral">&#39;5.0.0&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>)  ? __METHOD__ : __FUNCTION__)  . <span class="stringliteral">&#39;() must extend by class &#39;</span> . get_class($this), E_USER_ERROR);</div>
<div class="line"><span class="lineno"> 1796</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="configtest_8php_source.html#l00041">PHP_VERSION</a>.</p>

<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l01822">_setup()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_aad783e9c1c4fc5e3d8e312f08dd36f68_icgraph.png" border="0" usemap="#aclassCrypt__Base_aad783e9c1c4fc5e3d8e312f08dd36f68_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_aad783e9c1c4fc5e3d8e312f08dd36f68_icgraph" id="aclassCrypt__Base_aad783e9c1c4fc5e3d8e312f08dd36f68_icgraph">
<area shape="rect" title="Setup the key (expansion)" alt="" coords="492,79,581,104"/>
<area shape="rect" href="classCrypt__Base.html#a893edf931eab08c67a70d2e93bbf8c11" title="Setup the CRYPT_ENGINE_INTERNAL $engine." alt="" coords="379,79,444,104"/>
<area shape="rect" href="classCrypt__RC4.html#a4edc74894fc45ad50de5f65a2ce3c509" title="Encrypts or decrypts a message." alt="" coords="196,29,331,55"/>
<area shape="rect" href="classCrypt__Base.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="228,79,299,104"/>
<area shape="rect" href="classCrypt__Base.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="228,128,299,153"/>
<area shape="rect" href="classCrypt__RC4.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="5,5,148,31"/>
<area shape="rect" href="classCrypt__RC4.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="5,55,148,80"/>
</map>
</div>

</div>
</div>
<a id="af55698320880af8999c954bad4544a86" name="af55698320880af8999c954bad4544a86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af55698320880af8999c954bad4544a86">&#9670;&#160;</a></span>_setupMcrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_setupMcrypt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup the CRYPT_ENGINE_MCRYPT $engine. </p>
<p>(re)init, if necessary, the (ext)mcrypt resources and flush all $buffers Used (only) if $engine = CRYPT_ENGINE_MCRYPT</p>
<p>_setupMcrypt() will be called each time if $changed === true typically this happens when using one or more of following public methods:</p>
<ul>
<li>setKey()</li>
<li>setIV()</li>
<li>disableContinuousBuffer()</li>
<li>First run of encrypt() / decrypt()</li>
</ul>
<dl class="section see"><dt>See also</dt><dd>self::setKey() </dd>
<dd>
self::setIV() </dd>
<dd>
self::disableContinuousBuffer() @access private </dd></dl>

<p>Reimplemented in <a class="el" href="classCrypt__RC2.html#af55698320880af8999c954bad4544a86">Crypt_RC2</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01855">1855</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1856</span>    {</div>
<div class="line"><span class="lineno"> 1857</span>        $this-&gt;_clearBuffers();</div>
<div class="line"><span class="lineno"> 1858</span>        $this-&gt;enchanged = $this-&gt;dechanged = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1859</span> </div>
<div class="line"><span class="lineno"> 1860</span>        <span class="keywordflow">if</span> (!isset($this-&gt;enmcrypt)) {</div>
<div class="line"><span class="lineno"> 1861</span>            <span class="keyword">static</span> $mcrypt_modes = array(</div>
<div class="line"><span class="lineno"> 1862</span>                <a class="code hl_variable" href="Base_8php.html#a4204f1d2beaf41a2b97967cbea0ef666">CRYPT_MODE_CTR</a>    =&gt; <span class="stringliteral">&#39;ctr&#39;</span>,</div>
<div class="line"><span class="lineno"> 1863</span>                <a class="code hl_variable" href="Base_8php.html#ace7687420bc69da6192bc40c8a061804">CRYPT_MODE_ECB</a>    =&gt; MCRYPT_MODE_ECB,</div>
<div class="line"><span class="lineno"> 1864</span>                <a class="code hl_variable" href="Base_8php.html#a766af87a1190a65dd937ce94ef962400">CRYPT_MODE_CBC</a>    =&gt; MCRYPT_MODE_CBC,</div>
<div class="line"><span class="lineno"> 1865</span>                <a class="code hl_variable" href="Base_8php.html#aa1a1e45bef3380f6e5c0a1c8fa4dad46">CRYPT_MODE_CFB</a>    =&gt; <span class="stringliteral">&#39;ncfb&#39;</span>,</div>
<div class="line"><span class="lineno"> 1866</span>                <a class="code hl_variable" href="Base_8php.html#af9423638549fc5c52db69b66560614ef">CRYPT_MODE_OFB</a>    =&gt; MCRYPT_MODE_NOFB,</div>
<div class="line"><span class="lineno"> 1867</span>                <a class="code hl_variable" href="Base_8php.html#adaa3d4f69333325e047270ae0d58bcaa">CRYPT_MODE_STREAM</a> =&gt; MCRYPT_MODE_STREAM,</div>
<div class="line"><span class="lineno"> 1868</span>            );</div>
<div class="line"><span class="lineno"> 1869</span> </div>
<div class="line"><span class="lineno"> 1870</span>            $this-&gt;demcrypt = mcrypt_module_open($this-&gt;cipher_name_mcrypt, <span class="stringliteral">&#39;&#39;</span>, $mcrypt_modes[$this-&gt;mode], <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><span class="lineno"> 1871</span>            $this-&gt;enmcrypt = mcrypt_module_open($this-&gt;cipher_name_mcrypt, <span class="stringliteral">&#39;&#39;</span>, $mcrypt_modes[$this-&gt;mode], <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><span class="lineno"> 1872</span> </div>
<div class="line"><span class="lineno"> 1873</span>            <span class="comment">// we need the $ecb mcrypt resource (only) in MODE_CFB with enableContinuousBuffer()</span></div>
<div class="line"><span class="lineno"> 1874</span>            <span class="comment">// to workaround mcrypt&#39;s broken ncfb implementation in buffered mode</span></div>
<div class="line"><span class="lineno"> 1875</span>            <span class="comment">// see: {@link http://phpseclib.sourceforge.net/cfb-demo.phps}</span></div>
<div class="line"><span class="lineno"> 1876</span>            <span class="keywordflow">if</span> ($this-&gt;mode == <a class="code hl_variable" href="Base_8php.html#aa1a1e45bef3380f6e5c0a1c8fa4dad46">CRYPT_MODE_CFB</a>) {</div>
<div class="line"><span class="lineno"> 1877</span>                $this-&gt;ecb = mcrypt_module_open($this-&gt;cipher_name_mcrypt, <span class="stringliteral">&#39;&#39;</span>, MCRYPT_MODE_ECB, <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><span class="lineno"> 1878</span>            }</div>
<div class="line"><span class="lineno"> 1879</span>        } <span class="comment">// else should mcrypt_generic_deinit be called?</span></div>
<div class="line"><span class="lineno"> 1880</span> </div>
<div class="line"><span class="lineno"> 1881</span>        <span class="keywordflow">if</span> ($this-&gt;mode == <a class="code hl_variable" href="Base_8php.html#aa1a1e45bef3380f6e5c0a1c8fa4dad46">CRYPT_MODE_CFB</a>) {</div>
<div class="line"><span class="lineno"> 1882</span>            mcrypt_generic_init($this-&gt;ecb, $this-&gt;key, str_repeat(<span class="stringliteral">&quot;\0&quot;</span>, $this-&gt;block_size));</div>
<div class="line"><span class="lineno"> 1883</span>        }</div>
<div class="line"><span class="lineno"> 1884</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l01955">_clearBuffers()</a>, <a class="el" href="Base_8php_source.html#l00079">CRYPT_MODE_CBC</a>, <a class="el" href="Base_8php_source.html#l00085">CRYPT_MODE_CFB</a>, <a class="el" href="Base_8php_source.html#l00067">CRYPT_MODE_CTR</a>, <a class="el" href="Base_8php_source.html#l00073">CRYPT_MODE_ECB</a>, <a class="el" href="Base_8php_source.html#l00091">CRYPT_MODE_OFB</a>, and <a class="el" href="Base_8php_source.html#l00095">CRYPT_MODE_STREAM</a>.</p>

<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l01050">decrypt()</a>, and <a class="el" href="Base_8php_source.html#l00744">encrypt()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_af55698320880af8999c954bad4544a86_cgraph.png" border="0" usemap="#aclassCrypt__Base_af55698320880af8999c954bad4544a86_cgraph" alt=""/></div>
<map name="aclassCrypt__Base_af55698320880af8999c954bad4544a86_cgraph" id="aclassCrypt__Base_af55698320880af8999c954bad4544a86_cgraph">
<area shape="rect" title="Setup the CRYPT_ENGINE_MCRYPT $engine." alt="" coords="5,5,116,31"/>
<area shape="rect" href="classCrypt__Base.html#a1a87457f321c145b43893358a820f55a" title="Clears internal buffers." alt="" coords="164,5,271,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_af55698320880af8999c954bad4544a86_icgraph.png" border="0" usemap="#aclassCrypt__Base_af55698320880af8999c954bad4544a86_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_af55698320880af8999c954bad4544a86_icgraph" id="aclassCrypt__Base_af55698320880af8999c954bad4544a86_icgraph">
<area shape="rect" title="Setup the CRYPT_ENGINE_MCRYPT $engine." alt="" coords="124,31,235,56"/>
<area shape="rect" href="classCrypt__Base.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="5,5,76,31"/>
<area shape="rect" href="classCrypt__Base.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="5,55,76,80"/>
</map>
</div>

</div>
</div>
<a id="a1cc0bf8f079a276e5d518ac53443fa31" name="a1cc0bf8f079a276e5d518ac53443fa31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cc0bf8f079a276e5d518ac53443fa31">&#9670;&#160;</a></span>_string_pop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_string_pop </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$index</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>String Pop. </p>
<p>Inspired by array_pop</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$string</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$index</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01995">1995</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1996</span>    {</div>
<div class="line"><span class="lineno"> 1997</span>        $substr = substr($string, -$index);</div>
<div class="line"><span class="lineno"> 1998</span>        $string = substr($string, 0, -$index);</div>
<div class="line"><span class="lineno"> 1999</span>        <span class="keywordflow">return</span> $substr;</div>
<div class="line"><span class="lineno"> 2000</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l01351">_openssl_ctr_process()</a>, <a class="el" href="Base_8php_source.html#l01445">_openssl_ofb_process()</a>, and <a class="el" href="Base_8php_source.html#l00744">encrypt()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a1cc0bf8f079a276e5d518ac53443fa31_icgraph.png" border="0" usemap="#aclassCrypt__Base_a1cc0bf8f079a276e5d518ac53443fa31_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a1cc0bf8f079a276e5d518ac53443fa31_icgraph" id="aclassCrypt__Base_a1cc0bf8f079a276e5d518ac53443fa31_icgraph">
<area shape="rect" title="String Pop." alt="" coords="336,55,433,80"/>
<area shape="rect" href="classCrypt__Base.html#a7aaf3600e103d90572ffd029d81707d1" title="OpenSSL CTR Processor." alt="" coords="126,55,286,80"/>
<area shape="rect" href="classCrypt__Base.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="5,55,76,80"/>
<area shape="rect" href="classCrypt__Base.html#ac1b2f723636fe01c4aa90fb201384110" title="OpenSSL OFB Processor." alt="" coords="124,5,288,31"/>
<area shape="rect" href="classCrypt__Base.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="5,5,76,31"/>
</map>
</div>

</div>
</div>
<a id="ab009fa6f4ba09daa679a30e9b5bcfe35" name="ab009fa6f4ba09daa679a30e9b5bcfe35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab009fa6f4ba09daa679a30e9b5bcfe35">&#9670;&#160;</a></span>_string_shift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_string_shift </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$index</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>String Shift. </p>
<p>Inspired by array_shift</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$string</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$index</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01978">1978</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1979</span>    {</div>
<div class="line"><span class="lineno"> 1980</span>        $substr = substr($string, 0, $index);</div>
<div class="line"><span class="lineno"> 1981</span>        $string = substr($string, $index);</div>
<div class="line"><span class="lineno"> 1982</span>        <span class="keywordflow">return</span> $substr;</div>
<div class="line"><span class="lineno"> 1983</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l01351">_openssl_ctr_process()</a>, <a class="el" href="Base_8php_source.html#l01445">_openssl_ofb_process()</a>, <a class="el" href="Base_8php_source.html#l01050">decrypt()</a>, and <a class="el" href="Base_8php_source.html#l00744">encrypt()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_ab009fa6f4ba09daa679a30e9b5bcfe35_icgraph.png" border="0" usemap="#aclassCrypt__Base_ab009fa6f4ba09daa679a30e9b5bcfe35_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_ab009fa6f4ba09daa679a30e9b5bcfe35_icgraph" id="aclassCrypt__Base_ab009fa6f4ba09daa679a30e9b5bcfe35_icgraph">
<area shape="rect" title="String Shift." alt="" coords="336,54,437,80"/>
<area shape="rect" href="classCrypt__Base.html#a7aaf3600e103d90572ffd029d81707d1" title="OpenSSL CTR Processor." alt="" coords="126,29,286,54"/>
<area shape="rect" href="classCrypt__Base.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="5,29,76,54"/>
<area shape="rect" href="classCrypt__Base.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="5,78,76,104"/>
<area shape="rect" href="classCrypt__Base.html#ac1b2f723636fe01c4aa90fb201384110" title="OpenSSL OFB Processor." alt="" coords="124,78,288,104"/>
</map>
</div>

</div>
</div>
<a id="aa01a443b76b909f941c3434a06e744ce" name="aa01a443b76b909f941c3434a06e744ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa01a443b76b909f941c3434a06e744ce">&#9670;&#160;</a></span>_unpad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_unpad </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$text</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unpads a string. </p>
<p>If padding is enabled and the reported padding length is invalid the encryption key will be assumed to be wrong and false will be returned.</p>
<dl class="section see"><dt>See also</dt><dd>self::_pad() </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$text</td><td>@access private </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01930">1930</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1931</span>    {</div>
<div class="line"><span class="lineno"> 1932</span>        <span class="keywordflow">if</span> (!$this-&gt;padding) {</div>
<div class="line"><span class="lineno"> 1933</span>            <span class="keywordflow">return</span> $text;</div>
<div class="line"><span class="lineno"> 1934</span>        }</div>
<div class="line"><span class="lineno"> 1935</span> </div>
<div class="line"><span class="lineno"> 1936</span>        $length = ord($text[strlen($text) - 1]);</div>
<div class="line"><span class="lineno"> 1937</span> </div>
<div class="line"><span class="lineno"> 1938</span>        <span class="keywordflow">if</span> (!$length || $length &gt; $this-&gt;block_size) {</div>
<div class="line"><span class="lineno"> 1939</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1940</span>        }</div>
<div class="line"><span class="lineno"> 1941</span> </div>
<div class="line"><span class="lineno"> 1942</span>        <span class="keywordflow">return</span> substr($text, 0, -$length);</div>
<div class="line"><span class="lineno"> 1943</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l01050">decrypt()</a>, and <a class="el" href="TripleDES_8php_source.html#l00379">Crypt_TripleDES\decrypt()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_aa01a443b76b909f941c3434a06e744ce_icgraph.png" border="0" usemap="#aclassCrypt__Base_aa01a443b76b909f941c3434a06e744ce_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_aa01a443b76b909f941c3434a06e744ce_icgraph" id="aclassCrypt__Base_aa01a443b76b909f941c3434a06e744ce_icgraph">
<area shape="rect" title="Unpads a string." alt="" coords="459,43,528,68"/>
<area shape="rect" href="classCrypt__Base.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="286,5,357,31"/>
<area shape="rect" href="classCrypt__TripleDES.html#a7668d56408ddd5f0cd7e8e745afd9d9a" title="Decrypts a message." alt="" coords="232,79,411,104"/>
<area shape="rect" href="classCrypt__TripleDES.html#aa5ceadf7c30ea677b755c6085b23f2a5" title="Encrypts a message." alt="" coords="5,79,184,104"/>
</map>
</div>

</div>
</div>
<a id="a6a80cab2d9e4f3091d06f0393cb3faf8" name="a6a80cab2d9e4f3091d06f0393cb3faf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a80cab2d9e4f3091d06f0393cb3faf8">&#9670;&#160;</a></span>Crypt_Base()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCrypt__Base.html">Crypt_Base</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mode</em> = <code><a class="el" href="Base_8php.html#a766af87a1190a65dd937ce94ef962400">CRYPT_MODE_CBC</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PHP4 compatible Default Constructor. </p>
<dl class="section see"><dt>See also</dt><dd>self::__construct() </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$mode</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00541">541</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  542</span>    {</div>
<div class="line"><span class="lineno">  543</span>        $this-&gt;__construct($mode);</div>
<div class="line"><span class="lineno">  544</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l00506">__construct()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a6a80cab2d9e4f3091d06f0393cb3faf8_cgraph.png" border="0" usemap="#aclassCrypt__Base_a6a80cab2d9e4f3091d06f0393cb3faf8_cgraph" alt=""/></div>
<map name="aclassCrypt__Base_a6a80cab2d9e4f3091d06f0393cb3faf8_cgraph" id="aclassCrypt__Base_a6a80cab2d9e4f3091d06f0393cb3faf8_cgraph">
<area shape="rect" title="PHP4 compatible Default Constructor." alt="" coords="5,5,101,31"/>
<area shape="rect" href="classCrypt__Base.html#a7f343b63c2a2441c661bb6f07553643f" title="Default Constructor." alt="" coords="149,5,245,31"/>
<area shape="rect" href="classCrypt__Base.html#ab4e58314adec23125fc08ae86aa501e3" title="Sets the engine as appropriate." alt="" coords="293,5,387,31"/>
<area shape="rect" href="classCrypt__Base.html#ae62f456da9bef718ecc3e155d63f0dc8" title="Test for engine validity." alt="" coords="435,5,544,31"/>
</map>
</div>

</div>
</div>
<a id="a7668d56408ddd5f0cd7e8e745afd9d9a" name="a7668d56408ddd5f0cd7e8e745afd9d9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7668d56408ddd5f0cd7e8e745afd9d9a">&#9670;&#160;</a></span>decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">decrypt </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ciphertext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts a message. </p>
<p>If strlen($ciphertext) is not a multiple of the block size, null bytes will be added to the end of the string until it is.</p>
<dl class="section see"><dt>See also</dt><dd>self::encrypt() @access public </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$ciphertext</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string $plaintext </dd></dl>

<p>Reimplemented in <a class="el" href="classCrypt__RC2.html#a7668d56408ddd5f0cd7e8e745afd9d9a">Crypt_RC2</a>, <a class="el" href="classCrypt__RC4.html#a7668d56408ddd5f0cd7e8e745afd9d9a">Crypt_RC4</a>, and <a class="el" href="classCrypt__TripleDES.html#a7668d56408ddd5f0cd7e8e745afd9d9a">Crypt_TripleDES</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01050">1050</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1051</span>    {</div>
<div class="line"><span class="lineno"> 1052</span>        <span class="keywordflow">if</span> ($this-&gt;paddable) {</div>
<div class="line"><span class="lineno"> 1053</span>            <span class="comment">// we pad with chr(0) since that&#39;s what mcrypt_generic does.  to quote from {@link http://www.php.net/function.mcrypt-generic}:</span></div>
<div class="line"><span class="lineno"> 1054</span>            <span class="comment">// &quot;The data is padded with &quot;\0&quot; to make sure the length of the data is n * blocksize.&quot;</span></div>
<div class="line"><span class="lineno"> 1055</span>            $ciphertext = str_pad($ciphertext, strlen($ciphertext) + ($this-&gt;block_size - strlen($ciphertext) % $this-&gt;block_size) % $this-&gt;block_size, chr(0));</div>
<div class="line"><span class="lineno"> 1056</span>        }</div>
<div class="line"><span class="lineno"> 1057</span> </div>
<div class="line"><span class="lineno"> 1058</span>        <span class="keywordflow">if</span> ($this-&gt;engine === <a class="code hl_variable" href="Base_8php.html#a8f1200db8ddce5bab18ddeec03362215">CRYPT_ENGINE_OPENSSL</a>) {</div>
<div class="line"><span class="lineno"> 1059</span>            <span class="keywordflow">if</span> ($this-&gt;changed) {</div>
<div class="line"><span class="lineno"> 1060</span>                $this-&gt;_clearBuffers();</div>
<div class="line"><span class="lineno"> 1061</span>                $this-&gt;changed = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1062</span>            }</div>
<div class="line"><span class="lineno"> 1063</span>            <span class="keywordflow">switch</span> ($this-&gt;mode) {</div>
<div class="line"><span class="lineno"> 1064</span>                <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#adaa3d4f69333325e047270ae0d58bcaa">CRYPT_MODE_STREAM</a>:</div>
<div class="line"><span class="lineno"> 1065</span>                    $plaintext = openssl_decrypt($ciphertext, $this-&gt;cipher_name_openssl, $this-&gt;key, $this-&gt;openssl_options);</div>
<div class="line"><span class="lineno"> 1066</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1067</span>                <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#ace7687420bc69da6192bc40c8a061804">CRYPT_MODE_ECB</a>:</div>
<div class="line"><span class="lineno"> 1068</span>                    <span class="keywordflow">if</span> (!defined(<span class="stringliteral">&#39;OPENSSL_RAW_DATA&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 1069</span>                        $ciphertext.= @openssl_encrypt(<span class="stringliteral">&#39;&#39;</span>, $this-&gt;cipher_name_openssl_ecb, $this-&gt;key, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1070</span>                    }</div>
<div class="line"><span class="lineno"> 1071</span>                    $plaintext = openssl_decrypt($ciphertext, $this-&gt;cipher_name_openssl, $this-&gt;key, $this-&gt;openssl_options);</div>
<div class="line"><span class="lineno"> 1072</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1073</span>                <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a766af87a1190a65dd937ce94ef962400">CRYPT_MODE_CBC</a>:</div>
<div class="line"><span class="lineno"> 1074</span>                    <span class="keywordflow">if</span> (!defined(<span class="stringliteral">&#39;OPENSSL_RAW_DATA&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 1075</span>                        <a class="code hl_variable" href="classCrypt__Base.html#a8563f129efffd9bcc2e662e00c0ba29e">$padding</a> = str_repeat(chr($this-&gt;block_size), $this-&gt;block_size) ^ substr($ciphertext, -$this-&gt;block_size);</div>
<div class="line"><span class="lineno"> 1076</span>                        $ciphertext.= substr(@openssl_encrypt($padding, $this-&gt;cipher_name_openssl_ecb, $this-&gt;key, <span class="keyword">true</span>), 0, $this-&gt;block_size);</div>
<div class="line"><span class="lineno"> 1077</span>                        $offset = 2 * $this-&gt;block_size;</div>
<div class="line"><span class="lineno"> 1078</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1079</span>                        $offset = $this-&gt;block_size;</div>
<div class="line"><span class="lineno"> 1080</span>                    }</div>
<div class="line"><span class="lineno"> 1081</span>                    $plaintext = openssl_decrypt($ciphertext, $this-&gt;cipher_name_openssl, $this-&gt;key, $this-&gt;openssl_options, $this-&gt;decryptIV);</div>
<div class="line"><span class="lineno"> 1082</span>                    <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1083</span>                        $this-&gt;decryptIV = substr($ciphertext, -$offset, $this-&gt;block_size);</div>
<div class="line"><span class="lineno"> 1084</span>                    }</div>
<div class="line"><span class="lineno"> 1085</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1086</span>                <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a4204f1d2beaf41a2b97967cbea0ef666">CRYPT_MODE_CTR</a>:</div>
<div class="line"><span class="lineno"> 1087</span>                    $plaintext = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a7aaf3600e103d90572ffd029d81707d1">_openssl_ctr_process</a>($ciphertext, $this-&gt;decryptIV, $this-&gt;debuffer);</div>
<div class="line"><span class="lineno"> 1088</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1089</span>                <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#aa1a1e45bef3380f6e5c0a1c8fa4dad46">CRYPT_MODE_CFB</a>:</div>
<div class="line"><span class="lineno"> 1090</span>                    <span class="comment">// cfb loosely routines inspired by openssl&#39;s:</span></div>
<div class="line"><span class="lineno"> 1091</span>                    <span class="comment">// {@link http://cvs.openssl.org/fileview?f=openssl/crypto/modes/cfb128.c&amp;v=1.3.2.2.2.1}</span></div>
<div class="line"><span class="lineno"> 1092</span>                    $plaintext = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1093</span>                    <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1094</span>                        <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = &amp;$this-&gt;decryptIV;</div>
<div class="line"><span class="lineno"> 1095</span>                        $pos = &amp;$this-&gt;buffer[<span class="stringliteral">&#39;pos&#39;</span>];</div>
<div class="line"><span class="lineno"> 1096</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1097</span>                        <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = $this-&gt;decryptIV;</div>
<div class="line"><span class="lineno"> 1098</span>                        $pos = 0;</div>
<div class="line"><span class="lineno"> 1099</span>                    }</div>
<div class="line"><span class="lineno"> 1100</span>                    $len = strlen($ciphertext);</div>
<div class="line"><span class="lineno"> 1101</span>                    $i = 0;</div>
<div class="line"><span class="lineno"> 1102</span>                    <span class="keywordflow">if</span> ($pos) {</div>
<div class="line"><span class="lineno"> 1103</span>                        $orig_pos = $pos;</div>
<div class="line"><span class="lineno"> 1104</span>                        $max = $this-&gt;block_size - $pos;</div>
<div class="line"><span class="lineno"> 1105</span>                        <span class="keywordflow">if</span> ($len &gt;= $max) {</div>
<div class="line"><span class="lineno"> 1106</span>                            $i = $max;</div>
<div class="line"><span class="lineno"> 1107</span>                            $len-= $max;</div>
<div class="line"><span class="lineno"> 1108</span>                            $pos = 0;</div>
<div class="line"><span class="lineno"> 1109</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1110</span>                            $i = $len;</div>
<div class="line"><span class="lineno"> 1111</span>                            $pos+= $len;</div>
<div class="line"><span class="lineno"> 1112</span>                            $len = 0;</div>
<div class="line"><span class="lineno"> 1113</span>                        }</div>
<div class="line"><span class="lineno"> 1114</span>                        <span class="comment">// ie. $i = min($max, $len), $len-= $i, $pos+= $i, $pos%= $this-&gt;blocksize</span></div>
<div class="line"><span class="lineno"> 1115</span>                        $plaintext = substr($iv, $orig_pos) ^ $ciphertext;</div>
<div class="line"><span class="lineno"> 1116</span>                        <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr_replace($iv, substr($ciphertext, 0, $i), $orig_pos, $i);</div>
<div class="line"><span class="lineno"> 1117</span>                        $ciphertext = substr($ciphertext, $i);</div>
<div class="line"><span class="lineno"> 1118</span>                    }</div>
<div class="line"><span class="lineno"> 1119</span>                    $overflow = $len % $this-&gt;block_size;</div>
<div class="line"><span class="lineno"> 1120</span>                    <span class="keywordflow">if</span> ($overflow) {</div>
<div class="line"><span class="lineno"> 1121</span>                        $plaintext.= openssl_decrypt(substr($ciphertext, 0, -$overflow), $this-&gt;cipher_name_openssl, $this-&gt;key, $this-&gt;openssl_options, $iv);</div>
<div class="line"><span class="lineno"> 1122</span>                        <span class="keywordflow">if</span> ($len - $overflow) {</div>
<div class="line"><span class="lineno"> 1123</span>                            <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr($ciphertext, -$overflow - $this-&gt;block_size, -$overflow);</div>
<div class="line"><span class="lineno"> 1124</span>                        }</div>
<div class="line"><span class="lineno"> 1125</span>                        <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = openssl_encrypt(str_repeat(<span class="stringliteral">&quot;\0&quot;</span>, $this-&gt;block_size), $this-&gt;cipher_name_openssl, $this-&gt;key, $this-&gt;openssl_options, $iv);</div>
<div class="line"><span class="lineno"> 1126</span>                        $plaintext.= <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> ^ substr($ciphertext, -$overflow);</div>
<div class="line"><span class="lineno"> 1127</span>                        <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr_replace($iv, substr($ciphertext, -$overflow), 0, $overflow);</div>
<div class="line"><span class="lineno"> 1128</span>                        $pos = $overflow;</div>
<div class="line"><span class="lineno"> 1129</span>                    } elseif ($len) {</div>
<div class="line"><span class="lineno"> 1130</span>                        $plaintext.= openssl_decrypt($ciphertext, $this-&gt;cipher_name_openssl, $this-&gt;key, $this-&gt;openssl_options, $iv);</div>
<div class="line"><span class="lineno"> 1131</span>                        <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr($ciphertext, -$this-&gt;block_size);</div>
<div class="line"><span class="lineno"> 1132</span>                    }</div>
<div class="line"><span class="lineno"> 1133</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1134</span>                <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#af9423638549fc5c52db69b66560614ef">CRYPT_MODE_OFB</a>:</div>
<div class="line"><span class="lineno"> 1135</span>                    $plaintext = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#ac1b2f723636fe01c4aa90fb201384110">_openssl_ofb_process</a>($ciphertext, $this-&gt;decryptIV, $this-&gt;debuffer);</div>
<div class="line"><span class="lineno"> 1136</span>            }</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span>            <span class="keywordflow">return</span> $this-&gt;paddable ? $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#aa01a443b76b909f941c3434a06e744ce">_unpad</a>($plaintext) : $plaintext;</div>
<div class="line"><span class="lineno"> 1139</span>        }</div>
<div class="line"><span class="lineno"> 1140</span> </div>
<div class="line"><span class="lineno"> 1141</span>        <span class="keywordflow">if</span> ($this-&gt;engine === <a class="code hl_variable" href="Base_8php.html#aec1c8f2a4ace0050f6457c9c61bf8310">CRYPT_ENGINE_MCRYPT</a>) {</div>
<div class="line"><span class="lineno"> 1142</span>            set_error_handler(array($this, <span class="stringliteral">&#39;do_nothing&#39;</span>));</div>
<div class="line"><span class="lineno"> 1143</span>            <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a> = $this-&gt;block_size;</div>
<div class="line"><span class="lineno"> 1144</span>            <span class="keywordflow">if</span> ($this-&gt;changed) {</div>
<div class="line"><span class="lineno"> 1145</span>                $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#af55698320880af8999c954bad4544a86">_setupMcrypt</a>();</div>
<div class="line"><span class="lineno"> 1146</span>                $this-&gt;changed = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1147</span>            }</div>
<div class="line"><span class="lineno"> 1148</span>            <span class="keywordflow">if</span> ($this-&gt;dechanged) {</div>
<div class="line"><span class="lineno"> 1149</span>                mcrypt_generic_init($this-&gt;demcrypt, $this-&gt;key, $this-&gt;decryptIV);</div>
<div class="line"><span class="lineno"> 1150</span>                $this-&gt;dechanged = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1151</span>            }</div>
<div class="line"><span class="lineno"> 1152</span> </div>
<div class="line"><span class="lineno"> 1153</span>            <span class="keywordflow">if</span> ($this-&gt;mode == <a class="code hl_variable" href="Base_8php.html#aa1a1e45bef3380f6e5c0a1c8fa4dad46">CRYPT_MODE_CFB</a> &amp;&amp; $this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1154</span>                <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = &amp;$this-&gt;decryptIV;</div>
<div class="line"><span class="lineno"> 1155</span>                $pos = &amp;$this-&gt;debuffer[<span class="stringliteral">&#39;pos&#39;</span>];</div>
<div class="line"><span class="lineno"> 1156</span>                $len = strlen($ciphertext);</div>
<div class="line"><span class="lineno"> 1157</span>                $plaintext = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1158</span>                $i = 0;</div>
<div class="line"><span class="lineno"> 1159</span>                <span class="keywordflow">if</span> ($pos) {</div>
<div class="line"><span class="lineno"> 1160</span>                    $orig_pos = $pos;</div>
<div class="line"><span class="lineno"> 1161</span>                    $max = <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a> - $pos;</div>
<div class="line"><span class="lineno"> 1162</span>                    <span class="keywordflow">if</span> ($len &gt;= $max) {</div>
<div class="line"><span class="lineno"> 1163</span>                        $i = $max;</div>
<div class="line"><span class="lineno"> 1164</span>                        $len-= $max;</div>
<div class="line"><span class="lineno"> 1165</span>                        $pos = 0;</div>
<div class="line"><span class="lineno"> 1166</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1167</span>                        $i = $len;</div>
<div class="line"><span class="lineno"> 1168</span>                        $pos+= $len;</div>
<div class="line"><span class="lineno"> 1169</span>                        $len = 0;</div>
<div class="line"><span class="lineno"> 1170</span>                    }</div>
<div class="line"><span class="lineno"> 1171</span>                    <span class="comment">// ie. $i = min($max, $len), $len-= $i, $pos+= $i, $pos%= $blocksize</span></div>
<div class="line"><span class="lineno"> 1172</span>                    $plaintext = substr($iv, $orig_pos) ^ $ciphertext;</div>
<div class="line"><span class="lineno"> 1173</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr_replace($iv, substr($ciphertext, 0, $i), $orig_pos, $i);</div>
<div class="line"><span class="lineno"> 1174</span>                }</div>
<div class="line"><span class="lineno"> 1175</span>                <span class="keywordflow">if</span> ($len &gt;= $block_size) {</div>
<div class="line"><span class="lineno"> 1176</span>                    $cb = substr($ciphertext, $i, $len - $len % $block_size);</div>
<div class="line"><span class="lineno"> 1177</span>                    $plaintext.= mcrypt_generic($this-&gt;ecb, $iv . $cb) ^ $cb;</div>
<div class="line"><span class="lineno"> 1178</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr($cb, -$block_size);</div>
<div class="line"><span class="lineno"> 1179</span>                    $len%= <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>;</div>
<div class="line"><span class="lineno"> 1180</span>                }</div>
<div class="line"><span class="lineno"> 1181</span>                <span class="keywordflow">if</span> ($len) {</div>
<div class="line"><span class="lineno"> 1182</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = mcrypt_generic($this-&gt;ecb, $iv);</div>
<div class="line"><span class="lineno"> 1183</span>                    $plaintext.= <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> ^ substr($ciphertext, -$len);</div>
<div class="line"><span class="lineno"> 1184</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr_replace($iv, substr($ciphertext, -$len), 0, $len);</div>
<div class="line"><span class="lineno"> 1185</span>                    $pos = $len;</div>
<div class="line"><span class="lineno"> 1186</span>                }</div>
<div class="line"><span class="lineno"> 1187</span> </div>
<div class="line"><span class="lineno"> 1188</span>                restore_error_handler();</div>
<div class="line"><span class="lineno"> 1189</span> </div>
<div class="line"><span class="lineno"> 1190</span>                <span class="keywordflow">return</span> $plaintext;</div>
<div class="line"><span class="lineno"> 1191</span>            }</div>
<div class="line"><span class="lineno"> 1192</span> </div>
<div class="line"><span class="lineno"> 1193</span>            $plaintext = mdecrypt_generic($this-&gt;demcrypt, $ciphertext);</div>
<div class="line"><span class="lineno"> 1194</span> </div>
<div class="line"><span class="lineno"> 1195</span>            <span class="keywordflow">if</span> (!$this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1196</span>                mcrypt_generic_init($this-&gt;demcrypt, $this-&gt;key, $this-&gt;decryptIV);</div>
<div class="line"><span class="lineno"> 1197</span>            }</div>
<div class="line"><span class="lineno"> 1198</span> </div>
<div class="line"><span class="lineno"> 1199</span>            restore_error_handler();</div>
<div class="line"><span class="lineno"> 1200</span> </div>
<div class="line"><span class="lineno"> 1201</span>            <span class="keywordflow">return</span> $this-&gt;paddable ? $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#aa01a443b76b909f941c3434a06e744ce">_unpad</a>($plaintext) : $plaintext;</div>
<div class="line"><span class="lineno"> 1202</span>        }</div>
<div class="line"><span class="lineno"> 1203</span> </div>
<div class="line"><span class="lineno"> 1204</span>        <span class="keywordflow">if</span> ($this-&gt;changed) {</div>
<div class="line"><span class="lineno"> 1205</span>            $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a893edf931eab08c67a70d2e93bbf8c11">_setup</a>();</div>
<div class="line"><span class="lineno"> 1206</span>            $this-&gt;changed = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1207</span>        }</div>
<div class="line"><span class="lineno"> 1208</span>        <span class="keywordflow">if</span> ($this-&gt;use_inline_crypt) {</div>
<div class="line"><span class="lineno"> 1209</span>            $inline = $this-&gt;inline_crypt;</div>
<div class="line"><span class="lineno"> 1210</span>            <span class="keywordflow">return</span> $inline(<span class="stringliteral">&#39;decrypt&#39;</span>, $this, $ciphertext);</div>
<div class="line"><span class="lineno"> 1211</span>        }</div>
<div class="line"><span class="lineno"> 1212</span> </div>
<div class="line"><span class="lineno"> 1213</span>        <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a> = $this-&gt;block_size;</div>
<div class="line"><span class="lineno"> 1214</span> </div>
<div class="line"><span class="lineno"> 1215</span>        $buffer = &amp;$this-&gt;debuffer;</div>
<div class="line"><span class="lineno"> 1216</span>        $plaintext = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno"> 1217</span>        <span class="keywordflow">switch</span> ($this-&gt;mode) {</div>
<div class="line"><span class="lineno"> 1218</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#ace7687420bc69da6192bc40c8a061804">CRYPT_MODE_ECB</a>:</div>
<div class="line"><span class="lineno"> 1219</span>                <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($ciphertext); $i+=<a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>) {</div>
<div class="line"><span class="lineno"> 1220</span>                    $plaintext.= $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a2a08218631ae2281ca8cf6032c34a843">_decryptBlock</a>(substr($ciphertext, $i, $block_size));</div>
<div class="line"><span class="lineno"> 1221</span>                }</div>
<div class="line"><span class="lineno"> 1222</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1223</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a766af87a1190a65dd937ce94ef962400">CRYPT_MODE_CBC</a>:</div>
<div class="line"><span class="lineno"> 1224</span>                $xor = $this-&gt;decryptIV;</div>
<div class="line"><span class="lineno"> 1225</span>                <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($ciphertext); $i+=<a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>) {</div>
<div class="line"><span class="lineno"> 1226</span>                    $block = substr($ciphertext, $i, $block_size);</div>
<div class="line"><span class="lineno"> 1227</span>                    $plaintext.= $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a2a08218631ae2281ca8cf6032c34a843">_decryptBlock</a>($block) ^ $xor;</div>
<div class="line"><span class="lineno"> 1228</span>                    $xor = $block;</div>
<div class="line"><span class="lineno"> 1229</span>                }</div>
<div class="line"><span class="lineno"> 1230</span>                <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1231</span>                    $this-&gt;decryptIV = $xor;</div>
<div class="line"><span class="lineno"> 1232</span>                }</div>
<div class="line"><span class="lineno"> 1233</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1234</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a4204f1d2beaf41a2b97967cbea0ef666">CRYPT_MODE_CTR</a>:</div>
<div class="line"><span class="lineno"> 1235</span>                $xor = $this-&gt;decryptIV;</div>
<div class="line"><span class="lineno"> 1236</span>                <span class="keywordflow">if</span> (strlen($buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1237</span>                    <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($ciphertext); $i+=<a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>) {</div>
<div class="line"><span class="lineno"> 1238</span>                        $block = substr($ciphertext, $i, $block_size);</div>
<div class="line"><span class="lineno"> 1239</span>                        <span class="keywordflow">if</span> (strlen($block) &gt; strlen($buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1240</span>                            $buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>].= $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a>($xor);</div>
<div class="line"><span class="lineno"> 1241</span>                            $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a412f868848015dec037f640c385f37be">_increment_str</a>($xor);</div>
<div class="line"><span class="lineno"> 1242</span>                        }</div>
<div class="line"><span class="lineno"> 1243</span>                        <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a> = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>], $block_size);</div>
<div class="line"><span class="lineno"> 1244</span>                        $plaintext.= $block ^ <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a>;</div>
<div class="line"><span class="lineno"> 1245</span>                    }</div>
<div class="line"><span class="lineno"> 1246</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1247</span>                    <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($ciphertext); $i+=<a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>) {</div>
<div class="line"><span class="lineno"> 1248</span>                        $block = substr($ciphertext, $i, $block_size);</div>
<div class="line"><span class="lineno"> 1249</span>                        <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a> = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a>($xor);</div>
<div class="line"><span class="lineno"> 1250</span>                        $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a412f868848015dec037f640c385f37be">_increment_str</a>($xor);</div>
<div class="line"><span class="lineno"> 1251</span>                        $plaintext.= $block ^ <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a>;</div>
<div class="line"><span class="lineno"> 1252</span>                    }</div>
<div class="line"><span class="lineno"> 1253</span>                }</div>
<div class="line"><span class="lineno"> 1254</span>                <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1255</span>                    $this-&gt;decryptIV = $xor;</div>
<div class="line"><span class="lineno"> 1256</span>                    <span class="keywordflow">if</span> ($start = strlen($ciphertext) % $block_size) {</div>
<div class="line"><span class="lineno"> 1257</span>                        $buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>] = substr($key, $start) . $buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>];</div>
<div class="line"><span class="lineno"> 1258</span>                    }</div>
<div class="line"><span class="lineno"> 1259</span>                }</div>
<div class="line"><span class="lineno"> 1260</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1261</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#aa1a1e45bef3380f6e5c0a1c8fa4dad46">CRYPT_MODE_CFB</a>:</div>
<div class="line"><span class="lineno"> 1262</span>                <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1263</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = &amp;$this-&gt;decryptIV;</div>
<div class="line"><span class="lineno"> 1264</span>                    $pos = &amp;$buffer[<span class="stringliteral">&#39;pos&#39;</span>];</div>
<div class="line"><span class="lineno"> 1265</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1266</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = $this-&gt;decryptIV;</div>
<div class="line"><span class="lineno"> 1267</span>                    $pos = 0;</div>
<div class="line"><span class="lineno"> 1268</span>                }</div>
<div class="line"><span class="lineno"> 1269</span>                $len = strlen($ciphertext);</div>
<div class="line"><span class="lineno"> 1270</span>                $i = 0;</div>
<div class="line"><span class="lineno"> 1271</span>                <span class="keywordflow">if</span> ($pos) {</div>
<div class="line"><span class="lineno"> 1272</span>                    $orig_pos = $pos;</div>
<div class="line"><span class="lineno"> 1273</span>                    $max = <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a> - $pos;</div>
<div class="line"><span class="lineno"> 1274</span>                    <span class="keywordflow">if</span> ($len &gt;= $max) {</div>
<div class="line"><span class="lineno"> 1275</span>                        $i = $max;</div>
<div class="line"><span class="lineno"> 1276</span>                        $len-= $max;</div>
<div class="line"><span class="lineno"> 1277</span>                        $pos = 0;</div>
<div class="line"><span class="lineno"> 1278</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1279</span>                        $i = $len;</div>
<div class="line"><span class="lineno"> 1280</span>                        $pos+= $len;</div>
<div class="line"><span class="lineno"> 1281</span>                        $len = 0;</div>
<div class="line"><span class="lineno"> 1282</span>                    }</div>
<div class="line"><span class="lineno"> 1283</span>                    <span class="comment">// ie. $i = min($max, $len), $len-= $i, $pos+= $i, $pos%= $blocksize</span></div>
<div class="line"><span class="lineno"> 1284</span>                    $plaintext = substr($iv, $orig_pos) ^ $ciphertext;</div>
<div class="line"><span class="lineno"> 1285</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr_replace($iv, substr($ciphertext, 0, $i), $orig_pos, $i);</div>
<div class="line"><span class="lineno"> 1286</span>                }</div>
<div class="line"><span class="lineno"> 1287</span>                <span class="keywordflow">while</span> ($len &gt;= $block_size) {</div>
<div class="line"><span class="lineno"> 1288</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a>($iv);</div>
<div class="line"><span class="lineno"> 1289</span>                    $cb = substr($ciphertext, $i, $block_size);</div>
<div class="line"><span class="lineno"> 1290</span>                    $plaintext.= <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> ^ $cb;</div>
<div class="line"><span class="lineno"> 1291</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = $cb;</div>
<div class="line"><span class="lineno"> 1292</span>                    $len-= <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>;</div>
<div class="line"><span class="lineno"> 1293</span>                    $i+= <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>;</div>
<div class="line"><span class="lineno"> 1294</span>                }</div>
<div class="line"><span class="lineno"> 1295</span>                <span class="keywordflow">if</span> ($len) {</div>
<div class="line"><span class="lineno"> 1296</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a>($iv);</div>
<div class="line"><span class="lineno"> 1297</span>                    $plaintext.= <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> ^ substr($ciphertext, $i);</div>
<div class="line"><span class="lineno"> 1298</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr_replace($iv, substr($ciphertext, $i), 0, $len);</div>
<div class="line"><span class="lineno"> 1299</span>                    $pos = $len;</div>
<div class="line"><span class="lineno"> 1300</span>                }</div>
<div class="line"><span class="lineno"> 1301</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1302</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#af9423638549fc5c52db69b66560614ef">CRYPT_MODE_OFB</a>:</div>
<div class="line"><span class="lineno"> 1303</span>                $xor = $this-&gt;decryptIV;</div>
<div class="line"><span class="lineno"> 1304</span>                <span class="keywordflow">if</span> (strlen($buffer[<span class="stringliteral">&#39;xor&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1305</span>                    <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($ciphertext); $i+=<a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>) {</div>
<div class="line"><span class="lineno"> 1306</span>                        $block = substr($ciphertext, $i, $block_size);</div>
<div class="line"><span class="lineno"> 1307</span>                        <span class="keywordflow">if</span> (strlen($block) &gt; strlen($buffer[<span class="stringliteral">&#39;xor&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1308</span>                            $xor = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a>($xor);</div>
<div class="line"><span class="lineno"> 1309</span>                            $buffer[<span class="stringliteral">&#39;xor&#39;</span>].= $xor;</div>
<div class="line"><span class="lineno"> 1310</span>                        }</div>
<div class="line"><span class="lineno"> 1311</span>                        <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a> = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($buffer[<span class="stringliteral">&#39;xor&#39;</span>], $block_size);</div>
<div class="line"><span class="lineno"> 1312</span>                        $plaintext.= $block ^ <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a>;</div>
<div class="line"><span class="lineno"> 1313</span>                    }</div>
<div class="line"><span class="lineno"> 1314</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1315</span>                    <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($ciphertext); $i+=<a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>) {</div>
<div class="line"><span class="lineno"> 1316</span>                        $xor = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a>($xor);</div>
<div class="line"><span class="lineno"> 1317</span>                        $plaintext.= substr($ciphertext, $i, $block_size) ^ $xor;</div>
<div class="line"><span class="lineno"> 1318</span>                    }</div>
<div class="line"><span class="lineno"> 1319</span>                    <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a> = $xor;</div>
<div class="line"><span class="lineno"> 1320</span>                }</div>
<div class="line"><span class="lineno"> 1321</span>                <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1322</span>                    $this-&gt;decryptIV = $xor;</div>
<div class="line"><span class="lineno"> 1323</span>                    <span class="keywordflow">if</span> ($start = strlen($ciphertext) % $block_size) {</div>
<div class="line"><span class="lineno"> 1324</span>                        $buffer[<span class="stringliteral">&#39;xor&#39;</span>] = substr($key, $start) . $buffer[<span class="stringliteral">&#39;xor&#39;</span>];</div>
<div class="line"><span class="lineno"> 1325</span>                    }</div>
<div class="line"><span class="lineno"> 1326</span>                }</div>
<div class="line"><span class="lineno"> 1327</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1328</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#adaa3d4f69333325e047270ae0d58bcaa">CRYPT_MODE_STREAM</a>:</div>
<div class="line"><span class="lineno"> 1329</span>                $plaintext = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a2a08218631ae2281ca8cf6032c34a843">_decryptBlock</a>($ciphertext);</div>
<div class="line"><span class="lineno"> 1330</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1331</span>        }</div>
<div class="line"><span class="lineno"> 1332</span>        <span class="keywordflow">return</span> $this-&gt;paddable ? $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#aa01a443b76b909f941c3434a06e744ce">_unpad</a>($plaintext) : $plaintext;</div>
<div class="line"><span class="lineno"> 1333</span>    }</div>
<div class="ttc" id="aclassCrypt__Base_html_a147a28261cd10fb6dbdae31eb0a89c8d"><div class="ttname"><a href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">Crypt_Base\$iv</a></div><div class="ttdeci">$iv</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00160">Base.php:160</a></div></div>
<div class="ttc" id="aclassCrypt__Base_html_a2a08218631ae2281ca8cf6032c34a843"><div class="ttname"><a href="classCrypt__Base.html#a2a08218631ae2281ca8cf6032c34a843">Crypt_Base\_decryptBlock</a></div><div class="ttdeci">_decryptBlock($in)</div><div class="ttdoc">Decrypts a block.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l01779">Base.php:1779</a></div></div>
<div class="ttc" id="aclassCrypt__Base_html_a7aaf3600e103d90572ffd029d81707d1"><div class="ttname"><a href="classCrypt__Base.html#a7aaf3600e103d90572ffd029d81707d1">Crypt_Base\_openssl_ctr_process</a></div><div class="ttdeci">_openssl_ctr_process($plaintext, &amp;$encryptIV, &amp;$buffer)</div><div class="ttdoc">OpenSSL CTR Processor.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l01351">Base.php:1351</a></div></div>
<div class="ttc" id="aclassCrypt__Base_html_a8563f129efffd9bcc2e662e00c0ba29e"><div class="ttname"><a href="classCrypt__Base.html#a8563f129efffd9bcc2e662e00c0ba29e">Crypt_Base\$padding</a></div><div class="ttdeci">$padding</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00314">Base.php:314</a></div></div>
<div class="ttc" id="aclassCrypt__Base_html_a893edf931eab08c67a70d2e93bbf8c11"><div class="ttname"><a href="classCrypt__Base.html#a893edf931eab08c67a70d2e93bbf8c11">Crypt_Base\_setup</a></div><div class="ttdeci">_setup()</div><div class="ttdoc">Setup the CRYPT_ENGINE_INTERNAL $engine.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l01822">Base.php:1822</a></div></div>
<div class="ttc" id="aclassCrypt__Base_html_aa01a443b76b909f941c3434a06e744ce"><div class="ttname"><a href="classCrypt__Base.html#aa01a443b76b909f941c3434a06e744ce">Crypt_Base\_unpad</a></div><div class="ttdeci">_unpad($text)</div><div class="ttdoc">Unpads a string.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l01930">Base.php:1930</a></div></div>
<div class="ttc" id="aclassCrypt__Base_html_ac1b2f723636fe01c4aa90fb201384110"><div class="ttname"><a href="classCrypt__Base.html#ac1b2f723636fe01c4aa90fb201384110">Crypt_Base\_openssl_ofb_process</a></div><div class="ttdeci">_openssl_ofb_process($plaintext, &amp;$encryptIV, &amp;$buffer)</div><div class="ttdoc">OpenSSL OFB Processor.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l01445">Base.php:1445</a></div></div>
<div class="ttc" id="aclassCrypt__Base_html_adbb5f094cd3af568d05434b7a4b3e6e2"><div class="ttname"><a href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">Crypt_Base\_encryptBlock</a></div><div class="ttdeci">_encryptBlock($in)</div><div class="ttdoc">Encrypts a block.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l01766">Base.php:1766</a></div></div>
<div class="ttc" id="aclassCrypt__Base_html_af55698320880af8999c954bad4544a86"><div class="ttname"><a href="classCrypt__Base.html#af55698320880af8999c954bad4544a86">Crypt_Base\_setupMcrypt</a></div><div class="ttdeci">_setupMcrypt()</div><div class="ttdoc">Setup the CRYPT_ENGINE_MCRYPT $engine.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l01855">Base.php:1855</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l01955">_clearBuffers()</a>, <a class="el" href="Base_8php_source.html#l01779">_decryptBlock()</a>, <a class="el" href="Base_8php_source.html#l01766">_encryptBlock()</a>, <a class="el" href="Base_8php_source.html#l02010">_increment_str()</a>, <a class="el" href="Base_8php_source.html#l01351">_openssl_ctr_process()</a>, <a class="el" href="Base_8php_source.html#l01445">_openssl_ofb_process()</a>, <a class="el" href="Base_8php_source.html#l01822">_setup()</a>, <a class="el" href="Base_8php_source.html#l01855">_setupMcrypt()</a>, <a class="el" href="Base_8php_source.html#l01978">_string_shift()</a>, <a class="el" href="Base_8php_source.html#l01930">_unpad()</a>, <a class="el" href="Base_8php_source.html#l00110">CRYPT_ENGINE_MCRYPT</a>, <a class="el" href="Base_8php_source.html#l00114">CRYPT_ENGINE_OPENSSL</a>, <a class="el" href="Base_8php_source.html#l00079">CRYPT_MODE_CBC</a>, <a class="el" href="Base_8php_source.html#l00085">CRYPT_MODE_CFB</a>, <a class="el" href="Base_8php_source.html#l00067">CRYPT_MODE_CTR</a>, <a class="el" href="Base_8php_source.html#l00073">CRYPT_MODE_ECB</a>, <a class="el" href="Base_8php_source.html#l00091">CRYPT_MODE_OFB</a>, and <a class="el" href="Base_8php_source.html#l00095">CRYPT_MODE_STREAM</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a7668d56408ddd5f0cd7e8e745afd9d9a_cgraph.png" border="0" usemap="#aclassCrypt__Base_a7668d56408ddd5f0cd7e8e745afd9d9a_cgraph" alt=""/></div>
<map name="aclassCrypt__Base_a7668d56408ddd5f0cd7e8e745afd9d9a_cgraph" id="aclassCrypt__Base_a7668d56408ddd5f0cd7e8e745afd9d9a_cgraph">
<area shape="rect" title="Decrypts a message." alt="" coords="5,217,76,242"/>
<area shape="rect" href="classCrypt__Base.html#a1a87457f321c145b43893358a820f55a" title="Clears internal buffers." alt="" coords="351,43,457,69"/>
<area shape="rect" href="classCrypt__Base.html#a2a08218631ae2281ca8cf6032c34a843" title="Decrypts a block." alt="" coords="149,142,263,167"/>
<area shape="rect" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2" title="Encrypts a block." alt="" coords="149,191,263,217"/>
<area shape="rect" href="classCrypt__Base.html#a412f868848015dec037f640c385f37be" title="Increment the current string." alt="" coords="345,242,463,267"/>
<area shape="rect" href="classCrypt__Base.html#a7aaf3600e103d90572ffd029d81707d1" title="OpenSSL CTR Processor." alt="" coords="126,293,286,318"/>
<area shape="rect" href="classCrypt__Base.html#ab009fa6f4ba09daa679a30e9b5bcfe35" title="String Shift." alt="" coords="353,342,455,367"/>
<area shape="rect" href="classCrypt__Base.html#ac1b2f723636fe01c4aa90fb201384110" title="OpenSSL OFB Processor." alt="" coords="124,342,288,367"/>
<area shape="rect" href="classCrypt__Base.html#a893edf931eab08c67a70d2e93bbf8c11" title="Setup the CRYPT_ENGINE_INTERNAL $engine." alt="" coords="173,93,239,118"/>
<area shape="rect" href="classCrypt__Base.html#af55698320880af8999c954bad4544a86" title="Setup the CRYPT_ENGINE_MCRYPT $engine." alt="" coords="151,43,261,69"/>
<area shape="rect" href="classCrypt__Base.html#aa01a443b76b909f941c3434a06e744ce" title="Unpads a string." alt="" coords="171,443,241,469"/>
<area shape="rect" href="classCrypt__Base.html#a1cc0bf8f079a276e5d518ac53443fa31" title="String Pop." alt="" coords="355,293,453,318"/>
<area shape="rect" href="classCrypt__Base.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="336,93,472,118"/>
<area shape="rect" href="classCrypt__Base.html#aad783e9c1c4fc5e3d8e312f08dd36f68" title="Setup the key (expansion)" alt="" coords="359,142,449,167"/>
</map>
</div>

</div>
</div>
<a id="abfa3ada55a183bec17f12b630f8cfac5" name="abfa3ada55a183bec17f12b630f8cfac5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfa3ada55a183bec17f12b630f8cfac5">&#9670;&#160;</a></span>disableContinuousBuffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">disableContinuousBuffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Treat consecutive packets as if they are a discontinuous buffer. </p>
<p>The default behavior.</p>
<dl class="section see"><dt>See also</dt><dd>self::enableContinuousBuffer() @access public </dd></dl>

<p>Reimplemented in <a class="el" href="classCrypt__TripleDES.html#abfa3ada55a183bec17f12b630f8cfac5">Crypt_TripleDES</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01596">1596</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1597</span>    {</div>
<div class="line"><span class="lineno"> 1598</span>        <span class="keywordflow">if</span> ($this-&gt;mode == <a class="code hl_variable" href="Base_8php.html#ace7687420bc69da6192bc40c8a061804">CRYPT_MODE_ECB</a>) {</div>
<div class="line"><span class="lineno"> 1599</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1600</span>        }</div>
<div class="line"><span class="lineno"> 1601</span>        <span class="keywordflow">if</span> (!$this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1602</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1603</span>        }</div>
<div class="line"><span class="lineno"> 1604</span> </div>
<div class="line"><span class="lineno"> 1605</span>        $this-&gt;continuousBuffer = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1606</span>        $this-&gt;changed = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1607</span> </div>
<div class="line"><span class="lineno"> 1608</span>        $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#ab4e58314adec23125fc08ae86aa501e3">_setEngine</a>();</div>
<div class="line"><span class="lineno"> 1609</span>    }</div>
<div class="ttc" id="aclassCrypt__Base_html_ab4e58314adec23125fc08ae86aa501e3"><div class="ttname"><a href="classCrypt__Base.html#ab4e58314adec23125fc08ae86aa501e3">Crypt_Base\_setEngine</a></div><div class="ttdeci">_setEngine()</div><div class="ttdoc">Sets the engine as appropriate.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l01720">Base.php:1720</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l01720">_setEngine()</a>, and <a class="el" href="Base_8php_source.html#l00073">CRYPT_MODE_ECB</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_abfa3ada55a183bec17f12b630f8cfac5_cgraph.png" border="0" usemap="#aclassCrypt__Base_abfa3ada55a183bec17f12b630f8cfac5_cgraph" alt=""/></div>
<map name="aclassCrypt__Base_abfa3ada55a183bec17f12b630f8cfac5_cgraph" id="aclassCrypt__Base_abfa3ada55a183bec17f12b630f8cfac5_cgraph">
<area shape="rect" title="Treat consecutive packets as if they are a discontinuous buffer." alt="" coords="5,5,187,31"/>
<area shape="rect" href="classCrypt__Base.html#ab4e58314adec23125fc08ae86aa501e3" title="Sets the engine as appropriate." alt="" coords="235,5,328,31"/>
<area shape="rect" href="classCrypt__Base.html#ae62f456da9bef718ecc3e155d63f0dc8" title="Test for engine validity." alt="" coords="376,5,485,31"/>
</map>
</div>

</div>
</div>
<a id="a80e40051c6fe78e15a70e162dca32010" name="a80e40051c6fe78e15a70e162dca32010"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80e40051c6fe78e15a70e162dca32010">&#9670;&#160;</a></span>disablePadding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">disablePadding </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do not pad packets. </p>
<dl class="section see"><dt>See also</dt><dd>self::enablePadding() @access public </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01533">1533</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1534</span>    {</div>
<div class="line"><span class="lineno"> 1535</span>        $this-&gt;padding = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1536</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aff97cfdb1f997aedfc7a2093602e8409" name="aff97cfdb1f997aedfc7a2093602e8409"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff97cfdb1f997aedfc7a2093602e8409">&#9670;&#160;</a></span>do_nothing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">do_nothing </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dummy error handler to suppress mcrypt errors. </p>
<p>@access private </p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l02683">2683</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2684</span>    {</div>
<div class="line"><span class="lineno"> 2685</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8ff793379f109d2e0f62e942c1c5ba5" name="ab8ff793379f109d2e0f62e942c1c5ba5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8ff793379f109d2e0f62e942c1c5ba5">&#9670;&#160;</a></span>enableContinuousBuffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enableContinuousBuffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Treat consecutive "packets" as if they are a continuous buffer. </p>
<p>Say you have a 32-byte plaintext $plaintext. Using the default behavior, the two following code snippets will yield different outputs:</p>
<p><code> echo $rijndael-&gt;encrypt(substr($plaintext, 0, 16)); echo $rijndael-&gt;encrypt(substr($plaintext, 16, 16)); </code> <code> echo $rijndael-&gt;encrypt($plaintext); </code></p>
<p>The solution is to enable the continuous buffer. Although this will resolve the above discrepancy, it creates another, as demonstrated with the following:</p>
<p><code> $rijndael-&gt;encrypt(substr($plaintext, 0, 16)); echo $rijndael-&gt;decrypt($rijndael-&gt;encrypt(substr($plaintext, 16, 16))); </code> <code> echo $rijndael-&gt;decrypt($rijndael-&gt;encrypt(substr($plaintext, 16, 16))); </code></p>
<p>With the continuous buffer disabled, these would yield the same output. With it enabled, they yield different outputs. The reason is due to the fact that the initialization vector's change after every encryption / decryption round when the continuous buffer is enabled. When it's disabled, they remain constant.</p>
<p>Put another way, when the continuous buffer is enabled, the state of the Crypt_*() object changes after each encryption / decryption round, whereas otherwise, it'd remain constant. For this reason, it's recommended that continuous buffers not be used. They do offer better security and are, in fact, sometimes required (SSH uses them), however, they are also less intuitive and more likely to cause you problems.</p>
<dl class="section see"><dt>See also</dt><dd>self::disableContinuousBuffer() @access public </dd></dl>

<p>Reimplemented in <a class="el" href="classCrypt__TripleDES.html#ab8ff793379f109d2e0f62e942c1c5ba5">Crypt_TripleDES</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01576">1576</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1577</span>    {</div>
<div class="line"><span class="lineno"> 1578</span>        <span class="keywordflow">if</span> ($this-&gt;mode == <a class="code hl_variable" href="Base_8php.html#ace7687420bc69da6192bc40c8a061804">CRYPT_MODE_ECB</a>) {</div>
<div class="line"><span class="lineno"> 1579</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1580</span>        }</div>
<div class="line"><span class="lineno"> 1581</span> </div>
<div class="line"><span class="lineno"> 1582</span>        $this-&gt;continuousBuffer = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1583</span> </div>
<div class="line"><span class="lineno"> 1584</span>        $this-&gt;_setEngine();</div>
<div class="line"><span class="lineno"> 1585</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l01720">_setEngine()</a>, and <a class="el" href="Base_8php_source.html#l00073">CRYPT_MODE_ECB</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_ab8ff793379f109d2e0f62e942c1c5ba5_cgraph.png" border="0" usemap="#aclassCrypt__Base_ab8ff793379f109d2e0f62e942c1c5ba5_cgraph" alt=""/></div>
<map name="aclassCrypt__Base_ab8ff793379f109d2e0f62e942c1c5ba5_cgraph" id="aclassCrypt__Base_ab8ff793379f109d2e0f62e942c1c5ba5_cgraph">
<area shape="rect" title="Treat consecutive &quot;packets&quot; as if they are a continuous buffer." alt="" coords="5,5,184,31"/>
<area shape="rect" href="classCrypt__Base.html#ab4e58314adec23125fc08ae86aa501e3" title="Sets the engine as appropriate." alt="" coords="232,5,325,31"/>
<area shape="rect" href="classCrypt__Base.html#ae62f456da9bef718ecc3e155d63f0dc8" title="Test for engine validity." alt="" coords="373,5,483,31"/>
</map>
</div>

</div>
</div>
<a id="aa5d80da425e83888700a2bd9a4f19290" name="aa5d80da425e83888700a2bd9a4f19290"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5d80da425e83888700a2bd9a4f19290">&#9670;&#160;</a></span>enablePadding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enablePadding </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pad "packets". </p>
<p>Block ciphers working by encrypting between their specified [$this-&gt;]block_size at a time If you ever need to encrypt or decrypt something that isn't of the proper length, it becomes necessary to pad the input so that it is of the proper length.</p>
<p>Padding is enabled by default. Sometimes, however, it is undesirable to pad strings. Such is the case in SSH, where "packets" are padded with random bytes before being encrypted. Unpad these packets and you risk stripping away characters that shouldn't be stripped away. (SSH knows how many bytes are added because the length is transmitted separately)</p>
<dl class="section see"><dt>See also</dt><dd>self::disablePadding() @access public </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01522">1522</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1523</span>    {</div>
<div class="line"><span class="lineno"> 1524</span>        $this-&gt;padding = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1525</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5ceadf7c30ea677b755c6085b23f2a5" name="aa5ceadf7c30ea677b755c6085b23f2a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5ceadf7c30ea677b755c6085b23f2a5">&#9670;&#160;</a></span>encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encrypt </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$plaintext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts a message. </p>
<p>$plaintext will be padded with additional bytes such that it's length is a multiple of the block size. Other cipher implementations may or may not pad in the same manner. Other common approaches to padding and the reasons why it's necessary are discussed in the following URL:</p>
<p><code><a class="el" href=""><a href="http://www.di-mgt.com.au/cryptopad.html">http://www.di-mgt.com.au/cryptopad.html</a></a></code></p>
<p>An alternative to padding is to, separately, send the length of the file. This is what SSH, in fact, does. strlen($plaintext) will still need to be a multiple of the block size, however, arbitrary values can be added to make it that length.</p>
<dl class="section see"><dt>See also</dt><dd>self::decrypt() @access public </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$plaintext</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string $ciphertext </dd></dl>

<p>Reimplemented in <a class="el" href="classCrypt__RC2.html#aa5ceadf7c30ea677b755c6085b23f2a5">Crypt_RC2</a>, <a class="el" href="classCrypt__RC4.html#aa5ceadf7c30ea677b755c6085b23f2a5">Crypt_RC4</a>, and <a class="el" href="classCrypt__TripleDES.html#aa5ceadf7c30ea677b755c6085b23f2a5">Crypt_TripleDES</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00744">744</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  745</span>    {</div>
<div class="line"><span class="lineno">  746</span>        <span class="keywordflow">if</span> ($this-&gt;paddable) {</div>
<div class="line"><span class="lineno">  747</span>            $plaintext = $this-&gt;_pad($plaintext);</div>
<div class="line"><span class="lineno">  748</span>        }</div>
<div class="line"><span class="lineno">  749</span> </div>
<div class="line"><span class="lineno">  750</span>        <span class="keywordflow">if</span> ($this-&gt;engine === <a class="code hl_variable" href="Base_8php.html#a8f1200db8ddce5bab18ddeec03362215">CRYPT_ENGINE_OPENSSL</a>) {</div>
<div class="line"><span class="lineno">  751</span>            <span class="keywordflow">if</span> ($this-&gt;changed) {</div>
<div class="line"><span class="lineno">  752</span>                $this-&gt;_clearBuffers();</div>
<div class="line"><span class="lineno">  753</span>                $this-&gt;changed = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  754</span>            }</div>
<div class="line"><span class="lineno">  755</span>            <span class="keywordflow">switch</span> ($this-&gt;mode) {</div>
<div class="line"><span class="lineno">  756</span>                <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#adaa3d4f69333325e047270ae0d58bcaa">CRYPT_MODE_STREAM</a>:</div>
<div class="line"><span class="lineno">  757</span>                    <span class="keywordflow">return</span> openssl_encrypt($plaintext, $this-&gt;cipher_name_openssl, $this-&gt;key, $this-&gt;openssl_options);</div>
<div class="line"><span class="lineno">  758</span>                <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#ace7687420bc69da6192bc40c8a061804">CRYPT_MODE_ECB</a>:</div>
<div class="line"><span class="lineno">  759</span>                    $result = @openssl_encrypt($plaintext, $this-&gt;cipher_name_openssl, $this-&gt;key, $this-&gt;openssl_options);</div>
<div class="line"><span class="lineno">  760</span>                    <span class="keywordflow">return</span> !defined(<span class="stringliteral">&#39;OPENSSL_RAW_DATA&#39;</span>) ? substr($result, 0, -$this-&gt;block_size) : $result;</div>
<div class="line"><span class="lineno">  761</span>                <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a766af87a1190a65dd937ce94ef962400">CRYPT_MODE_CBC</a>:</div>
<div class="line"><span class="lineno">  762</span>                    $result = openssl_encrypt($plaintext, $this-&gt;cipher_name_openssl, $this-&gt;key, $this-&gt;openssl_options, $this-&gt;encryptIV);</div>
<div class="line"><span class="lineno">  763</span>                    <span class="keywordflow">if</span> (!defined(<span class="stringliteral">&#39;OPENSSL_RAW_DATA&#39;</span>)) {</div>
<div class="line"><span class="lineno">  764</span>                        $result = substr($result, 0, -$this-&gt;block_size);</div>
<div class="line"><span class="lineno">  765</span>                    }</div>
<div class="line"><span class="lineno">  766</span>                    <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno">  767</span>                        $this-&gt;encryptIV = substr($result, -$this-&gt;block_size);</div>
<div class="line"><span class="lineno">  768</span>                    }</div>
<div class="line"><span class="lineno">  769</span>                    <span class="keywordflow">return</span> $result;</div>
<div class="line"><span class="lineno">  770</span>                <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a4204f1d2beaf41a2b97967cbea0ef666">CRYPT_MODE_CTR</a>:</div>
<div class="line"><span class="lineno">  771</span>                    <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a7aaf3600e103d90572ffd029d81707d1">_openssl_ctr_process</a>($plaintext, $this-&gt;encryptIV, $this-&gt;enbuffer);</div>
<div class="line"><span class="lineno">  772</span>                <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#aa1a1e45bef3380f6e5c0a1c8fa4dad46">CRYPT_MODE_CFB</a>:</div>
<div class="line"><span class="lineno">  773</span>                    <span class="comment">// cfb loosely routines inspired by openssl&#39;s:</span></div>
<div class="line"><span class="lineno">  774</span>                    <span class="comment">// {@link http://cvs.openssl.org/fileview?f=openssl/crypto/modes/cfb128.c&amp;v=1.3.2.2.2.1}</span></div>
<div class="line"><span class="lineno">  775</span>                    $ciphertext = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  776</span>                    <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno">  777</span>                        <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = &amp;$this-&gt;encryptIV;</div>
<div class="line"><span class="lineno">  778</span>                        $pos = &amp;$this-&gt;enbuffer[<span class="stringliteral">&#39;pos&#39;</span>];</div>
<div class="line"><span class="lineno">  779</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  780</span>                        <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = $this-&gt;encryptIV;</div>
<div class="line"><span class="lineno">  781</span>                        $pos = 0;</div>
<div class="line"><span class="lineno">  782</span>                    }</div>
<div class="line"><span class="lineno">  783</span>                    $len = strlen($plaintext);</div>
<div class="line"><span class="lineno">  784</span>                    $i = 0;</div>
<div class="line"><span class="lineno">  785</span>                    <span class="keywordflow">if</span> ($pos) {</div>
<div class="line"><span class="lineno">  786</span>                        $orig_pos = $pos;</div>
<div class="line"><span class="lineno">  787</span>                        $max = $this-&gt;block_size - $pos;</div>
<div class="line"><span class="lineno">  788</span>                        <span class="keywordflow">if</span> ($len &gt;= $max) {</div>
<div class="line"><span class="lineno">  789</span>                            $i = $max;</div>
<div class="line"><span class="lineno">  790</span>                            $len-= $max;</div>
<div class="line"><span class="lineno">  791</span>                            $pos = 0;</div>
<div class="line"><span class="lineno">  792</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  793</span>                            $i = $len;</div>
<div class="line"><span class="lineno">  794</span>                            $pos+= $len;</div>
<div class="line"><span class="lineno">  795</span>                            $len = 0;</div>
<div class="line"><span class="lineno">  796</span>                        }</div>
<div class="line"><span class="lineno">  797</span>                        <span class="comment">// ie. $i = min($max, $len), $len-= $i, $pos+= $i, $pos%= $blocksize</span></div>
<div class="line"><span class="lineno">  798</span>                        $ciphertext = substr($iv, $orig_pos) ^ $plaintext;</div>
<div class="line"><span class="lineno">  799</span>                        <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr_replace($iv, $ciphertext, $orig_pos, $i);</div>
<div class="line"><span class="lineno">  800</span>                        $plaintext = substr($plaintext, $i);</div>
<div class="line"><span class="lineno">  801</span>                    }</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>                    $overflow = $len % $this-&gt;block_size;</div>
<div class="line"><span class="lineno">  804</span> </div>
<div class="line"><span class="lineno">  805</span>                    <span class="keywordflow">if</span> ($overflow) {</div>
<div class="line"><span class="lineno">  806</span>                        $ciphertext.= openssl_encrypt(substr($plaintext, 0, -$overflow) . str_repeat(<span class="stringliteral">&quot;\0&quot;</span>, $this-&gt;block_size), $this-&gt;cipher_name_openssl, $this-&gt;key, $this-&gt;openssl_options, $iv);</div>
<div class="line"><span class="lineno">  807</span>                        <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a1cc0bf8f079a276e5d518ac53443fa31">_string_pop</a>($ciphertext, $this-&gt;block_size);</div>
<div class="line"><span class="lineno">  808</span> </div>
<div class="line"><span class="lineno">  809</span>                        $size = $len - $overflow;</div>
<div class="line"><span class="lineno">  810</span>                        $block = <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> ^ substr($plaintext, -$overflow);</div>
<div class="line"><span class="lineno">  811</span>                        <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr_replace($iv, $block, 0, $overflow);</div>
<div class="line"><span class="lineno">  812</span>                        $ciphertext.= $block;</div>
<div class="line"><span class="lineno">  813</span>                        $pos = $overflow;</div>
<div class="line"><span class="lineno">  814</span>                    } elseif ($len) {</div>
<div class="line"><span class="lineno">  815</span>                        $ciphertext = openssl_encrypt($plaintext, $this-&gt;cipher_name_openssl, $this-&gt;key, $this-&gt;openssl_options, $iv);</div>
<div class="line"><span class="lineno">  816</span>                        <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr($ciphertext, -$this-&gt;block_size);</div>
<div class="line"><span class="lineno">  817</span>                    }</div>
<div class="line"><span class="lineno">  818</span> </div>
<div class="line"><span class="lineno">  819</span>                    <span class="keywordflow">return</span> $ciphertext;</div>
<div class="line"><span class="lineno">  820</span>                <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#af9423638549fc5c52db69b66560614ef">CRYPT_MODE_OFB</a>:</div>
<div class="line"><span class="lineno">  821</span>                    <span class="keywordflow">return</span> $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#ac1b2f723636fe01c4aa90fb201384110">_openssl_ofb_process</a>($plaintext, $this-&gt;encryptIV, $this-&gt;enbuffer);</div>
<div class="line"><span class="lineno">  822</span>            }</div>
<div class="line"><span class="lineno">  823</span>        }</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>        <span class="keywordflow">if</span> ($this-&gt;engine === <a class="code hl_variable" href="Base_8php.html#aec1c8f2a4ace0050f6457c9c61bf8310">CRYPT_ENGINE_MCRYPT</a>) {</div>
<div class="line"><span class="lineno">  826</span>            set_error_handler(array($this, <span class="stringliteral">&#39;do_nothing&#39;</span>));</div>
<div class="line"><span class="lineno">  827</span>            <span class="keywordflow">if</span> ($this-&gt;changed) {</div>
<div class="line"><span class="lineno">  828</span>                $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#af55698320880af8999c954bad4544a86">_setupMcrypt</a>();</div>
<div class="line"><span class="lineno">  829</span>                $this-&gt;changed = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  830</span>            }</div>
<div class="line"><span class="lineno">  831</span>            <span class="keywordflow">if</span> ($this-&gt;enchanged) {</div>
<div class="line"><span class="lineno">  832</span>                mcrypt_generic_init($this-&gt;enmcrypt, $this-&gt;key, $this-&gt;encryptIV);</div>
<div class="line"><span class="lineno">  833</span>                $this-&gt;enchanged = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  834</span>            }</div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>            <span class="comment">// re: {@link http://phpseclib.sourceforge.net/cfb-demo.phps}</span></div>
<div class="line"><span class="lineno">  837</span>            <span class="comment">// using mcrypt&#39;s default handing of CFB the above would output two different things.  using phpseclib&#39;s</span></div>
<div class="line"><span class="lineno">  838</span>            <span class="comment">// rewritten CFB implementation the above outputs the same thing twice.</span></div>
<div class="line"><span class="lineno">  839</span>            <span class="keywordflow">if</span> ($this-&gt;mode == <a class="code hl_variable" href="Base_8php.html#aa1a1e45bef3380f6e5c0a1c8fa4dad46">CRYPT_MODE_CFB</a> &amp;&amp; $this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno">  840</span>                <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a> = $this-&gt;block_size;</div>
<div class="line"><span class="lineno">  841</span>                <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = &amp;$this-&gt;encryptIV;</div>
<div class="line"><span class="lineno">  842</span>                $pos = &amp;$this-&gt;enbuffer[<span class="stringliteral">&#39;pos&#39;</span>];</div>
<div class="line"><span class="lineno">  843</span>                $len = strlen($plaintext);</div>
<div class="line"><span class="lineno">  844</span>                $ciphertext = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  845</span>                $i = 0;</div>
<div class="line"><span class="lineno">  846</span>                <span class="keywordflow">if</span> ($pos) {</div>
<div class="line"><span class="lineno">  847</span>                    $orig_pos = $pos;</div>
<div class="line"><span class="lineno">  848</span>                    $max = <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a> - $pos;</div>
<div class="line"><span class="lineno">  849</span>                    <span class="keywordflow">if</span> ($len &gt;= $max) {</div>
<div class="line"><span class="lineno">  850</span>                        $i = $max;</div>
<div class="line"><span class="lineno">  851</span>                        $len-= $max;</div>
<div class="line"><span class="lineno">  852</span>                        $pos = 0;</div>
<div class="line"><span class="lineno">  853</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  854</span>                        $i = $len;</div>
<div class="line"><span class="lineno">  855</span>                        $pos+= $len;</div>
<div class="line"><span class="lineno">  856</span>                        $len = 0;</div>
<div class="line"><span class="lineno">  857</span>                    }</div>
<div class="line"><span class="lineno">  858</span>                    $ciphertext = substr($iv, $orig_pos) ^ $plaintext;</div>
<div class="line"><span class="lineno">  859</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr_replace($iv, $ciphertext, $orig_pos, $i);</div>
<div class="line"><span class="lineno">  860</span>                    $this-&gt;enbuffer[<span class="stringliteral">&#39;enmcrypt_init&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  861</span>                }</div>
<div class="line"><span class="lineno">  862</span>                <span class="keywordflow">if</span> ($len &gt;= $block_size) {</div>
<div class="line"><span class="lineno">  863</span>                    <span class="keywordflow">if</span> ($this-&gt;enbuffer[<span class="stringliteral">&#39;enmcrypt_init&#39;</span>] === <span class="keyword">false</span> || $len &gt; $this-&gt;cfb_init_len) {</div>
<div class="line"><span class="lineno">  864</span>                        <span class="keywordflow">if</span> ($this-&gt;enbuffer[<span class="stringliteral">&#39;enmcrypt_init&#39;</span>] === <span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  865</span>                            mcrypt_generic_init($this-&gt;enmcrypt, $this-&gt;key, $iv);</div>
<div class="line"><span class="lineno">  866</span>                            $this-&gt;enbuffer[<span class="stringliteral">&#39;enmcrypt_init&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  867</span>                        }</div>
<div class="line"><span class="lineno">  868</span>                        $ciphertext.= mcrypt_generic($this-&gt;enmcrypt, substr($plaintext, $i, $len - $len % $block_size));</div>
<div class="line"><span class="lineno">  869</span>                        <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr($ciphertext, -$block_size);</div>
<div class="line"><span class="lineno">  870</span>                        $len%= <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>;</div>
<div class="line"><span class="lineno">  871</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  872</span>                        <span class="keywordflow">while</span> ($len &gt;= $block_size) {</div>
<div class="line"><span class="lineno">  873</span>                            <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = mcrypt_generic($this-&gt;ecb, $iv) ^ substr($plaintext, $i, $block_size);</div>
<div class="line"><span class="lineno">  874</span>                            $ciphertext.= <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a>;</div>
<div class="line"><span class="lineno">  875</span>                            $len-= <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>;</div>
<div class="line"><span class="lineno">  876</span>                            $i+= <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>;</div>
<div class="line"><span class="lineno">  877</span>                        }</div>
<div class="line"><span class="lineno">  878</span>                    }</div>
<div class="line"><span class="lineno">  879</span>                }</div>
<div class="line"><span class="lineno">  880</span> </div>
<div class="line"><span class="lineno">  881</span>                <span class="keywordflow">if</span> ($len) {</div>
<div class="line"><span class="lineno">  882</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = mcrypt_generic($this-&gt;ecb, $iv);</div>
<div class="line"><span class="lineno">  883</span>                    $block = <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> ^ substr($plaintext, -$len);</div>
<div class="line"><span class="lineno">  884</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr_replace($iv, $block, 0, $len);</div>
<div class="line"><span class="lineno">  885</span>                    $ciphertext.= $block;</div>
<div class="line"><span class="lineno">  886</span>                    $pos = $len;</div>
<div class="line"><span class="lineno">  887</span>                }</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span>                restore_error_handler();</div>
<div class="line"><span class="lineno">  890</span> </div>
<div class="line"><span class="lineno">  891</span>                <span class="keywordflow">return</span> $ciphertext;</div>
<div class="line"><span class="lineno">  892</span>            }</div>
<div class="line"><span class="lineno">  893</span> </div>
<div class="line"><span class="lineno">  894</span>            $ciphertext = mcrypt_generic($this-&gt;enmcrypt, $plaintext);</div>
<div class="line"><span class="lineno">  895</span> </div>
<div class="line"><span class="lineno">  896</span>            <span class="keywordflow">if</span> (!$this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno">  897</span>                mcrypt_generic_init($this-&gt;enmcrypt, $this-&gt;key, $this-&gt;encryptIV);</div>
<div class="line"><span class="lineno">  898</span>            }</div>
<div class="line"><span class="lineno">  899</span> </div>
<div class="line"><span class="lineno">  900</span>            restore_error_handler();</div>
<div class="line"><span class="lineno">  901</span> </div>
<div class="line"><span class="lineno">  902</span>            <span class="keywordflow">return</span> $ciphertext;</div>
<div class="line"><span class="lineno">  903</span>        }</div>
<div class="line"><span class="lineno">  904</span> </div>
<div class="line"><span class="lineno">  905</span>        <span class="keywordflow">if</span> ($this-&gt;changed) {</div>
<div class="line"><span class="lineno">  906</span>            $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a893edf931eab08c67a70d2e93bbf8c11">_setup</a>();</div>
<div class="line"><span class="lineno">  907</span>            $this-&gt;changed = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  908</span>        }</div>
<div class="line"><span class="lineno">  909</span>        <span class="keywordflow">if</span> ($this-&gt;use_inline_crypt) {</div>
<div class="line"><span class="lineno">  910</span>            $inline = $this-&gt;inline_crypt;</div>
<div class="line"><span class="lineno">  911</span>            <span class="keywordflow">return</span> $inline(<span class="stringliteral">&#39;encrypt&#39;</span>, $this, $plaintext);</div>
<div class="line"><span class="lineno">  912</span>        }</div>
<div class="line"><span class="lineno">  913</span> </div>
<div class="line"><span class="lineno">  914</span>        $buffer = &amp;$this-&gt;enbuffer;</div>
<div class="line"><span class="lineno">  915</span>        <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a> = $this-&gt;block_size;</div>
<div class="line"><span class="lineno">  916</span>        $ciphertext = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  917</span>        <span class="keywordflow">switch</span> ($this-&gt;mode) {</div>
<div class="line"><span class="lineno">  918</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#ace7687420bc69da6192bc40c8a061804">CRYPT_MODE_ECB</a>:</div>
<div class="line"><span class="lineno">  919</span>                <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($plaintext); $i+=<a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>) {</div>
<div class="line"><span class="lineno">  920</span>                    $ciphertext.= $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a>(substr($plaintext, $i, $block_size));</div>
<div class="line"><span class="lineno">  921</span>                }</div>
<div class="line"><span class="lineno">  922</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  923</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a766af87a1190a65dd937ce94ef962400">CRYPT_MODE_CBC</a>:</div>
<div class="line"><span class="lineno">  924</span>                $xor = $this-&gt;encryptIV;</div>
<div class="line"><span class="lineno">  925</span>                <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($plaintext); $i+=<a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>) {</div>
<div class="line"><span class="lineno">  926</span>                    $block = substr($plaintext, $i, $block_size);</div>
<div class="line"><span class="lineno">  927</span>                    $block = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a>($block ^ $xor);</div>
<div class="line"><span class="lineno">  928</span>                    $xor = $block;</div>
<div class="line"><span class="lineno">  929</span>                    $ciphertext.= $block;</div>
<div class="line"><span class="lineno">  930</span>                }</div>
<div class="line"><span class="lineno">  931</span>                <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno">  932</span>                    $this-&gt;encryptIV = $xor;</div>
<div class="line"><span class="lineno">  933</span>                }</div>
<div class="line"><span class="lineno">  934</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  935</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a4204f1d2beaf41a2b97967cbea0ef666">CRYPT_MODE_CTR</a>:</div>
<div class="line"><span class="lineno">  936</span>                $xor = $this-&gt;encryptIV;</div>
<div class="line"><span class="lineno">  937</span>                <span class="keywordflow">if</span> (strlen($buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>])) {</div>
<div class="line"><span class="lineno">  938</span>                    <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($plaintext); $i+=<a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>) {</div>
<div class="line"><span class="lineno">  939</span>                        $block = substr($plaintext, $i, $block_size);</div>
<div class="line"><span class="lineno">  940</span>                        <span class="keywordflow">if</span> (strlen($block) &gt; strlen($buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>])) {</div>
<div class="line"><span class="lineno">  941</span>                            $buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>].= $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a>($xor);</div>
<div class="line"><span class="lineno">  942</span>                        }</div>
<div class="line"><span class="lineno">  943</span>                        $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a412f868848015dec037f640c385f37be">_increment_str</a>($xor);</div>
<div class="line"><span class="lineno">  944</span>                        <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a> = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>], $block_size);</div>
<div class="line"><span class="lineno">  945</span>                        $ciphertext.= $block ^ <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a>;</div>
<div class="line"><span class="lineno">  946</span>                    }</div>
<div class="line"><span class="lineno">  947</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  948</span>                    <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($plaintext); $i+=<a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>) {</div>
<div class="line"><span class="lineno">  949</span>                        $block = substr($plaintext, $i, $block_size);</div>
<div class="line"><span class="lineno">  950</span>                        <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a> = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a>($xor);</div>
<div class="line"><span class="lineno">  951</span>                        $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a412f868848015dec037f640c385f37be">_increment_str</a>($xor);</div>
<div class="line"><span class="lineno">  952</span>                        $ciphertext.= $block ^ <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a>;</div>
<div class="line"><span class="lineno">  953</span>                    }</div>
<div class="line"><span class="lineno">  954</span>                }</div>
<div class="line"><span class="lineno">  955</span>                <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno">  956</span>                    $this-&gt;encryptIV = $xor;</div>
<div class="line"><span class="lineno">  957</span>                    <span class="keywordflow">if</span> ($start = strlen($plaintext) % $block_size) {</div>
<div class="line"><span class="lineno">  958</span>                        $buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>] = substr($key, $start) . $buffer[<span class="stringliteral">&#39;ciphertext&#39;</span>];</div>
<div class="line"><span class="lineno">  959</span>                    }</div>
<div class="line"><span class="lineno">  960</span>                }</div>
<div class="line"><span class="lineno">  961</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  962</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#aa1a1e45bef3380f6e5c0a1c8fa4dad46">CRYPT_MODE_CFB</a>:</div>
<div class="line"><span class="lineno">  963</span>                <span class="comment">// cfb loosely routines inspired by openssl&#39;s:</span></div>
<div class="line"><span class="lineno">  964</span>                <span class="comment">// {@link http://cvs.openssl.org/fileview?f=openssl/crypto/modes/cfb128.c&amp;v=1.3.2.2.2.1}</span></div>
<div class="line"><span class="lineno">  965</span>                <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno">  966</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = &amp;$this-&gt;encryptIV;</div>
<div class="line"><span class="lineno">  967</span>                    $pos = &amp;$buffer[<span class="stringliteral">&#39;pos&#39;</span>];</div>
<div class="line"><span class="lineno">  968</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  969</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = $this-&gt;encryptIV;</div>
<div class="line"><span class="lineno">  970</span>                    $pos = 0;</div>
<div class="line"><span class="lineno">  971</span>                }</div>
<div class="line"><span class="lineno">  972</span>                $len = strlen($plaintext);</div>
<div class="line"><span class="lineno">  973</span>                $i = 0;</div>
<div class="line"><span class="lineno">  974</span>                <span class="keywordflow">if</span> ($pos) {</div>
<div class="line"><span class="lineno">  975</span>                    $orig_pos = $pos;</div>
<div class="line"><span class="lineno">  976</span>                    $max = <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a> - $pos;</div>
<div class="line"><span class="lineno">  977</span>                    <span class="keywordflow">if</span> ($len &gt;= $max) {</div>
<div class="line"><span class="lineno">  978</span>                        $i = $max;</div>
<div class="line"><span class="lineno">  979</span>                        $len-= $max;</div>
<div class="line"><span class="lineno">  980</span>                        $pos = 0;</div>
<div class="line"><span class="lineno">  981</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  982</span>                        $i = $len;</div>
<div class="line"><span class="lineno">  983</span>                        $pos+= $len;</div>
<div class="line"><span class="lineno">  984</span>                        $len = 0;</div>
<div class="line"><span class="lineno">  985</span>                    }</div>
<div class="line"><span class="lineno">  986</span>                    <span class="comment">// ie. $i = min($max, $len), $len-= $i, $pos+= $i, $pos%= $blocksize</span></div>
<div class="line"><span class="lineno">  987</span>                    $ciphertext = substr($iv, $orig_pos) ^ $plaintext;</div>
<div class="line"><span class="lineno">  988</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr_replace($iv, $ciphertext, $orig_pos, $i);</div>
<div class="line"><span class="lineno">  989</span>                }</div>
<div class="line"><span class="lineno">  990</span>                <span class="keywordflow">while</span> ($len &gt;= $block_size) {</div>
<div class="line"><span class="lineno">  991</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a>($iv) ^ substr($plaintext, $i, $block_size);</div>
<div class="line"><span class="lineno">  992</span>                    $ciphertext.= <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a>;</div>
<div class="line"><span class="lineno">  993</span>                    $len-= <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>;</div>
<div class="line"><span class="lineno">  994</span>                    $i+= <a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>;</div>
<div class="line"><span class="lineno">  995</span>                }</div>
<div class="line"><span class="lineno">  996</span>                <span class="keywordflow">if</span> ($len) {</div>
<div class="line"><span class="lineno">  997</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a>($iv);</div>
<div class="line"><span class="lineno">  998</span>                    $block = <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> ^ substr($plaintext, $i);</div>
<div class="line"><span class="lineno">  999</span>                    <a class="code hl_variable" href="classCrypt__Base.html#a147a28261cd10fb6dbdae31eb0a89c8d">$iv</a> = substr_replace($iv, $block, 0, $len);</div>
<div class="line"><span class="lineno"> 1000</span>                    $ciphertext.= $block;</div>
<div class="line"><span class="lineno"> 1001</span>                    $pos = $len;</div>
<div class="line"><span class="lineno"> 1002</span>                }</div>
<div class="line"><span class="lineno"> 1003</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1004</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#af9423638549fc5c52db69b66560614ef">CRYPT_MODE_OFB</a>:</div>
<div class="line"><span class="lineno"> 1005</span>                $xor = $this-&gt;encryptIV;</div>
<div class="line"><span class="lineno"> 1006</span>                <span class="keywordflow">if</span> (strlen($buffer[<span class="stringliteral">&#39;xor&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1007</span>                    <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($plaintext); $i+=<a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>) {</div>
<div class="line"><span class="lineno"> 1008</span>                        $block = substr($plaintext, $i, $block_size);</div>
<div class="line"><span class="lineno"> 1009</span>                        <span class="keywordflow">if</span> (strlen($block) &gt; strlen($buffer[<span class="stringliteral">&#39;xor&#39;</span>])) {</div>
<div class="line"><span class="lineno"> 1010</span>                            $xor = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a>($xor);</div>
<div class="line"><span class="lineno"> 1011</span>                            $buffer[<span class="stringliteral">&#39;xor&#39;</span>].= $xor;</div>
<div class="line"><span class="lineno"> 1012</span>                        }</div>
<div class="line"><span class="lineno"> 1013</span>                        <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a> = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#ab009fa6f4ba09daa679a30e9b5bcfe35">_string_shift</a>($buffer[<span class="stringliteral">&#39;xor&#39;</span>], $block_size);</div>
<div class="line"><span class="lineno"> 1014</span>                        $ciphertext.= $block ^ <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a>;</div>
<div class="line"><span class="lineno"> 1015</span>                    }</div>
<div class="line"><span class="lineno"> 1016</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1017</span>                    <span class="keywordflow">for</span> ($i = 0; $i &lt; strlen($plaintext); $i+=<a class="code hl_variable" href="classCrypt__Base.html#ace0c858100bed2086051616b5c9f896e">$block_size</a>) {</div>
<div class="line"><span class="lineno"> 1018</span>                        $xor = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a>($xor);</div>
<div class="line"><span class="lineno"> 1019</span>                        $ciphertext.= substr($plaintext, $i, $block_size) ^ $xor;</div>
<div class="line"><span class="lineno"> 1020</span>                    }</div>
<div class="line"><span class="lineno"> 1021</span>                    <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a> = $xor;</div>
<div class="line"><span class="lineno"> 1022</span>                }</div>
<div class="line"><span class="lineno"> 1023</span>                <span class="keywordflow">if</span> ($this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1024</span>                    $this-&gt;encryptIV = $xor;</div>
<div class="line"><span class="lineno"> 1025</span>                    <span class="keywordflow">if</span> ($start = strlen($plaintext) % $block_size) {</div>
<div class="line"><span class="lineno"> 1026</span>                        $buffer[<span class="stringliteral">&#39;xor&#39;</span>] = substr($key, $start) . $buffer[<span class="stringliteral">&#39;xor&#39;</span>];</div>
<div class="line"><span class="lineno"> 1027</span>                    }</div>
<div class="line"><span class="lineno"> 1028</span>                }</div>
<div class="line"><span class="lineno"> 1029</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1030</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#adaa3d4f69333325e047270ae0d58bcaa">CRYPT_MODE_STREAM</a>:</div>
<div class="line"><span class="lineno"> 1031</span>                $ciphertext = $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2">_encryptBlock</a>($plaintext);</div>
<div class="line"><span class="lineno"> 1032</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1033</span>        }</div>
<div class="line"><span class="lineno"> 1034</span> </div>
<div class="line"><span class="lineno"> 1035</span>        <span class="keywordflow">return</span> $ciphertext;</div>
<div class="line"><span class="lineno"> 1036</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l01955">_clearBuffers()</a>, <a class="el" href="Base_8php_source.html#l01766">_encryptBlock()</a>, <a class="el" href="Base_8php_source.html#l02010">_increment_str()</a>, <a class="el" href="Base_8php_source.html#l01351">_openssl_ctr_process()</a>, <a class="el" href="Base_8php_source.html#l01445">_openssl_ofb_process()</a>, <a class="el" href="Base_8php_source.html#l01901">_pad()</a>, <a class="el" href="Base_8php_source.html#l01822">_setup()</a>, <a class="el" href="Base_8php_source.html#l01855">_setupMcrypt()</a>, <a class="el" href="Base_8php_source.html#l01995">_string_pop()</a>, <a class="el" href="Base_8php_source.html#l01978">_string_shift()</a>, <a class="el" href="Base_8php_source.html#l00110">CRYPT_ENGINE_MCRYPT</a>, <a class="el" href="Base_8php_source.html#l00114">CRYPT_ENGINE_OPENSSL</a>, <a class="el" href="Base_8php_source.html#l00079">CRYPT_MODE_CBC</a>, <a class="el" href="Base_8php_source.html#l00085">CRYPT_MODE_CFB</a>, <a class="el" href="Base_8php_source.html#l00067">CRYPT_MODE_CTR</a>, <a class="el" href="Base_8php_source.html#l00073">CRYPT_MODE_ECB</a>, <a class="el" href="Base_8php_source.html#l00091">CRYPT_MODE_OFB</a>, and <a class="el" href="Base_8php_source.html#l00095">CRYPT_MODE_STREAM</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_aa5ceadf7c30ea677b755c6085b23f2a5_cgraph.png" border="0" usemap="#aclassCrypt__Base_aa5ceadf7c30ea677b755c6085b23f2a5_cgraph" alt=""/></div>
<map name="aclassCrypt__Base_aa5ceadf7c30ea677b755c6085b23f2a5_cgraph" id="aclassCrypt__Base_aa5ceadf7c30ea677b755c6085b23f2a5_cgraph">
<area shape="rect" title="Encrypts a message." alt="" coords="5,218,76,243"/>
<area shape="rect" href="classCrypt__Base.html#a1a87457f321c145b43893358a820f55a" title="Clears internal buffers." alt="" coords="351,43,457,69"/>
<area shape="rect" href="classCrypt__Base.html#adbb5f094cd3af568d05434b7a4b3e6e2" title="Encrypts a block." alt="" coords="149,142,263,167"/>
<area shape="rect" href="classCrypt__Base.html#a412f868848015dec037f640c385f37be" title="Increment the current string." alt="" coords="345,218,463,243"/>
<area shape="rect" href="classCrypt__Base.html#a7aaf3600e103d90572ffd029d81707d1" title="OpenSSL CTR Processor." alt="" coords="126,243,286,269"/>
<area shape="rect" href="classCrypt__Base.html#a1cc0bf8f079a276e5d518ac53443fa31" title="String Pop." alt="" coords="355,294,453,319"/>
<area shape="rect" href="classCrypt__Base.html#ab009fa6f4ba09daa679a30e9b5bcfe35" title="String Shift." alt="" coords="353,345,455,370"/>
<area shape="rect" href="classCrypt__Base.html#ac1b2f723636fe01c4aa90fb201384110" title="OpenSSL OFB Processor." alt="" coords="124,345,288,370"/>
<area shape="rect" href="classCrypt__Base.html#a2dc8c16ec5951b4037a7b36a5a6c4bcd" title="Pads a string." alt="" coords="179,446,233,471"/>
<area shape="rect" href="classCrypt__Base.html#a893edf931eab08c67a70d2e93bbf8c11" title="Setup the CRYPT_ENGINE_INTERNAL $engine." alt="" coords="173,93,239,118"/>
<area shape="rect" href="classCrypt__Base.html#af55698320880af8999c954bad4544a86" title="Setup the CRYPT_ENGINE_MCRYPT $engine." alt="" coords="151,43,261,69"/>
<area shape="rect" href="classCrypt__Base.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="336,93,472,118"/>
<area shape="rect" href="classCrypt__Base.html#aad783e9c1c4fc5e3d8e312f08dd36f68" title="Setup the key (expansion)" alt="" coords="359,142,449,167"/>
</map>
</div>

</div>
</div>
<a id="aab61643153ff62ef8ecad1f33bcdcc62" name="aab61643153ff62ef8ecad1f33bcdcc62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab61643153ff62ef8ecad1f33bcdcc62">&#9670;&#160;</a></span>getBlockLength()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getBlockLength </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the current block length in bits. </p>
<p>@access public </p><dl class="section return"><dt>Returns</dt><dd>int </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00598">598</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  599</span>    {</div>
<div class="line"><span class="lineno">  600</span>        <span class="keywordflow">return</span> $this-&gt;block_size &lt;&lt; 3;</div>
<div class="line"><span class="lineno">  601</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeb060f55c1b9b700005ae80d2d627654" name="aeb060f55c1b9b700005ae80d2d627654"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb060f55c1b9b700005ae80d2d627654">&#9670;&#160;</a></span>getEngine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getEngine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the engine currently being utilized. </p>
<dl class="section see"><dt>See also</dt><dd>self::_setEngine() @access public </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01709">1709</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1710</span>    {</div>
<div class="line"><span class="lineno"> 1711</span>        <span class="keywordflow">return</span> $this-&gt;engine;</div>
<div class="line"><span class="lineno"> 1712</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a739a45ca8f3e8586eef3750ffd0e4a02" name="a739a45ca8f3e8586eef3750ffd0e4a02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a739a45ca8f3e8586eef3750ffd0e4a02">&#9670;&#160;</a></span>getKeyLength()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getKeyLength </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the current key length in bits. </p>
<p>@access public </p><dl class="section return"><dt>Returns</dt><dd>int </dd></dl>

<p>Reimplemented in <a class="el" href="classCrypt__RC2.html#a739a45ca8f3e8586eef3750ffd0e4a02">Crypt_RC2</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00587">587</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  588</span>    {</div>
<div class="line"><span class="lineno">  589</span>        <span class="keywordflow">return</span> $this-&gt;key_length &lt;&lt; 3;</div>
<div class="line"><span class="lineno">  590</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae62f456da9bef718ecc3e155d63f0dc8" name="ae62f456da9bef718ecc3e155d63f0dc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae62f456da9bef718ecc3e155d63f0dc8">&#9670;&#160;</a></span>isValidEngine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">isValidEngine </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$engine</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test for engine validity. </p>
<dl class="section see"><dt>See also</dt><dd>self::Crypt_Base() </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$engine</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

<p>Reimplemented in <a class="el" href="classCrypt__Blowfish.html#ae62f456da9bef718ecc3e155d63f0dc8">Crypt_Blowfish</a>, <a class="el" href="classCrypt__DES.html#ae62f456da9bef718ecc3e155d63f0dc8">Crypt_DES</a>, <a class="el" href="classCrypt__RC2.html#ae62f456da9bef718ecc3e155d63f0dc8">Crypt_RC2</a>, <a class="el" href="classCrypt__RC4.html#ae62f456da9bef718ecc3e155d63f0dc8">Crypt_RC4</a>, <a class="el" href="classCrypt__Rijndael.html#ae62f456da9bef718ecc3e155d63f0dc8">Crypt_Rijndael</a>, and <a class="el" href="classCrypt__TripleDES.html#ae62f456da9bef718ecc3e155d63f0dc8">Crypt_TripleDES</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01619">1619</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1620</span>    {</div>
<div class="line"><span class="lineno"> 1621</span>        <span class="keywordflow">switch</span> ($engine) {</div>
<div class="line"><span class="lineno"> 1622</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a8f1200db8ddce5bab18ddeec03362215">CRYPT_ENGINE_OPENSSL</a>:</div>
<div class="line"><span class="lineno"> 1623</span>                <span class="keywordflow">if</span> ($this-&gt;mode == <a class="code hl_variable" href="Base_8php.html#adaa3d4f69333325e047270ae0d58bcaa">CRYPT_MODE_STREAM</a> &amp;&amp; $this-&gt;continuousBuffer) {</div>
<div class="line"><span class="lineno"> 1624</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1625</span>                }</div>
<div class="line"><span class="lineno"> 1626</span>                $this-&gt;openssl_emulate_ctr = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1627</span>                $result = $this-&gt;cipher_name_openssl &amp;&amp;</div>
<div class="line"><span class="lineno"> 1628</span>                          extension_loaded(<span class="stringliteral">&#39;openssl&#39;</span>) &amp;&amp;</div>
<div class="line"><span class="lineno"> 1629</span>                          <span class="comment">// PHP 5.3.0 - 5.3.2 did not let you set IV&#39;s</span></div>
<div class="line"><span class="lineno"> 1630</span>                          version_compare(<a class="code hl_variable" href="configtest_8php.html#a3c1ade165b70ecbf36a71bc64671334a">PHP_VERSION</a>, <span class="stringliteral">&#39;5.3.3&#39;</span>, <span class="stringliteral">&#39;&gt;=&#39;</span>);</div>
<div class="line"><span class="lineno"> 1631</span>                <span class="keywordflow">if</span> (!$result) {</div>
<div class="line"><span class="lineno"> 1632</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1633</span>                }</div>
<div class="line"><span class="lineno"> 1634</span> </div>
<div class="line"><span class="lineno"> 1635</span>                <span class="comment">// prior to PHP 5.4.0 OPENSSL_RAW_DATA and OPENSSL_ZERO_PADDING were not defined. instead of expecting an integer</span></div>
<div class="line"><span class="lineno"> 1636</span>                <span class="comment">// $options openssl_encrypt expected a boolean $raw_data.</span></div>
<div class="line"><span class="lineno"> 1637</span>                <span class="keywordflow">if</span> (!defined(<span class="stringliteral">&#39;OPENSSL_RAW_DATA&#39;</span>)) {</div>
<div class="line"><span class="lineno"> 1638</span>                    $this-&gt;openssl_options = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1639</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1640</span>                    $this-&gt;openssl_options = OPENSSL_RAW_DATA | OPENSSL_ZERO_PADDING;</div>
<div class="line"><span class="lineno"> 1641</span>                }</div>
<div class="line"><span class="lineno"> 1642</span> </div>
<div class="line"><span class="lineno"> 1643</span>                $methods = openssl_get_cipher_methods();</div>
<div class="line"><span class="lineno"> 1644</span>                <span class="keywordflow">if</span> (in_array($this-&gt;cipher_name_openssl, $methods)) {</div>
<div class="line"><span class="lineno"> 1645</span>                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1646</span>                }</div>
<div class="line"><span class="lineno"> 1647</span>                <span class="comment">// not all of openssl&#39;s symmetric cipher&#39;s support ctr. for those</span></div>
<div class="line"><span class="lineno"> 1648</span>                <span class="comment">// that don&#39;t we&#39;ll emulate it</span></div>
<div class="line"><span class="lineno"> 1649</span>                <span class="keywordflow">switch</span> ($this-&gt;mode) {</div>
<div class="line"><span class="lineno"> 1650</span>                    <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a4204f1d2beaf41a2b97967cbea0ef666">CRYPT_MODE_CTR</a>:</div>
<div class="line"><span class="lineno"> 1651</span>                        <span class="keywordflow">if</span> (in_array($this-&gt;cipher_name_openssl_ecb, $methods)) {</div>
<div class="line"><span class="lineno"> 1652</span>                            $this-&gt;openssl_emulate_ctr = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1653</span>                            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1654</span>                        }</div>
<div class="line"><span class="lineno"> 1655</span>                }</div>
<div class="line"><span class="lineno"> 1656</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1657</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#aec1c8f2a4ace0050f6457c9c61bf8310">CRYPT_ENGINE_MCRYPT</a>:</div>
<div class="line"><span class="lineno"> 1658</span>                set_error_handler(array($this, <span class="stringliteral">&#39;do_nothing&#39;</span>));</div>
<div class="line"><span class="lineno"> 1659</span>                $result = $this-&gt;cipher_name_mcrypt &amp;&amp;</div>
<div class="line"><span class="lineno"> 1660</span>                       extension_loaded(<span class="stringliteral">&#39;mcrypt&#39;</span>) &amp;&amp;</div>
<div class="line"><span class="lineno"> 1661</span>                       in_array($this-&gt;cipher_name_mcrypt, mcrypt_list_algorithms());</div>
<div class="line"><span class="lineno"> 1662</span>                restore_error_handler();</div>
<div class="line"><span class="lineno"> 1663</span>                <span class="keywordflow">return</span> $result;</div>
<div class="line"><span class="lineno"> 1664</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a02836fb7d55f32f31941fa9ecddbd8fc">CRYPT_ENGINE_INTERNAL</a>:</div>
<div class="line"><span class="lineno"> 1665</span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1666</span>        }</div>
<div class="line"><span class="lineno"> 1667</span> </div>
<div class="line"><span class="lineno"> 1668</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1669</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l00106">CRYPT_ENGINE_INTERNAL</a>, <a class="el" href="Base_8php_source.html#l00110">CRYPT_ENGINE_MCRYPT</a>, <a class="el" href="Base_8php_source.html#l00114">CRYPT_ENGINE_OPENSSL</a>, <a class="el" href="Base_8php_source.html#l00067">CRYPT_MODE_CTR</a>, <a class="el" href="Base_8php_source.html#l00095">CRYPT_MODE_STREAM</a>, and <a class="el" href="configtest_8php_source.html#l00041">PHP_VERSION</a>.</p>

<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l01720">_setEngine()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_ae62f456da9bef718ecc3e155d63f0dc8_icgraph.png" border="0" usemap="#aclassCrypt__Base_ae62f456da9bef718ecc3e155d63f0dc8_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_ae62f456da9bef718ecc3e155d63f0dc8_icgraph" id="aclassCrypt__Base_ae62f456da9bef718ecc3e155d63f0dc8_icgraph">
<area shape="rect" title="Test for engine validity." alt="" coords="711,179,820,204"/>
<area shape="rect" href="classCrypt__Base.html#ab4e58314adec23125fc08ae86aa501e3" title="Sets the engine as appropriate." alt="" coords="569,179,663,204"/>
<area shape="rect" href="classCrypt__Base.html#a7f343b63c2a2441c661bb6f07553643f" title="Default Constructor." alt="" coords="363,5,459,31"/>
<area shape="rect" href="classCrypt__Base.html#abfa3ada55a183bec17f12b630f8cfac5" title="Treat consecutive packets as if they are a discontinuous buffer." alt="" coords="320,55,501,80"/>
<area shape="rect" href="classCrypt__Base.html#ab8ff793379f109d2e0f62e942c1c5ba5" title="Treat consecutive &quot;packets&quot; as if they are a continuous buffer." alt="" coords="321,104,500,129"/>
<area shape="rect" href="classCrypt__Rijndael.html#accc1879e7ebe30027584aaefa387461b" title="Sets the block length." alt="" coords="300,153,521,179"/>
<area shape="rect" href="classCrypt__AES.html#a9afc10d017d5c65d3e6a941f65cf1904" title="Sets the key." alt="" coords="342,203,479,228"/>
<area shape="rect" href="classCrypt__Base.html#a9afc10d017d5c65d3e6a941f65cf1904" title="Sets the key." alt="" coords="171,279,237,304"/>
<area shape="rect" href="classCrypt__Base.html#a213d72f64ec9f940548d56d3c9df7457" title="Sets the key length." alt="" coords="355,304,466,329"/>
<area shape="rect" href="classCrypt__Base.html#a1082dc0f46d62a6aaa2bf8088c521bfd" title="Sets the preferred crypt engine." alt="" coords="337,353,484,379"/>
<area shape="rect" href="classCrypt__Base.html#a6a80cab2d9e4f3091d06f0393cb3faf8" title="PHP4 compatible Default Constructor." alt="" coords="156,5,252,31"/>
<area shape="rect" href="classCrypt__Base.html#abee03ea49c9f963f2e40adf6f53a33fa" title="Sets the password." alt="" coords="5,279,108,304"/>
</map>
</div>

</div>
</div>
<a id="a342b96bd7214a3cb2254af8bd1fe53f6" name="a342b96bd7214a3cb2254af8bd1fe53f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a342b96bd7214a3cb2254af8bd1fe53f6">&#9670;&#160;</a></span>safe_intval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">safe_intval </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert float to int. </p>
<p>On 32-bit Linux installs running PHP &lt; 5.3 converting floats to ints doesn't always work</p>
<p>@access private </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$x</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l02643">2643</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2644</span>    {</div>
<div class="line"><span class="lineno"> 2645</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2646</span>            <span class="keywordflow">case</span> is_int($x):</div>
<div class="line"><span class="lineno"> 2647</span>            <span class="comment">// PHP 5.3, per http://php.net/releases/5_3_0.php, introduced &quot;more consistent float rounding&quot;</span></div>
<div class="line"><span class="lineno"> 2648</span>            case version_compare(<a class="code hl_variable" href="configtest_8php.html#a3c1ade165b70ecbf36a71bc64671334a">PHP_VERSION</a>, <span class="stringliteral">&#39;5.3.0&#39;</span>) &gt;= 0 &amp;&amp; (php_uname(<span class="stringliteral">&#39;m&#39;</span>) &amp; <span class="stringliteral">&quot;\xDF\xDF\xDF&quot;</span>) != <span class="stringliteral">&#39;ARM&#39;</span>:</div>
<div class="line"><span class="lineno"> 2649</span>            <span class="comment">// PHP_OS &amp; &quot;\xDF\xDF\xDF&quot; == strtoupper(substr(PHP_OS, 0, 3)), but a lot faster</span></div>
<div class="line"><span class="lineno"> 2650</span>            case (PHP_OS &amp; <span class="stringliteral">&quot;\xDF\xDF\xDF&quot;</span>) === <span class="stringliteral">&#39;WIN&#39;</span>:</div>
<div class="line"><span class="lineno"> 2651</span>                return $x;</div>
<div class="line"><span class="lineno"> 2652</span>        }</div>
<div class="line"><span class="lineno"> 2653</span>        <span class="keywordflow">return</span> (fmod($x, 0x80000000) &amp; 0x7FFFFFFF) |</div>
<div class="line"><span class="lineno"> 2654</span>            ((fmod(floor($x / 0x80000000), 2) &amp; 1) &lt;&lt; 31);</div>
<div class="line"><span class="lineno"> 2655</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="configtest_8php_source.html#l00041">PHP_VERSION</a>.</p>

<p class="reference">Referenced by <a class="el" href="Blowfish_8php_source.html#l00503">Crypt_Blowfish\_decryptBlock()</a>, <a class="el" href="Twofish_8php_source.html#l00692">Crypt_Twofish\_decryptBlock()</a>, <a class="el" href="Blowfish_8php_source.html#l00469">Crypt_Blowfish\_encryptBlock()</a>, <a class="el" href="Twofish_8php_source.html#l00636">Crypt_Twofish\_encryptBlock()</a>, and <a class="el" href="Twofish_8php_source.html#l00474">Crypt_Twofish\_setupKey()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a342b96bd7214a3cb2254af8bd1fe53f6_icgraph.png" border="0" usemap="#aclassCrypt__Base_a342b96bd7214a3cb2254af8bd1fe53f6_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a342b96bd7214a3cb2254af8bd1fe53f6_icgraph" id="aclassCrypt__Base_a342b96bd7214a3cb2254af8bd1fe53f6_icgraph">
<area shape="rect" title="Convert float to int." alt="" coords="507,104,601,129"/>
<area shape="rect" href="classCrypt__Blowfish.html#a2a08218631ae2281ca8cf6032c34a843" title="Decrypts a block." alt="" coords="244,5,459,31"/>
<area shape="rect" href="classCrypt__Twofish.html#a2a08218631ae2281ca8cf6032c34a843" title="Decrypts a block." alt="" coords="247,55,455,80"/>
<area shape="rect" href="classCrypt__Blowfish.html#adbb5f094cd3af568d05434b7a4b3e6e2" title="Encrypts a block." alt="" coords="244,104,459,129"/>
<area shape="rect" href="classCrypt__Twofish.html#adbb5f094cd3af568d05434b7a4b3e6e2" title="Encrypts a block." alt="" coords="247,153,455,179"/>
<area shape="rect" href="classCrypt__Twofish.html#aad783e9c1c4fc5e3d8e312f08dd36f68" title="Setup the key (expansion)" alt="" coords="260,203,443,228"/>
<area shape="rect" href="classCrypt__Blowfish.html#aad783e9c1c4fc5e3d8e312f08dd36f68" title="Setup the key (expansion)" alt="" coords="5,104,196,129"/>
</map>
</div>

</div>
</div>
<a id="a9b20f898d429ad2fbd075f3aaf498dca" name="a9b20f898d429ad2fbd075f3aaf498dca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b20f898d429ad2fbd075f3aaf498dca">&#9670;&#160;</a></span>safe_intval_inline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">safe_intval_inline </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>eval()'able string for in-line float to int </p>
<p>@access private </p><dl class="section return"><dt>Returns</dt><dd>string </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l02663">2663</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2664</span>    {</div>
<div class="line"><span class="lineno"> 2665</span>        <span class="comment">// on 32-bit linux systems with PHP &lt; 5.3 float to integer conversion is bad</span></div>
<div class="line"><span class="lineno"> 2666</span>        <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2667</span>            <span class="keywordflow">case</span> defined(<span class="stringliteral">&#39;PHP_INT_SIZE&#39;</span>) &amp;&amp; PHP_INT_SIZE == 8:</div>
<div class="line"><span class="lineno"> 2668</span>            <span class="keywordflow">case</span> version_compare(<a class="code hl_variable" href="configtest_8php.html#a3c1ade165b70ecbf36a71bc64671334a">PHP_VERSION</a>, <span class="stringliteral">&#39;5.3.0&#39;</span>) &gt;= 0 &amp;&amp; (php_uname(<span class="charliteral">&#39;m&#39;</span>) &amp; <span class="stringliteral">&quot;\xDF\xDF\xDF&quot;</span>) != <span class="stringliteral">&#39;ARM&#39;</span>:</div>
<div class="line"><span class="lineno"> 2669</span>            <span class="keywordflow">case</span> (PHP_OS &amp; <span class="stringliteral">&quot;\xDF\xDF\xDF&quot;</span>) === <span class="stringliteral">&#39;WIN&#39;</span>:</div>
<div class="line"><span class="lineno"> 2670</span>                <span class="keywordflow">return</span> <span class="stringliteral">&#39;%s&#39;</span>;</div>
<div class="line"><span class="lineno"> 2671</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2672</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2673</span>                $safeint = <span class="stringliteral">&#39;(is_int($temp = %s) ? $temp : (fmod($temp, 0x80000000) &amp; 0x7FFFFFFF) | &#39;</span>;</div>
<div class="line"><span class="lineno"> 2674</span>                <span class="keywordflow">return</span> $safeint . <span class="stringliteral">&#39;((fmod(floor($temp / 0x80000000), 2) &amp; 1) &lt;&lt; 31))&#39;</span>;</div>
<div class="line"><span class="lineno"> 2675</span>        }</div>
<div class="line"><span class="lineno"> 2676</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="configtest_8php_source.html#l00041">PHP_VERSION</a>.</p>

<p class="reference">Referenced by <a class="el" href="Blowfish_8php_source.html#l00535">Crypt_Blowfish\_setupInlineCrypt()</a>, and <a class="el" href="Twofish_8php_source.html#l00747">Crypt_Twofish\_setupInlineCrypt()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a9b20f898d429ad2fbd075f3aaf498dca_icgraph.png" border="0" usemap="#aclassCrypt__Base_a9b20f898d429ad2fbd075f3aaf498dca_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a9b20f898d429ad2fbd075f3aaf498dca_icgraph" id="aclassCrypt__Base_a9b20f898d429ad2fbd075f3aaf498dca_icgraph">
<area shape="rect" title="eval()&#39;able string for in&#45;line float to int" alt="" coords="256,45,393,70"/>
<area shape="rect" href="classCrypt__Blowfish.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="5,5,208,45"/>
<area shape="rect" href="classCrypt__Twofish.html#a08e325f5762546ed7646eb4e79835026" title="Setup the performance&#45;optimized function for de/encrypt()" alt="" coords="9,69,204,109"/>
</map>
</div>

</div>
</div>
<a id="a04b58c8316cfa43c8ac1bee9a05aa639" name="a04b58c8316cfa43c8ac1bee9a05aa639"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04b58c8316cfa43c8ac1bee9a05aa639">&#9670;&#160;</a></span>setIV()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setIV </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$iv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the initialization vector. </p>
<p>(optional)</p>
<p>SetIV is not required when CRYPT_MODE_ECB (or ie for AES: CRYPT_AES_MODE_ECB) is being used. If not explicitly set, it'll be assumed to be all zero's.</p>
<p>@access public </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$iv</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classCrypt__RC4.html#a04b58c8316cfa43c8ac1bee9a05aa639">Crypt_RC4</a>, and <a class="el" href="classCrypt__TripleDES.html#a04b58c8316cfa43c8ac1bee9a05aa639">Crypt_TripleDES</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00556">556</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  557</span>    {</div>
<div class="line"><span class="lineno">  558</span>        <span class="keywordflow">if</span> ($this-&gt;mode == <a class="code hl_variable" href="Base_8php.html#ace7687420bc69da6192bc40c8a061804">CRYPT_MODE_ECB</a>) {</div>
<div class="line"><span class="lineno">  559</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  560</span>        }</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>        $this-&gt;iv = $iv;</div>
<div class="line"><span class="lineno">  563</span>        $this-&gt;changed = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  564</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l00073">CRYPT_MODE_ECB</a>.</p>

<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l00645">setPassword()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a04b58c8316cfa43c8ac1bee9a05aa639_icgraph.png" border="0" usemap="#aclassCrypt__Base_a04b58c8316cfa43c8ac1bee9a05aa639_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a04b58c8316cfa43c8ac1bee9a05aa639_icgraph" id="aclassCrypt__Base_a04b58c8316cfa43c8ac1bee9a05aa639_icgraph">
<area shape="rect" title="Sets the initialization vector." alt="" coords="156,5,211,31"/>
<area shape="rect" href="classCrypt__Base.html#abee03ea49c9f963f2e40adf6f53a33fa" title="Sets the password." alt="" coords="5,5,108,31"/>
</map>
</div>

</div>
</div>
<a id="a9afc10d017d5c65d3e6a941f65cf1904" name="a9afc10d017d5c65d3e6a941f65cf1904"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9afc10d017d5c65d3e6a941f65cf1904">&#9670;&#160;</a></span>setKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the key. </p>
<p>The min/max length(s) of the key depends on the cipher which is used. If the key not fits the length(s) of the cipher it will paded with null bytes up to the closest valid key length. If the key is more than max length, we trim the excess bits.</p>
<p>If the key is not explicitly set, it'll be assumed to be all null bytes.</p>
<p>@access public </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classCrypt__AES.html#a9afc10d017d5c65d3e6a941f65cf1904">Crypt_AES</a>, <a class="el" href="classCrypt__DES.html#a9afc10d017d5c65d3e6a941f65cf1904">Crypt_DES</a>, <a class="el" href="classCrypt__Rijndael.html#a9afc10d017d5c65d3e6a941f65cf1904">Crypt_Rijndael</a>, and <a class="el" href="classCrypt__TripleDES.html#a9afc10d017d5c65d3e6a941f65cf1904">Crypt_TripleDES</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00617">617</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  618</span>    {</div>
<div class="line"><span class="lineno">  619</span>        <span class="keywordflow">if</span> (!$this-&gt;explicit_key_length) {</div>
<div class="line"><span class="lineno">  620</span>            $this-&gt;setKeyLength(strlen($key) &lt;&lt; 3);</div>
<div class="line"><span class="lineno">  621</span>            $this-&gt;explicit_key_length = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  622</span>        }</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>        $this-&gt;key = $key;</div>
<div class="line"><span class="lineno">  625</span>        $this-&gt;changed = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  626</span>        $this-&gt;_setEngine();</div>
<div class="line"><span class="lineno">  627</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l01720">_setEngine()</a>, and <a class="el" href="Base_8php_source.html#l00574">setKeyLength()</a>.</p>

<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l00645">setPassword()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a9afc10d017d5c65d3e6a941f65cf1904_cgraph.png" border="0" usemap="#aclassCrypt__Base_a9afc10d017d5c65d3e6a941f65cf1904_cgraph" alt=""/></div>
<map name="aclassCrypt__Base_a9afc10d017d5c65d3e6a941f65cf1904_cgraph" id="aclassCrypt__Base_a9afc10d017d5c65d3e6a941f65cf1904_cgraph">
<area shape="rect" title="Sets the key." alt="" coords="5,5,72,31"/>
<area shape="rect" href="classCrypt__Base.html#ab4e58314adec23125fc08ae86aa501e3" title="Sets the engine as appropriate." alt="" coords="279,5,372,31"/>
<area shape="rect" href="classCrypt__Base.html#a213d72f64ec9f940548d56d3c9df7457" title="Sets the key length." alt="" coords="120,31,231,56"/>
<area shape="rect" href="classCrypt__Base.html#ae62f456da9bef718ecc3e155d63f0dc8" title="Test for engine validity." alt="" coords="420,5,529,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a9afc10d017d5c65d3e6a941f65cf1904_icgraph.png" border="0" usemap="#aclassCrypt__Base_a9afc10d017d5c65d3e6a941f65cf1904_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a9afc10d017d5c65d3e6a941f65cf1904_icgraph" id="aclassCrypt__Base_a9afc10d017d5c65d3e6a941f65cf1904_icgraph">
<area shape="rect" title="Sets the key." alt="" coords="156,5,223,31"/>
<area shape="rect" href="classCrypt__Base.html#abee03ea49c9f963f2e40adf6f53a33fa" title="Sets the password." alt="" coords="5,5,108,31"/>
</map>
</div>

</div>
</div>
<a id="a213d72f64ec9f940548d56d3c9df7457" name="a213d72f64ec9f940548d56d3c9df7457"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a213d72f64ec9f940548d56d3c9df7457">&#9670;&#160;</a></span>setKeyLength()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setKeyLength </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$length</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the key length. </p>
<p>Keys with explicitly set lengths need to be treated accordingly</p>
<p>@access public </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$length</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classCrypt__AES.html#a213d72f64ec9f940548d56d3c9df7457">Crypt_AES</a>, <a class="el" href="classCrypt__Blowfish.html#a213d72f64ec9f940548d56d3c9df7457">Crypt_Blowfish</a>, <a class="el" href="classCrypt__RC2.html#a213d72f64ec9f940548d56d3c9df7457">Crypt_RC2</a>, <a class="el" href="classCrypt__RC4.html#a213d72f64ec9f940548d56d3c9df7457">Crypt_RC4</a>, <a class="el" href="classCrypt__Rijndael.html#a213d72f64ec9f940548d56d3c9df7457">Crypt_Rijndael</a>, <a class="el" href="classCrypt__TripleDES.html#a213d72f64ec9f940548d56d3c9df7457">Crypt_TripleDES</a>, and <a class="el" href="classCrypt__Twofish.html#a213d72f64ec9f940548d56d3c9df7457">Crypt_Twofish</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00574">574</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  575</span>    {</div>
<div class="line"><span class="lineno">  576</span>        $this-&gt;explicit_key_length = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  577</span>        $this-&gt;changed = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  578</span>        $this-&gt;_setEngine();</div>
<div class="line"><span class="lineno">  579</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l01720">_setEngine()</a>.</p>

<p class="reference">Referenced by <a class="el" href="Base_8php_source.html#l00617">setKey()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a213d72f64ec9f940548d56d3c9df7457_cgraph.png" border="0" usemap="#aclassCrypt__Base_a213d72f64ec9f940548d56d3c9df7457_cgraph" alt=""/></div>
<map name="aclassCrypt__Base_a213d72f64ec9f940548d56d3c9df7457_cgraph" id="aclassCrypt__Base_a213d72f64ec9f940548d56d3c9df7457_cgraph">
<area shape="rect" title="Sets the key length." alt="" coords="5,5,116,31"/>
<area shape="rect" href="classCrypt__Base.html#ab4e58314adec23125fc08ae86aa501e3" title="Sets the engine as appropriate." alt="" coords="164,5,257,31"/>
<area shape="rect" href="classCrypt__Base.html#ae62f456da9bef718ecc3e155d63f0dc8" title="Test for engine validity." alt="" coords="305,5,415,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a213d72f64ec9f940548d56d3c9df7457_icgraph.png" border="0" usemap="#aclassCrypt__Base_a213d72f64ec9f940548d56d3c9df7457_icgraph" alt=""/></div>
<map name="aclassCrypt__Base_a213d72f64ec9f940548d56d3c9df7457_icgraph" id="aclassCrypt__Base_a213d72f64ec9f940548d56d3c9df7457_icgraph">
<area shape="rect" title="Sets the key length." alt="" coords="271,5,381,31"/>
<area shape="rect" href="classCrypt__Base.html#a9afc10d017d5c65d3e6a941f65cf1904" title="Sets the key." alt="" coords="156,5,223,31"/>
<area shape="rect" href="classCrypt__Base.html#abee03ea49c9f963f2e40adf6f53a33fa" title="Sets the password." alt="" coords="5,5,108,31"/>
</map>
</div>

</div>
</div>
<a id="abee03ea49c9f963f2e40adf6f53a33fa" name="abee03ea49c9f963f2e40adf6f53a33fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abee03ea49c9f963f2e40adf6f53a33fa">&#9670;&#160;</a></span>setPassword()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setPassword </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$method</em> = <code>'pbkdf2'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the password. </p>
<p>Depending on what $method is set to, setPassword()'s (optional) parameters are as follows: <code><a class="el" href="">pbkdf2</a></code> or pbkdf1: $hash, $salt, $count, $dkLen</p>
<p>Where $hash (default = sha1) currently supports the following hashes: see: <a class="el" href="Hash_8php.html">Crypt/Hash.php</a></p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="Hash_8php.html">Crypt/Hash.php</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$password</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$method</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool @access public </dd></dl>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00645">645</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  646</span>    {</div>
<div class="line"><span class="lineno">  647</span>        global <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>;</div>
<div class="line"><span class="lineno">  648</span> </div>
<div class="line"><span class="lineno">  649</span>        $key = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>        <span class="keywordflow">switch</span> ($method) {</div>
<div class="line"><span class="lineno">  652</span>            <span class="keywordflow">default</span>: <span class="comment">// &#39;pbkdf2&#39; or &#39;pbkdf1&#39;</span></div>
<div class="line"><span class="lineno">  653</span>                $func_args = func_get_args();</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>                <span class="comment">// Hash function</span></div>
<div class="line"><span class="lineno">  656</span>                $hash = isset($func_args[2]) ? $func_args[2] : <span class="stringliteral">&#39;sha1&#39;</span>;</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>                <span class="comment">// WPA and WPA2 use the SSID as the salt</span></div>
<div class="line"><span class="lineno">  659</span>                $salt = isset($func_args[3]) ? $func_args[3] : $this-&gt;password_default_salt;</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>                <span class="comment">// RFC2898#section-4.2 uses 1,000 iterations by default</span></div>
<div class="line"><span class="lineno">  662</span>                <span class="comment">// WPA and WPA2 use 4,096.</span></div>
<div class="line"><span class="lineno">  663</span>                $count = isset($func_args[4]) ? $func_args[4] : 1000;</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>                <span class="comment">// Keylength</span></div>
<div class="line"><span class="lineno">  666</span>                <span class="keywordflow">if</span> (isset($func_args[5]) &amp;&amp; $func_args[5] &gt; 0) {</div>
<div class="line"><span class="lineno">  667</span>                    $dkLen = $func_args[5];</div>
<div class="line"><span class="lineno">  668</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  669</span>                    $dkLen = $method == <span class="stringliteral">&#39;pbkdf1&#39;</span> ? 2 * $this-&gt;key_length : $this-&gt;key_length;</div>
<div class="line"><span class="lineno">  670</span>                }</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>                <span class="keywordflow">switch</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  673</span>                    <span class="keywordflow">case</span> $method == <span class="stringliteral">&#39;pbkdf1&#39;</span>:</div>
<div class="line"><span class="lineno">  674</span>                        <span class="keywordflow">if</span> (!class_exists(<span class="stringliteral">&#39;Crypt_Hash&#39;</span>)) {</div>
<div class="line"><span class="lineno">  675</span>                            include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/Hash.php&#39;</span>;</div>
<div class="line"><span class="lineno">  676</span>                        }</div>
<div class="line"><span class="lineno">  677</span>                        $hashObj = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__Hash.html">Crypt_Hash</a>();</div>
<div class="line"><span class="lineno">  678</span>                        $hashObj-&gt;setHash($hash);</div>
<div class="line"><span class="lineno">  679</span>                        <span class="keywordflow">if</span> ($dkLen &gt; $hashObj-&gt;getLength()) {</div>
<div class="line"><span class="lineno">  680</span>                            user_error(<span class="stringliteral">&#39;Derived key too long&#39;</span>);</div>
<div class="line"><span class="lineno">  681</span>                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  682</span>                        }</div>
<div class="line"><span class="lineno">  683</span>                        $t = $password . $salt;</div>
<div class="line"><span class="lineno">  684</span>                        <span class="keywordflow">for</span> ($i = 0; $i &lt; $count; ++$i) {</div>
<div class="line"><span class="lineno">  685</span>                            $t = $hashObj-&gt;hash($t);</div>
<div class="line"><span class="lineno">  686</span>                        }</div>
<div class="line"><span class="lineno">  687</span>                        <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a> = substr($t, 0, $dkLen);</div>
<div class="line"><span class="lineno">  688</span> </div>
<div class="line"><span class="lineno">  689</span>                        $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a9afc10d017d5c65d3e6a941f65cf1904">setKey</a>(substr($key, 0, $dkLen &gt;&gt; 1));</div>
<div class="line"><span class="lineno">  690</span>                        $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a04b58c8316cfa43c8ac1bee9a05aa639">setIV</a>(substr($key, $dkLen &gt;&gt; 1));</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  693</span>                    <span class="comment">// Determining if php[&gt;=5.5.0]&#39;s hash_pbkdf2() function avail- and useable</span></div>
<div class="line"><span class="lineno">  694</span>                    <span class="keywordflow">case</span> !function_exists(<span class="stringliteral">&#39;hash_pbkdf2&#39;</span>):</div>
<div class="line"><span class="lineno">  695</span>                    case !function_exists(<span class="stringliteral">&#39;hash_algos&#39;</span>):</div>
<div class="line"><span class="lineno">  696</span>                    case !in_array($hash, hash_algos()):</div>
<div class="line"><span class="lineno">  697</span>                        <a class="code hl_variable" href="ctlr_8php.html#abc2baa6b327386720a46de43cf272921">if</a> (!class_exists(<span class="stringliteral">&#39;Crypt_Hash&#39;</span>)) {</div>
<div class="line"><span class="lineno">  698</span>                            include_once <a class="code hl_variable" href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a>.<span class="stringliteral">&#39;/lib/phpseclib/Crypt/Hash.php&#39;</span>;</div>
<div class="line"><span class="lineno">  699</span>                        }</div>
<div class="line"><span class="lineno">  700</span>                        $i = 1;</div>
<div class="line"><span class="lineno">  701</span>                        $hmac = <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceCrypt__Hash.html">Crypt_Hash</a>();</div>
<div class="line"><span class="lineno">  702</span>                        $hmac-&gt;setHash($hash);</div>
<div class="line"><span class="lineno">  703</span>                        $hmac-&gt;setKey($password);</div>
<div class="line"><span class="lineno">  704</span>                        <span class="keywordflow">while</span> (strlen($key) &lt; $dkLen) {</div>
<div class="line"><span class="lineno">  705</span>                            $f = $u = $hmac-&gt;hash($salt . pack(<span class="charliteral">&#39;N&#39;</span>, $i++));</div>
<div class="line"><span class="lineno">  706</span>                            <span class="keywordflow">for</span> ($j = 2; $j &lt;= $count; ++$j) {</div>
<div class="line"><span class="lineno">  707</span>                                $u = $hmac-&gt;hash($u);</div>
<div class="line"><span class="lineno">  708</span>                                $f^= $u;</div>
<div class="line"><span class="lineno">  709</span>                            }</div>
<div class="line"><span class="lineno">  710</span>                            <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a>.= $f;</div>
<div class="line"><span class="lineno">  711</span>                        }</div>
<div class="line"><span class="lineno">  712</span>                        <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a> = substr($key, 0, $dkLen);</div>
<div class="line"><span class="lineno">  713</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  714</span>                    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  715</span>                        <a class="code hl_variable" href="classCrypt__Base.html#aa60b0284e0dfa2463495481cf11e3cf4">$key</a> = hash_pbkdf2($hash, $password, $salt, $count, $dkLen, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  716</span>                }</div>
<div class="line"><span class="lineno">  717</span>        }</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>        $this-&gt;<a class="code hl_function" href="classCrypt__Base.html#a9afc10d017d5c65d3e6a941f65cf1904">setKey</a>($key);</div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  722</span>    }</div>
<div class="ttc" id="aclassCrypt__Base_html_a04b58c8316cfa43c8ac1bee9a05aa639"><div class="ttname"><a href="classCrypt__Base.html#a04b58c8316cfa43c8ac1bee9a05aa639">Crypt_Base\setIV</a></div><div class="ttdeci">setIV($iv)</div><div class="ttdoc">Sets the initialization vector.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00556">Base.php:556</a></div></div>
<div class="ttc" id="aclassCrypt__Base_html_a9afc10d017d5c65d3e6a941f65cf1904"><div class="ttname"><a href="classCrypt__Base.html#a9afc10d017d5c65d3e6a941f65cf1904">Crypt_Base\setKey</a></div><div class="ttdeci">setKey($key)</div><div class="ttdoc">Sets the key.</div><div class="ttdef"><b>Definition:</b> <a href="Base_8php_source.html#l00617">Base.php:617</a></div></div>
<div class="ttc" id="actlr_8php_html_abc2baa6b327386720a46de43cf272921"><div class="ttname"><a href="ctlr_8php.html#abc2baa6b327386720a46de43cf272921">if</a></div><div class="ttdeci">if(!ExpandArgs( $ArgV, $Locale, $View, $Command)) if(!array_key_exists( $View, $ModelFiles))</div><div class="ttdef"><b>Definition:</b> <a href="ctlr_8php_source.html#l00079">ctlr.php:79</a></div></div>
<div class="ttc" id="ainstall_8php_html_a1cf4c1ce4d54df11a660775bb7c5bbd8"><div class="ttname"><a href="install_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a></div><div class="ttdeci">$VIEW_PATH</div><div class="ttdef"><b>Definition:</b> <a href="install_8php_source.html#l00039">install.php:39</a></div></div>
<div class="ttc" id="anamespaceCrypt__Hash_html"><div class="ttname"><a href="namespaceCrypt__Hash.html">Crypt_Hash</a></div><div class="ttdoc">#-</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="install_8php_source.html#l00039">$VIEW_PATH</a>, <a class="el" href="Base_8php_source.html#l00556">setIV()</a>, and <a class="el" href="Base_8php_source.html#l00617">setKey()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_abee03ea49c9f963f2e40adf6f53a33fa_cgraph.png" border="0" usemap="#aclassCrypt__Base_abee03ea49c9f963f2e40adf6f53a33fa_cgraph" alt=""/></div>
<map name="aclassCrypt__Base_abee03ea49c9f963f2e40adf6f53a33fa_cgraph" id="aclassCrypt__Base_abee03ea49c9f963f2e40adf6f53a33fa_cgraph">
<area shape="rect" title="Sets the password." alt="" coords="5,31,108,56"/>
<area shape="rect" href="classCrypt__Base.html#a04b58c8316cfa43c8ac1bee9a05aa639" title="Sets the initialization vector." alt="" coords="162,5,217,31"/>
<area shape="rect" href="classCrypt__Base.html#a9afc10d017d5c65d3e6a941f65cf1904" title="Sets the key." alt="" coords="156,55,223,80"/>
<area shape="rect" href="classCrypt__Base.html#ab4e58314adec23125fc08ae86aa501e3" title="Sets the engine as appropriate." alt="" coords="429,55,523,80"/>
<area shape="rect" href="classCrypt__Base.html#a213d72f64ec9f940548d56d3c9df7457" title="Sets the key length." alt="" coords="271,80,381,105"/>
<area shape="rect" href="classCrypt__Base.html#ae62f456da9bef718ecc3e155d63f0dc8" title="Test for engine validity." alt="" coords="571,55,680,80"/>
</map>
</div>

</div>
</div>
<a id="a1082dc0f46d62a6aaa2bf8088c521bfd" name="a1082dc0f46d62a6aaa2bf8088c521bfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1082dc0f46d62a6aaa2bf8088c521bfd">&#9670;&#160;</a></span>setPreferredEngine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setPreferredEngine </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$engine</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the preferred crypt engine. </p>
<p>Currently, $engine could be:</p>
<ul>
<li>CRYPT_ENGINE_OPENSSL [very fast]</li>
<li>CRYPT_ENGINE_MCRYPT [fast]</li>
<li>CRYPT_ENGINE_INTERNAL [slow]</li>
</ul>
<p>If the preferred crypt engine is not available the fastest available one will be used</p>
<dl class="section see"><dt>See also</dt><dd>self::Crypt_Base() </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$engine</td><td>@access public </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classCrypt__TripleDES.html#a1082dc0f46d62a6aaa2bf8088c521bfd">Crypt_TripleDES</a>.</p>

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l01688">1688</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1689</span>    {</div>
<div class="line"><span class="lineno"> 1690</span>        <span class="keywordflow">switch</span> ($engine) {</div>
<div class="line"><span class="lineno"> 1691</span>            <span class="comment">//case CRYPT_ENGINE_OPENSSL:</span></div>
<div class="line"><span class="lineno"> 1692</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#aec1c8f2a4ace0050f6457c9c61bf8310">CRYPT_ENGINE_MCRYPT</a>:</div>
<div class="line"><span class="lineno"> 1693</span>            <span class="keywordflow">case</span> <a class="code hl_variable" href="Base_8php.html#a02836fb7d55f32f31941fa9ecddbd8fc">CRYPT_ENGINE_INTERNAL</a>:</div>
<div class="line"><span class="lineno"> 1694</span>                $this-&gt;preferredEngine = $engine;</div>
<div class="line"><span class="lineno"> 1695</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1696</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1697</span>                $this-&gt;preferredEngine = <a class="code hl_variable" href="Base_8php.html#a8f1200db8ddce5bab18ddeec03362215">CRYPT_ENGINE_OPENSSL</a>;</div>
<div class="line"><span class="lineno"> 1698</span>        }</div>
<div class="line"><span class="lineno"> 1699</span> </div>
<div class="line"><span class="lineno"> 1700</span>        $this-&gt;_setEngine();</div>
<div class="line"><span class="lineno"> 1701</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Base_8php_source.html#l01720">_setEngine()</a>, <a class="el" href="Base_8php_source.html#l00106">CRYPT_ENGINE_INTERNAL</a>, <a class="el" href="Base_8php_source.html#l00110">CRYPT_ENGINE_MCRYPT</a>, and <a class="el" href="Base_8php_source.html#l00114">CRYPT_ENGINE_OPENSSL</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCrypt__Base_a1082dc0f46d62a6aaa2bf8088c521bfd_cgraph.png" border="0" usemap="#aclassCrypt__Base_a1082dc0f46d62a6aaa2bf8088c521bfd_cgraph" alt=""/></div>
<map name="aclassCrypt__Base_a1082dc0f46d62a6aaa2bf8088c521bfd_cgraph" id="aclassCrypt__Base_a1082dc0f46d62a6aaa2bf8088c521bfd_cgraph">
<area shape="rect" title="Sets the preferred crypt engine." alt="" coords="5,5,152,31"/>
<area shape="rect" href="classCrypt__Base.html#ab4e58314adec23125fc08ae86aa501e3" title="Sets the engine as appropriate." alt="" coords="200,5,293,31"/>
<area shape="rect" href="classCrypt__Base.html#ae62f456da9bef718ecc3e155d63f0dc8" title="Test for engine validity." alt="" coords="341,5,451,31"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a id="ace0c858100bed2086051616b5c9f896e" name="ace0c858100bed2086051616b5c9f896e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace0c858100bed2086051616b5c9f896e">&#9670;&#160;</a></span>$block_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$block_size = 16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00142">142</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a20b2fd4815c854da73ea97eb0b80585d" name="a20b2fd4815c854da73ea97eb0b80585d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20b2fd4815c854da73ea97eb0b80585d">&#9670;&#160;</a></span>$cfb_init_len</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$cfb_init_len = 600</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00294">294</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="ab060006d1221e5e476126476b921ad54" name="ab060006d1221e5e476126476b921ad54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab060006d1221e5e476126476b921ad54">&#9670;&#160;</a></span>$changed</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$changed = true</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00305">305</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a8cd607a337f707065b91770b8f14ec6e" name="a8cd607a337f707065b91770b8f14ec6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cd607a337f707065b91770b8f14ec6e">&#9670;&#160;</a></span>$cipher_name_mcrypt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$cipher_name_mcrypt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00363">363</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a662d78092265a47caff4e068e74bff67" name="a662d78092265a47caff4e068e74bff67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a662d78092265a47caff4e068e74bff67">&#9670;&#160;</a></span>$cipher_name_openssl</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$cipher_name_openssl</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00374">374</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a4bc82d506210132f76de65f15df6e175" name="a4bc82d506210132f76de65f15df6e175"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bc82d506210132f76de65f15df6e175">&#9670;&#160;</a></span>$cipher_name_openssl_ecb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$cipher_name_openssl_ecb</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00386">386</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="ae829ae62fafd5d12c345286a4f66d54f" name="ae829ae62fafd5d12c345286a4f66d54f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae829ae62fafd5d12c345286a4f66d54f">&#9670;&#160;</a></span>$const_namespace</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$const_namespace</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00418">418</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a87a08812a447665deda8b4f637a3fd3c" name="a87a08812a447665deda8b4f637a3fd3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87a08812a447665deda8b4f637a3fd3c">&#9670;&#160;</a></span>$continuousBuffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$continuousBuffer = false</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00189">189</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="af7b9d1db8026a18bac02db20236b3041" name="af7b9d1db8026a18bac02db20236b3041"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7b9d1db8026a18bac02db20236b3041">&#9670;&#160;</a></span>$debuffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$debuffer</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00209">209</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a95a208baa79b17e35077ce93c3259de8" name="a95a208baa79b17e35077ce93c3259de8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95a208baa79b17e35077ce93c3259de8">&#9670;&#160;</a></span>$dechanged</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$dechanged = true</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00253">253</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a503b1f86cfb167f4d6a6dc64d1859c93" name="a503b1f86cfb167f4d6a6dc64d1859c93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a503b1f86cfb167f4d6a6dc64d1859c93">&#9670;&#160;</a></span>$decryptIV</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$decryptIV</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00180">180</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a3e9093ce4b7142ef92caef91f117dae4" name="a3e9093ce4b7142ef92caef91f117dae4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e9093ce4b7142ef92caef91f117dae4">&#9670;&#160;</a></span>$demcrypt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$demcrypt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00233">233</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="ab7384c69661159001cb7940c65ad164b" name="ab7384c69661159001cb7940c65ad164b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7384c69661159001cb7940c65ad164b">&#9670;&#160;</a></span>$ecb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$ecb</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00272">272</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a046df06c5e603847c89a819ec0d72e61" name="a046df06c5e603847c89a819ec0d72e61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a046df06c5e603847c89a819ec0d72e61">&#9670;&#160;</a></span>$enbuffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$enbuffer</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00199">199</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a9441e4025dc9752d42d5b9ccecb1e43f" name="a9441e4025dc9752d42d5b9ccecb1e43f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9441e4025dc9752d42d5b9ccecb1e43f">&#9670;&#160;</a></span>$enchanged</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$enchanged = true</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00243">243</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a844b790c27e6ac5bed660f5f39b968a2" name="a844b790c27e6ac5bed660f5f39b968a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a844b790c27e6ac5bed660f5f39b968a2">&#9670;&#160;</a></span>$encryptIV</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$encryptIV</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00170">170</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a8a3b012ad4844366d9207d8f0e174a00" name="a8a3b012ad4844366d9207d8f0e174a00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a3b012ad4844366d9207d8f0e174a00">&#9670;&#160;</a></span>$engine</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$engine</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00340">340</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

<p class="reference">Referenced by <a class="el" href="Blowfish_8php_source.html#l00390">Crypt_Blowfish\isValidEngine()</a>, <a class="el" href="DES_8php_source.html#l00664">Crypt_DES\isValidEngine()</a>, <a class="el" href="RC2_8php_source.html#l00345">Crypt_RC2\isValidEngine()</a>, <a class="el" href="RC4_8php_source.html#l00190">Crypt_RC4\isValidEngine()</a>, <a class="el" href="Rijndael_8php_source.html#l00360">Crypt_Rijndael\isValidEngine()</a>, <a class="el" href="TripleDES_8php_source.html#l00248">Crypt_TripleDES\isValidEngine()</a>, and <a class="el" href="TripleDES_8php_source.html#l00507">Crypt_TripleDES\setPreferredEngine()</a>.</p>

</div>
</div>
<a id="a1af90a6b87c48d4dd7737e8db69d58a7" name="a1af90a6b87c48d4dd7737e8db69d58a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1af90a6b87c48d4dd7737e8db69d58a7">&#9670;&#160;</a></span>$enmcrypt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$enmcrypt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00221">221</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="ab69ac592e5538135ff601ca4b8fa92c7" name="ab69ac592e5538135ff601ca4b8fa92c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab69ac592e5538135ff601ca4b8fa92c7">&#9670;&#160;</a></span>$explicit_key_length</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$explicit_key_length = false</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00471">471</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a3e914e76d25e4f5a8af66643aab09fa9" name="a3e914e76d25e4f5a8af66643aab09fa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e914e76d25e4f5a8af66643aab09fa9">&#9670;&#160;</a></span>$inline_crypt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$inline_crypt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00433">433</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a147a28261cd10fb6dbdae31eb0a89c8d" name="a147a28261cd10fb6dbdae31eb0a89c8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a147a28261cd10fb6dbdae31eb0a89c8d">&#9670;&#160;</a></span>$iv</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$iv</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00160">160</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

<p class="reference">Referenced by <a class="el" href="TripleDES_8php_source.html#l00269">Crypt_TripleDES\setIV()</a>.</p>

</div>
</div>
<a id="aa60b0284e0dfa2463495481cf11e3cf4" name="aa60b0284e0dfa2463495481cf11e3cf4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa60b0284e0dfa2463495481cf11e3cf4">&#9670;&#160;</a></span>$key</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$key = &quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00151">151</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

<p class="reference">Referenced by <a class="el" href="Blowfish_8php_source.html#l00412">Crypt_Blowfish\_setupKey()</a>, <a class="el" href="DES_8php_source.html#l00828">Crypt_DES\_setupKey()</a>, <a class="el" href="Twofish_8php_source.html#l00474">Crypt_Twofish\_setupKey()</a>, <a class="el" href="AES_8php_source.html#l00178">Crypt_AES\setKey()</a>, <a class="el" href="DES_8php_source.html#l00691">Crypt_DES\setKey()</a>, <a class="el" href="Rijndael_8php_source.html#l00261">Crypt_Rijndael\setKey()</a>, and <a class="el" href="TripleDES_8php_source.html#l00320">Crypt_TripleDES\setKey()</a>.</p>

</div>
</div>
<a id="a3aaf40baac36e278c7d7c9139df1750c" name="a3aaf40baac36e278c7d7c9139df1750c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3aaf40baac36e278c7d7c9139df1750c">&#9670;&#160;</a></span>$mode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$mode</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00134">134</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

<p class="reference">Referenced by <a class="el" href="TripleDES_8php_source.html#l00199">Crypt_TripleDES\__construct()</a>, <a class="el" href="RC4_8php_source.html#l00334">Crypt_RC4\_crypt()</a>, <a class="el" href="DES_8php_source.html#l00747">Crypt_DES\_processBlock()</a>, <a class="el" href="TripleDES_8php_source.html#l00233">Crypt_TripleDES\Crypt_TripleDES()</a>, and <a class="el" href="TripleDES_8php_source.html#l00248">Crypt_TripleDES\isValidEngine()</a>.</p>

</div>
</div>
<a id="a51ca16e2b0fc5a63963d3b4348bb2b7c" name="a51ca16e2b0fc5a63963d3b4348bb2b7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51ca16e2b0fc5a63963d3b4348bb2b7c">&#9670;&#160;</a></span>$openssl_emulate_ctr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$openssl_emulate_ctr = false</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00453">453</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a6f79357a9e674ecfc6f5649bf8c3d923" name="a6f79357a9e674ecfc6f5649bf8c3d923"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f79357a9e674ecfc6f5649bf8c3d923">&#9670;&#160;</a></span>$openssl_options</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$openssl_options</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00462">462</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="adcbc08bc1b750a9e99f89eadacb274f7" name="adcbc08bc1b750a9e99f89eadacb274f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcbc08bc1b750a9e99f89eadacb274f7">&#9670;&#160;</a></span>$paddable</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$paddable = false</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00323">323</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a8563f129efffd9bcc2e662e00c0ba29e" name="a8563f129efffd9bcc2e662e00c0ba29e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8563f129efffd9bcc2e662e00c0ba29e">&#9670;&#160;</a></span>$padding</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$padding = true</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00314">314</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="a4713350dcea06d7ac52a49e65d9a089c" name="a4713350dcea06d7ac52a49e65d9a089c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4713350dcea06d7ac52a49e65d9a089c">&#9670;&#160;</a></span>$password_default_salt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$password_default_salt = 'phpseclib/salt'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00395">395</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="aac1cfc082e560ddb261a1643ebb851a8" name="aac1cfc082e560ddb261a1643ebb851a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac1cfc082e560ddb261a1643ebb851a8">&#9670;&#160;</a></span>$preferredEngine</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$preferredEngine</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00350">350</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="aa1a44dd580ee401d0d447cf6a8a2a7a9" name="aa1a44dd580ee401d0d447cf6a8a2a7a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1a44dd580ee401d0d447cf6a8a2a7a9">&#9670;&#160;</a></span>$skip_key_adjustment</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$skip_key_adjustment = false</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00480">480</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<a id="ad463584f44c7740c6d0a5705c9e178cc" name="ad463584f44c7740c6d0a5705c9e178cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad463584f44c7740c6d0a5705c9e178cc">&#9670;&#160;</a></span>$use_inline_crypt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$use_inline_crypt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Base_8php_source.html#l00444">444</a> of file <a class="el" href="Base_8php_source.html">Base.php</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/View/lib/phpseclib/Crypt/<a class="el" href="Base_8php_source.html">Base.php</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classCrypt__Base.html">Crypt_Base</a></li>
    <li class="footer">Generated on Sun Apr 30 2023 00:52:47 for PF Firewall by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
