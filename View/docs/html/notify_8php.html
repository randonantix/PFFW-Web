<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PF Firewall: src/Notifier/notify.php File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PF Firewall<span id="projectnumber">&#160;7.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('notify_8php.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">notify.php File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Gets module statuses and sends push notifications.  
<a href="#details">More...</a></p>

<p><a href="notify_8php_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac089920689dafbf6a510f3b87eb6a6d4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="notify_8php.html#ac089920689dafbf6a510f3b87eb6a6d4">PrintHelpWindow</a> ($msg, $<a class="el" href="conf_8notifier_8php.html#a8564a5df6b59c3d332aae3fb6c0746bc">width</a>='auto', $type='INFO')</td></tr>
<tr class="memdesc:ac089920689dafbf6a510f3b87eb6a6d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Satisfies Controller.  <br /></td></tr>
<tr class="separator:ac089920689dafbf6a510f3b87eb6a6d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0a55790f8935bf7687b982bfb13968e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="notify_8php.html#ad0a55790f8935bf7687b982bfb13968e">Notify</a> ($title, $body, $data)</td></tr>
<tr class="separator:ad0a55790f8935bf7687b982bfb13968e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a598480993c4de9ea29ffe5c0fad27b70"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="notify_8php.html#a598480993c4de9ea29ffe5c0fad27b70">BuildFields</a> (&amp;$title, &amp;$body, &amp;$data, $total, $level, $text)</td></tr>
<tr class="separator:a598480993c4de9ea29ffe5c0fad27b70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac59b7758873c6578404e1d3a593c7038"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="notify_8php.html#ac59b7758873c6578404e1d3a593c7038">FilterLogLevels</a> ()</td></tr>
<tr class="separator:ac59b7758873c6578404e1d3a593c7038"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1533dd11a6f243ee103e120b2b174825"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="notify_8php.html#a1533dd11a6f243ee103e120b2b174825">FilterKeywords</a> ()</td></tr>
<tr class="separator:a1533dd11a6f243ee103e120b2b174825"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b4acf7e77142eb7a921ea8121456dc0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="notify_8php.html#a4b4acf7e77142eb7a921ea8121456dc0">FilterPreviousLogs</a> ()</td></tr>
<tr class="separator:a4b4acf7e77142eb7a921ea8121456dc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3c60c4d05948280e2c028ad791e7cc82"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="notify_8php.html#a3c60c4d05948280e2c028ad791e7cc82">$ROOT</a> = dirname(dirname(__FILE__))</td></tr>
<tr class="separator:a3c60c4d05948280e2c028ad791e7cc82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cf4c1ce4d54df11a660775bb7c5bbd8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="notify_8php.html#a1cf4c1ce4d54df11a660775bb7c5bbd8">$VIEW_PATH</a> = $ROOT.'/<a class="el" href="classView.html">View</a>/'</td></tr>
<tr class="separator:a1cf4c1ce4d54df11a660775bb7c5bbd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa85c30e769dd86430134683306463a51"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="notify_8php.html#aa85c30e769dd86430134683306463a51">$StatusText</a></td></tr>
<tr class="separator:aa85c30e769dd86430134683306463a51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e72d5ffade7f18c8473dfb0e6415d92"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="notify_8php.html#a2e72d5ffade7f18c8473dfb0e6415d92">$Prios</a></td></tr>
<tr class="separator:a2e72d5ffade7f18c8473dfb0e6415d92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfe49c647d27eb2b424c3ea73082382f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="notify_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a> = new <a class="el" href="classView.html">View</a>()</td></tr>
<tr class="separator:adfe49c647d27eb2b424c3ea73082382f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9151809b1224544377732b01b47eddb"><td class="memItemLeft" align="right" valign="top">$<a class="el" href="classView.html">View</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="notify_8php.html#aa9151809b1224544377732b01b47eddb">Model</a> = 'system'</td></tr>
<tr class="separator:aa9151809b1224544377732b01b47eddb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae24ad5440f9dc504e9e3ef2ddfb65566"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="notify_8php.html#ae24ad5440f9dc504e9e3ef2ddfb65566">$UseSSH</a> = FALSE</td></tr>
<tr class="separator:ae24ad5440f9dc504e9e3ef2ddfb65566"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad710cc6443330c829dc21fc80f3a233c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ctlr_8php.html#abc2baa6b327386720a46de43cf272921">if</a>(count(json_decode($NotifierUsers, TRUE)) &gt; 0)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="notify_8php.html#ad710cc6443330c829dc21fc80f3a233c">else</a></td></tr>
<tr class="separator:ad710cc6443330c829dc21fc80f3a233c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Gets module statuses and sends push notifications. </p>

<p class="definition">Definition in file <a class="el" href="notify_8php_source.html">notify.php</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a598480993c4de9ea29ffe5c0fad27b70" name="a598480993c4de9ea29ffe5c0fad27b70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a598480993c4de9ea29ffe5c0fad27b70">&#9670;&#160;</a></span>BuildFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BuildFields </td>
          <td>(</td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;&#160;</td>
          <td class="paramname"><em>$data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$text</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="notify_8php_source.html#l00148">148</a> of file <a class="el" href="notify_8php_source.html">notify.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  149</span>{</div>
<div class="line"><span class="lineno">  150</span>    global $ModuleErrorCounts, <a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>, <a class="code hl_variable" href="notify_8php.html#aa85c30e769dd86430134683306463a51">$StatusText</a>, <a class="code hl_variable" href="notify_8php.html#a2e72d5ffade7f18c8473dfb0e6415d92">$Prios</a>;</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>    $title[]= <span class="stringliteral">&quot;$total $text&quot;</span>;</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>    $modules= array();</div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">foreach</span> ($ModuleErrorCounts[$level] as $module =&gt; $count) {</div>
<div class="line"><span class="lineno">  156</span>        $modules[]= ucfirst($module).<span class="charliteral">&#39; &#39;</span>.<a class="code hl_variable" href="notify_8php.html#aa85c30e769dd86430134683306463a51">$StatusText</a>[<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module][<span class="stringliteral">&#39;Status&#39;</span>]].<span class="stringliteral">&quot;: $count $text&quot;</span>;</div>
<div class="line"><span class="lineno">  157</span>    }</div>
<div class="line"><span class="lineno">  158</span>    $body[]= implode(<span class="stringliteral">&#39;, &#39;</span>, $modules);</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">foreach</span> ($ModuleErrorCounts[$level] as $module =&gt; $count) {</div>
<div class="line"><span class="lineno">  161</span>        <span class="keywordflow">foreach</span> (<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module][<span class="stringliteral">&#39;Logs&#39;</span>] as $log) {</div>
<div class="line"><span class="lineno">  162</span>            <span class="keywordflow">if</span> (in_array($log[<span class="stringliteral">&#39;Prio&#39;</span>], <a class="code hl_variable" href="notify_8php.html#a2e72d5ffade7f18c8473dfb0e6415d92">$Prios</a>[$level])) {</div>
<div class="line"><span class="lineno">  163</span>                $data[$module][$level][]= $log;</div>
<div class="line"><span class="lineno">  164</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  165</span>            }</div>
<div class="line"><span class="lineno">  166</span>        }</div>
<div class="line"><span class="lineno">  167</span>    }</div>
<div class="line"><span class="lineno">  168</span>}</div>
<div class="ttc" id="adashboard_8php_html_a3af44abb08b57c22ceb30f2513a0c182"><div class="ttname"><a href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a></div><div class="ttdeci">if($StatusCheckInterval !==$DashboardIntervals2Seconds[$LastDashboardInterval]) $ServiceStatus</div><div class="ttdef"><b>Definition:</b> <a href="dashboard_8php_source.html#l00055">dashboard.php:55</a></div></div>
<div class="ttc" id="anotify_8php_html_a2e72d5ffade7f18c8473dfb0e6415d92"><div class="ttname"><a href="notify_8php.html#a2e72d5ffade7f18c8473dfb0e6415d92">$Prios</a></div><div class="ttdeci">$Prios</div><div class="ttdef"><b>Definition:</b> <a href="notify_8php_source.html#l00050">notify.php:50</a></div></div>
<div class="ttc" id="anotify_8php_html_aa85c30e769dd86430134683306463a51"><div class="ttname"><a href="notify_8php.html#aa85c30e769dd86430134683306463a51">$StatusText</a></div><div class="ttdeci">$StatusText</div><div class="ttdef"><b>Definition:</b> <a href="notify_8php_source.html#l00045">notify.php:45</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="notify_8php_source.html#l00050">$Prios</a>, <a class="el" href="dashboard_8php_source.html#l00055">$ServiceStatus</a>, and <a class="el" href="notify_8php_source.html#l00045">$StatusText</a>.</p>

</div>
</div>
<a id="a1533dd11a6f243ee103e120b2b174825" name="a1533dd11a6f243ee103e120b2b174825"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1533dd11a6f243ee103e120b2b174825">&#9670;&#160;</a></span>FilterKeywords()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FilterKeywords </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000044">Todo:</a></b></dt><dd>Filter module names too? So the module name must be among the filter keywords </dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>Fake slice to update the keys, keep all seen logs to filter the next $ServiceStatus</dd></dl>

<p class="definition">Definition at line <a class="el" href="notify_8php_source.html#l00210">210</a> of file <a class="el" href="notify_8php_source.html">notify.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  211</span>{</div>
<div class="line"><span class="lineno">  212</span>    global <a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>, <a class="code hl_variable" href="lib_2setup_8php.html#ae1ad0f4a1e1397d43f1e3964cd58dfbf">$NotifierFilters</a>;</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    $filters= json_decode(<a class="code hl_variable" href="lib_2setup_8php.html#ae1ad0f4a1e1397d43f1e3964cd58dfbf">$NotifierFilters</a>, TRUE);</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span>    <span class="keywordflow">if</span> (count($filters) == 0) {</div>
<div class="line"><span class="lineno">  217</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  218</span>    }</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordflow">foreach</span> (<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a> as $module =&gt; $status) {</div>
<div class="line"><span class="lineno">  221</span>        <span class="keywordflow">foreach</span> ($status[<span class="stringliteral">&#39;Logs&#39;</span>] as $i =&gt; $log) {</div>
<div class="line"><span class="lineno">  222</span>            $deleteLog= TRUE;</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>            <span class="keywordflow">foreach</span> ($filters as $re) {</div>
<div class="line"><span class="lineno">  225</span>                $re= <a class="code hl_function" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9">Escape</a>($re, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno">  227</span>                <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&quot;/$re/&quot;</span>, $log[<span class="stringliteral">&#39;Process&#39;</span>]) || preg_match(<span class="stringliteral">&quot;/$re/&quot;</span>, $log[<span class="stringliteral">&#39;Prio&#39;</span>]) || preg_match(<span class="stringliteral">&quot;/$re/&quot;</span>, $log[<span class="stringliteral">&#39;Log&#39;</span>])) {</div>
<div class="line"><span class="lineno">  228</span>                    $deleteLog= FALSE;</div>
<div class="line"><span class="lineno">  229</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  230</span>                }</div>
<div class="line"><span class="lineno">  231</span>            }</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>            <span class="keywordflow">if</span> ($deleteLog) {</div>
<div class="line"><span class="lineno">  234</span>                unset(<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module][<span class="stringliteral">&#39;Logs&#39;</span>][$i]);</div>
<div class="line"><span class="lineno">  235</span>            }</div>
<div class="line"><span class="lineno">  236</span>        }</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>        <span class="keywordflow">if</span> (count(<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module][<span class="stringliteral">&#39;Logs&#39;</span>]) == 0) {</div>
<div class="line"><span class="lineno">  239</span>            unset(<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module]);</div>
<div class="line"><span class="lineno">  240</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  242</span>            <a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module][<span class="stringliteral">&#39;Logs&#39;</span>]= array_slice(<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module][<span class="stringliteral">&#39;Logs&#39;</span>], 0);</div>
<div class="line"><span class="lineno">  243</span>        }</div>
<div class="line"><span class="lineno">  244</span>    }</div>
<div class="line"><span class="lineno">  245</span>}</div>
<div class="ttc" id="alib_2lib_8php_html_a998c26d78939d233b87794689e841eb9"><div class="ttname"><a href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9">Escape</a></div><div class="ttdeci">Escape($str, $chars, $no_double_escapes=TRUE)</div><div class="ttdoc">Escapes chars.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2lib_8php_source.html#l00080">lib.php:80</a></div></div>
<div class="ttc" id="alib_2setup_8php_html_ae1ad0f4a1e1397d43f1e3964cd58dfbf"><div class="ttname"><a href="lib_2setup_8php.html#ae1ad0f4a1e1397d43f1e3964cd58dfbf">$NotifierFilters</a></div><div class="ttdeci">$NotifierFilters</div><div class="ttdoc">Send notifications containing one of these keywords only.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2setup_8php_source.html#l00065">setup.php:65</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="lib_2setup_8php_source.html#l00065">$NotifierFilters</a>, <a class="el" href="dashboard_8php_source.html#l00055">$ServiceStatus</a>, and <a class="el" href="lib_2lib_8php_source.html#l00080">Escape()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="notify_8php_a1533dd11a6f243ee103e120b2b174825_cgraph.png" border="0" usemap="#anotify_8php_a1533dd11a6f243ee103e120b2b174825_cgraph" alt=""/></div>
<map name="anotify_8php_a1533dd11a6f243ee103e120b2b174825_cgraph" id="anotify_8php_a1533dd11a6f243ee103e120b2b174825_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,124,31"/>
<area shape="rect" href="lib_2lib_8php.html#a998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="172,5,240,31"/>
</map>
</div>

</div>
</div>
<a id="ac59b7758873c6578404e1d3a593c7038" name="ac59b7758873c6578404e1d3a593c7038"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac59b7758873c6578404e1d3a593c7038">&#9670;&#160;</a></span>FilterLogLevels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FilterLogLevels </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section attention"><dt>Attention</dt><dd>Fake slice to update the keys, keep all seen logs to filter the next $ServiceStatus</dd></dl>

<p class="definition">Definition at line <a class="el" href="notify_8php_source.html#l00170">170</a> of file <a class="el" href="notify_8php_source.html">notify.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  171</span>{</div>
<div class="line"><span class="lineno">  172</span>    global <a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>, <a class="code hl_variable" href="notify_8php.html#a2e72d5ffade7f18c8473dfb0e6415d92">$Prios</a>, <a class="code hl_variable" href="lib_2setup_8php.html#a1fdb31b2f2f83cf6e60c166eba370291">$NotifyLevel</a>;</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>    <span class="keywordflow">foreach</span> (<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a> as $module =&gt; $status) {</div>
<div class="line"><span class="lineno">  175</span>        <span class="keywordflow">foreach</span> ($status[<span class="stringliteral">&#39;Logs&#39;</span>] as $i =&gt; $log) {</div>
<div class="line"><span class="lineno">  176</span>            <span class="comment">// The log should pass the log level filter, otherwise we delete it</span></div>
<div class="line"><span class="lineno">  177</span>            $deleteLog= TRUE;</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>            <span class="comment">// Critical errors are always reported</span></div>
<div class="line"><span class="lineno">  180</span>            <span class="keywordflow">if</span> (in_array($log[<span class="stringliteral">&#39;Prio&#39;</span>], <a class="code hl_variable" href="notify_8php.html#a2e72d5ffade7f18c8473dfb0e6415d92">$Prios</a>[<span class="stringliteral">&#39;Critical&#39;</span>])) {</div>
<div class="line"><span class="lineno">  181</span>                $deleteLog= FALSE;</div>
<div class="line"><span class="lineno">  182</span>            }</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>            <span class="keywordflow">if</span> ($deleteLog &amp;&amp; <a class="code hl_variable" href="lib_2setup_8php.html#a1fdb31b2f2f83cf6e60c166eba370291">$NotifyLevel</a> &gt;= LOG_ERR) {</div>
<div class="line"><span class="lineno">  185</span>                <span class="keywordflow">if</span> (in_array($log[<span class="stringliteral">&#39;Prio&#39;</span>], <a class="code hl_variable" href="notify_8php.html#a2e72d5ffade7f18c8473dfb0e6415d92">$Prios</a>[<span class="stringliteral">&#39;Error&#39;</span>])) {</div>
<div class="line"><span class="lineno">  186</span>                    $deleteLog= FALSE;</div>
<div class="line"><span class="lineno">  187</span>                }</div>
<div class="line"><span class="lineno">  188</span>            }</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>            <span class="keywordflow">if</span> ($deleteLog &amp;&amp; <a class="code hl_variable" href="lib_2setup_8php.html#a1fdb31b2f2f83cf6e60c166eba370291">$NotifyLevel</a> &gt;= LOG_WARNING) {</div>
<div class="line"><span class="lineno">  191</span>                <span class="keywordflow">if</span> (in_array($log[<span class="stringliteral">&#39;Prio&#39;</span>], <a class="code hl_variable" href="notify_8php.html#a2e72d5ffade7f18c8473dfb0e6415d92">$Prios</a>[<span class="stringliteral">&#39;Warning&#39;</span>])) {</div>
<div class="line"><span class="lineno">  192</span>                    $deleteLog= FALSE;</div>
<div class="line"><span class="lineno">  193</span>                }</div>
<div class="line"><span class="lineno">  194</span>            }</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>            <span class="keywordflow">if</span> ($deleteLog) {</div>
<div class="line"><span class="lineno">  197</span>                unset(<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module][<span class="stringliteral">&#39;Logs&#39;</span>][$i]);</div>
<div class="line"><span class="lineno">  198</span>            }</div>
<div class="line"><span class="lineno">  199</span>        }</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>        <span class="keywordflow">if</span> (count(<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module][<span class="stringliteral">&#39;Logs&#39;</span>]) == 0) {</div>
<div class="line"><span class="lineno">  202</span>            unset(<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module]);</div>
<div class="line"><span class="lineno">  203</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  205</span>            <a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module][<span class="stringliteral">&#39;Logs&#39;</span>]= array_slice(<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module][<span class="stringliteral">&#39;Logs&#39;</span>], 0);</div>
<div class="line"><span class="lineno">  206</span>        }</div>
<div class="line"><span class="lineno">  207</span>    }</div>
<div class="line"><span class="lineno">  208</span>}</div>
<div class="ttc" id="alib_2setup_8php_html_a1fdb31b2f2f83cf6e60c166eba370291"><div class="ttname"><a href="lib_2setup_8php.html#a1fdb31b2f2f83cf6e60c166eba370291">$NotifyLevel</a></div><div class="ttdeci">$NotifyLevel</div><div class="ttdoc">Send module statuses at this priority level and up as notification.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2setup_8php_source.html#l00050">setup.php:50</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="lib_2setup_8php_source.html#l00050">$NotifyLevel</a>, <a class="el" href="notify_8php_source.html#l00050">$Prios</a>, and <a class="el" href="dashboard_8php_source.html#l00055">$ServiceStatus</a>.</p>

</div>
</div>
<a id="a4b4acf7e77142eb7a921ea8121456dc0" name="a4b4acf7e77142eb7a921ea8121456dc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b4acf7e77142eb7a921ea8121456dc0">&#9670;&#160;</a></span>FilterPreviousLogs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FilterPreviousLogs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section attention"><dt>Attention</dt><dd>Save $ServiceStatus before filtering with the previous logs, otherwise we may delete current logs</dd>
<dd>
Fake slice to update the keys</dd></dl>

<p class="definition">Definition at line <a class="el" href="notify_8php_source.html#l00247">247</a> of file <a class="el" href="notify_8php_source.html">notify.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  248</span>{</div>
<div class="line"><span class="lineno">  249</span>    global <a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>;</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>    $notifierFile= <a class="code hl_variable" href="defs_8php.html#aa8d15384fc15e1dedc917fe43ebf78e2">PFFWDIR</a>.<span class="stringliteral">&#39;/out/NotifierServiceStatus.json&#39;</span>;</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>    $previousServiceStatus= array();</div>
<div class="line"><span class="lineno">  254</span>    <span class="keywordflow">if</span> (file_exists($notifierFile)) {</div>
<div class="line"><span class="lineno">  255</span>        $previousServiceStatus= json_decode(file_get_contents($notifierFile), TRUE);</div>
<div class="line"><span class="lineno">  256</span>    }</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>    <span class="comment">// Save the current $ServiceStatus to use as a filter for the next notifier call</span></div>
<div class="line"><span class="lineno">  259</span>    <span class="comment">// Do not use PutFile(), it expects file to exist</span></div>
<div class="line"><span class="lineno">  261</span><span class="comment"></span>    <span class="comment">// All logs should remain in $previousServiceStatus until they drop from the unfiltered $ServiceStatus, hence the definition of &quot;current&quot; logs</span></div>
<div class="line"><span class="lineno">  262</span>    file_put_contents($notifierFile, json_encode(<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>), LOCK_EX);</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>    <span class="comment">// Filter with the previously sent logs, i.e. do not send the same log twice</span></div>
<div class="line"><span class="lineno">  265</span>    <span class="keywordflow">foreach</span> ($previousServiceStatus as $module =&gt; $status) {</div>
<div class="line"><span class="lineno">  266</span>        <span class="keywordflow">if</span> (!array_key_exists($module, <a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>)) {</div>
<div class="line"><span class="lineno">  267</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  268</span>        }</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>        <span class="keywordflow">foreach</span> ($previousServiceStatus[$module][<span class="stringliteral">&#39;Logs&#39;</span>] as $plog) {</div>
<div class="line"><span class="lineno">  271</span>            <span class="keywordflow">foreach</span> (<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module][<span class="stringliteral">&#39;Logs&#39;</span>] as $i =&gt; $clog) {</div>
<div class="line"><span class="lineno">  272</span>                <span class="keywordflow">if</span> ($plog[<span class="stringliteral">&#39;Date&#39;</span>] == $clog[<span class="stringliteral">&#39;Date&#39;</span>] &amp;&amp; $plog[<span class="stringliteral">&#39;Time&#39;</span>] == $clog[<span class="stringliteral">&#39;Time&#39;</span>] &amp;&amp; $plog[<span class="stringliteral">&#39;Process&#39;</span>] == $clog[<span class="stringliteral">&#39;Process&#39;</span>]</div>
<div class="line"><span class="lineno">  273</span>                        &amp;&amp; $plog[<span class="stringliteral">&#39;Prio&#39;</span>] == $clog[<span class="stringliteral">&#39;Prio&#39;</span>] &amp;&amp; $plog[<span class="stringliteral">&#39;Log&#39;</span>] == $clog[<span class="stringliteral">&#39;Log&#39;</span>]) {</div>
<div class="line"><span class="lineno">  274</span>                    unset(<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module][<span class="stringliteral">&#39;Logs&#39;</span>][$i]);</div>
<div class="line"><span class="lineno">  275</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  276</span>                }</div>
<div class="line"><span class="lineno">  277</span>            }</div>
<div class="line"><span class="lineno">  278</span>        }</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>        <span class="keywordflow">if</span> (count(<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module][<span class="stringliteral">&#39;Logs&#39;</span>]) == 0) {</div>
<div class="line"><span class="lineno">  281</span>            unset(<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module]);</div>
<div class="line"><span class="lineno">  282</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  284</span>            <a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module][<span class="stringliteral">&#39;Logs&#39;</span>]= array_slice(<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$module][<span class="stringliteral">&#39;Logs&#39;</span>], 0);</div>
<div class="line"><span class="lineno">  285</span>        }</div>
<div class="line"><span class="lineno">  286</span>    }</div>
<div class="line"><span class="lineno">  287</span>}</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span><a class="code hl_variable" href="notify_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>= <span class="keyword">new</span> <a class="code hl_namespace" href="namespaceView.html">View</a>();</div>
<div class="line"><span class="lineno">  290</span><a class="code hl_variable" href="notify_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>-&gt;Model= <span class="stringliteral">&#39;system&#39;</span>;</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  293</span><span class="comment">// Do not use SSH to run Controller commands</span></div>
<div class="line"><span class="lineno">  294</span><a class="code hl_variable" href="notify_8php.html#ae24ad5440f9dc504e9e3ef2ddfb65566">$UseSSH</a>= FALSE;</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span><span class="keywordflow">if</span> (count(json_decode(<a class="code hl_variable" href="lib_2setup_8php.html#aa3e26955030209ec94f773fc6974be57">$NotifierUsers</a>, TRUE)) &gt; 0) {</div>
<div class="line"><span class="lineno">  297</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="notify_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>-&gt;Controller(<a class="code hl_variable" href="Model_2include_8php.html#a8a55ddd2b83051d9d86510dcd04f9f4c">$Output</a>, <span class="stringliteral">&#39;GetServiceStatus&#39;</span>)) {</div>
<div class="line"><span class="lineno">  298</span>        <a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>= json_decode(<a class="code hl_variable" href="Model_2include_8php.html#a8a55ddd2b83051d9d86510dcd04f9f4c">$Output</a>[0], TRUE)[<span class="stringliteral">&#39;status&#39;</span>];</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>        <a class="code hl_function" href="notify_8php.html#ac59b7758873c6578404e1d3a593c7038">FilterLogLevels</a>();</div>
<div class="line"><span class="lineno">  301</span>        <a class="code hl_function" href="notify_8php.html#a1533dd11a6f243ee103e120b2b174825">FilterKeywords</a>();</div>
<div class="line"><span class="lineno">  302</span>        <a class="code hl_function" href="notify_8php.html#a4b4acf7e77142eb7a921ea8121456dc0">FilterPreviousLogs</a>();</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>        <span class="comment">// $ServiceStatus may become empty after applying filters</span></div>
<div class="line"><span class="lineno">  305</span>        <span class="keywordflow">if</span> (count(<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>)) {</div>
<div class="line"><span class="lineno">  306</span>            <span class="comment">// Critical errors are always reported</span></div>
<div class="line"><span class="lineno">  307</span>            $NotifyWarning= <a class="code hl_variable" href="lib_2setup_8php.html#a1fdb31b2f2f83cf6e60c166eba370291">$NotifyLevel</a> &gt;= LOG_WARNING;</div>
<div class="line"><span class="lineno">  308</span>            $NotifyError= <a class="code hl_variable" href="lib_2setup_8php.html#a1fdb31b2f2f83cf6e60c166eba370291">$NotifyLevel</a> &gt;= LOG_ERR;</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>            <a class="code hl_variable" href="dashboard_8php.html#a2297f1a110d47f4912ccfa10ef70855c">$Critical</a>= 0;</div>
<div class="line"><span class="lineno">  311</span>            <a class="code hl_variable" href="ctlr_8php.html#a2c562fdccbd5b3b7fbd472330b7effd9">$Error</a>= 0;</div>
<div class="line"><span class="lineno">  312</span>            <a class="code hl_variable" href="dashboard_8php.html#a4d78c5a498ba74929d598820227b34ab">$Warning</a>= 0;</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>            $ModuleErrorCounts= array();</div>
<div class="line"><span class="lineno">  315</span>            <span class="keywordflow">foreach</span> (<a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a> as $Module =&gt; $StatusArray) {</div>
<div class="line"><span class="lineno">  316</span>                $count= <a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$Module][<span class="stringliteral">&#39;Critical&#39;</span>];</div>
<div class="line"><span class="lineno">  317</span>                <span class="keywordflow">if</span> ($count) {</div>
<div class="line"><span class="lineno">  318</span>                    <a class="code hl_variable" href="dashboard_8php.html#a2297f1a110d47f4912ccfa10ef70855c">$Critical</a>+= $count;</div>
<div class="line"><span class="lineno">  319</span>                    $ModuleErrorCounts[<span class="stringliteral">&#39;Critical&#39;</span>][$Module]= $count;</div>
<div class="line"><span class="lineno">  320</span>                }</div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span>                <span class="keywordflow">if</span> ($NotifyError) {</div>
<div class="line"><span class="lineno">  323</span>                    $count= <a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$Module][<span class="stringliteral">&#39;Error&#39;</span>];</div>
<div class="line"><span class="lineno">  324</span>                    <span class="keywordflow">if</span> ($count) {</div>
<div class="line"><span class="lineno">  325</span>                        <a class="code hl_variable" href="ctlr_8php.html#a2c562fdccbd5b3b7fbd472330b7effd9">$Error</a>+= $count;</div>
<div class="line"><span class="lineno">  326</span>                        $ModuleErrorCounts[<span class="stringliteral">&#39;Error&#39;</span>][$Module]= $count;</div>
<div class="line"><span class="lineno">  327</span>                    }</div>
<div class="line"><span class="lineno">  328</span>                }</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>                <span class="keywordflow">if</span> ($NotifyWarning) {</div>
<div class="line"><span class="lineno">  331</span>                    $count= <a class="code hl_variable" href="dashboard_8php.html#a3af44abb08b57c22ceb30f2513a0c182">$ServiceStatus</a>[$Module][<span class="stringliteral">&#39;Warning&#39;</span>];</div>
<div class="line"><span class="lineno">  332</span>                    <span class="keywordflow">if</span> ($count) {</div>
<div class="line"><span class="lineno">  333</span>                        <a class="code hl_variable" href="dashboard_8php.html#a4d78c5a498ba74929d598820227b34ab">$Warning</a>+= $count;</div>
<div class="line"><span class="lineno">  334</span>                        $ModuleErrorCounts[<span class="stringliteral">&#39;Warning&#39;</span>][$Module]= $count;</div>
<div class="line"><span class="lineno">  335</span>                    }</div>
<div class="line"><span class="lineno">  336</span>                }</div>
<div class="line"><span class="lineno">  337</span>            }</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>            <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&quot;Counts: $Critical, $Error, $Warning, Level: $NotifyLevel, $NotifyError, $NotifyWarning&quot;</span>);</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="dashboard_8php.html#a2297f1a110d47f4912ccfa10ef70855c">$Critical</a> || ($NotifyError &amp;&amp; <a class="code hl_variable" href="ctlr_8php.html#a2c562fdccbd5b3b7fbd472330b7effd9">$Error</a>) || ($NotifyWarning &amp;&amp; <a class="code hl_variable" href="dashboard_8php.html#a4d78c5a498ba74929d598820227b34ab">$Warning</a>)) {</div>
<div class="line"><span class="lineno">  342</span>                $Title= array();</div>
<div class="line"><span class="lineno">  343</span>                $Body= array();</div>
<div class="line"><span class="lineno">  344</span>                $Data= array();</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="dashboard_8php.html#a2297f1a110d47f4912ccfa10ef70855c">$Critical</a>) {</div>
<div class="line"><span class="lineno">  347</span>                    <a class="code hl_function" href="notify_8php.html#a598480993c4de9ea29ffe5c0fad27b70">BuildFields</a>($Title, $Body, $Data, <a class="code hl_variable" href="dashboard_8php.html#a2297f1a110d47f4912ccfa10ef70855c">$Critical</a>, <span class="stringliteral">&#39;Critical&#39;</span>, <span class="stringliteral">&#39;critical errors&#39;</span>);</div>
<div class="line"><span class="lineno">  348</span>                }</div>
<div class="line"><span class="lineno">  349</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="ctlr_8php.html#a2c562fdccbd5b3b7fbd472330b7effd9">$Error</a> &amp;&amp; $NotifyError) {</div>
<div class="line"><span class="lineno">  350</span>                    <a class="code hl_function" href="notify_8php.html#a598480993c4de9ea29ffe5c0fad27b70">BuildFields</a>($Title, $Body, $Data, <a class="code hl_variable" href="ctlr_8php.html#a2c562fdccbd5b3b7fbd472330b7effd9">$Error</a>, <span class="stringliteral">&#39;Error&#39;</span>, <span class="stringliteral">&#39;errors&#39;</span>);</div>
<div class="line"><span class="lineno">  351</span>                }</div>
<div class="line"><span class="lineno">  352</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="dashboard_8php.html#a4d78c5a498ba74929d598820227b34ab">$Warning</a> &amp;&amp; $NotifyWarning) {</div>
<div class="line"><span class="lineno">  353</span>                    <a class="code hl_function" href="notify_8php.html#a598480993c4de9ea29ffe5c0fad27b70">BuildFields</a>($Title, $Body, $Data, <a class="code hl_variable" href="dashboard_8php.html#a4d78c5a498ba74929d598820227b34ab">$Warning</a>, <span class="stringliteral">&#39;Warning&#39;</span>, <span class="stringliteral">&#39;warnings&#39;</span>);</div>
<div class="line"><span class="lineno">  354</span>                }</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>                $hostname= <span class="stringliteral">&#39;PFFW&#39;</span>;</div>
<div class="line"><span class="lineno">  357</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="notify_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a>-&gt;Controller($Myname, <span class="stringliteral">&#39;GetMyName&#39;</span>)) {</div>
<div class="line"><span class="lineno">  358</span>                    $hostname= $Myname[0];</div>
<div class="line"><span class="lineno">  359</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  360</span>                    <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;Cannot get system name&#39;</span>);</div>
<div class="line"><span class="lineno">  361</span>                }</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>                $Title= $hostname.<span class="stringliteral">&#39;: &#39;</span>.implode(<span class="stringliteral">&#39;, &#39;</span>, $Title);</div>
<div class="line"><span class="lineno">  364</span>                $Body= implode(<span class="stringliteral">&#39;, &#39;</span>, $Body);</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="notify_8php.html#ad0a55790f8935bf7687b982bfb13968e">Notify</a>($Title, $Body, $Data)) {</div>
<div class="line"><span class="lineno">  367</span>                    <a class="code hl_variable" href="dhcpd_2index_8php.html#a6733eb5f605d09eaede9845835d71c4e">exit</a>(0);</div>
<div class="line"><span class="lineno">  368</span>                }</div>
<div class="line"><span class="lineno">  369</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  370</span>                <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;Nothing to notify due to notify level or counts&#39;</span>);</div>
<div class="line"><span class="lineno">  371</span>                <a class="code hl_variable" href="dhcpd_2index_8php.html#a6733eb5f605d09eaede9845835d71c4e">exit</a>(0);</div>
<div class="line"><span class="lineno">  372</span>            }</div>
<div class="line"><span class="lineno">  373</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  374</span>            <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;Nothing to notify due to service status being empty, perhaps after applying filters&#39;</span>);</div>
<div class="line"><span class="lineno">  375</span>            <a class="code hl_variable" href="dhcpd_2index_8php.html#a6733eb5f605d09eaede9845835d71c4e">exit</a>(0);</div>
<div class="line"><span class="lineno">  376</span>        }</div>
<div class="line"><span class="lineno">  377</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  378</span>        <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;Cannot get service status&#39;</span>);</div>
<div class="line"><span class="lineno">  379</span>    }</div>
<div class="line"><span class="lineno">  380</span>} <span class="keywordflow">else</span> {</div>
<div class="ttc" id="aModel_2include_8php_html_a8a55ddd2b83051d9d86510dcd04f9f4c"><div class="ttname"><a href="Model_2include_8php.html#a8a55ddd2b83051d9d86510dcd04f9f4c">$Output</a></div><div class="ttdeci">$Output</div><div class="ttdef"><b>Definition:</b> <a href="Model_2include_8php_source.html#l00092">include.php:92</a></div></div>
<div class="ttc" id="actlr_8php_html_a2c562fdccbd5b3b7fbd472330b7effd9"><div class="ttname"><a href="ctlr_8php.html#a2c562fdccbd5b3b7fbd472330b7effd9">$Error</a></div><div class="ttdeci">out $Error</div><div class="ttdef"><b>Definition:</b> <a href="ctlr_8php_source.html#l00105">ctlr.php:105</a></div></div>
<div class="ttc" id="adashboard_8php_html_a2297f1a110d47f4912ccfa10ef70855c"><div class="ttname"><a href="dashboard_8php.html#a2297f1a110d47f4912ccfa10ef70855c">$Critical</a></div><div class="ttdeci">$Critical</div><div class="ttdef"><b>Definition:</b> <a href="dashboard_8php_source.html#l00079">dashboard.php:79</a></div></div>
<div class="ttc" id="adashboard_8php_html_a4d78c5a498ba74929d598820227b34ab"><div class="ttname"><a href="dashboard_8php.html#a4d78c5a498ba74929d598820227b34ab">$Warning</a></div><div class="ttdeci">$Warning</div><div class="ttdef"><b>Definition:</b> <a href="dashboard_8php_source.html#l00081">dashboard.php:81</a></div></div>
<div class="ttc" id="adefs_8php_html_aa8d15384fc15e1dedc917fe43ebf78e2"><div class="ttname"><a href="defs_8php.html#aa8d15384fc15e1dedc917fe43ebf78e2">PFFWDIR</a></div><div class="ttdeci">const PFFWDIR</div><div class="ttdef"><b>Definition:</b> <a href="defs_8php_source.html#l00034">defs.php:34</a></div></div>
<div class="ttc" id="adhcpd_2index_8php_html_a6733eb5f605d09eaede9845835d71c4e"><div class="ttname"><a href="dhcpd_2index_8php.html#a6733eb5f605d09eaede9845835d71c4e">exit</a></div><div class="ttdeci">exit</div><div class="ttdef"><b>Definition:</b> <a href="dhcpd_2index_8php_source.html#l00023">index.php:23</a></div></div>
<div class="ttc" id="alib_2setup_8php_html_aa3e26955030209ec94f773fc6974be57"><div class="ttname"><a href="lib_2setup_8php.html#aa3e26955030209ec94f773fc6974be57">$NotifierUsers</a></div><div class="ttdeci">$NotifierUsers</div><div class="ttdoc">Notifier users.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2setup_8php_source.html#l00062">setup.php:62</a></div></div>
<div class="ttc" id="alibauth_8php_html_aafa5d84b0ff32cf3d31b8cdfd1c6d769"><div class="ttname"><a href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a></div><div class="ttdeci">wui_syslog($prio, $file, $func, $line, $msg)</div><div class="ttdoc">Wrapper for syslog().</div><div class="ttdef"><b>Definition:</b> <a href="libauth_8php_source.html#l00067">libauth.php:67</a></div></div>
<div class="ttc" id="anamespaceView_html"><div class="ttname"><a href="namespaceView.html">View</a></div><div class="ttdoc">View of MVC: Generally, the View displays Model data and allows modification of the data.</div><div class="ttdef"><b>Definition:</b> <a href="View_2pf_2lib_2AfTo_8php_source.html#l00021">AfTo.php:21</a></div></div>
<div class="ttc" id="anotify_8php_html_a1533dd11a6f243ee103e120b2b174825"><div class="ttname"><a href="notify_8php.html#a1533dd11a6f243ee103e120b2b174825">FilterKeywords</a></div><div class="ttdeci">FilterKeywords()</div><div class="ttdef"><b>Definition:</b> <a href="notify_8php_source.html#l00210">notify.php:210</a></div></div>
<div class="ttc" id="anotify_8php_html_a4b4acf7e77142eb7a921ea8121456dc0"><div class="ttname"><a href="notify_8php.html#a4b4acf7e77142eb7a921ea8121456dc0">FilterPreviousLogs</a></div><div class="ttdeci">FilterPreviousLogs()</div><div class="ttdef"><b>Definition:</b> <a href="notify_8php_source.html#l00247">notify.php:247</a></div></div>
<div class="ttc" id="anotify_8php_html_a598480993c4de9ea29ffe5c0fad27b70"><div class="ttname"><a href="notify_8php.html#a598480993c4de9ea29ffe5c0fad27b70">BuildFields</a></div><div class="ttdeci">BuildFields(&amp;$title, &amp;$body, &amp;$data, $total, $level, $text)</div><div class="ttdef"><b>Definition:</b> <a href="notify_8php_source.html#l00148">notify.php:148</a></div></div>
<div class="ttc" id="anotify_8php_html_ac59b7758873c6578404e1d3a593c7038"><div class="ttname"><a href="notify_8php.html#ac59b7758873c6578404e1d3a593c7038">FilterLogLevels</a></div><div class="ttdeci">FilterLogLevels()</div><div class="ttdef"><b>Definition:</b> <a href="notify_8php_source.html#l00170">notify.php:170</a></div></div>
<div class="ttc" id="anotify_8php_html_ad0a55790f8935bf7687b982bfb13968e"><div class="ttname"><a href="notify_8php.html#ad0a55790f8935bf7687b982bfb13968e">Notify</a></div><div class="ttdeci">Notify($title, $body, $data)</div><div class="ttdef"><b>Definition:</b> <a href="notify_8php_source.html#l00067">notify.php:67</a></div></div>
<div class="ttc" id="anotify_8php_html_adfe49c647d27eb2b424c3ea73082382f"><div class="ttname"><a href="notify_8php.html#adfe49c647d27eb2b424c3ea73082382f">$View</a></div><div class="ttdeci">$View</div><div class="ttdef"><b>Definition:</b> <a href="notify_8php_source.html#l00289">notify.php:289</a></div></div>
<div class="ttc" id="anotify_8php_html_ae24ad5440f9dc504e9e3ef2ddfb65566"><div class="ttname"><a href="notify_8php.html#ae24ad5440f9dc504e9e3ef2ddfb65566">$UseSSH</a></div><div class="ttdeci">$UseSSH</div><div class="ttdef"><b>Definition:</b> <a href="notify_8php_source.html#l00294">notify.php:294</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="dashboard_8php_source.html#l00055">$ServiceStatus</a>, and <a class="el" href="defs_8php_source.html#l00034">PFFWDIR</a>.</p>

</div>
</div>
<a id="ad0a55790f8935bf7687b982bfb13968e" name="ad0a55790f8935bf7687b982bfb13968e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0a55790f8935bf7687b982bfb13968e">&#9670;&#160;</a></span>Notify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Notify </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section attention"><dt>Attention</dt><dd>Put data field within data, so that Android app does not convert the subfields to a map</dd>
<dd>
If the Android app is in the background, it cannot access the title and body fields in notification</dd></dl>

<p class="definition">Definition at line <a class="el" href="notify_8php_source.html#l00067">67</a> of file <a class="el" href="notify_8php_source.html">notify.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   68</span>{</div>
<div class="line"><span class="lineno">   69</span>    global <a class="code hl_variable" href="lib_2setup_8php.html#aefeb98ab0670035c39501682bb373e06">$NotifierHost</a>, <a class="code hl_variable" href="lib_2setup_8php.html#a0508338fca1a76b12a856a95be26afbb">$NotifierAPIKey</a>, <a class="code hl_variable" href="lib_2setup_8php.html#aa3e26955030209ec94f773fc6974be57">$NotifierUsers</a>, <a class="code hl_variable" href="lib_2setup_8php.html#ab734ea4f9b640926dc7bb2bf155f0a99">$NotifierSSLVerifyPeer</a>, <a class="code hl_variable" href="lib_2setup_8php.html#ad7c70e27974adcc10e32df92a886c4b6">$NotifierTimeout</a>;</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>    $return= FALSE;</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    $ch= curl_init();</div>
<div class="line"><span class="lineno">   74</span>    <span class="keywordflow">if</span> ($ch !== FALSE) {</div>
<div class="line"><span class="lineno">   75</span>        $headers= array(</div>
<div class="line"><span class="lineno">   76</span>            <span class="stringliteral">&#39;Authorization: key=&#39;</span>.<a class="code hl_variable" href="lib_2setup_8php.html#a0508338fca1a76b12a856a95be26afbb">$NotifierAPIKey</a>,</div>
<div class="line"><span class="lineno">   77</span>            <span class="stringliteral">&#39;Content-Type: application/json&#39;</span></div>
<div class="line"><span class="lineno">   78</span>            );</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>        $message= json_encode(</div>
<div class="line"><span class="lineno">   81</span>            array(</div>
<div class="line"><span class="lineno">   82</span>                <span class="stringliteral">&#39;registration_ids&#39;</span> =&gt; array_keys(json_decode(<a class="code hl_variable" href="lib_2setup_8php.html#aa3e26955030209ec94f773fc6974be57">$NotifierUsers</a>, TRUE)),</div>
<div class="line"><span class="lineno">   83</span>                <span class="stringliteral">&#39;notification&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">   84</span>                    <span class="stringliteral">&#39;title&#39;</span> =&gt; $title,</div>
<div class="line"><span class="lineno">   85</span>                    <span class="stringliteral">&#39;body&#39;</span> =&gt; $body,</div>
<div class="line"><span class="lineno">   86</span>                    <span class="stringliteral">&#39;icon&#39;</span> =&gt; <span class="stringliteral">&#39;notification&#39;</span>,</div>
<div class="line"><span class="lineno">   87</span>                    <span class="stringliteral">&#39;sound&#39;</span>=&gt; <span class="stringliteral">&#39;default&#39;</span>,</div>
<div class="line"><span class="lineno">   88</span>                    ),</div>
<div class="line"><span class="lineno">   89</span>                <span class="stringliteral">&#39;data&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">   90</span>                    <span class="stringliteral">&#39;title&#39;</span> =&gt; $title,</div>
<div class="line"><span class="lineno">   91</span>                    <span class="stringliteral">&#39;body&#39;</span> =&gt; $body,</div>
<div class="line"><span class="lineno">   92</span>                    <span class="stringliteral">&#39;data&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">   93</span>                        <span class="comment">// Timestamp used as unique message id</span></div>
<div class="line"><span class="lineno">   94</span>                        <span class="stringliteral">&#39;timestamp&#39;</span> =&gt; time(),</div>
<div class="line"><span class="lineno">   96</span>                        <span class="comment">// We process these fields uniformly as json</span></div>
<div class="line"><span class="lineno">   97</span>                        <span class="stringliteral">&#39;data&#39;</span> =&gt; array(</div>
<div class="line"><span class="lineno">   99</span>                            <span class="comment">// So, repeat the title and body fields in data</span></div>
<div class="line"><span class="lineno">  100</span>                            <span class="stringliteral">&#39;title&#39;</span> =&gt; $title,</div>
<div class="line"><span class="lineno">  101</span>                            <span class="stringliteral">&#39;body&#39;</span> =&gt; $body,</div>
<div class="line"><span class="lineno">  102</span>                            <span class="stringliteral">&#39;data&#39;</span> =&gt; $data,</div>
<div class="line"><span class="lineno">  103</span>                            <span class="stringliteral">&#39;datetime&#39;</span> =&gt; exec(<span class="stringliteral">&#39;/bin/date &quot;+%c&quot;&#39;</span>),</div>
<div class="line"><span class="lineno">  104</span>                            )</div>
<div class="line"><span class="lineno">  105</span>                        )</div>
<div class="line"><span class="lineno">  106</span>                    )</div>
<div class="line"><span class="lineno">  107</span>                )</div>
<div class="line"><span class="lineno">  108</span>            );</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>        <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;Notification: &#39;</span>.json_encode($headers).<span class="stringliteral">&#39;, &#39;</span>.$message);</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>        curl_setopt($ch, CURLOPT_URL, <a class="code hl_variable" href="lib_2setup_8php.html#aefeb98ab0670035c39501682bb373e06">$NotifierHost</a>);</div>
<div class="line"><span class="lineno">  113</span>        curl_setopt($ch, CURLOPT_POST, TRUE);</div>
<div class="line"><span class="lineno">  114</span>        curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);</div>
<div class="line"><span class="lineno">  115</span>        curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);</div>
<div class="line"><span class="lineno">  116</span>        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <a class="code hl_variable" href="lib_2setup_8php.html#ab734ea4f9b640926dc7bb2bf155f0a99">$NotifierSSLVerifyPeer</a>);</div>
<div class="line"><span class="lineno">  117</span>        curl_setopt($ch, CURLOPT_POSTFIELDS, $message);</div>
<div class="line"><span class="lineno">  118</span>        <span class="comment">// Time curl_exec() out if it takes too long</span></div>
<div class="line"><span class="lineno">  119</span>        curl_setopt($ch, CURLOPT_TIMEOUT, <a class="code hl_variable" href="lib_2setup_8php.html#ad7c70e27974adcc10e32df92a886c4b6">$NotifierTimeout</a>);</div>
<div class="line"><span class="lineno">  120</span>        </div>
<div class="line"><span class="lineno">  121</span>        $start= time();</div>
<div class="line"><span class="lineno">  122</span>        $output= curl_exec($ch);</div>
<div class="line"><span class="lineno">  123</span>        <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;curl_exec() runs for &#39;</span>.(time() - $start).<span class="stringliteral">&#39; secs&#39;</span>);</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>        <span class="keywordflow">if</span> ($output !== FALSE) {</div>
<div class="line"><span class="lineno">  126</span>            $output= json_decode($output, TRUE);</div>
<div class="line"><span class="lineno">  127</span>            <span class="keywordflow">if</span> ($output !== NULL) {</div>
<div class="line"><span class="lineno">  128</span>                <span class="keywordflow">if</span> (is_array($output)) {</div>
<div class="line"><span class="lineno">  129</span>                    <span class="keywordflow">if</span> (isset($output[<span class="stringliteral">&#39;success&#39;</span>]) &amp;&amp; $output[<span class="stringliteral">&#39;success&#39;</span>] == 1) {</div>
<div class="line"><span class="lineno">  130</span>                        $return= TRUE;</div>
<div class="line"><span class="lineno">  131</span>                    }</div>
<div class="line"><span class="lineno">  132</span>                    <span class="keywordflow">if</span> (isset($output[<span class="stringliteral">&#39;failure&#39;</span>]) &amp;&amp; $output[<span class="stringliteral">&#39;failure&#39;</span>] == 1) {</div>
<div class="line"><span class="lineno">  133</span>                        <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;Notification failed&#39;</span>);</div>
<div class="line"><span class="lineno">  134</span>                    }</div>
<div class="line"><span class="lineno">  135</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  136</span>                    <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;Curl exec output not array&#39;</span>);</div>
<div class="line"><span class="lineno">  137</span>                }</div>
<div class="line"><span class="lineno">  138</span>            }</div>
<div class="line"><span class="lineno">  139</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  140</span>            <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;Failed executing notifier curl&#39;</span>);</div>
<div class="line"><span class="lineno">  141</span>        }</div>
<div class="line"><span class="lineno">  142</span>        curl_close($ch);</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>        <span class="keywordflow">return</span> $return;</div>
<div class="line"><span class="lineno">  145</span>    }</div>
<div class="line"><span class="lineno">  146</span>}</div>
<div class="ttc" id="alib_2setup_8php_html_a0508338fca1a76b12a856a95be26afbb"><div class="ttname"><a href="lib_2setup_8php.html#a0508338fca1a76b12a856a95be26afbb">$NotifierAPIKey</a></div><div class="ttdeci">$NotifierAPIKey</div><div class="ttdoc">Notifier API key.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2setup_8php_source.html#l00059">setup.php:59</a></div></div>
<div class="ttc" id="alib_2setup_8php_html_ab734ea4f9b640926dc7bb2bf155f0a99"><div class="ttname"><a href="lib_2setup_8php.html#ab734ea4f9b640926dc7bb2bf155f0a99">$NotifierSSLVerifyPeer</a></div><div class="ttdeci">$NotifierSSLVerifyPeer</div><div class="ttdoc">Verify Notifier SSL peers.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2setup_8php_source.html#l00056">setup.php:56</a></div></div>
<div class="ttc" id="alib_2setup_8php_html_ad7c70e27974adcc10e32df92a886c4b6"><div class="ttname"><a href="lib_2setup_8php.html#ad7c70e27974adcc10e32df92a886c4b6">$NotifierTimeout</a></div><div class="ttdeci">$NotifierTimeout</div><div class="ttdoc">Wait notifier for this many seconds before giving up.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2setup_8php_source.html#l00068">setup.php:68</a></div></div>
<div class="ttc" id="alib_2setup_8php_html_aefeb98ab0670035c39501682bb373e06"><div class="ttname"><a href="lib_2setup_8php.html#aefeb98ab0670035c39501682bb373e06">$NotifierHost</a></div><div class="ttdeci">$NotifierHost</div><div class="ttdoc">Notifier host.</div><div class="ttdef"><b>Definition:</b> <a href="lib_2setup_8php_source.html#l00053">setup.php:53</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="lib_2setup_8php_source.html#l00059">$NotifierAPIKey</a>, <a class="el" href="lib_2setup_8php_source.html#l00053">$NotifierHost</a>, <a class="el" href="lib_2setup_8php_source.html#l00056">$NotifierSSLVerifyPeer</a>, <a class="el" href="lib_2setup_8php_source.html#l00068">$NotifierTimeout</a>, <a class="el" href="lib_2setup_8php_source.html#l00062">$NotifierUsers</a>, and <a class="el" href="libauth_8php_source.html#l00067">wui_syslog()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="notify_8php_ad0a55790f8935bf7687b982bfb13968e_cgraph.png" border="0" usemap="#anotify_8php_ad0a55790f8935bf7687b982bfb13968e_cgraph" alt=""/></div>
<map name="anotify_8php_ad0a55790f8935bf7687b982bfb13968e_cgraph" id="anotify_8php_ad0a55790f8935bf7687b982bfb13968e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,67,31"/>
<area shape="rect" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769" title="Wrapper for syslog()." alt="" coords="115,5,209,31"/>
</map>
</div>

</div>
</div>
<a id="ac089920689dafbf6a510f3b87eb6a6d4" name="ac089920689dafbf6a510f3b87eb6a6d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac089920689dafbf6a510f3b87eb6a6d4">&#9670;&#160;</a></span>PrintHelpWindow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PrintHelpWindow </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$width</em> = <code>'auto'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$type</em> = <code>'INFO'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Satisfies Controller. </p>
<p>This is due to common code used by all. Otherwise, the Controller cannot display help windows. </p>

<p class="definition">Definition at line <a class="el" href="notify_8php_source.html#l00061">61</a> of file <a class="el" href="notify_8php_source.html">notify.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   62</span>{</div>
<div class="line"><span class="lineno">   63</span>    $msg= preg_replace(<span class="stringliteral">&#39;?&lt;br\s*(|/)&gt;?&#39;</span>, <span class="charliteral">&#39; &#39;</span>, $msg);</div>
<div class="line"><span class="lineno">   64</span>    echo <span class="stringliteral">&quot;$type: $msg\n&quot;</span>;</div>
<div class="line"><span class="lineno">   65</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a2e72d5ffade7f18c8473dfb0e6415d92" name="a2e72d5ffade7f18c8473dfb0e6415d92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e72d5ffade7f18c8473dfb0e6415d92">&#9670;&#160;</a></span>$Prios</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$Prios</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= array(</div>
<div class="line">    <span class="stringliteral">&#39;Critical&#39;</span> =&gt; array(<span class="stringliteral">&#39;EMERGENCY&#39;</span>, <span class="stringliteral">&#39;ALERT&#39;</span>, <span class="stringliteral">&#39;CRITICAL&#39;</span>, <span class="stringliteral">&#39;emergency&#39;</span>, <span class="stringliteral">&#39;alert&#39;</span>, <span class="stringliteral">&#39;critical&#39;</span>),</div>
<div class="line">    <span class="stringliteral">&#39;Error&#39;</span> =&gt; array(<span class="stringliteral">&#39;ERROR&#39;</span>, <span class="stringliteral">&#39;error&#39;</span>),</div>
<div class="line">    <span class="stringliteral">&#39;Warning&#39;</span> =&gt; array(<span class="stringliteral">&#39;WARNING&#39;</span>, <span class="stringliteral">&#39;NOTICE&#39;</span>, <span class="stringliteral">&#39;warning&#39;</span>, <span class="stringliteral">&#39;notice&#39;</span>),</div>
<div class="line">    )</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="notify_8php_source.html#l00050">50</a> of file <a class="el" href="notify_8php_source.html">notify.php</a>.</p>

<p class="reference">Referenced by <a class="el" href="notify_8php_source.html#l00148">BuildFields()</a>, and <a class="el" href="notify_8php_source.html#l00170">FilterLogLevels()</a>.</p>

</div>
</div>
<a id="a3c60c4d05948280e2c028ad791e7cc82" name="a3c60c4d05948280e2c028ad791e7cc82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c60c4d05948280e2c028ad791e7cc82">&#9670;&#160;</a></span>$ROOT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$ROOT = dirname(dirname(__FILE__))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="notify_8php_source.html#l00035">35</a> of file <a class="el" href="notify_8php_source.html">notify.php</a>.</p>

</div>
</div>
<a id="aa85c30e769dd86430134683306463a51" name="aa85c30e769dd86430134683306463a51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa85c30e769dd86430134683306463a51">&#9670;&#160;</a></span>$StatusText</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$StatusText</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= array(</div>
<div class="line">    <span class="charliteral">&#39;R&#39;</span> =&gt; _(<span class="stringliteral">&#39;running&#39;</span>),</div>
<div class="line">    <span class="charliteral">&#39;S&#39;</span> =&gt; _(<span class="stringliteral">&#39;stopped&#39;</span>),</div>
<div class="line">    )</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="notify_8php_source.html#l00045">45</a> of file <a class="el" href="notify_8php_source.html">notify.php</a>.</p>

<p class="reference">Referenced by <a class="el" href="notify_8php_source.html#l00148">BuildFields()</a>.</p>

</div>
</div>
<a id="ae24ad5440f9dc504e9e3ef2ddfb65566" name="ae24ad5440f9dc504e9e3ef2ddfb65566"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae24ad5440f9dc504e9e3ef2ddfb65566">&#9670;&#160;</a></span>$UseSSH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$UseSSH = FALSE</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section attention"><dt>Attention</dt><dd>This script is executed on the command line, so we don't have access to cookie and session vars here. </dd></dl>

<p class="definition">Definition at line <a class="el" href="notify_8php_source.html#l00294">294</a> of file <a class="el" href="notify_8php_source.html">notify.php</a>.</p>

</div>
</div>
<a id="adfe49c647d27eb2b424c3ea73082382f" name="adfe49c647d27eb2b424c3ea73082382f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfe49c647d27eb2b424c3ea73082382f">&#9670;&#160;</a></span>$View</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$<a class="el" href="classView.html">View</a> = new <a class="el" href="classView.html">View</a>()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="notify_8php_source.html#l00289">289</a> of file <a class="el" href="notify_8php_source.html">notify.php</a>.</p>

</div>
</div>
<a id="a1cf4c1ce4d54df11a660775bb7c5bbd8" name="a1cf4c1ce4d54df11a660775bb7c5bbd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cf4c1ce4d54df11a660775bb7c5bbd8">&#9670;&#160;</a></span>$VIEW_PATH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$VIEW_PATH = $ROOT.'/<a class="el" href="classView.html">View</a>/'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="notify_8php_source.html#l00036">36</a> of file <a class="el" href="notify_8php_source.html">notify.php</a>.</p>

</div>
</div>
<a id="ad710cc6443330c829dc21fc80f3a233c" name="ad710cc6443330c829dc21fc80f3a233c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad710cc6443330c829dc21fc80f3a233c">&#9670;&#160;</a></span>else</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ctlr_8php.html#abc2baa6b327386720a46de43cf272921">if</a> (count(json_decode( $NotifierUsers, TRUE)) &gt; 0) else</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">{</div>
<div class="line">    <a class="code hl_function" href="libauth_8php.html#aafa5d84b0ff32cf3d31b8cdfd1c6d769">wui_syslog</a>(LOG_WARNING, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">&#39;No device token to send notifications to&#39;</span>)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="notify_8php_source.html#l00380">380</a> of file <a class="el" href="notify_8php_source.html">notify.php</a>.</p>

</div>
</div>
<a id="aa9151809b1224544377732b01b47eddb" name="aa9151809b1224544377732b01b47eddb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9151809b1224544377732b01b47eddb">&#9670;&#160;</a></span>Model</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$<a class="el" href="classView.html">View</a> <a class="el" href="classModel.html">Model</a> = 'system'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="notify_8php_source.html#l00290">290</a> of file <a class="el" href="notify_8php_source.html">notify.php</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_e5bdda2a66bb179ade6b6b4e98919126.html">Notifier</a></li><li class="navelem"><a class="el" href="notify_8php.html">notify.php</a></li>
    <li class="footer">Generated on Sun Apr 30 2023 00:52:47 for PF Firewall by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
